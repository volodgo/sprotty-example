{
  "version": 3,
  "sources": ["../node_modules/sprotty/src/base/actions/action.ts", "../node_modules/inversify/lib/constants/metadata_keys.js", "../node_modules/inversify/lib/constants/literal_types.js", "../node_modules/inversify/lib/utils/id.js", "../node_modules/inversify/lib/bindings/binding.js", "../node_modules/inversify/lib/constants/error_msgs.js", "../node_modules/inversify/lib/planning/metadata_reader.js", "../node_modules/inversify/lib/bindings/binding_count.js", "../node_modules/inversify/lib/utils/exceptions.js", "../node_modules/inversify/lib/utils/serialization.js", "../node_modules/inversify/lib/planning/context.js", "../node_modules/inversify/lib/planning/metadata.js", "../node_modules/inversify/lib/planning/plan.js", "../node_modules/inversify/lib/annotation/lazy_service_identifier.js", "../node_modules/inversify/lib/planning/queryable_string.js", "../node_modules/inversify/lib/planning/target.js", "../node_modules/inversify/lib/planning/reflection_utils.js", "../node_modules/inversify/lib/planning/request.js", "../node_modules/inversify/lib/planning/planner.js", "../node_modules/inversify/lib/utils/async.js", "../node_modules/inversify/lib/scope/scope.js", "../node_modules/inversify/lib/utils/factory_type.js", "../node_modules/inversify/lib/utils/binding_utils.js", "../node_modules/inversify/lib/resolution/instantiation.js", "../node_modules/inversify/lib/resolution/resolver.js", "../node_modules/inversify/lib/syntax/constraint_helpers.js", "../node_modules/inversify/lib/syntax/binding_when_syntax.js", "../node_modules/inversify/lib/syntax/binding_on_syntax.js", "../node_modules/inversify/lib/syntax/binding_when_on_syntax.js", "../node_modules/inversify/lib/syntax/binding_in_syntax.js", "../node_modules/inversify/lib/syntax/binding_in_when_on_syntax.js", "../node_modules/inversify/lib/syntax/binding_to_syntax.js", "../node_modules/inversify/lib/container/container_snapshot.js", "../node_modules/inversify/lib/utils/clonable.js", "../node_modules/inversify/lib/container/lookup.js", "../node_modules/inversify/lib/container/module_activation_store.js", "../node_modules/inversify/lib/container/container.js", "../node_modules/inversify/lib/container/container_module.js", "../node_modules/inversify/lib/utils/js.js", "../node_modules/inversify/lib/annotation/decorator_utils.js", "../node_modules/inversify/lib/annotation/injectable.js", "../node_modules/inversify/lib/annotation/tagged.js", "../node_modules/inversify/lib/annotation/named.js", "../node_modules/inversify/lib/annotation/inject_base.js", "../node_modules/inversify/lib/annotation/inject.js", "../node_modules/inversify/lib/annotation/optional.js", "../node_modules/inversify/lib/annotation/unmanaged.js", "../node_modules/inversify/lib/annotation/multi_inject.js", "../node_modules/inversify/lib/annotation/target_name.js", "../node_modules/inversify/lib/annotation/property_event_decorator.js", "../node_modules/inversify/lib/annotation/post_construct.js", "../node_modules/inversify/lib/annotation/pre_destroy.js", "../node_modules/inversify/lib/interfaces/interfaces.js", "../node_modules/inversify/lib/inversify.js", "../node_modules/sprotty-protocol/src/utils/object.ts", "../node_modules/sprotty-protocol/src/actions.ts", "../node_modules/sprotty-protocol/src/utils/async.ts", "../node_modules/sprotty/src/base/types.ts", "../node_modules/sprotty/src/utils/registry.ts", "../node_modules/sprotty-protocol/src/utils/geometry.ts", "../node_modules/sprotty/src/utils/iterable.ts", "../node_modules/sprotty/src/base/model/smodel.ts", "../node_modules/sprotty/src/base/model/smodel-factory.ts", "../node_modules/sprotty/src/base/animations/animation-frame-syncer.ts", "../node_modules/sprotty/src/base/actions/action-dispatcher.ts", "../node_modules/sprotty/src/utils/inversify.ts", "../node_modules/sprotty/src/base/actions/action-handler.ts", "../node_modules/sprotty/src/base/actions/diagram-locker.ts", "../node_modules/sprotty/src/base/animations/easing.ts", "../node_modules/sprotty/src/base/animations/animation.ts", "../node_modules/sprotty/src/base/commands/command.ts", "../node_modules/sprotty/src/base/commands/command-registration.ts", "../node_modules/sprotty/src/base/commands/command-stack-options.ts", "../node_modules/sprotty/src/base/commands/command-stack.ts", "../node_modules/sprotty-protocol/src/utils/model-utils.ts", "../node_modules/sprotty-protocol/src/diagram-server.ts", "../node_modules/sprotty-protocol/src/model.ts", "../node_modules/sprotty-protocol/src/index.ts", "../node_modules/sprotty/src/utils/browser.ts", "../node_modules/sprotty/src/base/features/initialize-canvas.ts", "../node_modules/sprotty/src/base/features/set-model.ts", "../node_modules/sprotty/src/base/model/smodel-utils.ts", "../node_modules/sprotty/src/base/ui-extensions/ui-extension-registry.ts", "../node_modules/sprotty/src/base/ui-extensions/ui-extension.ts", "../node_modules/sprotty/src/base/views/vnode-utils.ts", "../node_modules/sprotty/src/base/views/key-tool.ts", "../node_modules/sprotty/src/base/views/dom-helper.ts", "../node_modules/sprotty/src/base/views/mouse-tool.ts", "../node_modules/snabbdom/build/snabbdom.cjs.js", "../node_modules/sprotty/src/base/views/thunk-view.ts", "../node_modules/sprotty/src/lib/jsx.ts", "../node_modules/sprotty/src/base/views/view.tsx", "../node_modules/sprotty/src/base/views/viewer-cache.ts", "../node_modules/sprotty/src/base/views/viewer-options.ts", "../node_modules/sprotty/src/base/views/viewer.tsx", "../node_modules/sprotty/src/base/views/vnode-postprocessor.ts", "../node_modules/sprotty/src/utils/logging.ts", "../node_modules/sprotty/src/base/views/id-postprocessor.ts", "../node_modules/sprotty/src/base/views/css-class-postprocessor.ts", "../node_modules/sprotty/src/base/di.config.ts", "../node_modules/sprotty/src/features/bounds/model.ts", "../node_modules/sprotty/src/features/bounds/bounds-manipulation.ts", "../node_modules/sprotty/src/features/bounds/layout.ts", "../node_modules/sprotty/src/features/bounds/hidden-bounds-updater.ts", "../node_modules/sprotty/src/features/bounds/abstract-layout.ts", "../node_modules/sprotty/src/features/bounds/vbox-layout.ts", "../node_modules/sprotty/src/features/bounds/hbox-layout.ts", "../node_modules/sprotty/src/features/bounds/stack-layout.ts", "../node_modules/sprotty/src/features/bounds/views.ts", "../node_modules/sprotty/src/features/button/button-handler.ts", "../node_modules/sprotty/src/features/fade/model.ts", "../node_modules/sprotty/src/features/button/model.ts", "../node_modules/sprotty/src/features/nameable/model.ts", "../node_modules/sprotty/src/features/command-palette/action-providers.ts", "../node_modules/sprotty/src/utils/codicon.ts", "../node_modules/sprotty/src/utils/keyboard.ts", "../node_modules/sprotty/src/features/select/model.ts", "../node_modules/autocompleter/autocomplete.ts", "../node_modules/sprotty/src/features/command-palette/command-palette.ts", "../node_modules/sprotty/src/features/context-menu/context-menu-service.ts", "../node_modules/sprotty/src/features/edit/delete.ts", "../node_modules/sprotty/src/features/context-menu/menu-providers.ts", "../node_modules/sprotty/src/features/context-menu/mouse-listener.ts", "../node_modules/sprotty/src/features/hover/model.ts", "../node_modules/sprotty/src/features/move/model.ts", "../node_modules/sprotty/src/features/routing/model.ts", "../node_modules/sprotty/src/features/edge-layout/model.ts", "../node_modules/sprotty/src/features/edit/model.ts", "../node_modules/sprotty/src/utils/geometry.ts", "../node_modules/sprotty/src/features/viewport/model.ts", "../node_modules/sprotty/src/features/export/model.ts", "../node_modules/sprotty/src/features/viewport/viewport-root.ts", "../node_modules/sprotty/src/graph/sgraph.ts", "../node_modules/sprotty/src/features/routing/anchor.ts", "../node_modules/sprotty/src/features/routing/abstract-edge-router.ts", "../node_modules/sprotty/src/features/routing/polyline-edge-router.ts", "../node_modules/sprotty/src/features/routing/routing.ts", "../node_modules/sprotty/src/features/edge-layout/edge-layout.ts", "../node_modules/sprotty/src/features/edge-layout/di.config.ts", "../node_modules/sprotty/src/features/edit/create.ts", "../node_modules/sprotty/src/features/edit/create-on-drag.ts", "../node_modules/sprotty/src/lib/svg-views.tsx", "../node_modules/sprotty/src/features/edit/edit-label.ts", "../node_modules/sprotty/src/features/export/svg-exporter.ts", "../node_modules/sprotty/src/model-source/model-source.ts", "../node_modules/sprotty/src/model-source/commit-model.ts", "../node_modules/sprotty/src/features/viewport/zoom.ts", "../node_modules/sprotty/src/features/edit/edit-label-ui.ts", "../node_modules/sprotty/src/features/edit/edit-routing.ts", "../node_modules/sprotty/src/features/edit/reconnect.ts", "../node_modules/sprotty/src/features/edit/di.config.ts", "../node_modules/sprotty/src/features/expand/model.ts", "../node_modules/sprotty/src/features/expand/expand.ts", "../node_modules/sprotty/src/features/expand/views.tsx", "../node_modules/sprotty/src/features/export/export.ts", "../node_modules/sprotty/src/features/fade/fade.ts", "../node_modules/sprotty/src/features/hover/hover.ts", "../node_modules/sprotty/src/features/decoration/model.ts", "../node_modules/sprotty/src/features/decoration/views.tsx", "../node_modules/sprotty/src/features/decoration/decoration-placer.ts", "../node_modules/tinyqueue/tinyqueue.js", "../node_modules/sprotty/src/features/edge-intersection/sweepline.ts", "../node_modules/sprotty/src/features/edge-intersection/intersection-finder.ts", "../node_modules/sprotty/src/features/move/move.ts", "../node_modules/sprotty/src/features/move/snap.ts", "../node_modules/sprotty/src/features/open/model.ts", "../node_modules/sprotty/src/features/open/open.ts", "../node_modules/sprotty/src/features/projection/model.ts", "../node_modules/sprotty/src/features/projection/views.tsx", "../node_modules/sprotty/src/features/routing/polyline-anchors.ts", "../node_modules/sprotty/src/features/routing/bezier-edge-router.ts", "../node_modules/sprotty/src/features/routing/bezier-anchors.ts", "../node_modules/sprotty/src/features/routing/manhattan-edge-router.ts", "../node_modules/sprotty/src/features/routing/manhattan-anchors.ts", "../node_modules/sprotty/src/features/routing/views.ts", "../node_modules/sprotty/src/base/commands/request-command.ts", "../node_modules/sprotty/src/features/viewport/scroll.ts", "../node_modules/sprotty/src/features/select/select.ts", "../node_modules/sprotty/src/features/undo-redo/undo-redo.ts", "../node_modules/sprotty/src/features/update/model-matching.ts", "../node_modules/sprotty/src/features/bounds/resize.ts", "../node_modules/sprotty/src/features/update/update-model.ts", "../node_modules/sprotty/src/features/viewport/viewport.ts", "../node_modules/sprotty/src/features/viewport/center-fit.ts", "../node_modules/sprotty/src/features/zorder/zorder.ts", "../node_modules/sprotty/src/features/bounds/di.config.ts", "../node_modules/sprotty/src/features/button/di.config.ts", "../node_modules/sprotty/src/features/command-palette/di.config.ts", "../node_modules/sprotty/src/features/context-menu/di.config.ts", "../node_modules/sprotty/src/features/decoration/di.config.ts", "../node_modules/sprotty/src/features/edge-intersection/di.config.ts", "../node_modules/sprotty/src/features/expand/di.config.ts", "../node_modules/sprotty/src/features/export/di.config.ts", "../node_modules/sprotty/src/features/fade/di.config.ts", "../node_modules/sprotty/src/features/hover/popup-position-updater.ts", "../node_modules/sprotty/src/features/hover/di.config.ts", "../node_modules/sprotty/src/features/move/di.config.ts", "../node_modules/sprotty/src/features/open/di.config.ts", "../node_modules/sprotty/src/features/routing/di.config.ts", "../node_modules/sprotty/src/features/select/di.config.ts", "../node_modules/sprotty/src/features/undo-redo/di.config.ts", "../node_modules/sprotty/src/features/update/di.config.ts", "../node_modules/sprotty/src/features/viewport/di.config.ts", "../node_modules/sprotty/src/features/zorder/di.config.ts", "../node_modules/sprotty/src/graph/views.tsx", "../node_modules/sprotty/src/model-source/di.config.ts", "../node_modules/sprotty/src/lib/modules.ts", "../node_modules/sprotty/src/lib/virtualize.ts", "../node_modules/sprotty/src/lib/model.ts", "../node_modules/sprotty/src/lib/generic-views.tsx", "../node_modules/sprotty/src/lib/html-views.tsx", "../node_modules/file-saver/src/FileSaver.js", "../node_modules/sprotty/src/model-source/diagram-server.ts", "../node_modules/sprotty/src/model-source/local-model-source.ts", "../node_modules/sprotty/src/model-source/logging.ts", "../node_modules/sprotty/src/model-source/websocket.ts", "../node_modules/sprotty/src/utils/color.ts", "../node_modules/sprotty/src/index.ts", "../node_modules/@eclipse-glsp/protocol/node_modules/sprotty-protocol/src/utils/async.ts", "../node_modules/@eclipse-glsp/protocol/node_modules/sprotty-protocol/src/utils/object.ts", "../node_modules/@eclipse-glsp/protocol/node_modules/sprotty-protocol/src/utils/geometry.ts", "../node_modules/@eclipse-glsp/protocol/node_modules/sprotty-protocol/src/utils/model-utils.ts", "../node_modules/@eclipse-glsp/protocol/node_modules/sprotty-protocol/src/actions.ts", "../node_modules/@eclipse-glsp/protocol/src/utils/type-util.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/base-protocol.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/client-notification.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/clipboard.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/contexts.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/edge-modification.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/element-creation.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/element-hover.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/element-navigation.ts", "../node_modules/@eclipse-glsp/protocol/src/utils/array-util.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/element-selection.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/element-text-editing.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/element-type-hints.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/element-validation.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/model-data.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/model-edit-mode.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/model-layout.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/model-saving.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/node-modification.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/tool-palette.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/types.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/undo-redo.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/viewport.ts", "../node_modules/@eclipse-glsp/protocol/src/action-protocol/index.ts", "../node_modules/@eclipse-glsp/protocol/node_modules/sprotty-protocol/src/diagram-server.ts", "../node_modules/@eclipse-glsp/protocol/node_modules/sprotty-protocol/src/model.ts", "../node_modules/@eclipse-glsp/protocol/node_modules/sprotty-protocol/src/index.ts", "../node_modules/vscode-jsonrpc/lib/common/is.js", "../node_modules/vscode-jsonrpc/lib/common/messages.js", "../node_modules/vscode-jsonrpc/lib/common/linkedMap.js", "../node_modules/vscode-jsonrpc/lib/common/disposable.js", "../node_modules/vscode-jsonrpc/lib/common/ral.js", "../node_modules/vscode-jsonrpc/lib/common/events.js", "../node_modules/vscode-jsonrpc/lib/common/cancellation.js", "../node_modules/vscode-jsonrpc/lib/common/sharedArrayCancellation.js", "../node_modules/vscode-jsonrpc/lib/common/semaphore.js", "../node_modules/vscode-jsonrpc/lib/common/messageReader.js", "../node_modules/vscode-jsonrpc/lib/common/messageWriter.js", "../node_modules/vscode-jsonrpc/lib/common/messageBuffer.js", "../node_modules/vscode-jsonrpc/lib/common/connection.js", "../node_modules/vscode-jsonrpc/lib/common/api.js", "../node_modules/vscode-jsonrpc/lib/browser/ril.js", "../node_modules/vscode-jsonrpc/lib/browser/main.js", "../node_modules/@eclipse-glsp/protocol/src/utils/event.ts", "../node_modules/uuid/dist/rng-browser.js", "../node_modules/uuid/dist/bytesToUuid.js", "../node_modules/uuid/dist/v1.js", "../node_modules/uuid/dist/v35.js", "../node_modules/uuid/dist/md5-browser.js", "../node_modules/uuid/dist/v3.js", "../node_modules/uuid/dist/v4.js", "../node_modules/uuid/dist/sha1-browser.js", "../node_modules/uuid/dist/v5.js", "../node_modules/uuid/dist/index.js", "../node_modules/@eclipse-glsp/protocol/src/client-server-protocol/glsp-client.ts", "../node_modules/@eclipse-glsp/protocol/src/client-server-protocol/base-glsp-client.ts", "../node_modules/@eclipse-glsp/protocol/src/client-server-protocol/glsp-server.ts", "../node_modules/@eclipse-glsp/protocol/src/client-server-protocol/jsonrpc/glsp-jsonrpc-client.ts", "../node_modules/@eclipse-glsp/protocol/src/client-server-protocol/jsonrpc/base-jsonrpc-glsp-client.ts", "../node_modules/@eclipse-glsp/protocol/src/client-server-protocol/jsonrpc/glsp-jsonrpc-server.ts", "../node_modules/@eclipse-glsp/protocol/src/client-server-protocol/jsonrpc/websocket-connection.ts", "../node_modules/@eclipse-glsp/protocol/src/client-server-protocol/jsonrpc/ws-connection-provider.ts", "../node_modules/@eclipse-glsp/protocol/src/model/default-types.ts", "../node_modules/@eclipse-glsp/protocol/src/model/model-schema.ts", "../node_modules/@eclipse-glsp/protocol/src/sprotty-actions.ts", "../node_modules/@eclipse-glsp/protocol/src/utils/di-util.ts", "../node_modules/@eclipse-glsp/protocol/src/utils/disposable.ts", "../node_modules/@eclipse-glsp/protocol/src/index.ts", "../node_modules/@eclipse-glsp/sprotty/src/action-override.ts", "../node_modules/@eclipse-glsp/sprotty/src/types.ts", "../node_modules/@eclipse-glsp/sprotty/src/feature-modules.ts", "../node_modules/@eclipse-glsp/sprotty/src/index.ts", "../node_modules/@eclipse-glsp/client/src/base/model/model-initialization-constraint.ts", "../node_modules/@eclipse-glsp/client/src/base/action-dispatcher.ts", "../node_modules/@eclipse-glsp/client/src/base/action-handler-registry.ts", "../node_modules/@eclipse-glsp/client/src/base/args-feature.ts", "../node_modules/@eclipse-glsp/client/src/base/auto-complete/auto-complete-actions.ts", "../node_modules/@eclipse-glsp/client/src/base/auto-complete/validation-decorator.ts", "../node_modules/@eclipse-glsp/client/src/base/auto-complete/auto-complete-widget.ts", "../node_modules/@eclipse-glsp/client/src/base/command-stack.ts", "../node_modules/@eclipse-glsp/client/src/base/drag-aware-mouse-listener.ts", "../node_modules/@eclipse-glsp/client/src/utils/gmodel-util.ts", "../node_modules/@eclipse-glsp/client/src/base/selection-service.ts", "../node_modules/@eclipse-glsp/client/src/base/editor-context-service.ts", "../node_modules/@eclipse-glsp/client/src/base/feedback/feedback-action-dispatcher.ts", "../node_modules/@eclipse-glsp/client/src/base/feedback/feedback-command.ts", "../node_modules/@eclipse-glsp/client/src/base/feedback/update-model-command.ts", "../node_modules/@eclipse-glsp/client/src/base/focus/focus-state-change-action.ts", "../node_modules/@eclipse-glsp/client/src/base/focus/focus-tracker.ts", "../node_modules/@eclipse-glsp/client/src/base/ranked.ts", "../node_modules/@eclipse-glsp/client/src/base/model/glsp-model-source.ts", "../node_modules/@eclipse-glsp/client/src/base/model/diagram-loader.ts", "../node_modules/@eclipse-glsp/client/src/base/model/model-registry.ts", "../node_modules/@eclipse-glsp/client/src/base/selection-clearing-mouse-listener.ts", "../node_modules/@eclipse-glsp/client/src/base/tool-manager/tool.ts", "../node_modules/@eclipse-glsp/client/src/base/tool-manager/tool-manager.ts", "../node_modules/@eclipse-glsp/client/src/base/view/mouse-tool.ts", "../node_modules/@eclipse-glsp/client/src/base/view/view-registry.ts", "../node_modules/@eclipse-glsp/client/src/base/feedback/css-feedback.ts", "../node_modules/@eclipse-glsp/client/src/features/hints/model.ts", "../node_modules/@eclipse-glsp/client/src/model.ts", "../node_modules/@eclipse-glsp/client/src/features/viewport/reposition.ts", "../node_modules/lodash/lodash.js", "../node_modules/@eclipse-glsp/client/src/features/accessibility/key-shortcut/accessible-key-shortcut.ts", "../node_modules/@eclipse-glsp/client/src/base/view/key-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/base-tools.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/key-shortcut/accessible-key-shortcut-tool.ts", "../node_modules/@eclipse-glsp/client/src/base/auto-complete/base-autocomplete-palette.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/search/search-palette.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/search/search-tool.ts", "../node_modules/@eclipse-glsp/client/lib/features/accessibility/toast/messages.json", "../node_modules/@eclipse-glsp/client/src/features/accessibility/toast/toast-handler.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/element-navigation/diagram-navigation-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/focus-tracker/focus-tracker-tool.ts", "../node_modules/@eclipse-glsp/client/src/utils/layout-utils.ts", "../node_modules/@eclipse-glsp/client/src/features/change-bounds/snap.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/resize-key-tool/resize-key-handler.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/resize-key-tool/resize-key-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/toast/toast-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/change-bounds/model.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/view-key-tools/deselect-key-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/move-zoom/move-handler.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/view-key-tools/movement-key-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/move-zoom/zoom-handler.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-grid/action.ts", "../node_modules/@eclipse-glsp/client/src/utils/viewpoint-util.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/view-key-tools/zoom-key-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/bounds/freeform-layout.ts", "../node_modules/@eclipse-glsp/client/src/features/bounds/glsp-hidden-bounds-updater.ts", "../node_modules/@eclipse-glsp/client/src/features/bounds/hbox-layout.ts", "../node_modules/@eclipse-glsp/client/src/features/bounds/layouter.ts", "../node_modules/@eclipse-glsp/client/src/features/bounds/vbox-layout.ts", "../node_modules/@eclipse-glsp/client/src/features/change-bounds/movement-restrictor.ts", "../node_modules/@eclipse-glsp/client/src/features/command-palette/command-palette-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/command-palette/server-command-palette-provider.ts", "../node_modules/@eclipse-glsp/client/src/features/context-menu/delete-element-context-menu.ts", "../node_modules/@eclipse-glsp/client/src/features/context-menu/glsp-context-menu-mouse-listener.ts", "../node_modules/@eclipse-glsp/client/src/features/context-menu/server-context-menu-provider.ts", "../node_modules/@eclipse-glsp/client/src/features/copy-paste/copy-paste-context-menu.ts", "../node_modules/@eclipse-glsp/client/src/features/copy-paste/copy-paste-handler.ts", "../node_modules/@eclipse-glsp/client/src/features/decoration/decoration-placer.ts", "../node_modules/@eclipse-glsp/client/src/features/export/glsp-svg-exporter.ts", "../node_modules/@eclipse-glsp/client/src/features/reconnect/model.ts", "../node_modules/@eclipse-glsp/client/src/features/hints/type-hint-provider.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/edge-creation/view.tsx", "../node_modules/@eclipse-glsp/client/src/features/tools/edge-creation/dangling-edge-feedback.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/edge-creation/edge-creation-tool-feedback.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/edge-creation/edge-creation-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/validation/issue-marker.ts", "../node_modules/@eclipse-glsp/client/src/features/hover/hover.ts", "../node_modules/@eclipse-glsp/client/src/features/label-edit/edit-label-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/label-edit/edit-label-validator.ts", "../node_modules/@eclipse-glsp/client/src/features/layout/layout-elements-action.ts", "../node_modules/@eclipse-glsp/client/src/features/navigation/navigation-target-resolver.ts", "../node_modules/@eclipse-glsp/client/src/features/navigation/navigation-action-handler.ts", "../node_modules/@eclipse-glsp/client/src/features/routing/glsp-manhattan-edge-router.ts", "../node_modules/@eclipse-glsp/client/src/features/save/save-keylistener.ts", "../node_modules/@eclipse-glsp/client/src/features/select/select-feedback-command.ts", "../node_modules/@eclipse-glsp/client/src/features/select/select-mouse-listener.ts", "../node_modules/@eclipse-glsp/client/src/features/source-model-watcher/source-model-changed-action-handler.ts", "../node_modules/@eclipse-glsp/client/src/features/status/status-overlay.ts", "../node_modules/@eclipse-glsp/client/src/features/svg-metadata/metadata-placer.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/deletion/delete-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/marquee-selection/marquee-tool-feedback.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/marquee-selection/marquee-behavior.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/marquee-selection/marquee-mouse-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/tool-palette/tool-palette.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/change-bounds/change-bounds-tool-feedback.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/change-bounds/change-bounds-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/change-bounds/view.tsx", "../node_modules/@eclipse-glsp/client/src/features/tools/edge-edit/edge-edit-tool-feedback.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/edge-edit/edge-edit-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/marquee-selection/marquee-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/marquee-selection/model.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/marquee-selection/view.tsx", "../node_modules/@eclipse-glsp/client/src/features/tools/node-creation/node-creation-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/undo-redo/undo-redo-key-listener.ts", "../node_modules/@eclipse-glsp/client/src/utils/marker.ts", "../node_modules/@eclipse-glsp/client/src/features/validation/marker-navigator.ts", "../node_modules/@eclipse-glsp/client/src/features/validation/validate.ts", "../node_modules/@eclipse-glsp/client/src/features/viewport/glsp-scroll-mouse-listener.ts", "../node_modules/@eclipse-glsp/client/src/base/default.module.ts", "../node_modules/@eclipse-glsp/client/src/features/bounds/bounds-module.ts", "../node_modules/@eclipse-glsp/client/src/features/command-palette/command-palette-module.ts", "../node_modules/@eclipse-glsp/client/src/features/context-menu/context-menu-module.ts", "../node_modules/@eclipse-glsp/client/src/features/copy-paste/copy-paste-standalone.ts", "../node_modules/@eclipse-glsp/client/src/features/copy-paste/copy-paste-modules.ts", "../node_modules/@eclipse-glsp/client/src/features/decoration/decoration-module.ts", "../node_modules/@eclipse-glsp/client/src/features/export/export-svg-action-handler.ts", "../node_modules/@eclipse-glsp/client/src/features/export/export-modules.ts", "../node_modules/@eclipse-glsp/client/src/features/hints/type-hints-module.ts", "../node_modules/@eclipse-glsp/client/src/features/hover/hover-module.ts", "../node_modules/@eclipse-glsp/client/src/features/label-edit/label-edit-module.ts", "../node_modules/@eclipse-glsp/client/src/features/layout/layout-module.ts", "../node_modules/@eclipse-glsp/client/src/features/navigation/navigation-module.ts", "../node_modules/@eclipse-glsp/client/src/features/routing/routing-module.ts", "../node_modules/@eclipse-glsp/client/src/features/select/select-module.ts", "../node_modules/@eclipse-glsp/client/src/features/source-model-watcher/source-model-wacher-module.ts", "../node_modules/@eclipse-glsp/client/src/features/status/status-module.ts", "../node_modules/@eclipse-glsp/client/src/features/svg-metadata/svg-metadata-module.ts", "../node_modules/@eclipse-glsp/client/src/features/tool-palette/tool-palette-module.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/change-bounds/change-boounds-tool-module.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/deletion/deletion-tool-module.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/edge-creation/edege-creation-module.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/edge-edit/edge-edit-module.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/marquee-selection/marquee-selection-module.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/node-creation/node-creation-module.ts", "../node_modules/@eclipse-glsp/client/src/features/tools/tool-focus-loss-module.ts", "../node_modules/@eclipse-glsp/client/src/features/validation/validation-modules.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/actions.ts", "../node_modules/@eclipse-glsp/client/src/features/viewport/viewport-handler.ts", "../node_modules/@eclipse-glsp/client/src/features/viewport/viewport-modules.ts", "../node_modules/@eclipse-glsp/client/src/default-modules.ts", "../node_modules/@eclipse-glsp/client/src/features/save/save-module.ts", "../node_modules/@eclipse-glsp/client/src/features/undo-redo/undo-redo-module.ts", "../node_modules/@eclipse-glsp/client/src/standalone-modules.ts", "../node_modules/@eclipse-glsp/client/src/utils/argument-utils.ts", "../node_modules/@eclipse-glsp/client/src/utils/html-utils.ts", "../node_modules/@eclipse-glsp/client/src/views/gedge-view.tsx", "../node_modules/@eclipse-glsp/client/src/views/issue-marker-view.tsx", "../node_modules/@eclipse-glsp/client/src/views/rounded-corner.ts", "../node_modules/@eclipse-glsp/client/src/views/rounded-corner-view.tsx", "../node_modules/@eclipse-glsp/client/src/views/base-view-module.ts", "../node_modules/@eclipse-glsp/client/src/views/compartments.tsx", "../node_modules/@eclipse-glsp/client/src/views/glsp-projection-view.tsx", "../node_modules/@eclipse-glsp/client/src/views/index.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/key-shortcut/di.config.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/move-zoom/move-zoom-module.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/resize-key-tool/resize-key-module.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/search/search-palette-module.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/view-key-tools/view-key-tools-module.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-grid/constants.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/edge-autocomplete/action.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/edge-autocomplete/edge-autocomplete-palette.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-tool-palette/keyboard-tool-palette.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-tool-palette/keyboard-tool-palette-module.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-pointer/constants.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/global-keylistener-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-pointer/actions.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-pointer/keyboard-pointer-listener.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-pointer/keyboard-pointer-position.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-pointer/keyboard-pointer.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-grid/keyboard-grid.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/edge-autocomplete/edge-autocomplete-tool.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-grid/keyboard-grid-search-palette.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-grid/keyboard-node-grid.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/keyboard-pointer/keyboard-pointer-module.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/element-navigation/position-navigator.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/element-navigation/local-element-navigator.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/element-navigation/element-navigation-module.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/focus-tracker/focus-tracker-module.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/toast/toast-module.ts", "../node_modules/@eclipse-glsp/client/src/features/accessibility/accessibility-module.ts", "../node_modules/@eclipse-glsp/client/src/index.ts", "../node_modules/reflect-metadata/Reflect.js", "../index.ts", "../di.config.ts", "../views.tsx", "../models.ts", "../model-source.ts", "../features/creatingNodes/creatingNodes.ts", "../features/creatingEdge/di.config.ts", "../features/creatingEdge/creatingEdge.ts", "../features/creatingEdge/model.ts", "../features/edge-creation/dangling-edge-feedback.ts", "../features/edge-creation/view.tsx", "../features/creatingNodes/di.config.ts"],
  "sourcesContent": ["/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Action } from 'sprotty-protocol/lib/actions';\n\n/**\n * A list of actions with a label.\n * Labeled actions are used to denote a group of actions in a user-interface context, e.g.,\n * to define an entry in the command palette or in the context menu.\n */\nexport class LabeledAction {\n    constructor(readonly label: string, readonly actions: Action[], readonly icon?: string) { }\n}\n\nexport function isLabeledAction(element: unknown): element is LabeledAction {\n    return element !== undefined\n        && (<LabeledAction>element).label !== undefined\n        && (<LabeledAction>element).actions !== undefined;\n}\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.NON_CUSTOM_TAG_KEYS = exports.PRE_DESTROY = exports.POST_CONSTRUCT = exports.DESIGN_PARAM_TYPES = exports.PARAM_TYPES = exports.TAGGED_PROP = exports.TAGGED = exports.MULTI_INJECT_TAG = exports.INJECT_TAG = exports.OPTIONAL_TAG = exports.UNMANAGED_TAG = exports.NAME_TAG = exports.NAMED_TAG = void 0;\r\nexports.NAMED_TAG = 'named';\r\nexports.NAME_TAG = 'name';\r\nexports.UNMANAGED_TAG = 'unmanaged';\r\nexports.OPTIONAL_TAG = 'optional';\r\nexports.INJECT_TAG = 'inject';\r\nexports.MULTI_INJECT_TAG = 'multi_inject';\r\nexports.TAGGED = 'inversify:tagged';\r\nexports.TAGGED_PROP = 'inversify:tagged_props';\r\nexports.PARAM_TYPES = 'inversify:paramtypes';\r\nexports.DESIGN_PARAM_TYPES = 'design:paramtypes';\r\nexports.POST_CONSTRUCT = 'post_construct';\r\nexports.PRE_DESTROY = 'pre_destroy';\r\nfunction getNonCustomTagKeys() {\r\n    return [\r\n        exports.INJECT_TAG,\r\n        exports.MULTI_INJECT_TAG,\r\n        exports.NAME_TAG,\r\n        exports.UNMANAGED_TAG,\r\n        exports.NAMED_TAG,\r\n        exports.OPTIONAL_TAG,\r\n    ];\r\n}\r\nexports.NON_CUSTOM_TAG_KEYS = getNonCustomTagKeys();\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.TargetTypeEnum = exports.BindingTypeEnum = exports.BindingScopeEnum = void 0;\r\nvar BindingScopeEnum = {\r\n    Request: 'Request',\r\n    Singleton: 'Singleton',\r\n    Transient: 'Transient'\r\n};\r\nexports.BindingScopeEnum = BindingScopeEnum;\r\nvar BindingTypeEnum = {\r\n    ConstantValue: 'ConstantValue',\r\n    Constructor: 'Constructor',\r\n    DynamicValue: 'DynamicValue',\r\n    Factory: 'Factory',\r\n    Function: 'Function',\r\n    Instance: 'Instance',\r\n    Invalid: 'Invalid',\r\n    Provider: 'Provider'\r\n};\r\nexports.BindingTypeEnum = BindingTypeEnum;\r\nvar TargetTypeEnum = {\r\n    ClassProperty: 'ClassProperty',\r\n    ConstructorArgument: 'ConstructorArgument',\r\n    Variable: 'Variable'\r\n};\r\nexports.TargetTypeEnum = TargetTypeEnum;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.id = void 0;\r\nvar idCounter = 0;\r\nfunction id() {\r\n    return idCounter++;\r\n}\r\nexports.id = id;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Binding = void 0;\r\nvar literal_types_1 = require(\"../constants/literal_types\");\r\nvar id_1 = require(\"../utils/id\");\r\nvar Binding = (function () {\r\n    function Binding(serviceIdentifier, scope) {\r\n        this.id = (0, id_1.id)();\r\n        this.activated = false;\r\n        this.serviceIdentifier = serviceIdentifier;\r\n        this.scope = scope;\r\n        this.type = literal_types_1.BindingTypeEnum.Invalid;\r\n        this.constraint = function (request) { return true; };\r\n        this.implementationType = null;\r\n        this.cache = null;\r\n        this.factory = null;\r\n        this.provider = null;\r\n        this.onActivation = null;\r\n        this.onDeactivation = null;\r\n        this.dynamicValue = null;\r\n    }\r\n    Binding.prototype.clone = function () {\r\n        var clone = new Binding(this.serviceIdentifier, this.scope);\r\n        clone.activated = (clone.scope === literal_types_1.BindingScopeEnum.Singleton) ? this.activated : false;\r\n        clone.implementationType = this.implementationType;\r\n        clone.dynamicValue = this.dynamicValue;\r\n        clone.scope = this.scope;\r\n        clone.type = this.type;\r\n        clone.factory = this.factory;\r\n        clone.provider = this.provider;\r\n        clone.constraint = this.constraint;\r\n        clone.onActivation = this.onActivation;\r\n        clone.onDeactivation = this.onDeactivation;\r\n        clone.cache = this.cache;\r\n        return clone;\r\n    };\r\n    return Binding;\r\n}());\r\nexports.Binding = Binding;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.STACK_OVERFLOW = exports.CIRCULAR_DEPENDENCY_IN_FACTORY = exports.ON_DEACTIVATION_ERROR = exports.PRE_DESTROY_ERROR = exports.POST_CONSTRUCT_ERROR = exports.ASYNC_UNBIND_REQUIRED = exports.MULTIPLE_POST_CONSTRUCT_METHODS = exports.MULTIPLE_PRE_DESTROY_METHODS = exports.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK = exports.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE = exports.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE = exports.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT = exports.ARGUMENTS_LENGTH_MISMATCH = exports.INVALID_DECORATOR_OPERATION = exports.INVALID_TO_SELF_VALUE = exports.LAZY_IN_SYNC = exports.INVALID_FUNCTION_BINDING = exports.INVALID_MIDDLEWARE_RETURN = exports.NO_MORE_SNAPSHOTS_AVAILABLE = exports.INVALID_BINDING_TYPE = exports.NOT_IMPLEMENTED = exports.CIRCULAR_DEPENDENCY = exports.UNDEFINED_INJECT_ANNOTATION = exports.MISSING_INJECT_ANNOTATION = exports.MISSING_INJECTABLE_ANNOTATION = exports.NOT_REGISTERED = exports.CANNOT_UNBIND = exports.AMBIGUOUS_MATCH = exports.KEY_NOT_FOUND = exports.NULL_ARGUMENT = exports.DUPLICATED_METADATA = exports.DUPLICATED_INJECTABLE_DECORATOR = void 0;\r\nexports.DUPLICATED_INJECTABLE_DECORATOR = 'Cannot apply @injectable decorator multiple times.';\r\nexports.DUPLICATED_METADATA = 'Metadata key was used more than once in a parameter:';\r\nexports.NULL_ARGUMENT = 'NULL argument';\r\nexports.KEY_NOT_FOUND = 'Key Not Found';\r\nexports.AMBIGUOUS_MATCH = 'Ambiguous match found for serviceIdentifier:';\r\nexports.CANNOT_UNBIND = 'Could not unbind serviceIdentifier:';\r\nexports.NOT_REGISTERED = 'No matching bindings found for serviceIdentifier:';\r\nexports.MISSING_INJECTABLE_ANNOTATION = 'Missing required @injectable annotation in:';\r\nexports.MISSING_INJECT_ANNOTATION = 'Missing required @inject or @multiInject annotation in:';\r\nvar UNDEFINED_INJECT_ANNOTATION = function (name) {\r\n    return \"@inject called with undefined this could mean that the class \" + name + \" has \" +\r\n        'a circular dependency problem. You can use a LazyServiceIdentifier to  ' +\r\n        'overcome this limitation.';\r\n};\r\nexports.UNDEFINED_INJECT_ANNOTATION = UNDEFINED_INJECT_ANNOTATION;\r\nexports.CIRCULAR_DEPENDENCY = 'Circular dependency found:';\r\nexports.NOT_IMPLEMENTED = 'Sorry, this feature is not fully implemented yet.';\r\nexports.INVALID_BINDING_TYPE = 'Invalid binding type:';\r\nexports.NO_MORE_SNAPSHOTS_AVAILABLE = 'No snapshot available to restore.';\r\nexports.INVALID_MIDDLEWARE_RETURN = 'Invalid return type in middleware. Middleware must return!';\r\nexports.INVALID_FUNCTION_BINDING = 'Value provided to function binding must be a function!';\r\nvar LAZY_IN_SYNC = function (key) { return \"You are attempting to construct '\" + key + \"' in a synchronous way\\n but it has asynchronous dependencies.\"; };\r\nexports.LAZY_IN_SYNC = LAZY_IN_SYNC;\r\nexports.INVALID_TO_SELF_VALUE = 'The toSelf function can only be applied when a constructor is ' +\r\n    'used as service identifier';\r\nexports.INVALID_DECORATOR_OPERATION = 'The @inject @multiInject @tagged and @named decorators ' +\r\n    'must be applied to the parameters of a class constructor or a class property.';\r\nvar ARGUMENTS_LENGTH_MISMATCH = function () {\r\n    var values = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        values[_i] = arguments[_i];\r\n    }\r\n    return 'The number of constructor arguments in the derived class ' +\r\n        (values[0] + \" must be >= than the number of constructor arguments of its base class.\");\r\n};\r\nexports.ARGUMENTS_LENGTH_MISMATCH = ARGUMENTS_LENGTH_MISMATCH;\r\nexports.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT = 'Invalid Container constructor argument. Container options ' +\r\n    'must be an object.';\r\nexports.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE = 'Invalid Container option. Default scope must ' +\r\n    'be a string (\"singleton\" or \"transient\").';\r\nexports.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE = 'Invalid Container option. Auto bind injectable must ' +\r\n    'be a boolean';\r\nexports.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK = 'Invalid Container option. Skip base check must ' +\r\n    'be a boolean';\r\nexports.MULTIPLE_PRE_DESTROY_METHODS = 'Cannot apply @preDestroy decorator multiple times in the same class';\r\nexports.MULTIPLE_POST_CONSTRUCT_METHODS = 'Cannot apply @postConstruct decorator multiple times in the same class';\r\nexports.ASYNC_UNBIND_REQUIRED = 'Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)';\r\nvar POST_CONSTRUCT_ERROR = function (clazz, errorMessage) { return \"@postConstruct error in class \" + clazz + \": \" + errorMessage; };\r\nexports.POST_CONSTRUCT_ERROR = POST_CONSTRUCT_ERROR;\r\nvar PRE_DESTROY_ERROR = function (clazz, errorMessage) { return \"@preDestroy error in class \" + clazz + \": \" + errorMessage; };\r\nexports.PRE_DESTROY_ERROR = PRE_DESTROY_ERROR;\r\nvar ON_DEACTIVATION_ERROR = function (clazz, errorMessage) { return \"onDeactivation() error in class \" + clazz + \": \" + errorMessage; };\r\nexports.ON_DEACTIVATION_ERROR = ON_DEACTIVATION_ERROR;\r\nvar CIRCULAR_DEPENDENCY_IN_FACTORY = function (factoryType, serviceIdentifier) {\r\n    return \"It looks like there is a circular dependency in one of the '\" + factoryType + \"' bindings. Please investigate bindings with \" +\r\n        (\"service identifier '\" + serviceIdentifier + \"'.\");\r\n};\r\nexports.CIRCULAR_DEPENDENCY_IN_FACTORY = CIRCULAR_DEPENDENCY_IN_FACTORY;\r\nexports.STACK_OVERFLOW = 'Maximum call stack size exceeded';\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.MetadataReader = void 0;\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar MetadataReader = (function () {\r\n    function MetadataReader() {\r\n    }\r\n    MetadataReader.prototype.getConstructorMetadata = function (constructorFunc) {\r\n        var compilerGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.PARAM_TYPES, constructorFunc);\r\n        var userGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.TAGGED, constructorFunc);\r\n        return {\r\n            compilerGeneratedMetadata: compilerGeneratedMetadata,\r\n            userGeneratedMetadata: userGeneratedMetadata || {}\r\n        };\r\n    };\r\n    MetadataReader.prototype.getPropertiesMetadata = function (constructorFunc) {\r\n        var userGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.TAGGED_PROP, constructorFunc) || [];\r\n        return userGeneratedMetadata;\r\n    };\r\n    return MetadataReader;\r\n}());\r\nexports.MetadataReader = MetadataReader;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BindingCount = void 0;\r\nexports.BindingCount = {\r\n    MultipleBindingsAvailable: 2,\r\n    NoBindingsAvailable: 0,\r\n    OnlyOneBindingAvailable: 1\r\n};\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.tryAndThrowErrorIfStackOverflow = exports.isStackOverflowExeption = void 0;\r\nvar ERROR_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nfunction isStackOverflowExeption(error) {\r\n    return (error instanceof RangeError ||\r\n        error.message === ERROR_MSGS.STACK_OVERFLOW);\r\n}\r\nexports.isStackOverflowExeption = isStackOverflowExeption;\r\nvar tryAndThrowErrorIfStackOverflow = function (fn, errorCallback) {\r\n    try {\r\n        return fn();\r\n    }\r\n    catch (error) {\r\n        if (isStackOverflowExeption(error)) {\r\n            error = errorCallback();\r\n        }\r\n        throw error;\r\n    }\r\n};\r\nexports.tryAndThrowErrorIfStackOverflow = tryAndThrowErrorIfStackOverflow;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getSymbolDescription = exports.circularDependencyToException = exports.listMetadataForTarget = exports.listRegisteredBindingsForServiceIdentifier = exports.getServiceIdentifierAsString = exports.getFunctionName = void 0;\r\nvar ERROR_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nfunction getServiceIdentifierAsString(serviceIdentifier) {\r\n    if (typeof serviceIdentifier === 'function') {\r\n        var _serviceIdentifier = serviceIdentifier;\r\n        return _serviceIdentifier.name;\r\n    }\r\n    else if (typeof serviceIdentifier === 'symbol') {\r\n        return serviceIdentifier.toString();\r\n    }\r\n    else {\r\n        var _serviceIdentifier = serviceIdentifier;\r\n        return _serviceIdentifier;\r\n    }\r\n}\r\nexports.getServiceIdentifierAsString = getServiceIdentifierAsString;\r\nfunction listRegisteredBindingsForServiceIdentifier(container, serviceIdentifier, getBindings) {\r\n    var registeredBindingsList = '';\r\n    var registeredBindings = getBindings(container, serviceIdentifier);\r\n    if (registeredBindings.length !== 0) {\r\n        registeredBindingsList = '\\nRegistered bindings:';\r\n        registeredBindings.forEach(function (binding) {\r\n            var name = 'Object';\r\n            if (binding.implementationType !== null) {\r\n                name = getFunctionName(binding.implementationType);\r\n            }\r\n            registeredBindingsList = registeredBindingsList + \"\\n \" + name;\r\n            if (binding.constraint.metaData) {\r\n                registeredBindingsList = registeredBindingsList + \" - \" + binding.constraint.metaData;\r\n            }\r\n        });\r\n    }\r\n    return registeredBindingsList;\r\n}\r\nexports.listRegisteredBindingsForServiceIdentifier = listRegisteredBindingsForServiceIdentifier;\r\nfunction alreadyDependencyChain(request, serviceIdentifier) {\r\n    if (request.parentRequest === null) {\r\n        return false;\r\n    }\r\n    else if (request.parentRequest.serviceIdentifier === serviceIdentifier) {\r\n        return true;\r\n    }\r\n    else {\r\n        return alreadyDependencyChain(request.parentRequest, serviceIdentifier);\r\n    }\r\n}\r\nfunction dependencyChainToString(request) {\r\n    function _createStringArr(req, result) {\r\n        if (result === void 0) { result = []; }\r\n        var serviceIdentifier = getServiceIdentifierAsString(req.serviceIdentifier);\r\n        result.push(serviceIdentifier);\r\n        if (req.parentRequest !== null) {\r\n            return _createStringArr(req.parentRequest, result);\r\n        }\r\n        return result;\r\n    }\r\n    var stringArr = _createStringArr(request);\r\n    return stringArr.reverse().join(' --> ');\r\n}\r\nfunction circularDependencyToException(request) {\r\n    request.childRequests.forEach(function (childRequest) {\r\n        if (alreadyDependencyChain(childRequest, childRequest.serviceIdentifier)) {\r\n            var services = dependencyChainToString(childRequest);\r\n            throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY + \" \" + services);\r\n        }\r\n        else {\r\n            circularDependencyToException(childRequest);\r\n        }\r\n    });\r\n}\r\nexports.circularDependencyToException = circularDependencyToException;\r\nfunction listMetadataForTarget(serviceIdentifierString, target) {\r\n    if (target.isTagged() || target.isNamed()) {\r\n        var m_1 = '';\r\n        var namedTag = target.getNamedTag();\r\n        var otherTags = target.getCustomTags();\r\n        if (namedTag !== null) {\r\n            m_1 += namedTag.toString() + '\\n';\r\n        }\r\n        if (otherTags !== null) {\r\n            otherTags.forEach(function (tag) {\r\n                m_1 += tag.toString() + '\\n';\r\n            });\r\n        }\r\n        return \" \" + serviceIdentifierString + \"\\n \" + serviceIdentifierString + \" - \" + m_1;\r\n    }\r\n    else {\r\n        return \" \" + serviceIdentifierString;\r\n    }\r\n}\r\nexports.listMetadataForTarget = listMetadataForTarget;\r\nfunction getFunctionName(func) {\r\n    if (func.name) {\r\n        return func.name;\r\n    }\r\n    else {\r\n        var name_1 = func.toString();\r\n        var match = name_1.match(/^function\\s*([^\\s(]+)/);\r\n        return match ? match[1] : \"Anonymous function: \" + name_1;\r\n    }\r\n}\r\nexports.getFunctionName = getFunctionName;\r\nfunction getSymbolDescription(symbol) {\r\n    return symbol.toString().slice(7, -1);\r\n}\r\nexports.getSymbolDescription = getSymbolDescription;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Context = void 0;\r\nvar id_1 = require(\"../utils/id\");\r\nvar Context = (function () {\r\n    function Context(container) {\r\n        this.id = (0, id_1.id)();\r\n        this.container = container;\r\n    }\r\n    Context.prototype.addPlan = function (plan) {\r\n        this.plan = plan;\r\n    };\r\n    Context.prototype.setCurrentRequest = function (currentRequest) {\r\n        this.currentRequest = currentRequest;\r\n    };\r\n    return Context;\r\n}());\r\nexports.Context = Context;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Metadata = void 0;\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar Metadata = (function () {\r\n    function Metadata(key, value) {\r\n        this.key = key;\r\n        this.value = value;\r\n    }\r\n    Metadata.prototype.toString = function () {\r\n        if (this.key === METADATA_KEY.NAMED_TAG) {\r\n            return \"named: \" + String(this.value).toString() + \" \";\r\n        }\r\n        else {\r\n            return \"tagged: { key:\" + this.key.toString() + \", value: \" + String(this.value) + \" }\";\r\n        }\r\n    };\r\n    return Metadata;\r\n}());\r\nexports.Metadata = Metadata;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Plan = void 0;\r\nvar Plan = (function () {\r\n    function Plan(parentContext, rootRequest) {\r\n        this.parentContext = parentContext;\r\n        this.rootRequest = rootRequest;\r\n    }\r\n    return Plan;\r\n}());\r\nexports.Plan = Plan;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.LazyServiceIdentifier = void 0;\r\nvar LazyServiceIdentifier = (function () {\r\n    function LazyServiceIdentifier(cb) {\r\n        this._cb = cb;\r\n    }\r\n    LazyServiceIdentifier.prototype.unwrap = function () {\r\n        return this._cb();\r\n    };\r\n    return LazyServiceIdentifier;\r\n}());\r\nexports.LazyServiceIdentifier = LazyServiceIdentifier;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.QueryableString = void 0;\r\nvar QueryableString = (function () {\r\n    function QueryableString(str) {\r\n        this.str = str;\r\n    }\r\n    QueryableString.prototype.startsWith = function (searchString) {\r\n        return this.str.indexOf(searchString) === 0;\r\n    };\r\n    QueryableString.prototype.endsWith = function (searchString) {\r\n        var reverseString = '';\r\n        var reverseSearchString = searchString.split('').reverse().join('');\r\n        reverseString = this.str.split('').reverse().join('');\r\n        return this.startsWith.call({ str: reverseString }, reverseSearchString);\r\n    };\r\n    QueryableString.prototype.contains = function (searchString) {\r\n        return (this.str.indexOf(searchString) !== -1);\r\n    };\r\n    QueryableString.prototype.equals = function (compareString) {\r\n        return this.str === compareString;\r\n    };\r\n    QueryableString.prototype.value = function () {\r\n        return this.str;\r\n    };\r\n    return QueryableString;\r\n}());\r\nexports.QueryableString = QueryableString;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Target = void 0;\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar id_1 = require(\"../utils/id\");\r\nvar serialization_1 = require(\"../utils/serialization\");\r\nvar metadata_1 = require(\"./metadata\");\r\nvar queryable_string_1 = require(\"./queryable_string\");\r\nvar Target = (function () {\r\n    function Target(type, identifier, serviceIdentifier, namedOrTagged) {\r\n        this.id = (0, id_1.id)();\r\n        this.type = type;\r\n        this.serviceIdentifier = serviceIdentifier;\r\n        var queryableName = typeof identifier === 'symbol' ? (0, serialization_1.getSymbolDescription)(identifier) : identifier;\r\n        this.name = new queryable_string_1.QueryableString(queryableName || '');\r\n        this.identifier = identifier;\r\n        this.metadata = new Array();\r\n        var metadataItem = null;\r\n        if (typeof namedOrTagged === 'string') {\r\n            metadataItem = new metadata_1.Metadata(METADATA_KEY.NAMED_TAG, namedOrTagged);\r\n        }\r\n        else if (namedOrTagged instanceof metadata_1.Metadata) {\r\n            metadataItem = namedOrTagged;\r\n        }\r\n        if (metadataItem !== null) {\r\n            this.metadata.push(metadataItem);\r\n        }\r\n    }\r\n    Target.prototype.hasTag = function (key) {\r\n        for (var _i = 0, _a = this.metadata; _i < _a.length; _i++) {\r\n            var m = _a[_i];\r\n            if (m.key === key) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    Target.prototype.isArray = function () {\r\n        return this.hasTag(METADATA_KEY.MULTI_INJECT_TAG);\r\n    };\r\n    Target.prototype.matchesArray = function (name) {\r\n        return this.matchesTag(METADATA_KEY.MULTI_INJECT_TAG)(name);\r\n    };\r\n    Target.prototype.isNamed = function () {\r\n        return this.hasTag(METADATA_KEY.NAMED_TAG);\r\n    };\r\n    Target.prototype.isTagged = function () {\r\n        return this.metadata.some(function (metadata) { return METADATA_KEY.NON_CUSTOM_TAG_KEYS.every(function (key) { return metadata.key !== key; }); });\r\n    };\r\n    Target.prototype.isOptional = function () {\r\n        return this.matchesTag(METADATA_KEY.OPTIONAL_TAG)(true);\r\n    };\r\n    Target.prototype.getNamedTag = function () {\r\n        if (this.isNamed()) {\r\n            return this.metadata.filter(function (m) { return m.key === METADATA_KEY.NAMED_TAG; })[0];\r\n        }\r\n        return null;\r\n    };\r\n    Target.prototype.getCustomTags = function () {\r\n        if (this.isTagged()) {\r\n            return this.metadata.filter(function (metadata) { return METADATA_KEY.NON_CUSTOM_TAG_KEYS.every(function (key) { return metadata.key !== key; }); });\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    };\r\n    Target.prototype.matchesNamedTag = function (name) {\r\n        return this.matchesTag(METADATA_KEY.NAMED_TAG)(name);\r\n    };\r\n    Target.prototype.matchesTag = function (key) {\r\n        var _this = this;\r\n        return function (value) {\r\n            for (var _i = 0, _a = _this.metadata; _i < _a.length; _i++) {\r\n                var m = _a[_i];\r\n                if (m.key === key && m.value === value) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n    };\r\n    return Target;\r\n}());\r\nexports.Target = Target;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getFunctionName = exports.getBaseClassDependencyCount = exports.getDependencies = void 0;\r\nvar lazy_service_identifier_1 = require(\"../annotation/lazy_service_identifier\");\r\nvar ERROR_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar literal_types_1 = require(\"../constants/literal_types\");\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar serialization_1 = require(\"../utils/serialization\");\r\nObject.defineProperty(exports, \"getFunctionName\", { enumerable: true, get: function () { return serialization_1.getFunctionName; } });\r\nvar target_1 = require(\"./target\");\r\nfunction getDependencies(metadataReader, func) {\r\n    var constructorName = (0, serialization_1.getFunctionName)(func);\r\n    return getTargets(metadataReader, constructorName, func, false);\r\n}\r\nexports.getDependencies = getDependencies;\r\nfunction getTargets(metadataReader, constructorName, func, isBaseClass) {\r\n    var metadata = metadataReader.getConstructorMetadata(func);\r\n    var serviceIdentifiers = metadata.compilerGeneratedMetadata;\r\n    if (serviceIdentifiers === undefined) {\r\n        var msg = ERROR_MSGS.MISSING_INJECTABLE_ANNOTATION + \" \" + constructorName + \".\";\r\n        throw new Error(msg);\r\n    }\r\n    var constructorArgsMetadata = metadata.userGeneratedMetadata;\r\n    var keys = Object.keys(constructorArgsMetadata);\r\n    var hasUserDeclaredUnknownInjections = (func.length === 0 && keys.length > 0);\r\n    var hasOptionalParameters = keys.length > func.length;\r\n    var iterations = (hasUserDeclaredUnknownInjections || hasOptionalParameters) ? keys.length : func.length;\r\n    var constructorTargets = getConstructorArgsAsTargets(isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata, iterations);\r\n    var propertyTargets = getClassPropsAsTargets(metadataReader, func, constructorName);\r\n    var targets = __spreadArray(__spreadArray([], constructorTargets, true), propertyTargets, true);\r\n    return targets;\r\n}\r\nfunction getConstructorArgsAsTarget(index, isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata) {\r\n    var targetMetadata = constructorArgsMetadata[index.toString()] || [];\r\n    var metadata = formatTargetMetadata(targetMetadata);\r\n    var isManaged = metadata.unmanaged !== true;\r\n    var serviceIdentifier = serviceIdentifiers[index];\r\n    var injectIdentifier = metadata.inject || metadata.multiInject;\r\n    serviceIdentifier = (injectIdentifier ? injectIdentifier : serviceIdentifier);\r\n    if (serviceIdentifier instanceof lazy_service_identifier_1.LazyServiceIdentifier) {\r\n        serviceIdentifier = serviceIdentifier.unwrap();\r\n    }\r\n    if (isManaged) {\r\n        var isObject = serviceIdentifier === Object;\r\n        var isFunction = serviceIdentifier === Function;\r\n        var isUndefined = serviceIdentifier === undefined;\r\n        var isUnknownType = isObject || isFunction || isUndefined;\r\n        if (!isBaseClass && isUnknownType) {\r\n            var msg = ERROR_MSGS.MISSING_INJECT_ANNOTATION + \" argument \" + index + \" in class \" + constructorName + \".\";\r\n            throw new Error(msg);\r\n        }\r\n        var target = new target_1.Target(literal_types_1.TargetTypeEnum.ConstructorArgument, metadata.targetName, serviceIdentifier);\r\n        target.metadata = targetMetadata;\r\n        return target;\r\n    }\r\n    return null;\r\n}\r\nfunction getConstructorArgsAsTargets(isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata, iterations) {\r\n    var targets = [];\r\n    for (var i = 0; i < iterations; i++) {\r\n        var index = i;\r\n        var target = getConstructorArgsAsTarget(index, isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata);\r\n        if (target !== null) {\r\n            targets.push(target);\r\n        }\r\n    }\r\n    return targets;\r\n}\r\nfunction _getServiceIdentifierForProperty(inject, multiInject, propertyName, className) {\r\n    var serviceIdentifier = (inject || multiInject);\r\n    if (serviceIdentifier === undefined) {\r\n        var msg = ERROR_MSGS.MISSING_INJECTABLE_ANNOTATION + \" for property \" + String(propertyName) + \" in class \" + className + \".\";\r\n        throw new Error(msg);\r\n    }\r\n    return serviceIdentifier;\r\n}\r\nfunction getClassPropsAsTargets(metadataReader, constructorFunc, constructorName) {\r\n    var classPropsMetadata = metadataReader.getPropertiesMetadata(constructorFunc);\r\n    var targets = [];\r\n    var symbolKeys = Object.getOwnPropertySymbols(classPropsMetadata);\r\n    var stringKeys = Object.keys(classPropsMetadata);\r\n    var keys = stringKeys.concat(symbolKeys);\r\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n        var key = keys_1[_i];\r\n        var targetMetadata = classPropsMetadata[key];\r\n        var metadata = formatTargetMetadata(targetMetadata);\r\n        var identifier = metadata.targetName || key;\r\n        var serviceIdentifier = _getServiceIdentifierForProperty(metadata.inject, metadata.multiInject, key, constructorName);\r\n        var target = new target_1.Target(literal_types_1.TargetTypeEnum.ClassProperty, identifier, serviceIdentifier);\r\n        target.metadata = targetMetadata;\r\n        targets.push(target);\r\n    }\r\n    var baseConstructor = Object.getPrototypeOf(constructorFunc.prototype).constructor;\r\n    if (baseConstructor !== Object) {\r\n        var baseTargets = getClassPropsAsTargets(metadataReader, baseConstructor, constructorName);\r\n        targets = __spreadArray(__spreadArray([], targets, true), baseTargets, true);\r\n    }\r\n    return targets;\r\n}\r\nfunction getBaseClassDependencyCount(metadataReader, func) {\r\n    var baseConstructor = Object.getPrototypeOf(func.prototype).constructor;\r\n    if (baseConstructor !== Object) {\r\n        var baseConstructorName = (0, serialization_1.getFunctionName)(baseConstructor);\r\n        var targets = getTargets(metadataReader, baseConstructorName, baseConstructor, true);\r\n        var metadata = targets.map(function (t) { return t.metadata.filter(function (m) { return m.key === METADATA_KEY.UNMANAGED_TAG; }); });\r\n        var unmanagedCount = [].concat.apply([], metadata).length;\r\n        var dependencyCount = targets.length - unmanagedCount;\r\n        if (dependencyCount > 0) {\r\n            return dependencyCount;\r\n        }\r\n        else {\r\n            return getBaseClassDependencyCount(metadataReader, baseConstructor);\r\n        }\r\n    }\r\n    else {\r\n        return 0;\r\n    }\r\n}\r\nexports.getBaseClassDependencyCount = getBaseClassDependencyCount;\r\nfunction formatTargetMetadata(targetMetadata) {\r\n    var targetMetadataMap = {};\r\n    targetMetadata.forEach(function (m) {\r\n        targetMetadataMap[m.key.toString()] = m.value;\r\n    });\r\n    return {\r\n        inject: targetMetadataMap[METADATA_KEY.INJECT_TAG],\r\n        multiInject: targetMetadataMap[METADATA_KEY.MULTI_INJECT_TAG],\r\n        targetName: targetMetadataMap[METADATA_KEY.NAME_TAG],\r\n        unmanaged: targetMetadataMap[METADATA_KEY.UNMANAGED_TAG]\r\n    };\r\n}\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Request = void 0;\r\nvar id_1 = require(\"../utils/id\");\r\nvar Request = (function () {\r\n    function Request(serviceIdentifier, parentContext, parentRequest, bindings, target) {\r\n        this.id = (0, id_1.id)();\r\n        this.serviceIdentifier = serviceIdentifier;\r\n        this.parentContext = parentContext;\r\n        this.parentRequest = parentRequest;\r\n        this.target = target;\r\n        this.childRequests = [];\r\n        this.bindings = (Array.isArray(bindings) ? bindings : [bindings]);\r\n        this.requestScope = parentRequest === null\r\n            ? new Map()\r\n            : null;\r\n    }\r\n    Request.prototype.addChildRequest = function (serviceIdentifier, bindings, target) {\r\n        var child = new Request(serviceIdentifier, this.parentContext, this, bindings, target);\r\n        this.childRequests.push(child);\r\n        return child;\r\n    };\r\n    return Request;\r\n}());\r\nexports.Request = Request;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getBindingDictionary = exports.createMockRequest = exports.plan = void 0;\r\nvar binding_count_1 = require(\"../bindings/binding_count\");\r\nvar ERROR_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar literal_types_1 = require(\"../constants/literal_types\");\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar exceptions_1 = require(\"../utils/exceptions\");\r\nvar serialization_1 = require(\"../utils/serialization\");\r\nvar context_1 = require(\"./context\");\r\nvar metadata_1 = require(\"./metadata\");\r\nvar plan_1 = require(\"./plan\");\r\nvar reflection_utils_1 = require(\"./reflection_utils\");\r\nvar request_1 = require(\"./request\");\r\nvar target_1 = require(\"./target\");\r\nfunction getBindingDictionary(cntnr) {\r\n    return cntnr._bindingDictionary;\r\n}\r\nexports.getBindingDictionary = getBindingDictionary;\r\nfunction _createTarget(isMultiInject, targetType, serviceIdentifier, name, key, value) {\r\n    var metadataKey = isMultiInject ? METADATA_KEY.MULTI_INJECT_TAG : METADATA_KEY.INJECT_TAG;\r\n    var injectMetadata = new metadata_1.Metadata(metadataKey, serviceIdentifier);\r\n    var target = new target_1.Target(targetType, name, serviceIdentifier, injectMetadata);\r\n    if (key !== undefined) {\r\n        var tagMetadata = new metadata_1.Metadata(key, value);\r\n        target.metadata.push(tagMetadata);\r\n    }\r\n    return target;\r\n}\r\nfunction _getActiveBindings(metadataReader, avoidConstraints, context, parentRequest, target) {\r\n    var bindings = getBindings(context.container, target.serviceIdentifier);\r\n    var activeBindings = [];\r\n    if (bindings.length === binding_count_1.BindingCount.NoBindingsAvailable &&\r\n        context.container.options.autoBindInjectable &&\r\n        typeof target.serviceIdentifier === 'function' &&\r\n        metadataReader.getConstructorMetadata(target.serviceIdentifier).compilerGeneratedMetadata) {\r\n        context.container.bind(target.serviceIdentifier).toSelf();\r\n        bindings = getBindings(context.container, target.serviceIdentifier);\r\n    }\r\n    if (!avoidConstraints) {\r\n        activeBindings = bindings.filter(function (binding) {\r\n            var request = new request_1.Request(binding.serviceIdentifier, context, parentRequest, binding, target);\r\n            return binding.constraint(request);\r\n        });\r\n    }\r\n    else {\r\n        activeBindings = bindings;\r\n    }\r\n    _validateActiveBindingCount(target.serviceIdentifier, activeBindings, target, context.container);\r\n    return activeBindings;\r\n}\r\nfunction _validateActiveBindingCount(serviceIdentifier, bindings, target, container) {\r\n    switch (bindings.length) {\r\n        case binding_count_1.BindingCount.NoBindingsAvailable:\r\n            if (target.isOptional()) {\r\n                return bindings;\r\n            }\r\n            else {\r\n                var serviceIdentifierString = (0, serialization_1.getServiceIdentifierAsString)(serviceIdentifier);\r\n                var msg = ERROR_MSGS.NOT_REGISTERED;\r\n                msg += (0, serialization_1.listMetadataForTarget)(serviceIdentifierString, target);\r\n                msg += (0, serialization_1.listRegisteredBindingsForServiceIdentifier)(container, serviceIdentifierString, getBindings);\r\n                throw new Error(msg);\r\n            }\r\n        case binding_count_1.BindingCount.OnlyOneBindingAvailable:\r\n            return bindings;\r\n        case binding_count_1.BindingCount.MultipleBindingsAvailable:\r\n        default:\r\n            if (!target.isArray()) {\r\n                var serviceIdentifierString = (0, serialization_1.getServiceIdentifierAsString)(serviceIdentifier);\r\n                var msg = ERROR_MSGS.AMBIGUOUS_MATCH + \" \" + serviceIdentifierString;\r\n                msg += (0, serialization_1.listRegisteredBindingsForServiceIdentifier)(container, serviceIdentifierString, getBindings);\r\n                throw new Error(msg);\r\n            }\r\n            else {\r\n                return bindings;\r\n            }\r\n    }\r\n}\r\nfunction _createSubRequests(metadataReader, avoidConstraints, serviceIdentifier, context, parentRequest, target) {\r\n    var activeBindings;\r\n    var childRequest;\r\n    if (parentRequest === null) {\r\n        activeBindings = _getActiveBindings(metadataReader, avoidConstraints, context, null, target);\r\n        childRequest = new request_1.Request(serviceIdentifier, context, null, activeBindings, target);\r\n        var thePlan = new plan_1.Plan(context, childRequest);\r\n        context.addPlan(thePlan);\r\n    }\r\n    else {\r\n        activeBindings = _getActiveBindings(metadataReader, avoidConstraints, context, parentRequest, target);\r\n        childRequest = parentRequest.addChildRequest(target.serviceIdentifier, activeBindings, target);\r\n    }\r\n    activeBindings.forEach(function (binding) {\r\n        var subChildRequest = null;\r\n        if (target.isArray()) {\r\n            subChildRequest = childRequest.addChildRequest(binding.serviceIdentifier, binding, target);\r\n        }\r\n        else {\r\n            if (binding.cache) {\r\n                return;\r\n            }\r\n            subChildRequest = childRequest;\r\n        }\r\n        if (binding.type === literal_types_1.BindingTypeEnum.Instance && binding.implementationType !== null) {\r\n            var dependencies = (0, reflection_utils_1.getDependencies)(metadataReader, binding.implementationType);\r\n            if (!context.container.options.skipBaseClassChecks) {\r\n                var baseClassDependencyCount = (0, reflection_utils_1.getBaseClassDependencyCount)(metadataReader, binding.implementationType);\r\n                if (dependencies.length < baseClassDependencyCount) {\r\n                    var error = ERROR_MSGS.ARGUMENTS_LENGTH_MISMATCH((0, reflection_utils_1.getFunctionName)(binding.implementationType));\r\n                    throw new Error(error);\r\n                }\r\n            }\r\n            dependencies.forEach(function (dependency) {\r\n                _createSubRequests(metadataReader, false, dependency.serviceIdentifier, context, subChildRequest, dependency);\r\n            });\r\n        }\r\n    });\r\n}\r\nfunction getBindings(container, serviceIdentifier) {\r\n    var bindings = [];\r\n    var bindingDictionary = getBindingDictionary(container);\r\n    if (bindingDictionary.hasKey(serviceIdentifier)) {\r\n        bindings = bindingDictionary.get(serviceIdentifier);\r\n    }\r\n    else if (container.parent !== null) {\r\n        bindings = getBindings(container.parent, serviceIdentifier);\r\n    }\r\n    return bindings;\r\n}\r\nfunction plan(metadataReader, container, isMultiInject, targetType, serviceIdentifier, key, value, avoidConstraints) {\r\n    if (avoidConstraints === void 0) { avoidConstraints = false; }\r\n    var context = new context_1.Context(container);\r\n    var target = _createTarget(isMultiInject, targetType, serviceIdentifier, '', key, value);\r\n    try {\r\n        _createSubRequests(metadataReader, avoidConstraints, serviceIdentifier, context, null, target);\r\n        return context;\r\n    }\r\n    catch (error) {\r\n        if ((0, exceptions_1.isStackOverflowExeption)(error)) {\r\n            (0, serialization_1.circularDependencyToException)(context.plan.rootRequest);\r\n        }\r\n        throw error;\r\n    }\r\n}\r\nexports.plan = plan;\r\nfunction createMockRequest(container, serviceIdentifier, key, value) {\r\n    var target = new target_1.Target(literal_types_1.TargetTypeEnum.Variable, '', serviceIdentifier, new metadata_1.Metadata(key, value));\r\n    var context = new context_1.Context(container);\r\n    var request = new request_1.Request(serviceIdentifier, context, null, [], target);\r\n    return request;\r\n}\r\nexports.createMockRequest = createMockRequest;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.isPromiseOrContainsPromise = exports.isPromise = void 0;\r\nfunction isPromise(object) {\r\n    var isObjectOrFunction = (typeof object === 'object' && object !== null) || typeof object === 'function';\r\n    return isObjectOrFunction && typeof object.then === \"function\";\r\n}\r\nexports.isPromise = isPromise;\r\nfunction isPromiseOrContainsPromise(object) {\r\n    if (isPromise(object)) {\r\n        return true;\r\n    }\r\n    return Array.isArray(object) && object.some(isPromise);\r\n}\r\nexports.isPromiseOrContainsPromise = isPromiseOrContainsPromise;\r\n", "\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.saveToScope = exports.tryGetFromScope = void 0;\r\nvar literal_types_1 = require(\"../constants/literal_types\");\r\nvar async_1 = require(\"../utils/async\");\r\nvar tryGetFromScope = function (requestScope, binding) {\r\n    if ((binding.scope === literal_types_1.BindingScopeEnum.Singleton) && binding.activated) {\r\n        return binding.cache;\r\n    }\r\n    if (binding.scope === literal_types_1.BindingScopeEnum.Request &&\r\n        requestScope.has(binding.id)) {\r\n        return requestScope.get(binding.id);\r\n    }\r\n    return null;\r\n};\r\nexports.tryGetFromScope = tryGetFromScope;\r\nvar saveToScope = function (requestScope, binding, result) {\r\n    if (binding.scope === literal_types_1.BindingScopeEnum.Singleton) {\r\n        _saveToSingletonScope(binding, result);\r\n    }\r\n    if (binding.scope === literal_types_1.BindingScopeEnum.Request) {\r\n        _saveToRequestScope(requestScope, binding, result);\r\n    }\r\n};\r\nexports.saveToScope = saveToScope;\r\nvar _saveToRequestScope = function (requestScope, binding, result) {\r\n    if (!requestScope.has(binding.id)) {\r\n        requestScope.set(binding.id, result);\r\n    }\r\n};\r\nvar _saveToSingletonScope = function (binding, result) {\r\n    binding.cache = result;\r\n    binding.activated = true;\r\n    if ((0, async_1.isPromise)(result)) {\r\n        void _saveAsyncResultToSingletonScope(binding, result);\r\n    }\r\n};\r\nvar _saveAsyncResultToSingletonScope = function (binding, asyncResult) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var result, ex_1;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0:\r\n                _a.trys.push([0, 2, , 3]);\r\n                return [4, asyncResult];\r\n            case 1:\r\n                result = _a.sent();\r\n                binding.cache = result;\r\n                return [3, 3];\r\n            case 2:\r\n                ex_1 = _a.sent();\r\n                binding.cache = null;\r\n                binding.activated = false;\r\n                throw ex_1;\r\n            case 3: return [2];\r\n        }\r\n    });\r\n}); };\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.FactoryType = void 0;\r\nvar FactoryType;\r\n(function (FactoryType) {\r\n    FactoryType[\"DynamicValue\"] = \"toDynamicValue\";\r\n    FactoryType[\"Factory\"] = \"toFactory\";\r\n    FactoryType[\"Provider\"] = \"toProvider\";\r\n})(FactoryType = exports.FactoryType || (exports.FactoryType = {}));\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getFactoryDetails = exports.ensureFullyBound = exports.multiBindToService = void 0;\r\nvar serialization_1 = require(\"../utils/serialization\");\r\nvar ERROR_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar literal_types_1 = require(\"../constants/literal_types\");\r\nvar factory_type_1 = require(\"./factory_type\");\r\nvar multiBindToService = function (container) {\r\n    return function (service) {\r\n        return function () {\r\n            var types = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                types[_i] = arguments[_i];\r\n            }\r\n            return types.forEach(function (t) { return container.bind(t).toService(service); });\r\n        };\r\n    };\r\n};\r\nexports.multiBindToService = multiBindToService;\r\nvar ensureFullyBound = function (binding) {\r\n    var boundValue = null;\r\n    switch (binding.type) {\r\n        case literal_types_1.BindingTypeEnum.ConstantValue:\r\n        case literal_types_1.BindingTypeEnum.Function:\r\n            boundValue = binding.cache;\r\n            break;\r\n        case literal_types_1.BindingTypeEnum.Constructor:\r\n        case literal_types_1.BindingTypeEnum.Instance:\r\n            boundValue = binding.implementationType;\r\n            break;\r\n        case literal_types_1.BindingTypeEnum.DynamicValue:\r\n            boundValue = binding.dynamicValue;\r\n            break;\r\n        case literal_types_1.BindingTypeEnum.Provider:\r\n            boundValue = binding.provider;\r\n            break;\r\n        case literal_types_1.BindingTypeEnum.Factory:\r\n            boundValue = binding.factory;\r\n            break;\r\n    }\r\n    if (boundValue === null) {\r\n        var serviceIdentifierAsString = (0, serialization_1.getServiceIdentifierAsString)(binding.serviceIdentifier);\r\n        throw new Error(ERROR_MSGS.INVALID_BINDING_TYPE + \" \" + serviceIdentifierAsString);\r\n    }\r\n};\r\nexports.ensureFullyBound = ensureFullyBound;\r\nvar getFactoryDetails = function (binding) {\r\n    switch (binding.type) {\r\n        case literal_types_1.BindingTypeEnum.Factory:\r\n            return { factory: binding.factory, factoryType: factory_type_1.FactoryType.Factory };\r\n        case literal_types_1.BindingTypeEnum.Provider:\r\n            return { factory: binding.provider, factoryType: factory_type_1.FactoryType.Provider };\r\n        case literal_types_1.BindingTypeEnum.DynamicValue:\r\n            return { factory: binding.dynamicValue, factoryType: factory_type_1.FactoryType.DynamicValue };\r\n        default:\r\n            throw new Error(\"Unexpected factory type \" + binding.type);\r\n    }\r\n};\r\nexports.getFactoryDetails = getFactoryDetails;\r\n", "\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.resolveInstance = void 0;\r\nvar error_msgs_1 = require(\"../constants/error_msgs\");\r\nvar literal_types_1 = require(\"../constants/literal_types\");\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar async_1 = require(\"../utils/async\");\r\nfunction _resolveRequests(childRequests, resolveRequest) {\r\n    return childRequests.reduce(function (resolvedRequests, childRequest) {\r\n        var injection = resolveRequest(childRequest);\r\n        var targetType = childRequest.target.type;\r\n        if (targetType === literal_types_1.TargetTypeEnum.ConstructorArgument) {\r\n            resolvedRequests.constructorInjections.push(injection);\r\n        }\r\n        else {\r\n            resolvedRequests.propertyRequests.push(childRequest);\r\n            resolvedRequests.propertyInjections.push(injection);\r\n        }\r\n        if (!resolvedRequests.isAsync) {\r\n            resolvedRequests.isAsync = (0, async_1.isPromiseOrContainsPromise)(injection);\r\n        }\r\n        return resolvedRequests;\r\n    }, { constructorInjections: [], propertyInjections: [], propertyRequests: [], isAsync: false });\r\n}\r\nfunction _createInstance(constr, childRequests, resolveRequest) {\r\n    var result;\r\n    if (childRequests.length > 0) {\r\n        var resolved = _resolveRequests(childRequests, resolveRequest);\r\n        var createInstanceWithInjectionsArg = __assign(__assign({}, resolved), { constr: constr });\r\n        if (resolved.isAsync) {\r\n            result = createInstanceWithInjectionsAsync(createInstanceWithInjectionsArg);\r\n        }\r\n        else {\r\n            result = createInstanceWithInjections(createInstanceWithInjectionsArg);\r\n        }\r\n    }\r\n    else {\r\n        result = new constr();\r\n    }\r\n    return result;\r\n}\r\nfunction createInstanceWithInjections(args) {\r\n    var _a;\r\n    var instance = new ((_a = args.constr).bind.apply(_a, __spreadArray([void 0], args.constructorInjections, false)))();\r\n    args.propertyRequests.forEach(function (r, index) {\r\n        var property = r.target.identifier;\r\n        var injection = args.propertyInjections[index];\r\n        if (!r.target.isOptional() || injection !== undefined) {\r\n            instance[property] = injection;\r\n        }\r\n    });\r\n    return instance;\r\n}\r\nfunction createInstanceWithInjectionsAsync(args) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var constructorInjections, propertyInjections;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4, possiblyWaitInjections(args.constructorInjections)];\r\n                case 1:\r\n                    constructorInjections = _a.sent();\r\n                    return [4, possiblyWaitInjections(args.propertyInjections)];\r\n                case 2:\r\n                    propertyInjections = _a.sent();\r\n                    return [2, createInstanceWithInjections(__assign(__assign({}, args), { constructorInjections: constructorInjections, propertyInjections: propertyInjections }))];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction possiblyWaitInjections(possiblePromiseinjections) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var injections, _i, possiblePromiseinjections_1, injection;\r\n        return __generator(this, function (_a) {\r\n            injections = [];\r\n            for (_i = 0, possiblePromiseinjections_1 = possiblePromiseinjections; _i < possiblePromiseinjections_1.length; _i++) {\r\n                injection = possiblePromiseinjections_1[_i];\r\n                if (Array.isArray(injection)) {\r\n                    injections.push(Promise.all(injection));\r\n                }\r\n                else {\r\n                    injections.push(injection);\r\n                }\r\n            }\r\n            return [2, Promise.all(injections)];\r\n        });\r\n    });\r\n}\r\nfunction _getInstanceAfterPostConstruct(constr, result) {\r\n    var postConstructResult = _postConstruct(constr, result);\r\n    if ((0, async_1.isPromise)(postConstructResult)) {\r\n        return postConstructResult.then(function () { return result; });\r\n    }\r\n    else {\r\n        return result;\r\n    }\r\n}\r\nfunction _postConstruct(constr, instance) {\r\n    var _a, _b;\r\n    if (Reflect.hasMetadata(METADATA_KEY.POST_CONSTRUCT, constr)) {\r\n        var data = Reflect.getMetadata(METADATA_KEY.POST_CONSTRUCT, constr);\r\n        try {\r\n            return (_b = (_a = instance)[data.value]) === null || _b === void 0 ? void 0 : _b.call(_a);\r\n        }\r\n        catch (e) {\r\n            if (e instanceof Error) {\r\n                throw new Error((0, error_msgs_1.POST_CONSTRUCT_ERROR)(constr.name, e.message));\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction _validateInstanceResolution(binding, constr) {\r\n    if (binding.scope !== literal_types_1.BindingScopeEnum.Singleton) {\r\n        _throwIfHandlingDeactivation(binding, constr);\r\n    }\r\n}\r\nfunction _throwIfHandlingDeactivation(binding, constr) {\r\n    var scopeErrorMessage = \"Class cannot be instantiated in \" + (binding.scope === literal_types_1.BindingScopeEnum.Request ?\r\n        'request' :\r\n        'transient') + \" scope.\";\r\n    if (typeof binding.onDeactivation === 'function') {\r\n        throw new Error((0, error_msgs_1.ON_DEACTIVATION_ERROR)(constr.name, scopeErrorMessage));\r\n    }\r\n    if (Reflect.hasMetadata(METADATA_KEY.PRE_DESTROY, constr)) {\r\n        throw new Error((0, error_msgs_1.PRE_DESTROY_ERROR)(constr.name, scopeErrorMessage));\r\n    }\r\n}\r\nfunction resolveInstance(binding, constr, childRequests, resolveRequest) {\r\n    _validateInstanceResolution(binding, constr);\r\n    var result = _createInstance(constr, childRequests, resolveRequest);\r\n    if ((0, async_1.isPromise)(result)) {\r\n        return result.then(function (resolvedResult) { return _getInstanceAfterPostConstruct(constr, resolvedResult); });\r\n    }\r\n    else {\r\n        return _getInstanceAfterPostConstruct(constr, result);\r\n    }\r\n}\r\nexports.resolveInstance = resolveInstance;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.resolve = void 0;\r\nvar ERROR_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar literal_types_1 = require(\"../constants/literal_types\");\r\nvar planner_1 = require(\"../planning/planner\");\r\nvar scope_1 = require(\"../scope/scope\");\r\nvar async_1 = require(\"../utils/async\");\r\nvar binding_utils_1 = require(\"../utils/binding_utils\");\r\nvar exceptions_1 = require(\"../utils/exceptions\");\r\nvar instantiation_1 = require(\"./instantiation\");\r\nvar _resolveRequest = function (requestScope) {\r\n    return function (request) {\r\n        request.parentContext.setCurrentRequest(request);\r\n        var bindings = request.bindings;\r\n        var childRequests = request.childRequests;\r\n        var targetIsAnArray = request.target && request.target.isArray();\r\n        var targetParentIsNotAnArray = !request.parentRequest ||\r\n            !request.parentRequest.target ||\r\n            !request.target ||\r\n            !request.parentRequest.target.matchesArray(request.target.serviceIdentifier);\r\n        if (targetIsAnArray && targetParentIsNotAnArray) {\r\n            return childRequests.map(function (childRequest) {\r\n                var _f = _resolveRequest(requestScope);\r\n                return _f(childRequest);\r\n            });\r\n        }\r\n        else {\r\n            if (request.target.isOptional() && bindings.length === 0) {\r\n                return undefined;\r\n            }\r\n            var binding = bindings[0];\r\n            return _resolveBinding(requestScope, request, binding);\r\n        }\r\n    };\r\n};\r\nvar _resolveFactoryFromBinding = function (binding, context) {\r\n    var factoryDetails = (0, binding_utils_1.getFactoryDetails)(binding);\r\n    return (0, exceptions_1.tryAndThrowErrorIfStackOverflow)(function () { return factoryDetails.factory.bind(binding)(context); }, function () { return new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY_IN_FACTORY(factoryDetails.factoryType, context.currentRequest.serviceIdentifier.toString())); });\r\n};\r\nvar _getResolvedFromBinding = function (requestScope, request, binding) {\r\n    var result;\r\n    var childRequests = request.childRequests;\r\n    (0, binding_utils_1.ensureFullyBound)(binding);\r\n    switch (binding.type) {\r\n        case literal_types_1.BindingTypeEnum.ConstantValue:\r\n        case literal_types_1.BindingTypeEnum.Function:\r\n            result = binding.cache;\r\n            break;\r\n        case literal_types_1.BindingTypeEnum.Constructor:\r\n            result = binding.implementationType;\r\n            break;\r\n        case literal_types_1.BindingTypeEnum.Instance:\r\n            result = (0, instantiation_1.resolveInstance)(binding, binding.implementationType, childRequests, _resolveRequest(requestScope));\r\n            break;\r\n        default:\r\n            result = _resolveFactoryFromBinding(binding, request.parentContext);\r\n    }\r\n    return result;\r\n};\r\nvar _resolveInScope = function (requestScope, binding, resolveFromBinding) {\r\n    var result = (0, scope_1.tryGetFromScope)(requestScope, binding);\r\n    if (result !== null) {\r\n        return result;\r\n    }\r\n    result = resolveFromBinding();\r\n    (0, scope_1.saveToScope)(requestScope, binding, result);\r\n    return result;\r\n};\r\nvar _resolveBinding = function (requestScope, request, binding) {\r\n    return _resolveInScope(requestScope, binding, function () {\r\n        var result = _getResolvedFromBinding(requestScope, request, binding);\r\n        if ((0, async_1.isPromise)(result)) {\r\n            result = result.then(function (resolved) { return _onActivation(request, binding, resolved); });\r\n        }\r\n        else {\r\n            result = _onActivation(request, binding, result);\r\n        }\r\n        return result;\r\n    });\r\n};\r\nfunction _onActivation(request, binding, resolved) {\r\n    var result = _bindingActivation(request.parentContext, binding, resolved);\r\n    var containersIterator = _getContainersIterator(request.parentContext.container);\r\n    var container;\r\n    var containersIteratorResult = containersIterator.next();\r\n    do {\r\n        container = containersIteratorResult.value;\r\n        var context_1 = request.parentContext;\r\n        var serviceIdentifier = request.serviceIdentifier;\r\n        var activationsIterator = _getContainerActivationsForService(container, serviceIdentifier);\r\n        if ((0, async_1.isPromise)(result)) {\r\n            result = _activateContainerAsync(activationsIterator, context_1, result);\r\n        }\r\n        else {\r\n            result = _activateContainer(activationsIterator, context_1, result);\r\n        }\r\n        containersIteratorResult = containersIterator.next();\r\n    } while (containersIteratorResult.done !== true && !(0, planner_1.getBindingDictionary)(container).hasKey(request.serviceIdentifier));\r\n    return result;\r\n}\r\nvar _bindingActivation = function (context, binding, previousResult) {\r\n    var result;\r\n    if (typeof binding.onActivation === 'function') {\r\n        result = binding.onActivation(context, previousResult);\r\n    }\r\n    else {\r\n        result = previousResult;\r\n    }\r\n    return result;\r\n};\r\nvar _activateContainer = function (activationsIterator, context, result) {\r\n    var activation = activationsIterator.next();\r\n    while (!activation.done) {\r\n        result = activation.value(context, result);\r\n        if ((0, async_1.isPromise)(result)) {\r\n            return _activateContainerAsync(activationsIterator, context, result);\r\n        }\r\n        activation = activationsIterator.next();\r\n    }\r\n    return result;\r\n};\r\nvar _activateContainerAsync = function (activationsIterator, context, resultPromise) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var result, activation;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0: return [4, resultPromise];\r\n            case 1:\r\n                result = _a.sent();\r\n                activation = activationsIterator.next();\r\n                _a.label = 2;\r\n            case 2:\r\n                if (!!activation.done) return [3, 4];\r\n                return [4, activation.value(context, result)];\r\n            case 3:\r\n                result = _a.sent();\r\n                activation = activationsIterator.next();\r\n                return [3, 2];\r\n            case 4: return [2, result];\r\n        }\r\n    });\r\n}); };\r\nvar _getContainerActivationsForService = function (container, serviceIdentifier) {\r\n    var activations = container._activations;\r\n    return activations.hasKey(serviceIdentifier) ? activations.get(serviceIdentifier).values() : [].values();\r\n};\r\nvar _getContainersIterator = function (container) {\r\n    var containersStack = [container];\r\n    var parent = container.parent;\r\n    while (parent !== null) {\r\n        containersStack.push(parent);\r\n        parent = parent.parent;\r\n    }\r\n    var getNextContainer = function () {\r\n        var nextContainer = containersStack.pop();\r\n        if (nextContainer !== undefined) {\r\n            return { done: false, value: nextContainer };\r\n        }\r\n        else {\r\n            return { done: true, value: undefined };\r\n        }\r\n    };\r\n    var containersIterator = {\r\n        next: getNextContainer,\r\n    };\r\n    return containersIterator;\r\n};\r\nfunction resolve(context) {\r\n    var _f = _resolveRequest(context.plan.rootRequest.requestScope);\r\n    return _f(context.plan.rootRequest);\r\n}\r\nexports.resolve = resolve;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.typeConstraint = exports.namedConstraint = exports.taggedConstraint = exports.traverseAncerstors = void 0;\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar metadata_1 = require(\"../planning/metadata\");\r\nvar traverseAncerstors = function (request, constraint) {\r\n    var parent = request.parentRequest;\r\n    if (parent !== null) {\r\n        return constraint(parent) ? true : traverseAncerstors(parent, constraint);\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n};\r\nexports.traverseAncerstors = traverseAncerstors;\r\nvar taggedConstraint = function (key) { return function (value) {\r\n    var constraint = function (request) {\r\n        return request !== null && request.target !== null && request.target.matchesTag(key)(value);\r\n    };\r\n    constraint.metaData = new metadata_1.Metadata(key, value);\r\n    return constraint;\r\n}; };\r\nexports.taggedConstraint = taggedConstraint;\r\nvar namedConstraint = taggedConstraint(METADATA_KEY.NAMED_TAG);\r\nexports.namedConstraint = namedConstraint;\r\nvar typeConstraint = function (type) { return function (request) {\r\n    var binding = null;\r\n    if (request !== null) {\r\n        binding = request.bindings[0];\r\n        if (typeof type === 'string') {\r\n            var serviceIdentifier = binding.serviceIdentifier;\r\n            return serviceIdentifier === type;\r\n        }\r\n        else {\r\n            var constructor = request.bindings[0].implementationType;\r\n            return type === constructor;\r\n        }\r\n    }\r\n    return false;\r\n}; };\r\nexports.typeConstraint = typeConstraint;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BindingWhenSyntax = void 0;\r\nvar binding_on_syntax_1 = require(\"./binding_on_syntax\");\r\nvar constraint_helpers_1 = require(\"./constraint_helpers\");\r\nvar BindingWhenSyntax = (function () {\r\n    function BindingWhenSyntax(binding) {\r\n        this._binding = binding;\r\n    }\r\n    BindingWhenSyntax.prototype.when = function (constraint) {\r\n        this._binding.constraint = constraint;\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenTargetNamed = function (name) {\r\n        this._binding.constraint = (0, constraint_helpers_1.namedConstraint)(name);\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenTargetIsDefault = function () {\r\n        this._binding.constraint = function (request) {\r\n            if (request === null) {\r\n                return false;\r\n            }\r\n            var targetIsDefault = (request.target !== null) &&\r\n                (!request.target.isNamed()) &&\r\n                (!request.target.isTagged());\r\n            return targetIsDefault;\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenTargetTagged = function (tag, value) {\r\n        this._binding.constraint = (0, constraint_helpers_1.taggedConstraint)(tag)(value);\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenInjectedInto = function (parent) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && (0, constraint_helpers_1.typeConstraint)(parent)(request.parentRequest);\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenParentNamed = function (name) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && (0, constraint_helpers_1.namedConstraint)(name)(request.parentRequest);\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenParentTagged = function (tag, value) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && (0, constraint_helpers_1.taggedConstraint)(tag)(value)(request.parentRequest);\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && (0, constraint_helpers_1.traverseAncerstors)(request, (0, constraint_helpers_1.typeConstraint)(ancestor));\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenNoAncestorIs = function (ancestor) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && !(0, constraint_helpers_1.traverseAncerstors)(request, (0, constraint_helpers_1.typeConstraint)(ancestor));\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenAnyAncestorNamed = function (name) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && (0, constraint_helpers_1.traverseAncerstors)(request, (0, constraint_helpers_1.namedConstraint)(name));\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenNoAncestorNamed = function (name) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && !(0, constraint_helpers_1.traverseAncerstors)(request, (0, constraint_helpers_1.namedConstraint)(name));\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && (0, constraint_helpers_1.traverseAncerstors)(request, (0, constraint_helpers_1.taggedConstraint)(tag)(value));\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && !(0, constraint_helpers_1.traverseAncerstors)(request, (0, constraint_helpers_1.taggedConstraint)(tag)(value));\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && (0, constraint_helpers_1.traverseAncerstors)(request, constraint);\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenNoAncestorMatches = function (constraint) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && !(0, constraint_helpers_1.traverseAncerstors)(request, constraint);\r\n        };\r\n        return new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    };\r\n    return BindingWhenSyntax;\r\n}());\r\nexports.BindingWhenSyntax = BindingWhenSyntax;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BindingOnSyntax = void 0;\r\nvar binding_when_syntax_1 = require(\"./binding_when_syntax\");\r\nvar BindingOnSyntax = (function () {\r\n    function BindingOnSyntax(binding) {\r\n        this._binding = binding;\r\n    }\r\n    BindingOnSyntax.prototype.onActivation = function (handler) {\r\n        this._binding.onActivation = handler;\r\n        return new binding_when_syntax_1.BindingWhenSyntax(this._binding);\r\n    };\r\n    BindingOnSyntax.prototype.onDeactivation = function (handler) {\r\n        this._binding.onDeactivation = handler;\r\n        return new binding_when_syntax_1.BindingWhenSyntax(this._binding);\r\n    };\r\n    return BindingOnSyntax;\r\n}());\r\nexports.BindingOnSyntax = BindingOnSyntax;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BindingWhenOnSyntax = void 0;\r\nvar binding_on_syntax_1 = require(\"./binding_on_syntax\");\r\nvar binding_when_syntax_1 = require(\"./binding_when_syntax\");\r\nvar BindingWhenOnSyntax = (function () {\r\n    function BindingWhenOnSyntax(binding) {\r\n        this._binding = binding;\r\n        this._bindingWhenSyntax = new binding_when_syntax_1.BindingWhenSyntax(this._binding);\r\n        this._bindingOnSyntax = new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n    }\r\n    BindingWhenOnSyntax.prototype.when = function (constraint) {\r\n        return this._bindingWhenSyntax.when(constraint);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenTargetNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenTargetNamed(name);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenTargetIsDefault = function () {\r\n        return this._bindingWhenSyntax.whenTargetIsDefault();\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenTargetTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenTargetTagged(tag, value);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenInjectedInto = function (parent) {\r\n        return this._bindingWhenSyntax.whenInjectedInto(parent);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenParentNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenParentNamed(name);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenParentTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenParentTagged(tag, value);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorIs(ancestor);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenNoAncestorIs = function (ancestor) {\r\n        return this._bindingWhenSyntax.whenNoAncestorIs(ancestor);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenAnyAncestorNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorNamed(name);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorTagged(tag, value);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenNoAncestorNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenNoAncestorNamed(name);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenNoAncestorTagged(tag, value);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorMatches(constraint);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenNoAncestorMatches = function (constraint) {\r\n        return this._bindingWhenSyntax.whenNoAncestorMatches(constraint);\r\n    };\r\n    BindingWhenOnSyntax.prototype.onActivation = function (handler) {\r\n        return this._bindingOnSyntax.onActivation(handler);\r\n    };\r\n    BindingWhenOnSyntax.prototype.onDeactivation = function (handler) {\r\n        return this._bindingOnSyntax.onDeactivation(handler);\r\n    };\r\n    return BindingWhenOnSyntax;\r\n}());\r\nexports.BindingWhenOnSyntax = BindingWhenOnSyntax;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BindingInSyntax = void 0;\r\nvar literal_types_1 = require(\"../constants/literal_types\");\r\nvar binding_when_on_syntax_1 = require(\"./binding_when_on_syntax\");\r\nvar BindingInSyntax = (function () {\r\n    function BindingInSyntax(binding) {\r\n        this._binding = binding;\r\n    }\r\n    BindingInSyntax.prototype.inRequestScope = function () {\r\n        this._binding.scope = literal_types_1.BindingScopeEnum.Request;\r\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingInSyntax.prototype.inSingletonScope = function () {\r\n        this._binding.scope = literal_types_1.BindingScopeEnum.Singleton;\r\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingInSyntax.prototype.inTransientScope = function () {\r\n        this._binding.scope = literal_types_1.BindingScopeEnum.Transient;\r\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\r\n    };\r\n    return BindingInSyntax;\r\n}());\r\nexports.BindingInSyntax = BindingInSyntax;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BindingInWhenOnSyntax = void 0;\r\nvar binding_in_syntax_1 = require(\"./binding_in_syntax\");\r\nvar binding_on_syntax_1 = require(\"./binding_on_syntax\");\r\nvar binding_when_syntax_1 = require(\"./binding_when_syntax\");\r\nvar BindingInWhenOnSyntax = (function () {\r\n    function BindingInWhenOnSyntax(binding) {\r\n        this._binding = binding;\r\n        this._bindingWhenSyntax = new binding_when_syntax_1.BindingWhenSyntax(this._binding);\r\n        this._bindingOnSyntax = new binding_on_syntax_1.BindingOnSyntax(this._binding);\r\n        this._bindingInSyntax = new binding_in_syntax_1.BindingInSyntax(binding);\r\n    }\r\n    BindingInWhenOnSyntax.prototype.inRequestScope = function () {\r\n        return this._bindingInSyntax.inRequestScope();\r\n    };\r\n    BindingInWhenOnSyntax.prototype.inSingletonScope = function () {\r\n        return this._bindingInSyntax.inSingletonScope();\r\n    };\r\n    BindingInWhenOnSyntax.prototype.inTransientScope = function () {\r\n        return this._bindingInSyntax.inTransientScope();\r\n    };\r\n    BindingInWhenOnSyntax.prototype.when = function (constraint) {\r\n        return this._bindingWhenSyntax.when(constraint);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenTargetNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenTargetNamed(name);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenTargetIsDefault = function () {\r\n        return this._bindingWhenSyntax.whenTargetIsDefault();\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenTargetTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenTargetTagged(tag, value);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenInjectedInto = function (parent) {\r\n        return this._bindingWhenSyntax.whenInjectedInto(parent);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenParentNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenParentNamed(name);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenParentTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenParentTagged(tag, value);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorIs(ancestor);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenNoAncestorIs = function (ancestor) {\r\n        return this._bindingWhenSyntax.whenNoAncestorIs(ancestor);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorNamed(name);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorTagged(tag, value);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenNoAncestorNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenNoAncestorNamed(name);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenNoAncestorTagged(tag, value);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorMatches(constraint);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenNoAncestorMatches = function (constraint) {\r\n        return this._bindingWhenSyntax.whenNoAncestorMatches(constraint);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.onActivation = function (handler) {\r\n        return this._bindingOnSyntax.onActivation(handler);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.onDeactivation = function (handler) {\r\n        return this._bindingOnSyntax.onDeactivation(handler);\r\n    };\r\n    return BindingInWhenOnSyntax;\r\n}());\r\nexports.BindingInWhenOnSyntax = BindingInWhenOnSyntax;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BindingToSyntax = void 0;\r\nvar ERROR_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar literal_types_1 = require(\"../constants/literal_types\");\r\nvar binding_in_when_on_syntax_1 = require(\"./binding_in_when_on_syntax\");\r\nvar binding_when_on_syntax_1 = require(\"./binding_when_on_syntax\");\r\nvar BindingToSyntax = (function () {\r\n    function BindingToSyntax(binding) {\r\n        this._binding = binding;\r\n    }\r\n    BindingToSyntax.prototype.to = function (constructor) {\r\n        this._binding.type = literal_types_1.BindingTypeEnum.Instance;\r\n        this._binding.implementationType = constructor;\r\n        return new binding_in_when_on_syntax_1.BindingInWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toSelf = function () {\r\n        if (typeof this._binding.serviceIdentifier !== \"function\") {\r\n            throw new Error(\"\" + ERROR_MSGS.INVALID_TO_SELF_VALUE);\r\n        }\r\n        var self = this._binding.serviceIdentifier;\r\n        return this.to(self);\r\n    };\r\n    BindingToSyntax.prototype.toConstantValue = function (value) {\r\n        this._binding.type = literal_types_1.BindingTypeEnum.ConstantValue;\r\n        this._binding.cache = value;\r\n        this._binding.dynamicValue = null;\r\n        this._binding.implementationType = null;\r\n        this._binding.scope = literal_types_1.BindingScopeEnum.Singleton;\r\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toDynamicValue = function (func) {\r\n        this._binding.type = literal_types_1.BindingTypeEnum.DynamicValue;\r\n        this._binding.cache = null;\r\n        this._binding.dynamicValue = func;\r\n        this._binding.implementationType = null;\r\n        return new binding_in_when_on_syntax_1.BindingInWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toConstructor = function (constructor) {\r\n        this._binding.type = literal_types_1.BindingTypeEnum.Constructor;\r\n        this._binding.implementationType = constructor;\r\n        this._binding.scope = literal_types_1.BindingScopeEnum.Singleton;\r\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toFactory = function (factory) {\r\n        this._binding.type = literal_types_1.BindingTypeEnum.Factory;\r\n        this._binding.factory = factory;\r\n        this._binding.scope = literal_types_1.BindingScopeEnum.Singleton;\r\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toFunction = function (func) {\r\n        if (typeof func !== \"function\") {\r\n            throw new Error(ERROR_MSGS.INVALID_FUNCTION_BINDING);\r\n        }\r\n        var bindingWhenOnSyntax = this.toConstantValue(func);\r\n        this._binding.type = literal_types_1.BindingTypeEnum.Function;\r\n        this._binding.scope = literal_types_1.BindingScopeEnum.Singleton;\r\n        return bindingWhenOnSyntax;\r\n    };\r\n    BindingToSyntax.prototype.toAutoFactory = function (serviceIdentifier) {\r\n        this._binding.type = literal_types_1.BindingTypeEnum.Factory;\r\n        this._binding.factory = function (context) {\r\n            var autofactory = function () { return context.container.get(serviceIdentifier); };\r\n            return autofactory;\r\n        };\r\n        this._binding.scope = literal_types_1.BindingScopeEnum.Singleton;\r\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toAutoNamedFactory = function (serviceIdentifier) {\r\n        this._binding.type = literal_types_1.BindingTypeEnum.Factory;\r\n        this._binding.factory = function (context) {\r\n            return function (named) { return context.container.getNamed(serviceIdentifier, named); };\r\n        };\r\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toProvider = function (provider) {\r\n        this._binding.type = literal_types_1.BindingTypeEnum.Provider;\r\n        this._binding.provider = provider;\r\n        this._binding.scope = literal_types_1.BindingScopeEnum.Singleton;\r\n        return new binding_when_on_syntax_1.BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toService = function (service) {\r\n        this.toDynamicValue(function (context) { return context.container.get(service); });\r\n    };\r\n    return BindingToSyntax;\r\n}());\r\nexports.BindingToSyntax = BindingToSyntax;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ContainerSnapshot = void 0;\r\nvar ContainerSnapshot = (function () {\r\n    function ContainerSnapshot() {\r\n    }\r\n    ContainerSnapshot.of = function (bindings, middleware, activations, deactivations, moduleActivationStore) {\r\n        var snapshot = new ContainerSnapshot();\r\n        snapshot.bindings = bindings;\r\n        snapshot.middleware = middleware;\r\n        snapshot.deactivations = deactivations;\r\n        snapshot.activations = activations;\r\n        snapshot.moduleActivationStore = moduleActivationStore;\r\n        return snapshot;\r\n    };\r\n    return ContainerSnapshot;\r\n}());\r\nexports.ContainerSnapshot = ContainerSnapshot;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.isClonable = void 0;\r\nfunction isClonable(obj) {\r\n    return (typeof obj === 'object')\r\n        && (obj !== null)\r\n        && ('clone' in obj)\r\n        && typeof obj.clone === 'function';\r\n}\r\nexports.isClonable = isClonable;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Lookup = void 0;\r\nvar ERROR_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar clonable_1 = require(\"../utils/clonable\");\r\nvar Lookup = (function () {\r\n    function Lookup() {\r\n        this._map = new Map();\r\n    }\r\n    Lookup.prototype.getMap = function () {\r\n        return this._map;\r\n    };\r\n    Lookup.prototype.add = function (serviceIdentifier, value) {\r\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\r\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\r\n        }\r\n        if (value === null || value === undefined) {\r\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\r\n        }\r\n        var entry = this._map.get(serviceIdentifier);\r\n        if (entry !== undefined) {\r\n            entry.push(value);\r\n        }\r\n        else {\r\n            this._map.set(serviceIdentifier, [value]);\r\n        }\r\n    };\r\n    Lookup.prototype.get = function (serviceIdentifier) {\r\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\r\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\r\n        }\r\n        var entry = this._map.get(serviceIdentifier);\r\n        if (entry !== undefined) {\r\n            return entry;\r\n        }\r\n        else {\r\n            throw new Error(ERROR_MSGS.KEY_NOT_FOUND);\r\n        }\r\n    };\r\n    Lookup.prototype.remove = function (serviceIdentifier) {\r\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\r\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\r\n        }\r\n        if (!this._map.delete(serviceIdentifier)) {\r\n            throw new Error(ERROR_MSGS.KEY_NOT_FOUND);\r\n        }\r\n    };\r\n    Lookup.prototype.removeIntersection = function (lookup) {\r\n        var _this = this;\r\n        this.traverse(function (serviceIdentifier, value) {\r\n            var lookupActivations = lookup.hasKey(serviceIdentifier) ? lookup.get(serviceIdentifier) : undefined;\r\n            if (lookupActivations !== undefined) {\r\n                var filteredValues = value.filter(function (lookupValue) {\r\n                    return !lookupActivations.some(function (moduleActivation) { return lookupValue === moduleActivation; });\r\n                });\r\n                _this._setValue(serviceIdentifier, filteredValues);\r\n            }\r\n        });\r\n    };\r\n    Lookup.prototype.removeByCondition = function (condition) {\r\n        var _this = this;\r\n        var removals = [];\r\n        this._map.forEach(function (entries, key) {\r\n            var updatedEntries = [];\r\n            for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\r\n                var entry = entries_1[_i];\r\n                var remove = condition(entry);\r\n                if (remove) {\r\n                    removals.push(entry);\r\n                }\r\n                else {\r\n                    updatedEntries.push(entry);\r\n                }\r\n            }\r\n            _this._setValue(key, updatedEntries);\r\n        });\r\n        return removals;\r\n    };\r\n    Lookup.prototype.hasKey = function (serviceIdentifier) {\r\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\r\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\r\n        }\r\n        return this._map.has(serviceIdentifier);\r\n    };\r\n    Lookup.prototype.clone = function () {\r\n        var copy = new Lookup();\r\n        this._map.forEach(function (value, key) {\r\n            value.forEach(function (b) { return copy.add(key, (0, clonable_1.isClonable)(b) ? b.clone() : b); });\r\n        });\r\n        return copy;\r\n    };\r\n    Lookup.prototype.traverse = function (func) {\r\n        this._map.forEach(function (value, key) {\r\n            func(key, value);\r\n        });\r\n    };\r\n    Lookup.prototype._setValue = function (serviceIdentifier, value) {\r\n        if (value.length > 0) {\r\n            this._map.set(serviceIdentifier, value);\r\n        }\r\n        else {\r\n            this._map.delete(serviceIdentifier);\r\n        }\r\n    };\r\n    return Lookup;\r\n}());\r\nexports.Lookup = Lookup;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ModuleActivationStore = void 0;\r\nvar lookup_1 = require(\"./lookup\");\r\nvar ModuleActivationStore = (function () {\r\n    function ModuleActivationStore() {\r\n        this._map = new Map();\r\n    }\r\n    ModuleActivationStore.prototype.remove = function (moduleId) {\r\n        if (this._map.has(moduleId)) {\r\n            var handlers = this._map.get(moduleId);\r\n            this._map.delete(moduleId);\r\n            return handlers;\r\n        }\r\n        return this._getEmptyHandlersStore();\r\n    };\r\n    ModuleActivationStore.prototype.addDeactivation = function (moduleId, serviceIdentifier, onDeactivation) {\r\n        this._getModuleActivationHandlers(moduleId)\r\n            .onDeactivations.add(serviceIdentifier, onDeactivation);\r\n    };\r\n    ModuleActivationStore.prototype.addActivation = function (moduleId, serviceIdentifier, onActivation) {\r\n        this._getModuleActivationHandlers(moduleId)\r\n            .onActivations.add(serviceIdentifier, onActivation);\r\n    };\r\n    ModuleActivationStore.prototype.clone = function () {\r\n        var clone = new ModuleActivationStore();\r\n        this._map.forEach(function (handlersStore, moduleId) {\r\n            clone._map.set(moduleId, {\r\n                onActivations: handlersStore.onActivations.clone(),\r\n                onDeactivations: handlersStore.onDeactivations.clone(),\r\n            });\r\n        });\r\n        return clone;\r\n    };\r\n    ModuleActivationStore.prototype._getModuleActivationHandlers = function (moduleId) {\r\n        var moduleActivationHandlers = this._map.get(moduleId);\r\n        if (moduleActivationHandlers === undefined) {\r\n            moduleActivationHandlers = this._getEmptyHandlersStore();\r\n            this._map.set(moduleId, moduleActivationHandlers);\r\n        }\r\n        return moduleActivationHandlers;\r\n    };\r\n    ModuleActivationStore.prototype._getEmptyHandlersStore = function () {\r\n        var handlersStore = {\r\n            onActivations: new lookup_1.Lookup(),\r\n            onDeactivations: new lookup_1.Lookup()\r\n        };\r\n        return handlersStore;\r\n    };\r\n    return ModuleActivationStore;\r\n}());\r\nexports.ModuleActivationStore = ModuleActivationStore;\r\n", "\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Container = void 0;\r\nvar binding_1 = require(\"../bindings/binding\");\r\nvar ERROR_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar literal_types_1 = require(\"../constants/literal_types\");\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar metadata_reader_1 = require(\"../planning/metadata_reader\");\r\nvar planner_1 = require(\"../planning/planner\");\r\nvar resolver_1 = require(\"../resolution/resolver\");\r\nvar binding_to_syntax_1 = require(\"../syntax/binding_to_syntax\");\r\nvar async_1 = require(\"../utils/async\");\r\nvar id_1 = require(\"../utils/id\");\r\nvar serialization_1 = require(\"../utils/serialization\");\r\nvar container_snapshot_1 = require(\"./container_snapshot\");\r\nvar lookup_1 = require(\"./lookup\");\r\nvar module_activation_store_1 = require(\"./module_activation_store\");\r\nvar Container = (function () {\r\n    function Container(containerOptions) {\r\n        var options = containerOptions || {};\r\n        if (typeof options !== 'object') {\r\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);\r\n        }\r\n        if (options.defaultScope === undefined) {\r\n            options.defaultScope = literal_types_1.BindingScopeEnum.Transient;\r\n        }\r\n        else if (options.defaultScope !== literal_types_1.BindingScopeEnum.Singleton &&\r\n            options.defaultScope !== literal_types_1.BindingScopeEnum.Transient &&\r\n            options.defaultScope !== literal_types_1.BindingScopeEnum.Request) {\r\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);\r\n        }\r\n        if (options.autoBindInjectable === undefined) {\r\n            options.autoBindInjectable = false;\r\n        }\r\n        else if (typeof options.autoBindInjectable !== 'boolean') {\r\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);\r\n        }\r\n        if (options.skipBaseClassChecks === undefined) {\r\n            options.skipBaseClassChecks = false;\r\n        }\r\n        else if (typeof options.skipBaseClassChecks !== 'boolean') {\r\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);\r\n        }\r\n        this.options = {\r\n            autoBindInjectable: options.autoBindInjectable,\r\n            defaultScope: options.defaultScope,\r\n            skipBaseClassChecks: options.skipBaseClassChecks\r\n        };\r\n        this.id = (0, id_1.id)();\r\n        this._bindingDictionary = new lookup_1.Lookup();\r\n        this._snapshots = [];\r\n        this._middleware = null;\r\n        this._activations = new lookup_1.Lookup();\r\n        this._deactivations = new lookup_1.Lookup();\r\n        this.parent = null;\r\n        this._metadataReader = new metadata_reader_1.MetadataReader();\r\n        this._moduleActivationStore = new module_activation_store_1.ModuleActivationStore();\r\n    }\r\n    Container.merge = function (container1, container2) {\r\n        var containers = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            containers[_i - 2] = arguments[_i];\r\n        }\r\n        var container = new Container();\r\n        var targetContainers = __spreadArray([container1, container2], containers, true).map(function (targetContainer) { return (0, planner_1.getBindingDictionary)(targetContainer); });\r\n        var bindingDictionary = (0, planner_1.getBindingDictionary)(container);\r\n        function copyDictionary(origin, destination) {\r\n            origin.traverse(function (_key, value) {\r\n                value.forEach(function (binding) {\r\n                    destination.add(binding.serviceIdentifier, binding.clone());\r\n                });\r\n            });\r\n        }\r\n        targetContainers.forEach(function (targetBindingDictionary) {\r\n            copyDictionary(targetBindingDictionary, bindingDictionary);\r\n        });\r\n        return container;\r\n    };\r\n    Container.prototype.load = function () {\r\n        var modules = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            modules[_i] = arguments[_i];\r\n        }\r\n        var getHelpers = this._getContainerModuleHelpersFactory();\r\n        for (var _a = 0, modules_1 = modules; _a < modules_1.length; _a++) {\r\n            var currentModule = modules_1[_a];\r\n            var containerModuleHelpers = getHelpers(currentModule.id);\r\n            currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction, containerModuleHelpers.unbindAsyncFunction, containerModuleHelpers.onActivationFunction, containerModuleHelpers.onDeactivationFunction);\r\n        }\r\n    };\r\n    Container.prototype.loadAsync = function () {\r\n        var modules = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            modules[_i] = arguments[_i];\r\n        }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var getHelpers, _a, modules_2, currentModule, containerModuleHelpers;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        getHelpers = this._getContainerModuleHelpersFactory();\r\n                        _a = 0, modules_2 = modules;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(_a < modules_2.length)) return [3, 4];\r\n                        currentModule = modules_2[_a];\r\n                        containerModuleHelpers = getHelpers(currentModule.id);\r\n                        return [4, currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction, containerModuleHelpers.unbindAsyncFunction, containerModuleHelpers.onActivationFunction, containerModuleHelpers.onDeactivationFunction)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _a++;\r\n                        return [3, 1];\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.unload = function () {\r\n        var _this = this;\r\n        var modules = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            modules[_i] = arguments[_i];\r\n        }\r\n        modules.forEach(function (module) {\r\n            var deactivations = _this._removeModuleBindings(module.id);\r\n            _this._deactivateSingletons(deactivations);\r\n            _this._removeModuleHandlers(module.id);\r\n        });\r\n    };\r\n    Container.prototype.unloadAsync = function () {\r\n        var modules = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            modules[_i] = arguments[_i];\r\n        }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a, modules_3, module_1, deactivations;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = 0, modules_3 = modules;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(_a < modules_3.length)) return [3, 4];\r\n                        module_1 = modules_3[_a];\r\n                        deactivations = this._removeModuleBindings(module_1.id);\r\n                        return [4, this._deactivateSingletonsAsync(deactivations)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        this._removeModuleHandlers(module_1.id);\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _a++;\r\n                        return [3, 1];\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.bind = function (serviceIdentifier) {\r\n        var scope = this.options.defaultScope || literal_types_1.BindingScopeEnum.Transient;\r\n        var binding = new binding_1.Binding(serviceIdentifier, scope);\r\n        this._bindingDictionary.add(serviceIdentifier, binding);\r\n        return new binding_to_syntax_1.BindingToSyntax(binding);\r\n    };\r\n    Container.prototype.rebind = function (serviceIdentifier) {\r\n        this.unbind(serviceIdentifier);\r\n        return this.bind(serviceIdentifier);\r\n    };\r\n    Container.prototype.rebindAsync = function (serviceIdentifier) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, this.unbindAsync(serviceIdentifier)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2, this.bind(serviceIdentifier)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.unbind = function (serviceIdentifier) {\r\n        if (this._bindingDictionary.hasKey(serviceIdentifier)) {\r\n            var bindings = this._bindingDictionary.get(serviceIdentifier);\r\n            this._deactivateSingletons(bindings);\r\n        }\r\n        this._removeServiceFromDictionary(serviceIdentifier);\r\n    };\r\n    Container.prototype.unbindAsync = function (serviceIdentifier) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var bindings;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this._bindingDictionary.hasKey(serviceIdentifier)) return [3, 2];\r\n                        bindings = this._bindingDictionary.get(serviceIdentifier);\r\n                        return [4, this._deactivateSingletonsAsync(bindings)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        this._removeServiceFromDictionary(serviceIdentifier);\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.unbindAll = function () {\r\n        var _this = this;\r\n        this._bindingDictionary.traverse(function (_key, value) {\r\n            _this._deactivateSingletons(value);\r\n        });\r\n        this._bindingDictionary = new lookup_1.Lookup();\r\n    };\r\n    Container.prototype.unbindAllAsync = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var promises;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        promises = [];\r\n                        this._bindingDictionary.traverse(function (_key, value) {\r\n                            promises.push(_this._deactivateSingletonsAsync(value));\r\n                        });\r\n                        return [4, Promise.all(promises)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this._bindingDictionary = new lookup_1.Lookup();\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.onActivation = function (serviceIdentifier, onActivation) {\r\n        this._activations.add(serviceIdentifier, onActivation);\r\n    };\r\n    Container.prototype.onDeactivation = function (serviceIdentifier, onDeactivation) {\r\n        this._deactivations.add(serviceIdentifier, onDeactivation);\r\n    };\r\n    Container.prototype.isBound = function (serviceIdentifier) {\r\n        var bound = this._bindingDictionary.hasKey(serviceIdentifier);\r\n        if (!bound && this.parent) {\r\n            bound = this.parent.isBound(serviceIdentifier);\r\n        }\r\n        return bound;\r\n    };\r\n    Container.prototype.isCurrentBound = function (serviceIdentifier) {\r\n        return this._bindingDictionary.hasKey(serviceIdentifier);\r\n    };\r\n    Container.prototype.isBoundNamed = function (serviceIdentifier, named) {\r\n        return this.isBoundTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\r\n    };\r\n    Container.prototype.isBoundTagged = function (serviceIdentifier, key, value) {\r\n        var bound = false;\r\n        if (this._bindingDictionary.hasKey(serviceIdentifier)) {\r\n            var bindings = this._bindingDictionary.get(serviceIdentifier);\r\n            var request_1 = (0, planner_1.createMockRequest)(this, serviceIdentifier, key, value);\r\n            bound = bindings.some(function (b) { return b.constraint(request_1); });\r\n        }\r\n        if (!bound && this.parent) {\r\n            bound = this.parent.isBoundTagged(serviceIdentifier, key, value);\r\n        }\r\n        return bound;\r\n    };\r\n    Container.prototype.snapshot = function () {\r\n        this._snapshots.push(container_snapshot_1.ContainerSnapshot.of(this._bindingDictionary.clone(), this._middleware, this._activations.clone(), this._deactivations.clone(), this._moduleActivationStore.clone()));\r\n    };\r\n    Container.prototype.restore = function () {\r\n        var snapshot = this._snapshots.pop();\r\n        if (snapshot === undefined) {\r\n            throw new Error(ERROR_MSGS.NO_MORE_SNAPSHOTS_AVAILABLE);\r\n        }\r\n        this._bindingDictionary = snapshot.bindings;\r\n        this._activations = snapshot.activations;\r\n        this._deactivations = snapshot.deactivations;\r\n        this._middleware = snapshot.middleware;\r\n        this._moduleActivationStore = snapshot.moduleActivationStore;\r\n    };\r\n    Container.prototype.createChild = function (containerOptions) {\r\n        var child = new Container(containerOptions || this.options);\r\n        child.parent = this;\r\n        return child;\r\n    };\r\n    Container.prototype.applyMiddleware = function () {\r\n        var middlewares = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            middlewares[_i] = arguments[_i];\r\n        }\r\n        var initial = (this._middleware) ? this._middleware : this._planAndResolve();\r\n        this._middleware = middlewares.reduce(function (prev, curr) { return curr(prev); }, initial);\r\n    };\r\n    Container.prototype.applyCustomMetadataReader = function (metadataReader) {\r\n        this._metadataReader = metadataReader;\r\n    };\r\n    Container.prototype.get = function (serviceIdentifier) {\r\n        var getArgs = this._getNotAllArgs(serviceIdentifier, false);\r\n        return this._getButThrowIfAsync(getArgs);\r\n    };\r\n    Container.prototype.getAsync = function (serviceIdentifier) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var getArgs;\r\n            return __generator(this, function (_a) {\r\n                getArgs = this._getNotAllArgs(serviceIdentifier, false);\r\n                return [2, this._get(getArgs)];\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.getTagged = function (serviceIdentifier, key, value) {\r\n        var getArgs = this._getNotAllArgs(serviceIdentifier, false, key, value);\r\n        return this._getButThrowIfAsync(getArgs);\r\n    };\r\n    Container.prototype.getTaggedAsync = function (serviceIdentifier, key, value) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var getArgs;\r\n            return __generator(this, function (_a) {\r\n                getArgs = this._getNotAllArgs(serviceIdentifier, false, key, value);\r\n                return [2, this._get(getArgs)];\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.getNamed = function (serviceIdentifier, named) {\r\n        return this.getTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\r\n    };\r\n    Container.prototype.getNamedAsync = function (serviceIdentifier, named) {\r\n        return this.getTaggedAsync(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\r\n    };\r\n    Container.prototype.getAll = function (serviceIdentifier) {\r\n        var getArgs = this._getAllArgs(serviceIdentifier);\r\n        return this._getButThrowIfAsync(getArgs);\r\n    };\r\n    Container.prototype.getAllAsync = function (serviceIdentifier) {\r\n        var getArgs = this._getAllArgs(serviceIdentifier);\r\n        return this._getAll(getArgs);\r\n    };\r\n    Container.prototype.getAllTagged = function (serviceIdentifier, key, value) {\r\n        var getArgs = this._getNotAllArgs(serviceIdentifier, true, key, value);\r\n        return this._getButThrowIfAsync(getArgs);\r\n    };\r\n    Container.prototype.getAllTaggedAsync = function (serviceIdentifier, key, value) {\r\n        var getArgs = this._getNotAllArgs(serviceIdentifier, true, key, value);\r\n        return this._getAll(getArgs);\r\n    };\r\n    Container.prototype.getAllNamed = function (serviceIdentifier, named) {\r\n        return this.getAllTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\r\n    };\r\n    Container.prototype.getAllNamedAsync = function (serviceIdentifier, named) {\r\n        return this.getAllTaggedAsync(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\r\n    };\r\n    Container.prototype.resolve = function (constructorFunction) {\r\n        var isBound = this.isBound(constructorFunction);\r\n        if (!isBound) {\r\n            this.bind(constructorFunction).toSelf();\r\n        }\r\n        var resolved = this.get(constructorFunction);\r\n        if (!isBound) {\r\n            this.unbind(constructorFunction);\r\n        }\r\n        return resolved;\r\n    };\r\n    Container.prototype._preDestroy = function (constructor, instance) {\r\n        var _a, _b;\r\n        if (Reflect.hasMetadata(METADATA_KEY.PRE_DESTROY, constructor)) {\r\n            var data = Reflect.getMetadata(METADATA_KEY.PRE_DESTROY, constructor);\r\n            return (_b = (_a = instance)[data.value]) === null || _b === void 0 ? void 0 : _b.call(_a);\r\n        }\r\n    };\r\n    Container.prototype._removeModuleHandlers = function (moduleId) {\r\n        var moduleActivationsHandlers = this._moduleActivationStore.remove(moduleId);\r\n        this._activations.removeIntersection(moduleActivationsHandlers.onActivations);\r\n        this._deactivations.removeIntersection(moduleActivationsHandlers.onDeactivations);\r\n    };\r\n    Container.prototype._removeModuleBindings = function (moduleId) {\r\n        return this._bindingDictionary.removeByCondition(function (binding) { return binding.moduleId === moduleId; });\r\n    };\r\n    Container.prototype._deactivate = function (binding, instance) {\r\n        var _this = this;\r\n        var constructor = Object.getPrototypeOf(instance).constructor;\r\n        try {\r\n            if (this._deactivations.hasKey(binding.serviceIdentifier)) {\r\n                var result = this._deactivateContainer(instance, this._deactivations.get(binding.serviceIdentifier).values());\r\n                if ((0, async_1.isPromise)(result)) {\r\n                    return this._handleDeactivationError(result.then(function () { return _this._propagateContainerDeactivationThenBindingAndPreDestroyAsync(binding, instance, constructor); }), constructor);\r\n                }\r\n            }\r\n            var propagateDeactivationResult = this._propagateContainerDeactivationThenBindingAndPreDestroy(binding, instance, constructor);\r\n            if ((0, async_1.isPromise)(propagateDeactivationResult)) {\r\n                return this._handleDeactivationError(propagateDeactivationResult, constructor);\r\n            }\r\n        }\r\n        catch (ex) {\r\n            if (ex instanceof Error) {\r\n                throw new Error(ERROR_MSGS.ON_DEACTIVATION_ERROR(constructor.name, ex.message));\r\n            }\r\n        }\r\n    };\r\n    Container.prototype._handleDeactivationError = function (asyncResult, constructor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var ex_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        _a.trys.push([0, 2, , 3]);\r\n                        return [4, asyncResult];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [3, 3];\r\n                    case 2:\r\n                        ex_1 = _a.sent();\r\n                        if (ex_1 instanceof Error) {\r\n                            throw new Error(ERROR_MSGS.ON_DEACTIVATION_ERROR(constructor.name, ex_1.message));\r\n                        }\r\n                        return [3, 3];\r\n                    case 3: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype._deactivateContainer = function (instance, deactivationsIterator) {\r\n        var _this = this;\r\n        var deactivation = deactivationsIterator.next();\r\n        while (deactivation.value) {\r\n            var result = deactivation.value(instance);\r\n            if ((0, async_1.isPromise)(result)) {\r\n                return result.then(function () {\r\n                    return _this._deactivateContainerAsync(instance, deactivationsIterator);\r\n                });\r\n            }\r\n            deactivation = deactivationsIterator.next();\r\n        }\r\n    };\r\n    Container.prototype._deactivateContainerAsync = function (instance, deactivationsIterator) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var deactivation;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        deactivation = deactivationsIterator.next();\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        if (!deactivation.value) return [3, 3];\r\n                        return [4, deactivation.value(instance)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        deactivation = deactivationsIterator.next();\r\n                        return [3, 1];\r\n                    case 3: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype._getContainerModuleHelpersFactory = function () {\r\n        var _this = this;\r\n        var setModuleId = function (bindingToSyntax, moduleId) {\r\n            bindingToSyntax._binding.moduleId = moduleId;\r\n        };\r\n        var getBindFunction = function (moduleId) {\r\n            return function (serviceIdentifier) {\r\n                var bindingToSyntax = _this.bind(serviceIdentifier);\r\n                setModuleId(bindingToSyntax, moduleId);\r\n                return bindingToSyntax;\r\n            };\r\n        };\r\n        var getUnbindFunction = function () {\r\n            return function (serviceIdentifier) {\r\n                return _this.unbind(serviceIdentifier);\r\n            };\r\n        };\r\n        var getUnbindAsyncFunction = function () {\r\n            return function (serviceIdentifier) {\r\n                return _this.unbindAsync(serviceIdentifier);\r\n            };\r\n        };\r\n        var getIsboundFunction = function () {\r\n            return function (serviceIdentifier) {\r\n                return _this.isBound(serviceIdentifier);\r\n            };\r\n        };\r\n        var getRebindFunction = function (moduleId) {\r\n            return function (serviceIdentifier) {\r\n                var bindingToSyntax = _this.rebind(serviceIdentifier);\r\n                setModuleId(bindingToSyntax, moduleId);\r\n                return bindingToSyntax;\r\n            };\r\n        };\r\n        var getOnActivationFunction = function (moduleId) {\r\n            return function (serviceIdentifier, onActivation) {\r\n                _this._moduleActivationStore.addActivation(moduleId, serviceIdentifier, onActivation);\r\n                _this.onActivation(serviceIdentifier, onActivation);\r\n            };\r\n        };\r\n        var getOnDeactivationFunction = function (moduleId) {\r\n            return function (serviceIdentifier, onDeactivation) {\r\n                _this._moduleActivationStore.addDeactivation(moduleId, serviceIdentifier, onDeactivation);\r\n                _this.onDeactivation(serviceIdentifier, onDeactivation);\r\n            };\r\n        };\r\n        return function (mId) { return ({\r\n            bindFunction: getBindFunction(mId),\r\n            isboundFunction: getIsboundFunction(),\r\n            onActivationFunction: getOnActivationFunction(mId),\r\n            onDeactivationFunction: getOnDeactivationFunction(mId),\r\n            rebindFunction: getRebindFunction(mId),\r\n            unbindFunction: getUnbindFunction(),\r\n            unbindAsyncFunction: getUnbindAsyncFunction()\r\n        }); };\r\n    };\r\n    Container.prototype._getAll = function (getArgs) {\r\n        return Promise.all(this._get(getArgs));\r\n    };\r\n    Container.prototype._get = function (getArgs) {\r\n        var planAndResolveArgs = __assign(__assign({}, getArgs), { contextInterceptor: function (context) { return context; }, targetType: literal_types_1.TargetTypeEnum.Variable });\r\n        if (this._middleware) {\r\n            var middlewareResult = this._middleware(planAndResolveArgs);\r\n            if (middlewareResult === undefined || middlewareResult === null) {\r\n                throw new Error(ERROR_MSGS.INVALID_MIDDLEWARE_RETURN);\r\n            }\r\n            return middlewareResult;\r\n        }\r\n        return this._planAndResolve()(planAndResolveArgs);\r\n    };\r\n    Container.prototype._getButThrowIfAsync = function (getArgs) {\r\n        var result = this._get(getArgs);\r\n        if ((0, async_1.isPromiseOrContainsPromise)(result)) {\r\n            throw new Error(ERROR_MSGS.LAZY_IN_SYNC(getArgs.serviceIdentifier));\r\n        }\r\n        return result;\r\n    };\r\n    Container.prototype._getAllArgs = function (serviceIdentifier) {\r\n        var getAllArgs = {\r\n            avoidConstraints: true,\r\n            isMultiInject: true,\r\n            serviceIdentifier: serviceIdentifier,\r\n        };\r\n        return getAllArgs;\r\n    };\r\n    Container.prototype._getNotAllArgs = function (serviceIdentifier, isMultiInject, key, value) {\r\n        var getNotAllArgs = {\r\n            avoidConstraints: false,\r\n            isMultiInject: isMultiInject,\r\n            serviceIdentifier: serviceIdentifier,\r\n            key: key,\r\n            value: value,\r\n        };\r\n        return getNotAllArgs;\r\n    };\r\n    Container.prototype._planAndResolve = function () {\r\n        var _this = this;\r\n        return function (args) {\r\n            var context = (0, planner_1.plan)(_this._metadataReader, _this, args.isMultiInject, args.targetType, args.serviceIdentifier, args.key, args.value, args.avoidConstraints);\r\n            context = args.contextInterceptor(context);\r\n            var result = (0, resolver_1.resolve)(context);\r\n            return result;\r\n        };\r\n    };\r\n    Container.prototype._deactivateIfSingleton = function (binding) {\r\n        var _this = this;\r\n        if (!binding.activated) {\r\n            return;\r\n        }\r\n        if ((0, async_1.isPromise)(binding.cache)) {\r\n            return binding.cache.then(function (resolved) { return _this._deactivate(binding, resolved); });\r\n        }\r\n        return this._deactivate(binding, binding.cache);\r\n    };\r\n    Container.prototype._deactivateSingletons = function (bindings) {\r\n        for (var _i = 0, bindings_1 = bindings; _i < bindings_1.length; _i++) {\r\n            var binding = bindings_1[_i];\r\n            var result = this._deactivateIfSingleton(binding);\r\n            if ((0, async_1.isPromise)(result)) {\r\n                throw new Error(ERROR_MSGS.ASYNC_UNBIND_REQUIRED);\r\n            }\r\n        }\r\n    };\r\n    Container.prototype._deactivateSingletonsAsync = function (bindings) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, Promise.all(bindings.map(function (b) { return _this._deactivateIfSingleton(b); }))];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype._propagateContainerDeactivationThenBindingAndPreDestroy = function (binding, instance, constructor) {\r\n        if (this.parent) {\r\n            return this._deactivate.bind(this.parent)(binding, instance);\r\n        }\r\n        else {\r\n            return this._bindingDeactivationAndPreDestroy(binding, instance, constructor);\r\n        }\r\n    };\r\n    Container.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync = function (binding, instance, constructor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this.parent) return [3, 2];\r\n                        return [4, this._deactivate.bind(this.parent)(binding, instance)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [3, 4];\r\n                    case 2: return [4, this._bindingDeactivationAndPreDestroyAsync(binding, instance, constructor)];\r\n                    case 3:\r\n                        _a.sent();\r\n                        _a.label = 4;\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype._removeServiceFromDictionary = function (serviceIdentifier) {\r\n        try {\r\n            this._bindingDictionary.remove(serviceIdentifier);\r\n        }\r\n        catch (e) {\r\n            throw new Error(ERROR_MSGS.CANNOT_UNBIND + \" \" + (0, serialization_1.getServiceIdentifierAsString)(serviceIdentifier));\r\n        }\r\n    };\r\n    Container.prototype._bindingDeactivationAndPreDestroy = function (binding, instance, constructor) {\r\n        var _this = this;\r\n        if (typeof binding.onDeactivation === 'function') {\r\n            var result = binding.onDeactivation(instance);\r\n            if ((0, async_1.isPromise)(result)) {\r\n                return result.then(function () { return _this._preDestroy(constructor, instance); });\r\n            }\r\n        }\r\n        return this._preDestroy(constructor, instance);\r\n    };\r\n    Container.prototype._bindingDeactivationAndPreDestroyAsync = function (binding, instance, constructor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(typeof binding.onDeactivation === 'function')) return [3, 2];\r\n                        return [4, binding.onDeactivation(instance)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2: return [4, this._preDestroy(constructor, instance)];\r\n                    case 3:\r\n                        _a.sent();\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return Container;\r\n}());\r\nexports.Container = Container;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.AsyncContainerModule = exports.ContainerModule = void 0;\r\nvar id_1 = require(\"../utils/id\");\r\nvar ContainerModule = (function () {\r\n    function ContainerModule(registry) {\r\n        this.id = (0, id_1.id)();\r\n        this.registry = registry;\r\n    }\r\n    return ContainerModule;\r\n}());\r\nexports.ContainerModule = ContainerModule;\r\nvar AsyncContainerModule = (function () {\r\n    function AsyncContainerModule(registry) {\r\n        this.id = (0, id_1.id)();\r\n        this.registry = registry;\r\n    }\r\n    return AsyncContainerModule;\r\n}());\r\nexports.AsyncContainerModule = AsyncContainerModule;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getFirstArrayDuplicate = void 0;\r\nfunction getFirstArrayDuplicate(array) {\r\n    var seenValues = new Set();\r\n    for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\r\n        var entry = array_1[_i];\r\n        if (seenValues.has(entry)) {\r\n            return entry;\r\n        }\r\n        else {\r\n            seenValues.add(entry);\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\nexports.getFirstArrayDuplicate = getFirstArrayDuplicate;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.createTaggedDecorator = exports.tagProperty = exports.tagParameter = exports.decorate = void 0;\r\nvar ERROR_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar js_1 = require(\"../utils/js\");\r\nfunction targetIsConstructorFunction(target) {\r\n    return target.prototype !== undefined;\r\n}\r\nfunction _throwIfMethodParameter(parameterName) {\r\n    if (parameterName !== undefined) {\r\n        throw new Error(ERROR_MSGS.INVALID_DECORATOR_OPERATION);\r\n    }\r\n}\r\nfunction tagParameter(annotationTarget, parameterName, parameterIndex, metadata) {\r\n    _throwIfMethodParameter(parameterName);\r\n    _tagParameterOrProperty(METADATA_KEY.TAGGED, annotationTarget, parameterIndex.toString(), metadata);\r\n}\r\nexports.tagParameter = tagParameter;\r\nfunction tagProperty(annotationTarget, propertyName, metadata) {\r\n    if (targetIsConstructorFunction(annotationTarget)) {\r\n        throw new Error(ERROR_MSGS.INVALID_DECORATOR_OPERATION);\r\n    }\r\n    _tagParameterOrProperty(METADATA_KEY.TAGGED_PROP, annotationTarget.constructor, propertyName, metadata);\r\n}\r\nexports.tagProperty = tagProperty;\r\nfunction _ensureNoMetadataKeyDuplicates(metadata) {\r\n    var metadatas = [];\r\n    if (Array.isArray(metadata)) {\r\n        metadatas = metadata;\r\n        var duplicate = (0, js_1.getFirstArrayDuplicate)(metadatas.map(function (md) { return md.key; }));\r\n        if (duplicate !== undefined) {\r\n            throw new Error(ERROR_MSGS.DUPLICATED_METADATA + \" \" + duplicate.toString());\r\n        }\r\n    }\r\n    else {\r\n        metadatas = [metadata];\r\n    }\r\n    return metadatas;\r\n}\r\nfunction _tagParameterOrProperty(metadataKey, annotationTarget, key, metadata) {\r\n    var metadatas = _ensureNoMetadataKeyDuplicates(metadata);\r\n    var paramsOrPropertiesMetadata = {};\r\n    if (Reflect.hasOwnMetadata(metadataKey, annotationTarget)) {\r\n        paramsOrPropertiesMetadata = Reflect.getMetadata(metadataKey, annotationTarget);\r\n    }\r\n    var paramOrPropertyMetadata = paramsOrPropertiesMetadata[key];\r\n    if (paramOrPropertyMetadata === undefined) {\r\n        paramOrPropertyMetadata = [];\r\n    }\r\n    else {\r\n        var _loop_1 = function (m) {\r\n            if (metadatas.some(function (md) { return md.key === m.key; })) {\r\n                throw new Error(ERROR_MSGS.DUPLICATED_METADATA + \" \" + m.key.toString());\r\n            }\r\n        };\r\n        for (var _i = 0, paramOrPropertyMetadata_1 = paramOrPropertyMetadata; _i < paramOrPropertyMetadata_1.length; _i++) {\r\n            var m = paramOrPropertyMetadata_1[_i];\r\n            _loop_1(m);\r\n        }\r\n    }\r\n    paramOrPropertyMetadata.push.apply(paramOrPropertyMetadata, metadatas);\r\n    paramsOrPropertiesMetadata[key] = paramOrPropertyMetadata;\r\n    Reflect.defineMetadata(metadataKey, paramsOrPropertiesMetadata, annotationTarget);\r\n}\r\nfunction createTaggedDecorator(metadata) {\r\n    return function (target, targetKey, indexOrPropertyDescriptor) {\r\n        if (typeof indexOrPropertyDescriptor === 'number') {\r\n            tagParameter(target, targetKey, indexOrPropertyDescriptor, metadata);\r\n        }\r\n        else {\r\n            tagProperty(target, targetKey, metadata);\r\n        }\r\n    };\r\n}\r\nexports.createTaggedDecorator = createTaggedDecorator;\r\nfunction _decorate(decorators, target) {\r\n    Reflect.decorate(decorators, target);\r\n}\r\nfunction _param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); };\r\n}\r\nfunction decorate(decorator, target, parameterIndexOrProperty) {\r\n    if (typeof parameterIndexOrProperty === 'number') {\r\n        _decorate([_param(parameterIndexOrProperty, decorator)], target);\r\n    }\r\n    else if (typeof parameterIndexOrProperty === 'string') {\r\n        Reflect.decorate([decorator], target, parameterIndexOrProperty);\r\n    }\r\n    else {\r\n        _decorate([decorator], target);\r\n    }\r\n}\r\nexports.decorate = decorate;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.injectable = void 0;\r\nvar ERRORS_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nfunction injectable() {\r\n    return function (target) {\r\n        if (Reflect.hasOwnMetadata(METADATA_KEY.PARAM_TYPES, target)) {\r\n            throw new Error(ERRORS_MSGS.DUPLICATED_INJECTABLE_DECORATOR);\r\n        }\r\n        var types = Reflect.getMetadata(METADATA_KEY.DESIGN_PARAM_TYPES, target) || [];\r\n        Reflect.defineMetadata(METADATA_KEY.PARAM_TYPES, types, target);\r\n        return target;\r\n    };\r\n}\r\nexports.injectable = injectable;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.tagged = void 0;\r\nvar metadata_1 = require(\"../planning/metadata\");\r\nvar decorator_utils_1 = require(\"./decorator_utils\");\r\nfunction tagged(metadataKey, metadataValue) {\r\n    return (0, decorator_utils_1.createTaggedDecorator)(new metadata_1.Metadata(metadataKey, metadataValue));\r\n}\r\nexports.tagged = tagged;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.named = void 0;\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar metadata_1 = require(\"../planning/metadata\");\r\nvar decorator_utils_1 = require(\"./decorator_utils\");\r\nfunction named(name) {\r\n    return (0, decorator_utils_1.createTaggedDecorator)(new metadata_1.Metadata(METADATA_KEY.NAMED_TAG, name));\r\n}\r\nexports.named = named;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.injectBase = void 0;\r\nvar error_msgs_1 = require(\"../constants/error_msgs\");\r\nvar metadata_1 = require(\"../planning/metadata\");\r\nvar decorator_utils_1 = require(\"./decorator_utils\");\r\nfunction injectBase(metadataKey) {\r\n    return function (serviceIdentifier) {\r\n        return function (target, targetKey, indexOrPropertyDescriptor) {\r\n            if (serviceIdentifier === undefined) {\r\n                var className = typeof target === 'function' ? target.name : target.constructor.name;\r\n                throw new Error((0, error_msgs_1.UNDEFINED_INJECT_ANNOTATION)(className));\r\n            }\r\n            return (0, decorator_utils_1.createTaggedDecorator)(new metadata_1.Metadata(metadataKey, serviceIdentifier))(target, targetKey, indexOrPropertyDescriptor);\r\n        };\r\n    };\r\n}\r\nexports.injectBase = injectBase;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.inject = void 0;\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar inject_base_1 = require(\"./inject_base\");\r\nvar inject = (0, inject_base_1.injectBase)(METADATA_KEY.INJECT_TAG);\r\nexports.inject = inject;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.optional = void 0;\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar metadata_1 = require(\"../planning/metadata\");\r\nvar decorator_utils_1 = require(\"./decorator_utils\");\r\nfunction optional() {\r\n    return (0, decorator_utils_1.createTaggedDecorator)(new metadata_1.Metadata(METADATA_KEY.OPTIONAL_TAG, true));\r\n}\r\nexports.optional = optional;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.unmanaged = void 0;\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar metadata_1 = require(\"../planning/metadata\");\r\nvar decorator_utils_1 = require(\"./decorator_utils\");\r\nfunction unmanaged() {\r\n    return function (target, targetKey, index) {\r\n        var metadata = new metadata_1.Metadata(METADATA_KEY.UNMANAGED_TAG, true);\r\n        (0, decorator_utils_1.tagParameter)(target, targetKey, index, metadata);\r\n    };\r\n}\r\nexports.unmanaged = unmanaged;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.multiInject = void 0;\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar inject_base_1 = require(\"./inject_base\");\r\nvar multiInject = (0, inject_base_1.injectBase)(METADATA_KEY.MULTI_INJECT_TAG);\r\nexports.multiInject = multiInject;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.targetName = void 0;\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar metadata_1 = require(\"../planning/metadata\");\r\nvar decorator_utils_1 = require(\"./decorator_utils\");\r\nfunction targetName(name) {\r\n    return function (target, targetKey, index) {\r\n        var metadata = new metadata_1.Metadata(METADATA_KEY.NAME_TAG, name);\r\n        (0, decorator_utils_1.tagParameter)(target, targetKey, index, metadata);\r\n    };\r\n}\r\nexports.targetName = targetName;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.propertyEventDecorator = void 0;\r\nvar metadata_1 = require(\"../planning/metadata\");\r\nfunction propertyEventDecorator(eventKey, errorMessage) {\r\n    return function () {\r\n        return function (target, propertyKey) {\r\n            var metadata = new metadata_1.Metadata(eventKey, propertyKey);\r\n            if (Reflect.hasOwnMetadata(eventKey, target.constructor)) {\r\n                throw new Error(errorMessage);\r\n            }\r\n            Reflect.defineMetadata(eventKey, metadata, target.constructor);\r\n        };\r\n    };\r\n}\r\nexports.propertyEventDecorator = propertyEventDecorator;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.postConstruct = void 0;\r\nvar ERRORS_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar property_event_decorator_1 = require(\"./property_event_decorator\");\r\nvar postConstruct = (0, property_event_decorator_1.propertyEventDecorator)(METADATA_KEY.POST_CONSTRUCT, ERRORS_MSGS.MULTIPLE_POST_CONSTRUCT_METHODS);\r\nexports.postConstruct = postConstruct;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.preDestroy = void 0;\r\nvar ERRORS_MSGS = __importStar(require(\"../constants/error_msgs\"));\r\nvar METADATA_KEY = __importStar(require(\"../constants/metadata_keys\"));\r\nvar property_event_decorator_1 = require(\"./property_event_decorator\");\r\nvar preDestroy = (0, property_event_decorator_1.propertyEventDecorator)(METADATA_KEY.PRE_DESTROY, ERRORS_MSGS.MULTIPLE_PRE_DESTROY_METHODS);\r\nexports.preDestroy = preDestroy;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.interfaces = void 0;\r\nvar interfaces;\r\n(function (interfaces) {\r\n    ;\r\n})(interfaces || (interfaces = {}));\r\nexports.interfaces = interfaces;\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.multiBindToService = exports.getServiceIdentifierAsString = exports.typeConstraint = exports.namedConstraint = exports.taggedConstraint = exports.traverseAncerstors = exports.decorate = exports.interfaces = exports.id = exports.MetadataReader = exports.preDestroy = exports.postConstruct = exports.targetName = exports.multiInject = exports.unmanaged = exports.optional = exports.LazyServiceIdentifer = exports.LazyServiceIdentifier = exports.inject = exports.named = exports.tagged = exports.injectable = exports.createTaggedDecorator = exports.ContainerModule = exports.AsyncContainerModule = exports.TargetTypeEnum = exports.BindingTypeEnum = exports.BindingScopeEnum = exports.Container = exports.METADATA_KEY = void 0;\r\nvar keys = __importStar(require(\"./constants/metadata_keys\"));\r\nexports.METADATA_KEY = keys;\r\nvar container_1 = require(\"./container/container\");\r\nObject.defineProperty(exports, \"Container\", { enumerable: true, get: function () { return container_1.Container; } });\r\nvar literal_types_1 = require(\"./constants/literal_types\");\r\nObject.defineProperty(exports, \"BindingScopeEnum\", { enumerable: true, get: function () { return literal_types_1.BindingScopeEnum; } });\r\nObject.defineProperty(exports, \"BindingTypeEnum\", { enumerable: true, get: function () { return literal_types_1.BindingTypeEnum; } });\r\nObject.defineProperty(exports, \"TargetTypeEnum\", { enumerable: true, get: function () { return literal_types_1.TargetTypeEnum; } });\r\nvar container_module_1 = require(\"./container/container_module\");\r\nObject.defineProperty(exports, \"AsyncContainerModule\", { enumerable: true, get: function () { return container_module_1.AsyncContainerModule; } });\r\nObject.defineProperty(exports, \"ContainerModule\", { enumerable: true, get: function () { return container_module_1.ContainerModule; } });\r\nvar decorator_utils_1 = require(\"./annotation/decorator_utils\");\r\nObject.defineProperty(exports, \"createTaggedDecorator\", { enumerable: true, get: function () { return decorator_utils_1.createTaggedDecorator; } });\r\nvar injectable_1 = require(\"./annotation/injectable\");\r\nObject.defineProperty(exports, \"injectable\", { enumerable: true, get: function () { return injectable_1.injectable; } });\r\nvar tagged_1 = require(\"./annotation/tagged\");\r\nObject.defineProperty(exports, \"tagged\", { enumerable: true, get: function () { return tagged_1.tagged; } });\r\nvar named_1 = require(\"./annotation/named\");\r\nObject.defineProperty(exports, \"named\", { enumerable: true, get: function () { return named_1.named; } });\r\nvar inject_1 = require(\"./annotation/inject\");\r\nObject.defineProperty(exports, \"inject\", { enumerable: true, get: function () { return inject_1.inject; } });\r\nvar lazy_service_identifier_1 = require(\"./annotation/lazy_service_identifier\");\r\nObject.defineProperty(exports, \"LazyServiceIdentifier\", { enumerable: true, get: function () { return lazy_service_identifier_1.LazyServiceIdentifier; } });\r\nvar lazy_service_identifier_2 = require(\"./annotation/lazy_service_identifier\");\r\nObject.defineProperty(exports, \"LazyServiceIdentifer\", { enumerable: true, get: function () { return lazy_service_identifier_2.LazyServiceIdentifier; } });\r\nvar optional_1 = require(\"./annotation/optional\");\r\nObject.defineProperty(exports, \"optional\", { enumerable: true, get: function () { return optional_1.optional; } });\r\nvar unmanaged_1 = require(\"./annotation/unmanaged\");\r\nObject.defineProperty(exports, \"unmanaged\", { enumerable: true, get: function () { return unmanaged_1.unmanaged; } });\r\nvar multi_inject_1 = require(\"./annotation/multi_inject\");\r\nObject.defineProperty(exports, \"multiInject\", { enumerable: true, get: function () { return multi_inject_1.multiInject; } });\r\nvar target_name_1 = require(\"./annotation/target_name\");\r\nObject.defineProperty(exports, \"targetName\", { enumerable: true, get: function () { return target_name_1.targetName; } });\r\nvar post_construct_1 = require(\"./annotation/post_construct\");\r\nObject.defineProperty(exports, \"postConstruct\", { enumerable: true, get: function () { return post_construct_1.postConstruct; } });\r\nvar pre_destroy_1 = require(\"./annotation/pre_destroy\");\r\nObject.defineProperty(exports, \"preDestroy\", { enumerable: true, get: function () { return pre_destroy_1.preDestroy; } });\r\nvar metadata_reader_1 = require(\"./planning/metadata_reader\");\r\nObject.defineProperty(exports, \"MetadataReader\", { enumerable: true, get: function () { return metadata_reader_1.MetadataReader; } });\r\nvar id_1 = require(\"./utils/id\");\r\nObject.defineProperty(exports, \"id\", { enumerable: true, get: function () { return id_1.id; } });\r\nvar interfaces_1 = require(\"./interfaces/interfaces\");\r\nObject.defineProperty(exports, \"interfaces\", { enumerable: true, get: function () { return interfaces_1.interfaces; } });\r\nvar decorator_utils_2 = require(\"./annotation/decorator_utils\");\r\nObject.defineProperty(exports, \"decorate\", { enumerable: true, get: function () { return decorator_utils_2.decorate; } });\r\nvar constraint_helpers_1 = require(\"./syntax/constraint_helpers\");\r\nObject.defineProperty(exports, \"traverseAncerstors\", { enumerable: true, get: function () { return constraint_helpers_1.traverseAncerstors; } });\r\nObject.defineProperty(exports, \"taggedConstraint\", { enumerable: true, get: function () { return constraint_helpers_1.taggedConstraint; } });\r\nObject.defineProperty(exports, \"namedConstraint\", { enumerable: true, get: function () { return constraint_helpers_1.namedConstraint; } });\r\nObject.defineProperty(exports, \"typeConstraint\", { enumerable: true, get: function () { return constraint_helpers_1.typeConstraint; } });\r\nvar serialization_1 = require(\"./utils/serialization\");\r\nObject.defineProperty(exports, \"getServiceIdentifierAsString\", { enumerable: true, get: function () { return serialization_1.getServiceIdentifierAsString; } });\r\nvar binding_utils_1 = require(\"./utils/binding_utils\");\r\nObject.defineProperty(exports, \"multiBindToService\", { enumerable: true, get: function () { return binding_utils_1.multiBindToService; } });\r\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport function isObject(data: unknown): data is Record<PropertyKey, unknown> {\n    return typeof data === 'object' && data !== null;\n}\n\nexport type TypeOf<T> =\n    T extends number ? 'number'\n    : T extends string ? 'string'\n    : T extends boolean ? 'boolean'\n    : T extends bigint ? 'bigint'\n    : T extends symbol ? 'symbol'\n    : T extends Function ? 'function'\n    : T extends object ? 'object'\n    : 'undefined';\n\nexport function hasOwnProperty<K extends PropertyKey, T>(arg: unknown, key: K | K[], type?: TypeOf<T> | ((v: unknown) => v is T)): arg is Record<K, T> {\n    if (!isObject(arg)) {\n        return false;\n    }\n    if (Array.isArray(key)) {\n        for (const k of key) {\n            if (!Object.prototype.hasOwnProperty.call(arg, k)) {\n                return false;\n            }\n            if (typeof type === 'string' && typeof arg[k] !== type) {\n                return false;\n            } else if (typeof type === 'function' && !type(arg[k])) {\n                return false;\n            }\n        }\n    } else {\n        if (!Object.prototype.hasOwnProperty.call(arg, key)) {\n            return false;\n        }\n        if (typeof type === 'string') {\n            return typeof arg[key] === type;\n        }\n        if (typeof type === 'function') {\n            return type(arg[key]);\n        }\n    }\n    return true;\n}\n\nexport function safeAssign<T extends {}>(target: T, partial: Partial<T>): T {\n    return Object.assign(target, partial);\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelRoot, SModelElement, Viewport } from './model';\nimport { Bounds, Point, Dimension } from './utils/geometry';\nimport { JsonAny, JsonMap } from './utils/json';\nimport { hasOwnProperty } from './utils/object';\n\n/**\n * Wrapper for actions when transferring them between client and server.\n * The `clientId` is used to identify the specific diagram instance in the client.\n */\nexport interface ActionMessage {\n    clientId: string\n    action: Action\n}\n\nexport function isActionMessage(object: unknown): object is ActionMessage {\n    return hasOwnProperty(object, 'action');\n}\n\n/**\n * An action describes a change to the model declaratively.\n * It is a plain data structure, and as such transferable between server and client.\n */\nexport interface Action {\n    kind: string;\n}\n\nexport function isAction(object?: unknown): object is Action {\n    return hasOwnProperty<string, string>(object, 'kind', 'string');\n}\n\n/**\n * A request action is tied to the expectation of receiving a corresponding response action.\n * The `requestId` property is used to match the received response with the original request.\n */\nexport interface RequestAction<Res extends ResponseAction> extends Action {\n    requestId: string\n\n    /**\n     * Used to ensure correct typing. Clients must not use this property\n     */\n    readonly _?: Res;\n}\n\nexport function isRequestAction(object?: Action): object is RequestAction<ResponseAction> {\n    return hasOwnProperty<string, string>(object, 'requestId', 'string');\n}\n\nlet requestContext = '';\nlet nextRequestId = 1;\n/**\n * Generate a unique `requestId` for a request action.\n */\nexport function generateRequestId(): string {\n    return `${requestContext}_${nextRequestId++}`;\n}\n\n/**\n * Configure the context in which request actions are created. This is typically either\n * 'client' or 'server' to avoid collisions of request IDs.\n */\nexport function setRequestContext(context: string): void {\n    requestContext = context;\n}\n\n/**\n * A response action is sent to respond to a request action. The `responseId` must match\n * the `requestId` of the preceding request. In case the `responseId` is empty or undefined,\n * the action is handled as standalone, i.e. it was fired without a preceding request.\n */\nexport interface ResponseAction extends Action {\n    responseId: string;\n}\n\n/**\n * A response action is sent to respond to a request action. The `responseId` must match\n * the `requestId` of the preceding request. In case the `responseId` is empty or undefined,\n * the action is handled as standalone, i.e. it was fired without a preceding request.\n */\n\nexport function isResponseAction(object?: Action): object is ResponseAction {\n    return hasOwnProperty<string, string>(object, 'responseId', 'string') && object.responseId !== '';\n}\n\n/**\n * A reject action is fired to indicate that a request must be rejected.\n */\nexport interface RejectAction extends ResponseAction {\n    kind: typeof RejectAction.KIND\n    message: string\n    detail?: JsonAny\n}\nexport namespace RejectAction {\n    export const KIND = 'rejectRequest';\n\n    export function create(options: { message: string, detail?: JsonAny, requestId: string }): RejectAction {\n        return {\n            kind: KIND,\n            message: options.message,\n            detail: options.detail,\n            responseId: options.requestId\n        };\n    }\n}\n\n/**\n * Sent from the client to the model source (e.g. a DiagramServer) in order to request a model. Usually this\n * is the first message that is sent to the source, so it is also used to initiate the communication.\n * The response is a SetModelAction or an UpdateModelAction.\n */\nexport interface RequestModelAction extends RequestAction<SetModelAction> {\n    kind: typeof RequestModelAction.KIND\n    options?: JsonMap\n}\nexport namespace RequestModelAction {\n    export const KIND = 'requestModel';\n\n    export function create(options?: JsonMap): RequestModelAction {\n        return {\n            kind: KIND,\n            options,\n            requestId: generateRequestId()\n        };\n    }\n}\n\n/**\n * Sent from the model source to the client in order to set the model. If a model is already present, it is replaced.\n */\nexport interface SetModelAction extends ResponseAction {\n    kind: typeof SetModelAction.KIND\n    newRoot: SModelRoot\n}\nexport namespace SetModelAction {\n    export const KIND = 'setModel';\n\n    export function create(newRoot: SModelRoot, requestId: string = ''): SetModelAction {\n        return {\n            kind: KIND,\n            newRoot,\n            responseId: requestId\n        };\n    }\n}\n\n/**\n * Sent from the model source to the client in order to update the model. If no model is present yet,\n * this behaves the same as a SetModelAction. The transition from the old model to the new one can be animated.\n */\nexport interface UpdateModelAction {\n    kind: typeof UpdateModelAction.KIND\n    newRoot?: SModelRoot\n    matches?: Match[]\n    animate?: boolean\n    cause?: Action\n}\nexport namespace UpdateModelAction {\n    export const KIND = 'updateModel';\n\n    export function create(input: SModelRoot | Match[], options: { animate?: boolean, cause?: Action } = {}): UpdateModelAction {\n        if (Array.isArray(input)) {\n            return {\n                kind: KIND,\n                matches: input,\n                animate: options.animate,\n                cause: options.cause\n            };\n        } else {\n            return {\n                kind: KIND,\n                newRoot: input,\n                animate: options.animate,\n                cause: options.cause\n            };\n        }\n    }\n}\n\nexport interface Match {\n    left?: SModelElement\n    right?: SModelElement\n    leftParentId?: string\n    rightParentId?: string\n}\n\n/**\n * Triggered when the user hovers the mouse pointer over an element to get a popup with details on\n * that element. This action is sent from the client to the model source, e.g. a DiagramServer.\n * The response is a SetPopupModelAction.\n */\nexport interface RequestPopupModelAction extends RequestAction<SetPopupModelAction> {\n    kind: typeof RequestPopupModelAction.KIND\n    elementId: string\n    bounds: Bounds\n}\nexport namespace RequestPopupModelAction {\n    export const KIND = 'requestPopupModel';\n\n    export function create(options: { elementId: string, bounds: Bounds }): RequestPopupModelAction {\n        return {\n            kind: KIND,\n            elementId: options.elementId,\n            bounds: options.bounds,\n            requestId: generateRequestId()\n        };\n    }\n}\n\n/**\n * Sent from the model source to the client to display a popup in response to a RequestPopupModelAction.\n * This action can also be used to remove any existing popup by choosing EMPTY_ROOT as root element.\n */\nexport interface SetPopupModelAction extends ResponseAction {\n    kind: typeof SetPopupModelAction.KIND\n    newRoot: SModelRoot\n}\nexport namespace SetPopupModelAction {\n    export const KIND = 'setPopupModel';\n\n    export function create(newRoot: SModelRoot, requestId: string = ''): SetPopupModelAction {\n        return {\n            kind: KIND,\n            newRoot,\n            responseId: requestId\n        };\n    }\n}\n\n/**\n * Sent from the model source (e.g. a DiagramServer) to the client to update the bounds of some\n * (or all) model elements.\n */\nexport interface SetBoundsAction extends Action {\n    kind: typeof SetBoundsAction.KIND\n    bounds: ElementAndBounds[]\n}\nexport namespace SetBoundsAction {\n    export const KIND = 'setBounds';\n\n    export function create(bounds: ElementAndBounds[]): SetBoundsAction {\n        return {\n            kind: KIND,\n            bounds\n        };\n    }\n}\n\n/**\n * Sent from the model source to the client to request bounds for the given model. The model is\n * rendered invisibly so the bounds can derived from the DOM. The response is a ComputedBoundsAction.\n * This hidden rendering round-trip is necessary if the client is responsible for parts of the layout\n * (see `needsClientLayout` viewer option).\n */\nexport interface RequestBoundsAction extends RequestAction<ComputedBoundsAction> {\n    kind: typeof RequestBoundsAction.KIND\n    newRoot: SModelRoot\n}\nexport namespace RequestBoundsAction {\n    export const KIND = 'requestBounds';\n\n    export function create(newRoot: SModelRoot): RequestBoundsAction {\n        return {\n            kind: KIND,\n            newRoot,\n            requestId: generateRequestId()\n        };\n    }\n}\n\n/**\n * Sent from the client to the model source (e.g. a DiagramServer) to transmit the result of bounds\n * computation as a response to a RequestBoundsAction. If the server is responsible for parts of\n * the layout (see `needsServerLayout` viewer option), it can do so after applying the computed bounds\n * received with this action. Otherwise there is no need to send the computed bounds to the server,\n * so they can be processed locally by the client.\n */\nexport interface ComputedBoundsAction extends ResponseAction {\n    kind: typeof ComputedBoundsAction.KIND\n    bounds: ElementAndBounds[]\n    revision?: number\n    alignments?: ElementAndAlignment[]\n}\nexport namespace ComputedBoundsAction {\n    export const KIND = 'computedBounds';\n\n    export function create(bounds: ElementAndBounds[], options: { revision?: number, alignments?: ElementAndAlignment[], requestId?: string } = {}): ComputedBoundsAction {\n        return {\n            kind: KIND,\n            bounds,\n            revision: options.revision,\n            alignments: options.alignments,\n            responseId: options.requestId ?? ''\n        };\n    }\n}\n\n/**\n * Associates new bounds with a model element, which is referenced via its id.\n */\nexport interface ElementAndBounds {\n    elementId: string\n    newPosition?: Point\n    newSize: Dimension\n}\n\n/**\n * Associates a new alignment with a model element, which is referenced via its id.\n */\nexport interface ElementAndAlignment {\n    elementId: string\n    newAlignment: Point\n}\n\n/**\n * Transport logging data to be stored elsewhere.\n */\nexport interface LoggingAction extends Action {\n    kind: typeof LoggingAction.KIND;\n    severity: string\n    time: string\n    caller: string\n    message: string\n    params: string[]\n}\nexport namespace LoggingAction {\n    export const KIND = 'logging';\n\n    export function create(options: { severity: string, time: string, caller: string, message: string, params: string[] }): LoggingAction {\n        return {\n            kind: KIND,\n            ...options\n        };\n    }\n}\n\n/**\n * Triggered when the user changes the selection, e.g. by clicking on a selectable element. The resulting\n * SelectCommand changes the `selected` state accordingly, so the elements can be rendered differently.\n * This action is also forwarded to the diagram server, if present, so it may react on the selection change.\n * Furthermore, the server can send such an action to the client in order to change the selection programmatically.\n */\nexport interface SelectAction {\n    kind: typeof SelectAction.KIND\n    selectedElementsIDs: string[]\n    deselectedElementsIDs: string[]\n}\nexport namespace SelectAction {\n    export const KIND = 'elementSelected';\n\n    export function create(options: { selectedElementsIDs?: string[], deselectedElementsIDs?: string[] }): SelectAction {\n        return {\n            kind: KIND,\n            selectedElementsIDs: options.selectedElementsIDs ?? [],\n            deselectedElementsIDs: options.deselectedElementsIDs ?? []\n        };\n    }\n}\n\n/**\n * Programmatic action for selecting or deselecting all elements.\n * If `select` is true, all elements are selected, otherwise they are deselected.\n */\nexport interface SelectAllAction {\n    kind: typeof SelectAllAction.KIND\n    select: boolean\n}\nexport namespace SelectAllAction {\n    export const KIND = 'allSelected';\n\n    export function create(options: { select?: boolean } = {}): SelectAllAction {\n        return {\n            kind: KIND,\n            select: options.select ?? true\n        };\n    }\n}\n\n/**\n * Request action for retrieving the current selection.\n */\nexport interface GetSelectionAction extends RequestAction<SelectionResult> {\n    kind: typeof GetSelectionAction.KIND\n}\nexport namespace GetSelectionAction {\n    export const KIND = 'getSelection';\n\n    export function create(): GetSelectionAction {\n        return {\n            kind: KIND,\n            requestId: generateRequestId()\n        };\n    }\n}\n\n/**\n * Result for a `GetSelectionAction`.\n */\nexport interface SelectionResult extends ResponseAction {\n    kind: typeof SelectionResult.KIND\n    selectedElementsIDs: string[]\n}\nexport namespace SelectionResult {\n    export const KIND = 'selectionResult';\n\n    export function create(selectedElementsIDs: string[], requestId: string): SelectionResult {\n        return {\n            kind: KIND,\n            selectedElementsIDs,\n            responseId: requestId\n        };\n    }\n}\n\n/**\n * Sent from the client to the model source to recalculate a diagram when elements\n * are collapsed/expanded by the client.\n */\nexport interface CollapseExpandAction {\n    kind: typeof CollapseExpandAction.KIND\n    expandIds: string[]\n    collapseIds: string[]\n}\nexport namespace CollapseExpandAction {\n    export const KIND = 'collapseExpand';\n\n    export function create(options: { expandIds?: string[], collapseIds?: string[] }): CollapseExpandAction {\n        return {\n            kind: KIND,\n            expandIds: options.expandIds ?? [],\n            collapseIds: options.collapseIds ?? []\n        };\n    }\n}\n\n/**\n * Programmatic action for expanding or collapsing all elements.\n * If `expand` is true, all elements are expanded, otherwise they are collapsed.\n */\nexport interface CollapseExpandAllAction {\n    kind: typeof CollapseExpandAllAction.KIND\n    expand: boolean\n}\nexport namespace CollapseExpandAllAction {\n    export const KIND = 'collapseExpandAll';\n\n    export function create(options: { expand?: boolean } = {}): CollapseExpandAllAction {\n        return {\n            kind: KIND,\n            expand: options.expand ?? true\n        };\n    }\n}\n\nexport interface OpenAction {\n    kind: typeof OpenAction.KIND\n    elementId: string\n}\nexport namespace OpenAction {\n    export const KIND = 'open';\n\n    export function create(elementId: string): OpenAction {\n        return {\n            kind: KIND,\n            elementId\n        };\n    }\n}\n\n/**\n * Request a layout of the diagram or the selected elements only.\n */\nexport interface LayoutAction {\n    kind: typeof LayoutAction.KIND\n    layoutType?: string\n    elementIds?: string[]\n}\nexport namespace LayoutAction {\n    export const KIND = 'layout';\n\n    export function create(options: { layoutType?: string, elementIds?: string[] } = {}): LayoutAction {\n        return {\n            kind: KIND,\n            layoutType: options.layoutType,\n            elementIds: options.elementIds\n        };\n    }\n}\n\n/**\n * Triggered when the user requests the viewer to center on the current model. The resulting\n * CenterCommand changes the scroll setting of the viewport accordingly.\n * It also resets the zoom to its default if retainZoom is false.\n * This action can also be sent from the model source to the client in order to perform such a\n * viewport change programmatically.\n */\nexport interface CenterAction extends Action {\n    kind: typeof CenterAction.KIND\n    elementIds: string[]\n    animate: boolean\n    retainZoom: boolean\n    zoomScale?: number\n}\nexport namespace CenterAction {\n    export const KIND = 'center';\n\n    export function create(elementIds: string[], options: { animate?: boolean, retainZoom?: boolean, zoomScale?: number } = {}): CenterAction {\n        return {\n            kind: KIND,\n            elementIds,\n            animate: options.animate ?? true,\n            retainZoom: options.retainZoom ?? false,\n            zoomScale: options.zoomScale\n        };\n    }\n}\n\n/**\n * Triggered when the user requests the viewer to fit its content to the available drawing area.\n * The resulting FitToScreenCommand changes the zoom and scroll settings of the viewport so the model\n * can be shown completely. This action can also be sent from the model source to the client in order\n * to perform such a viewport change programmatically.\n */\nexport interface FitToScreenAction extends Action {\n    kind: typeof FitToScreenAction.KIND;\n    elementIds: string[]\n    padding?: number\n    maxZoom?: number\n    animate: boolean\n}\nexport namespace FitToScreenAction {\n    export const KIND = 'fit';\n\n    export function create(elementIds: string[], options: { padding?: number, maxZoom?: number, animate?: boolean } = {}): FitToScreenAction {\n        return {\n            kind: KIND,\n            elementIds,\n            padding: options.padding,\n            maxZoom: options.maxZoom,\n            animate: options.animate ?? true\n        };\n    }\n}\n\n/**\n * Directly set the diagram viewport to the given scroll and zoom values.\n * The ID of the viewport element to manipulate must be given with the action\n * (usually it is the root element's ID).\n */\nexport interface SetViewportAction extends Action {\n    kind: typeof SetViewportAction.KIND;\n    elementId: string\n    newViewport: Viewport\n    animate: boolean\n}\nexport namespace SetViewportAction {\n    export const KIND = 'viewport';\n\n    export function create(elementId: string, newViewport: Viewport, options: { animate?: boolean } = {}): SetViewportAction {\n        return {\n            kind: KIND,\n            elementId,\n            newViewport,\n            animate: options.animate ?? true\n        };\n    }\n}\n\n/**\n * Request action for retrieving the current viewport and canvas bounds.\n */\nexport interface GetViewportAction extends RequestAction<ViewportResult> {\n    kind: typeof GetViewportAction.KIND;\n}\nexport namespace GetViewportAction {\n    export const KIND = 'getViewport';\n\n    export function create(): GetViewportAction {\n        return {\n            kind: KIND,\n            requestId: generateRequestId()\n        };\n    }\n}\n\n/**\n * Response to a `GetViewportAction`.\n */\nexport interface ViewportResult extends ResponseAction {\n    kind: typeof ViewportResult.KIND;\n    viewport: Viewport\n    canvasBounds: Bounds\n}\nexport namespace ViewportResult {\n    export const KIND = 'viewportResult';\n\n    export function create(viewport: Viewport, canvasBounds: Bounds, requestId: string): ViewportResult {\n        return {\n            kind: KIND,\n            viewport,\n            canvasBounds,\n            responseId: requestId\n        };\n    }\n}\n\n/**\n * Action to render the selected elements in front of others by manipulating the z-order.\n */\nexport interface BringToFrontAction extends Action {\n    kind: typeof BringToFrontAction.KIND;\n    elementIDs: string[]\n}\nexport namespace BringToFrontAction {\n    export const KIND = 'bringToFront';\n\n    export function create(elementIDs: string[]): BringToFrontAction {\n        return {\n            kind: KIND,\n            elementIDs\n        };\n    }\n}\n\n/**\n * Undo the previous operation on the stack of operations.\n */\nexport interface UndoAction extends Action {\n    kind: typeof UndoAction.KIND;\n}\nexport namespace UndoAction {\n    export const KIND = 'undo';\n\n    export function create(): UndoAction {\n        return {\n            kind: KIND\n        };\n    }\n}\n\n/**\n * Redo a previously undone operation.\n */\nexport interface RedoAction extends Action {\n    kind: typeof RedoAction.KIND;\n}\nexport namespace RedoAction {\n    export const KIND = 'redo';\n\n    export function create(): RedoAction {\n        return {\n            kind: KIND\n        };\n    }\n}\n\n/**\n * Move an arbitrary set of elements to new positions.\n */\nexport interface MoveAction extends Action {\n    kind: typeof MoveAction.KIND\n    moves: ElementMove[]\n    animate: boolean\n    finished: boolean\n}\nexport namespace MoveAction {\n    export const KIND = 'move';\n\n    export function create(moves: ElementMove[], options: { animate?: boolean, finished?: boolean } = {}): MoveAction {\n        return {\n            kind: KIND,\n            moves,\n            animate: options.animate ?? true,\n            finished: options.finished ?? false\n        };\n    }\n}\n\nexport interface ElementMove {\n    elementId: string\n    elementType?: string\n    fromPosition?: Point\n    toPosition: Point\n}\n\n/**\n * Triggered when the user puts the mouse pointer over an element.\n */\nexport interface HoverFeedbackAction extends Action {\n    kind: typeof HoverFeedbackAction.KIND\n    mouseoverElement: string\n    mouseIsOver: boolean\n}\nexport namespace HoverFeedbackAction {\n    export const KIND = 'hoverFeedback';\n\n    export function create(options: { mouseoverElement: string, mouseIsOver: boolean }): HoverFeedbackAction {\n        return {\n            kind: KIND,\n            mouseoverElement: options.mouseoverElement,\n            mouseIsOver: options.mouseIsOver\n        };\n    }\n}\n\n/**\n * Create an element with the given schema and add it to the diagram.\n */\nexport interface CreateElementAction extends Action {\n    kind: typeof CreateElementAction.KIND\n    containerId: string\n    elementSchema: SModelElement\n}\nexport namespace CreateElementAction {\n    export const KIND = 'createElement';\n\n    export function create(elementSchema: SModelElement, options: { containerId: string }): CreateElementAction {\n        return {\n            kind: KIND,\n            elementSchema,\n            containerId: options.containerId\n        };\n    }\n}\n\n/**\n * Delete a set of elements identified by their IDs.\n */\nexport interface DeleteElementAction extends Action {\n    kind: typeof DeleteElementAction.KIND\n    elementIds: string[]\n}\nexport namespace DeleteElementAction {\n    export const KIND = 'delete';\n\n    export function create(elementIds: string[]): DeleteElementAction {\n        return {\n            kind: KIND,\n            elementIds\n        };\n    }\n}\n\n/**\n * Apply a text change to a label element.\n */\nexport interface ApplyLabelEditAction extends Action {\n    kind: typeof ApplyLabelEditAction.KIND;\n    labelId: string,\n    text: string\n}\nexport namespace ApplyLabelEditAction {\n    export const KIND = 'applyLabelEdit';\n\n    export function create(labelId: string, text: string): ApplyLabelEditAction {\n        return {\n            kind: KIND,\n            labelId,\n            text\n        };\n    }\n}\n\n/**\n * Change the source or target node of a routable element (edge of a graph).\n */\nexport interface ReconnectAction extends Action {\n    kind: typeof ReconnectAction.KIND\n    routableId: string\n    newSourceId?: string\n    newTargetId?: string\n}\nexport namespace ReconnectAction {\n    export const KIND = 'reconnect';\n\n    export function create(options: { routableId: string, newSourceId?: string, newTargetId?: string }): ReconnectAction {\n        return {\n            kind: KIND,\n            routableId: options.routableId,\n            newSourceId: options.newSourceId,\n            newTargetId: options.newTargetId\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/**\n * Simple implementation of the deferred pattern.\n * An object that exposes a promise and functions to resolve and reject it.\n */\nexport class Deferred<T> {\n    resolve: (value?: T | PromiseLike<T>) => void;\n    reject: (reason?: any) => void;\n    readonly promise: Promise<T>;\n    private _state: DeferredState = 'unresolved';\n\n\n    constructor() {\n        this.promise = new Promise<T>((resolve, reject) => {\n            this.resolve = resolve;\n            this.reject = reject;\n        });\n        this.promise.then(\n            res => this._state = 'resolved',\n            rej => this._state = 'rejected'\n        );\n    }\n\n    private set state(state: DeferredState) {\n        if (this._state === 'unresolved') {\n            this._state = state;\n        }\n    }\n\n    get state(): DeferredState {\n        return this._state;\n    }\n}\n\nexport type DeferredState = 'resolved' | 'rejected' | 'unresolved';\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n /* eslint-disable @typescript-eslint/naming-convention */\nexport const TYPES = {\n    Action: Symbol('Action'),\n    IActionDispatcher: Symbol('IActionDispatcher'),\n    IActionDispatcherProvider: Symbol('IActionDispatcherProvider'),\n    IActionHandlerInitializer: Symbol('IActionHandlerInitializer'),\n    ActionHandlerRegistration: Symbol('ActionHandlerRegistration'),\n    ActionHandlerRegistryProvider: Symbol('ActionHandlerRegistryProvider'),\n    IAnchorComputer: Symbol('IAnchor'),\n    AnimationFrameSyncer: Symbol('AnimationFrameSyncer'),\n    IButtonHandlerRegistration: Symbol('IButtonHandlerRegistration'),\n    ICommandPaletteActionProvider: Symbol('ICommandPaletteActionProvider'),\n    ICommandPaletteActionProviderRegistry: Symbol('ICommandPaletteActionProviderRegistry'),\n    CommandRegistration: Symbol('CommandRegistration'),\n    ICommandStack: Symbol('ICommandStack'),\n    CommandStackOptions: Symbol('CommandStackOptions'),\n    ICommandStackProvider: Symbol('ICommandStackProvider'),\n    IContextMenuItemProvider: Symbol.for(\"IContextMenuProvider\"),\n    IContextMenuProviderRegistry: Symbol.for(\"IContextMenuProviderRegistry\"),\n    IContextMenuService: Symbol.for(\"IContextMenuService\"),\n    IContextMenuServiceProvider: Symbol.for(\"IContextMenuServiceProvider\"),\n    DOMHelper: Symbol('DOMHelper'),\n    IDiagramLocker: Symbol('IDiagramLocker'),\n    IEdgeRouter: Symbol('IEdgeRouter'),\n    IEdgeRoutePostprocessor: Symbol('IEdgeRoutePostprocessor'),\n    IEditLabelValidationDecorator: Symbol('IEditLabelValidationDecorator'),\n    IEditLabelValidator: Symbol('IEditLabelValidator'),\n    HiddenModelViewer: Symbol('HiddenModelViewer'),\n    HiddenVNodePostprocessor: Symbol('HiddenVNodeDecorator'),\n    HoverState: Symbol('HoverState'),\n    KeyListener: Symbol('KeyListener'),\n    LayoutRegistration: Symbol('LayoutRegistration'),\n    LayoutRegistry: Symbol('LayoutRegistry'),\n    Layouter: Symbol('Layouter'),\n    LogLevel: Symbol('LogLevel'),\n    ILogger: Symbol('ILogger'),\n    IModelFactory: Symbol('IModelFactory'),\n    IModelLayoutEngine: Symbol('IModelLayoutEngine'),\n    ModelRendererFactory: Symbol('ModelRendererFactory'),\n    ModelSource: Symbol('ModelSource'),\n    ModelSourceProvider: Symbol('ModelSourceProvider'),\n    ModelViewer: Symbol('ModelViewer'),\n    MouseListener: Symbol('MouseListener'),\n    PatcherProvider: Symbol('PatcherProvider'),\n    IPopupModelProvider: Symbol('IPopupModelProvider'),\n    PopupModelViewer: Symbol('PopupModelViewer'),\n    PopupMouseListener: Symbol('PopupMouseListener'),\n    PopupVNodePostprocessor: Symbol('PopupVNodeDecorator'),\n    SModelElementRegistration: Symbol('SModelElementRegistration'),\n    SModelRegistry: Symbol('SModelRegistry'),\n    ISnapper: Symbol('ISnapper'),\n    SvgExporter: Symbol('SvgExporter'),\n    IUIExtension: Symbol('IUIExtension'),\n    UIExtensionRegistry: Symbol('UIExtensionRegistry'),\n    IVNodePostprocessor: Symbol('IVNodePostprocessor'),\n    ViewRegistration: Symbol('ViewRegistration'),\n    ViewRegistry: Symbol('ViewRegistry'),\n    IViewer: Symbol('IViewer'),\n    ViewerOptions: Symbol('ViewerOptions'),\n    IViewerProvider: Symbol('IViewerProvider'),\n};\n/* eslint-enable */\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from \"inversify\";\n\n@injectable()\nexport class ProviderRegistry<T, U> {\n    protected elements: Map<string, new (u: U) => T> = new Map;\n\n    register(key: string, cstr: new (u: U) => T) {\n        if (key === undefined)\n            throw new Error('Key is undefined');\n        if (this.hasKey(key))\n            throw new Error('Key is already registered: ' + key);\n        this.elements.set(key, cstr);\n    }\n\n    deregister(key: string) {\n        if (key === undefined)\n            throw new Error('Key is undefined');\n        this.elements.delete(key);\n    }\n\n    hasKey(key: string): boolean {\n        return this.elements.has(key);\n    }\n\n    get(key: string, arg: U): T {\n        const existingCstr = this.elements.get(key);\n        if (existingCstr)\n            return new existingCstr(arg);\n        else\n            return this.missing(key, arg);\n    }\n\n    protected missing(key: string, arg: U): T | never {\n        throw new Error('Unknown registry key: ' + key);\n    }\n}\n\n@injectable()\nexport class FactoryRegistry<T, U> {\n    protected elements: Map<string, (u: U) => T> = new Map;\n\n    register(key: string, factory: (u: U) => T) {\n        if (key === undefined) {\n            throw new Error('Key is undefined');\n        }\n        if (this.hasKey(key)) {\n            throw new Error('Key is already registered: ' + key);\n        }\n        this.elements.set(key, factory);\n    }\n\n    deregister(key: string) {\n        if (key === undefined) {\n            throw new Error('Key is undefined');\n        }\n        this.elements.delete(key);\n    }\n\n    hasKey(key: string): boolean {\n        return this.elements.has(key);\n    }\n\n    get(key: string, arg: U): T {\n        const existingFactory = this.elements.get(key);\n        if (existingFactory) {\n            return existingFactory(arg);\n        } else {\n            return this.missing(key, arg);\n        }\n    }\n\n    protected missing(key: string, arg: U): T | never {\n        throw new Error('Unknown registry key: ' + key);\n    }\n}\n\n@injectable()\nexport class InstanceRegistry<T> {\n    protected elements: Map<string, T> = new Map;\n\n    register(key: string, instance: T) {\n        if (key === undefined) {\n            throw new Error('Key is undefined');\n        }\n        if (this.hasKey(key)) {\n            throw new Error('Key is already registered: ' + key);\n        }\n        this.elements.set(key, instance);\n    }\n\n    deregister(key: string) {\n        if (key === undefined) {\n            throw new Error('Key is undefined');\n        }\n        this.elements.delete(key);\n    }\n\n    hasKey(key: string): boolean {\n        return this.elements.has(key);\n    }\n\n    get(key: string): T {\n        const existingInstance = this.elements.get(key);\n        if (existingInstance) {\n            return existingInstance;\n        } else {\n            return this.missing(key);\n        }\n    }\n\n    protected missing(key: string): T | never {\n        throw new Error('Unknown registry key: ' + key);\n    }\n}\n\n@injectable()\nexport class MultiInstanceRegistry<T> {\n    protected elements: Map<string, T[]> = new Map;\n\n    register(key: string, instance: T) {\n        if (key === undefined) {\n            throw new Error('Key is undefined');\n        }\n        const instances = this.elements.get(key);\n        if (instances !== undefined) {\n            instances.push(instance);\n        } else {\n            this.elements.set(key, [instance]);\n        }\n    }\n\n    deregisterAll(key: string) {\n        if (key === undefined) {\n            throw new Error('Key is undefined');\n        }\n        this.elements.delete(key);\n    }\n\n    get(key: string): T[] {\n        const existingInstances = this.elements.get(key);\n        if (existingInstances !== undefined) {\n            return existingInstances;\n        } else {\n            return [];\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { hasOwnProperty } from \"./object\";\n\n/**\n * A Point is composed of the (x,y) coordinates of an object.\n */\nexport interface Point {\n    readonly x: number\n    readonly y: number\n}\n\nexport namespace Point {\n    /**\n     * (x,y) coordinates of the origin.\n     */\n    export const ORIGIN: Point = Object.freeze({\n        x: 0,\n        y: 0\n    });\n\n    /**\n     * Adds two points.\n     * @param {Point} p1 - First point\n     * @param {Point} p2 - Second point\n     * @returns {Point} The sum of the two points\n     */\n    export function add(p1: Point, p2: Point): Point {\n        return {\n            x: p1.x + p2.x,\n            y: p1.y + p2.y\n        };\n    }\n\n    /**\n     * Subtracts two points.\n     * @param {Point} p1 - First point\n     * @param {Point} p2 - Second point\n     * @returns {Point} The difference of the two points\n     */\n    export function subtract(p1: Point, p2: Point): Point {\n        return {\n            x: p1.x - p2.x,\n            y: p1.y - p2.y\n        };\n    }\n\n    /**\n     * Specifies whether a point has exactly the same coordinates as another point.\n     * @param {Point} point1 a point\n     * @param {Point} point2 another point\n     * @returns {boolean} `true` if `point1` has exactly the same `x` and `y` values as `point2`, `false` otherwise.\n     */\n    export function equals(point1: Point, point2: Point): boolean {\n        return point1.x === point2.x && point1.y === point2.y;\n    }\n\n    /**\n     * Computes a point that is the original `point` shifted towards `refPoint` by the given `distance`.\n     * @param {Point} point - Point to shift\n     * @param {Point} refPoint - Point to shift towards\n     * @param {Point} distance - Distance to shift\n     */\n    export function shiftTowards(point: Point, refPoint: Point, distance: number): Point {\n        const diff = subtract(refPoint, point);\n        const normalized = normalize(diff);\n        const shift = { x: normalized.x * distance, y: normalized.y * distance };\n        return add(point, shift);\n    }\n\n    /**\n     * Computes the normalized vector from the vector given in `point`; that is, computing its unit vector.\n     * @param {Point} point - Point representing the vector to be normalized\n     * @returns {Point} The normalized point\n     */\n    export function normalize(point: Point): Point {\n        const mag = magnitude(point);\n        if (mag === 0 || mag === 1) {\n            return ORIGIN;\n        }\n        return {\n            x: point.x / mag,\n            y: point.y / mag\n        };\n    }\n\n    /**\n     * Computes the magnitude of the vector given in `point`.\n     * @param {Point} point - Point representing the vector to compute the magnitude for\n     * @returns {number} The magnitude or also known as length of the `point`\n     */\n    export function magnitude(point: Point): number {\n        return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n    }\n\n    /**\n     * Calculates a linear combination of p0 and p1 using lambda, i.e.\n     *   (1-lambda) * p0 + lambda * p1\n     */\n    export function linear(p0: Point, p1: Point, lambda: number): Point {\n        return {\n            x: (1 - lambda) * p0.x + lambda * p1.x,\n            y: (1 - lambda) * p0.y + lambda * p1.y\n        };\n    }\n\n    /**\n     * Returns the \"straight line\" distance between two points.\n     * @param {Point} a - First point\n     * @param {Point} b - Second point\n     * @returns {number} The Eucledian distance\n     */\n    export function euclideanDistance(a: Point, b: Point): number {\n        const dx = b.x - a.x;\n        const dy = b.y - a.y;\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n\n    /**\n     * Returns the distance between two points in a grid, using a\n     * strictly vertical and/or horizontal path (versus straight line).\n     * @param {Point} a - First point\n     * @param {Point} b - Second point\n     * @returns {number} The Manhattan distance\n     */\n    export function manhattanDistance(a: Point, b: Point): number {\n        return Math.abs(b.x - a.x) + Math.abs(b.y - a.y);\n    }\n\n    /**\n     * Returns the maximum of the horizontal and the vertical distance.\n     * @param {Point} a - First point\n     * @param {Point} b - Second point\n     * @returns {number} The maximum distance\n     */\n    export function maxDistance(a: Point, b: Point): number {\n        return Math.max(Math.abs(b.x - a.x), Math.abs(b.y - a.y));\n    }\n}\n\n/**\n * Computes the angle in radians of the given point to the x-axis of the coordinate system.\n * The result is in the range [-pi, pi].\n * @param {Point} p - A point in the Eucledian plane\n */\nexport function angleOfPoint(p: Point): number {\n    return Math.atan2(p.y, p.x);\n}\n\n/**\n * Computes the angle in radians between the two given points (relative to the origin of the coordinate system).\n * The result is in the range [0, pi]. Returns NaN if the points are equal.\n * @param {Point} a - First point\n * @param {Point} b - Second point\n */\nexport function angleBetweenPoints(a: Point, b: Point): number {\n    const lengthProduct = Math.sqrt((a.x * a.x + a.y * a.y) * (b.x * b.x + b.y * b.y));\n    if (isNaN(lengthProduct) || lengthProduct === 0)\n        return NaN;\n    const dotProduct = a.x * b.x + a.y * b.y;\n    return Math.acos(dotProduct / lengthProduct);\n}\n\n/**\n * Computes the center of the line segment spanned by the two given points.\n * @param {Point} s - Start point of the line\n * @param {Point} e - End point of the line\n */\nexport function centerOfLine(s: Point, e: Point): Point {\n    const b: Bounds = {\n        x: s.x > e.x ? e.x : s.x,\n        y: s.y > e.y ? e.y : s.y,\n        width: Math.abs(e.x - s.x),\n        height: Math.abs(e.y - s.y)\n    };\n    return Bounds.center(b);\n}\n\n/**\n * The Dimension of an object is composed of its width and height.\n */\nexport interface Dimension {\n    readonly width: number\n    readonly height: number\n}\n\nexport namespace Dimension {\n    /**\n     * A dimension with both width and height set to a negative value, which is considered as undefined.\n     */\n    export const EMPTY: Dimension = Object.freeze({\n        width: -1,\n        height: -1\n    });\n\n    /**\n     * Checks whether the given dimention is valid, i.e. the width and height are non-zero.\n     * @param {Dimension} b - Dimension object\n     * @returns {boolean} `true` if the dimension is valid\n     */\n    export function isValid(d: Dimension): boolean {\n        return d.width >= 0 && d.height >= 0;\n    }\n}\n\n/**\n * The bounds are the position (x, y) and dimension (width, height) of an object.\n */\nexport interface Bounds extends Point, Dimension {\n}\n\nexport function isBounds(element: unknown): element is Bounds {\n    return hasOwnProperty(element, ['x', 'y', 'width', 'height']);\n}\n\nexport namespace Bounds {\n    export const EMPTY: Bounds = Object.freeze({\n        x: 0,\n        y: 0,\n        width: -1,\n        height: -1\n    });\n\n    /**\n     * Combines the bounds of two objects into one, so that the new bounds\n     * are the minimum bounds that covers both of the original bounds.\n     * @param {Bounds} b0 - First bounds object\n     * @param {Bounds} b1 - Second bounds object\n     * @returns {Bounds} The combined bounds\n     */\n    export function combine(b0: Bounds, b1: Bounds): Bounds {\n        if (!Dimension.isValid(b0))\n            return Dimension.isValid(b1) ? b1 : EMPTY;\n        if (!Dimension.isValid(b1))\n            return b0;\n        const minX = Math.min(b0.x, b1.x);\n        const minY = Math.min(b0.y, b1.y);\n        const maxX = Math.max(b0.x + (b0.width >= 0 ? b0.width : 0), b1.x + (b1.width >= 0 ? b1.width : 0));\n        const maxY = Math.max(b0.y + (b0.height >= 0 ? b0.height : 0), b1.y + (b1.height >= 0 ? b1.height : 0));\n        return {\n            x: minX, y: minY, width: maxX - minX, height: maxY - minY\n        };\n    }\n\n    /**\n     * Translates the given bounds.\n     * @param {Bounds} b - Bounds object\n     * @param {Point} p - Vector by which to translate the bounds\n     * @returns {Bounds} The translated bounds\n     */\n    export function translate(b: Bounds, p: Point): Bounds {\n        return {\n            x: b.x + p.x,\n            y: b.y + p.y,\n            width: b.width,\n            height: b.height\n        };\n    }\n\n    /**\n     * Returns the center point of the bounds of an object\n     * @param {Bounds} b - Bounds object\n     * @returns {Point} the center point\n     */\n    export function center(b: Bounds): Point {\n        return {\n            x: b.x + (b.width >= 0 ? 0.5 * b.width : 0),\n            y: b.y + (b.height >= 0 ? 0.5 * b.height : 0)\n        };\n    }\n\n    /**\n    * Checks whether the point p is included in the bounds b.\n    */\n    export function includes(b: Bounds, p: Point): boolean {\n        return p.x >= b.x && p.x <= b.x + b.width && p.y >= b.y && p.y <= b.y + b.height;\n    }\n}\n\n/**\n * Converts from radians to degrees\n * @param {number} a - A value in radians\n * @returns {number} The converted value\n */\nexport function toDegrees(a: number): number {\n    return a * 180 / Math.PI;\n}\n\n/**\n * Converts from degrees to radians\n * @param {number} a - A value in degrees\n * @returns {number} The converted value\n */\nexport function toRadians(a: number): number {\n    return a * Math.PI / 180;\n}\n\n/**\n * Returns whether two numbers are almost equal, within a small margin (0.001)\n * @param {number} a - First number\n * @param {number} b - Second number\n * @returns {boolean} True if the two numbers are almost equal\n */\nexport function almostEquals(a: number, b: number): boolean {\n    return Math.abs(a - b) < 1e-3;\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/**\n * An iterable that allows filtering, mapping values etc. with a fluent API.\n * Arrays conform to this interface, so an array can be passed at every place where\n * a FluentIterable is expected.\n */\nexport interface FluentIterable<T> extends Iterable<T> {\n    filter(callback: (element: T) => boolean): FluentIterable<T>\n    map<T2>(callback: (element: T) => T2): FluentIterable<T2>\n    forEach(callback: (element: T, index: number) => void): void\n    indexOf(element: any): number\n}\n\n/**\n * A helper class that allows to easily create fluent iterables.\n */\nexport class FluentIterableImpl<S, T> implements FluentIterable<T> {\n\n    constructor(private readonly startFn: () => S,\n                private readonly nextFn: (state: S) => IteratorResult<T>) {}\n\n    [Symbol.iterator]() {\n        const iterator = {\n            state: this.startFn(),\n            next: () => this.nextFn(iterator.state),\n            [Symbol.iterator]: () => iterator\n        };\n        return iterator;\n    }\n\n    filter(callback: (element: T) => boolean): FluentIterable<T> {\n        return filterIterable(this, callback);\n    }\n\n    map<T2>(callback: (element: T) => T2): FluentIterable<T2> {\n        return mapIterable(this, callback);\n    }\n\n    forEach(callback: (element: T, index: number) => void): void {\n        const iterator = this[Symbol.iterator]();\n        let index = 0;\n        let result: IteratorResult<T>;\n        do {\n            result = iterator.next();\n            if (result.value !== undefined)\n                callback(result.value, index);\n            index++;\n        } while (!result.done);\n    }\n\n    indexOf(element: any): number {\n        const iterator = this[Symbol.iterator]();\n        let index = 0;\n        let result: IteratorResult<T>;\n        do {\n            result = iterator.next();\n            if (result.value === element)\n                return index;\n            index++;\n        } while (!result.done);\n        return -1;\n    }\n}\n\n/**\n * Converts a FluentIterable into an array. If the input is an array, it is returned unchanged.\n */\nexport function toArray<T>(input: FluentIterable<T>): T[] {\n    if (input.constructor === Array) {\n        return input as T[];\n    }\n    const result: T[] = [];\n    input.forEach(element => result.push(element));\n    return result;\n}\n\nexport const DONE_RESULT: IteratorResult<any> = Object.freeze({ done: true, value: undefined });\n\n/**\n * Create a fluent iterable that filters the content of the given iterable or array.\n */\nexport function filterIterable<T>(input: Iterable<T> | ArrayLike<T>, callback: (element: T) => boolean): FluentIterable<T> {\n    return new FluentIterableImpl(\n        () => createIterator(input),\n        (iterator) => {\n            let result: IteratorResult<T>;\n            do {\n                result = iterator.next();\n            } while (!result.done && !callback(result.value));\n            return result;\n        }\n    );\n}\n\n/**\n * Create a fluent iterable that maps the content of the given iterable or array.\n */\nexport function mapIterable<T1, T2>(input: Iterable<T1> | ArrayLike<T1>, callback: (element: T1) => T2): FluentIterable<T2> {\n    return new FluentIterableImpl(\n        () => createIterator(input),\n        (iterator) => {\n            const { done, value } = iterator.next();\n            if (done)\n                return DONE_RESULT;\n            else\n                return { done: false, value: callback(value) };\n        }\n    );\n}\n\n/**\n * Create an iterator for the given iterable or array.\n */\nfunction createIterator<T>(collection: Iterable<T> | ArrayLike<T>): Iterator<T> {\n    const method = (collection as Iterable<T>)[Symbol.iterator];\n    if (typeof method === 'function') {\n        return method.call(collection);\n    }\n    const length = (collection as ArrayLike<T>).length;\n    if (typeof length === 'number' && length >= 0) {\n        return new ArrayIterator(collection as ArrayLike<T>);\n    }\n    return { next: () => DONE_RESULT };\n}\n\n/**\n * Iterator implementation for arrays.\n */\nclass ArrayIterator<T> implements IterableIterator<T> {\n    constructor(private readonly array: ArrayLike<T>) {}\n\n    private index = 0;\n\n    next(): IteratorResult<T> {\n        if (this.index < this.array.length)\n            return { done: false, value: this.array[this.index++] };\n        else\n            return DONE_RESULT;\n    }\n\n    [Symbol.iterator]() {\n        return this;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElement } from 'sprotty-protocol/lib/model';\nimport { Bounds, isBounds, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { FluentIterable, mapIterable } from '../../utils/iterable';\n\n/**\n * Base class for all elements of the internal diagram model.\n * Each model element must have a unique ID and a type that is used to look up its view.\n */\nexport class SModelElementImpl {\n    type: string;\n    id: string;\n    features?: FeatureSet;\n    cssClasses?: string[];\n\n    get root(): SModelRootImpl {\n        let current: SModelElementImpl | undefined = this;\n        while (current) {\n            if (current instanceof SModelRootImpl)\n                return current;\n            else if (current instanceof SChildElementImpl)\n                current = current.parent;\n            else\n                current = undefined;\n        }\n        throw new Error('Element has no root');\n    }\n\n    get index(): ModelIndexImpl {\n        return this.root.index;\n    }\n\n    /**\n     * A feature is a symbol identifying some functionality that can be enabled or disabled for\n     * a model element. The set of supported features is determined by the `features` property.\n     */\n    hasFeature(feature: symbol): boolean {\n        return this.features !== undefined && this.features.has(feature);\n    }\n}\n\n\nexport interface FeatureSet {\n    has(feature: symbol): boolean\n}\n\nexport function isParent(element: SModelElement | SModelElementImpl):\n        element is SModelElement & { children: SModelElement[] } {\n    const children = (element as any).children;\n    return children !== undefined && children.constructor === Array;\n}\n\n/**\n * A parent element may contain child elements, thus the diagram model forms a tree.\n */\nexport class SParentElementImpl extends SModelElementImpl {\n    readonly children: ReadonlyArray<SChildElementImpl> = [];\n\n    add(child: SChildElementImpl, index?: number) {\n        const children = this.children as SChildElementImpl[];\n        if (index === undefined) {\n            children.push(child);\n        } else {\n            if (index < 0 || index > this.children.length) {\n                throw new Error(`Child index ${index} out of bounds (0..${children.length})`);\n            }\n            children.splice(index, 0, child);\n        }\n        (child as {parent: SParentElementImpl}).parent = this;\n        this.index.add(child);\n    }\n\n    remove(child: SChildElementImpl) {\n        const children = this.children as SChildElementImpl[];\n        const i = children.indexOf(child);\n        if (i < 0) {\n            throw new Error(`No such child ${child.id}`);\n        }\n        children.splice(i, 1);\n        this.index.remove(child);\n    }\n\n    removeAll(filter?: (e: SChildElementImpl) => boolean) {\n        const children = this.children as SChildElementImpl[];\n        if (filter !== undefined) {\n            for (let i = children.length - 1; i >= 0; i--) {\n                if (filter(children[i])) {\n                    const child = children.splice(i, 1)[0];\n                    this.index.remove(child);\n                }\n            }\n        } else {\n            children.forEach(child => {\n                this.index.remove(child);\n            });\n            children.splice(0, children.length);\n        }\n    }\n\n    move(child: SChildElementImpl, newIndex: number) {\n        const children = this.children as SChildElementImpl[];\n        const i = children.indexOf(child);\n        if (i === -1) {\n            throw new Error(`No such child ${child.id}`);\n        } else {\n            if (newIndex < 0 || newIndex > children.length - 1) {\n                throw new Error(`Child index ${newIndex} out of bounds (0..${children.length})`);\n            }\n            children.splice(i, 1);\n            children.splice(newIndex, 0, child);\n        }\n    }\n\n    /**\n     * Transform the given bounds from the local coordinate system of this element to the coordinate\n     * system of its parent. This function should consider any transformation that is applied to the\n     * view of this element and its contents.\n     * The base implementation assumes that this element does not define a local coordinate system,\n     * so it leaves the bounds unchanged.\n     */\n    localToParent(point: Point | Bounds): Bounds {\n        return isBounds(point) ? point : { x: point.x, y: point.y, width: -1, height: -1 };\n    }\n\n    /**\n     * Transform the given bounds from the coordinate system of this element's parent to its local\n     * coordinate system. This function should consider any transformation that is applied to the\n     * view of this element and its contents.\n     * The base implementation assumes that this element does not define a local coordinate system,\n     * so it leaves the bounds unchanged.\n     */\n    parentToLocal(point: Point | Bounds): Bounds {\n        return isBounds(point) ? point : { x: point.x, y: point.y, width: -1, height: -1 };\n    }\n}\n\n/**\n * A child element is contained in a parent element. All elements except the model root are child\n * elements. In order to keep the model class hierarchy simple, every child element is also a\n * parent element, although for many elements the array of children is empty (i.e. they are\n * leafs in the model element tree).\n */\nexport class SChildElementImpl extends SParentElementImpl {\n    readonly parent: SParentElementImpl;\n}\n\n\n/**\n * Base class for the root element of the diagram model tree.\n */\nexport class SModelRootImpl extends SParentElementImpl {\n    revision?: number;\n\n    canvasBounds: Bounds = Bounds.EMPTY;\n\n    constructor(index = new ModelIndexImpl()) {\n        super();\n          // Override the index property from SModelElement, which has a getter, with a data property\n          Object.defineProperty(this, 'index', {\n            value: index,\n            writable: false\n        });\n    }\n}\n\nconst ID_CHARS = '0123456789abcdefghijklmnopqrstuvwxyz';\nexport function createRandomId(length: number = 8): string {\n    let id = '';\n    for (let i = 0; i < length; i++) {\n        id += ID_CHARS.charAt(Math.floor(Math.random() * ID_CHARS.length));\n    }\n    return id;\n}\n\n\n/**\n * Used to speed up model element lookup by id.\n */\n export interface IModelIndex {\n    add(element: SModelElement): void\n    remove(element: SModelElement): void\n    contains(element: SModelElement): boolean\n    getById(id: string): SModelElement | undefined\n}\n\n/**\n * This index implementation is for the _internal model_ that is used for rendering.\n */\nexport class ModelIndexImpl implements IModelIndex {\n\n    private readonly id2element: Map<string, SModelElementImpl> = new Map();\n\n    add(element: SModelElementImpl): void {\n        if (!element.id) {\n            do {\n                element.id = createRandomId();\n            } while (this.contains(element));\n        } else if (this.contains(element)) {\n            throw new Error('Duplicate ID in model: ' + element.id);\n        }\n        this.id2element.set(element.id, element);\n        if (element instanceof SParentElementImpl) {\n            for (const child of element.children) {\n                this.add(child as any);\n            }\n        }\n    }\n\n    remove(element: SModelElementImpl): void {\n        this.id2element.delete(element.id);\n        if (element instanceof SParentElementImpl) {\n            for (const child of element.children) {\n                this.remove(child as any);\n            }\n        }\n    }\n\n    contains(element: SModelElementImpl): boolean {\n        return this.id2element.has(element.id);\n    }\n\n    getById(id: string): SModelElementImpl | undefined {\n        return this.id2element.get(id);\n    }\n\n    getAttachedElements(element: SModelElementImpl): FluentIterable<SModelElementImpl> {\n        return [];\n    }\n\n    all(): FluentIterable<SModelElementImpl> {\n        return mapIterable(this.id2element, ([key, value]: [string, SModelElementImpl]) => value);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, multiInject, optional, inject } from 'inversify';\nimport { SModelElement, SModelRoot } from 'sprotty-protocol/lib/model';\nimport { TYPES } from \"../types\";\nimport { FactoryRegistry } from '../../utils/registry';\nimport { SChildElementImpl, SModelElementImpl, SModelRootImpl, SParentElementImpl, isParent, FeatureSet } from './smodel';\n\n/**\n * Model element classes registered here are considered automatically when constructring a model from its schema.\n */\n@injectable()\nexport class SModelRegistry extends FactoryRegistry<SModelElementImpl, void> {\n    constructor(@multiInject(TYPES.SModelElementRegistration) @optional() registrations: SModelElementRegistration[]) {\n        super();\n\n        registrations.forEach(registration => {\n            let defaultFeatures = this.getDefaultFeatures(registration.constr);\n            if (!defaultFeatures && registration.features && registration.features.enable)\n                defaultFeatures = [];\n            if (defaultFeatures) {\n                const featureSet = createFeatureSet(defaultFeatures, registration.features);\n                this.register(registration.type, () => {\n                    const element = new registration.constr();\n                    element.features = featureSet;\n                    return element;\n                });\n            } else {\n                this.register(registration.type, () => new registration.constr());\n            }\n        });\n    }\n\n    protected getDefaultFeatures(constr: SModelElementConstructor): ReadonlyArray<symbol> | undefined {\n        let obj = constr;\n        do {\n            const defaultFeatures = obj.DEFAULT_FEATURES;\n            if (defaultFeatures)\n                return defaultFeatures;\n            obj = Object.getPrototypeOf(obj);\n        } while (obj);\n        return undefined;\n    }\n}\n\n/**\n * A model factory transforms a serializable model schema into the model representation that is used\n * internally by sprotty.\n */\nexport interface IModelFactory {\n    createElement(schema: SModelElement | SModelElementImpl, parent?: SParentElementImpl): SChildElementImpl\n\n    createRoot(schema: SModelRoot | SModelRootImpl): SModelRootImpl\n\n    createSchema(element: SModelElementImpl): SModelElement\n}\n\n/**\n * The default model factory creates SModelRoot for the root element and SChildElement for all other\n * model elements.\n */\n@injectable()\nexport class SModelFactory implements IModelFactory {\n\n    @inject(TYPES.SModelRegistry) protected readonly registry: SModelRegistry;\n\n    createElement(schema: SModelElement | SModelElementImpl, parent?: SParentElementImpl): SChildElementImpl {\n        let child: SChildElementImpl;\n        if (this.registry.hasKey(schema.type)) {\n            const regElement = this.registry.get(schema.type, undefined);\n            if (!(regElement instanceof SChildElementImpl))\n                throw new Error(`Element with type ${schema.type} was expected to be an SChildElement.`);\n            child = regElement;\n        } else {\n            child = new SChildElementImpl();\n        }\n        return this.initializeChild(child, schema, parent);\n    }\n\n    createRoot(schema: SModelRoot | SModelRootImpl): SModelRootImpl {\n        let root: SModelRootImpl;\n        if (this.registry.hasKey(schema.type)) {\n            const regElement = this.registry.get(schema.type, undefined);\n            if (!(regElement instanceof SModelRootImpl))\n                throw new Error(`Element with type ${schema.type} was expected to be an SModelRoot.`);\n            root = regElement;\n        } else {\n            root = new SModelRootImpl();\n        }\n        return this.initializeRoot(root, schema);\n    }\n\n    createSchema(element: SModelElementImpl): SModelElement {\n        const schema = {};\n        for (const key in element) {\n             if (!this.isReserved(element, key)) {\n                const value: any = (element as any)[key];\n                if (typeof value !== 'function')\n                    (schema as any)[key] = value;\n            }\n        }\n        if (element instanceof SParentElementImpl)\n            (schema as any)['children'] = element.children.map(child => this.createSchema(child));\n        return schema as SModelElement;\n    }\n\n    protected initializeElement(element: SModelElementImpl, schema: SModelElement | SModelElementImpl): SModelElementImpl {\n        for (const key in schema) {\n            if (!this.isReserved(element, key)) {\n                const value: any = (schema as any)[key];\n                if (typeof value !== 'function')\n                    (element as any)[key] = value;\n            }\n        }\n        return element;\n    }\n\n    protected isReserved(element: SModelElementImpl, propertyName: string) {\n        if (['children', 'parent', 'index'].indexOf(propertyName) >= 0)\n            return true;\n        let obj = element;\n        do {\n            const descriptor = Object.getOwnPropertyDescriptor(obj, propertyName);\n            if (descriptor !== undefined)\n                return descriptor.get !== undefined;\n            obj = Object.getPrototypeOf(obj);\n        } while (obj);\n        return false;\n    }\n\n    protected initializeParent(parent: SParentElementImpl, schema: SModelElement | SParentElementImpl): SParentElementImpl {\n        this.initializeElement(parent, schema);\n        if (isParent(schema)) {\n            (parent as any).children = schema.children.map(childSchema => this.createElement(childSchema, parent));\n        }\n        return parent;\n    }\n\n    protected initializeChild(child: SChildElementImpl, schema: SModelElement, parent?: SParentElementImpl): SChildElementImpl {\n        this.initializeParent(child, schema);\n        if (parent !== undefined) {\n            (child as any).parent = parent;\n        }\n        return child;\n    }\n\n    protected initializeRoot(root: SModelRootImpl, schema: SModelRoot | SModelRootImpl): SModelRootImpl {\n        this.initializeParent(root, schema);\n        root.index.add(root);\n        return root;\n    }\n}\n\nexport const EMPTY_ROOT: Readonly<SModelRoot> = Object.freeze({\n    type: 'NONE',\n    id: 'EMPTY'\n});\n\n/**\n * Used to bind a model element type to a class constructor in the SModelRegistry.\n */\nexport interface SModelElementRegistration {\n    type: string\n    constr: SModelElementConstructor\n    features?: CustomFeatures\n}\n\nexport interface SModelElementConstructor {\n    DEFAULT_FEATURES?: ReadonlyArray<symbol>\n    new (): SModelElementImpl\n}\n\nexport interface CustomFeatures {\n    enable?: symbol[]\n    disable?: symbol[]\n}\n\nexport function createFeatureSet(defaults: ReadonlyArray<symbol>, custom?: CustomFeatures): FeatureSet {\n    const featureSet = new Set<symbol>(defaults);\n    if (custom && custom.enable) {\n        for (const f of custom.enable) {\n            featureSet.add(f);\n        }\n    }\n    if (custom && custom.disable) {\n        for (const f of custom.disable) {\n            featureSet.delete(f);\n        }\n    }\n    return featureSet;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from \"inversify\";\n\n@injectable()\nexport class AnimationFrameSyncer {\n\n    tasks: ((x?: number) => void) [] = [];\n    endTasks: ((x?: number) => void) [] = [];\n    triggered: boolean = false;\n\n    isAvailable(): boolean {\n        return typeof requestAnimationFrame === \"function\";\n    }\n\n    onNextFrame(task: (x?: number) => void) {\n        this.tasks.push(task);\n        this.trigger();\n    }\n\n    onEndOfNextFrame(task: (x?: number) => void) {\n        this.endTasks.push(task);\n        this.trigger();\n    }\n\n    protected trigger() {\n        if (!this.triggered) {\n            this.triggered = true;\n            if (this.isAvailable())\n                requestAnimationFrame((time: number) => this.run(time));\n            else\n                setTimeout((time: number) => this.run(time));\n        }\n    }\n\n    protected run(time: number) {\n        const tasks = this.tasks;\n        const endTasks = this.endTasks;\n        this.triggered = false;\n        this.tasks = [];\n        this.endTasks = [];\n        tasks.forEach(task => task.call(undefined, time));\n        endTasks.forEach(task => task.call(undefined, time));\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport {\n    Action, isAction, isRequestAction, isResponseAction, RedoAction, RejectAction, RequestAction,\n    ResponseAction, SetModelAction, setRequestContext, UndoAction\n} from 'sprotty-protocol/lib/actions';\nimport { Deferred } from 'sprotty-protocol/lib/utils/async';\nimport { TYPES } from '../types';\nimport { ILogger } from '../../utils/logging';\nimport { EMPTY_ROOT } from '../model/smodel-factory';\nimport { ICommandStack } from '../commands/command-stack';\nimport { AnimationFrameSyncer } from '../animations/animation-frame-syncer';\nimport { ActionHandlerRegistry } from './action-handler';\nimport { IDiagramLocker } from './diagram-locker';\n\nexport interface IActionDispatcher {\n    dispatch(action: Action): Promise<void>\n    dispatchAll(actions: Action[]): Promise<void>\n    request<Res extends ResponseAction>(action: RequestAction<Res>): Promise<Res>\n}\n\n// This code should be used only in the client part of a Sprotty application.\n// We set the request context to 'client' to avoid collisions with requests created by the server.\nsetRequestContext('client');\n\n/**\n * Collects actions, converts them to commands and dispatches them.\n * Also acts as the proxy to model sources such as diagram servers.\n */\n@injectable()\nexport class ActionDispatcher implements IActionDispatcher {\n\n    @inject(TYPES.ActionHandlerRegistryProvider) protected actionHandlerRegistryProvider: () => Promise<ActionHandlerRegistry>;\n    @inject(TYPES.ICommandStack) protected commandStack: ICommandStack;\n    @inject(TYPES.ILogger) protected logger: ILogger;\n    @inject(TYPES.AnimationFrameSyncer) protected syncer: AnimationFrameSyncer;\n    @inject(TYPES.IDiagramLocker) protected diagramLocker: IDiagramLocker;\n\n    protected actionHandlerRegistry: ActionHandlerRegistry;\n\n    protected initialized: Promise<void> | undefined;\n    protected blockUntil?: (action: Action) => boolean;\n    protected postponedActions: PostponedAction[] = [];\n    protected readonly requests: Map<string, Deferred<ResponseAction>> = new Map();\n\n    initialize(): Promise<void> {\n        if (!this.initialized) {\n            this.initialized = this.actionHandlerRegistryProvider().then(registry => {\n                this.actionHandlerRegistry = registry;\n                this.handleAction(SetModelAction.create(EMPTY_ROOT)).catch(() => { /* Logged in handleAction method */ });\n            });\n        }\n        return this.initialized;\n    }\n\n    /**\n     * Dispatch an action by querying all handlers that are registered for its kind.\n     * The returned promise is resolved when all handler results (commands or actions)\n     * have been processed.\n     */\n    dispatch(action: Action): Promise<void> {\n        return this.initialize().then(() => {\n            if (this.blockUntil !== undefined) {\n                return this.handleBlocked(action, this.blockUntil);\n            } else if (this.diagramLocker.isAllowed(action)) {\n                return this.handleAction(action);\n            }\n            return undefined;\n        });\n    }\n\n    /**\n     * Calls `dispatch` on every action in the given array. The returned promise\n     * is resolved when the promises of all `dispatch` calls have been resolved.\n     */\n    dispatchAll(actions: Action[]): Promise<void> {\n        return Promise.all(actions.map(action => this.dispatch(action))) as Promise<any>;\n    }\n\n    /**\n     * Dispatch a request. The returned promise is resolved when a response with matching\n     * identifier is dispatched. That response is _not_ passed to the registered action\n     * handlers. Instead, it is the responsibility of the caller of this method to handle\n     * the response properly. For example, it can be sent to the registered handlers by\n     * passing it again to the `dispatch` method.\n     */\n    request<Res extends ResponseAction>(action: RequestAction<Res>): Promise<Res> {\n        if (!action.requestId) {\n            return Promise.reject(new Error('Request without requestId'));\n        }\n        const deferred = new Deferred<Res>();\n        this.requests.set(action.requestId, deferred);\n        this.dispatch(action).catch(() => { /* Logged in handleAction method */ });\n        return deferred.promise;\n    }\n\n    protected handleAction(action: Action): Promise<void> {\n        if (action.kind === UndoAction.KIND) {\n            return this.commandStack.undo().then(() => {});\n        }\n        if (action.kind === RedoAction.KIND) {\n            return this.commandStack.redo().then(() => {});\n        }\n        if (isResponseAction(action)) {\n            const deferred = this.requests.get(action.responseId);\n            if (deferred !== undefined) {\n                this.requests.delete(action.responseId);\n                if (action.kind === RejectAction.KIND) {\n                    const rejectAction = action as RejectAction;\n                    deferred.reject(new Error(rejectAction.message));\n                    this.logger.warn(this, `Request with id ${action.responseId} failed.`,\n                            rejectAction.message, rejectAction.detail);\n                } else {\n                    deferred.resolve(action);\n                }\n                return Promise.resolve();\n            }\n            this.logger.log(this, 'No matching request for response', action);\n        }\n\n        const handlers = this.actionHandlerRegistry.get(action.kind);\n        if (handlers.length === 0) {\n            this.logger.warn(this, 'Missing handler for action', action);\n            const error = new Error(`Missing handler for action '${action.kind}'`);\n            if (isRequestAction(action)) {\n                const deferred = this.requests.get(action.requestId);\n                if (deferred !== undefined) {\n                    this.requests.delete(action.requestId);\n                    deferred.reject(error);\n                }\n            }\n            return Promise.reject(error);\n        }\n        this.logger.log(this, 'Handle', action);\n        const promises: Promise<any>[] = [];\n        for (const handler of handlers) {\n            const result = handler.handle(action);\n            if (isAction(result)) {\n                promises.push(this.dispatch(result));\n            } else if (result !== undefined) {\n                promises.push(this.commandStack.execute(result));\n                this.blockUntil = result.blockUntil;\n            }\n        }\n        return Promise.all(promises) as Promise<any>;\n    }\n\n    protected handleBlocked(action: Action, predicate: (action: Action) => boolean): Promise<void> {\n        if (predicate(action)) {\n            this.blockUntil = undefined;\n            const result = this.handleAction(action);\n            const actions = this.postponedActions;\n            this.postponedActions = [];\n            for (const a of actions) {\n                this.dispatch(a.action).then(a.resolve, a.reject);\n            }\n            return result;\n        } else {\n            this.logger.log(this, 'Action is postponed due to block condition', action);\n            return new Promise((resolve, reject) => {\n                this.postponedActions.push({ action, resolve, reject });\n            });\n        }\n    }\n}\n\nexport interface PostponedAction {\n    action: Action\n    resolve: () => void\n    reject: (reason: any) => void\n}\n\nexport type IActionDispatcherProvider = () => Promise<IActionDispatcher>;\n", "/********************************************************************************\n * Copyright (c) 2019-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport function isInjectable(constr: new (...args: unknown[]) => unknown): boolean {\n    return Reflect.getMetadata('inversify:paramtypes', constr) !== undefined;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, multiInject, optional, interfaces } from \"inversify\";\nimport { TYPES } from \"../types\";\nimport { MultiInstanceRegistry } from \"../../utils/registry\";\nimport { isInjectable } from \"../../utils/inversify\";\nimport { ICommand } from \"../commands/command\";\nimport { Action } from \"sprotty-protocol\";\n\n/**\n * An action handler accepts an action and reacts to it by returning either a command to be\n * executed, or another action to be dispatched.\n */\nexport interface IActionHandler {\n    handle(action: Action): ICommand | Action | void\n}\n\n/**\n * Used to bind an action kind to an action handler factory in the ActionHandlerRegistry.\n */\nexport interface ActionHandlerRegistration {\n    actionKind: string\n    factory: () => IActionHandler\n}\n\n/**\n * Initializes and registers an action handler for multiple action kinds. In most cases\n * `ActionHandlerRegistration` should be used instead.\n */\nexport interface IActionHandlerInitializer {\n    initialize(registry: ActionHandlerRegistry): void\n}\n\n/**\n * The action handler registry maps actions to their handlers using the Action.kind property.\n */\n@injectable()\nexport class ActionHandlerRegistry extends MultiInstanceRegistry<IActionHandler> {\n\n    constructor(@multiInject(TYPES.ActionHandlerRegistration) @optional() registrations: ActionHandlerRegistration[],\n                @multiInject(TYPES.IActionHandlerInitializer) @optional() initializers: IActionHandlerInitializer[]) {\n        super();\n        registrations.forEach(registration =>\n            this.register(registration.actionKind, registration.factory())\n        );\n        initializers.forEach(initializer =>\n            this.initializeActionHandler(initializer)\n        );\n    }\n\n    initializeActionHandler(initializer: IActionHandlerInitializer): void {\n        initializer.initialize(this);\n    }\n}\n\n/**\n * Utility function to register an action handler for an action kind.\n */\nexport function configureActionHandler(context: { bind: interfaces.Bind, isBound: interfaces.IsBound },\n        kind: string, constr: interfaces.ServiceIdentifier<IActionHandler>): void {\n    if (typeof constr === 'function') {\n        if (!isInjectable(constr)) {\n            throw new Error(`Action handlers should be @injectable: ${constr.name}`);\n        }\n        if (!context.isBound(constr)) {\n            context.bind(constr).toSelf();\n        }\n    }\n    context.bind(TYPES.ActionHandlerRegistration).toDynamicValue(ctx => ({\n        actionKind: kind,\n        factory: () => ctx.container.get(constr)\n    }));\n}\n\n/**\n * Utility function to register an action handler for an action kind.\n */\nexport function onAction(context: { bind: interfaces.Bind, isBound: interfaces.IsBound },\n        kind: string, handle: (action: Action) => ICommand | Action | void): void {\n    context.bind(TYPES.ActionHandlerRegistration).toConstantValue({\n        actionKind: kind,\n        factory: () => ({ handle })\n    });\n}\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from \"inversify\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\n\n/**\n * Allows to lock the diagram by preventing certain actions from being\n * dispatched.\n *\n * This could for example be used to prevent the diagram from being modified\n * when the underlying model is broken or the server is unavailable.\n */\nexport interface IDiagramLocker {\n    isAllowed(action: Action): boolean\n}\n\n@injectable()\nexport class DefaultDiagramLocker implements IDiagramLocker {\n    isAllowed(action: Action): boolean {\n        return true;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/**\n * Slows down animations towards the begin and the end.\n *\n * @param x the value between 0 (start of animation) and 1 (end of\n *     animation) linearly interpolated in time.\n * @returns {number} the eased value between 0 and 1\n */\nexport function easeInOut(x: number): number {\n    if (x < 0.5)\n        return x * x * 2;\n    else\n        return 1 - (1 - x) * (1 - x) * 2;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { CommandExecutionContext } from \"../commands/command\";\nimport { SModelRootImpl } from \"../model/smodel\";\nimport { easeInOut } from \"./easing\";\n\n/**\n * An animation uses the rendering loop of the browser to smoothly\n * calculate a transition between two states of a model element.\n */\nexport abstract class Animation {\n\n    constructor(protected context: CommandExecutionContext, protected ease: (x: number) => number = easeInOut) {\n    }\n\n    start(): Promise<SModelRootImpl> {\n        return new Promise<SModelRootImpl>(\n            (resolve: (model: SModelRootImpl) => void, reject: (model: SModelRootImpl) => void) => {\n                let start: number | undefined = undefined;\n                let frames = 0;\n                const lambda = (time: number) => {\n                    frames++;\n                    let dtime: number;\n                    if (start === undefined) {\n                        start = time;\n                        dtime = 0;\n                    } else {\n                        dtime = time - start;\n                    }\n                    const t = Math.min(1, dtime / this.context.duration);\n                    const current = this.tween(this.ease(t), this.context);\n                    this.context.modelChanged.update(current);\n                    if (t === 1) {\n                        this.context.logger.log(this, (frames * 1000 / this.context.duration) + ' fps');\n                        resolve(current);\n                    } else {\n                        this.context.syncer.onNextFrame(lambda);\n                    }\n                };\n                if (this.context.syncer.isAvailable()) {\n                    this.context.syncer.onNextFrame(lambda);\n                } else {\n                    const finalModel = this.tween(1, this.context);\n                    resolve(finalModel);\n                }\n            });\n    }\n\n    /**\n     * This method called by the animation at each rendering pass until\n     * the duration is reached. Implement it to interpolate the state.\n     *\n     * @param t varies between 0 (start of animation) and 1 (end of animation)\n     * @param context\n     */\n    abstract tween(t: number, context: CommandExecutionContext): SModelRootImpl;\n}\n\nexport class CompoundAnimation extends Animation {\n\n    constructor(protected model: SModelRootImpl,\n                protected override context: CommandExecutionContext,\n                public components: Animation[] = [],\n                protected override ease: (x: number) => number = easeInOut) {\n        super(context, ease);\n    }\n\n    include(animation: Animation): this {\n        this.components.push(animation);\n        return this;\n    }\n\n    tween(t: number, context: CommandExecutionContext): SModelRootImpl {\n        for (const a of this.components) {\n            a.tween(t, context);\n        }\n        return this.model;\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from \"inversify\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { ILogger } from \"../../utils/logging\";\nimport { AnimationFrameSyncer } from \"../animations/animation-frame-syncer\";\nimport { SModelRootImpl } from \"../model/smodel\";\nimport { IModelFactory } from \"../model/smodel-factory\";\nimport { IViewer } from \"../views/viewer\";\n\n/**\n * A command holds the behaviour of an action.\n * It is executed on a command stack and can be undone / redone.\n *\n * A command should store all information it needs to undo itself at a\n * later stage. It typically resolves the model elements it is going\n * to manipulate as a first step in the execute method.\n *\n * Each command should define a static string property KIND that\n * matches the associated action. This is used as a key in the\n * ActionHandlerRegistry.\n *\n * Clients should not implement the ICommand interface directly but\n * rather inherit from one of its abstract implementators.\n */\nexport interface ICommand {\n    /**\n     * If this property is present, all following actions are blocked\n     * until the function returns `true`.\n     */\n    readonly blockUntil?: (action: Action) => boolean;\n\n    execute(context: CommandExecutionContext): CommandReturn\n\n    undo(context: CommandExecutionContext): CommandReturn\n\n    redo(context: CommandExecutionContext): CommandReturn\n}\n\n/**\n * Commands return the changed model or a Promise for it. Promises\n * serve animating commands to render some intermediate states before\n * finishing. The CommandStack is in charge of chaining these promises,\n * such that they run sequentially only one at a time. Due to that\n * chaining, it is essential that a command does not make any assumption\n * on the state of the model before execute() is called.\n */\nexport type CommandReturn = SModelRootImpl | Promise<SModelRootImpl> | CommandResult;\n\n/**\n * The `CommandResult` allows to specify whether the model has changed\n * and the original action that caused the command to be executed. In case such\n * an action is given, it is passed to the viewer in order to link any\n * subsequent response action to the original request.\n */\nexport type CommandResult = { model: SModelRootImpl, modelChanged: boolean, cause?: Action };\n\n/**\n * Base class for all commands.\n *\n * Command instances are created via dependency injection and should take\n * the respective action as an injected constructor parameter. They must\n * also define a static <code>KIND</code> which is used to map an\n * <code>Action#kind</code>.\n *\n * <pre>\n * export class MyCommand extends Command {\n *   static KIND = 'MyCommand'\n *   constructor(@inject(TYPES.Action) action: MyAction) {\n *   ...\n * }\n * @inject(TYPES.Action)\n * </pre>\n */\n@injectable()\nexport abstract class Command implements ICommand {\n\n    abstract execute(context: CommandExecutionContext): CommandReturn;\n\n    abstract undo(context: CommandExecutionContext): CommandReturn;\n\n    abstract redo(context: CommandExecutionContext): CommandReturn;\n}\n\n/**\n * A mergeable command can accumulate subsequent commands of the same kind.\n *\n * For example, multiple subsequent move commands can be merged to yield a\n * single command, such that undo will roll them back altogether. Otherwise\n * the user would have to push CTRL-Z for each mouse move element that\n * resuted in a command.\n */\n@injectable()\nexport abstract class MergeableCommand extends Command {\n    /**\n     * Tries to merge the given command with this.\n     *\n     * @param command\n     * @param context\n     */\n    merge(command: ICommand, context: CommandExecutionContext): boolean {\n        return false;\n    }\n}\n\n/**\n * A hidden command is used to trigger the rendering of a model on a\n * hidden canvas.\n *\n * Some graphical elements are styled using CSS, others have bounds that\n * require to layout their children before being computed. In such cases\n * we cannot tell about the size of elements without acutally rendering\n * the DOM. We render them to an invisible canvas. This can be achieved\n * using hidden commands.\n *\n * Hidden commands do not change the model directly, and are as such\n * neither undoable nor redoable. The command stack does not push them on\n * any stack and forwards the resulting model to the invisible viewer.\n */\n@injectable()\nexport abstract class HiddenCommand extends Command {\n    abstract override execute(context: CommandExecutionContext): SModelRootImpl | CommandResult;\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        context.logger.error(this, 'Cannot undo a hidden command');\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        context.logger.error(this, 'Cannot redo a hidden command');\n        return context.root;\n    }\n}\n\n@injectable()\nexport abstract class PopupCommand extends Command {\n}\n\n/**\n * A system command is triggered by the system, e.g. in order to update bounds\n * in the model with data fetched from the DOM.\n *\n * As it is automatically triggered it should not count as a single command in\n * undo/redo operations. Into the bargain, such an automatic command could occur\n * after an undo and as such make the next redo command invalid because it is\n * based on a model state that has changed. The command stack handles system\n * commands in a special way to overcome these issues.\n */\n@injectable()\nexport abstract class SystemCommand extends Command {\n}\n\n/**\n * A reset command deletes all undo/redo stacks and cannot be undone.\n *\n * It marks a point of no return.\n */\n@injectable()\nexport abstract class ResetCommand extends Command {\n}\n\n/**\n * The data that is passed into the execution methods of a command to give it\n * access to the context.\n */\nexport interface CommandExecutionContext {\n    /** The current Sprotty model (i.e. the main model that is visible to the user) */\n    root: SModelRootImpl\n\n    /** Used to turn sprotty external model elements (e.g. from the action) into internal model elements */\n    modelFactory: IModelFactory\n\n    /** Allows to give some feedback to the console */\n    logger: ILogger\n\n    /** Used for anmiations to trigger the rendering of a new frame */\n    modelChanged: IViewer\n\n    /** Duration of an anmiation */\n    duration: number\n\n    /** Provides the ticks for animations */\n    syncer: AnimationFrameSyncer\n}\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, multiInject, optional, interfaces, Container } from \"inversify\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { isInjectable } from \"../../utils/inversify\";\nimport { ActionHandlerRegistry, IActionHandler, IActionHandlerInitializer } from \"../actions/action-handler\";\nimport { ICommand } from \"./command\";\nimport { TYPES } from \"../types\";\n\nexport class CommandActionHandler implements IActionHandler {\n    constructor(private commandRegistration: CommandRegistration) {\n    }\n\n    handle(action: Action): ICommand {\n        return this.commandRegistration.factory(action);\n    }\n}\n\n@injectable()\nexport class CommandActionHandlerInitializer implements IActionHandlerInitializer {\n\n    constructor(@multiInject(TYPES.CommandRegistration) @optional() protected registrations: CommandRegistration[]) {\n    }\n\n    initialize(registry: ActionHandlerRegistry): void {\n        this.registrations.forEach(registration =>\n            registry.register(registration.kind, new CommandActionHandler(registration))\n        );\n    }\n}\n\nexport interface CommandRegistration {\n    kind: string\n    factory: (a: Action) => ICommand\n}\n\nexport interface ICommandConstructor<T extends Action> {\n    KIND: string\n    new (a: T, ...args: any[]): ICommand\n}\n\n/**\n * Use this method in your DI configuration to register a new command to the diagram.\n */\nexport function configureCommand<T extends Action>(context: { bind: interfaces.Bind, isBound: interfaces.IsBound },\n        constr: ICommandConstructor<T>) {\n    if (!isInjectable(constr)) {\n        throw new Error(`Commands should be @injectable: ${constr.name}`);\n    }\n    if (!context.isBound(constr)) {\n        context.bind(constr).toSelf();\n    }\n    context.bind(TYPES.CommandRegistration).toDynamicValue(ctx => ({\n        kind: constr.KIND,\n        factory: (action: Action) => {\n            const childContainer = new Container();\n            childContainer.parent = ctx.container;\n            childContainer.bind(TYPES.Action).toConstantValue(action);\n            return childContainer.get<ICommand>(constr);\n        }\n    }));\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Container } from \"inversify\";\nimport { safeAssign } from \"sprotty-protocol/lib/utils/object\";\nimport { TYPES } from '../types';\n\n/**\n * Options for the command execution\n */\nexport interface CommandStackOptions {\n    /**\n     * The default duration of an animated command in milliseconds\n     */\n    defaultDuration: number\n\n    /**\n     * The maximum number of commands that can be undone. Once the undo stack\n     * reaches this number, any additional command that is pushed will remove\n     * one from the bottom of the stack.\n     *\n     * If negative, there is no limit, which results in a memory leak.\n     */\n    undoHistoryLimit: number\n}\n\nexport function overrideCommandStackOptions(container: Container, options: Partial<CommandStackOptions>): CommandStackOptions {\n    const defaultOptions = container.get<CommandStackOptions>(TYPES.CommandStackOptions);\n    safeAssign(defaultOptions, options);\n    return defaultOptions;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, postConstruct } from \"inversify\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { TYPES } from \"../types\";\nimport { ILogger } from \"../../utils/logging\";\nimport { EMPTY_ROOT, IModelFactory } from \"../model/smodel-factory\";\nimport { SModelRootImpl } from \"../model/smodel\";\nimport { AnimationFrameSyncer } from \"../animations/animation-frame-syncer\";\nimport { IViewer, IViewerProvider } from \"../views/viewer\";\nimport { CommandStackOptions } from './command-stack-options';\nimport {\n    HiddenCommand, ICommand, CommandExecutionContext, CommandReturn, SystemCommand,\n    MergeableCommand, PopupCommand, ResetCommand, CommandResult\n} from './command';\n\n/**\n * The component that holds the current model and applies the commands\n * to change it.\n *\n * The command stack is called by the ActionDispatcher and forwards the\n * changed model to the Viewer that renders it.\n */\nexport interface ICommandStack {\n    /**\n     * Executes the given command on the current model and returns a\n     * Promise for the new result.\n     *\n     * Unless it is a special command, it is pushed to the undo stack\n     * such that it can be rolled back later and the redo stack is\n     * cleared.\n     */\n    execute(command: ICommand): Promise<SModelRootImpl>\n\n    /**\n     * Executes all of the given commands. As opposed to calling\n     * execute() multiple times, the Viewer is only updated once after\n     * the last command has been executed.\n     */\n    executeAll(commands: ICommand[]): Promise<SModelRootImpl>\n\n    /**\n     * Takes the topmost command from the undo stack, undoes its\n     * changes and pushes it ot the redo stack. Returns a Promise for\n     * the changed model.\n     */\n    undo(): Promise<SModelRootImpl>\n\n    /**\n     * Takes the topmost command from the redo stack, redoes its\n     * changes and pushes it ot the undo stack. Returns a Promise for\n     * the changed model.\n     */\n    redo(): Promise<SModelRootImpl>\n}\n\n/**\n * As part of the event cylce, the ICommandStack should be injected\n * using a provider to avoid cyclic injection dependencies.\n */\nexport type CommandStackProvider = () => Promise<ICommandStack>;\n\n/**\n * The implementation of the ICommandStack. Clients should not use this\n * class directly.\n *\n * The command stack holds the current model as the result of the current\n * promise. When a new command is executed/undone/redone, its execution is\n * chained using <code>Promise#then()</code> to the current Promise. This\n * way we can handle long running commands without blocking the current\n * thread.\n *\n * The command stack also does the special handling for special commands:\n *\n * System commands should be transparent to the user and as such be\n * automatically undone/redone with the next plain command. Additional care\n * must be taken that system commands that are executed after undo don't\n * break the correspondence between the topmost commands on the undo and\n * redo stacks.\n *\n * Hidden commands only tell the viewer to render a hidden model such that\n * its bounds can be extracted from the DOM and forwarded as separate actions.\n * Hidden commands should not leave any trace on the undo/redo/off stacks.\n *\n * Mergeable commands should be merged with their predecessor if possible,\n * such that e.g. multiple subsequent moves of the smae element can be undone\n * in one single step.\n */\n@injectable()\nexport class CommandStack implements ICommandStack {\n\n    @inject(TYPES.IModelFactory) protected modelFactory: IModelFactory;\n    @inject(TYPES.IViewerProvider) protected viewerProvider: IViewerProvider;\n    @inject(TYPES.ILogger) protected logger: ILogger;\n    @inject(TYPES.AnimationFrameSyncer) protected syncer: AnimationFrameSyncer;\n    @inject(TYPES.CommandStackOptions) protected options: CommandStackOptions;\n\n    protected currentPromise: Promise<CommandStackState>;\n\n    protected modelViewer?: IViewer;\n    protected hiddenModelViewer?: IViewer;\n    protected popupModelViewer?: IViewer;\n\n    protected undoStack: ICommand[] = [];\n    protected redoStack: ICommand[] = [];\n\n    /**\n     * System commands should be transparent to the user in undo/redo\n     * operations. When a system command is executed when the redo\n     * stack is not empty, it is pushed to offStack instead.\n     *\n     * On redo, all commands form this stack are undone such that the\n     * redo operation gets the exact same model as when it was executed\n     * first.\n     *\n     * On undo, all commands form this stack are undone as well as\n     * system ommands should be transparent to the user.\n     */\n    protected offStack: ICommand[] = [];\n\n    @postConstruct()\n    protected initialize() {\n        this.currentPromise = Promise.resolve({\n            main: {\n                model: this.modelFactory.createRoot(EMPTY_ROOT),\n                modelChanged: false,\n            },\n            hidden: {\n                model: this.modelFactory.createRoot(EMPTY_ROOT),\n                modelChanged: false,\n            },\n            popup: {\n                model: this.modelFactory.createRoot(EMPTY_ROOT),\n                modelChanged: false,\n            }\n        });\n    }\n\n    protected get currentModel(): Promise<SModelRootImpl> {\n        return this.currentPromise.then(\n            state => state.main.model\n        );\n    }\n\n    executeAll(commands: ICommand[]): Promise<SModelRootImpl> {\n        commands.forEach(\n            command => {\n                this.logger.log(this, 'Executing', command);\n                this.handleCommand(command, command.execute, this.mergeOrPush);\n            }\n        );\n        return this.thenUpdate();\n    }\n\n    execute(command: ICommand): Promise<SModelRootImpl> {\n        this.logger.log(this, 'Executing', command);\n        this.handleCommand(command, command.execute, this.mergeOrPush);\n        return this.thenUpdate();\n    }\n\n    undo(): Promise<SModelRootImpl> {\n        this.undoOffStackSystemCommands();\n        this.undoPreceedingSystemCommands();\n        const command = this.undoStack[this.undoStack.length - 1];\n        if (command !== undefined && !this.isBlockUndo(command)) {\n            this.undoStack.pop();\n            this.logger.log(this, 'Undoing', command);\n            this.handleCommand(command, command.undo, (c: ICommand, context: CommandExecutionContext) => {\n                this.redoStack.push(c);\n            });\n        }\n        return this.thenUpdate();\n    }\n\n    redo(): Promise<SModelRootImpl> {\n        this.undoOffStackSystemCommands();\n        const command = this.redoStack.pop();\n        if (command !== undefined) {\n            this.logger.log(this, 'Redoing', command);\n            this.handleCommand(command, command.redo, (c: ICommand, context: CommandExecutionContext) => {\n                this.pushToUndoStack(c);\n            });\n        }\n        this.redoFollowingSystemCommands();\n        return this.thenUpdate();\n    }\n\n    /**\n     * Chains the current promise with another Promise that performs the\n     * given operation on the given command.\n     *\n     * @param beforeResolve a function that is called directly before\n     *      resolving the Promise to return the new model. Usually puts the\n     *      command on the appropriate stack.\n     */\n    protected handleCommand(command: ICommand,\n                            operation: (context: CommandExecutionContext) => CommandReturn,\n                            beforeResolve: (command: ICommand, context: CommandExecutionContext) => void) {\n        this.currentPromise = this.currentPromise.then(state =>\n            new Promise<CommandStackState>(resolve => {\n                let target: 'main' | 'hidden' | 'popup';\n                if (command instanceof HiddenCommand)\n                    target = 'hidden';\n                else if (command instanceof PopupCommand)\n                    target = 'popup';\n                else\n                    target = 'main';\n                const context = this.createContext(state.main.model);\n\n                let commandResult: CommandReturn;\n                try {\n                    commandResult = operation.call(command, context);\n                } catch (error) {\n                    this.logger.error(this, \"Failed to execute command:\", error);\n                    commandResult = state[target].model;\n                }\n\n                const newState = copyState(state);\n                if (commandResult instanceof Promise) {\n                    commandResult.then(newModel => {\n                        if (target === 'main')\n                            beforeResolve.call(this, command, context);\n                        newState[target] = { model: newModel, modelChanged: true };\n                        resolve(newState);\n                    });\n                } else if (commandResult instanceof SModelRootImpl) {\n                    if (target === 'main')\n                        beforeResolve.call(this, command, context);\n                    newState[target] = { model: commandResult, modelChanged: true };\n                    resolve(newState);\n                } else {\n                    if (target === 'main')\n                        beforeResolve.call(this, command, context);\n                    newState[target] = {\n                        model: commandResult.model,\n                        modelChanged: state[target].modelChanged || commandResult.modelChanged,\n                        cause: commandResult.cause\n                    };\n                    resolve(newState);\n                }\n            })\n        );\n    }\n\n    protected pushToUndoStack(command: ICommand) {\n        this.undoStack.push(command);\n        if (this.options.undoHistoryLimit >= 0 && this.undoStack.length > this.options.undoHistoryLimit)\n            this.undoStack.splice(0, this.undoStack.length - this.options.undoHistoryLimit);\n    }\n\n    /**\n     * Notifies the Viewer to render the new model and/or the new hidden model\n     * and returns a Promise for the new model.\n     */\n    protected thenUpdate(): Promise<SModelRootImpl> {\n        this.currentPromise = this.currentPromise.then(state => {\n            const newState = copyState(state);\n            if (state.hidden.modelChanged) {\n                this.updateHidden(state.hidden.model, state.hidden.cause);\n                newState.hidden.modelChanged = false;\n                newState.hidden.cause = undefined;\n            }\n            if (state.main.modelChanged) {\n                this.update(state.main.model, state.main.cause);\n                newState.main.modelChanged = false;\n                newState.main.cause = undefined;\n            }\n            if (state.popup.modelChanged) {\n                this.updatePopup(state.popup.model, state.popup.cause);\n                newState.popup.modelChanged = false;\n                newState.popup.cause = undefined;\n            }\n            return newState;\n        });\n        return this.currentModel;\n    }\n\n    /**\n     * Notify the `ModelViewer` that the model has changed.\n     */\n    update(model: SModelRootImpl, cause?: Action): void {\n        if (this.modelViewer === undefined) {\n            this.modelViewer = this.viewerProvider.modelViewer;\n        }\n        this.modelViewer.update(model, cause);\n    }\n\n    /**\n     * Notify the `HiddenModelViewer` that the hidden model has changed.\n     */\n    updateHidden(model: SModelRootImpl, cause?: Action): void {\n        if (this.hiddenModelViewer === undefined) {\n            this.hiddenModelViewer = this.viewerProvider.hiddenModelViewer;\n        }\n        this.hiddenModelViewer.update(model, cause);\n    }\n\n    /**\n     * Notify the `PopupModelViewer` that the popup model has changed.\n     */\n    updatePopup(model: SModelRootImpl, cause?: Action): void {\n        if (this.popupModelViewer === undefined) {\n            this.popupModelViewer = this.viewerProvider.popupModelViewer;\n        }\n        this.popupModelViewer.update(model, cause);\n    }\n\n    /**\n     * Handling of commands after their execution.\n     *\n     * Hidden commands are not pushed to any stack.\n     *\n     * System commands are pushed to the <code>offStack</code> when the redo\n     * stack is not empty, allowing to undo the before a redo to keep the chain\n     * of commands consistent.\n     *\n     * Mergable commands are merged if possible.\n     */\n    protected mergeOrPush(command: ICommand, context: CommandExecutionContext): void {\n        if (this.isBlockUndo(command)) {\n            this.undoStack = [];\n            this.redoStack = [];\n            this.offStack = [];\n            this.pushToUndoStack(command);\n            return;\n        }\n        if (this.isPushToOffStack(command) && this.redoStack.length > 0) {\n            if (this.offStack.length > 0) {\n                const lastCommand = this.offStack[this.offStack.length - 1];\n                if (lastCommand instanceof MergeableCommand && lastCommand.merge(command, context))\n                    return;\n            }\n            this.offStack.push(command);\n            return;\n        }\n        if (this.isPushToUndoStack(command)) {\n            this.offStack.forEach(c => this.undoStack.push(c));\n            this.offStack = [];\n            this.redoStack = [];\n            if (this.undoStack.length > 0) {\n                const lastCommand = this.undoStack[this.undoStack.length - 1];\n                if (lastCommand instanceof MergeableCommand && lastCommand.merge(command, context))\n                    return;\n            }\n            this.pushToUndoStack(command);\n        }\n    }\n\n    /**\n     * Reverts all system commands on the offStack.\n     */\n    protected undoOffStackSystemCommands(): void {\n        let command = this.offStack.pop();\n        while (command !== undefined) {\n            this.logger.log(this, 'Undoing off-stack', command);\n            this.handleCommand(command, command.undo, () => {});\n            command = this.offStack.pop();\n        }\n    }\n\n    /**\n     * System commands should be transparent to the user, so this method\n     * is called from <code>undo()</code> to revert all system commands\n     * at the top of the undoStack.\n     */\n    protected undoPreceedingSystemCommands(): void {\n        let command = this.undoStack[this.undoStack.length - 1];\n        while (command !== undefined && this.isPushToOffStack(command)) {\n            this.undoStack.pop();\n            this.logger.log(this, 'Undoing', command);\n            this.handleCommand(command, command.undo, (c: ICommand, context: CommandExecutionContext) => {\n                this.redoStack.push(c);\n            });\n            command = this.undoStack[this.undoStack.length - 1];\n        }\n    }\n\n    /**\n     * System commands should be transparent to the user, so this method\n     * is called from <code>redo()</code> to re-execute all system commands\n     * at the top of the redoStack.\n     */\n    protected redoFollowingSystemCommands(): void {\n        let command = this.redoStack[this.redoStack.length - 1];\n        while (command !== undefined && this.isPushToOffStack(command)) {\n            this.redoStack.pop();\n            this.logger.log(this, 'Redoing ', command);\n            this.handleCommand(command, command.redo, (c: ICommand, context: CommandExecutionContext) => {\n                this.pushToUndoStack(c);\n            });\n            command = this.redoStack[this.redoStack.length - 1];\n        }\n    }\n\n    /**\n     * Assembles the context object that is passed to the commands execution method.\n     */\n    protected createContext(currentModel: SModelRootImpl): CommandExecutionContext {\n        return {\n            root: currentModel,\n            modelChanged: this,\n            modelFactory: this.modelFactory,\n            duration: this.options.defaultDuration,\n            logger: this.logger,\n            syncer: this.syncer\n        };\n    }\n\n    protected isPushToOffStack(command: ICommand): boolean {\n        return command instanceof SystemCommand;\n    }\n\n    protected isPushToUndoStack(command: ICommand): boolean {\n        return !(command instanceof HiddenCommand);\n    }\n\n    protected isBlockUndo(command: ICommand): boolean {\n        return command instanceof ResetCommand;\n    }\n}\n\n/**\n * Internal type to pass the results between the promises in the `CommandStack`.\n */\nexport interface CommandStackState {\n    main: CommandResult,\n    hidden: CommandResult,\n    popup: CommandResult\n}\n\nfunction copyState(state: CommandStackState): CommandStackState {\n    return {\n        main: {...state.main},\n        hidden: {...state.hidden},\n        popup: {...state.popup}\n    };\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Alignable, BoundsAware, SModelElement, SModelRoot } from '../model';\nimport { ComputedBoundsAction } from '../actions';\n\n/**\n * Clone a given model. This function requires that the model is serializable, so it's\n * free of cycles and functions.\n */\nexport function cloneModel<T extends SModelElement>(model: T): T {\n    return JSON.parse(JSON.stringify(model));\n}\n\n/**\n * Apply the computed bounds to the given model. This ensures that the model has complete\n * information about positions and sizes derived from its actual rendering in the frontend.\n */\nexport function applyBounds(root: SModelRoot, action: ComputedBoundsAction) {\n    const index = new SModelIndex();\n    index.add(root);\n    for (const b of action.bounds) {\n        const element = index.getById(b.elementId);\n        if (element) {\n            const bae = element as SModelElement & BoundsAware;\n            if (b.newPosition) {\n                bae.position = { x: b.newPosition.x, y: b.newPosition.y };\n            }\n            if (b.newSize) {\n                bae.size = { width: b.newSize.width, height: b.newSize.height };\n            }\n        }\n    }\n    if (action.alignments) {\n        for (const a of action.alignments) {\n            const element = index.getById(a.elementId);\n            if (element) {\n                const alignable = element as SModelElement & Alignable;\n                alignable.alignment = { x: a.newAlignment.x, y: a.newAlignment.y };\n            }\n        }\n    }\n}\n\n/**\n * Model element types can include a colon to separate the basic type and a sub-type. This function\n * extracts the basic type of a model element.\n */\nexport function getBasicType(element: { type: string }): string {\n    if (!element.type) {\n        return '';\n    }\n    const colonIndex = element.type.indexOf(':');\n    return colonIndex >= 0 ? element.type.substring(0, colonIndex) : element.type;\n}\n\n/**\n * Model element types can include a colon to separate the basic type and a sub-type. This function\n * extracts the sub-type of a model element.\n */\nexport function getSubType(schema: { type: string }): string {\n    if (!schema.type) {\n        return '';\n    }\n    const colonIndex = schema.type.indexOf(':');\n    return colonIndex >= 0 ? schema.type.substring(colonIndex + 1) : schema.type;\n}\n\n/**\n * Find the element with the given identifier. If you need to find multiple elements, using an\n * `SModelIndex` might be more effective.\n */\nexport function findElement(parent: SModelElement, elementId: string): SModelElement | undefined {\n    if (parent.id === elementId)\n        return parent;\n    if (parent.children !== undefined) {\n        for (const child of parent.children) {\n            const result = findElement(child, elementId);\n            if (result !== undefined)\n                return result;\n        }\n    }\n    return undefined;\n}\n\n/**\n * Used to speed up model element lookup by id.\n * This index implementation is for the serializable _external model_ defined in `sprotty-protocol`.\n */\nexport class SModelIndex {\n\n    private readonly id2element: Map<string, SModelElement> = new Map();\n    private id2parent: Map<string, SModelElement> = new Map();\n\n    add(element: SModelElement): void {\n        if (!element.id) {\n            throw new Error(\"Model element has no ID.\");\n        } else if (this.contains(element)) {\n            throw new Error(\"Duplicate ID in model: \" + element.id);\n        }\n        this.id2element.set(element.id, element);\n        if (Array.isArray(element.children)) {\n            for (const child of element.children) {\n                this.add(child as any);\n                this.id2parent.set(child.id, element);\n            }\n        }\n    }\n\n    remove(element: SModelElement): void {\n        this.id2element.delete(element.id);\n        if (Array.isArray(element.children)) {\n            for (const child of element.children) {\n                this.id2parent.delete(child.id);\n                this.remove(child as any);\n            }\n        }\n    }\n\n    contains(element: SModelElement): boolean {\n        return this.id2element.has(element.id);\n    }\n\n    getById(id: string): SModelElement | undefined {\n        return this.id2element.get(id);\n    }\n\n    getParent(id: string): SModelElement | undefined {\n        return this.id2parent.get(id);\n    }\n\n    getRoot(element: SModelElement): SModelRoot {\n        let current: SModelElement | undefined = element;\n        while (current) {\n            const parent = this.id2parent.get(current.id);\n            if (parent === undefined) {\n                return current;\n            }\n            current = parent;\n        }\n        throw new Error(\"Element has no root\");\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ServerActionHandlerRegistry } from './action-handler';\nimport {\n    Action, isResponseAction, ResponseAction, RequestModelAction, ComputedBoundsAction, LayoutAction, RequestBoundsAction,\n    RequestAction, generateRequestId, SetModelAction, UpdateModelAction, RejectAction, isRequestAction\n} from './actions';\nimport { DiagramServices, DiagramState, IDiagramGenerator, IModelLayoutEngine } from './diagram-services';\nimport { SModelRoot } from './model';\nimport { Deferred } from './utils/async';\nimport { applyBounds, cloneModel } from './utils/model-utils';\n\n/**\n * An instance of this class is responsible for handling a single diagram client. It holds the current\n * state of the diagram and manages communication with the client via actions.\n */\nexport class DiagramServer {\n\n    readonly state: DiagramState & {\n        lastSubmittedModelType?: string\n    } = {\n        currentRoot: {\n            type: 'NONE',\n            id: 'ROOT'\n        },\n        revision: 0\n    };\n    readonly dispatch: <A extends Action>(action: A) => Promise<void>;\n\n    protected readonly diagramGenerator: IDiagramGenerator;\n    protected readonly layoutEngine?: IModelLayoutEngine;\n    protected actionHandlerRegistry?: ServerActionHandlerRegistry;\n    protected readonly requests = new Map<string, Deferred<ResponseAction>>();\n\n    constructor(dispatch: <A extends Action>(action: A) => Promise<void>,\n                services: DiagramServices) {\n        this.dispatch = dispatch;\n        this.diagramGenerator = services.DiagramGenerator;\n        this.layoutEngine = services.ModelLayoutEngine;\n        this.actionHandlerRegistry = services.ServerActionHandlerRegistry;\n    }\n\n    /**\n     * Set the model and submit it to the client.\n     */\n    setModel(newRoot: SModelRoot): Promise<void> {\n        newRoot.revision = ++this.state.revision;\n        this.state.currentRoot = newRoot;\n        return this.submitModel(newRoot, false);\n    }\n\n    /**\n     * Update the model to a new state and submit it to the client.\n     */\n    updateModel(newRoot: SModelRoot): Promise<void> {\n        newRoot.revision = ++this.state.revision;\n        this.state.currentRoot = newRoot;\n        return this.submitModel(newRoot, true);\n    }\n\n    /**\n     * Whether the client needs to compute the layout of parts of the model. This affects the behavior\n     * of `submitModel`.\n     *\n     * This setting is determined by the `DiagramOptions` that are received with the `RequestModelAction`\n     * from the client. If the client does not specify whether it needs client layout, the default value\n     * is `true`.\n     */\n    get needsClientLayout(): boolean {\n        if (this.state.options && this.state.options.needsClientLayout !== undefined) {\n            return !!this.state.options.needsClientLayout;\n        }\n        return true;\n    }\n\n    /**\n     * Whether the server needs to compute the layout of parts of the model. This affects the behavior\n     * of `submitModel`.\n     *\n     * This setting is determined by the `DiagramOptions` that are received with the `RequestModelAction`\n     * from the client. If the client does not specify whether it needs server layout, the default value\n     * is `false`.\n     */\n    get needsServerLayout(): boolean {\n        if (this.state.options && this.state.options.needsServerLayout !== undefined) {\n            return !!this.state.options.needsServerLayout;\n        }\n        return false;\n    }\n\n    /**\n     * Called when an action is received from the client.\n     */\n    accept(action: Action): Promise<void> {\n        if (isResponseAction(action)) {\n            const id = action.responseId;\n            const future = this.requests.get(id);\n            if (future) {\n                this.requests.delete(id);\n                if (action.kind === RejectAction.KIND) {\n                    const rejectAction: RejectAction = action as any;\n                    future.reject(new Error(rejectAction.message));\n                    console.warn(`Request with id ${action.responseId} failed: ${rejectAction.message}`, rejectAction.detail);\n                } else {\n                    future.resolve(action);\n                }\n                return Promise.resolve();\n            }\n            console.info('No matching request for response:', action);\n        }\n        return this.handleAction(action);\n    }\n\n    /**\n     * Send a request action to the client. The resulting promise is resolved when a matching\n     * response is received and rejected when a `RejectAction` is received.\n     */\n    request<Res extends ResponseAction>(action: RequestAction<Res>): Promise<Res> {\n        if (!action.requestId) {\n            action.requestId = 'server_' + generateRequestId();\n        }\n        const future = new Deferred<Res>();\n        this.requests.set(action.requestId, future as any);\n        this.dispatch(action).catch(err => {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.requests.delete(action.requestId!);\n            future.reject(err);\n        });\n        return future.promise;\n    }\n\n    /**\n     * Send a `RejectAction` to the client to notify that a request could not be fulfilled.\n     */\n    rejectRemoteRequest(action: Action | undefined, error: Error): void {\n        if (action && isRequestAction(action)) {\n            this.dispatch({\n                kind: RejectAction.KIND,\n                responseId: action.requestId,\n                message: error.message,\n                detail: error.stack\n            });\n        }\n    }\n\n    protected handleAction(action: Action): Promise<void> {\n        // Find a matching action handler in the registry\n        const handlers = this.actionHandlerRegistry?.getHandler(action.kind);\n        if (handlers && handlers.length === 1) {\n            return handlers[0](action, this.state, this);\n        } else if (handlers && handlers.length > 1) {\n            return Promise.all(handlers.map(h => h(action, this.state, this))) as Promise<any>;\n        }\n        // If no handler is registered, call one of the default handling methods\n        switch (action.kind) {\n            case RequestModelAction.KIND:\n                return this.handleRequestModel(action as RequestModelAction);\n            case ComputedBoundsAction.KIND:\n                return this.handleComputedBounds(action as ComputedBoundsAction);\n            case LayoutAction.KIND:\n                return this.handleLayout(action as LayoutAction);\n        }\n        // We don't know this action kind, sigh\n        console.warn(`Unhandled action from client: ${action.kind}`);\n        return Promise.resolve();\n    }\n\n    protected async handleRequestModel(action: RequestModelAction): Promise<void> {\n        this.state.options = action.options;\n        try {\n            const newRoot = await this.diagramGenerator.generate({\n                options: this.state.options ?? {},\n                state: this.state\n            });\n            newRoot.revision = ++this.state.revision;\n            this.state.currentRoot = newRoot;\n            await this.submitModel(this.state.currentRoot, false, action);\n        } catch (err) {\n            this.rejectRemoteRequest(action, err as Error);\n            console.error('Failed to generate diagram:', err);\n        }\n    }\n\n    /**\n     * Submit a model to the client after it has been updated in the server state.\n     */\n     protected async submitModel(newRoot: SModelRoot, update: boolean, cause?: Action): Promise<void> {\n        if (this.needsClientLayout) {\n            if (!this.needsServerLayout) {\n                // In this case the client won't send us the computed bounds\n                this.dispatch({ kind: RequestBoundsAction.KIND, newRoot });\n            } else {\n                const request = RequestBoundsAction.create(newRoot);\n                const response = await this.request<ComputedBoundsAction>(request);\n                const currentRoot = this.state.currentRoot;\n                if (response.revision === currentRoot.revision) {\n                    applyBounds(currentRoot, response);\n                    await this.doSubmitModel(currentRoot, update, cause);\n                } else {\n                    this.rejectRemoteRequest(cause, new Error(`Model revision does not match: ${response.revision}`));\n                }\n            }\n        } else {\n            await this.doSubmitModel(newRoot, update, cause);\n        }\n    }\n\n    private async doSubmitModel(newRoot: SModelRoot, update: boolean, cause?: Action): Promise<void> {\n        if (newRoot.revision !== this.state.revision) {\n            return;\n        }\n        if (this.needsServerLayout && this.layoutEngine) {\n            newRoot = await this.layoutEngine.layout(newRoot);\n        }\n        const modelType = newRoot.type;\n        if (cause && cause.kind === RequestModelAction.KIND) {\n            const requestId = (cause as RequestModelAction).requestId;\n            const response = SetModelAction.create(newRoot, requestId);\n            await this.dispatch(response);\n        } else if (update && modelType === this.state.lastSubmittedModelType) {\n            await this.dispatch({ kind: UpdateModelAction.KIND, newRoot, cause });\n        } else {\n            await this.dispatch({ kind: SetModelAction.KIND, newRoot });\n        }\n        this.state.lastSubmittedModelType = modelType;\n    }\n\n    protected handleComputedBounds(action: ComputedBoundsAction): Promise<void> {\n        if (action.revision !== this.state.currentRoot.revision) {\n            return Promise.reject();\n        }\n        applyBounds(this.state.currentRoot, action);\n        return Promise.resolve();\n    }\n\n    protected async handleLayout(action: LayoutAction): Promise<void> {\n        if (!this.layoutEngine) {\n            return;\n        }\n        if (!this.needsServerLayout) {\n            let newRoot = cloneModel(this.state.currentRoot);\n            newRoot = await this.layoutEngine.layout(newRoot);\n            newRoot.revision = ++this.state.revision;\n            this.state.currentRoot = newRoot;\n        }\n        await this.doSubmitModel(this.state.currentRoot, true, action);\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Bounds, Point, Dimension } from './utils/geometry';\nimport { hasOwnProperty } from './utils/object';\n\n/**\n * Base type for all elements of the diagram model.\n * Each model element must have a unique ID and a type that is used to look up its view.\n */\nexport interface SModelElement {\n    type: string\n    id: string\n    children?: SModelElement[]\n    cssClasses?: string[]\n}\n\n/**\n * Base type for the root element of the diagram model tree.\n */\nexport interface SModelRoot extends SModelElement {\n    canvasBounds?: Bounds\n    revision?: number\n}\n\n/**\n * Model elements that implement this interface have a position and a size.\n */\nexport interface BoundsAware {\n    position: Point\n    size: Dimension\n}\n\n/**\n * Used to adjust elements whose bounding box is not at the origin, e.g. labels\n * or pre-rendered SVG figures.\n */\nexport interface Alignable {\n    alignment: Point\n}\n\n/**\n * A viewport has a scroll position and a zoom factor. Usually these properties are\n * applied to the root element to enable navigating through the diagram.\n */\nexport interface Viewport extends Scrollable, Zoomable {\n}\n\n/**\n * Usually the root of a model is also a viewport.\n */\nexport interface ViewportRootElement extends SModelRoot {\n    scroll?: Point\n    zoom?: number\n    position?: Point\n    size?: Dimension\n}\n\n/**\n * A scrollable element has a scroll position, which indicates the top left corner of the\n * visible area.\n */\nexport interface Scrollable {\n    scroll: Point\n}\n\nexport function isScrollable(element: SModelElement | Scrollable): element is Scrollable {\n    return hasOwnProperty(element, 'scroll');\n}\n\n/**\n * A zoomable element can be scaled so it appears smaller or larger than its actual size.\n * The zoom value 1 is the default scale where the content is drawn with its actual size.\n */\nexport interface Zoomable {\n    zoom: number\n}\n\nexport function isZoomable(element: SModelElement | Zoomable): element is Zoomable {\n    return hasOwnProperty(element, 'zoom');\n}\n\n/**\n * Root element for graph-like models.\n */\nexport interface SGraph extends SModelRoot {\n    children: SModelElement[]\n    bounds?: Bounds\n    scroll?: Point\n    zoom?: number\n    layoutOptions?: ModelLayoutOptions\n}\n\n/**\n * Options to control the \"micro layout\" of a model element, i.e. the arrangement of its content\n * using simple algorithms such as horizontal or vertical box layout.\n */\nexport type ModelLayoutOptions = { [key: string]: string | number | boolean };\n\nexport interface SShapeElement extends SModelElement {\n    position?: Point\n    size?: Dimension\n    layoutOptions?: ModelLayoutOptions\n}\n\n/**\n * Model element class for nodes, which are the main entities in a graph. A node can be connected to\n * another node via an SEdge. Such a connection can be direct, i.e. the node is the source or target of\n * the edge, or indirect through a port, i.e. it contains an SPort which is the source or target of the edge.\n */\nexport interface SNode extends SShapeElement {\n    layout?: string\n    selected?: boolean\n    hoverFeedback?: boolean\n    opacity?: number\n    anchorKind?: string\n}\n\n/**\n * A port is a connection point for edges. It should always be contained in an SNode.\n */\nexport interface SPort extends SShapeElement {\n    selected?: boolean\n    hoverFeedback?: boolean\n    opacity?: number\n    anchorKind?: string\n}\n\n/**\n * Model element class for edges, which are the connectors in a graph. An edge has a source and a target,\n * each of which can be either a node or a port. The source and target elements are referenced via their ids.\n */\nexport interface SEdge extends SModelElement {\n    sourceId: string\n    targetId: string\n    routerKind?: string\n    routingPoints?: Point[]\n    selected?: boolean\n    hoverFeedback?: boolean\n    opacity?: number\n}\n\n/**\n * A label can be attached to a node, edge, or port, and contains some text to be rendered in its view.\n */\nexport interface SLabel extends SShapeElement {\n    text: string\n    selected?: boolean\n}\n\n/**\n * A compartment is used to group multiple child elements such as labels of a node. Usually a `vbox`\n * or `hbox` layout is used to arrange these children.\n */\nexport interface SCompartment extends SShapeElement {\n    layout?: string\n}\n\n/**\n * Root model element class for HTML content. Usually this is rendered with a `div` DOM element.\n */\nexport interface HtmlRoot extends SModelRoot {\n    classes?: string[]\n}\n\n/**\n * Pre-rendered elements contain HTML or SVG code to be transferred to the DOM. This can be useful to\n * render complex figures or to compute the view on the server instead of the client code.\n */\nexport interface PreRenderedElement extends SModelElement {\n    code: string\n}\n\n/**\n * Same as PreRenderedElement, but with a position and a size.\n */\nexport interface ShapedPreRenderedElement extends PreRenderedElement {\n    position?: Point\n    size?: Dimension\n}\n\n/**\n * A `foreignObject` element to be transferred to the DOM within the SVG.\n *\n * This can be useful to to benefit from e.g. HTML rendering features, such as line wrapping, inside of\n * the SVG diagram.  Note that `foreignObject` is not supported by all browsers and SVG viewers may not\n * support rendering the `foreignObject` content.\n *\n * If no dimensions are specified in the schema element, this element will obtain the dimension of\n * its parent to fill the entire available room. Thus, this element requires specified bounds itself\n * or bounds to be available for its parent.\n */\nexport interface ForeignObjectElement extends ShapedPreRenderedElement {\n    /** The namespace to be assigned to the elements inside of the `foreignObject`. */\n    namespace: string\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport * from './actions';\nexport * from './diagram-server';\nexport * from './diagram-services';\nexport * from './model';\nexport * from './utils/async';\nexport * from './utils/geometry';\nexport * from './utils/json';\nexport * from './utils/model-utils';\nexport * from './utils/object';\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Point } from 'sprotty-protocol';\n\n/**\n * Returns whether the mouse or keyboard event includes the CMD key\n * on Mac or CTRL key on Linux / others.\n */\nexport function isCtrlOrCmd(event: KeyboardEvent | MouseEvent) {\n    if (isMac())\n        return event.metaKey;\n    else\n        return event.ctrlKey;\n}\n\nexport function isMac(): boolean {\n    return window.navigator.userAgent.indexOf(\"Mac\") !== -1;\n}\n\nexport function isCrossSite(url: string): boolean {\n    if (url && typeof window !== 'undefined' && window.location) {\n        let baseURL: string = '';\n        if (window.location.protocol)\n            baseURL += window.location.protocol + '//';\n        if (window.location.host)\n            baseURL += window.location.host;\n        return baseURL.length > 0 && !url.startsWith(baseURL);\n    }\n    return false;\n}\n\n/**\n * Returns the amount of scroll of the browser window as a point.\n */\nexport function getWindowScroll(): Point {\n    if (typeof window === 'undefined') {\n        return Point.ORIGIN;\n    }\n    return {\n        x: window.pageXOffset,\n        y: window.pageYOffset\n    };\n}\n\n/**\n * Checks whether the given mouse event hits the given DOM element.\n */\nexport function hitsMouseEvent(child: Element, event: MouseEvent): boolean {\n    const clientRect = child.getBoundingClientRect();\n    return event.clientX >= clientRect.left && event.clientX <= clientRect.right\n        && event.clientY >= clientRect.top && event.clientY <= clientRect.bottom;\n}\n\n/**\n * Checks whether the given DOM node is an SVG element.\n */\nexport function isSVGGraphicsElement(node: Node): node is SVGGraphicsElement {\n    return typeof (node as SVGGraphicsElement).getBBox === 'function';\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from \"inversify\";\nimport { VNode } from \"snabbdom\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { almostEquals, Bounds, Dimension } from \"sprotty-protocol/lib/utils/geometry\";\nimport { TYPES } from \"../types\";\nimport { IActionDispatcher } from '../actions/action-dispatcher';\nimport { IVNodePostprocessor } from \"../views/vnode-postprocessor\";\nimport { SModelElementImpl, SModelRootImpl } from \"../model/smodel\";\nimport { SystemCommand, CommandExecutionContext, CommandReturn } from '../commands/command';\nimport { getWindowScroll } from \"../../utils/browser\";\n\n/**\n * Grabs the bounds from the root element in page coordinates and fires a\n * InitializeCanvasBoundsAction. This size is needed for other actions such\n * as FitToScreenAction.\n */\n@injectable()\nexport class CanvasBoundsInitializer implements IVNodePostprocessor {\n\n    protected rootAndVnode: [SModelRootImpl, VNode] | undefined;\n\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: IActionDispatcher;\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        if (element instanceof SModelRootImpl && !Dimension.isValid(element.canvasBounds)) {\n            this.rootAndVnode = [element, vnode];\n        }\n        return vnode;\n    }\n\n    postUpdate() {\n        if (this.rootAndVnode !== undefined) {\n            const domElement = this.rootAndVnode[1].elm;\n            const oldBounds = this.rootAndVnode[0].canvasBounds;\n            if (domElement !== undefined) {\n                const newBounds = this.getBoundsInPage(domElement as Element);\n                if (!(almostEquals(newBounds.x, oldBounds.x)\n                        && almostEquals(newBounds.y, oldBounds.y)\n                        && almostEquals(newBounds.width, oldBounds.width)\n                        && almostEquals(newBounds.height, oldBounds.width)))\n                    this.actionDispatcher.dispatch(InitializeCanvasBoundsAction.create(newBounds));\n\n            }\n            this.rootAndVnode = undefined;\n        }\n    }\n\n    protected getBoundsInPage(element: Element) {\n        const bounds = element.getBoundingClientRect();\n        const scroll = getWindowScroll();\n        return {\n            x: bounds.left + scroll.x,\n            y: bounds.top + scroll.y,\n            width: bounds.width,\n            height: bounds.height\n        };\n    }\n}\n\nexport interface InitializeCanvasBoundsAction extends Action {\n    kind: typeof InitializeCanvasBoundsAction.KIND\n    newCanvasBounds: Bounds\n}\nexport namespace InitializeCanvasBoundsAction {\n    export const KIND = 'initializeCanvasBounds';\n\n    export function create(newCanvasBounds: Bounds): InitializeCanvasBoundsAction {\n        return {\n            kind: KIND,\n            newCanvasBounds\n        };\n    }\n}\n\n@injectable()\nexport class InitializeCanvasBoundsCommand extends SystemCommand {\n    static readonly KIND: string = InitializeCanvasBoundsAction.KIND;\n\n    private newCanvasBounds: Bounds;\n\n    constructor(@inject(TYPES.Action) protected readonly action: InitializeCanvasBoundsAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        this.newCanvasBounds = this.action.newCanvasBounds;\n        context.root.canvasBounds = this.newCanvasBounds;\n        return context.root;\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        return context.root;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from \"inversify\";\nimport { Action, SetModelAction } from \"sprotty-protocol/lib/actions\";\nimport { CommandExecutionContext, ResetCommand } from \"../commands/command\";\nimport { SModelRootImpl } from \"../model/smodel\";\nimport { TYPES } from \"../types\";\nimport { InitializeCanvasBoundsCommand } from './initialize-canvas';\n\n@injectable()\nexport class SetModelCommand extends ResetCommand {\n    static readonly KIND = SetModelAction.KIND;\n\n    oldRoot: SModelRootImpl;\n    newRoot: SModelRootImpl;\n\n    constructor(@inject(TYPES.Action) protected readonly action: SetModelAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): SModelRootImpl {\n        this.oldRoot = context.modelFactory.createRoot(context.root);\n        this.newRoot = context.modelFactory.createRoot(this.action.newRoot);\n        return this.newRoot;\n    }\n\n    undo(context: CommandExecutionContext): SModelRootImpl {\n        return this.oldRoot;\n    }\n\n    redo(context: CommandExecutionContext): SModelRootImpl {\n        return this.newRoot;\n    }\n\n    get blockUntil(): (action: Action) => boolean {\n        return action => action.kind === InitializeCanvasBoundsCommand.KIND;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { interfaces } from \"inversify\";\nimport { Bounds, Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { TYPES } from \"../types\";\nimport { SChildElementImpl, SModelElementImpl, SModelRootImpl, SParentElementImpl } from \"./smodel\";\nimport { SModelElementRegistration, CustomFeatures } from \"./smodel-factory\";\n\n/**\n * Register a model element constructor for an element type.\n */\nexport function registerModelElement(context: { bind: interfaces.Bind, isBound: interfaces.IsBound },\n        type: string, constr: new () => SModelElementImpl, features?: CustomFeatures): void {\n    context.bind<SModelElementRegistration>(TYPES.SModelElementRegistration).toConstantValue({\n        type, constr, features\n    });\n}\n\n/**\n * Find a parent element that satisfies the given predicate.\n */\nexport function findParent(element: SModelElementImpl, predicate: (e: SModelElementImpl) => boolean): SModelElementImpl | undefined {\n    let current: SModelElementImpl | undefined = element;\n    while (current !== undefined) {\n        if (predicate(current))\n            return current;\n        else if (current instanceof SChildElementImpl)\n            current = current.parent;\n        else\n            current = undefined;\n    }\n    return current;\n}\n\n/**\n * Find a parent element that implements the feature identified with the given predicate.\n */\nexport function findParentByFeature<T>(element: SModelElementImpl, predicate: (t: SModelElementImpl) => t is SModelElementImpl & T): SModelElementImpl & T | undefined {\n    let current: SModelElementImpl | undefined = element;\n    while (current !== undefined) {\n        if (predicate(current))\n            return current;\n        else if (current instanceof SChildElementImpl)\n            current = current.parent;\n        else\n            current = undefined;\n    }\n    return current;\n}\n\n/**\n * Translate a point from the coordinate system of the source element to the coordinate system\n * of the target element.\n */\nexport function translatePoint(point: Point, source: SModelElementImpl, target: SModelElementImpl): Point {\n    if (source !== target) {\n        // Translate from the source to the root element\n        while (source instanceof SChildElementImpl) {\n            point = source.localToParent(point);\n            source = source.parent;\n            if (source === target)\n                return point;\n        }\n        // Translate from the root to the target element\n        const targetTrace = [];\n        while (target instanceof SChildElementImpl) {\n            targetTrace.push(target);\n            target = target.parent;\n        }\n        if (source !== target)\n            throw new Error(\"Incompatible source and target: \" + source.id + \", \" + target.id);\n        for (let i = targetTrace.length - 1; i >= 0; i--) {\n            point = targetTrace[i].parentToLocal(point);\n        }\n    }\n    return point;\n}\n\n/**\n * Translate some bounds from the coordinate system of the source element to the coordinate system\n * of the target element.\n */\nexport function translateBounds(bounds: Bounds, source: SModelElementImpl, target: SModelElementImpl): Bounds {\n    const upperLeft = translatePoint(bounds, source, target);\n    const lowerRight = translatePoint({ x: bounds.x + bounds.width, y: bounds.y + bounds.height }, source, target);\n    return {\n        x: upperLeft.x,\n        y: upperLeft.y,\n        width: lowerRight.x - upperLeft.x,\n        height: lowerRight.y - upperLeft.y\n    };\n}\n\n/**\n * Tests if the given model contains an id of then given element or one of its descendants.\n */\nexport function containsSome(root: SModelRootImpl, element: SChildElementImpl): boolean {\n    const test = (el: SChildElementImpl) => root.index.getById(el.id) !== undefined;\n    const find = (elements: readonly SChildElementImpl[]): boolean => elements.some(el => test(el) || find(el.children));\n    return find([element]);\n}\n\n/**\n * Transforms the local bounds all the way up to the root.\n */\nexport function  transformToRootBounds(parent: SParentElementImpl, bounds: Bounds) {\n    while (parent instanceof SChildElementImpl) {\n        bounds = parent.localToParent(bounds);\n        parent = parent.parent;\n    }\n    return bounds;\n}\n", "/********************************************************************************\n * Copyright (c) 2019 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, multiInject, optional } from \"inversify\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { InstanceRegistry } from \"../../utils/registry\";\nimport { CommandExecutionContext, SystemCommand, CommandReturn } from \"../commands/command\";\nimport { TYPES } from \"../types\";\nimport { IUIExtension } from \"./ui-extension\";\n\n/**\n * The registry maintaining UI extensions registered via `TYPES.IUIExtension`.\n */\n@injectable()\nexport class UIExtensionRegistry extends InstanceRegistry<IUIExtension>  {\n    constructor(@multiInject(TYPES.IUIExtension) @optional() extensions: (IUIExtension)[] = []) {\n        super();\n        extensions.forEach((extension) => this.register(extension.id(), extension));\n    }\n}\n\n/**\n * Action to set the visibility state of the UI extension with the specified `id`.\n */\nexport interface SetUIExtensionVisibilityAction extends Action {\n    kind: typeof SetUIExtensionVisibilityAction.KIND;\n    extensionId: string\n    visible: boolean\n    contextElementsId: string[]\n}\nexport namespace SetUIExtensionVisibilityAction {\n    export const KIND = \"setUIExtensionVisibility\";\n\n    export function create(options: { extensionId: string, visible: boolean, contextElementsId?: string[] }): SetUIExtensionVisibilityAction {\n        return {\n            kind: KIND,\n            extensionId: options.extensionId,\n            visible: options.visible,\n            contextElementsId: options.contextElementsId ?? []\n        };\n    }\n}\n\n@injectable()\nexport class SetUIExtensionVisibilityCommand extends SystemCommand {\n    static readonly KIND = SetUIExtensionVisibilityAction.KIND;\n\n    @inject(TYPES.UIExtensionRegistry) protected readonly registry: UIExtensionRegistry;\n\n    constructor(@inject(TYPES.Action) protected readonly action: SetUIExtensionVisibilityAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const extension = this.registry.get(this.action.extensionId);\n        if (extension) {\n            this.action.visible ? extension.show(context.root, ...this.action.contextElementsId) : extension.hide();\n        }\n        return { model: context.root, modelChanged: false };\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        return { model: context.root, modelChanged: false };\n    }\n    redo(context: CommandExecutionContext): CommandReturn {\n        return { model: context.root, modelChanged: false };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from \"inversify\";\nimport { hasOwnProperty } from \"sprotty-protocol\";\nimport { ILogger } from \"../../utils/logging\";\nimport { SModelRootImpl } from \"../model/smodel\";\nimport { TYPES } from \"../types\";\nimport { ViewerOptions } from \"../views/viewer-options\";\n\n/**\n * A UI extension displaying additional UI elements on top of a sprotty diagram.\n */\nexport interface IUIExtension {\n    id(): string;\n    show(root: Readonly<SModelRootImpl>, ...contextElementIds: string[]): void;\n    hide(): void;\n    enableOnStartup?: boolean\n}\n\nexport function isUIExtension(object: unknown): object is IUIExtension {\n    return hasOwnProperty<string, Function>(object, 'id', 'function')\n    && hasOwnProperty<string, Function>(object, 'show', 'function')\n    && hasOwnProperty<string, Function>(object, 'hide', 'function');\n}\n\n/**\n * Abstract base class for UI extensions.\n */\n@injectable()\nexport abstract class AbstractUIExtension implements IUIExtension {\n    @inject(TYPES.ViewerOptions) protected options: ViewerOptions;\n    @inject(TYPES.ILogger) protected logger: ILogger;\n\n    protected containerElement: HTMLElement;\n    protected activeElement: Element | null;\n\n    abstract id(): string;\n    abstract containerClass(): string;\n\n    show(root: Readonly<SModelRootImpl>, ...contextElementIds: string[]): void {\n        this.activeElement = document.activeElement;\n        if (!this.containerElement) {\n            if (!this.initialize()) return;\n        }\n        this.onBeforeShow(this.containerElement, root, ...contextElementIds);\n        this.setContainerVisible(true);\n    }\n\n    hide(): void {\n        this.setContainerVisible(false);\n        this.restoreFocus();\n        this.activeElement = null;\n    }\n\n    protected restoreFocus() {\n        const focusedElement = this.activeElement as HTMLElement;\n        if (focusedElement) {\n            focusedElement.focus();\n        }\n    }\n\n    protected initialize(): boolean {\n        const baseDiv = document.getElementById(this.options.baseDiv);\n        if (!baseDiv) {\n            this.logger.warn(this, `Could not obtain sprotty base container for initializing UI extension ${this.id}`, this);\n            return false;\n        }\n        this.containerElement = this.getOrCreateContainer(baseDiv.id);\n        this.initializeContents(this.containerElement);\n        if (baseDiv) {\n            baseDiv.insertBefore(this.containerElement, baseDiv.firstChild);\n        }\n        return true;\n    }\n\n    protected getOrCreateContainer(baseDivId: string): HTMLElement {\n        let container = document.getElementById(this.id());\n        if (container === null) {\n            container = document.createElement('div');\n            container.id = baseDivId + \"_\" + this.id();\n            container.classList.add(this.containerClass());\n        }\n        return container;\n    }\n\n    protected setContainerVisible(visible: boolean) {\n        if (this.containerElement) {\n            if (visible) {\n                this.containerElement.style.visibility = 'visible';\n                this.containerElement.style.opacity = '1';\n            } else {\n                this.containerElement.style.visibility = 'hidden';\n                this.containerElement.style.opacity = '0';\n            }\n        }\n    }\n\n    /**\n     * Updates the `containerElement` under the given `context` before it becomes visible.\n     *\n     * Subclasses may override this method to, for instance, modifying the position of the\n     * `containerElement`, add or remove elements, etc. depending on the specified `root`\n     * or `contextElementIds`.\n     */\n    protected onBeforeShow(containerElement: HTMLElement, root: Readonly<SModelRootImpl>, ...contextElementIds: string[]): void {\n        // default: do nothing\n    }\n\n    /**\n     * Initializes the contents of this UI extension.\n     *\n     * Subclasses must implement this method to initialize the UI elements of this UI extension inside the specified `containerElement`.\n     */\n    protected abstract initializeContents(containerElement: HTMLElement): void;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { VNode } from \"snabbdom\";\n\nexport function setAttr(vnode: VNode, name: string, value: any) {\n    getAttrs(vnode)[name] = value;\n}\n\nexport function setClass(vnode: VNode, name: string, value: boolean) {\n    getClass(vnode)[name] = value;\n}\n\nexport function setNamespace(node: VNode, ns: string) {\n    if (node.data === undefined)\n        node.data = {};\n    node.data.ns = ns;\n    const children = node.children;\n    if (children !== undefined) {\n        for (let i = 0; i < children.length; i++) {\n            const child = children[i];\n            if (typeof child !== 'string')\n                setNamespace(child, ns);\n        }\n    }\n}\n\nexport function copyClassesFromVNode(source: VNode, target: VNode) {\n    const classList = getClass(source);\n    Object.keys(classList).forEach(c => setClass(target, c, true));\n}\n\nexport function copyClassesFromElement(element: HTMLElement, target: VNode) {\n    const classList = element.classList;\n    for (let i = 0; i < classList.length; i++) {\n        const item = classList.item(i);\n        if (item)\n            setClass(target, item, true);\n    }\n}\n\nexport function mergeStyle(vnode: VNode, style: any) {\n    getData(vnode).style = {...(getData(vnode).style || {}), ...style};\n}\n\nexport function on(vnode: VNode, event: string, listener: (event: Event) => void) {\n    const val = getOn(vnode);\n    if (val[event]) {\n        throw new Error('EventListener for ' + event + ' already registered on VNode');\n    }\n    (val as any)[event] = listener;\n}\n\nexport function getAttrs(vnode: VNode) {\n    const data = getData(vnode);\n    if (!data.attrs)\n        data.attrs = {};\n    return data.attrs;\n}\n\nfunction getData(vnode: VNode) {\n    if (!vnode.data)\n        vnode.data = {};\n    return vnode.data;\n}\n\nfunction getClass(vnode: VNode) {\n    const data = getData(vnode);\n    if (!data.class)\n        data.class = {};\n    return data.class;\n}\n\nfunction getOn(vnode: VNode) {\n    const data = getData(vnode);\n    if (!data.on)\n        data.on = {};\n    return data.on;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, multiInject, optional } from \"inversify\";\nimport { VNode } from \"snabbdom\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { TYPES } from \"../types\";\nimport { IActionDispatcher } from \"../actions/action-dispatcher\";\nimport { SModelElementImpl, SModelRootImpl } from \"../model/smodel\";\nimport { IVNodePostprocessor } from \"./vnode-postprocessor\";\nimport { on } from \"./vnode-utils\";\n\n@injectable()\nexport class KeyTool implements IVNodePostprocessor {\n\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: IActionDispatcher;\n\n    constructor(@multiInject(TYPES.KeyListener)@optional() protected keyListeners: KeyListener[] = []) {}\n\n    register(keyListener: KeyListener) {\n        this.keyListeners.push(keyListener);\n    }\n\n    deregister(keyListener: KeyListener) {\n        const index = this.keyListeners.indexOf(keyListener);\n        if (index >= 0)\n            this.keyListeners.splice(index, 1);\n    }\n\n    protected handleEvent<K extends keyof KeyListener>(methodName: K, model: SModelRootImpl, event: KeyboardEvent) {\n        const actions = this.keyListeners\n            .map(listener => listener[methodName].apply(listener, [model, event]))\n            .reduce((a, b) => a.concat(b));\n        if (actions.length > 0) {\n            event.preventDefault();\n            this.actionDispatcher.dispatchAll(actions);\n        }\n    }\n\n    keyDown(element: SModelRootImpl, event: KeyboardEvent): void {\n        this.handleEvent('keyDown', element, event);\n    }\n\n    keyUp(element: SModelRootImpl, event: KeyboardEvent): void {\n        this.handleEvent('keyUp', element, event);\n    }\n\n    focus() {}\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        if (element instanceof SModelRootImpl) {\n            on(vnode, 'focus', this.focus.bind(this, element));\n            on(vnode, 'keydown', this.keyDown.bind(this, element));\n            on(vnode, 'keyup', this.keyUp.bind(this, element));\n        }\n        return vnode;\n    }\n\n    postUpdate() {\n    }\n}\n\n@injectable()\nexport class KeyListener {\n    keyDown(element: SModelElementImpl, event: KeyboardEvent): Action[] {\n        return [];\n    }\n\n    keyUp(element: SModelElementImpl, event: KeyboardEvent): Action[] {\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from \"inversify\";\nimport { ViewerOptions } from \"./viewer-options\";\nimport { TYPES } from \"../types\";\nimport { SModelElementImpl } from \"../model/smodel\";\n\n@injectable()\nexport class DOMHelper {\n\n    @inject(TYPES.ViewerOptions) private viewerOptions: ViewerOptions;\n\n    private getPrefix() {\n        const prefix = this.viewerOptions !== undefined && this.viewerOptions.baseDiv !== undefined ?\n            this.viewerOptions.baseDiv + \"_\" : \"\";\n        return prefix;\n    }\n\n    createUniqueDOMElementId(element: SModelElementImpl): string {\n        return this.getPrefix() + element.id;\n    }\n\n    findSModelIdByDOMElement(element: Element): string {\n        return element.id.replace(this.getPrefix(), '');\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, multiInject, optional } from \"inversify\";\nimport { VNode } from \"snabbdom\";\nimport { Action, isAction } from \"sprotty-protocol/lib/actions\";\nimport { Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { IActionDispatcher } from \"../actions/action-dispatcher\";\nimport { SModelElementImpl, SModelRootImpl } from \"../model/smodel\";\nimport { TYPES } from \"../types\";\nimport { DOMHelper } from \"./dom-helper\";\nimport { IVNodePostprocessor } from \"./vnode-postprocessor\";\nimport { on } from \"./vnode-utils\";\n\n@injectable()\nexport class MouseTool implements IVNodePostprocessor {\n\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: IActionDispatcher;\n    @inject(TYPES.DOMHelper) protected domHelper: DOMHelper;\n\n    constructor(@multiInject(TYPES.MouseListener) @optional() protected mouseListeners: MouseListener[] = []) { }\n\n    register(mouseListener: MouseListener) {\n        this.mouseListeners.push(mouseListener);\n    }\n\n    deregister(mouseListener: MouseListener) {\n        const index = this.mouseListeners.indexOf(mouseListener);\n        if (index >= 0)\n            this.mouseListeners.splice(index, 1);\n    }\n\n    protected getTargetElement(model: SModelRootImpl, event: MouseEvent): SModelElementImpl | undefined {\n        let target = event.target as Element;\n        const index = model.index;\n        while (target) {\n            if (target.id) {\n                const element = index.getById(this.domHelper.findSModelIdByDOMElement(target));\n                if (element !== undefined)\n                    return element;\n            }\n            target = target.parentNode as Element;\n        }\n        return undefined;\n    }\n\n    protected handleEvent(methodName: MouseEventKind, model: SModelRootImpl, event: MouseEvent) {\n        this.focusOnMouseEvent(methodName, model);\n        const element = this.getTargetElement(model, event);\n        if (!element)\n            return;\n        const actions = this.mouseListeners\n            .map(listener => listener[methodName](element, event as WheelEvent))\n            .reduce((a, b) => a.concat(b));\n        if (actions.length > 0) {\n            event.preventDefault();\n            for (const actionOrPromise of actions) {\n                if (isAction(actionOrPromise)) {\n                    this.actionDispatcher.dispatch(actionOrPromise);\n                } else {\n                    actionOrPromise.then((action: Action) => {\n                        this.actionDispatcher.dispatch(action);\n                    });\n                }\n            }\n        }\n    }\n\n    protected focusOnMouseEvent<K extends keyof MouseListener>(methodName: K, model: SModelRootImpl) {\n        if (document && methodName === 'mouseDown') {\n            const domElement = document.getElementById(this.domHelper.createUniqueDOMElementId(model));\n            if (domElement !== null && typeof domElement.focus === 'function')\n                domElement.focus();\n        }\n    }\n\n    mouseOver(model: SModelRootImpl, event: MouseEvent) {\n        this.handleEvent('mouseOver', model, event);\n    }\n\n    mouseOut(model: SModelRootImpl, event: MouseEvent) {\n        this.handleEvent('mouseOut', model, event);\n    }\n\n    mouseEnter(model: SModelRootImpl, event: MouseEvent) {\n        this.handleEvent('mouseEnter', model, event);\n    }\n\n    mouseLeave(model: SModelRootImpl, event: MouseEvent) {\n        this.handleEvent('mouseLeave', model, event);\n    }\n\n    mouseDown(model: SModelRootImpl, event: MouseEvent) {\n        this.handleEvent('mouseDown', model, event);\n    }\n\n    mouseMove(model: SModelRootImpl, event: MouseEvent) {\n        this.handleEvent('mouseMove', model, event);\n    }\n\n    mouseUp(model: SModelRootImpl, event: MouseEvent) {\n        this.handleEvent('mouseUp', model, event);\n    }\n\n    wheel(model: SModelRootImpl, event: WheelEvent) {\n        this.handleEvent('wheel', model, event);\n    }\n\n    contextMenu(model: SModelRootImpl, event: MouseEvent) {\n        event.preventDefault();\n        this.handleEvent('contextMenu', model, event);\n    }\n\n    doubleClick(model: SModelRootImpl, event: MouseEvent) {\n        this.handleEvent('doubleClick', model, event);\n    }\n\n    decorate(vnode: VNode, element: SModelElementImpl) {\n        if (element instanceof SModelRootImpl) {\n            on(vnode, 'mouseover', this.mouseOver.bind(this, element));\n            on(vnode, 'mouseout', this.mouseOut.bind(this, element));\n            on(vnode, 'mouseenter', this.mouseEnter.bind(this, element));\n            on(vnode, 'mouseleave', this.mouseLeave.bind(this, element));\n            on(vnode, 'mousedown', this.mouseDown.bind(this, element));\n            on(vnode, 'mouseup', this.mouseUp.bind(this, element));\n            on(vnode, 'mousemove', this.mouseMove.bind(this, element));\n            on(vnode, 'wheel', this.wheel.bind(this, element));\n            on(vnode, 'contextmenu', this.contextMenu.bind(this, element));\n            on(vnode, 'dblclick', this.doubleClick.bind(this, element));\n            on(vnode, 'dragover', (event: MouseEvent) => this.handleEvent('dragOver', element, event));\n            on(vnode, 'drop', (event: MouseEvent) => this.handleEvent('drop', element, event));\n        }\n        vnode = this.mouseListeners.reduce(\n            (n: VNode, listener: MouseListener) => listener.decorate(n, element),\n            vnode);\n        return vnode;\n    }\n\n    postUpdate() {\n    }\n}\n\n@injectable()\nexport class PopupMouseTool extends MouseTool {\n    constructor(@multiInject(TYPES.PopupMouseListener) @optional() protected override mouseListeners: MouseListener[] = []) {\n        super(mouseListeners);\n    }\n}\n\nexport type MouseEventKind =\n    'mouseOver' | 'mouseOut' | 'mouseEnter' | 'mouseLeave' | 'mouseDown' | 'mouseMove' | 'mouseUp'\n    | 'wheel' | 'doubleClick' | 'contextMenu' | 'dragOver' | 'drop';\n\n@injectable()\nexport class MouseListener {\n\n    mouseOver(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    mouseOut(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    mouseEnter(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    mouseLeave(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    mouseDown(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    mouseMove(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    mouseUp(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    wheel(target: SModelElementImpl, event: WheelEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    doubleClick(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    contextMenu(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    dragOver(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    drop(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        return vnode;\n    }\n}\n\n@injectable()\nexport class MousePositionTracker extends MouseListener {\n\n    protected lastPosition: Point | undefined;\n\n    override mouseMove(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        this.lastPosition = target.root.parentToLocal({ x: event.offsetX, y: event.offsetY });\n        return [];\n    }\n\n    /**\n     * Returns the last tracked mouse cursor position relative to the diagram root or `undefined`\n     * if no mouse cursor position was ever tracked yet.\n     */\n    get lastPositionOnDiagram(): Point | undefined {\n        return this.lastPosition;\n    }\n}\n", "'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nfunction createElement(tagName, options) {\n    return document.createElement(tagName, options);\n}\nfunction createElementNS(namespaceURI, qualifiedName, options) {\n    return document.createElementNS(namespaceURI, qualifiedName, options);\n}\nfunction createDocumentFragment() {\n    return parseFragment(document.createDocumentFragment());\n}\nfunction createTextNode(text) {\n    return document.createTextNode(text);\n}\nfunction createComment(text) {\n    return document.createComment(text);\n}\nfunction insertBefore(parentNode, newNode, referenceNode) {\n    if (isDocumentFragment$1(parentNode)) {\n        let node = parentNode;\n        while (node && isDocumentFragment$1(node)) {\n            const fragment = parseFragment(node);\n            node = fragment.parent;\n        }\n        parentNode = node !== null && node !== void 0 ? node : parentNode;\n    }\n    if (isDocumentFragment$1(newNode)) {\n        newNode = parseFragment(newNode, parentNode);\n    }\n    if (referenceNode && isDocumentFragment$1(referenceNode)) {\n        referenceNode = parseFragment(referenceNode).firstChildNode;\n    }\n    parentNode.insertBefore(newNode, referenceNode);\n}\nfunction removeChild(node, child) {\n    node.removeChild(child);\n}\nfunction appendChild(node, child) {\n    if (isDocumentFragment$1(child)) {\n        child = parseFragment(child, node);\n    }\n    node.appendChild(child);\n}\nfunction parentNode(node) {\n    if (isDocumentFragment$1(node)) {\n        while (node && isDocumentFragment$1(node)) {\n            const fragment = parseFragment(node);\n            node = fragment.parent;\n        }\n        return node !== null && node !== void 0 ? node : null;\n    }\n    return node.parentNode;\n}\nfunction nextSibling(node) {\n    var _a;\n    if (isDocumentFragment$1(node)) {\n        const fragment = parseFragment(node);\n        const parent = parentNode(fragment);\n        if (parent && fragment.lastChildNode) {\n            const children = Array.from(parent.childNodes);\n            const index = children.indexOf(fragment.lastChildNode);\n            return (_a = children[index + 1]) !== null && _a !== void 0 ? _a : null;\n        }\n        return null;\n    }\n    return node.nextSibling;\n}\nfunction tagName(elm) {\n    return elm.tagName;\n}\nfunction setTextContent(node, text) {\n    node.textContent = text;\n}\nfunction getTextContent(node) {\n    return node.textContent;\n}\nfunction isElement$1(node) {\n    return node.nodeType === 1;\n}\nfunction isText(node) {\n    return node.nodeType === 3;\n}\nfunction isComment(node) {\n    return node.nodeType === 8;\n}\nfunction isDocumentFragment$1(node) {\n    return node.nodeType === 11;\n}\nfunction parseFragment(fragmentNode, parentNode) {\n    var _a, _b, _c;\n    const fragment = fragmentNode;\n    (_a = fragment.parent) !== null && _a !== void 0 ? _a : (fragment.parent = parentNode !== null && parentNode !== void 0 ? parentNode : null);\n    (_b = fragment.firstChildNode) !== null && _b !== void 0 ? _b : (fragment.firstChildNode = fragmentNode.firstChild);\n    (_c = fragment.lastChildNode) !== null && _c !== void 0 ? _c : (fragment.lastChildNode = fragmentNode.lastChild);\n    return fragment;\n}\nconst htmlDomApi = {\n    createElement,\n    createElementNS,\n    createTextNode,\n    createDocumentFragment,\n    createComment,\n    insertBefore,\n    removeChild,\n    appendChild,\n    parentNode,\n    nextSibling,\n    tagName,\n    setTextContent,\n    getTextContent,\n    isElement: isElement$1,\n    isText,\n    isComment,\n    isDocumentFragment: isDocumentFragment$1,\n};\n\nfunction vnode(sel, data, children, text, elm) {\n    const key = data === undefined ? undefined : data.key;\n    return { sel, data, children, text, elm, key };\n}\n\nconst array = Array.isArray;\nfunction primitive(s) {\n    return (typeof s === \"string\" ||\n        typeof s === \"number\" ||\n        s instanceof String ||\n        s instanceof Number);\n}\n\nfunction isUndef(s) {\n    return s === undefined;\n}\nfunction isDef(s) {\n    return s !== undefined;\n}\nconst emptyNode = vnode(\"\", {}, [], undefined, undefined);\nfunction sameVnode(vnode1, vnode2) {\n    var _a, _b;\n    const isSameKey = vnode1.key === vnode2.key;\n    const isSameIs = ((_a = vnode1.data) === null || _a === void 0 ? void 0 : _a.is) === ((_b = vnode2.data) === null || _b === void 0 ? void 0 : _b.is);\n    const isSameSel = vnode1.sel === vnode2.sel;\n    const isSameTextOrFragment = !vnode1.sel && vnode1.sel === vnode2.sel\n        ? typeof vnode1.text === typeof vnode2.text\n        : true;\n    return isSameSel && isSameKey && isSameIs && isSameTextOrFragment;\n}\n/**\n * @todo Remove this function when the document fragment is considered stable.\n */\nfunction documentFragmentIsNotSupported() {\n    throw new Error(\"The document fragment is not supported on this platform.\");\n}\nfunction isElement(api, vnode) {\n    return api.isElement(vnode);\n}\nfunction isDocumentFragment(api, vnode) {\n    return api.isDocumentFragment(vnode);\n}\nfunction createKeyToOldIdx(children, beginIdx, endIdx) {\n    var _a;\n    const map = {};\n    for (let i = beginIdx; i <= endIdx; ++i) {\n        const key = (_a = children[i]) === null || _a === void 0 ? void 0 : _a.key;\n        if (key !== undefined) {\n            map[key] = i;\n        }\n    }\n    return map;\n}\nconst hooks = [\n    \"create\",\n    \"update\",\n    \"remove\",\n    \"destroy\",\n    \"pre\",\n    \"post\",\n];\nfunction init$1(modules, domApi, options) {\n    const cbs = {\n        create: [],\n        update: [],\n        remove: [],\n        destroy: [],\n        pre: [],\n        post: [],\n    };\n    const api = domApi !== undefined ? domApi : htmlDomApi;\n    for (const hook of hooks) {\n        for (const module of modules) {\n            const currentHook = module[hook];\n            if (currentHook !== undefined) {\n                cbs[hook].push(currentHook);\n            }\n        }\n    }\n    function emptyNodeAt(elm) {\n        const id = elm.id ? \"#\" + elm.id : \"\";\n        // elm.className doesn't return a string when elm is an SVG element inside a shadowRoot.\n        // https://stackoverflow.com/questions/29454340/detecting-classname-of-svganimatedstring\n        const classes = elm.getAttribute(\"class\");\n        const c = classes ? \".\" + classes.split(\" \").join(\".\") : \"\";\n        return vnode(api.tagName(elm).toLowerCase() + id + c, {}, [], undefined, elm);\n    }\n    function emptyDocumentFragmentAt(frag) {\n        return vnode(undefined, {}, [], undefined, frag);\n    }\n    function createRmCb(childElm, listeners) {\n        return function rmCb() {\n            if (--listeners === 0) {\n                const parent = api.parentNode(childElm);\n                api.removeChild(parent, childElm);\n            }\n        };\n    }\n    function createElm(vnode, insertedVnodeQueue) {\n        var _a, _b, _c, _d;\n        let i;\n        let data = vnode.data;\n        if (data !== undefined) {\n            const init = (_a = data.hook) === null || _a === void 0 ? void 0 : _a.init;\n            if (isDef(init)) {\n                init(vnode);\n                data = vnode.data;\n            }\n        }\n        const children = vnode.children;\n        const sel = vnode.sel;\n        if (sel === \"!\") {\n            if (isUndef(vnode.text)) {\n                vnode.text = \"\";\n            }\n            vnode.elm = api.createComment(vnode.text);\n        }\n        else if (sel !== undefined) {\n            // Parse selector\n            const hashIdx = sel.indexOf(\"#\");\n            const dotIdx = sel.indexOf(\".\", hashIdx);\n            const hash = hashIdx > 0 ? hashIdx : sel.length;\n            const dot = dotIdx > 0 ? dotIdx : sel.length;\n            const tag = hashIdx !== -1 || dotIdx !== -1\n                ? sel.slice(0, Math.min(hash, dot))\n                : sel;\n            const elm = (vnode.elm =\n                isDef(data) && isDef((i = data.ns))\n                    ? api.createElementNS(i, tag, data)\n                    : api.createElement(tag, data));\n            if (hash < dot)\n                elm.setAttribute(\"id\", sel.slice(hash + 1, dot));\n            if (dotIdx > 0)\n                elm.setAttribute(\"class\", sel.slice(dot + 1).replace(/\\./g, \" \"));\n            for (i = 0; i < cbs.create.length; ++i)\n                cbs.create[i](emptyNode, vnode);\n            if (array(children)) {\n                for (i = 0; i < children.length; ++i) {\n                    const ch = children[i];\n                    if (ch != null) {\n                        api.appendChild(elm, createElm(ch, insertedVnodeQueue));\n                    }\n                }\n            }\n            else if (primitive(vnode.text)) {\n                api.appendChild(elm, api.createTextNode(vnode.text));\n            }\n            const hook = vnode.data.hook;\n            if (isDef(hook)) {\n                (_b = hook.create) === null || _b === void 0 ? void 0 : _b.call(hook, emptyNode, vnode);\n                if (hook.insert) {\n                    insertedVnodeQueue.push(vnode);\n                }\n            }\n        }\n        else if (((_c = options === null || options === void 0 ? void 0 : options.experimental) === null || _c === void 0 ? void 0 : _c.fragments) && vnode.children) {\n            vnode.elm = ((_d = api.createDocumentFragment) !== null && _d !== void 0 ? _d : documentFragmentIsNotSupported)();\n            for (i = 0; i < cbs.create.length; ++i)\n                cbs.create[i](emptyNode, vnode);\n            for (i = 0; i < vnode.children.length; ++i) {\n                const ch = vnode.children[i];\n                if (ch != null) {\n                    api.appendChild(vnode.elm, createElm(ch, insertedVnodeQueue));\n                }\n            }\n        }\n        else {\n            vnode.elm = api.createTextNode(vnode.text);\n        }\n        return vnode.elm;\n    }\n    function addVnodes(parentElm, before, vnodes, startIdx, endIdx, insertedVnodeQueue) {\n        for (; startIdx <= endIdx; ++startIdx) {\n            const ch = vnodes[startIdx];\n            if (ch != null) {\n                api.insertBefore(parentElm, createElm(ch, insertedVnodeQueue), before);\n            }\n        }\n    }\n    function invokeDestroyHook(vnode) {\n        var _a, _b;\n        const data = vnode.data;\n        if (data !== undefined) {\n            (_b = (_a = data === null || data === void 0 ? void 0 : data.hook) === null || _a === void 0 ? void 0 : _a.destroy) === null || _b === void 0 ? void 0 : _b.call(_a, vnode);\n            for (let i = 0; i < cbs.destroy.length; ++i)\n                cbs.destroy[i](vnode);\n            if (vnode.children !== undefined) {\n                for (let j = 0; j < vnode.children.length; ++j) {\n                    const child = vnode.children[j];\n                    if (child != null && typeof child !== \"string\") {\n                        invokeDestroyHook(child);\n                    }\n                }\n            }\n        }\n    }\n    function removeVnodes(parentElm, vnodes, startIdx, endIdx) {\n        var _a, _b;\n        for (; startIdx <= endIdx; ++startIdx) {\n            let listeners;\n            let rm;\n            const ch = vnodes[startIdx];\n            if (ch != null) {\n                if (isDef(ch.sel)) {\n                    invokeDestroyHook(ch);\n                    listeners = cbs.remove.length + 1;\n                    rm = createRmCb(ch.elm, listeners);\n                    for (let i = 0; i < cbs.remove.length; ++i)\n                        cbs.remove[i](ch, rm);\n                    const removeHook = (_b = (_a = ch === null || ch === void 0 ? void 0 : ch.data) === null || _a === void 0 ? void 0 : _a.hook) === null || _b === void 0 ? void 0 : _b.remove;\n                    if (isDef(removeHook)) {\n                        removeHook(ch, rm);\n                    }\n                    else {\n                        rm();\n                    }\n                }\n                else if (ch.children) {\n                    // Fragment node\n                    invokeDestroyHook(ch);\n                    removeVnodes(parentElm, ch.children, 0, ch.children.length - 1);\n                }\n                else {\n                    // Text node\n                    api.removeChild(parentElm, ch.elm);\n                }\n            }\n        }\n    }\n    function updateChildren(parentElm, oldCh, newCh, insertedVnodeQueue) {\n        let oldStartIdx = 0;\n        let newStartIdx = 0;\n        let oldEndIdx = oldCh.length - 1;\n        let oldStartVnode = oldCh[0];\n        let oldEndVnode = oldCh[oldEndIdx];\n        let newEndIdx = newCh.length - 1;\n        let newStartVnode = newCh[0];\n        let newEndVnode = newCh[newEndIdx];\n        let oldKeyToIdx;\n        let idxInOld;\n        let elmToMove;\n        let before;\n        while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\n            if (oldStartVnode == null) {\n                oldStartVnode = oldCh[++oldStartIdx]; // Vnode might have been moved left\n            }\n            else if (oldEndVnode == null) {\n                oldEndVnode = oldCh[--oldEndIdx];\n            }\n            else if (newStartVnode == null) {\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else if (newEndVnode == null) {\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldStartVnode, newStartVnode)) {\n                patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue);\n                oldStartVnode = oldCh[++oldStartIdx];\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else if (sameVnode(oldEndVnode, newEndVnode)) {\n                patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue);\n                oldEndVnode = oldCh[--oldEndIdx];\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldStartVnode, newEndVnode)) {\n                // Vnode moved right\n                patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue);\n                api.insertBefore(parentElm, oldStartVnode.elm, api.nextSibling(oldEndVnode.elm));\n                oldStartVnode = oldCh[++oldStartIdx];\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldEndVnode, newStartVnode)) {\n                // Vnode moved left\n                patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue);\n                api.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm);\n                oldEndVnode = oldCh[--oldEndIdx];\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else {\n                if (oldKeyToIdx === undefined) {\n                    oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx);\n                }\n                idxInOld = oldKeyToIdx[newStartVnode.key];\n                if (isUndef(idxInOld)) {\n                    // New element\n                    api.insertBefore(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);\n                }\n                else {\n                    elmToMove = oldCh[idxInOld];\n                    if (elmToMove.sel !== newStartVnode.sel) {\n                        api.insertBefore(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);\n                    }\n                    else {\n                        patchVnode(elmToMove, newStartVnode, insertedVnodeQueue);\n                        oldCh[idxInOld] = undefined;\n                        api.insertBefore(parentElm, elmToMove.elm, oldStartVnode.elm);\n                    }\n                }\n                newStartVnode = newCh[++newStartIdx];\n            }\n        }\n        if (newStartIdx <= newEndIdx) {\n            before = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].elm;\n            addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx, insertedVnodeQueue);\n        }\n        if (oldStartIdx <= oldEndIdx) {\n            removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx);\n        }\n    }\n    function patchVnode(oldVnode, vnode, insertedVnodeQueue) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        const hook = (_a = vnode.data) === null || _a === void 0 ? void 0 : _a.hook;\n        (_b = hook === null || hook === void 0 ? void 0 : hook.prepatch) === null || _b === void 0 ? void 0 : _b.call(hook, oldVnode, vnode);\n        const elm = (vnode.elm = oldVnode.elm);\n        if (oldVnode === vnode)\n            return;\n        if (vnode.data !== undefined ||\n            (isDef(vnode.text) && vnode.text !== oldVnode.text)) {\n            (_c = vnode.data) !== null && _c !== void 0 ? _c : (vnode.data = {});\n            (_d = oldVnode.data) !== null && _d !== void 0 ? _d : (oldVnode.data = {});\n            for (let i = 0; i < cbs.update.length; ++i)\n                cbs.update[i](oldVnode, vnode);\n            (_g = (_f = (_e = vnode.data) === null || _e === void 0 ? void 0 : _e.hook) === null || _f === void 0 ? void 0 : _f.update) === null || _g === void 0 ? void 0 : _g.call(_f, oldVnode, vnode);\n        }\n        const oldCh = oldVnode.children;\n        const ch = vnode.children;\n        if (isUndef(vnode.text)) {\n            if (isDef(oldCh) && isDef(ch)) {\n                if (oldCh !== ch)\n                    updateChildren(elm, oldCh, ch, insertedVnodeQueue);\n            }\n            else if (isDef(ch)) {\n                if (isDef(oldVnode.text))\n                    api.setTextContent(elm, \"\");\n                addVnodes(elm, null, ch, 0, ch.length - 1, insertedVnodeQueue);\n            }\n            else if (isDef(oldCh)) {\n                removeVnodes(elm, oldCh, 0, oldCh.length - 1);\n            }\n            else if (isDef(oldVnode.text)) {\n                api.setTextContent(elm, \"\");\n            }\n        }\n        else if (oldVnode.text !== vnode.text) {\n            if (isDef(oldCh)) {\n                removeVnodes(elm, oldCh, 0, oldCh.length - 1);\n            }\n            api.setTextContent(elm, vnode.text);\n        }\n        (_h = hook === null || hook === void 0 ? void 0 : hook.postpatch) === null || _h === void 0 ? void 0 : _h.call(hook, oldVnode, vnode);\n    }\n    return function patch(oldVnode, vnode) {\n        let i, elm, parent;\n        const insertedVnodeQueue = [];\n        for (i = 0; i < cbs.pre.length; ++i)\n            cbs.pre[i]();\n        if (isElement(api, oldVnode)) {\n            oldVnode = emptyNodeAt(oldVnode);\n        }\n        else if (isDocumentFragment(api, oldVnode)) {\n            oldVnode = emptyDocumentFragmentAt(oldVnode);\n        }\n        if (sameVnode(oldVnode, vnode)) {\n            patchVnode(oldVnode, vnode, insertedVnodeQueue);\n        }\n        else {\n            elm = oldVnode.elm;\n            parent = api.parentNode(elm);\n            createElm(vnode, insertedVnodeQueue);\n            if (parent !== null) {\n                api.insertBefore(parent, vnode.elm, api.nextSibling(elm));\n                removeVnodes(parent, [oldVnode], 0, 0);\n            }\n        }\n        for (i = 0; i < insertedVnodeQueue.length; ++i) {\n            insertedVnodeQueue[i].data.hook.insert(insertedVnodeQueue[i]);\n        }\n        for (i = 0; i < cbs.post.length; ++i)\n            cbs.post[i]();\n        return vnode;\n    };\n}\n\nfunction addNS(data, children, sel) {\n    data.ns = \"http://www.w3.org/2000/svg\";\n    if (sel !== \"foreignObject\" && children !== undefined) {\n        for (let i = 0; i < children.length; ++i) {\n            const child = children[i];\n            if (typeof child === \"string\")\n                continue;\n            const childData = child.data;\n            if (childData !== undefined) {\n                addNS(childData, child.children, child.sel);\n            }\n        }\n    }\n}\nfunction h(sel, b, c) {\n    let data = {};\n    let children;\n    let text;\n    let i;\n    if (c !== undefined) {\n        if (b !== null) {\n            data = b;\n        }\n        if (array(c)) {\n            children = c;\n        }\n        else if (primitive(c)) {\n            text = c.toString();\n        }\n        else if (c && c.sel) {\n            children = [c];\n        }\n    }\n    else if (b !== undefined && b !== null) {\n        if (array(b)) {\n            children = b;\n        }\n        else if (primitive(b)) {\n            text = b.toString();\n        }\n        else if (b && b.sel) {\n            children = [b];\n        }\n        else {\n            data = b;\n        }\n    }\n    if (children !== undefined) {\n        for (i = 0; i < children.length; ++i) {\n            if (primitive(children[i]))\n                children[i] = vnode(undefined, undefined, undefined, children[i], undefined);\n        }\n    }\n    if (sel[0] === \"s\" &&\n        sel[1] === \"v\" &&\n        sel[2] === \"g\" &&\n        (sel.length === 3 || sel[3] === \".\" || sel[3] === \"#\")) {\n        addNS(data, children, sel);\n    }\n    return vnode(sel, data, children, text, undefined);\n}\n/**\n * @experimental\n */\nfunction fragment(children) {\n    let c;\n    let text;\n    if (array(children)) {\n        c = children;\n    }\n    else if (primitive(c)) {\n        text = children;\n    }\n    else if (c && c.sel) {\n        c = [children];\n    }\n    if (c !== undefined) {\n        for (let i = 0; i < c.length; ++i) {\n            if (primitive(c[i]))\n                c[i] = vnode(undefined, undefined, undefined, c[i], undefined);\n        }\n    }\n    return vnode(undefined, {}, c, text, undefined);\n}\n\nfunction copyToThunk(vnode, thunk) {\n    var _a;\n    const ns = (_a = thunk.data) === null || _a === void 0 ? void 0 : _a.ns;\n    vnode.data.fn = thunk.data.fn;\n    vnode.data.args = thunk.data.args;\n    thunk.data = vnode.data;\n    thunk.children = vnode.children;\n    thunk.text = vnode.text;\n    thunk.elm = vnode.elm;\n    if (ns)\n        addNS(thunk.data, thunk.children, thunk.sel);\n}\nfunction init(thunk) {\n    const cur = thunk.data;\n    const vnode = cur.fn(...cur.args);\n    copyToThunk(vnode, thunk);\n}\nfunction prepatch(oldVnode, thunk) {\n    let i;\n    const old = oldVnode.data;\n    const cur = thunk.data;\n    const oldArgs = old.args;\n    const args = cur.args;\n    if (old.fn !== cur.fn || oldArgs.length !== args.length) {\n        copyToThunk(cur.fn(...args), thunk);\n        return;\n    }\n    for (i = 0; i < args.length; ++i) {\n        if (oldArgs[i] !== args[i]) {\n            copyToThunk(cur.fn(...args), thunk);\n            return;\n        }\n    }\n    copyToThunk(oldVnode, thunk);\n}\nconst thunk = function thunk(sel, key, fn, args) {\n    if (args === undefined) {\n        args = fn;\n        fn = key;\n        key = undefined;\n    }\n    return h(sel, {\n        key: key,\n        hook: { init, prepatch },\n        fn: fn,\n        args: args,\n    });\n};\n\nfunction pre(vnode, newVnode) {\n    const attachData = vnode.data.attachData;\n    // Copy created placeholder and real element from old vnode\n    newVnode.data.attachData.placeholder = attachData.placeholder;\n    newVnode.data.attachData.real = attachData.real;\n    // Mount real element in vnode so the patch process operates on it\n    vnode.elm = vnode.data.attachData.real;\n}\nfunction post(_, vnode) {\n    // Mount dummy placeholder in vnode so potential reorders use it\n    vnode.elm = vnode.data.attachData.placeholder;\n}\nfunction destroy(vnode) {\n    // Remove placeholder\n    if (vnode.elm !== undefined) {\n        vnode.elm.parentNode.removeChild(vnode.elm);\n    }\n    // Remove real element from where it was inserted\n    vnode.elm = vnode.data.attachData.real;\n}\nfunction create(_, vnode) {\n    const real = vnode.elm;\n    const attachData = vnode.data.attachData;\n    const placeholder = document.createElement(\"span\");\n    // Replace actual element with dummy placeholder\n    // Snabbdom will then insert placeholder instead\n    vnode.elm = placeholder;\n    attachData.target.appendChild(real);\n    attachData.real = real;\n    attachData.placeholder = placeholder;\n}\nfunction attachTo(target, vnode) {\n    if (vnode.data === undefined)\n        vnode.data = {};\n    if (vnode.data.hook === undefined)\n        vnode.data.hook = {};\n    const data = vnode.data;\n    const hook = vnode.data.hook;\n    data.attachData = { target: target, placeholder: undefined, real: undefined };\n    hook.create = create;\n    hook.prepatch = pre;\n    hook.postpatch = post;\n    hook.destroy = destroy;\n    return vnode;\n}\n\nfunction toVNode(node, domApi) {\n    const api = domApi !== undefined ? domApi : htmlDomApi;\n    let text;\n    if (api.isElement(node)) {\n        const id = node.id ? \"#\" + node.id : \"\";\n        const cn = node.getAttribute(\"class\");\n        const c = cn ? \".\" + cn.split(\" \").join(\".\") : \"\";\n        const sel = api.tagName(node).toLowerCase() + id + c;\n        const attrs = {};\n        const dataset = {};\n        const data = {};\n        const children = [];\n        let name;\n        let i, n;\n        const elmAttrs = node.attributes;\n        const elmChildren = node.childNodes;\n        for (i = 0, n = elmAttrs.length; i < n; i++) {\n            name = elmAttrs[i].nodeName;\n            if (name[0] === \"d\" &&\n                name[1] === \"a\" &&\n                name[2] === \"t\" &&\n                name[3] === \"a\" &&\n                name[4] === \"-\") {\n                dataset[name.slice(5)] = elmAttrs[i].nodeValue || \"\";\n            }\n            else if (name !== \"id\" && name !== \"class\") {\n                attrs[name] = elmAttrs[i].nodeValue;\n            }\n        }\n        for (i = 0, n = elmChildren.length; i < n; i++) {\n            children.push(toVNode(elmChildren[i], domApi));\n        }\n        if (Object.keys(attrs).length > 0)\n            data.attrs = attrs;\n        if (Object.keys(dataset).length > 0)\n            data.dataset = dataset;\n        if (sel[0] === \"s\" &&\n            sel[1] === \"v\" &&\n            sel[2] === \"g\" &&\n            (sel.length === 3 || sel[3] === \".\" || sel[3] === \"#\")) {\n            addNS(data, children, sel);\n        }\n        return vnode(sel, data, children, undefined, node);\n    }\n    else if (api.isText(node)) {\n        text = api.getTextContent(node);\n        return vnode(undefined, undefined, undefined, text, node);\n    }\n    else if (api.isComment(node)) {\n        text = api.getTextContent(node);\n        return vnode(\"!\", {}, [], text, node);\n    }\n    else {\n        return vnode(\"\", {}, [], undefined, node);\n    }\n}\n\nconst xlinkNS = \"http://www.w3.org/1999/xlink\";\nconst xmlNS = \"http://www.w3.org/XML/1998/namespace\";\nconst colonChar = 58;\nconst xChar = 120;\nfunction updateAttrs(oldVnode, vnode) {\n    let key;\n    const elm = vnode.elm;\n    let oldAttrs = oldVnode.data.attrs;\n    let attrs = vnode.data.attrs;\n    if (!oldAttrs && !attrs)\n        return;\n    if (oldAttrs === attrs)\n        return;\n    oldAttrs = oldAttrs || {};\n    attrs = attrs || {};\n    // update modified attributes, add new attributes\n    for (key in attrs) {\n        const cur = attrs[key];\n        const old = oldAttrs[key];\n        if (old !== cur) {\n            if (cur === true) {\n                elm.setAttribute(key, \"\");\n            }\n            else if (cur === false) {\n                elm.removeAttribute(key);\n            }\n            else {\n                if (key.charCodeAt(0) !== xChar) {\n                    elm.setAttribute(key, cur);\n                }\n                else if (key.charCodeAt(3) === colonChar) {\n                    // Assume xml namespace\n                    elm.setAttributeNS(xmlNS, key, cur);\n                }\n                else if (key.charCodeAt(5) === colonChar) {\n                    // Assume xlink namespace\n                    elm.setAttributeNS(xlinkNS, key, cur);\n                }\n                else {\n                    elm.setAttribute(key, cur);\n                }\n            }\n        }\n    }\n    // remove removed attributes\n    // use `in` operator since the previous `for` iteration uses it (.i.e. add even attributes with undefined value)\n    // the other option is to remove all attributes with value == undefined\n    for (key in oldAttrs) {\n        if (!(key in attrs)) {\n            elm.removeAttribute(key);\n        }\n    }\n}\nconst attributesModule = {\n    create: updateAttrs,\n    update: updateAttrs,\n};\n\nfunction updateClass(oldVnode, vnode) {\n    let cur;\n    let name;\n    const elm = vnode.elm;\n    let oldClass = oldVnode.data.class;\n    let klass = vnode.data.class;\n    if (!oldClass && !klass)\n        return;\n    if (oldClass === klass)\n        return;\n    oldClass = oldClass || {};\n    klass = klass || {};\n    for (name in oldClass) {\n        if (oldClass[name] && !Object.prototype.hasOwnProperty.call(klass, name)) {\n            // was `true` and now not provided\n            elm.classList.remove(name);\n        }\n    }\n    for (name in klass) {\n        cur = klass[name];\n        if (cur !== oldClass[name]) {\n            elm.classList[cur ? \"add\" : \"remove\"](name);\n        }\n    }\n}\nconst classModule = { create: updateClass, update: updateClass };\n\nconst CAPS_REGEX = /[A-Z]/g;\nfunction updateDataset(oldVnode, vnode) {\n    const elm = vnode.elm;\n    let oldDataset = oldVnode.data.dataset;\n    let dataset = vnode.data.dataset;\n    let key;\n    if (!oldDataset && !dataset)\n        return;\n    if (oldDataset === dataset)\n        return;\n    oldDataset = oldDataset || {};\n    dataset = dataset || {};\n    const d = elm.dataset;\n    for (key in oldDataset) {\n        if (!dataset[key]) {\n            if (d) {\n                if (key in d) {\n                    delete d[key];\n                }\n            }\n            else {\n                elm.removeAttribute(\"data-\" + key.replace(CAPS_REGEX, \"-$&\").toLowerCase());\n            }\n        }\n    }\n    for (key in dataset) {\n        if (oldDataset[key] !== dataset[key]) {\n            if (d) {\n                d[key] = dataset[key];\n            }\n            else {\n                elm.setAttribute(\"data-\" + key.replace(CAPS_REGEX, \"-$&\").toLowerCase(), dataset[key]);\n            }\n        }\n    }\n}\nconst datasetModule = {\n    create: updateDataset,\n    update: updateDataset,\n};\n\nfunction invokeHandler(handler, vnode, event) {\n    if (typeof handler === \"function\") {\n        // call function handler\n        handler.call(vnode, event, vnode);\n    }\n    else if (typeof handler === \"object\") {\n        // call multiple handlers\n        for (let i = 0; i < handler.length; i++) {\n            invokeHandler(handler[i], vnode, event);\n        }\n    }\n}\nfunction handleEvent(event, vnode) {\n    const name = event.type;\n    const on = vnode.data.on;\n    // call event handler(s) if exists\n    if (on && on[name]) {\n        invokeHandler(on[name], vnode, event);\n    }\n}\nfunction createListener() {\n    return function handler(event) {\n        handleEvent(event, handler.vnode);\n    };\n}\nfunction updateEventListeners(oldVnode, vnode) {\n    const oldOn = oldVnode.data.on;\n    const oldListener = oldVnode.listener;\n    const oldElm = oldVnode.elm;\n    const on = vnode && vnode.data.on;\n    const elm = (vnode && vnode.elm);\n    let name;\n    // optimization for reused immutable handlers\n    if (oldOn === on) {\n        return;\n    }\n    // remove existing listeners which no longer used\n    if (oldOn && oldListener) {\n        // if element changed or deleted we remove all existing listeners unconditionally\n        if (!on) {\n            for (name in oldOn) {\n                // remove listener if element was changed or existing listeners removed\n                oldElm.removeEventListener(name, oldListener, false);\n            }\n        }\n        else {\n            for (name in oldOn) {\n                // remove listener if existing listener removed\n                if (!on[name]) {\n                    oldElm.removeEventListener(name, oldListener, false);\n                }\n            }\n        }\n    }\n    // add new listeners which has not already attached\n    if (on) {\n        // reuse existing listener or create new\n        const listener = (vnode.listener =\n            oldVnode.listener || createListener());\n        // update vnode for listener\n        listener.vnode = vnode;\n        // if element changed or added we add all needed listeners unconditionally\n        if (!oldOn) {\n            for (name in on) {\n                // add listener if element was changed or new listeners added\n                elm.addEventListener(name, listener, false);\n            }\n        }\n        else {\n            for (name in on) {\n                // add listener if new listener added\n                if (!oldOn[name]) {\n                    elm.addEventListener(name, listener, false);\n                }\n            }\n        }\n    }\n}\nconst eventListenersModule = {\n    create: updateEventListeners,\n    update: updateEventListeners,\n    destroy: updateEventListeners,\n};\n\nfunction updateProps(oldVnode, vnode) {\n    let key;\n    let cur;\n    let old;\n    const elm = vnode.elm;\n    let oldProps = oldVnode.data.props;\n    let props = vnode.data.props;\n    if (!oldProps && !props)\n        return;\n    if (oldProps === props)\n        return;\n    oldProps = oldProps || {};\n    props = props || {};\n    for (key in props) {\n        cur = props[key];\n        old = oldProps[key];\n        if (old !== cur && (key !== \"value\" || elm[key] !== cur)) {\n            elm[key] = cur;\n        }\n    }\n}\nconst propsModule = { create: updateProps, update: updateProps };\n\n// Bindig `requestAnimationFrame` like this fixes a bug in IE/Edge. See #360 and #409.\nconst raf = (typeof window !== \"undefined\" &&\n    window.requestAnimationFrame.bind(window)) ||\n    setTimeout;\nconst nextFrame = function (fn) {\n    raf(function () {\n        raf(fn);\n    });\n};\nlet reflowForced = false;\nfunction setNextFrame(obj, prop, val) {\n    nextFrame(function () {\n        obj[prop] = val;\n    });\n}\nfunction updateStyle(oldVnode, vnode) {\n    let cur;\n    let name;\n    const elm = vnode.elm;\n    let oldStyle = oldVnode.data.style;\n    let style = vnode.data.style;\n    if (!oldStyle && !style)\n        return;\n    if (oldStyle === style)\n        return;\n    oldStyle = oldStyle || {};\n    style = style || {};\n    const oldHasDel = \"delayed\" in oldStyle;\n    for (name in oldStyle) {\n        if (!style[name]) {\n            if (name[0] === \"-\" && name[1] === \"-\") {\n                elm.style.removeProperty(name);\n            }\n            else {\n                elm.style[name] = \"\";\n            }\n        }\n    }\n    for (name in style) {\n        cur = style[name];\n        if (name === \"delayed\" && style.delayed) {\n            for (const name2 in style.delayed) {\n                cur = style.delayed[name2];\n                if (!oldHasDel || cur !== oldStyle.delayed[name2]) {\n                    setNextFrame(elm.style, name2, cur);\n                }\n            }\n        }\n        else if (name !== \"remove\" && cur !== oldStyle[name]) {\n            if (name[0] === \"-\" && name[1] === \"-\") {\n                elm.style.setProperty(name, cur);\n            }\n            else {\n                elm.style[name] = cur;\n            }\n        }\n    }\n}\nfunction applyDestroyStyle(vnode) {\n    let style;\n    let name;\n    const elm = vnode.elm;\n    const s = vnode.data.style;\n    if (!s || !(style = s.destroy))\n        return;\n    for (name in style) {\n        elm.style[name] = style[name];\n    }\n}\nfunction applyRemoveStyle(vnode, rm) {\n    const s = vnode.data.style;\n    if (!s || !s.remove) {\n        rm();\n        return;\n    }\n    if (!reflowForced) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n        vnode.elm.offsetLeft;\n        reflowForced = true;\n    }\n    let name;\n    const elm = vnode.elm;\n    let i = 0;\n    const style = s.remove;\n    let amount = 0;\n    const applied = [];\n    for (name in style) {\n        applied.push(name);\n        elm.style[name] = style[name];\n    }\n    const compStyle = getComputedStyle(elm);\n    const props = compStyle[\"transition-property\"].split(\", \");\n    for (; i < props.length; ++i) {\n        if (applied.indexOf(props[i]) !== -1)\n            amount++;\n    }\n    elm.addEventListener(\"transitionend\", function (ev) {\n        if (ev.target === elm)\n            --amount;\n        if (amount === 0)\n            rm();\n    });\n}\nfunction forceReflow() {\n    reflowForced = false;\n}\nconst styleModule = {\n    pre: forceReflow,\n    create: updateStyle,\n    update: updateStyle,\n    destroy: applyDestroyStyle,\n    remove: applyRemoveStyle,\n};\n\n/* eslint-disable @typescript-eslint/no-namespace, import/export */\nfunction Fragment(data, ...children) {\n    const flatChildren = flattenAndFilter(children, []);\n    if (flatChildren.length === 1 &&\n        !flatChildren[0].sel &&\n        flatChildren[0].text) {\n        // only child is a simple text node, pass as text for a simpler vtree\n        return vnode(undefined, undefined, undefined, flatChildren[0].text, undefined);\n    }\n    else {\n        return vnode(undefined, data !== null && data !== void 0 ? data : {}, flatChildren, undefined, undefined);\n    }\n}\nfunction flattenAndFilter(children, flattened) {\n    for (const child of children) {\n        // filter out falsey children, except 0 since zero can be a valid value e.g inside a chart\n        if (child !== undefined &&\n            child !== null &&\n            child !== false &&\n            child !== \"\") {\n            if (Array.isArray(child)) {\n                flattenAndFilter(child, flattened);\n            }\n            else if (typeof child === \"string\" ||\n                typeof child === \"number\" ||\n                typeof child === \"boolean\") {\n                flattened.push(vnode(undefined, undefined, undefined, String(child), undefined));\n            }\n            else {\n                flattened.push(child);\n            }\n        }\n    }\n    return flattened;\n}\n/**\n * jsx/tsx compatible factory function\n * see: https://www.typescriptlang.org/docs/handbook/jsx.html#factory-functions\n */\nfunction jsx(tag, data, ...children) {\n    const flatChildren = flattenAndFilter(children, []);\n    if (typeof tag === \"function\") {\n        // tag is a function component\n        return tag(data, flatChildren);\n    }\n    else {\n        if (flatChildren.length === 1 &&\n            !flatChildren[0].sel &&\n            flatChildren[0].text) {\n            // only child is a simple text node, pass as text for a simpler vtree\n            return h(tag, data, flatChildren[0].text);\n        }\n        else {\n            return h(tag, data, flatChildren);\n        }\n    }\n}\n(function (jsx) {\n})(jsx || (jsx = {}));\n\nexports.Fragment = Fragment;\nexports.array = array;\nexports.attachTo = attachTo;\nexports.attributesModule = attributesModule;\nexports.classModule = classModule;\nexports.datasetModule = datasetModule;\nexports.eventListenersModule = eventListenersModule;\nexports.fragment = fragment;\nexports.h = h;\nexports.htmlDomApi = htmlDomApi;\nexports.init = init$1;\nexports.jsx = jsx;\nexports.primitive = primitive;\nexports.propsModule = propsModule;\nexports.styleModule = styleModule;\nexports.thunk = thunk;\nexports.toVNode = toVNode;\nexports.vnode = vnode;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { h, VNode, VNodeData } from \"snabbdom\";\nimport { SModelElementImpl } from \"../model/smodel\";\nimport { RenderingContext, IView } from \"./view\";\nimport { injectable } from \"inversify\";\n\n/**\n * An view that avoids calculation and patching of VNodes unless some model properties have changed.\n * Based on snabbdom's thunks.\n */\n@injectable()\nexport abstract class ThunkView implements IView {\n\n    /**\n     * Returns the array of values that are watched for changes.\n     * If they haven't change since the last rendering, the VNode is neither recalculated nor patched.\n     */\n    abstract watchedArgs(model: SModelElementImpl): any[];\n\n    /**\n     * Returns the selector of the VNode root, i.e. it's element type.\n     */\n    abstract selector(model: SModelElementImpl): string;\n\n    /**\n     * Calculate the VNode from the input data. Only called if the watched properties change.\n     */\n    abstract doRender(model: SModelElementImpl, context: RenderingContext): VNode;\n\n    render(model: SModelElementImpl, context: RenderingContext): VNode {\n        return h(this.selector(model), {\n            key: model.id,\n            hook: {\n                init: this.init.bind(this),\n                prepatch: this.prepatch.bind(this)},\n            fn: () => this.renderAndDecorate(model, context),\n            args: this.watchedArgs(model),\n            thunk: true\n        });\n    }\n\n    protected renderAndDecorate(model: SModelElementImpl, context: RenderingContext): VNode {\n        const vnode = this.doRender(model, context);\n        context.decorate(vnode, model);\n        return vnode;\n    }\n\n    protected copyToThunk(vnode: VNode, thunk: VNode): void {\n        thunk.elm = vnode.elm;\n        (vnode.data as VNodeData).fn = (thunk.data as VNodeData).fn;\n        (vnode.data as VNodeData).args = (thunk.data as VNodeData).args;\n        thunk.data = vnode.data;\n        thunk.children = vnode.children;\n        thunk.text = vnode.text;\n        thunk.elm = vnode.elm;\n    }\n\n    protected init(thunk: VNode): void {\n        const cur = thunk.data as VNodeData;\n        const vnode = (cur.fn as any).apply(undefined, cur.args);\n        this.copyToThunk(vnode, thunk);\n    }\n\n    protected prepatch(oldVnode: VNode, thunk: VNode): void {\n        const old = oldVnode.data as VNodeData, cur = thunk.data as VNodeData;\n        if (!this.equals(old.args as any[], cur.args as any[]))\n            this.copyToThunk((cur.fn as any).apply(undefined, cur.args), thunk);\n        else\n            this.copyToThunk(oldVnode, thunk);\n    }\n\n    protected equals(oldArg: any, newArg: any) {\n        if (Array.isArray(oldArg) && Array.isArray(newArg)) {\n            if (oldArg.length !== newArg.length)\n                return false;\n            for (let i = 0; i < newArg.length; ++i) {\n                if (!this.equals(oldArg[i], newArg[i]))\n                    return false;\n            }\n        } else if (typeof oldArg === 'object' && typeof newArg === 'object') {\n            if (Object.keys(oldArg).length !== Object.keys(newArg).length)\n                return false;\n            for (const key in oldArg) {\n                if (key !== 'parent' && key !== 'root' && (!(key in newArg) || !this.equals(oldArg[key], newArg[key])))\n                    return false;\n            }\n        } else if (oldArg !== newArg) {\n            return false;\n        }\n        return true;\n    }\n}\n\nexport interface ThunkVNode extends VNode {\n    thunk: boolean\n}\n\nexport function isThunk(vnode: VNode): vnode is ThunkVNode {\n    return 'thunk' in vnode;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { VNodeData, JsxVNodeChildren, JsxVNodeChild, jsx, FunctionComponent } from \"snabbdom\";\n\n\ndeclare global {\n  // eslint-disable-next-line no-redeclare\n  namespace JSX {\n      // Based on the tag list in github:DefinitelyTyped/DefinitelyTyped:React\n      interface IntrinsicElements {\n          [elemName: string]: VNodeData\n      }\n  }\n}\n\nconst modulesNS = ['hook', 'on', 'style', 'class', 'props', 'attrs', 'dataset'];\nconst SVGNS = 'http://www.w3.org/2000/svg';\n\nfunction normalizeAttrs(source: VNodeData | null, defNS: string, namespace?: string) {\n  const data: VNodeData = {};\n\n  if (namespace) {\n    data.ns = namespace;\n  }\n  if (source === null) {\n    return data;\n  }\n\n  modulesNS.forEach(mod => {\n    if (source[mod]) {\n      data[mod] = source[mod];\n    }\n  });\n  Object.keys(source).forEach(key => {\n    if (key === 'key' || key === 'classNames' || key === 'selector') return;\n    const idx = key.indexOf('-');\n    if (idx > 0)\n      addAttr(key.slice(0, idx), key.slice(idx + 1), source[key]);\n    else if (!data[key])\n      addAttr(defNS, key, source[key]);\n  });\n  return data;\n\n  function addAttr(modname: string, key: string, val: JsxVNodeChildren) {\n    const mod = data[modname] || (data[modname] = {});\n    mod[key] = val;\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction JSX(namespace?: string, defNS: string = 'props') {\n  return (tag: FunctionComponent | string, attrs: VNodeData | null, ...children: JsxVNodeChild[]) => jsx(tag, normalizeAttrs(attrs, defNS, namespace), children);\n}\n\nconst html = JSX();\nconst svg = JSX(SVGNS, 'attrs');\n\nexport { html, svg, JSX };\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/** @jsx svg */\nimport { svg } from '../../lib/jsx';\n\nimport { injectable, multiInject, optional, interfaces } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { TYPES } from '../types';\nimport { InstanceRegistry } from '../../utils/registry';\nimport { isInjectable } from '../../utils/inversify';\nimport { SModelElementImpl, SModelRootImpl, SParentElementImpl } from '../model/smodel';\nimport { EMPTY_ROOT, CustomFeatures } from '../model/smodel-factory';\nimport { registerModelElement } from '../model/smodel-utils';\nimport { Point } from 'sprotty-protocol';\n\n/**\n * Arguments for `IView` rendering.\n */\nexport interface IViewArgs {\n    parentArgs?: IViewArgs;\n    [key: string]: any;\n}\n\n/**\n * Searches for the property specified in `key` in the specified `args`,\n * including its direct or indirect `IRenderingArgs#parentArgs`.\n *\n * @param arg the rendering arguments.\n * @param key the key to search for.\n * @returns the found value or `undefined.\n */\nexport function findArgValue<T>(arg: IViewArgs | undefined, key: string): T | undefined {\n    while (arg !== undefined && !(key in arg) && arg.parentArgs) {\n        arg = arg.parentArgs;\n    }\n    return arg ? arg[key] : undefined;\n}\n\n/**\n * Base interface for the components that turn GModelElements into virtual DOM elements.\n */\nexport interface IView<A extends IViewArgs = {}> {\n    render(model: Readonly<SModelElementImpl>, context: RenderingContext, args?: A): VNode | undefined\n}\n\n/**\n * Indicates the target of the view rendering. `main` is the actually visible diagram,\n * `popup` is the mouse hover popup, and `hidden` is for computing element bounds prior\n * to the main rendering.\n */\nexport type RenderingTargetKind = 'main' | 'popup' | 'hidden';\n\n/**\n * Bundles additional data that is passed to views for VNode creation.\n */\nexport interface RenderingContext {\n    readonly viewRegistry: ViewRegistry\n    readonly targetKind: RenderingTargetKind;\n    readonly parentArgs?: IViewArgs;\n\n    decorate(vnode: VNode, element: Readonly<SModelElementImpl>): VNode\n\n    renderElement(element: Readonly<SModelElementImpl>): VNode | undefined\n\n    renderChildren(element: Readonly<SParentElementImpl>, args?: IViewArgs): VNode[]\n}\n\n/**\n * Used to bind a model element type to a view factory in the ViewRegistry.\n */\nexport interface ViewRegistration {\n    type: string\n    factory: () => IView\n}\n\nexport type ViewRegistrationFactory = () => ViewRegistration;\n\n/**\n * Allows to look up the IView for a given SModelElement based on its type.\n */\n@injectable()\nexport class ViewRegistry extends InstanceRegistry<IView> {\n    constructor(@multiInject(TYPES.ViewRegistration) @optional() registrations: ViewRegistration[]) {\n        super();\n        this.registerDefaults();\n        registrations.forEach(registration =>\n            this.register(registration.type, registration.factory())\n        );\n    }\n\n    protected registerDefaults() {\n        this.register(EMPTY_ROOT.type, new EmptyView());\n    }\n\n    override missing(key: string): IView {\n        return new MissingView();\n    }\n}\n\n/**\n * Combines `registerModelElement` and `configureView`.\n */\nexport function configureModelElement(context: { bind: interfaces.Bind, isBound: interfaces.IsBound },\n        type: string, modelConstr: new () => SModelElementImpl, viewConstr: interfaces.ServiceIdentifier<IView>,\n        features?: CustomFeatures): void {\n    registerModelElement(context, type, modelConstr, features);\n    configureView(context, type, viewConstr);\n}\n\n/**\n * Utility function to register a view for a model element type.\n */\nexport function configureView(context: { bind: interfaces.Bind, isBound: interfaces.IsBound },\n        type: string, constr: interfaces.ServiceIdentifier<IView>): void {\n    if (typeof constr === 'function') {\n        if (!isInjectable(constr)) {\n            throw new Error(`Views should be @injectable: ${constr.name}`);\n        }\n        if (!context.isBound(constr)) {\n            context.bind(constr).toSelf();\n        }\n    }\n    context.bind(TYPES.ViewRegistration).toDynamicValue(ctx => ({\n        type,\n        factory: () => ctx.container.get(constr)\n    }));\n}\n\n/**\n * This view is used when the model is the EMPTY_ROOT.\n */\n@injectable()\nexport class EmptyView implements IView {\n    render(model: SModelRootImpl, context: RenderingContext): VNode {\n        return <svg class-sprotty-empty={true} />;\n    }\n}\n\n/**\n * This view is used when no view has been registered for a model element type.\n */\n@injectable()\nexport class MissingView implements IView {\n    render(model: Readonly<SModelElementImpl>, context: RenderingContext): VNode {\n        const position: Point = (model as any).position || Point.ORIGIN;\n        return <text class-sprotty-missing={true} x={position.x} y={position.y}>?{model.id}?</text>;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from \"inversify\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { SModelRootImpl } from \"../model/smodel\";\nimport { TYPES } from \"../types\";\nimport { AnimationFrameSyncer } from \"../animations/animation-frame-syncer\";\nimport { IViewer } from \"./viewer\";\n\n/**\n * Updating the view is rather expensive, and it doesn't make sense to calculate\n * more then one update per animation (rendering) frame. So this class batches\n * all incoming model changes and only renders the last one when the next animation\n * frame comes.\n */\n@injectable()\nexport class ViewerCache implements IViewer {\n\n    @inject(TYPES.IViewer) protected delegate: IViewer;\n    @inject(TYPES.AnimationFrameSyncer) protected syncer: AnimationFrameSyncer;\n\n    protected cachedModel?: SModelRootImpl;\n\n    update(model: SModelRootImpl, cause?: Action): void {\n        if (cause !== undefined) {\n            // Forward the update immediately in order to pass the cause action\n            this.delegate.update(model, cause);\n            this.cachedModel = undefined;\n        } else {\n            const isCacheEmpty = this.cachedModel === undefined;\n            this.cachedModel = model;\n            if (isCacheEmpty) {\n                this.scheduleUpdate();\n            }\n        }\n    }\n\n    protected scheduleUpdate() {\n        this.syncer.onEndOfNextFrame(() => {\n            if (this.cachedModel) {\n                this.delegate.update(this.cachedModel);\n                this.cachedModel = undefined;\n            }\n        });\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2023 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Container, interfaces } from 'inversify';\nimport { safeAssign } from 'sprotty-protocol/lib/utils/object';\nimport { Limits } from '../../utils/geometry';\nimport { TYPES } from '../types';\n\nexport interface ViewerOptions {\n    /** ID of the HTML element into which the visible diagram is rendered. */\n    baseDiv: string\n    /** CSS class added to the base element of the visible diagram. */\n    baseClass: string\n    /** ID of the HTML element into which the hidden diagram is rendered. */\n    hiddenDiv: string\n    /** CSS class added to the base element of the hidden rendering. */\n    hiddenClass: string\n    /** ID of the HTML element into which hover popup boxes are rendered. */\n    popupDiv: string\n    /** CSS class added to the base element of popup boxes. */\n    popupClass: string\n    /** CSS class added to popup boxes when they are closed. */\n    popupClosedClass: string\n    /** Whether client layouts need to be computed by Sprotty. This activates a hidden rendering cycle. */\n    needsClientLayout: boolean\n    /** Whether the model source needs to invoke a layout engine after a model update. */\n    needsServerLayout: boolean\n    /** Delay for opening a popup box after mouse hovering an element. */\n    popupOpenDelay: number\n    /** Delay for closing a popup box after leaving the corresponding element. */\n    popupCloseDelay: number\n    /** Minimum (zoom out) and maximum (zoom in) values for the zoom factor. */\n    zoomLimits: Limits\n    /** Minimum and maximum values for the horizontal scroll position. */\n    horizontalScrollLimits: Limits\n    /** Minimum and maximum values for the vertical scroll position. */\n    verticalScrollLimits: Limits\n}\n\nexport const defaultViewerOptions: () => ViewerOptions = () => ({\n    baseDiv: 'sprotty',\n    baseClass: 'sprotty',\n    hiddenDiv: 'sprotty-hidden',\n    hiddenClass: 'sprotty-hidden',\n    popupDiv: 'sprotty-popup',\n    popupClass: 'sprotty-popup',\n    popupClosedClass: 'sprotty-popup-closed',\n    needsClientLayout: true,\n    needsServerLayout: false,\n    popupOpenDelay: 1000,\n    popupCloseDelay: 300,\n    zoomLimits: { min: 0.01, max: 10 },\n    horizontalScrollLimits: { min: -100_000, max: 100_000 },\n    verticalScrollLimits: { min: -100_000, max: 100_000 }\n});\n\n/**\n * Utility function to partially set viewer options. Default values (from `defaultViewerOptions`) are used for\n * options that are not specified.\n */\nexport function configureViewerOptions(context: { bind: interfaces.Bind, isBound: interfaces.IsBound, rebind: interfaces.Rebind },\n        options: Partial<ViewerOptions>): void {\n    const opt: ViewerOptions = {\n        ...defaultViewerOptions(),\n        ...options\n    };\n    if (context.isBound(TYPES.ViewerOptions))\n        context.rebind(TYPES.ViewerOptions).toConstantValue(opt);\n    else\n        context.bind(TYPES.ViewerOptions).toConstantValue(opt);\n}\n\n/**\n * Utility function to partially override the currently configured viewer options in a DI container.\n */\nexport function overrideViewerOptions(container: Container, options: Partial<ViewerOptions>): ViewerOptions {\n    const opt = container.get<ViewerOptions>(TYPES.ViewerOptions);\n    safeAssign(opt, options);\n    return opt;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/** @jsx html */\nimport { inject, injectable, multiInject, optional } from 'inversify';\nimport { attributesModule, classModule, eventListenersModule, init, Module, propsModule, styleModule, VNode } from 'snabbdom';\nimport { Action } from 'sprotty-protocol/lib/actions';\nimport { html } from '../../lib/jsx'; // must be html here, as we're creating a div\nimport { getWindowScroll } from '../../utils/browser';\nimport { ILogger } from '../../utils/logging';\nimport { IActionDispatcher } from '../actions/action-dispatcher';\nimport { InitializeCanvasBoundsAction } from '../features/initialize-canvas';\nimport { SModelElementImpl, SModelRootImpl, SParentElementImpl } from '../model/smodel';\nimport { EMPTY_ROOT } from '../model/smodel-factory';\nimport { TYPES } from '../types';\nimport { isThunk } from './thunk-view';\nimport { IViewArgs, RenderingContext, RenderingTargetKind, ViewRegistry } from './view';\nimport { ViewerOptions } from './viewer-options';\nimport { IVNodePostprocessor } from './vnode-postprocessor';\nimport { copyClassesFromElement, copyClassesFromVNode, setAttr, setClass } from './vnode-utils';\n\n\nexport interface IViewer {\n    update(model: SModelRootImpl, cause?: Action): void\n}\n\nexport interface IViewerProvider {\n    readonly modelViewer: IViewer\n    readonly hiddenModelViewer: IViewer\n    readonly popupModelViewer: IViewer\n}\n\nexport class ModelRenderer implements RenderingContext {\n\n    constructor(readonly viewRegistry: ViewRegistry,\n        readonly targetKind: RenderingTargetKind,\n        private postprocessors: IVNodePostprocessor[],\n        protected args: IViewArgs = {}) {\n    }\n\n    decorate(vnode: VNode, element: Readonly<SModelElementImpl>): VNode {\n        if (isThunk(vnode)) {\n            return vnode;\n        }\n        return this.postprocessors.reduce(\n            (n: VNode, processor: IVNodePostprocessor) => processor.decorate(n, element),\n            vnode);\n    }\n\n    renderElement(element: Readonly<SModelElementImpl>): VNode | undefined {\n        const view = this.viewRegistry.get(element.type);\n        const vnode = view.render(element, this, this.args);\n        if (vnode) {\n            return this.decorate(vnode, element);\n        } else {\n            return undefined;\n        }\n    }\n\n    renderChildren(element: Readonly<SParentElementImpl>, args?: IViewArgs): VNode[] {\n        const context = args ?\n            new ModelRenderer(\n                this.viewRegistry,\n                this.targetKind,\n                this.postprocessors,\n                { ...args, parentArgs: this.args }\n            ) : this;\n        return element.children\n            .map(child => context.renderElement(child))\n            .filter(vnode => vnode !== undefined) as VNode[];\n    }\n\n    postUpdate(cause?: Action) {\n        this.postprocessors.forEach(processor => processor.postUpdate(cause));\n    }\n}\n\nexport type ModelRendererFactory = (\n    targetKind: RenderingTargetKind,\n    postprocessors: IVNodePostprocessor[],\n    args?: IViewArgs\n) => ModelRenderer;\n\nexport type Patcher = (oldRoot: VNode | Element, newRoot: VNode) => VNode;\n\n@injectable()\nexport class PatcherProvider {\n\n    readonly patcher: Patcher;\n\n    constructor() {\n        this.patcher = init(this.createModules());\n    }\n\n    protected createModules(): Module[] {\n        return [\n            propsModule,\n            attributesModule,\n            classModule,\n            styleModule,\n            eventListenersModule\n        ];\n    }\n\n}\n\n/**\n * The component that turns the model into an SVG DOM.\n * Uses a VDOM based on snabbdom.js for performance.\n */\n@injectable()\nexport class ModelViewer implements IViewer {\n\n    @inject(TYPES.ViewerOptions) protected options: ViewerOptions;\n    @inject(TYPES.ILogger) protected logger: ILogger;\n    @inject(TYPES.IActionDispatcher) protected actiondispatcher: IActionDispatcher;\n\n    constructor(@inject(TYPES.ModelRendererFactory) modelRendererFactory: ModelRendererFactory,\n        @inject(TYPES.PatcherProvider) patcherProvider: PatcherProvider,\n        @multiInject(TYPES.IVNodePostprocessor) @optional() postprocessors: IVNodePostprocessor[]) {\n        this.renderer = modelRendererFactory('main', postprocessors);\n        this.patcher = patcherProvider.patcher;\n    }\n\n    protected readonly renderer: ModelRenderer;\n    protected readonly patcher: Patcher;\n\n    protected lastVDOM: VNode;\n\n    update(model: Readonly<SModelRootImpl>, cause?: Action): void {\n        this.logger.log(this, 'rendering', model);\n        const newVDOM = <div id={this.options.baseDiv}>\n            {this.renderer.renderElement(model)}\n        </div>;\n        if (this.lastVDOM !== undefined) {\n            const hadFocus = this.hasFocus();\n            copyClassesFromVNode(this.lastVDOM, newVDOM);\n            this.lastVDOM = this.patcher.call(this, this.lastVDOM, newVDOM);\n            this.restoreFocus(hadFocus);\n        } else if (typeof document !== 'undefined') {\n            const placeholder = document.getElementById(this.options.baseDiv);\n            if (placeholder !== null) {\n                if (typeof window !== 'undefined') {\n                    window.addEventListener('resize', () => {\n                        this.onWindowResize(newVDOM);\n                    });\n                }\n                copyClassesFromElement(placeholder, newVDOM);\n                setClass(newVDOM, this.options.baseClass, true);\n                this.lastVDOM = this.patcher.call(this, placeholder, newVDOM);\n            } else {\n                this.logger.error(this, 'element not in DOM:', this.options.baseDiv);\n            }\n        }\n        this.renderer.postUpdate(cause);\n    }\n\n    protected hasFocus(): boolean {\n        if (typeof document !== 'undefined' && document.activeElement && this.lastVDOM.children && this.lastVDOM.children.length > 0) {\n            const lastRootVNode = this.lastVDOM.children[0];\n            if (typeof lastRootVNode === 'object') {\n                const lastElement = (lastRootVNode as VNode).elm;\n                return document.activeElement === lastElement;\n            }\n        }\n        return false;\n    }\n\n    protected restoreFocus(focus: boolean) {\n        if (focus && this.lastVDOM.children && this.lastVDOM.children.length > 0) {\n            const lastRootVNode = this.lastVDOM.children[0];\n            if (typeof lastRootVNode === 'object') {\n                const lastElement = (lastRootVNode as VNode).elm;\n                if (lastElement && typeof (lastElement as any).focus === 'function')\n                    (lastElement as any).focus();\n            }\n        }\n    }\n\n    protected onWindowResize(vdom: VNode): void {\n        const baseDiv = document.getElementById(this.options.baseDiv);\n        if (baseDiv !== null) {\n            const newBounds = this.getBoundsInPage(baseDiv as Element);\n            this.actiondispatcher.dispatch(InitializeCanvasBoundsAction.create(newBounds));\n        }\n    }\n\n    protected getBoundsInPage(element: Element) {\n        const bounds = element.getBoundingClientRect();\n        const scroll = getWindowScroll();\n        return {\n            x: bounds.left + scroll.x,\n            y: bounds.top + scroll.y,\n            width: bounds.width,\n            height: bounds.height\n        };\n    }\n\n}\n\n/**\n * Viewer for the _hidden_ model. This serves as an intermediate step to compute bounds\n * of elements. The model is rendered in a section that is not visible to the user,\n * and then the bounds are extracted from the DOM.\n */\n@injectable()\nexport class HiddenModelViewer implements IViewer {\n\n    @inject(TYPES.ViewerOptions) protected options: ViewerOptions;\n    @inject(TYPES.ILogger) protected logger: ILogger;\n\n    constructor(@inject(TYPES.ModelRendererFactory) modelRendererFactory: ModelRendererFactory,\n        @inject(TYPES.PatcherProvider) patcherProvider: PatcherProvider,\n        @multiInject(TYPES.HiddenVNodePostprocessor) @optional() hiddenPostprocessors: IVNodePostprocessor[]) {\n        this.hiddenRenderer = modelRendererFactory('hidden', hiddenPostprocessors);\n        this.patcher = patcherProvider.patcher;\n    }\n\n    protected readonly hiddenRenderer: ModelRenderer;\n    protected readonly patcher: Patcher;\n\n    protected lastHiddenVDOM: VNode;\n\n    update(hiddenModel: Readonly<SModelRootImpl>, cause?: Action): void {\n        this.logger.log(this, 'rendering hidden');\n\n        let newVDOM: VNode;\n        if (hiddenModel.type === EMPTY_ROOT.type) {\n            newVDOM = <div id={this.options.hiddenDiv}></div>;\n        } else {\n            const hiddenVNode = this.hiddenRenderer.renderElement(hiddenModel);\n            if (hiddenVNode) {\n                setAttr(hiddenVNode, 'opacity', 0);\n            }\n            newVDOM = <div id={this.options.hiddenDiv}>\n                {hiddenVNode}\n            </div>;\n        }\n\n        if (this.lastHiddenVDOM !== undefined) {\n            copyClassesFromVNode(this.lastHiddenVDOM, newVDOM);\n            this.lastHiddenVDOM = this.patcher.call(this, this.lastHiddenVDOM, newVDOM);\n        } else {\n            let placeholder = document.getElementById(this.options.hiddenDiv);\n            if (placeholder === null) {\n                placeholder = document.createElement('div');\n                document.body.appendChild(placeholder);\n            } else {\n                copyClassesFromElement(placeholder, newVDOM);\n            }\n            setClass(newVDOM, this.options.baseClass, true);\n            setClass(newVDOM, this.options.hiddenClass, true);\n            this.lastHiddenVDOM = this.patcher.call(this, placeholder, newVDOM);\n        }\n        this.hiddenRenderer.postUpdate(cause);\n    }\n\n}\n\n@injectable()\nexport class PopupModelViewer implements IViewer {\n\n    @inject(TYPES.ViewerOptions) protected options: ViewerOptions;\n    @inject(TYPES.ILogger) protected logger: ILogger;\n\n    constructor(@inject(TYPES.ModelRendererFactory) protected readonly modelRendererFactory: ModelRendererFactory,\n        @inject(TYPES.PatcherProvider) patcherProvider: PatcherProvider,\n        @multiInject(TYPES.PopupVNodePostprocessor) @optional() popupPostprocessors: IVNodePostprocessor[]) {\n        this.popupRenderer = this.modelRendererFactory('popup', popupPostprocessors);\n        this.patcher = patcherProvider.patcher;\n    }\n\n    protected readonly popupRenderer: ModelRenderer;\n    protected readonly patcher: Patcher;\n\n    protected lastPopupVDOM: VNode;\n\n    update(model: Readonly<SModelRootImpl>, cause?: Action): void {\n        this.logger.log(this, 'rendering popup', model);\n\n        const popupClosed = model.type === EMPTY_ROOT.type;\n        let newVDOM: VNode;\n        if (popupClosed) {\n            newVDOM = <div id={this.options.popupDiv}></div>;\n        } else {\n            const position = model.canvasBounds;\n            const inlineStyle = {\n                top: position.y + 'px',\n                left: position.x + 'px'\n            };\n            newVDOM = <div id={this.options.popupDiv} style={inlineStyle}>\n                {this.popupRenderer.renderElement(model)}\n            </div>;\n        }\n\n        if (this.lastPopupVDOM !== undefined) {\n            copyClassesFromVNode(this.lastPopupVDOM, newVDOM);\n            setClass(newVDOM, this.options.popupClosedClass, popupClosed);\n            this.lastPopupVDOM = this.patcher.call(this, this.lastPopupVDOM, newVDOM);\n        } else if (typeof document !== 'undefined') {\n            let placeholder = document.getElementById(this.options.popupDiv);\n            if (placeholder === null) {\n                placeholder = document.createElement('div');\n                document.body.appendChild(placeholder);\n            } else {\n                copyClassesFromElement(placeholder, newVDOM);\n            }\n            setClass(newVDOM, this.options.popupClass, true);\n            setClass(newVDOM, this.options.popupClosedClass, popupClosed);\n            this.lastPopupVDOM = this.patcher.call(this, placeholder, newVDOM);\n        }\n        this.popupRenderer.postUpdate(cause);\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from \"inversify\";\nimport { VNode } from \"snabbdom\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { SModelElementImpl } from \"../model/smodel\";\nimport { setAttr } from \"./vnode-utils\";\n\n/**\n * Manipulates a created VNode after it has been created.\n * Used to register listeners and add animations.\n */\nexport interface IVNodePostprocessor {\n    decorate(vnode: VNode, element: SModelElementImpl): VNode\n    postUpdate(cause?: Action): void\n}\n\n@injectable()\nexport class FocusFixPostprocessor implements IVNodePostprocessor {\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        if (vnode.sel && vnode.sel.startsWith('svg'))\n            // allows to set focus in Firefox\n            setAttr(vnode, 'tabindex', 0);\n        return vnode;\n    }\n\n    postUpdate(): void {\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from \"inversify\";\nimport { TYPES } from \"../base/types\";\nimport { ViewerOptions } from \"../base/views/viewer-options\";\n\nexport interface ILogger {\n    logLevel: LogLevel\n\n    error(thisArg: any, message: string, ...params: any[]): void\n    warn(thisArg: any, message: string, ...params: any[]): void\n    info(thisArg: any, message: string, ...params: any[]): void\n    log(thisArg: any, message: string, ...params: any[]): void\n}\n\nexport enum LogLevel { none = 0, error = 1, warn = 2, info = 3, log = 4 }\n\n@injectable()\nexport class NullLogger implements ILogger {\n    logLevel: LogLevel = LogLevel.none;\n\n    error(thisArg: any, message: string, ...params: any[]): void {}\n    warn(thisArg: any, message: string, ...params: any[]): void {}\n    info(thisArg: any, message: string, ...params: any[]): void {}\n    log(thisArg: any, message: string, ...params: any[]): void {}\n}\n\n@injectable()\nexport class ConsoleLogger implements ILogger {\n\n    @inject(TYPES.LogLevel) public logLevel: LogLevel = LogLevel.log;\n    @inject(TYPES.ViewerOptions) protected viewOptions: ViewerOptions = { baseDiv: '' } as ViewerOptions;\n\n    error(thisArg: any, message: string, ...params: any[]): void {\n        if (this.logLevel >= LogLevel.error)\n            try {\n                console.error.apply(thisArg, this.consoleArguments(thisArg, message, params));\n            } catch (error) {}\n    }\n\n    warn(thisArg: any, message: string, ...params: any[]): void {\n        if (this.logLevel >= LogLevel.warn)\n            try {\n                console.warn.apply(thisArg, this.consoleArguments(thisArg, message, params));\n            } catch (error) {}\n    }\n\n    info(thisArg: any, message: string, ...params: any[]): void {\n        if (this.logLevel >= LogLevel.info)\n            try {\n                console.info.apply(thisArg, this.consoleArguments(thisArg, message, params));\n            } catch (error) {}\n    }\n\n    log(thisArg: any, message: string, ...params: any[]): void {\n        if (this.logLevel >= LogLevel.log)\n            try {\n                console.log.apply(thisArg, this.consoleArguments(thisArg, message, params));\n            } catch (error) {}\n    }\n\n    protected consoleArguments(thisArg: any, message: string, params: any[]): any[] {\n        let caller: any;\n        if (typeof thisArg === 'object')\n            caller = thisArg.constructor.name;\n        else\n            caller = thisArg;\n        const date = new Date();\n        return [date.toLocaleTimeString() + ' ' + this.viewOptions.baseDiv + ' ' + caller + ': ' + message, ...params];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from \"inversify\";\nimport { VNode } from \"snabbdom\";\nimport { TYPES } from \"../types\";\nimport { ILogger } from \"../../utils/logging\";\nimport { SModelElementImpl } from \"../model/smodel\";\nimport { IVNodePostprocessor } from \"./vnode-postprocessor\";\nimport { DOMHelper } from \"./dom-helper\";\nimport { getAttrs } from \"./vnode-utils\";\n\n@injectable()\nexport class IdPostprocessor implements IVNodePostprocessor {\n\n    @inject(TYPES.ILogger) protected logger: ILogger;\n    @inject(TYPES.DOMHelper) protected domHelper: DOMHelper;\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        const attrs = getAttrs(vnode);\n        if (attrs.id !== undefined)\n            this.logger.warn(vnode, 'Overriding id of vnode (' + attrs.id + '). Make sure not to set it manually in view.');\n        attrs.id = this.domHelper.createUniqueDOMElementId(element);\n        if (!vnode.key)\n            vnode.key = element.id;\n        return vnode;\n    }\n\n    postUpdate(): void {\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { IVNodePostprocessor } from \"./vnode-postprocessor\";\nimport { VNode } from \"snabbdom\";\nimport { getSubType } from 'sprotty-protocol/lib/utils/model-utils';\nimport { SModelElementImpl } from \"../model/smodel\";\nimport { setClass } from \"./vnode-utils\";\nimport { injectable } from \"inversify\";\n\n@injectable()\nexport class CssClassPostprocessor implements IVNodePostprocessor {\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        if (element.cssClasses) {\n            for (const cssClass of element.cssClasses)\n                setClass(vnode, cssClass, true);\n        }\n        // append model subtype as class\n        const subType = getSubType(element);\n        if (subType && subType !== element.type) {\n            setClass(vnode, subType, true);\n        }\n        return vnode;\n    }\n\n    postUpdate(): void {\n        // empty\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"./types\";\nimport { CanvasBoundsInitializer, InitializeCanvasBoundsCommand } from './features/initialize-canvas';\nimport { LogLevel, NullLogger } from \"../utils/logging\";\nimport { ActionDispatcher, IActionDispatcher } from \"./actions/action-dispatcher\";\nimport { ActionHandlerRegistry } from \"./actions/action-handler\";\nimport { CommandStack, ICommandStack } from \"./commands/command-stack\";\nimport { CommandStackOptions } from \"./commands/command-stack-options\";\nimport { SModelFactory, SModelRegistry } from './model/smodel-factory';\nimport { AnimationFrameSyncer } from \"./animations/animation-frame-syncer\";\nimport { IViewer, ModelViewer, HiddenModelViewer, PopupModelViewer, ModelRenderer, PatcherProvider } from \"./views/viewer\";\nimport { ViewerOptions, defaultViewerOptions } from \"./views/viewer-options\";\nimport { MouseTool, PopupMouseTool, MousePositionTracker } from \"./views/mouse-tool\";\nimport { KeyTool } from \"./views/key-tool\";\nimport { FocusFixPostprocessor, IVNodePostprocessor } from \"./views/vnode-postprocessor\";\nimport { ViewRegistry, RenderingTargetKind, IViewArgs } from \"./views/view\";\nimport { ViewerCache } from \"./views/viewer-cache\";\nimport { DOMHelper } from \"./views/dom-helper\";\nimport { IdPostprocessor } from \"./views/id-postprocessor\";\nimport { configureCommand, CommandActionHandlerInitializer } from \"./commands/command-registration\";\nimport { CssClassPostprocessor } from \"./views/css-class-postprocessor\";\nimport { SetModelCommand } from \"./features/set-model\";\nimport { UIExtensionRegistry, SetUIExtensionVisibilityCommand } from \"./ui-extensions/ui-extension-registry\";\nimport { DefaultDiagramLocker } from \"./actions/diagram-locker\";\n\nconst defaultContainerModule = new ContainerModule((bind, _unbind, isBound) => {\n    // Logging ---------------------------------------------\n    bind(TYPES.ILogger).to(NullLogger).inSingletonScope();\n    bind(TYPES.LogLevel).toConstantValue(LogLevel.warn);\n\n    // Registries ---------------------------------------------\n    bind(TYPES.SModelRegistry).to(SModelRegistry).inSingletonScope();\n    bind(ActionHandlerRegistry).toSelf().inSingletonScope();\n    bind(TYPES.ActionHandlerRegistryProvider).toProvider<ActionHandlerRegistry>(ctx => {\n        return () => {\n            return new Promise<ActionHandlerRegistry>((resolve) => {\n                resolve(ctx.container.get<ActionHandlerRegistry>(ActionHandlerRegistry));\n            });\n        };\n    });\n    bind(TYPES.ViewRegistry).to(ViewRegistry).inSingletonScope();\n\n    // Model Creation ---------------------------------------------\n    bind(TYPES.IModelFactory).to(SModelFactory).inSingletonScope();\n\n    // Action Dispatcher ---------------------------------------------\n    bind(TYPES.IActionDispatcher).to(ActionDispatcher).inSingletonScope();\n    bind(TYPES.IActionDispatcherProvider).toProvider<IActionDispatcher>(ctx => {\n        return () => {\n            return new Promise<IActionDispatcher>((resolve) => {\n                resolve(ctx.container.get<IActionDispatcher>(TYPES.IActionDispatcher));\n            });\n        };\n    });\n    bind(TYPES.IDiagramLocker).to(DefaultDiagramLocker).inSingletonScope();\n\n    // Action handler\n    bind(TYPES.IActionHandlerInitializer).to(CommandActionHandlerInitializer);\n\n    // Command Stack ---------------------------------------------\n    bind(TYPES.ICommandStack).to(CommandStack).inSingletonScope();\n    bind(TYPES.ICommandStackProvider).toProvider<ICommandStack>(ctx => {\n        return () => {\n            return new Promise<ICommandStack>((resolve) => {\n                resolve(ctx.container.get<ICommandStack>(TYPES.ICommandStack));\n            });\n        };\n    });\n    bind<CommandStackOptions>(TYPES.CommandStackOptions).toConstantValue({\n        defaultDuration: 250,\n        undoHistoryLimit: 50\n    });\n\n    // Viewer ---------------------------------------------\n    bind(ModelViewer).toSelf().inSingletonScope();\n    bind(HiddenModelViewer).toSelf().inSingletonScope();\n    bind(PopupModelViewer).toSelf().inSingletonScope();\n    bind(TYPES.ModelViewer).toDynamicValue(ctx => {\n        const container = ctx.container.createChild();\n        container.bind(TYPES.IViewer).toService(ModelViewer);\n        container.bind(ViewerCache).toSelf();\n        return container.get(ViewerCache);\n    }).inSingletonScope();\n    bind(TYPES.PopupModelViewer).toDynamicValue(ctx => {\n        const container = ctx.container.createChild();\n        container.bind(TYPES.IViewer).toService(PopupModelViewer);\n        container.bind(ViewerCache).toSelf();\n        return container.get(ViewerCache);\n    }).inSingletonScope();\n    bind(TYPES.HiddenModelViewer).toService(HiddenModelViewer);\n    bind(TYPES.IViewerProvider).toDynamicValue(ctx => {\n        return {\n            get modelViewer() {\n                return ctx.container.get<IViewer>(TYPES.ModelViewer);\n            },\n            get hiddenModelViewer() {\n                return ctx.container.get<IViewer>(TYPES.HiddenModelViewer);\n            },\n            get popupModelViewer() {\n                return ctx.container.get<IViewer>(TYPES.PopupModelViewer);\n            }\n        };\n    });\n    bind<ViewerOptions>(TYPES.ViewerOptions).toConstantValue(defaultViewerOptions());\n    bind(TYPES.PatcherProvider).to(PatcherProvider).inSingletonScope();\n    bind(TYPES.DOMHelper).to(DOMHelper).inSingletonScope();\n    bind(TYPES.ModelRendererFactory).toFactory<ModelRenderer>(ctx => {\n        return (targetKind: RenderingTargetKind, processors: IVNodePostprocessor[], args: IViewArgs = {}) => {\n            const viewRegistry = ctx.container.get<ViewRegistry>(TYPES.ViewRegistry);\n            return new ModelRenderer(viewRegistry, targetKind, processors, args);\n        };\n    });\n\n    // Tools & Postprocessors --------------------------------------\n    bind(IdPostprocessor).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(IdPostprocessor);\n    bind(TYPES.HiddenVNodePostprocessor).toService(IdPostprocessor);\n    bind(CssClassPostprocessor).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(CssClassPostprocessor);\n    bind(TYPES.HiddenVNodePostprocessor).toService(CssClassPostprocessor);\n    bind(MouseTool).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(MouseTool);\n    bind(KeyTool).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(KeyTool);\n    bind(FocusFixPostprocessor).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(FocusFixPostprocessor);\n    bind(TYPES.PopupVNodePostprocessor).toService(IdPostprocessor);\n    bind(PopupMouseTool).toSelf().inSingletonScope();\n    bind(TYPES.PopupVNodePostprocessor).toService(PopupMouseTool);\n\n    // Animation Frame Sync ------------------------------------------\n    bind(TYPES.AnimationFrameSyncer).to(AnimationFrameSyncer).inSingletonScope();\n\n    // Canvas Initialization ---------------------------------------------\n    const context = { bind, isBound };\n    configureCommand(context, InitializeCanvasBoundsCommand);\n    bind(CanvasBoundsInitializer).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(CanvasBoundsInitializer);\n\n    // Model commands ---------------------------------------------\n    configureCommand(context, SetModelCommand);\n\n    // UIExtension registry initialization ------------------------------------\n    bind(TYPES.UIExtensionRegistry).to(UIExtensionRegistry).inSingletonScope();\n    configureCommand(context, SetUIExtensionVisibilityCommand);\n\n    // Tracker for last known mouse position on diagram ------------------------\n    bind(MousePositionTracker).toSelf().inSingletonScope();\n    bind(TYPES.MouseListener).toService(MousePositionTracker);\n});\n\nexport default defaultContainerModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Bounds, Dimension, isBounds, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SChildElementImpl, SModelElementImpl, SModelRootImpl, SParentElementImpl } from '../../base/model/smodel';\nimport { findParentByFeature } from '../../base/model/smodel-utils';\nimport { DOMHelper } from '../../base/views/dom-helper';\nimport { ViewerOptions } from '../../base/views/viewer-options';\nimport { getWindowScroll } from '../../utils/browser';\nimport type { Locateable } from '../move/model';\n\nexport const boundsFeature = Symbol('boundsFeature');\nexport const layoutContainerFeature = Symbol('layoutContainerFeature');\nexport const layoutableChildFeature = Symbol('layoutableChildFeature');\nexport const alignFeature = Symbol('alignFeature');\n\n/**\n * Model elements that implement this interface have a position and a size.\n * Note that this definition differs from the one in `sprotty-protocol` because this is\n * used in the _internal model_, while the other is used in the _external model_.\n *\n * Feature extension interface for {@link boundsFeature}.\n */\nexport interface BoundsAware {\n    bounds: Bounds\n}\n\n/**\n * Used to identify model elements that specify a layout to apply to their children.\n */\nexport interface LayoutContainer extends LayoutableChild {\n    layout: string\n}\n\nexport type ModelLayoutOptions = { [key: string]: string | number | boolean };\n\n/**\n * Feature extension interface for {@link layoutableChildFeature}.\n */\nexport interface LayoutableChild extends BoundsAware {\n    layoutOptions?: ModelLayoutOptions\n}\n\n/**\n * Used to adjust elements whose bounding box is not at the origin, e.g.\n * labels, or pre-rendered SVG figures.\n *\n * Feature extension interface for {@link alignFeature}.\n */\nexport interface Alignable {\n    alignment: Point\n}\n\nexport function isBoundsAware(element: SModelElementImpl): element is SModelElementImpl & BoundsAware {\n    return 'bounds' in element;\n}\n\nexport function isLayoutContainer(element: SModelElementImpl): element is SParentElementImpl & LayoutContainer {\n    return isBoundsAware(element)\n        && element.hasFeature(layoutContainerFeature)\n        && 'layout' in element;\n}\n\nexport function isLayoutableChild(element: SModelElementImpl): element is SChildElementImpl & LayoutableChild {\n    return isBoundsAware(element)\n        && element.hasFeature(layoutableChildFeature);\n}\n\nexport function isSizeable(element: SModelElementImpl): element is SModelElementImpl & BoundsAware {\n    return element.hasFeature(boundsFeature) && isBoundsAware(element);\n}\n\nexport function isAlignable(element: SModelElementImpl): element is SModelElementImpl & Alignable {\n    return element.hasFeature(alignFeature)\n        && 'alignment' in element;\n}\n\nexport function getAbsoluteBounds(element: SModelElementImpl): Bounds {\n    const boundsAware = findParentByFeature(element, isBoundsAware);\n    if (boundsAware !== undefined) {\n        let bounds = boundsAware.bounds;\n        let current: SModelElementImpl = boundsAware;\n        while (current instanceof SChildElementImpl) {\n            const parent = current.parent;\n            bounds = parent.localToParent(bounds);\n            current = parent;\n        }\n        return bounds;\n    } else if (element instanceof SModelRootImpl) {\n        const canvasBounds = element.canvasBounds;\n        return { x: 0, y: 0, width: canvasBounds.width, height: canvasBounds.height };\n    } else {\n        return Bounds.EMPTY;\n    }\n}\n\n/**\n * Returns the \"client-absolute\" bounds of the specified `element`.\n *\n * The client-absolute bounds are relative to the entire browser page.\n *\n * @param element The element to get the bounds for.\n * @param domHelper The dom helper to obtain the SVG element's id.\n * @param viewerOptions The viewer options to obtain sprotty's container div id.\n */\nexport function getAbsoluteClientBounds(element: SModelElementImpl, domHelper: DOMHelper, viewerOptions: ViewerOptions): Bounds {\n    let x = 0;\n    let y = 0;\n    let width = 0;\n    let height = 0;\n\n    const svgElementId = domHelper.createUniqueDOMElementId(element);\n    const svgElement = document.getElementById(svgElementId);\n    if (svgElement) {\n        const rect = svgElement.getBoundingClientRect();\n        const scroll = getWindowScroll();\n        x = rect.left + scroll.x;\n        y = rect.top + scroll.y;\n        width = rect.width;\n        height = rect.height;\n    }\n\n    let container = document.getElementById(viewerOptions.baseDiv);\n    if (container) {\n        while (container.offsetParent instanceof HTMLElement\n            && (container = <HTMLElement>container.offsetParent)) {\n            x -= container.offsetLeft;\n            y -= container.offsetTop;\n        }\n    }\n\n    return { x, y, width, height };\n}\n\nexport function findChildrenAtPosition(parent: SParentElementImpl, point: Point): SModelElementImpl[] {\n    const matches: SModelElementImpl[] = [];\n    doFindChildrenAtPosition(parent, point, matches);\n    return matches;\n}\n\nfunction doFindChildrenAtPosition(parent: SParentElementImpl, point: Point, matches: SModelElementImpl[]) {\n    parent.children.forEach(child => {\n        if (isBoundsAware(child) && Bounds.includes(child.bounds, point))\n            matches.push(child);\n        if (child instanceof SParentElementImpl) {\n            const newPoint = child.parentToLocal(point);\n            doFindChildrenAtPosition(child, newPoint, matches);\n        }\n    });\n}\n\n/**\n * Abstract class for elements with a position and a size.\n */\nexport abstract class SShapeElementImpl extends SChildElementImpl implements BoundsAware, Locateable, LayoutableChild {\n\n    position: Point = Point.ORIGIN;\n    size: Dimension = Dimension.EMPTY;\n    layoutOptions?: ModelLayoutOptions;\n\n    get bounds(): Bounds {\n        return {\n            x: this.position.x,\n            y: this.position.y,\n            width: this.size.width,\n            height: this.size.height\n        };\n    }\n\n    set bounds(newBounds: Bounds) {\n        this.position = {\n            x: newBounds.x,\n            y: newBounds.y\n        };\n        this.size = {\n            width: newBounds.width,\n            height: newBounds.height\n        };\n    }\n\n    override localToParent(point: Point | Bounds): Bounds {\n        const result = {\n            x: point.x + this.position.x,\n            y: point.y + this.position.y,\n            width: -1,\n            height: -1\n        };\n        if (isBounds(point)) {\n            result.width = point.width;\n            result.height = point.height;\n        }\n        return result;\n    }\n\n    override parentToLocal(point: Point | Bounds): Bounds {\n        const result = {\n            x: point.x - this.position.x,\n            y: point.y - this.position.y,\n            width: -1,\n            height: -1\n        };\n        if (isBounds(point)) {\n            result.width = point.width;\n            result.height = point.height;\n        }\n        return result;\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { Action, ComputedBoundsAction, RequestBoundsAction, SetBoundsAction } from 'sprotty-protocol/lib/actions';\nimport { Bounds, Dimension, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { CommandExecutionContext, CommandResult, CommandReturn, HiddenCommand, SystemCommand } from '../../base/commands/command';\nimport { SModelElementImpl } from '../../base/model/smodel';\nimport { TYPES } from '../../base/types';\nimport { Alignable, BoundsAware, isBoundsAware } from './model';\n\nexport interface ResolvedElementAndBounds {\n    element: SModelElementImpl & BoundsAware\n    oldBounds: Bounds\n    newPosition?: Point\n    newSize: Dimension\n}\n\nexport interface ResolvedElementAndAlignment {\n    element: SModelElementImpl & Alignable\n    oldAlignment: Point\n    newAlignment: Point\n}\n\n@injectable()\nexport class SetBoundsCommand extends SystemCommand {\n    static readonly KIND: string = SetBoundsAction.KIND;\n\n    protected bounds: ResolvedElementAndBounds[] = [];\n\n    constructor(@inject(TYPES.Action) protected readonly action: SetBoundsAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        this.action.bounds.forEach(\n            b => {\n                const element = context.root.index.getById(b.elementId);\n                if (element && isBoundsAware(element)) {\n                    this.bounds.push({\n                        element: element,\n                        oldBounds: element.bounds,\n                        newPosition: b.newPosition,\n                        newSize: b.newSize\n                    });\n                }\n            }\n        );\n        return this.redo(context);\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        this.bounds.forEach(\n            b => b.element.bounds = b.oldBounds\n        );\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        this.bounds.forEach(\n            b => {\n                if (b.newPosition)\n                    b.element.bounds = {\n                        ...b.newPosition,\n                        ...b.newSize,\n                    };\n                else\n                    // keep the position\n                    b.element.bounds = {\n                        x: b.element.bounds.x,\n                        y: b.element.bounds.y,\n                        ...b.newSize\n                    };\n            }\n        );\n        return context.root;\n    }\n}\n\n@injectable()\nexport class RequestBoundsCommand extends HiddenCommand {\n    static readonly KIND: string = RequestBoundsAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: RequestBoundsAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandResult {\n        return {\n            model: context.modelFactory.createRoot(this.action.newRoot),\n            modelChanged: true,\n            cause: this.action\n        };\n    }\n\n    get blockUntil(): (action: Action) => boolean {\n        return action => action.kind === ComputedBoundsAction.KIND;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, interfaces, multiInject, optional } from \"inversify\";\nimport { Bounds } from \"sprotty-protocol/lib/utils/geometry\";\nimport { TYPES } from \"../../base/types\";\nimport { ILogger } from '../../utils/logging';\nimport { InstanceRegistry } from \"../../utils/registry\";\nimport { SParentElementImpl, SModelElementImpl } from \"../../base/model/smodel\";\nimport { isLayoutContainer, LayoutContainer } from \"./model\";\nimport { BoundsData } from \"./hidden-bounds-updater\";\nimport { isInjectable } from \"../../utils/inversify\";\n\n@injectable()\nexport class LayoutRegistry extends InstanceRegistry<ILayout> {\n\n    @inject(TYPES.ILogger) logger: ILogger;\n\n    constructor(@multiInject(TYPES.LayoutRegistration) @optional() layouts: (LayoutRegistration)[] = []) {\n        super();\n        layouts.forEach(layout => {\n            if (this.hasKey(layout.layoutKind)) {\n                this.logger.warn('Layout kind is already defined: ', layout.layoutKind);\n            } else {\n                this.register(layout.layoutKind, layout.factory());\n            }\n        });\n    }\n}\n\nexport interface LayoutRegistration {\n    layoutKind: string;\n    factory: () => ILayout;\n}\n\n@injectable()\nexport class Layouter {\n\n    @inject(TYPES.LayoutRegistry) protected layoutRegistry: LayoutRegistry;\n    @inject(TYPES.ILogger) protected logger: ILogger;\n\n    layout(element2boundsData: Map<SModelElementImpl\u200B\u200B , BoundsData>) {\n        new StatefulLayouter(element2boundsData, this.layoutRegistry, this.logger).layout();\n    }\n}\n\nexport class StatefulLayouter {\n\n    private toBeLayouted: (SParentElementImpl & LayoutContainer)[];\n\n    constructor(private readonly element2boundsData: Map<SModelElementImpl\u200B\u200B , BoundsData>,\n                private readonly layoutRegistry: LayoutRegistry,\n                public readonly log: ILogger) {\n        this.toBeLayouted = [];\n        element2boundsData.forEach(\n            (data, element) => {\n                if (isLayoutContainer(element))\n                    this.toBeLayouted.push(element);\n            });\n    }\n\n    getBoundsData(element: SModelElementImpl): BoundsData {\n        let boundsData = this.element2boundsData.get(element);\n        let bounds = (element as any).bounds;\n        if (isLayoutContainer(element) && this.toBeLayouted.indexOf(element) >= 0) {\n            bounds = this.doLayout(element);\n        }\n        if (!boundsData) {\n            boundsData = {\n                bounds: bounds,\n                boundsChanged: false,\n                alignmentChanged: false\n            };\n            this.element2boundsData.set(element, boundsData);\n        }\n        return boundsData;\n    }\n\n    layout(): void {\n        while (this.toBeLayouted.length > 0) {\n            const element = this.toBeLayouted[0];\n            this.doLayout(element);\n        }\n    }\n\n    protected doLayout(element: SParentElementImpl & LayoutContainer): Bounds {\n        const index = this.toBeLayouted.indexOf(element);\n        if (index >= 0)\n            this.toBeLayouted.splice(index, 1);\n        const layout = this.layoutRegistry.get(element.layout);\n        if (layout)\n            layout.layout(element, this);\n        const boundsData = this.element2boundsData.get(element);\n        if (boundsData !== undefined && boundsData.bounds !== undefined) {\n            return boundsData.bounds;\n        } else {\n            this.log.error(element, 'Layout failed');\n            return Bounds.EMPTY;\n        }\n    }\n}\n\nexport interface ILayout {\n    layout(container: SParentElementImpl & LayoutContainer,\n           layouter: StatefulLayouter): void\n}\n\n\nexport function configureLayout(context: { bind: interfaces.Bind, isBound: interfaces.IsBound },\n    kind: string, constr: interfaces.ServiceIdentifier<ILayout>) {\n\n    if (typeof constr === 'function') {\n        if (!isInjectable(constr)) {\n            throw new Error(`Layouts be @injectable: ${constr.name}`);\n        }\n        if (!context.isBound(constr)) {\n            context.bind(constr).toSelf();\n        }\n    }\n    context.bind(TYPES.LayoutRegistration).toDynamicValue(ctx => ({\n        layoutKind: kind,\n        factory: () => ctx.container.get(constr)\n    }));\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { Action, ComputedBoundsAction, ElementAndAlignment, ElementAndBounds, RequestBoundsAction } from 'sprotty-protocol/lib/actions';\nimport { almostEquals, Bounds, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { isSVGGraphicsElement } from '../../utils/browser';\nimport { ILogger } from '../../utils/logging';\nimport { IActionDispatcher } from '../../base/actions/action-dispatcher';\nimport { SChildElementImpl, SModelElementImpl, SModelRootImpl } from '../../base/model/smodel';\nimport { TYPES } from '../../base/types';\nimport { IVNodePostprocessor } from '../../base/views/vnode-postprocessor';\nimport { Layouter } from './layout';\nimport { BoundsAware, isAlignable, isLayoutContainer, isSizeable } from './model';\n\nexport class BoundsData {\n    vnode?: VNode;\n    bounds?: Bounds;\n    alignment?: Point;\n    boundsChanged: boolean;\n    alignmentChanged: boolean;\n}\n\n/**\n * Grabs the bounds from hidden SVG DOM elements, applies layouts and fires\n * ComputedBoundsActions.\n *\n * The actual bounds of an element can usually not be determined from the SModel\n * as they depend on the view implementation and CSS stylings. So the best way is\n * to grab them from a live (but hidden) SVG using getBBox().\n *\n * If an element is Alignable, and the top-left corner of its bounding box is not\n * the origin, we also issue a realign with the ComputedBoundsAction.\n */\n@injectable()\nexport class HiddenBoundsUpdater implements IVNodePostprocessor {\n\n    @inject(TYPES.ILogger) protected logger: ILogger;\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: IActionDispatcher;\n    @inject(TYPES.Layouter) protected layouter: Layouter;\n\n    private readonly element2boundsData: Map<SModelElementImpl & BoundsAware, BoundsData> = new Map;\n\n    root: SModelRootImpl | undefined;\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        if (isSizeable(element) || isLayoutContainer(element)) {\n            this.element2boundsData.set(element, {\n                vnode: vnode,\n                bounds: element.bounds,\n                boundsChanged: false,\n                alignmentChanged: false\n            });\n        }\n        if (element instanceof SModelRootImpl) {\n            this.root = element;\n        }\n        return vnode;\n    }\n\n    postUpdate(cause?: Action) {\n        if (cause === undefined || cause.kind !== RequestBoundsAction.KIND) {\n            return;\n        }\n        const request = cause as RequestBoundsAction;\n        this.getBoundsFromDOM();\n        this.layouter.layout(this.element2boundsData);\n        const resizes: ElementAndBounds[] = [];\n        const alignments: ElementAndAlignment[] = [];\n        this.element2boundsData.forEach(\n            (boundsData, element) => {\n                if (boundsData.boundsChanged && boundsData.bounds !== undefined) {\n                    const resize: ElementAndBounds = {\n                        elementId: element.id,\n                        newSize: {\n                            width: boundsData.bounds.width,\n                            height: boundsData.bounds.height\n                        }\n                    };\n                    // don't copy position if the element is layouted by the server\n                    if (element instanceof SChildElementImpl && isLayoutContainer(element.parent)) {\n                        resize.newPosition = {\n                            x: boundsData.bounds.x,\n                            y: boundsData.bounds.y,\n                        };\n                    }\n                    resizes.push(resize);\n                }\n                if (boundsData.alignmentChanged && boundsData.alignment !== undefined) {\n                    alignments.push({\n                        elementId: element.id,\n                        newAlignment: boundsData.alignment\n                    });\n                }\n            });\n        const revision = (this.root !== undefined) ? this.root.revision : undefined;\n        this.actionDispatcher.dispatch(ComputedBoundsAction.create(resizes, { revision, alignments, requestId: request.requestId }));\n        this.element2boundsData.clear();\n    }\n\n    protected getBoundsFromDOM() {\n        this.element2boundsData.forEach(\n            (boundsData, element) => {\n                if (boundsData.bounds && isSizeable(element)) {\n                    const vnode = boundsData.vnode;\n                    if (vnode && vnode.elm) {\n                        const boundingBox = this.getBounds(vnode.elm, element);\n                        if (isAlignable(element) && !(\n                            almostEquals(boundingBox.x, 0) && almostEquals(boundingBox.y, 0)\n                        )) {\n                            boundsData.alignment = {\n                                x: -boundingBox.x,\n                                y: -boundingBox.y\n                            };\n                            boundsData.alignmentChanged = true;\n                        }\n                        const newBounds = {\n                            x: element.bounds.x,\n                            y: element.bounds.y,\n                            width: boundingBox.width,\n                            height: boundingBox.height\n                        };\n                        if (!(almostEquals(newBounds.x, element.bounds.x)\n                            && almostEquals(newBounds.y, element.bounds.y)\n                            && almostEquals(newBounds.width, element.bounds.width)\n                            && almostEquals(newBounds.height, element.bounds.height))) {\n                            boundsData.bounds = newBounds;\n                            boundsData.boundsChanged = true;\n                        }\n                    }\n                }\n            }\n        );\n    }\n\n    /**\n     * Compute the bounds of the given DOM element. Override this method to customize how\n     * the bounding box of a rendered view is determined.\n     *\n     * In case your Sprotty model element contains children that are rendered outside of\n     * their parent, you can add the `ATTR_BBOX_ELEMENT` attribute to the SVG element\n     * that shall be used to compute the bounding box.\n     */\n    protected getBounds(elm: Node, element: SModelElementImpl & BoundsAware): Bounds {\n        if (!isSVGGraphicsElement(elm)) {\n            this.logger.error(this, 'Not an SVG element:', elm);\n            return Bounds.EMPTY;\n        }\n        if (elm.tagName === 'g') {\n            for (const child of Array.from(elm.children)) {\n                if (child.getAttribute(ATTR_BBOX_ELEMENT) !== null) {\n                    return this.getBounds(child, element);\n                }\n            }\n        }\n        const bounds = elm.getBBox();\n        return {\n            x: bounds.x,\n            y: bounds.y,\n            width: bounds.width,\n            height: bounds.height\n        };\n    }\n}\n\n/**\n * Attribute name identifying the SVG element that determines the bounding box of a rendered view.\n * This can be used when a view creates a group of which only a part should contribute to the\n * bounding box computed by `HiddenBoundsUpdater`.\n */\nexport const ATTR_BBOX_ELEMENT = 'bboxElement';\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Bounds, Dimension, Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { SParentElementImpl, SModelElementImpl, SChildElementImpl } from \"../../base/model/smodel\";\nimport { isLayoutContainer, isLayoutableChild, LayoutContainer, isBoundsAware } from \"./model\";\nimport { ILayout, StatefulLayouter } from './layout';\nimport { AbstractLayoutOptions, HAlignment, VAlignment } from './layout-options';\nimport { BoundsData } from './hidden-bounds-updater';\nimport { injectable } from \"inversify\";\n\n@injectable()\nexport abstract class AbstractLayout<T extends AbstractLayoutOptions> implements ILayout {\n\n    layout(container: SParentElementImpl & LayoutContainer,\n           layouter: StatefulLayouter) {\n        const boundsData = layouter.getBoundsData(container);\n        const options = this.getLayoutOptions(container);\n        const childrenSize = this.getChildrenSize(container, options, layouter);\n        const maxWidth = options.paddingFactor * (\n            options.resizeContainer\n            ? childrenSize.width\n            : Math.max(0, this.getFixedContainerBounds(container, options, layouter).width) - options.paddingLeft - options.paddingRight);\n        const maxHeight =  options.paddingFactor * (\n            options.resizeContainer\n            ? childrenSize.height\n            : Math.max(0, this.getFixedContainerBounds(container, options, layouter).height) - options.paddingTop - options.paddingBottom);\n        if (maxWidth > 0 && maxHeight > 0) {\n            const offset = this.layoutChildren(container, layouter, options, maxWidth, maxHeight);\n            boundsData.bounds = this.getFinalContainerBounds(container, offset, options, maxWidth, maxHeight);\n            boundsData.boundsChanged = true;\n        }\n    }\n    protected abstract layoutChild(child: SChildElementImpl,\n                                boundsData: BoundsData, bounds: Bounds,\n                                childOptions: T, containerOptions: T,\n                                currentOffset: Point,\n                                maxWidth: number, maxHeight: number): Point;\n\n    protected getFinalContainerBounds(container: SParentElementImpl & LayoutContainer,\n                                    lastOffset: Point,\n                                    options: T,\n                                    maxWidth: number,\n                                    maxHeight: number): Bounds {\n        return {\n            x: container.bounds.x,\n            y: container.bounds.y,\n            width: Math.max(options.minWidth, maxWidth + options.paddingLeft + options.paddingRight),\n            height: Math.max(options.minHeight, maxHeight + options.paddingTop + options.paddingBottom)\n        };\n    }\n\n    protected getFixedContainerBounds(\n            container: SModelElementImpl,\n            layoutOptions: T,\n            layouter: StatefulLayouter): Bounds {\n        let currentContainer = container;\n        while (true) {\n            if (isBoundsAware(currentContainer)) {\n                const bounds = currentContainer.bounds;\n                if (isLayoutContainer(currentContainer) && layoutOptions.resizeContainer)\n                    layouter.log.error(currentContainer, 'Resizable container found while detecting fixed bounds');\n                if (Dimension.isValid(bounds))\n                    return bounds;\n            }\n            if (currentContainer instanceof SChildElementImpl) {\n                currentContainer = currentContainer.parent;\n            } else {\n                layouter.log.error(currentContainer, 'Cannot detect fixed bounds');\n                return Bounds.EMPTY;\n            }\n        }\n    }\n\n    protected abstract getChildrenSize(container: SParentElementImpl & LayoutContainer,\n                               containerOptions: T,\n                               layouter: StatefulLayouter): Dimension;\n\n    protected layoutChildren(container: SParentElementImpl & LayoutContainer,\n                            layouter: StatefulLayouter,\n                            containerOptions: T,\n                            maxWidth: number,\n                            maxHeight: number): Point {\n        let currentOffset: Point = {\n            x: containerOptions.paddingLeft + 0.5 * (maxWidth - (maxWidth / containerOptions.paddingFactor)),\n            y: containerOptions.paddingTop + 0.5 * (maxHeight - (maxHeight / containerOptions.paddingFactor))};\n        container.children.forEach(\n            child => {\n                if (isLayoutableChild(child)) {\n                    const boundsData = layouter.getBoundsData(child);\n                    const bounds = boundsData.bounds;\n                    const childOptions = this.getChildLayoutOptions(child, containerOptions);\n                    if (bounds !== undefined && Dimension.isValid(bounds)) {\n                        currentOffset = this.layoutChild(child, boundsData, bounds,\n                            childOptions, containerOptions, currentOffset,\n                            maxWidth, maxHeight);\n                    }\n                }\n            }\n        );\n        return currentOffset;\n    }\n\n    protected getDx(hAlign: HAlignment, bounds: Bounds, maxWidth: number): number {\n        switch (hAlign) {\n            case 'left':\n                return 0;\n            case 'center':\n                return 0.5 * (maxWidth - bounds.width);\n            case 'right':\n                return maxWidth - bounds.width;\n        }\n    }\n\n    protected getDy(vAlign: VAlignment, bounds: Bounds, maxHeight: number): number {\n        switch (vAlign) {\n            case 'top':\n                return 0;\n            case 'center':\n                return 0.5 * (maxHeight - bounds.height);\n            case 'bottom':\n                return maxHeight - bounds.height;\n        }\n    }\n\n    protected getChildLayoutOptions(child: SChildElementImpl, containerOptions: T): T {\n        const layoutOptions = (child as any).layoutOptions;\n        if (layoutOptions === undefined)\n            return containerOptions;\n        else\n            return this.spread(containerOptions, layoutOptions);\n    }\n\n    protected getLayoutOptions(element: SModelElementImpl): T {\n        let current = element;\n        const allOptions: T[] = [];\n        while (current !== undefined) {\n            const layoutOptions = (current as any).layoutOptions;\n            if (layoutOptions !== undefined)\n                allOptions.push(layoutOptions);\n            if (current instanceof SChildElementImpl)\n                current = current.parent;\n            else\n                break;\n        }\n        return allOptions.reverse().reduce(\n            (a, b) => { return this.spread(a, b); }, this.getDefaultLayoutOptions());\n    }\n\n    protected abstract getDefaultLayoutOptions(): T;\n\n    protected abstract spread(a: T, b: T): T;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { Bounds, Dimension, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SParentElementImpl, SChildElementImpl } from \"../../base/model/smodel\";\nimport { AbstractLayout } from './abstract-layout';\nimport { AbstractLayoutOptions, HAlignment } from './layout-options';\nimport { BoundsData } from './hidden-bounds-updater';\nimport { LayoutContainer, isLayoutableChild } from './model';\nimport { StatefulLayouter } from './layout';\n\nexport interface VBoxLayoutOptions extends AbstractLayoutOptions {\n    vGap: number\n    hAlign: HAlignment\n}\n\n/**\n * Layouts children of a container in vertical (top->bottom) direction.\n */\n@injectable()\nexport class VBoxLayouter extends AbstractLayout<VBoxLayoutOptions> {\n\n    static KIND = 'vbox';\n\n    protected getChildrenSize(container: SParentElementImpl & LayoutContainer,\n                               containerOptions: VBoxLayoutOptions,\n                               layouter: StatefulLayouter) {\n        let maxWidth = -1;\n        let maxHeight = 0;\n        let isFirst = true;\n        container.children.forEach(\n            child => {\n                if (isLayoutableChild(child)) {\n                    const bounds = layouter.getBoundsData(child).bounds;\n                    if (bounds !== undefined && Dimension.isValid(bounds)) {\n                        maxHeight += bounds.height;\n                        if (isFirst)\n                            isFirst = false;\n                        else\n                            maxHeight += containerOptions.vGap;\n                        maxWidth = Math.max(maxWidth, bounds.width);\n                    }\n                }\n            }\n        );\n        return {\n            width: maxWidth,\n            height: maxHeight\n        };\n    }\n\n    protected layoutChild(child: SChildElementImpl,\n                        boundsData: BoundsData,\n                        bounds: Bounds,\n                        childOptions: VBoxLayoutOptions,\n                        containerOptions: VBoxLayoutOptions,\n                        currentOffset: Point,\n                        maxWidth: number,\n                        maxHeight: number) {\n        const dx = this.getDx(childOptions.hAlign, bounds, maxWidth);\n        boundsData.bounds = {\n            x: containerOptions.paddingLeft + (child as any).bounds.x - bounds.x + dx,\n            y: currentOffset.y + (child as any).bounds.y - bounds.y,\n            width: bounds.width,\n            height: bounds.height\n        };\n        boundsData.boundsChanged = true;\n        return {\n            x: currentOffset.x,\n            y: currentOffset.y + bounds.height + containerOptions.vGap\n        };\n    }\n\n    protected getDefaultLayoutOptions(): VBoxLayoutOptions {\n        return {\n            resizeContainer: true,\n            paddingTop: 5,\n            paddingBottom: 5,\n            paddingLeft: 5,\n            paddingRight: 5,\n            paddingFactor: 1,\n            vGap: 1,\n            hAlign: 'center',\n            minWidth: 0,\n            minHeight: 0\n        };\n    }\n\n    protected spread(a: VBoxLayoutOptions, b: VBoxLayoutOptions): VBoxLayoutOptions {\n        return { ...a, ...b };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { Bounds, Dimension, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SParentElementImpl, SChildElementImpl } from \"../../base/model/smodel\";\nimport { AbstractLayout } from './abstract-layout';\nimport { AbstractLayoutOptions, VAlignment } from './layout-options';\nimport { BoundsData } from './hidden-bounds-updater';\nimport { LayoutContainer, isLayoutableChild } from './model';\nimport { StatefulLayouter } from './layout';\n\nexport interface HBoxLayoutOptions extends AbstractLayoutOptions {\n    hGap: number\n    vAlign: VAlignment\n}\n\n/**\n * Layouts children of a container in horizontal (left->right) direction.\n */\n@injectable()\nexport class HBoxLayouter extends AbstractLayout<HBoxLayoutOptions> {\n\n    static KIND = 'hbox';\n\n    protected getChildrenSize(container: SParentElementImpl & LayoutContainer,\n                               containerOptions: HBoxLayoutOptions,\n                               layouter: StatefulLayouter) {\n        let maxWidth = 0;\n        let maxHeight = -1;\n        let isFirst = true;\n        container.children.forEach(\n            child => {\n                if (isLayoutableChild(child)) {\n                    const bounds = layouter.getBoundsData(child).bounds;\n                    if (bounds !== undefined && Dimension.isValid(bounds)) {\n                        if (isFirst)\n                            isFirst = false;\n                        else\n                            maxWidth += containerOptions.hGap;\n                        maxWidth += bounds.width;\n                        maxHeight = Math.max(maxHeight, bounds.height);\n                    }\n                }\n            }\n        );\n        return {\n            width: maxWidth,\n            height: maxHeight\n        };\n    }\n\n    protected layoutChild(child: SChildElementImpl,\n                        boundsData: BoundsData,\n                        bounds: Bounds,\n                        childOptions: HBoxLayoutOptions,\n                        containerOptions: HBoxLayoutOptions,\n                        currentOffset: Point,\n                        maxWidth: number,\n                        maxHeight: number): Point {\n        const dy = this.getDy(childOptions.vAlign, bounds, maxHeight);\n        boundsData.bounds = {\n            x: currentOffset.x + (child as any).bounds.x - bounds.x,\n            y: containerOptions.paddingTop + (child as any).bounds.y - bounds.y + dy,\n            width: bounds.width,\n            height: bounds.height\n        };\n        boundsData.boundsChanged = true;\n        return {\n            x: currentOffset.x + bounds.width + containerOptions.hGap,\n            y: currentOffset.y\n        };\n    }\n\n    protected getDefaultLayoutOptions(): HBoxLayoutOptions {\n        return {\n            resizeContainer: true,\n            paddingTop: 5,\n            paddingBottom: 5,\n            paddingLeft: 5,\n            paddingRight: 5,\n            paddingFactor: 1,\n            hGap: 1,\n            vAlign: 'center',\n            minWidth: 0,\n            minHeight: 0\n        };\n    }\n\n    protected spread(a: HBoxLayoutOptions, b: HBoxLayoutOptions): HBoxLayoutOptions {\n        return { ...a, ...b };\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { Bounds, Dimension, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SParentElementImpl, SChildElementImpl } from \"../../base/model/smodel\";\nimport { AbstractLayout } from './abstract-layout';\nimport { AbstractLayoutOptions, HAlignment, VAlignment } from './layout-options';\nimport { BoundsData } from './hidden-bounds-updater';\nimport { LayoutContainer, isLayoutableChild } from './model';\nimport { StatefulLayouter } from './layout';\n\nexport interface StackLayoutOptions extends AbstractLayoutOptions {\n    paddingFactor: number\n    vAlign: VAlignment\n    hAlign: HAlignment\n}\n\n@injectable()\nexport class StackLayouter extends AbstractLayout<StackLayoutOptions> {\n\n    static KIND = 'stack';\n\n    protected getChildrenSize(container: SParentElementImpl & LayoutContainer,\n                            options: StackLayoutOptions,\n                            layouter: StatefulLayouter) {\n        let maxWidth = -1;\n        let maxHeight = -1;\n        container.children.forEach(\n            child => {\n                if (isLayoutableChild(child)) {\n                    const bounds = layouter.getBoundsData(child).bounds;\n                    if (bounds !== undefined && Dimension.isValid(bounds)) {\n                        maxWidth = Math.max(maxWidth, bounds.width);\n                        maxHeight = Math.max(maxHeight, bounds.height);\n                    }\n                }\n            }\n        );\n        return {\n            width: maxWidth,\n            height: maxHeight\n        };\n    }\n\n    protected layoutChild(child: SChildElementImpl,\n                        boundsData: BoundsData,\n                        bounds: Bounds,\n                        childOptions: StackLayoutOptions,\n                        containerOptions: StackLayoutOptions,\n                        currentOffset: Point,\n                        maxWidth: number, maxHeight: number): Point {\n        const dx = this.getDx(childOptions.hAlign, bounds, maxWidth);\n        const dy = this.getDy(childOptions.vAlign, bounds, maxHeight);\n        boundsData.bounds = {\n            x: containerOptions.paddingLeft + (child as any).bounds.x - bounds.x + dx,\n            y: containerOptions.paddingTop + (child as any).bounds.y - bounds.y + dy,\n            width: bounds.width,\n            height: bounds.height\n        };\n        boundsData.boundsChanged = true;\n        return currentOffset;\n    }\n\n    protected getDefaultLayoutOptions(): StackLayoutOptions {\n        return {\n            resizeContainer: true,\n            paddingTop: 5,\n            paddingBottom: 5,\n            paddingLeft: 5,\n            paddingRight: 5,\n            paddingFactor: 1,\n            hAlign: 'center',\n            vAlign: 'center',\n            minWidth: 0,\n            minHeight: 0\n        };\n    }\n\n    protected spread(a: StackLayoutOptions, b: StackLayoutOptions): StackLayoutOptions {\n        return { ...a, ...b };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { Dimension } from 'sprotty-protocol/lib/utils/geometry';\nimport { IViewArgs, IView, RenderingContext } from '../../base/views/view';\nimport { getAbsoluteBounds, BoundsAware } from './model';\nimport { SChildElementImpl } from '../../base/model/smodel';\n\n@injectable()\nexport abstract class ShapeView implements IView {\n\n    /**\n     * Check whether the given model element is in the current viewport. Use this method\n     * in your `render` implementation to skip rendering in case the element is not visible.\n     * This can greatly enhance performance for large models.\n     */\n    isVisible(model: Readonly<SChildElementImpl & BoundsAware>, context: RenderingContext): boolean {\n        if (context.targetKind === 'hidden') {\n            // Don't hide any element for hidden rendering\n            return true;\n        }\n        if (!Dimension.isValid(model.bounds)) {\n            // We should hide only if we know the element's bounds\n            return true;\n        }\n        const ab = getAbsoluteBounds(model);\n        const canvasBounds = model.root.canvasBounds;\n        return ab.x <= canvasBounds.width\n            && ab.x + ab.width >= 0\n            && ab.y <= canvasBounds.height\n            && ab.y + ab.height >= 0;\n    }\n\n    abstract render(model: Readonly<SChildElementImpl>, context: RenderingContext, args?: IViewArgs): VNode | undefined;\n\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, interfaces, multiInject, optional } from 'inversify';\nimport { Action } from 'sprotty-protocol/lib/actions';\nimport { InstanceRegistry } from '../../utils/registry';\nimport { TYPES } from '../../base/types';\nimport { SButtonImpl } from './model';\nimport { isInjectable } from '../../utils/inversify';\n\nexport interface IButtonHandler {\n    buttonPressed(button: SButtonImpl): (Action | Promise<Action>)[]\n}\n\nexport interface IButtonHandlerRegistration {\n    TYPE: string\n    factory: () => IButtonHandler\n}\n\n@injectable()\nexport class ButtonHandlerRegistry extends InstanceRegistry<IButtonHandler> {\n\n    constructor(\n        @multiInject(TYPES.IButtonHandlerRegistration)@optional() buttonHandlerRegistrations: IButtonHandlerRegistration[]) {\n        super();\n        buttonHandlerRegistrations.forEach(factory => this.register(factory.TYPE, factory.factory()));\n    }\n}\n\n/**\n * Utility function to register a button handler for an button type.\n */\nexport function configureButtonHandler(context: { bind: interfaces.Bind, isBound: interfaces.IsBound },\n    type: string, constr: interfaces.ServiceIdentifier<IButtonHandler>): void {\n    if (typeof constr === 'function') {\n        if (!isInjectable(constr)) {\n            throw new Error(`Button handlers should be @injectable: ${constr.name}`);\n        }\n        if (!context.isBound(constr)) {\n            context.bind(constr).toSelf();\n        }\n    }\n    context.bind(TYPES.IButtonHandlerRegistration).toDynamicValue(ctx => ({\n        TYPE: type,\n        factory: () => ctx.container.get(constr)\n    }));\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElementImpl } from '../../base/model/smodel';\n\nexport const fadeFeature = Symbol('fadeFeature');\n\n/**\n* Feature extension interface for {@link fadeFeature}.\n */\nexport interface Fadeable {\n    opacity: number\n}\n\nexport function isFadeable(element: SModelElementImpl): element is SModelElementImpl & Fadeable {\n    return element.hasFeature(fadeFeature) && (element as any)['opacity'] !== undefined;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SShapeElement } from 'sprotty-protocol';\nimport { boundsFeature, layoutableChildFeature, SShapeElementImpl } from '../bounds/model';\nimport { fadeFeature } from '../fade/model';\n\nexport interface SButtonSchema extends SShapeElement {\n    pressed: boolean\n    enabled: boolean\n}\n\nexport class SButtonImpl extends SShapeElementImpl {\n    static readonly DEFAULT_FEATURES = [boundsFeature, layoutableChildFeature, fadeFeature];\n\n    enabled = true;\n}\n", "/********************************************************************************\n * Copyright (c) 2019 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElementImpl } from '../../base/model/smodel';\n\nexport const nameFeature = Symbol('nameableFeature');\n\n/**\n * Feature extension interface for {@link nameableFeature}.\n */\nexport interface Nameable {\n    name: string\n}\n\nexport function isNameable(element: SModelElementImpl): element is SModelElementImpl & Nameable {\n    return element.hasFeature(nameFeature);\n}\n\nexport function name(element: SModelElementImpl): string | undefined {\n    if (isNameable(element)) {\n        return element.name;\n    } else {\n        return undefined;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, multiInject, optional } from \"inversify\";\nimport { CenterAction, SelectAction, SelectAllAction } from \"sprotty-protocol/lib/actions\";\nimport { Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { LabeledAction } from \"../../base/actions/action\";\nimport { SModelRootImpl } from \"../../base/model/smodel\";\nimport { TYPES } from \"../../base/types\";\nimport { toArray } from \"../../utils/iterable\";\nimport { ILogger } from \"../../utils/logging\";\nimport { isNameable, name } from \"../nameable/model\";\n\nexport interface ICommandPaletteActionProvider {\n    getActions(root: Readonly<SModelRootImpl>, text: string, lastMousePosition?: Point, index?: number): Promise<LabeledAction[]>;\n}\n\n@injectable()\nexport class CommandPaletteActionProviderRegistry implements ICommandPaletteActionProvider {\n\n    constructor(@multiInject(TYPES.ICommandPaletteActionProvider) @optional() protected actionProviders: ICommandPaletteActionProvider[] = []) {\n    }\n\n    getActions(root: Readonly<SModelRootImpl>, text: string, lastMousePosition?: Point, index?: number) {\n        const actionLists = this.actionProviders.map(provider => provider.getActions(root, text, lastMousePosition, index));\n        return Promise.all(actionLists).then(p => p.reduce((acc, promise) => promise !== undefined ? acc.concat(promise) : acc));\n    }\n}\n\n@injectable()\nexport class RevealNamedElementActionProvider implements ICommandPaletteActionProvider {\n\n    constructor(@inject(TYPES.ILogger) protected logger: ILogger) { }\n\n    getActions(root: Readonly<SModelRootImpl>, text: string, lastMousePosition?: Point, index?: number) {\n        if (index !== undefined && index % 2 === 0)\n            return Promise.resolve(this.createSelectActions(root));\n        else\n            return Promise.resolve([new LabeledAction(\"Select all\", [SelectAllAction.create()])]);\n    }\n\n    createSelectActions(modelRoot: SModelRootImpl): LabeledAction[] {\n        const nameables = toArray(modelRoot.index.all().filter(element => isNameable(element)));\n        return nameables.map(nameable => new LabeledAction(`Reveal ${name(nameable)}`,\n            [SelectAction.create({ selectedElementsIDs: [nameable.id] }), CenterAction.create([nameable.id])], 'eye'));\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport const ACTION_ITEM = 'action-item';\nexport const ANIMATION_SPIN = 'animation-spin';\n\nexport function codiconCSSString(codiconId: string, actionItem = false, animationSpin = false, additionalCSS: string[] = []): string {\n    return codiconCSSClasses(codiconId, actionItem, animationSpin, additionalCSS).join(' ');\n}\n\nexport function codiconCSSClasses(codiconId: string, actionItem = false, animationSpin = false, additionalCSS: string[] = []): string[] {\n    const cssClassArray = ['codicon', `codicon-${codiconId}`];\n    if (actionItem) {\n        cssClassArray.push(ACTION_ITEM);\n    }\n    if (animationSpin) {\n        cssClassArray.push(ANIMATION_SPIN);\n    }\n    if (additionalCSS.length > 0) {\n        cssClassArray.push(...additionalCSS);\n    }\n    return cssClassArray;\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { isMac } from './browser';\n\n/**\n * Returns whether the keyboard event matches the keystroke described by the given\n * code and modifiers. The code must comply to the format of the `code` property\n * of KeyboardEvent, but in contrast to that property, the actual keyboard layout is\n * considered by this function if possible.\n */\nexport function matchesKeystroke(event: KeyboardEvent, code: KeyCode, ...modifiers: KeyboardModifier[]): boolean {\n    if (getActualCode(event) !== code)\n        return false;\n    if (isMac()) {\n        if (event.ctrlKey !== (modifiers.findIndex(m => m === 'ctrl') >= 0))\n            return false;\n        if (event.metaKey !== (modifiers.findIndex(m => m === 'meta' || m === 'ctrlCmd') >= 0))\n            return false;\n    } else {\n        if (event.ctrlKey !== (modifiers.findIndex(m => m === 'ctrl' || m === 'ctrlCmd') >= 0))\n            return false;\n        if (event.metaKey !== (modifiers.findIndex(m => m === 'meta') >= 0))\n            return false;\n    }\n    if (event.altKey !== (modifiers.findIndex(m => m === 'alt') >= 0))\n        return false;\n    if (event.shiftKey !== (modifiers.findIndex(m => m === 'shift') >= 0))\n        return false;\n    return true;\n}\n\nexport type KeyboardModifier = 'ctrl' | 'meta' | 'ctrlCmd' | 'alt' | 'shift';\n\nexport type KeyCode =\n    'AltLeft'|'AltRight'|'ArrowDown'|'ArrowLeft'|'ArrowRight'|'ArrowUp'|'Backslash'|'Backspace'|'Backquote'\n    |'BracketLeft'|'BracketRight'|'CapsLock'|'Comma'|'ContextMenu'|'ControlLeft'|'ControlRight'|'Convert'|'Delete'\n    |'Digit0'|'Digit1'|'Digit2'|'Digit3'|'Digit4'|'Digit5'|'Digit6'|'Digit7'|'Digit8'|'Digit9'\n    |'F1'|'F2'|'F3'|'F4'|'F5'|'F6'|'F7'|'F8'|'F9'|'F10'|'F11'|'F12'|'F13'|'F14'|'F15'|'F16'|'F17'|'F18'|'F19'|'F20'|'F21'|'F22'|'F23'|'F24'\n    |'End'|'Enter'|'Equal'|'Escape'|'Home'|'Insert'|'IntlBackslash'|'IntlRo'|'IntlYen'|'KanaMode'\n    |'KeyA'|'KeyB'|'KeyC'|'KeyD'|'KeyE'|'KeyF'|'KeyG'|'KeyH'|'KeyI'|'KeyJ'|'KeyK'|'KeyL'|'KeyM'\n    |'KeyN'|'KeyO'|'KeyP'|'KeyQ'|'KeyR'|'KeyS'|'KeyT'|'KeyU'|'KeyV'|'KeyW'|'KeyX'|'KeyY'|'KeyZ'\n    |'MetaLeft'|'MetaRight'|'Minus'|'NonConvert'|'NumLock'\n    |'Numpad0'|'Numpad1'|'Numpad2'|'Numpad3'|'Numpad4'|'Numpad5'|'Numpad6'|'Numpad7'|'Numpad8'|'Numpad9'\n    |'NumpadAdd'|'NumpadComma'|'NumpadDecimal'|'NumpadDivide'|'NumpadEnter'|'NumpadEqual'|'NumpadMultiply'\n    |'NumpadSeparator'|'NumpadSubtract'|'OSLeft'|'OSRight'|'PageDown'|'PageUp'|'Pause'|'Period'|'PrintScreen'\n    |'Quote'|'ScrollLock'|'Semicolon'|'ShiftLeft'|'ShiftRight'|'Slash'|'Space'|'Tab';\n\n/**\n * Determines a key code from the given event. This is necessary because the `code` property of\n * a KeyboardEvent does not consider keyboard layouts.\n */\nexport function getActualCode(event: KeyboardEvent): KeyCode {\n    if (event.keyCode) {\n        const result = STRING_CODE[event.keyCode];\n        if (result !== undefined)\n            return result;\n    }\n    return event.code as KeyCode;\n}\n\nconst STRING_CODE: { [keyCode: number]: KeyCode } = new Array(256);\n\n(() => {\n    function addKeyCode(stringCode: KeyCode, numericCode: number): void {\n        if (STRING_CODE[numericCode] === undefined)\n            STRING_CODE[numericCode] = stringCode;\n    }\n\n    addKeyCode('Pause', 3);\n    addKeyCode('Backspace', 8);\n    addKeyCode('Tab', 9);\n    addKeyCode('Enter', 13);\n    addKeyCode('ShiftLeft', 16);\n    addKeyCode('ShiftRight', 16);\n    addKeyCode('ControlLeft', 17);\n    addKeyCode('ControlRight', 17);\n    addKeyCode('AltLeft', 18);\n    addKeyCode('AltRight', 18);\n    addKeyCode('CapsLock', 20);\n    addKeyCode('Escape', 27);\n    addKeyCode('Space', 32);\n    addKeyCode('PageUp', 33);\n    addKeyCode('PageDown', 34);\n    addKeyCode('End', 35);\n    addKeyCode('Home', 36);\n    addKeyCode('ArrowLeft', 37);\n    addKeyCode('ArrowUp', 38);\n    addKeyCode('ArrowRight', 39);\n    addKeyCode('ArrowDown', 40);\n    addKeyCode('Insert', 45);\n    addKeyCode('Delete', 46);\n\n    addKeyCode('Digit1', 49);\n    addKeyCode('Digit2', 50);\n    addKeyCode('Digit3', 51);\n    addKeyCode('Digit4', 52);\n    addKeyCode('Digit5', 53);\n    addKeyCode('Digit6', 54);\n    addKeyCode('Digit7', 55);\n    addKeyCode('Digit8', 56);\n    addKeyCode('Digit9', 57);\n    addKeyCode('Digit0', 48);\n\n    addKeyCode('KeyA', 65);\n    addKeyCode('KeyB', 66);\n    addKeyCode('KeyC', 67);\n    addKeyCode('KeyD', 68);\n    addKeyCode('KeyE', 69);\n    addKeyCode('KeyF', 70);\n    addKeyCode('KeyG', 71);\n    addKeyCode('KeyH', 72);\n    addKeyCode('KeyI', 73);\n    addKeyCode('KeyJ', 74);\n    addKeyCode('KeyK', 75);\n    addKeyCode('KeyL', 76);\n    addKeyCode('KeyM', 77);\n    addKeyCode('KeyN', 78);\n    addKeyCode('KeyO', 79);\n    addKeyCode('KeyP', 80);\n    addKeyCode('KeyQ', 81);\n    addKeyCode('KeyR', 82);\n    addKeyCode('KeyS', 83);\n    addKeyCode('KeyT', 84);\n    addKeyCode('KeyU', 85);\n    addKeyCode('KeyV', 86);\n    addKeyCode('KeyW', 87);\n    addKeyCode('KeyX', 88);\n    addKeyCode('KeyY', 89);\n    addKeyCode('KeyZ', 90);\n\n    addKeyCode('OSLeft', 91);\n    addKeyCode('MetaLeft', 91);\n    addKeyCode('OSRight', 92);\n    addKeyCode('MetaRight', 92);\n    addKeyCode('ContextMenu', 93);\n\n    addKeyCode('Numpad0', 96);\n    addKeyCode('Numpad1', 97);\n    addKeyCode('Numpad2', 98);\n    addKeyCode('Numpad3', 99);\n    addKeyCode('Numpad4', 100);\n    addKeyCode('Numpad5', 101);\n    addKeyCode('Numpad6', 102);\n    addKeyCode('Numpad7', 103);\n    addKeyCode('Numpad8', 104);\n    addKeyCode('Numpad9', 105);\n    addKeyCode('NumpadMultiply', 106);\n    addKeyCode('NumpadAdd', 107);\n    addKeyCode('NumpadSeparator', 108);\n    addKeyCode('NumpadSubtract', 109);\n    addKeyCode('NumpadDecimal', 110);\n    addKeyCode('NumpadDivide', 111);\n\n    addKeyCode('F1', 112);\n    addKeyCode('F2', 113);\n    addKeyCode('F3', 114);\n    addKeyCode('F4', 115);\n    addKeyCode('F5', 116);\n    addKeyCode('F6', 117);\n    addKeyCode('F7', 118);\n    addKeyCode('F8', 119);\n    addKeyCode('F9', 120);\n    addKeyCode('F10', 121);\n    addKeyCode('F11', 122);\n    addKeyCode('F12', 123);\n    addKeyCode('F13', 124);\n    addKeyCode('F14', 125);\n    addKeyCode('F15', 126);\n    addKeyCode('F16', 127);\n    addKeyCode('F17', 128);\n    addKeyCode('F18', 129);\n    addKeyCode('F19', 130);\n    addKeyCode('F20', 131);\n    addKeyCode('F21', 132);\n    addKeyCode('F22', 133);\n    addKeyCode('F23', 134);\n    addKeyCode('F24', 135);\n\n    addKeyCode('NumLock', 144);\n    addKeyCode('ScrollLock', 145);\n\n    addKeyCode('Semicolon', 186);\n    addKeyCode('Equal', 187);\n    addKeyCode('Comma', 188);\n    addKeyCode('Minus', 189);\n    addKeyCode('Period', 190);\n    addKeyCode('Slash', 191);\n    addKeyCode('Backquote', 192);\n    addKeyCode('IntlRo', 193);\n    addKeyCode('BracketLeft', 219);\n    addKeyCode('Backslash', 220);\n    addKeyCode('BracketRight', 221);\n    addKeyCode('Quote', 222);\n    addKeyCode('IntlYen', 255);\n})();\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElementImpl } from '../../base/model/smodel';\n\nexport const selectFeature = Symbol('selectFeature');\n\n/**\n * Feature extension interface for {@link selectFeature}.\n */\nexport interface Selectable {\n    selected: boolean\n}\n\nexport function isSelectable(element: SModelElementImpl): element is SModelElementImpl & Selectable {\n    return element.hasFeature(selectFeature);\n}\n\nexport function isSelected(element: SModelElementImpl | undefined): element is SModelElementImpl & Selectable {\n    return element !== undefined && isSelectable(element) && element.selected;\n}\n", "/**\n * Copyright (c) 2016 Denys Krasnoshchok\n * \n * Homepage: https://smartscheduling.com/en/documentation/autocomplete\n * Source: https://github.com/kraaden/autocomplete\n * \n * MIT License\n */\n\nexport const enum EventTrigger {\n    Keyboard = 0,\n    Focus = 1,\n    Mouse = 2,\n    /**\n     * Fetch is triggered manually by calling `fetch` function returned in `AutocompleteResult`\n     */\n    Manual = 3\n}\n\n/**\n * Enum for controlling form submission when `ENTER` key is pressed in the autocomplete input field.\n */\nexport const enum PreventSubmit {\n    Never = 0,\n    Always = 1,\n    /**\n     * Form submission is prevented only when an item is selected from the autocomplete list.\n     */\n    OnSelect = 2\n}\n\nexport interface AutocompleteItem {\n    label?: string;\n    group?: string;\n}\n\nexport interface AutocompleteEvent<T extends Event> {\n    /**\n     * Native event object passed by browser to the event handler\n     */\n    event: T;\n\n    /**\n     * Fetch data and display autocomplete\n     */\n    fetch: () => void;\n}\n\nexport interface AutocompleteSettings<T extends AutocompleteItem> {\n    /**\n     * Autocomplete will be attached to this element.\n     */\n    input: HTMLInputElement | HTMLTextAreaElement;\n\n    /**\n     * Provide your own container for the widget.\n     * If not specified, a new DIV element will be created.\n     */\n    container?: HTMLDivElement;\n\n    /**\n     * This method allows you to override the default rendering function for items.\n     * It must return a DIV element or undefined to skip rendering.\n     */\n    render?: (item: T, currentValue: string, index: number) => HTMLDivElement | undefined;\n\n    /**\n     * This method allows you to override the default rendering function for item groups.\n     * It must return a DIV element or undefined to skip rendering.\n     */\n    renderGroup?: (name: string, currentValue: string) => HTMLDivElement | undefined;\n\n    /**\n     * If specified, the autocomplete DOM element will have this class assigned to it.\n     */\n    className?: string;\n\n    /**\n     * Specify the minimum text length required to show autocomplete.\n     */\n    minLength?: number;\n\n    /**\n     * The message that will be showed when there are no suggestions that match the entered value.\n     */\n    emptyMsg?: string;\n\n    /**\n     * This method will be called when user choose an item in autocomplete. The selected item will be passed as the first parameter.\n     */\n    onSelect: (item: T, input: HTMLInputElement | HTMLTextAreaElement) => void;\n\n    /**\n     * Show autocomplete on focus event. Focus event will ignore the `minLength` property and will always call `fetch`.\n     */\n    showOnFocus?: boolean;\n\n    /**\n     * This method will be called to prepare suggestions and then pass them to autocomplete.\n     * @param {string} text - text in the input field\n     * @param {(items: T[] | false) => void} update - a callback function that must be called after suggestions are prepared\n     * @param {EventTrigger} trigger - type of the event that triggered the fetch\n     * @param {number} cursorPos - position of the cursor in the input field\n     */\n    fetch: (text: string, update: (items: T[] | false) => void, trigger: EventTrigger, cursorPos: number) => void;\n\n    /**\n     * Enforces that the fetch function will only be called once within the specified time frame (in milliseconds) and\n     * delays execution. This prevents flooding your server with AJAX requests.\n     */\n    debounceWaitMs?: number;\n\n    /**\n     * Callback for additional autocomplete customization\n     * @param {HTMLInputElement | HTMLTextAreaElement} input - input box associated with autocomplete\n     * @param {ClientRect | DOMRect} inputRect - size of the input box and its position relative to the viewport\n     * @param {HTMLDivElement} container - container with suggestions\n     * @param {number} maxHeight - max height that can be used by autocomplete\n     */\n    customize?: (input: HTMLInputElement | HTMLTextAreaElement, inputRect: ClientRect | DOMRect, container: HTMLDivElement, maxHeight: number) => void;\n\n    /**\n     * Controls form submission when the ENTER key is pressed in a input field.\n     */\n    preventSubmit?: PreventSubmit;\n\n    /**\n     * Prevents the first item in the list from being selected automatically. This option allows you\n     * to submit a custom text by pressing ENTER even when autocomplete is displayed.\n     */\n    disableAutoSelect?: boolean;\n\n    /**\n     * Provide your keyup event handler to display autocomplete when a key is pressed that doesn't modify the content. You can also perform some additional actions.\n     */\n    keyup?: (e: AutocompleteEvent<KeyboardEvent>) => void;\n\n    /**\n     * Allows to display autocomplete on mouse clicks or perform some additional actions.\n     */\n    click?: (e: AutocompleteEvent<MouseEvent>) => void;\n}\n\nexport interface AutocompleteResult {\n    /**\n     * Remove event handlers, DOM elements and ARIA/accessibility attributes created by the widget.\n     */\n    destroy: () => void;\n\n    /**\n     * This function allows to manually start data fetching and display autocomplete. Note that\n     * it does not automatically place focus on the input field, so you may need to do so manually\n     * in certain situations.\n     */\n    fetch: () => void;\n}\n\nexport default function autocomplete<T extends AutocompleteItem>(settings: AutocompleteSettings<T>): AutocompleteResult {\n\n    // just an alias to minimize JS file size\n    const doc = document;\n\n    const container: HTMLDivElement = settings.container || doc.createElement('div');\n    const preventSubmit: PreventSubmit = settings.preventSubmit || PreventSubmit.Never;\n\n    container.id = container.id || 'autocomplete-' + uid();\n    const containerStyle = container.style;\n    const debounceWaitMs = settings.debounceWaitMs || 0;\n    const disableAutoSelect = settings.disableAutoSelect || false;\n    const customContainerParent = container.parentElement;\n\n    let items: T[] = [];\n    let inputValue = '';\n    let minLen = 2;\n    const showOnFocus = settings.showOnFocus;\n    let selected: T | undefined;\n    let fetchCounter = 0;\n    let debounceTimer: number | undefined;\n    let destroyed = false;\n\n    // Fixes #104: autocomplete selection is broken on Firefox for Android\n    let suppressAutocomplete = false;\n\n    if (settings.minLength !== undefined) {\n        minLen = settings.minLength;\n    }\n\n    if (!settings.input) {\n        throw new Error('input undefined');\n    }\n\n    const input: HTMLInputElement | HTMLTextAreaElement = settings.input;\n\n    container.className = 'autocomplete ' + (settings.className || '');\n    container.setAttribute('role', 'listbox');\n\n    input.setAttribute('role', 'combobox');\n    input.setAttribute('aria-expanded', 'false');\n    input.setAttribute('aria-autocomplete', 'list');\n    input.setAttribute('aria-controls', container.id);\n    input.setAttribute('aria-owns', container.id);\n    input.setAttribute('aria-activedescendant', '');\n    input.setAttribute('aria-haspopup', 'listbox');\n\n    // IOS implementation for fixed positioning has many bugs, so we will use absolute positioning\n    containerStyle.position = 'absolute';\n\n    /**\n     * Generate a very complex textual ID that greatly reduces the chance of a collision with another ID or text.\n     */\n    function uid(): string {\n        return Date.now().toString(36) + Math.random().toString(36).substring(2);\n    }\n\n    /**\n     * Detach the container from DOM\n     */\n    function detach() {\n        const parent = container.parentNode;\n        if (parent) {\n            parent.removeChild(container);\n        }\n    }\n\n    /**\n     * Clear debouncing timer if assigned\n     */\n    function clearDebounceTimer() {\n        if (debounceTimer) {\n            window.clearTimeout(debounceTimer);\n        }\n    }\n\n    /**\n     * Attach the container to DOM\n     */\n    function attach() {\n        if (!container.parentNode) {\n            (customContainerParent || doc.body).appendChild(container);\n        }\n    }\n\n    /**\n     * Check if container for autocomplete is displayed\n     */\n    function containerDisplayed(): boolean {\n        return !!container.parentNode;\n    }\n\n    /**\n     * Clear autocomplete state and hide container\n     */\n    function clear() {\n        // prevent the update call if there are pending AJAX requests\n        fetchCounter++;\n\n        items = [];\n        inputValue = '';\n        selected = undefined;\n        input.setAttribute('aria-activedescendant', '');\n        input.setAttribute('aria-expanded', 'false');\n        detach();\n    }\n\n    /**\n     * Update autocomplete position\n     */\n    function updatePosition() {\n        if (!containerDisplayed()) {\n            return;\n        }\n\n        input.setAttribute('aria-expanded', 'true');\n\n        containerStyle.height = 'auto';\n        containerStyle.width = input.offsetWidth + 'px';\n\n        let maxHeight = 0;\n        let inputRect: DOMRect | undefined;\n\n        function calc() {\n            const docEl = doc.documentElement as HTMLElement;\n            const clientTop = docEl.clientTop || doc.body.clientTop || 0;\n            const clientLeft = docEl.clientLeft || doc.body.clientLeft || 0;\n            const scrollTop = window.pageYOffset || docEl.scrollTop;\n            const scrollLeft = window.pageXOffset || docEl.scrollLeft;\n\n            inputRect = input.getBoundingClientRect();\n\n            const top = inputRect.top + input.offsetHeight + scrollTop - clientTop;\n            const left = inputRect.left + scrollLeft - clientLeft;\n\n            containerStyle.top = top + 'px';\n            containerStyle.left = left + 'px';\n\n            maxHeight = window.innerHeight - (inputRect.top + input.offsetHeight);\n\n            if (maxHeight < 0) {\n                maxHeight = 0;\n            }\n\n            containerStyle.top = top + 'px';\n            containerStyle.bottom = '';\n            containerStyle.left = left + 'px';\n            containerStyle.maxHeight = maxHeight + 'px';\n        }\n\n        // the calc method must be called twice, otherwise the calculation may be wrong on resize event (chrome browser)\n        calc();\n        calc();\n\n        if (settings.customize && inputRect) {\n            settings.customize(input, inputRect, container, maxHeight);\n        }\n    }\n\n    /**\n     * Redraw the autocomplete div element with suggestions\n     */\n    function update() {\n\n        container.innerHTML = '';\n        input.setAttribute('aria-activedescendant', '');\n\n        // function for rendering autocomplete suggestions\n        let render = function (item: T, _: string, __: number): HTMLDivElement | undefined {\n            const itemElement = doc.createElement('div');\n            itemElement.textContent = item.label || '';\n            return itemElement;\n        };\n        if (settings.render) {\n            render = settings.render;\n        }\n\n        // function to render autocomplete groups\n        let renderGroup = function (groupName: string, _: string): HTMLDivElement | undefined {\n            const groupDiv = doc.createElement('div');\n            groupDiv.textContent = groupName;\n            return groupDiv;\n        };\n        if (settings.renderGroup) {\n            renderGroup = settings.renderGroup;\n        }\n\n        const fragment = doc.createDocumentFragment();\n        let prevGroup = uid();\n\n        items.forEach(function (item: T, index: number): void {\n            if (item.group && item.group !== prevGroup) {\n                prevGroup = item.group;\n                const groupDiv = renderGroup(item.group, inputValue);\n                if (groupDiv) {\n                    groupDiv.className += ' group';\n                    fragment.appendChild(groupDiv);\n                }\n            }\n            const div = render(item, inputValue, index);\n            if (div) {\n                div.id = `${container.id}_${index}`;\n                div.setAttribute('role', 'option');\n                div.addEventListener('click', function (ev: MouseEvent): void {\n                    suppressAutocomplete = true;\n                    try {\n                        settings.onSelect(item, input);\n                    } finally {\n                        suppressAutocomplete = false;\n                    }\n                    clear();\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                });\n                if (item === selected) {\n                    div.className += ' selected';\n                    div.setAttribute('aria-selected', 'true');\n                    input.setAttribute('aria-activedescendant', div.id);\n                }\n                fragment.appendChild(div);\n            }\n        });\n        container.appendChild(fragment);\n        if (items.length < 1) {\n            if (settings.emptyMsg) {\n                const empty = doc.createElement('div');\n                empty.id = `${container.id}_${uid()}`;\n                empty.className = 'empty';\n                empty.textContent = settings.emptyMsg;\n                container.appendChild(empty);\n                input.setAttribute('aria-activedescendant', empty.id);\n            } else {\n                clear();\n                return;\n            }\n        }\n\n        attach();\n        updatePosition();\n\n        updateScroll();\n    }\n\n    function updateIfDisplayed() {\n        if (containerDisplayed()) {\n            update();\n        }\n    }\n\n    function resizeEventHandler() {\n        updateIfDisplayed();\n    }\n\n    function scrollEventHandler(e: Event) {\n        if (e.target !== container) {\n            updateIfDisplayed();\n        } else {\n            e.preventDefault();\n        }\n    }\n\n    function inputEventHandler() {\n        if (!suppressAutocomplete) {\n            fetch(EventTrigger.Keyboard);\n        }\n    }\n\n    /**\n     * Automatically move scroll bar if selected item is not visible\n     */\n    function updateScroll() {\n        const elements = container.getElementsByClassName('selected');\n        if (elements.length > 0) {\n            let element = elements[0] as HTMLDivElement;\n\n            // make group visible\n            const previous = element.previousElementSibling as HTMLDivElement;\n            if (previous && previous.className.indexOf('group') !== -1 && !previous.previousElementSibling) {\n                element = previous;\n            }\n\n            if (element.offsetTop < container.scrollTop) {\n                container.scrollTop = element.offsetTop;\n            } else {\n                const selectBottom = element.offsetTop + element.offsetHeight;\n                const containerBottom = container.scrollTop + container.offsetHeight;\n                if (selectBottom > containerBottom) {\n                    container.scrollTop += selectBottom - containerBottom;\n                }\n            }\n        }\n    }\n\n    function selectPreviousSuggestion() {\n        const index = items.indexOf(selected!);\n\n        selected = index === -1\n            ? undefined\n            : items[(index + items.length - 1) % items.length];\n\n        updateSelectedSuggestion(index);\n    }\n\n    function selectNextSuggestion() {\n        const index = items.indexOf(selected!);\n\n        selected = items.length < 1\n            ? undefined\n            : index === -1\n                ? items[0]\n                : items[(index + 1) % items.length];\n\n        updateSelectedSuggestion(index);\n    }\n\n    function updateSelectedSuggestion(index: number) {\n        if (items.length > 0) {\n            unselectSuggestion(index);\n            selectSuggestion(items.indexOf(selected!));\n            updateScroll();\n        }\n    }\n\n    function selectSuggestion(index: number) {\n        var element = doc.getElementById(container.id + \"_\" + index);\n        if (element) {\n            element.classList.add('selected');\n            element.setAttribute('aria-selected', 'true');\n            input.setAttribute('aria-activedescendant', element.id);\n        }\n    }\n\n    function unselectSuggestion(index: number) {\n        var element = doc.getElementById(container.id + \"_\" + index);\n        if (element) {\n            element.classList.remove('selected');\n            element.removeAttribute('aria-selected');\n            input.removeAttribute('aria-activedescendant');\n        }\n    }\n\n    function handleArrowAndEscapeKeys(ev: KeyboardEvent, key: 'ArrowUp' | 'ArrowDown' | 'Escape') {\n        const containerIsDisplayed = containerDisplayed();\n\n        if (key === 'Escape') {\n            clear();\n        } else {\n            if (!containerIsDisplayed || items.length < 1) {\n                return;\n            }\n            key === 'ArrowUp'\n                ? selectPreviousSuggestion()\n                : selectNextSuggestion();\n        }\n\n        ev.preventDefault();\n\n        if (containerIsDisplayed) {\n            ev.stopPropagation();\n        }\n    }\n\n    function handleEnterKey(ev: KeyboardEvent) {\n        if (selected) {\n            if (preventSubmit === PreventSubmit.OnSelect) {\n                ev.preventDefault();\n            }\n            suppressAutocomplete = true;\n            try {\n                settings.onSelect(selected, input);\n            } finally {\n                suppressAutocomplete = false;\n            }\n            clear();\n        }\n\n        if (preventSubmit === PreventSubmit.Always) {\n            ev.preventDefault();\n        }\n    }\n\n    function keydownEventHandler(ev: KeyboardEvent) {\n        const key = ev.key;\n\n        switch (key) {\n            case 'ArrowUp':\n            case 'ArrowDown':\n            case 'Escape':\n                handleArrowAndEscapeKeys(ev, key);\n                break;\n            case 'Enter':\n                handleEnterKey(ev);\n                break;\n            default:\n                break;\n        }\n    }\n\n    function focusEventHandler() {\n        if (showOnFocus) {\n            fetch(EventTrigger.Focus);\n        }\n    }\n\n    function fetch(trigger: EventTrigger) {\n        if (input.value.length >= minLen || trigger === EventTrigger.Focus) {\n            clearDebounceTimer();\n            debounceTimer = window.setTimeout(\n                () => startFetch(input.value, trigger, input.selectionStart || 0),\n                trigger === EventTrigger.Keyboard || trigger === EventTrigger.Mouse ? debounceWaitMs : 0);\n        } else {\n            clear();\n        }\n    }\n\n    function startFetch(inputText: string, trigger: EventTrigger, cursorPos: number) {\n        if (destroyed) return;\n        const savedFetchCounter = ++fetchCounter;\n        settings.fetch(inputText, function (elements: T[] | false): void {\n            if (fetchCounter === savedFetchCounter && elements) {\n                items = elements;\n                inputValue = inputText;\n                selected = (items.length < 1 || disableAutoSelect) ? undefined : items[0];\n                update();\n            }\n        }, trigger, cursorPos);\n    }\n\n    function keyupEventHandler(e: KeyboardEvent) {\n        if (settings.keyup) {\n            settings.keyup({\n                event: e,\n                fetch: () => fetch(EventTrigger.Keyboard)\n            });\n            return;\n        }\n\n        if (!containerDisplayed() && e.key === 'ArrowDown') {\n            fetch(EventTrigger.Keyboard);\n        }\n    }\n\n    function clickEventHandler(e: MouseEvent) {\n        settings.click && settings.click({\n            event: e,\n            fetch: () => fetch(EventTrigger.Mouse)\n        });\n    }\n\n    function blurEventHandler() {\n        // when an item is selected by mouse click, the blur event will be initiated before the click event and remove DOM elements,\n        // so that the click event will never be triggered. In order to avoid this issue, DOM removal should be delayed.\n        setTimeout(() => {\n            if (doc.activeElement !== input) {\n                clear();\n            }\n        }, 200);\n    }\n\n    function manualFetch() {\n        startFetch(input.value, EventTrigger.Manual, input.selectionStart || 0);\n    }\n\n    /**\n     * Fixes #26: on long clicks focus will be lost and onSelect method will not be called\n     */\n    container.addEventListener('mousedown', function (evt: Event) {\n        evt.stopPropagation();\n        evt.preventDefault();\n    });\n\n    /**\n     * Fixes #30: autocomplete closes when scrollbar is clicked in IE\n     * See: https://stackoverflow.com/a/9210267/13172349\n     */\n    container.addEventListener('focus', () => input.focus());\n\n    // If the custom autocomplete container is already appended to the DOM during widget initialization, detach it.\n    detach();\n\n    /**\n     * This function will remove DOM elements and clear event handlers\n     */\n    function destroy() {\n        input.removeEventListener('focus', focusEventHandler);\n        input.removeEventListener('keyup', keyupEventHandler as EventListenerOrEventListenerObject)\n        input.removeEventListener('click', clickEventHandler as EventListenerOrEventListenerObject)\n        input.removeEventListener('keydown', keydownEventHandler as EventListenerOrEventListenerObject);\n        input.removeEventListener('input', inputEventHandler as EventListenerOrEventListenerObject);\n        input.removeEventListener('blur', blurEventHandler);\n        window.removeEventListener('resize', resizeEventHandler);\n        doc.removeEventListener('scroll', scrollEventHandler, true);\n        input.removeAttribute('role');\n        input.removeAttribute('aria-expanded');\n        input.removeAttribute('aria-autocomplete');\n        input.removeAttribute('aria-controls');\n        input.removeAttribute('aria-activedescendant');\n        input.removeAttribute('aria-owns');\n        input.removeAttribute('aria-haspopup');\n        clearDebounceTimer();\n        clear();\n        destroyed = true;\n    }\n\n    // setup event handlers\n    input.addEventListener('keyup', keyupEventHandler as EventListenerOrEventListenerObject);\n    input.addEventListener('click', clickEventHandler as EventListenerOrEventListenerObject);\n    input.addEventListener('keydown', keydownEventHandler as EventListenerOrEventListenerObject);\n    input.addEventListener('input', inputEventHandler as EventListenerOrEventListenerObject);\n    input.addEventListener('blur', blurEventHandler);\n    input.addEventListener('focus', focusEventHandler);\n    window.addEventListener('resize', resizeEventHandler);\n    doc.addEventListener('scroll', scrollEventHandler, true);\n\n    return {\n        destroy,\n        fetch: manualFetch\n    };\n}\n", "/********************************************************************************\n * Copyright (c) 2019 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { AutocompleteResult, AutocompleteSettings } from \"autocompleter\";\nimport { inject, injectable } from \"inversify\";\nimport { Action, isAction } from 'sprotty-protocol/lib/actions';\nimport { LabeledAction, isLabeledAction } from \"../../base/actions/action\";\nimport { IActionDispatcherProvider } from \"../../base/actions/action-dispatcher\";\nimport { SModelElementImpl, SModelRootImpl } from \"../../base/model/smodel\";\nimport { TYPES } from \"../../base/types\";\nimport { AbstractUIExtension } from \"../../base/ui-extensions/ui-extension\";\nimport { SetUIExtensionVisibilityAction } from \"../../base/ui-extensions/ui-extension-registry\";\nimport { DOMHelper } from \"../../base/views/dom-helper\";\nimport { KeyListener } from \"../../base/views/key-tool\";\nimport { ViewerOptions } from \"../../base/views/viewer-options\";\nimport { codiconCSSClasses, codiconCSSString } from \"../../utils/codicon\";\nimport { toArray } from \"../../utils/iterable\";\nimport { matchesKeystroke } from \"../../utils/keyboard\";\nimport { getAbsoluteClientBounds } from \"../bounds/model\";\nimport { isSelectable } from \"../select/model\";\nimport { CommandPaletteActionProviderRegistry } from \"./action-providers\";\nimport { MousePositionTracker } from \"../../base/views/mouse-tool\";\nimport configureAutocomplete from \"autocompleter\";\n\n@injectable()\nexport class CommandPalette extends AbstractUIExtension {\n    static readonly ID = \"command-palette\";\n    static readonly isInvokePaletteKey = (event: KeyboardEvent) => matchesKeystroke(event, 'Space', 'ctrl');\n\n    protected loadingIndicatorClasses = codiconCSSClasses('loading', false, true, ['loading']);\n    protected xOffset = 20;\n    protected yOffset = 20;\n    protected defaultWidth = 400;\n    protected debounceWaitMs = 100;\n    protected noCommandsMsg = \"No commands available\";\n\n    protected inputElement: HTMLInputElement;\n    protected loadingIndicator: HTMLSpanElement;\n    protected autoCompleteResult: AutocompleteResult;\n    protected paletteIndex = 0;\n    protected contextActions?: LabeledAction[];\n\n    @inject(TYPES.IActionDispatcherProvider) protected actionDispatcherProvider: IActionDispatcherProvider;\n    @inject(TYPES.ICommandPaletteActionProviderRegistry) protected actionProviderRegistry: CommandPaletteActionProviderRegistry;\n    @inject(TYPES.ViewerOptions) protected viewerOptions: ViewerOptions;\n    @inject(TYPES.DOMHelper) protected domHelper: DOMHelper;\n    @inject(MousePositionTracker) protected mousePositionTracker: MousePositionTracker;\n\n    public id() { return CommandPalette.ID; }\n    public containerClass() { return \"command-palette\"; }\n\n    override show(root: Readonly<SModelRootImpl>, ...contextElementIds: string[]) {\n        super.show(root, ...contextElementIds);\n        this.paletteIndex = 0;\n        this.contextActions = undefined;\n        this.inputElement!.value = \"\";\n        this.autoCompleteResult = configureAutocomplete(this.autocompleteSettings(root));\n        this.inputElement.focus();\n    }\n\n    protected initializeContents(containerElement: HTMLElement) {\n        containerElement.style.position = \"absolute\";\n        this.inputElement = document.createElement('input');\n        this.inputElement.style.width = '100%';\n        this.inputElement.addEventListener('keydown', (event) => this.hideIfEscapeEvent(event));\n        this.inputElement.addEventListener('keydown', (event) => this.cylceIfInvokePaletteKey(event));\n        this.inputElement.onblur = () => window.setTimeout(() => this.hide(), 200);\n        containerElement.appendChild(this.inputElement);\n    }\n\n    protected hideIfEscapeEvent(event: KeyboardEvent): any {\n        if (matchesKeystroke(event, 'Escape')) { this.hide(); }\n    }\n\n    protected cylceIfInvokePaletteKey(event: KeyboardEvent): any {\n        if (CommandPalette.isInvokePaletteKey(event)) { this.cycle(); }\n    }\n\n    protected cycle() {\n        this.contextActions = undefined;\n        this.paletteIndex++;\n    }\n\n    protected override onBeforeShow(containerElement: HTMLElement, root: Readonly<SModelRootImpl>, ...selectedElementIds: string[]) {\n        let x = this.xOffset;\n        let y = this.yOffset;\n        const selectedElements = toArray(root.index.all().filter(e => isSelectable(e) && e.selected));\n        if (selectedElements.length === 1) {\n            const bounds = getAbsoluteClientBounds(selectedElements[0], this.domHelper, this.viewerOptions);\n            x += bounds.x + bounds.width;\n            y += bounds.y;\n        } else {\n            const bounds = getAbsoluteClientBounds(root, this.domHelper, this.viewerOptions);\n            x += bounds.x;\n            y += bounds.y;\n        }\n        containerElement.style.left = `${x}px`;\n        containerElement.style.top = `${y}px`;\n        containerElement.style.width = `${this.defaultWidth}px`;\n    }\n\n    protected autocompleteSettings(root: Readonly<SModelRootImpl>): AutocompleteSettings<LabeledAction> {\n        return {\n            input: this.inputElement,\n            emptyMsg: this.noCommandsMsg,\n            className: \"command-palette-suggestions\",\n            debounceWaitMs: this.debounceWaitMs,\n            showOnFocus: true,\n            minLength: -1,\n            fetch: (text: string, update: (items: LabeledAction[]) => void) =>\n                this.updateAutoCompleteActions(update, text, root),\n            onSelect: (item: LabeledAction) => this.onSelect(item),\n            render: (item: LabeledAction, currentValue: string): HTMLDivElement | undefined =>\n                this.renderLabeledActionSuggestion(item, currentValue),\n            customize: (input: HTMLInputElement, inputRect: ClientRect | DOMRect, container: HTMLDivElement, maxHeight: number) => {\n                this.customizeSuggestionContainer(container, inputRect, maxHeight);\n            }\n        };\n    }\n\n    protected onSelect(item: LabeledAction) {\n        this.executeAction(item);\n        this.hide();\n    }\n\n    protected updateAutoCompleteActions(update: (items: LabeledAction[]) => void, text: string, root: Readonly<SModelRootImpl>) {\n        this.onLoading();\n        if (this.contextActions) {\n            update(this.filterActions(text, this.contextActions));\n            this.onLoaded('success');\n        } else {\n            this.actionProviderRegistry\n                .getActions(root, text, this.mousePositionTracker.lastPositionOnDiagram, this.paletteIndex)\n                .then(actions => {\n                    this.contextActions = actions;\n                    update(this.filterActions(text, actions));\n                    this.onLoaded('success');\n                })\n                .catch((reason) => {\n                    this.logger.error(this, \"Failed to obtain actions from command palette action providers\", reason);\n                    this.onLoaded('error');\n                });\n        }\n    }\n\n    protected onLoading() {\n        if (this.loadingIndicator && this.containerElement.contains(this.loadingIndicator)) {\n            return;\n        }\n        this.loadingIndicator = document.createElement('span');\n        this.loadingIndicator.classList.add(...this.loadingIndicatorClasses);\n        this.containerElement.appendChild(this.loadingIndicator);\n    }\n\n    protected onLoaded(success: 'success' | 'error') {\n        if (this.containerElement.contains(this.loadingIndicator)) {\n            this.containerElement.removeChild(this.loadingIndicator);\n        }\n    }\n\n    protected renderLabeledActionSuggestion(item: LabeledAction, value: string) {\n        const itemElement = document.createElement(\"div\");\n        const wordMatcher = espaceForRegExp(value).split(\" \").join(\"|\");\n        const regex = new RegExp(wordMatcher, \"gi\");\n        if (item.icon) {\n            this.renderIcon(itemElement, item.icon);\n        }\n        if (value.length > 0) {\n            itemElement.innerHTML += item.label.replace(regex, (match) => \"<em>\" + match + \"</em>\").replace(/ /g, '&nbsp;');\n        } else {\n            itemElement.innerHTML += item.label.replace(/ /g, '&nbsp;');\n        }\n        return itemElement;\n    }\n\n    protected renderIcon(itemElement: HTMLDivElement, iconId: string) {\n        itemElement.innerHTML += `<span class=\"icon ${this.getCodicon(iconId)}\"></span>`;\n    }\n\n    protected getFontAwesomeIcon(iconId: string) {\n        return `fa fa-${iconId}`;\n    }\n\n    protected getCodicon(iconId: string) {\n        return codiconCSSString(iconId);\n    }\n\n    protected filterActions(filterText: string, actions: LabeledAction[]): LabeledAction[] {\n        return toArray(actions.filter(action => {\n            const label = action.label.toLowerCase();\n            const searchWords = filterText.split(' ');\n            return searchWords.every(word => label.indexOf(word.toLowerCase()) !== -1);\n        }));\n    }\n\n    protected customizeSuggestionContainer(container: HTMLDivElement, inputRect: ClientRect | DOMRect, maxHeight: number) {\n        // move container into our command palette container as this is already positioned correctly\n        container.style.position = \"fixed\";\n        if (this.containerElement) {\n            this.containerElement.appendChild(container);\n        }\n    }\n\n    override hide() {\n        super.hide();\n        if (this.autoCompleteResult) {\n            this.autoCompleteResult.destroy();\n        }\n    }\n\n    protected executeAction(input: LabeledAction | Action[] | Action) {\n        this.actionDispatcherProvider()\n            .then((actionDispatcher) => actionDispatcher.dispatchAll(toActionArray(input)))\n            .catch((reason) => this.logger.error(this, 'No action dispatcher available to execute command palette action', reason));\n    }\n}\n\nfunction toActionArray(input: LabeledAction | Action[] | Action): Action[] {\n    if (isLabeledAction(input)) {\n        return input.actions;\n    } else if (isAction(input)) {\n        return [input];\n    }\n    return [];\n}\n\nfunction espaceForRegExp(value: string): string {\n    return value.replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\n}\n\nexport class CommandPaletteKeyListener extends KeyListener {\n    override keyDown(element: SModelElementImpl, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'Escape')) {\n            return [SetUIExtensionVisibilityAction.create({ extensionId: CommandPalette.ID, visible: false, contextElementsId: [] })];\n        } else if (CommandPalette.isInvokePaletteKey(event)) {\n            const selectedElements = toArray(element.index.all().filter(e => isSelectable(e) && e.selected).map(e => e.id));\n            return [SetUIExtensionVisibilityAction.create({ extensionId: CommandPalette.ID, visible: true, contextElementsId: selectedElements })];\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { LabeledAction } from \"../../base/actions/action\";\n\nexport interface MenuItem extends LabeledAction {\n    /** Technical id of the menu item. */\n    readonly id: string;\n    /** String indicating the order. */\n    readonly sortString?: string;\n    /** String indicating the grouping (separators). Items with equal group will be in the same group. */\n    readonly group?: string;\n    /**\n     * The optional parent id can be used to add this element as a child of another element provided by anohter menu provider.\n     * The `parentId` must be fully qualified in the form of `a.b.c`, whereas `a`, `b` and `c` are referring to the IDs of other elements.\n     * Note that this attribute will only be considered for root items of a provider and not for children of provided items.\n     */\n    readonly parentId?: string;\n    /** Function determining whether the element is enabled. */\n    readonly isEnabled?: () => boolean;\n    /** Function determining whether the element is visible. */\n    readonly isVisible?: () => boolean;\n    /** Function determining whether the element is toggled on or off. */\n    readonly isToggled?: () => boolean;\n    /** Children of this item. If this item has children, they will be added into a submenu of this item. */\n    children?: MenuItem[];\n}\n\nexport type Anchor = MouseEvent | { x: number, y: number };\n\nexport function toAnchor(anchor: HTMLElement | { x: number, y: number }): Anchor {\n    return anchor instanceof HTMLElement ? { x: anchor.offsetLeft, y: anchor.offsetTop } : anchor;\n}\n\nexport interface IContextMenuService {\n    show(items: MenuItem[], anchor: Anchor, onHide?: () => void): void;\n}\n\nexport type IContextMenuServiceProvider = () => Promise<IContextMenuService>;\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { DeleteElementAction } from 'sprotty-protocol/lib/actions';\nimport { Command, CommandExecutionContext, CommandReturn } from '../../base/commands/command';\nimport { SModelElementImpl, SParentElementImpl, SChildElementImpl } from '../../base/model/smodel';\nimport { TYPES } from '../../base/types';\n\nexport const deletableFeature = Symbol('deletableFeature');\n\n/**\n *  Feature extension interface for {@link deletableFeature}.\n */\nexport interface Deletable {\n}\n\nexport function isDeletable<T extends SModelElementImpl>(element: T): element is T & Deletable & SChildElementImpl {\n    return element instanceof SChildElementImpl && element.hasFeature(deletableFeature);\n}\n\nexport class ResolvedDelete {\n    child: SChildElementImpl;\n    parent: SParentElementImpl;\n}\n\n@injectable()\nexport class DeleteElementCommand extends Command {\n    static readonly KIND = DeleteElementAction.KIND;\n\n    resolvedDeletes: ResolvedDelete[] = [];\n\n    constructor(@inject(TYPES.Action) protected readonly action: DeleteElementAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const index = context.root.index;\n        for (const id of this.action.elementIds) {\n            const element = index.getById(id);\n            if (element && isDeletable(element)) {\n                this.resolvedDeletes.push({ child: element, parent: element.parent });\n                element.parent.remove(element);\n            }\n        }\n        return context.root;\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        for (const resolvedDelete of this.resolvedDeletes)\n            resolvedDelete.parent.add(resolvedDelete.child);\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        for (const resolvedDelete of this.resolvedDeletes)\n            resolvedDelete.parent.remove(resolvedDelete.child);\n        return context.root;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, multiInject, optional } from 'inversify';\nimport { Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { MenuItem } from './context-menu-service';\nimport { SModelRootImpl } from '../../base/model/smodel';\nimport { LabeledAction } from '../../base/actions/action';\nimport { TYPES } from '../../base/types';\nimport { isDeletable } from '../edit/delete';\nimport { isSelected } from '../select/model';\nimport { DeleteElementAction } from 'sprotty-protocol';\n\nexport interface IContextMenuItemProvider {\n    getItems(root: Readonly<SModelRootImpl>, lastMousePosition?: Point): Promise<LabeledAction[]>;\n}\n\n@injectable()\nexport class ContextMenuProviderRegistry implements IContextMenuItemProvider {\n\n    constructor(@multiInject(TYPES.IContextMenuItemProvider) @optional() protected menuProviders: IContextMenuItemProvider[] = []) { }\n\n    getItems(root: Readonly<SModelRootImpl>, lastMousePosition?: Point) {\n        const menues = this.menuProviders.map(provider => provider.getItems(root, lastMousePosition));\n        return Promise.all(menues).then(this.flattenAndRestructure);\n    }\n\n    private flattenAndRestructure(p: MenuItem[][]): MenuItem[] {\n        let menuItems = p.reduce((acc, promise) => promise !== undefined ? acc.concat(promise) : acc, []);\n        const menuItemsWithParentId = menuItems.filter(menuItem => menuItem.parentId);\n        for (const menuItem of menuItemsWithParentId) {\n            if (menuItem.parentId) {\n                const fragments = menuItem.parentId.split('.');\n                let matchingParent: MenuItem | undefined = undefined;\n                let nextParents = menuItems;\n                for (const fragment of fragments) {\n                    matchingParent = nextParents.find(item => fragment === item.id);\n                    if (matchingParent && matchingParent.children)\n                        nextParents = matchingParent.children;\n                }\n                if (matchingParent) {\n                    if (matchingParent.children) {\n                        matchingParent.children.push(menuItem);\n                    } else {\n                        matchingParent.children = [menuItem];\n                    }\n                    menuItems = menuItems.filter(item => item !== menuItem);\n                }\n            }\n        }\n        return menuItems;\n    }\n}\n\n@injectable()\nexport class DeleteContextMenuItemProvider implements IContextMenuItemProvider {\n    getItems(root: Readonly<SModelRootImpl>, lastMousePosition?: Point): Promise<MenuItem[]> {\n        const selectedElements = Array.from(root.index.all().filter(isSelected).filter(isDeletable));\n        return Promise.resolve([\n            {\n                id: 'delete',\n                label: 'Delete',\n                sortString: 'd',\n                group: 'edit',\n                actions: [DeleteElementAction.create(selectedElements.map(e => e.id))],\n                isEnabled: () => selectedElements.length > 0\n            }\n        ]);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject } from \"inversify\";\nimport { Action, SelectAction } from \"sprotty-protocol/lib/actions\";\nimport { IActionDispatcher } from \"../../base/actions/action-dispatcher\";\nimport { SModelElementImpl } from \"../../base/model/smodel\";\nimport { findParentByFeature } from \"../../base/model/smodel-utils\";\nimport { TYPES } from \"../../base/types\";\nimport { MouseListener } from \"../../base/views/mouse-tool\";\nimport { isSelectable, isSelected } from \"../select/model\";\nimport { IContextMenuService, IContextMenuServiceProvider } from \"./context-menu-service\";\nimport { ContextMenuProviderRegistry } from \"./menu-providers\";\n\nexport class ContextMenuMouseListener extends MouseListener {\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: IActionDispatcher;\n    constructor(\n        @inject(TYPES.IContextMenuServiceProvider) protected readonly contextMenuService: IContextMenuServiceProvider,\n        @inject(TYPES.IContextMenuProviderRegistry) protected readonly menuProvider: ContextMenuProviderRegistry) {\n        super();\n    }\n\n    override contextMenu(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        this.showContextMenu(target, event);\n        return [];\n    }\n\n    protected async showContextMenu(target: SModelElementImpl, event: MouseEvent): Promise<void> {\n        let menuService: IContextMenuService;\n        try {\n            menuService = await this.contextMenuService();\n        } catch (rejected) {\n            // IContextMenuService is not bound => do nothing\n            return;\n        }\n\n        let isTargetSelected = false;\n        const selectableTarget = findParentByFeature(target, isSelectable);\n        if (selectableTarget) {\n            isTargetSelected = selectableTarget.selected;\n            selectableTarget.selected = true;\n        }\n\n        const root = target.root;\n        const mousePosition = { x: event.x, y: event.y };\n        if (target.id === root.id || isSelected(selectableTarget)) {\n            const menuItems = await this.menuProvider.getItems(root, mousePosition);\n            const restoreSelection = () => { if (selectableTarget) selectableTarget.selected = isTargetSelected; };\n            menuService.show(menuItems, mousePosition, restoreSelection);\n        } else {\n            if (isSelectable(target)) {\n                const options = { selectedElementsIDs: [target.id], deselectedElementsIDs: Array.from(root.index.all().filter(isSelected), (val) => { return val.id; }) };\n                await this.actionDispatcher.dispatch(SelectAction.create(options));\n            }\n            const items = await this.menuProvider.getItems(root, mousePosition);\n            menuService.show(items, mousePosition);\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElementImpl } from '../../base/model/smodel';\n\nexport const hoverFeedbackFeature = Symbol('hoverFeedbackFeature');\n\n/**\n * Feature extension interface for {@link hoverFeedbackFeature}.\n */\nexport interface Hoverable {\n    hoverFeedback: boolean\n}\n\nexport function isHoverable(element: SModelElementImpl): element is SModelElementImpl & Hoverable {\n    return element.hasFeature(hoverFeedbackFeature);\n}\n\nexport const popupFeature = Symbol('popupFeature');\n\nexport function hasPopupFeature(element: SModelElementImpl): boolean {\n    return element.hasFeature(popupFeature);\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SModelElementImpl } from '../../base/model/smodel';\n\nexport const moveFeature = Symbol('moveFeature');\n\n/**\n * An element that can be placed at a specific location using its position\n * property.\n *\n * Feature extension interface for {@link moveFeature}.\n */\nexport interface Locateable {\n    position: Point\n}\n\nexport function isLocateable(element: SModelElementImpl): element is SModelElementImpl & Locateable {\n    return (element as any)['position'] !== undefined;\n}\n\nexport function isMoveable(element: SModelElementImpl): element is SModelElementImpl & Locateable {\n    return element.hasFeature(moveFeature) && isLocateable(element);\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Bounds, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SChildElementImpl, SModelElementImpl } from '../../base/model/smodel';\nimport { FluentIterable } from '../../utils/iterable';\nimport { SShapeElementImpl } from '../bounds/model';\nimport { deletableFeature } from '../edit/delete';\nimport { Selectable, selectFeature } from '../select/model';\nimport { Hoverable, hoverFeedbackFeature } from '../hover/model';\nimport { moveFeature } from '../move/model';\n\nexport abstract class SRoutableElementImpl extends SChildElementImpl {\n\n    routerKind?: string;\n    routingPoints: Point[] = [];\n    sourceId: string;\n    targetId: string;\n    sourceAnchorCorrection?: number;\n    targetAnchorCorrection?: number;\n\n    get source(): SConnectableElementImpl | undefined {\n        return this.index.getById(this.sourceId) as SConnectableElementImpl;\n    }\n\n    get target(): SConnectableElementImpl | undefined {\n        return this.index.getById(this.targetId) as SConnectableElementImpl;\n    }\n\n    get bounds(): Bounds {\n        // this should also work for splines, which have the convex hull property\n        return this.routingPoints.reduce<Bounds>((bounds, routingPoint) => Bounds.combine(bounds, {\n            x: routingPoint.x,\n            y: routingPoint.y,\n            width: 0,\n            height: 0\n        }), Bounds.EMPTY);\n    }\n}\n\nexport const connectableFeature = Symbol('connectableFeature');\n\n/**\n * Feature extension interface for {@link connectableFeature}.\n */\nexport interface Connectable {\n    canConnect(routable: SRoutableElementImpl, role: 'source' | 'target'): boolean;\n}\n\nexport function isConnectable<T extends SModelElementImpl>(element: T): element is Connectable & T {\n    return element.hasFeature(connectableFeature) && (element as any).canConnect;\n}\n\nexport function getAbsoluteRouteBounds(model: Readonly<SRoutableElementImpl>, route: Point[] = model.routingPoints): Bounds {\n    let bounds = getRouteBounds(route);\n    let current: SModelElementImpl = model;\n    while (current instanceof SChildElementImpl) {\n        const parent = current.parent;\n        bounds = parent.localToParent(bounds);\n        current = parent;\n    }\n    return bounds;\n}\n\nexport function getRouteBounds(route: Point[]): Bounds {\n    const bounds = { x: NaN, y: NaN, width: 0, height: 0 };\n    for (const point of route) {\n        if (isNaN(bounds.x)) {\n            bounds.x = point.x;\n            bounds.y = point.y;\n        } else {\n            if (point.x < bounds.x) {\n                bounds.width += bounds.x - point.x;\n                bounds.x = point.x;\n            } else if (point.x > bounds.x + bounds.width) {\n                bounds.width = point.x - bounds.x;\n            }\n            if (point.y < bounds.y) {\n                bounds.height += bounds.y - point.y;\n                bounds.y = point.y;\n            } else if (point.y > bounds.y + bounds.height) {\n                bounds.height = point.y - bounds.y;\n            }\n        }\n    }\n    return bounds;\n}\n\n/**\n * A connectable element is one that can have outgoing and incoming edges, i.e. it can be the source\n * or target element of an edge. There are two kinds of connectable elements: nodes (`SNode`) and\n * ports (`SPort`). A node represents a main entity, while a port is a connection point inside a node.\n */\nexport abstract class SConnectableElementImpl extends SShapeElementImpl implements Connectable {\n\n    get anchorKind(): string | undefined {\n        return undefined;\n    }\n\n    strokeWidth: number = 0;\n\n    /**\n     * The incoming edges of this connectable element. They are resolved by the index, which must\n     * be an `SGraphIndex` for efficient lookup.\n     */\n    get incomingEdges(): FluentIterable<SRoutableElementImpl> {\n        const allEdges = this.index.all().filter(e => e instanceof SRoutableElementImpl) as FluentIterable<SRoutableElementImpl>;\n        return allEdges.filter(e => e.targetId === this.id);\n    }\n\n    /**\n     * The outgoing edges of this connectable element. They are resolved by the index, which must\n     * be an `SGraphIndex` for efficient lookup.\n     */\n    get outgoingEdges(): FluentIterable<SRoutableElementImpl> {\n        const allEdges = this.index.all().filter(e => e instanceof SRoutableElementImpl) as FluentIterable<SRoutableElementImpl>;\n        return allEdges.filter(e => e.sourceId === this.id);\n    }\n\n    canConnect(routable: SRoutableElementImpl, role: 'source' | 'target') {\n        return true;\n    }\n}\n\n\nexport type RoutingHandleKind = 'junction' | 'line' | 'source' | 'target' | 'manhattan-50%' |\n    'bezier-control-after' | 'bezier-control-before' | 'bezier-junction' | 'bezier-add' | 'bezier-remove';\n\nexport class SRoutingHandleImpl extends SChildElementImpl implements Selectable, Hoverable {\n    static readonly DEFAULT_FEATURES = [selectFeature, moveFeature, hoverFeedbackFeature];\n\n    /**\n     * 'junction' is a point where two line segments meet,\n     * 'line' is a volatile handle placed on a line segment,\n     * 'source' and 'target' are the respective anchors.\n     */\n    kind: RoutingHandleKind;\n    /** The actual routing point index (junction) or the previous point index (line). */\n    pointIndex: number;\n    /** Whether the routing point is being dragged. */\n    editMode: boolean = false;\n\n    hoverFeedback: boolean = false;\n    selected: boolean = false;\n    danglingAnchor?: SDanglingAnchorImpl;\n\n    /**\n     * SRoutingHandles are created using the constructor, so we hard-wire the\n     * default features\n     */\n    override hasFeature(feature: symbol): boolean {\n        return SRoutingHandleImpl.DEFAULT_FEATURES.indexOf(feature) !== -1;\n    }\n}\n\nexport class SDanglingAnchorImpl extends SConnectableElementImpl {\n    static readonly DEFAULT_FEATURES = [deletableFeature];\n\n    original?: SModelElementImpl;\n    override type = 'dangling-anchor';\n\n    constructor() {\n        super();\n        this.size = { width: 0, height: 0 };\n    }\n}\n\nexport const edgeInProgressID = 'edge-in-progress';\nexport const edgeInProgressTargetHandleID = edgeInProgressID + '-target-anchor';\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElementImpl, SChildElementImpl } from '../../base/model/smodel';\nimport { BoundsAware, isBoundsAware } from '../bounds/model';\nimport { SRoutableElementImpl } from '../routing/model';\n\nexport const edgeLayoutFeature = Symbol('edgeLayout');\n\n/**\n * Feature extension interface for {@link edgeLayoutFeature}.\n */\nexport interface EdgeLayoutable {\n    edgePlacement: EdgePlacement\n}\n\nexport function isEdgeLayoutable<T extends SModelElementImpl>(element: T): element is T & SChildElementImpl & BoundsAware & EdgeLayoutable {\n    return element instanceof SChildElementImpl\n        && element.parent instanceof SRoutableElementImpl\n        && checkEdgeLayoutable(element)\n        && isBoundsAware(element)\n        && element.hasFeature(edgeLayoutFeature);\n}\n\nfunction checkEdgeLayoutable(element: SChildElementImpl): element is SChildElementImpl & EdgeLayoutable {\n    return 'edgePlacement' in element;\n}\n\nexport type EdgeSide = 'left' | 'right' | 'top' | 'bottom' | 'on';\n\nexport class EdgePlacement extends Object {\n    /**\n     * true, if the label should be rotated to touch the edge tangentially\n     */\n    rotate: boolean;\n\n    /**\n     * where is the label relative to the line's direction\n     */\n    side: EdgeSide;\n\n    /**\n     * between 0 (source anchor) and 1 (target anchor)\n     */\n    position: number;\n\n    /**\n     * space between label and edge/connected nodes\n     */\n    offset: number;\n}\n\nexport const DEFAULT_EDGE_PLACEMENT: EdgePlacement = {\n    rotate: true,\n    side: 'top',\n    position: 0.5,\n    offset: 7\n};\n", "/********************************************************************************\n * Copyright (c) 2017-2020 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Dimension, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SModelElementImpl } from '../../base/model/smodel';\nimport { SRoutableElementImpl } from '../routing/model';\n\nexport const editFeature = Symbol('editFeature');\n\nexport function canEditRouting(element: SModelElementImpl): element is SRoutableElementImpl {\n    return element instanceof SRoutableElementImpl && element.hasFeature(editFeature);\n}\n\n\nexport const editLabelFeature = Symbol('editLabelFeature');\n\n/**\n * Feature extension interface for {@link editLabelFeature}.\n */\nexport interface EditableLabel  {\n    text: string;\n    readonly isMultiLine?: boolean;\n    readonly editControlDimension?: Dimension;\n    readonly editControlPositionCorrection?: Point;\n}\n\nexport function isEditableLabel<T extends SModelElementImpl>(element: T): element is T & EditableLabel {\n    return 'text' in element && element.hasFeature(editLabelFeature);\n}\n\nexport const withEditLabelFeature = Symbol('withEditLabelFeature');\n\n/**\n * Feature extension interface for {@link withEditLabelFeature}.\n */\nexport interface WithEditableLabel  {\n    readonly editableLabel?: EditableLabel & SModelElementImpl;\n}\n\nexport function isWithEditableLabel<T extends SModelElementImpl>(element: T): element is T & WithEditableLabel {\n    return 'editableLabel' in element && element.hasFeature(withEditLabelFeature);\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2022 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Bounds, Point, toDegrees } from 'sprotty-protocol';\n\n/**\n * Represents an object's insets, for top, bottom, left and right\n */\nexport interface Insets {\n    top: number\n    bottom: number\n    left: number\n    right: number\n}\n\nexport type Orientation = 'north' | 'south' | 'east' | 'west';\n\n/**\n * A diamond or rhombus is a quadrilateral whose four sides all have the same length.\n * It consists of four points, a `topPoint`, `rightPoint`, `bottomPoint`, and a `leftPoint`,\n * which are connected by four lines -- the `topRightSideLight`, `topLeftSideLine`, `bottomRightSideLine`,\n * and the `bottomLeftSideLine`.\n */\nexport class Diamond {\n\n    constructor(protected bounds: Bounds) { }\n\n    get topPoint(): Point {\n        return {\n            x: this.bounds.x + this.bounds.width / 2,\n            y: this.bounds.y\n        };\n    }\n\n    get rightPoint(): Point {\n        return {\n            x: this.bounds.x + this.bounds.width,\n            y: this.bounds.y + this.bounds.height / 2\n        };\n    }\n\n    get bottomPoint(): Point {\n        return {\n            x: this.bounds.x + this.bounds.width / 2,\n            y: this.bounds.y + this.bounds.height\n        };\n    }\n\n    get leftPoint(): Point {\n        return {\n            x: this.bounds.x,\n            y: this.bounds.y + this.bounds.height / 2\n        };\n    }\n\n    get topRightSideLine(): Line {\n        return new PointToPointLine(this.topPoint, this.rightPoint);\n    }\n\n    get topLeftSideLine(): Line {\n        return new PointToPointLine(this.topPoint, this.leftPoint);\n    }\n\n    get bottomRightSideLine(): Line {\n        return new PointToPointLine(this.bottomPoint, this.rightPoint);\n    }\n\n    get bottomLeftSideLine(): Line {\n        return new PointToPointLine(this.bottomPoint, this.leftPoint);\n    }\n\n    /**\n     * Return the closest side of this diamond to the specified `refPoint`.\n     * @param {Point} refPoint a reference point\n     * @returns {Line} a line representing the closest side\n     */\n    closestSideLine(refPoint: Point): Line {\n        const c = Bounds.center(this.bounds);\n        if (refPoint.x > c.x) {\n            if (refPoint.y > c.y) {\n                return this.bottomRightSideLine;\n            } else {\n                return this.topRightSideLine;\n            }\n        } else {\n            if (refPoint.y > c.y) {\n                return this.bottomLeftSideLine;\n            } else {\n                return this.topLeftSideLine;\n            }\n        }\n    }\n}\n\n/**\n * A line represented in its standard form `a*x + b*y = c`.\n */\nexport interface Line {\n    readonly a: number\n    readonly b: number\n    readonly c: number\n}\n\nexport type CardinalDirection =\n    'north' | 'north-east' | 'east' | 'south-east' |\n    'south' | 'south-west' | 'west' | 'north-west';\n\n/**\n * A line made up from two points.\n */\nexport class PointToPointLine implements Line {\n\n    constructor(public p1: Point, public p2: Point) { }\n\n    get a(): number {\n        return this.p1.y - this.p2.y;\n    }\n\n    get b(): number {\n        return this.p2.x - this.p1.x;\n    }\n\n    get c(): number {\n        return this.p2.x * this.p1.y - this.p1.x * this.p2.y;\n    }\n\n    /**\n     * The counter-clockwise angle of this line relative to the x-axis.\n     */\n    get angle(): number {\n        return Math.atan2(-this.a, this.b);\n    }\n\n    /**\n     * The slope of the line.\n     * A vertical line returns `undefined`.\n     */\n    get slope(): number | undefined {\n        if (this.b === 0) return undefined;\n        return this.a / this.b;\n    }\n\n    /**\n     * The slope of the line or `Number.MAX_SAFE_INTEGER` if vertical.\n     */\n    get slopeOrMax(): number {\n        if (this.slope === undefined) {\n            return Number.MAX_SAFE_INTEGER;\n        }\n        return this.slope;\n    }\n\n    /**\n     * The direction of this line, such as 'north', 'south', or 'south-west'.\n     */\n    get direction(): CardinalDirection {\n        const hDegrees = toDegrees(this.angle);\n        const degrees = hDegrees < 0 ? 360 + hDegrees : hDegrees;\n        // degrees are relative to the x-axis\n        if (degrees === 90) {\n            return 'south';\n        } else if (degrees === 0 || degrees === 360) {\n            return 'east';\n        } else if (degrees === 270) {\n            return 'north';\n        } else if (degrees === 180) {\n            return 'west';\n        } else if (degrees > 0 && degrees < 90) {\n            return 'south-east';\n        } else if (degrees > 90 && degrees < 180) {\n            return 'south-west';\n        } else if (degrees > 180 && degrees < 270) {\n            return 'north-west';\n        } else if (degrees > 270 && degrees < 360) {\n            return 'north-east';\n        }\n        throw new Error(`Cannot determine direction of line (${this.p1.x},${this.p1.y}) to (${this.p2.x},${this.p2.y})`);\n    }\n\n    /**\n     * @param otherLine the other line\n     * @returns the intersection point between `this` line and the `otherLine` if exists, or `undefined`.\n     */\n    intersection(otherLine: PointToPointLine): Point | undefined {\n        if (this.hasIndistinctPoints(otherLine)) {\n            return undefined;\n        }\n\n        const x1 = this.p1.x;\n        const y1 = this.p1.y;\n        const x2 = this.p2.x;\n        const y2 = this.p2.y;\n        const x3 = otherLine.p1.x;\n        const y3 = otherLine.p1.y;\n        const x4 = otherLine.p2.x;\n        const y4 = otherLine.p2.y;\n\n        const denominator = ((y4 - y3) * (x2 - x1)) - ((x4 - x3) * (y2 - y1));\n        if (denominator === 0) {\n            return undefined;\n        }\n        const numeratorA = ((x4 - x3) * (y1 - y3)) - ((y4 - y3) * (x1 - x3));\n        const numeratorB = ((x2 - x1) * (y1 - y3)) - ((y2 - y1) * (x1 - x3));\n        if (numeratorA === 0 && numeratorB === 0) {\n            return undefined;\n        }\n\n        const determinantA = numeratorA / denominator;\n        const determinantB = numeratorB / denominator;\n        if (determinantA < 0 || determinantA > 1 || determinantB < 0 || determinantB > 1) {\n            return undefined;\n        }\n\n        const x = x1 + (determinantA * (x2 - x1));\n        const y = y1 + (determinantA * (y2 - y1));\n        return { x, y };\n    }\n\n    /**\n     * @param otherLine the other line\n     * @returns whether the start and end point of this line is does not have distinct start\n     * or end points with the `otherLine`\n     */\n    hasIndistinctPoints(otherLine: PointToPointLine): boolean {\n        return Point.equals(this.p1, otherLine.p1) ||\n            Point.equals(this.p1, otherLine.p2) ||\n            Point.equals(this.p2, otherLine.p1) ||\n            Point.equals(this.p2, otherLine.p2);\n    }\n}\n\n/**\n * Returns the intersection of two lines `l1` and `l2`\n * @param {Line} l1 - A line\n * @param {Line} l2 - Another line\n * @returns {Point} The intersection point of `l1` and `l2`\n */\nexport function intersection(l1: Line, l2: Line): Point {\n    return {\n        x: (l1.c * l2.b - l2.c * l1.b) / (l1.a * l2.b - l2.a * l1.b),\n        y: (l1.a * l2.c - l2.a * l1.c) / (l1.a * l2.b - l2.a * l1.b)\n    };\n}\n\n/**\n * A minimum and maximum value of a numeric type.\n */\nexport interface Limits {\n    min: number\n    max: number\n}\n\n/**\n * Limits a value to the specified `limits`.\n * @param {number} value - The value to limit\n * @param {Limits} limits - The minimum and maximum limits\n */\nexport function limit(value: number, limits: Limits): number {\n    if (value < limits.min) {\n        return limits.min;\n    }\n    if (value > limits.max) {\n        return limits.max;\n    }\n    return value;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2023 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Bounds, Dimension } from 'sprotty-protocol';\nimport { Viewport } from 'sprotty-protocol/lib/model';\nimport { SModelElementImpl, SModelRootImpl } from '../../base/model/smodel';\nimport { limit, Limits } from '../../utils/geometry';\n\nexport const viewportFeature = Symbol('viewportFeature');\n\n/**\n * Determine whether the given model element has a viewport.\n */\nexport function isViewport(element: SModelElementImpl): element is SModelRootImpl & Viewport {\n    return element instanceof SModelRootImpl\n        && element.hasFeature(viewportFeature)\n        && 'zoom' in element\n        && 'scroll' in element;\n}\n\n/**\n * Apply limits to the given viewport.\n */\nexport function limitViewport(viewport: Viewport,\n    canvasBounds: Bounds | undefined,\n    horizontalScrollLimits: Limits | undefined,\n    verticalScrollLimits: Limits | undefined,\n    zoomLimits: Limits | undefined): Viewport {\n    if (canvasBounds && !Dimension.isValid(canvasBounds)) {\n        canvasBounds = undefined;\n    }\n    // Limit the zoom factor\n    let zoom = zoomLimits ? limit(viewport.zoom, zoomLimits) : viewport.zoom;\n    if (canvasBounds && horizontalScrollLimits) {\n        const minZoom = canvasBounds.width / (horizontalScrollLimits.max - horizontalScrollLimits.min);\n        if (zoom < minZoom) {\n            zoom = minZoom;\n        }\n    }\n    if (canvasBounds && verticalScrollLimits) {\n        const minZoom = canvasBounds.height / (verticalScrollLimits.max - verticalScrollLimits.min);\n        if (zoom < minZoom) {\n            zoom = minZoom;\n        }\n    }\n    // Limit the horizontal scroll position\n    let scrollX: number;\n    if (horizontalScrollLimits) {\n        const min = horizontalScrollLimits.min;\n        const max = canvasBounds ? horizontalScrollLimits.max - canvasBounds.width / zoom : horizontalScrollLimits.max;\n        scrollX = limit(viewport.scroll.x, { min, max });\n    } else {\n        scrollX = viewport.scroll.x;\n    }\n    // Limit the vertical scroll position\n    let scrollY: number;\n    if (verticalScrollLimits) {\n        const min = verticalScrollLimits.min;\n        const max = canvasBounds ? verticalScrollLimits.max - canvasBounds.height / zoom : verticalScrollLimits.max;\n        scrollY = limit(viewport.scroll.y, { min, max });\n    } else {\n        scrollY = viewport.scroll.y;\n    }\n    return { scroll: { x: scrollX, y: scrollY }, zoom };\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElementImpl } from '../../base/model/smodel';\n\nexport const exportFeature = Symbol('exportFeature');\n\nexport function isExportable(element: SModelElementImpl): boolean {\n     return element.hasFeature(exportFeature);\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Viewport } from 'sprotty-protocol/lib/model';\nimport { Bounds, Dimension, isBounds, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SModelRootImpl, ModelIndexImpl } from '../../base/model/smodel';\nimport { viewportFeature } from \"./model\";\nimport { exportFeature } from \"../export/model\";\nimport { BoundsAware } from \"../bounds/model\";\n\n/**\n * Model root element that defines a viewport, so it transforms the coordinate system with\n * a `scroll` translation and a `zoom` scaling.\n */\nexport class ViewportRootElementImpl extends SModelRootImpl implements Viewport, BoundsAware {\n    static readonly DEFAULT_FEATURES = [viewportFeature, exportFeature];\n\n    scroll: Point = { x: 0, y: 0 };\n    zoom: number = 1;\n    position: Point = Point.ORIGIN;\n    size: Dimension = Dimension.EMPTY;\n\n    constructor(index?: ModelIndexImpl) {\n        super(index);\n    }\n\n    get bounds(): Bounds {\n        return {\n            x: this.position.x,\n            y: this.position.y,\n            width: this.size.width,\n            height: this.size.height\n        };\n    }\n\n    set bounds(newBounds: Bounds) {\n        this.position = {\n            x: newBounds.x,\n            y: newBounds.y\n        };\n        this.size = {\n            width: newBounds.width,\n            height: newBounds.height\n        };\n    }\n\n    override localToParent(point: Point | Bounds): Bounds {\n        const result = {\n            x: (point.x - this.scroll.x) * this.zoom,\n            y: (point.y - this.scroll.y) * this.zoom,\n            width: -1,\n            height: -1\n        };\n        if (isBounds(point)) {\n            result.width = point.width * this.zoom;\n            result.height = point.height * this.zoom;\n        }\n        return result;\n    }\n\n    override parentToLocal(point: Point | Bounds): Bounds {\n        const result = {\n            x: (point.x / this.zoom) + this.scroll.x,\n            y: (point.y / this.zoom) + this.scroll.y,\n            width: -1,\n            height: -1\n        };\n        if (isBounds(point) && Dimension.isValid(point)) {\n            result.width = point.width / this.zoom;\n            result.height = point.height / this.zoom;\n        }\n        return result;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { ModelIndexImpl, SChildElementImpl, SModelElementImpl } from '../base/model/smodel';\nimport {\n    Alignable, alignFeature, BoundsAware, boundsFeature, layoutableChildFeature, layoutContainerFeature,\n    ModelLayoutOptions, SShapeElementImpl\n} from '../features/bounds/model';\nimport { edgeLayoutFeature, EdgePlacement } from '../features/edge-layout/model';\nimport { deletableFeature } from '../features/edit/delete';\nimport { editFeature } from '../features/edit/model';\nimport { Fadeable, fadeFeature } from '../features/fade/model';\nimport { Hoverable, hoverFeedbackFeature, popupFeature } from '../features/hover/model';\nimport { moveFeature } from '../features/move/model';\nimport { connectableFeature, SConnectableElementImpl, SRoutableElementImpl } from '../features/routing/model';\nimport { Selectable, selectFeature } from '../features/select/model';\nimport { ViewportRootElementImpl } from '../features/viewport/viewport-root';\nimport { FluentIterable, FluentIterableImpl } from '../utils/iterable';\n\n/**\n * Root element for graph-like models.\n */\nexport class SGraphImpl extends ViewportRootElementImpl {\n    layoutOptions?: ModelLayoutOptions;\n\n    constructor(index = new SGraphIndex()) {\n        super(index);\n    }\n}\n\n/**\n * Model element class for nodes, which are the main entities in a graph. A node can be connected to\n * another node via an SEdge. Such a connection can be direct, i.e. the node is the source or target of\n * the edge, or indirect through a port, i.e. it contains an SPort which is the source or target of the edge.\n */\nexport class SNodeImpl extends SConnectableElementImpl implements Selectable, Fadeable, Hoverable {\n    static readonly DEFAULT_FEATURES = [connectableFeature, deletableFeature, selectFeature, boundsFeature,\n        moveFeature, layoutContainerFeature, fadeFeature, hoverFeedbackFeature, popupFeature];\n\n    override children: SChildElementImpl[];\n    layout?: string;\n    selected: boolean = false;\n    hoverFeedback: boolean = false;\n    opacity: number = 1;\n\n    override canConnect(routable: SRoutableElementImpl, role: string) {\n        return this.children.find(c => c instanceof SPortImpl) === undefined;\n    }\n\n    override get incomingEdges(): FluentIterable<SEdgeImpl> {\n        const index = this.index;\n        if (index instanceof SGraphIndex) {\n            return index.getIncomingEdges(this);\n        }\n        const allEdges = this.index.all().filter(e => e instanceof SEdgeImpl) as FluentIterable<SEdgeImpl>;\n        return allEdges.filter(e => e.targetId === this.id);\n    }\n\n    override get outgoingEdges(): FluentIterable<SEdgeImpl> {\n        const index = this.index;\n        if (index instanceof SGraphIndex) {\n            return index.getOutgoingEdges(this);\n        }\n        const allEdges = this.index.all().filter(e => e instanceof SEdgeImpl) as FluentIterable<SEdgeImpl>;\n        return allEdges.filter(e => e.sourceId === this.id);\n    }\n\n}\n\n/**\n * A port is a connection point for edges. It should always be contained in an SNode.\n */\nexport class SPortImpl extends SConnectableElementImpl implements Selectable, Fadeable, Hoverable {\n    static readonly DEFAULT_FEATURES = [connectableFeature, selectFeature, boundsFeature, fadeFeature,\n        hoverFeedbackFeature];\n\n    selected: boolean = false;\n    hoverFeedback: boolean = false;\n    opacity: number = 1;\n\n    override get incomingEdges(): FluentIterable<SEdgeImpl> {\n        const index = this.index;\n        if (index instanceof SGraphIndex) {\n            return index.getIncomingEdges(this);\n        }\n        return super.incomingEdges.filter(e => e instanceof SEdgeImpl) as FluentIterable<SEdgeImpl>;\n    }\n\n    override get outgoingEdges(): FluentIterable<SEdgeImpl> {\n        const index = this.index;\n        if (index instanceof SGraphIndex) {\n            return index.getOutgoingEdges(this);\n        }\n        return super.outgoingEdges.filter(e => e instanceof SEdgeImpl) as FluentIterable<SEdgeImpl>;\n    }\n\n}\n\n\n\n/**\n * Model element class for edges, which are the connectors in a graph. An edge has a source and a target,\n * each of which can be either a node or a port. The source and target elements are referenced via their\n * ids and can be resolved with the index stored in the root element.\n */\nexport class SEdgeImpl extends SRoutableElementImpl implements Fadeable, Selectable, Hoverable, BoundsAware {\n    static readonly DEFAULT_FEATURES = [editFeature, deletableFeature, selectFeature, fadeFeature,\n        hoverFeedbackFeature];\n\n    selected: boolean = false;\n    hoverFeedback: boolean = false;\n    opacity: number = 1;\n\n}\n\n/**\n * A label can be attached to a node, edge, or port, and contains some text to be rendered in its view.\n */\nexport class SLabelImpl extends SShapeElementImpl implements Selectable, Alignable, Fadeable {\n    static readonly DEFAULT_FEATURES = [boundsFeature, alignFeature, layoutableChildFeature,\n        edgeLayoutFeature, fadeFeature];\n\n    text: string;\n    selected: boolean = false;\n    alignment: Point = Point.ORIGIN;\n    opacity = 1;\n    edgePlacement?: EdgePlacement;\n\n}\n\n/**\n * A compartment is used to group multiple child elements such as labels of a node. Usually a `vbox`\n * or `hbox` layout is used to arrange these children.\n */\nexport class SCompartmentImpl extends SShapeElementImpl implements Fadeable {\n    static readonly DEFAULT_FEATURES = [boundsFeature, layoutContainerFeature, layoutableChildFeature,\n        fadeFeature];\n\n    override children: SChildElementImpl[];\n    layout?: string;\n    override layoutOptions?: {[key: string]: string | number | boolean};\n    opacity = 1;\n\n}\n\n\n\n/**\n * A specialized model index that tracks outgoing and incoming edges.\n */\nexport class SGraphIndex extends ModelIndexImpl {\n\n    private outgoing: Map<string, SEdgeImpl[]> = new Map;\n    private incoming: Map<string, SEdgeImpl[]> = new Map;\n\n    override add(element: SModelElementImpl): void {\n        super.add(element);\n        if (element instanceof SEdgeImpl) {\n            // Register the edge in the outgoing map\n            if (element.sourceId) {\n                const sourceArr = this.outgoing.get(element.sourceId);\n                if (sourceArr === undefined)\n                    this.outgoing.set(element.sourceId, [element]);\n                else\n                    sourceArr.push(element);\n            }\n            // Register the edge in the incoming map\n            if (element.targetId) {\n                const targetArr = this.incoming.get(element.targetId);\n                if (targetArr === undefined)\n                    this.incoming.set(element.targetId, [element]);\n                else\n                    targetArr.push(element);\n            }\n        }\n    }\n\n    override remove(element: SModelElementImpl): void {\n        super.remove(element);\n        if (element instanceof SEdgeImpl) {\n            // Remove the edge from the outgoing map\n            const sourceArr = this.outgoing.get(element.sourceId);\n            if (sourceArr !== undefined) {\n                const index = sourceArr.indexOf(element);\n                if (index >= 0) {\n                    if (sourceArr.length === 1)\n                        this.outgoing.delete(element.sourceId);\n                    else\n                        sourceArr.splice(index, 1);\n                }\n            }\n            // Remove the edge from the incoming map\n            const targetArr = this.incoming.get(element.targetId);\n            if (targetArr !== undefined) {\n                const index = targetArr.indexOf(element);\n                if (index >= 0) {\n                    if (targetArr.length === 1)\n                        this.incoming.delete(element.targetId);\n                    else\n                        targetArr.splice(index, 1);\n                }\n            }\n        }\n    }\n\n    override getAttachedElements(element: SModelElementImpl): FluentIterable<SModelElementImpl> {\n        return new FluentIterableImpl(\n            () => ({\n                outgoing: this.outgoing.get(element.id),\n                incoming: this.incoming.get(element.id),\n                nextOutgoingIndex: 0,\n                nextIncomingIndex: 0\n            }),\n            (state) => {\n                let index = state.nextOutgoingIndex;\n                if (state.outgoing !== undefined && index < state.outgoing.length) {\n                    state.nextOutgoingIndex = index + 1;\n                    return { done: false, value: state.outgoing[index] };\n                }\n                index = state.nextIncomingIndex;\n                if (state.incoming !== undefined) {\n                    // Filter out self-loops: edges that are both outgoing and incoming\n                    while (index < state.incoming.length) {\n                        const edge = state.incoming[index];\n                        if (edge.sourceId !== edge.targetId) {\n                            state.nextIncomingIndex = index + 1;\n                            return { done: false, value: edge };\n                        }\n                        index++;\n                    }\n                }\n                return { done: true, value: undefined as any };\n            }\n        );\n    }\n\n    getIncomingEdges(element: SConnectableElementImpl): FluentIterable<SEdgeImpl> {\n        return this.incoming.get(element.id) || [];\n    }\n\n    getOutgoingEdges(element: SConnectableElementImpl): FluentIterable<SEdgeImpl> {\n        return this.outgoing.get(element.id) || [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, multiInject } from \"inversify\";\nimport { Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { TYPES } from \"../../base/types\";\nimport { InstanceRegistry } from \"../../utils/registry\";\nimport { SConnectableElementImpl } from \"./model\";\n\nexport const DIAMOND_ANCHOR_KIND = 'diamond';\nexport const ELLIPTIC_ANCHOR_KIND = 'elliptic';\nexport const RECTANGULAR_ANCHOR_KIND = 'rectangular';\n\nexport interface IAnchorComputer {\n    readonly kind: string;\n\n    /**\n     * Compute an anchor position for routing an edge towards this element.\n     *\n     * The default implementation returns the element's center point. If edges should be connected\n     * differently, e.g. to some point on the boundary of the element's view, the according computation\n     * should be implemented in a subclass by overriding this method.\n     *\n     * @param connectable The node or port an edge should be connected to.\n     * @param referencePoint The point from which the edge is routed towards this elemet, in the same\n     *                       coordintae system as the connectable.\n     * @param offset An optional offset value to be considered in the anchor computation;\n     *               positive values should shift the anchor away from this element, negative values\n     *               should shift the anchor more to the inside. Use this to adapt ot arrow heads.\n     */\n    getAnchor(connectable: SConnectableElementImpl, referencePoint: Point, offset?: number): Point;\n}\n\n\n@injectable()\nexport class AnchorComputerRegistry extends InstanceRegistry<IAnchorComputer> {\n\n    constructor(@multiInject(TYPES.IAnchorComputer) anchors: IAnchorComputer[]) {\n        super();\n        anchors.forEach(anchor => this.register(anchor.kind, anchor));\n    }\n\n    protected get defaultAnchorKind() {\n        return RECTANGULAR_ANCHOR_KIND;\n    }\n\n    override get(routerKind: string, anchorKind?: string): IAnchorComputer {\n        return super.get(`${routerKind}:${anchorKind || this.defaultAnchorKind}`);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2020 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from \"inversify\";\nimport { Bounds, Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { SModelElementImpl, SParentElementImpl } from \"../../base/model/smodel\";\nimport { translateBounds, translatePoint } from \"../../base/model/smodel-utils\";\nimport { ResolvedHandleMove } from \"../move/move\";\nimport { RoutingHandleKind, SDanglingAnchorImpl, SRoutingHandleImpl, edgeInProgressID, edgeInProgressTargetHandleID } from \"./model\";\nimport { AnchorComputerRegistry, IAnchorComputer } from \"./anchor\";\nimport { SConnectableElementImpl, SRoutableElementImpl } from \"./model\";\nimport { EdgeSnapshot, IEdgeRouter, RoutedPoint } from \"./routing\";\n\nexport interface LinearRouteOptions {\n    minimalPointDistance: number\n    standardDistance: number\n    selfEdgeOffset: number\n}\n\nexport enum Side { RIGHT, LEFT, TOP, BOTTOM }\n\nexport class DefaultAnchors {\n    readonly bounds: Bounds;\n    readonly left: RoutedPoint;\n    readonly right: RoutedPoint;\n    readonly top: RoutedPoint;\n    readonly bottom: RoutedPoint;\n\n    constructor(readonly element: SConnectableElementImpl, edgeParent: SParentElementImpl, readonly kind: 'source' | 'target') {\n        const bounds = element.bounds;\n        this.bounds = translateBounds(bounds, element.parent, edgeParent);\n        this.left = { x: this.bounds.x, y: this.bounds.y + 0.5 * this.bounds.height, kind };\n        this.right = { x: this.bounds.x + this.bounds.width, y: this.bounds.y + 0.5 * this.bounds.height, kind };\n        this.top = { x: this.bounds.x + 0.5 * this.bounds.width, y: this.bounds.y, kind };\n        this.bottom = { x: this.bounds.x + 0.5 * this.bounds.width, y: this.bounds.y + this.bounds.height, kind };\n    }\n\n    get(side: Side): RoutedPoint {\n        return (this as any)[Side[side].toLowerCase()];\n    }\n\n    getNearestSide(point: Point): Side {\n        const leftDistance = Point.euclideanDistance(point, this.left);\n        const rightDistance = Point.euclideanDistance(point, this.right);\n        const topDistance = Point.euclideanDistance(point, this.top);\n        const bottomDistance = Point.euclideanDistance(point, this.bottom);\n        let currentNearestSide = Side.LEFT;\n        let currentMinDist = leftDistance;\n        if (rightDistance < currentMinDist) {\n            currentMinDist = rightDistance;\n            currentNearestSide = Side.RIGHT;\n        }\n        if (topDistance < currentMinDist) {\n            currentMinDist = topDistance;\n            currentNearestSide = Side.TOP;\n        }\n        if (bottomDistance < currentMinDist) {\n            currentMinDist = bottomDistance;\n            currentNearestSide = Side.BOTTOM;\n        }\n        return currentNearestSide;\n    }\n}\n\n@injectable()\nexport abstract class AbstractEdgeRouter implements IEdgeRouter {\n\n    @inject(AnchorComputerRegistry) anchorRegistry: AnchorComputerRegistry;\n\n    abstract get kind(): string;\n\n    abstract route(edge: SRoutableElementImpl): RoutedPoint[];\n\n    abstract createRoutingHandles(edge: SRoutableElementImpl): void;\n\n    protected abstract getOptions(edge: SRoutableElementImpl): LinearRouteOptions;\n\n    pointAt(edge: SRoutableElementImpl, t: number): Point | undefined {\n        const segments = this.calculateSegment(edge, t);\n        if (!segments)\n            return undefined;\n        const { segmentStart, segmentEnd, lambda } = segments;\n        return Point.linear(segmentStart, segmentEnd, lambda);\n    }\n\n    derivativeAt(edge: SRoutableElementImpl, t: number): Point | undefined {\n        const segments = this.calculateSegment(edge, t);\n        if (!segments)\n            return undefined;\n        const { segmentStart, segmentEnd } = segments;\n        return {\n            x: segmentEnd.x - segmentStart.x,\n            y: segmentEnd.y - segmentStart.y\n        };\n    }\n\n    protected calculateSegment(edge: SRoutableElementImpl, t: number): { segmentStart: Point, segmentEnd: Point, lambda: number} | undefined {\n        if (t < 0 || t > 1)\n            return undefined;\n        const routedPoints = this.route(edge);\n        if (routedPoints.length < 2)\n            return undefined;\n        const segmentLengths: number[] = [];\n        let totalLength = 0;\n        for (let i = 0; i < routedPoints.length - 1; ++i) {\n            segmentLengths[i] = Point.euclideanDistance(routedPoints[i], routedPoints[i + 1]);\n            totalLength += segmentLengths[i];\n        }\n        let currentLenght = 0;\n        const tAsLenght = t * totalLength;\n        for (let i = 0; i < routedPoints.length - 1; ++i) {\n            const newLength = currentLenght + segmentLengths[i];\n            // avoid division by (almost) zero\n            if (segmentLengths[i] > 1E-8) {\n                if (newLength >= tAsLenght) {\n                    const lambda = Math.max(0, (tAsLenght - currentLenght)) / segmentLengths[i];\n                    return {\n                        segmentStart: routedPoints[i],\n                        segmentEnd: routedPoints[i + 1],\n                        lambda\n                    };\n                }\n            }\n            currentLenght = newLength;\n        }\n        return {\n            segmentEnd: routedPoints.pop()!,\n            segmentStart: routedPoints.pop()!,\n            lambda: 1\n        };\n    }\n\n    protected addHandle(edge: SRoutableElementImpl, kind: RoutingHandleKind, type: string, routingPointIndex: number): SRoutingHandleImpl {\n        const handle = new SRoutingHandleImpl();\n        handle.kind = kind;\n        handle.pointIndex = routingPointIndex;\n        handle.type = type;\n        if (kind === 'target' && edge.id === edgeInProgressID)\n            handle.id = edgeInProgressTargetHandleID;\n        edge.add(handle);\n        return handle;\n    }\n\n    getHandlePosition(edge: SRoutableElementImpl, route: RoutedPoint[], handle: SRoutingHandleImpl): Point | undefined {\n        switch (handle.kind) {\n            case 'source':\n                if (edge.source instanceof SDanglingAnchorImpl)\n                    return edge.source.position;\n                else\n                    return route[0];\n            case 'target':\n                if (edge.target instanceof SDanglingAnchorImpl)\n                    return edge.target.position;\n                 else {\n                    return route[route.length - 1];\n                }\n            default:\n                const position = this.getInnerHandlePosition(edge, route, handle);\n                if (position !== undefined)\n                    return position;\n                if (handle.pointIndex >= 0 && handle.pointIndex < edge.routingPoints.length)\n                    return edge.routingPoints[handle.pointIndex];\n        }\n        return undefined;\n    }\n\n    protected abstract getInnerHandlePosition(edge: SRoutableElementImpl, route: RoutedPoint[], handle: SRoutingHandleImpl): Point | undefined;\n\n    protected findRouteSegment(edge: SRoutableElementImpl, route: RoutedPoint[], handleIndex: number): { start?: Point, end?: Point } {\n        const getIndex = (rp: RoutedPoint) => {\n            if (rp.pointIndex !== undefined)\n                return rp.pointIndex;\n            else if (rp.kind === 'target')\n                return edge.routingPoints.length;\n            else\n                return -2;\n        };\n        let start, end: RoutedPoint | undefined;\n        for (const rp of route) {\n            const i = getIndex(rp);\n            if (i <= handleIndex && (start === undefined || i > getIndex(start)))\n                start = rp;\n            if (i > handleIndex && (end === undefined || i < getIndex(end)))\n                end = rp;\n        }\n        return { start, end };\n    }\n\n    getTranslatedAnchor(connectable: SConnectableElementImpl, refPoint: Point, refContainer: SParentElementImpl, edge: SRoutableElementImpl, anchorCorrection: number = 0): Point {\n        const translatedRefPoint = translatePoint(refPoint, refContainer, connectable.parent);\n        const anchorComputer = this.getAnchorComputer(connectable);\n        const strokeCorrection = 0.5 * connectable.strokeWidth;\n        const anchor = anchorComputer.getAnchor(connectable, translatedRefPoint, anchorCorrection + strokeCorrection);\n        return translatePoint(anchor, connectable.parent, edge.parent);\n    }\n\n    protected getAnchorComputer(connectable: SConnectableElementImpl): IAnchorComputer {\n       return this.anchorRegistry.get(this.kind, connectable.anchorKind);\n    }\n\n    applyHandleMoves(edge: SRoutableElementImpl, moves: ResolvedHandleMove[]): void {\n        const remainingMoves = moves.slice();\n        moves.forEach(move => {\n            const handle = move.handle;\n            if (handle.kind === 'source' && !(edge.source instanceof SDanglingAnchorImpl)) {\n                // detach source\n                const anchor = new SDanglingAnchorImpl();\n                anchor.id = edge.id + '_dangling-source';\n                anchor.original = edge.source;\n                anchor.position = move.toPosition;\n                handle.root.add(anchor);\n                handle.danglingAnchor = anchor;\n                edge.sourceId = anchor.id;\n            } else if (handle.kind === 'target' && !(edge.target instanceof SDanglingAnchorImpl)) {\n                // detach target\n                const anchor = new SDanglingAnchorImpl();\n                anchor.id = edge.id + '_dangling-target';\n                anchor.original = edge.target;\n                anchor.position = move.toPosition;\n                handle.root.add(anchor);\n                handle.danglingAnchor = anchor;\n                edge.targetId = anchor.id;\n            }\n            if (handle.danglingAnchor) {\n                handle.danglingAnchor.position = move.toPosition;\n                remainingMoves.splice(remainingMoves.indexOf(move), 1);\n            }\n        });\n        if (remainingMoves.length > 0)\n            this.applyInnerHandleMoves(edge, remainingMoves);\n        this.cleanupRoutingPoints(edge, edge.routingPoints, true, true);\n    }\n\n    protected abstract applyInnerHandleMoves(edge: SRoutableElementImpl, moves: ResolvedHandleMove[]): void;\n\n    cleanupRoutingPoints(edge: SRoutableElementImpl, routingPoints: Point[], updateHandles: boolean, addRoutingPoints: boolean) {\n        const sourceAnchors = new DefaultAnchors(edge.source!, edge.parent, \"source\");\n        const targetAnchors = new DefaultAnchors(edge.target!, edge.parent, \"target\");\n        this.resetRoutingPointsOnReconnect(edge, routingPoints, updateHandles, sourceAnchors, targetAnchors);\n    }\n\n    protected resetRoutingPointsOnReconnect(edge: SRoutableElementImpl, routingPoints: Point[], updateHandles: boolean,\n        sourceAnchors: DefaultAnchors, targetAnchors: DefaultAnchors): boolean {\n        if (routingPoints.length === 0 || edge.source instanceof SDanglingAnchorImpl || edge.target instanceof SDanglingAnchorImpl) {\n            const options = this.getOptions(edge);\n            const corners = this.calculateDefaultCorners(edge, sourceAnchors, targetAnchors, options);\n            routingPoints.splice(0, routingPoints.length, ...corners);\n            if (updateHandles) {\n                let maxPointIndex = -2;\n                edge.children.forEach(child => {\n                    if (child instanceof SRoutingHandleImpl) {\n                        if (child.kind === 'target')\n                            child.pointIndex = routingPoints.length;\n                        else if (child.kind === 'line' && child.pointIndex >= routingPoints.length)\n                            edge.remove(child);\n                        else\n                            maxPointIndex = Math.max(child.pointIndex, maxPointIndex);\n                    }\n                });\n                for (let i = maxPointIndex; i < routingPoints.length - 1; ++i)\n                    this.addHandle(edge, 'manhattan-50%', 'volatile-routing-point', i);\n            }\n            return true;\n        }\n        return false;\n    }\n\n    applyReconnect(edge: SRoutableElementImpl, newSourceId?: string, newTargetId?: string) {\n        let hasChanged = false;\n        if (newSourceId) {\n            const newSource = edge.root.index.getById(newSourceId);\n            if (newSource instanceof SConnectableElementImpl) {\n                edge.sourceId = newSource.id;\n                hasChanged = true;\n            }\n        }\n        if (newTargetId) {\n            const newTarget = edge.root.index.getById(newTargetId);\n            if (newTarget instanceof SConnectableElementImpl) {\n                edge.targetId = newTarget.id;\n                hasChanged = true;\n            }\n        }\n        if (hasChanged) {\n            // reset attached elements in index\n            edge.index.remove(edge);\n            edge.index.add(edge);\n            if (this.getSelfEdgeIndex(edge) > -1) {\n                edge.routingPoints = [];\n                this.cleanupRoutingPoints(edge, edge.routingPoints, true, true);\n            }\n        }\n    }\n\n    takeSnapshot(edge: SRoutableElementImpl): EdgeSnapshot {\n        return {\n            routingPoints: edge.routingPoints.slice(),\n            routingHandles: edge.children\n                .filter(child => child instanceof SRoutingHandleImpl)\n                .map(child => child as SRoutingHandleImpl),\n            routedPoints: this.route(edge),\n            router: this,\n            source: edge.source,\n            target: edge.target\n        };\n    }\n\n    applySnapshot(edge: SRoutableElementImpl, snapshot: EdgeSnapshot): void {\n        edge.routingPoints = snapshot.routingPoints;\n        edge.removeAll(child => child instanceof SRoutingHandleImpl);\n        edge.routerKind = snapshot.router.kind;\n        snapshot.routingHandles.forEach(handle => edge.add(handle));\n        if (snapshot.source)\n            edge.sourceId = snapshot.source.id;\n        if (snapshot.target)\n            edge.targetId = snapshot.target.id;\n        // update index\n        edge.root.index.remove(edge as SModelElementImpl);\n        edge.root.index.add(edge as SModelElementImpl);\n    }\n\n    protected calculateDefaultCorners(edge: SRoutableElementImpl, sourceAnchors: DefaultAnchors, targetAnchors: DefaultAnchors, options: LinearRouteOptions): Point[] {\n        const selfEdgeIndex = this.getSelfEdgeIndex(edge);\n        if (selfEdgeIndex >= 0) {\n            const standardDist = options.standardDistance;\n            const delta = options.selfEdgeOffset * Math.min(sourceAnchors.bounds.width, sourceAnchors.bounds.height);\n            switch (selfEdgeIndex % 4) {\n                case 0:\n                    return [\n                        { x: sourceAnchors.get(Side.RIGHT).x + standardDist, y: sourceAnchors.get(Side.RIGHT).y + delta },\n                        { x: sourceAnchors.get(Side.RIGHT).x + standardDist, y: sourceAnchors.get(Side.BOTTOM).y + standardDist },\n                        { x: sourceAnchors.get(Side.BOTTOM).x + delta, y: sourceAnchors.get(Side.BOTTOM).y + standardDist },\n                    ];\n                case 1:\n                    return [\n                        { x: sourceAnchors.get(Side.BOTTOM).x - delta, y: sourceAnchors.get(Side.BOTTOM).y + standardDist },\n                        { x: sourceAnchors.get(Side.LEFT).x - standardDist, y: sourceAnchors.get(Side.BOTTOM).y + standardDist },\n                        { x: sourceAnchors.get(Side.LEFT).x - standardDist, y: sourceAnchors.get(Side.LEFT).y + delta},\n                    ];\n                case 2:\n                    return [\n                        { x: sourceAnchors.get(Side.LEFT).x - standardDist, y: sourceAnchors.get(Side.LEFT).y - delta },\n                        { x: sourceAnchors.get(Side.LEFT).x - standardDist, y: sourceAnchors.get(Side.TOP).y - standardDist },\n                        { x: sourceAnchors.get(Side.TOP).x - delta, y: sourceAnchors.get(Side.TOP).y - standardDist },\n                    ];\n                case 3:\n                    return [\n                        { x: sourceAnchors.get(Side.TOP).x + delta, y: sourceAnchors.get(Side.TOP).y - standardDist },\n                        { x: sourceAnchors.get(Side.RIGHT).x + standardDist, y: sourceAnchors.get(Side.TOP).y - standardDist },\n                        { x: sourceAnchors.get(Side.RIGHT).x + standardDist, y: sourceAnchors.get(Side.RIGHT).y - delta },\n                    ];\n            }\n        }\n        return [];\n    }\n\n    protected getSelfEdgeIndex(edge: SRoutableElementImpl): number {\n        if (!edge.source || edge.source !== edge.target)\n            return -1;\n        return edge.source.outgoingEdges\n            .filter(otherEdge => otherEdge.target === edge.source)\n            .indexOf(edge);\n    }\n\n    protected commitRoute(edge: SRoutableElementImpl, routedPoints: RoutedPoint[]) {\n        const newRoutingPoints: Point[] = [];\n        for (let i = 1; i < routedPoints.length - 1; ++i)\n            newRoutingPoints.push({ x: routedPoints[i].x, y: routedPoints[i].y });\n        edge.routingPoints = newRoutingPoints;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from \"inversify\";\nimport { angleBetweenPoints, Bounds, centerOfLine, Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { SRoutingHandleImpl } from \"./model\";\nimport { ResolvedHandleMove } from \"../move/move\";\nimport { AnchorComputerRegistry } from \"./anchor\";\nimport { AbstractEdgeRouter, LinearRouteOptions } from \"./abstract-edge-router\";\nimport { SRoutableElementImpl } from \"./model\";\nimport { RoutedPoint } from \"./routing\";\n\nexport interface PolylineRouteOptions extends LinearRouteOptions {\n    /** The angle in radians below which a routing handle is removed. */\n    removeAngleThreshold: number;\n}\n\n@injectable()\nexport class PolylineEdgeRouter extends AbstractEdgeRouter {\n\n    @inject(AnchorComputerRegistry) override anchorRegistry: AnchorComputerRegistry;\n\n    static readonly KIND = 'polyline';\n\n    get kind() {\n        return PolylineEdgeRouter.KIND;\n    }\n\n    protected getOptions(edge: SRoutableElementImpl): PolylineRouteOptions {\n        return {\n            minimalPointDistance: 2,\n            removeAngleThreshold: 0.1,\n            standardDistance: 20,\n            selfEdgeOffset: 0.25\n        };\n    }\n\n    route(edge: SRoutableElementImpl): RoutedPoint[] {\n        const source = edge.source;\n        const target = edge.target;\n        if (source === undefined || target === undefined) {\n            return [];\n        }\n\n        let sourceAnchor: Point;\n        let targetAnchor: Point;\n        const options = this.getOptions(edge);\n        const routingPoints = edge.routingPoints.length > 0\n            ? edge.routingPoints\n            : [];\n        this.cleanupRoutingPoints(edge, routingPoints, false, false);\n        const rpCount = routingPoints !== undefined ? routingPoints.length : 0;\n        if (rpCount === 0) {\n            // Use the target center as start anchor reference\n            const startRef = Bounds.center(target.bounds);\n            sourceAnchor = this.getTranslatedAnchor(source, startRef, target.parent, edge, edge.sourceAnchorCorrection);\n            // Use the source center as end anchor reference\n            const endRef = Bounds.center(source.bounds);\n            targetAnchor = this.getTranslatedAnchor(target, endRef, source.parent, edge, edge.targetAnchorCorrection);\n        } else {\n            // Use the first routing point as start anchor reference\n            const p0 = routingPoints[0];\n            sourceAnchor = this.getTranslatedAnchor(source, p0, edge.parent, edge, edge.sourceAnchorCorrection);\n            // Use the last routing point as end anchor reference\n            const pn = routingPoints[rpCount - 1];\n            targetAnchor = this.getTranslatedAnchor(target, pn, edge.parent, edge, edge.targetAnchorCorrection);\n        }\n\n        const result: RoutedPoint[] = [];\n        result.push({ kind: 'source', x: sourceAnchor.x, y: sourceAnchor.y });\n        for (let i = 0; i < rpCount; i++) {\n            const p = routingPoints[i];\n            if (i > 0 && i < rpCount - 1\n                || i === 0 && Point.maxDistance(sourceAnchor, p) >= options.minimalPointDistance + (edge.sourceAnchorCorrection || 0)\n                || i === rpCount - 1 && Point.maxDistance(p, targetAnchor) >= options.minimalPointDistance + (edge.targetAnchorCorrection || 0)) {\n                result.push({ kind: 'linear', x: p.x, y: p.y, pointIndex: i });\n            }\n        }\n        result.push({ kind: 'target', x: targetAnchor.x, y: targetAnchor.y });\n            return this.filterEditModeHandles(result, edge, options);\n    }\n\n    /**\n     * Remove routed points that are in edit mode and for which the angle between the preceding and\n     * following points falls below a threshold.\n     */\n    protected filterEditModeHandles(route: RoutedPoint[], edge: SRoutableElementImpl, options: PolylineRouteOptions): RoutedPoint[] {\n        if (edge.children.length === 0)\n            return route;\n\n        let i = 0;\n        while (i < route.length) {\n            const curr = route[i];\n            if (curr.pointIndex !== undefined) {\n                const handle: SRoutingHandleImpl | undefined = edge.children.find(child =>\n                    child instanceof SRoutingHandleImpl && child.kind === 'junction' && child.pointIndex === curr.pointIndex) as any;\n                if (handle !== undefined && handle.editMode && i > 0 && i < route.length - 1) {\n                    const prev = route[i - 1], next = route[i + 1];\n                    const prevDiff: Point = { x: prev.x - curr.x, y: prev.y - curr.y };\n                    const nextDiff: Point = { x: next.x - curr.x, y: next.y - curr.y };\n                    const angle = angleBetweenPoints(prevDiff, nextDiff);\n                    if (Math.abs(Math.PI - angle) < options.removeAngleThreshold) {\n                        route.splice(i, 1);\n                        continue;\n                    }\n                }\n            }\n            i++;\n        }\n        return route;\n    }\n\n    createRoutingHandles(edge: SRoutableElementImpl): void {\n        const rpCount = edge.routingPoints.length;\n        this.addHandle(edge, 'source', 'routing-point', -2);\n        this.addHandle(edge, 'line', 'volatile-routing-point', -1);\n        for (let i = 0; i < rpCount; i++) {\n            this.addHandle(edge, 'junction', 'routing-point', i);\n            this.addHandle(edge, 'line', 'volatile-routing-point', i);\n        }\n        this.addHandle(edge, 'target', 'routing-point', rpCount);\n    }\n\n    getInnerHandlePosition(edge: SRoutableElementImpl, route: RoutedPoint[], handle: SRoutingHandleImpl) {\n        if (handle.kind === 'line') {\n            const { start, end } = this.findRouteSegment(edge, route, handle.pointIndex);\n            if (start !== undefined && end !== undefined)\n                return centerOfLine(start, end);\n        }\n        return undefined;\n    }\n\n    applyInnerHandleMoves(edge: SRoutableElementImpl, moves: ResolvedHandleMove[]) {\n        moves.forEach(move => {\n            const handle = move.handle;\n            const points = edge.routingPoints;\n            let index = handle.pointIndex;\n            if (handle.kind === 'line') {\n                // Upgrade to a proper routing point\n                handle.kind = 'junction';\n                handle.type = 'routing-point';\n                points.splice(index + 1, 0, move.fromPosition || points[Math.max(index, 0)]);\n                edge.children.forEach(child => {\n                    if (child instanceof SRoutingHandleImpl && (child === handle || child.pointIndex > index))\n                        child.pointIndex++;\n                });\n                this.addHandle(edge, 'line', 'volatile-routing-point', index);\n                index++;\n                this.addHandle(edge, 'line', 'volatile-routing-point', index);\n            }\n            if (index >= 0 && index < points.length) {\n                points[index] = move.toPosition;\n            }\n        });\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2018-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, multiInject, optional } from \"inversify\";\nimport { Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { SParentElementImpl } from \"../../base/model/smodel\";\nimport { TYPES } from \"../../base/types\";\nimport { findArgValue, IViewArgs } from \"../../base/views/view\";\nimport { InstanceRegistry } from \"../../utils/registry\";\nimport { ResolvedHandleMove } from \"../move/move\";\nimport { SRoutingHandleImpl } from \"../routing/model\";\nimport { SConnectableElementImpl, SRoutableElementImpl } from \"./model\";\nimport { PolylineEdgeRouter } from \"./polyline-edge-router\";\n\n/**\n * A point describing the shape of an edge.\n *\n * The <code>RoutedPoints</code> of an edge are derived from the <code>routingPoints</code>\n * which plain <code>Points</code> stored in the SModel by the <code>IEdgeRouter</code>.\n * As opposed to the originals, they also contain the source and target anchor points.\n * The router may also add or remove points in order to satisfy the constraints\n * the constraints of the routing algorithm or in order to to filter out points which are\n * obsolete, e.g. to close to each other.\n */\nexport interface RoutedPoint extends Point {\n    kind: 'source' | 'target' | 'linear' | 'bezier-control-before' | 'bezier-junction' | 'bezier-control-after'\n    pointIndex?: number\n}\n\n/**\n * Stores the state of an edge at a specific time.\n */\nexport interface EdgeSnapshot {\n    routingHandles: SRoutingHandleImpl[]\n    routingPoints: Point[]\n    routedPoints: RoutedPoint[]\n    router: IEdgeRouter\n    source?: SConnectableElementImpl\n    target?: SConnectableElementImpl\n}\n\nexport interface EdgeMemento {\n    edge: SRoutableElementImpl\n    before: EdgeSnapshot\n    after: EdgeSnapshot\n}\n\n/**\n * Encapsulates the logic of how the actual shape of an edge is derived from its routing points,\n * and how the user can modify it.\n */\nexport interface IEdgeRouter {\n\n    readonly kind: string;\n\n    /**\n     * Calculates the route of the given edge.\n     */\n    route(edge: SRoutableElementImpl): RoutedPoint[]\n\n    /**\n     * Calculates a point on the edge\n     *\n     * @param t a value between 0 (sourceAnchor) and 1 (targetAnchor)\n     * @returns the point or undefined if t is out of bounds or it cannot be computed\n     */\n    pointAt(edge: SRoutableElementImpl, t: number): Point | undefined\n\n    /**\n     * Calculates the derivative at a point on the edge.\n     *\n     * @param t a value between 0 (sourceAnchor) and 1 (targetAnchor)\n     * @returns the point or undefined if t is out of bounds or it cannot be computed\n     */\n    derivativeAt(edge: SRoutableElementImpl, t: number): Point | undefined\n\n    /**\n     * Retuns the position of the given handle based on the routing points of the edge.\n     */\n    getHandlePosition(edge: SRoutableElementImpl, route: RoutedPoint[], handle: SRoutingHandleImpl): Point | undefined\n\n    /**\n     * Creates the routing handles for the given target.\n     */\n    createRoutingHandles(edge: SRoutableElementImpl): void\n\n    /**\n     * Updates the routing points and handles of the given edge with regard to the given moves.\n     */\n    applyHandleMoves(edge: SRoutableElementImpl, moves: ResolvedHandleMove[]): void\n\n    /**\n     * Updates the routing points and handles of the given edge with regard to the given moves.\n     */\n    applyReconnect(edge: SRoutableElementImpl, newSourceId?: string, newTargetId?: string): void\n\n    /**\n     * Remove/add points in order to keep routing constraints consistent, or reset RPs on reconnect.\n     */\n    cleanupRoutingPoints(edge: SRoutableElementImpl, routingPoints: Point[], updateHandles: boolean, addRoutingPoints: boolean): void;\n    /**\n     * Creates a snapshot of the given edge, storing all the data needed to restore it to\n     * its current state.\n     */\n    takeSnapshot(edge: SRoutableElementImpl): EdgeSnapshot;\n\n    /**\n     * Applies a snapshot to the current edge.\n     */\n    applySnapshot(edge: SRoutableElementImpl, edgeSnapshot: EdgeSnapshot): void;\n}\n\nexport interface IMultipleEdgesRouter extends IEdgeRouter {\n    routeAll(\n        edges: SRoutableElementImpl[],\n        parent: Readonly<SParentElementImpl>\n    ): EdgeRouting;\n}\n\nfunction isMultipleEdgesRouter(\n    router: IEdgeRouter | IMultipleEdgesRouter\n): router is IMultipleEdgesRouter {\n    return (router as IMultipleEdgesRouter).routeAll !== undefined;\n}\n\n/** A postprocessor that is applied to all routes, once they are computed. */\nexport interface IEdgeRoutePostprocessor {\n    apply(routing: EdgeRouting): void;\n}\n\n@injectable()\nexport class EdgeRouterRegistry extends InstanceRegistry<IEdgeRouter> {\n\n    @multiInject(TYPES.IEdgeRoutePostprocessor) @optional()\n    protected postProcessors: IEdgeRoutePostprocessor[];\n\n    constructor(@multiInject(TYPES.IEdgeRouter) edgeRouters: IEdgeRouter[]) {\n        super();\n        edgeRouters.forEach(router => this.register(router.kind, router));\n    }\n\n    protected get defaultKind() {\n        return PolylineEdgeRouter.KIND;\n    }\n\n    override get(kind: string | undefined): IEdgeRouter {\n        return super.get(kind || this.defaultKind);\n    }\n\n    /**\n     * Computes the routes of all edges contained by the specified `parent`.\n     * After all routes are available, it'll apply the registered `EdgeRoutePostProcessors`.\n     * @param parent the parent to traverse for edges\n     * @returns the routes of all edges that are children of `parent`\n     */\n    routeAllChildren(parent: Readonly<SParentElementImpl>): EdgeRouting {\n        const routing = this.doRouteAllChildren(parent);\n        for (const postProcessor of this.postProcessors) {\n            postProcessor.apply(routing);\n        }\n        return routing;\n    }\n\n    /**\n     * Recursively traverses the children of `parent`, collects children grouped by router kind,\n     * and then routes them either.\n     * @param parent the parent to traverse for edges\n     * @returns the routes of all edges that are children of `parent`\n     */\n    protected doRouteAllChildren(parent: Readonly<SParentElementImpl>) {\n        const routing = new EdgeRouting();\n        const routersEdges = new Map<string, SRoutableElementImpl[]>();\n\n        const elementsToProcess = [parent];\n        while (elementsToProcess.length > 0) {\n            const element = elementsToProcess.shift() as SParentElementImpl;\n            for (const child of element.children) {\n                if (child instanceof SRoutableElementImpl) {\n                    const routerKind = child.routerKind || this.defaultKind;\n                    if (routersEdges.has(routerKind)) {\n                        (routersEdges.get(routerKind) as SRoutableElementImpl[]).push(child);\n                    } else {\n                        routersEdges.set(routerKind, [child]);\n                    }\n                }\n                if (child instanceof SParentElementImpl) {\n                    elementsToProcess.push(child);\n                }\n            }\n        }\n\n        routersEdges.forEach((edges, routerKind) => {\n            const childRouter = this.get(routerKind);\n            if (isMultipleEdgesRouter(childRouter)) {\n                routing.setAll(childRouter.routeAll(edges, parent));\n            } else {\n                for (const edge of  edges) {\n                    routing.set(edge.id, this.route(edge));\n                }\n            }\n        });\n\n        return routing;\n    }\n\n    /**\n     * Computes or obtains the route of a single edge.\n     * @param edge the edge to be routed\n     * @param args arguments that may contain an `EdgeRouting` already\n     * @returns the route of the specified `edge`\n     */\n    route(edge: Readonly<SRoutableElementImpl>, args?: IViewArgs): RoutedPoint[] {\n        const edgeRouting = findArgValue<EdgeRouting>(args, 'edgeRouting');\n        if (edgeRouting) {\n            const route = edgeRouting.get(edge.id);\n            if (route) {\n                return route;\n            }\n        }\n        const router = this.get(edge.routerKind);\n        return router.route(edge);\n    }\n\n}\n\n/** Any object that contains a routing, such as an argument object passed to views for rendering. */\nexport interface EdgeRoutingContainer {\n    edgeRouting: EdgeRouting;\n}\n\n/**\n * Map of edges and their computed routes.\n */\nexport class EdgeRouting {\n\n    protected routesMap = new Map<string, RoutedPoint[]>();\n\n    set(routableId: string, route: RoutedPoint[]): void {\n        this.routesMap.set(routableId, route);\n    }\n\n    setAll(otherRoutes: EdgeRouting): void {\n        otherRoutes.routes.forEach((route, routableId) => this.set(routableId, route));\n    }\n\n    get(routableId: string): RoutedPoint[] | undefined {\n        return this.routesMap.get(routableId);\n    }\n\n    get routes() {\n        return this.routesMap;\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from \"inversify\";\nimport { VNode } from \"snabbdom\";\nimport { Bounds, Point, toDegrees } from \"sprotty-protocol/lib/utils/geometry\";\nimport { SModelElementImpl, SChildElementImpl } from \"../../base/model/smodel\";\nimport { IVNodePostprocessor } from \"../../base/views/vnode-postprocessor\";\nimport { setAttr } from \"../../base/views/vnode-utils\";\nimport { SEdgeImpl } from \"../../graph/sgraph\";\nimport { Orientation } from \"../../utils/geometry\";\nimport { isAlignable, BoundsAware } from \"../bounds/model\";\nimport { DEFAULT_EDGE_PLACEMENT, isEdgeLayoutable, EdgeLayoutable, EdgePlacement } from \"./model\";\nimport { EdgeRouterRegistry } from \"../routing/routing\";\n\n@injectable()\nexport class EdgeLayoutPostprocessor implements IVNodePostprocessor {\n\n    @inject(EdgeRouterRegistry) edgeRouterRegistry: EdgeRouterRegistry;\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        if (isEdgeLayoutable(element) && element.parent instanceof SEdgeImpl) {\n            if (element.bounds !== Bounds.EMPTY) {\n                const placement = this.getEdgePlacement(element);\n                const edge = element.parent;\n                const position = Math.min(1, Math.max(0, placement.position));\n                const router = this.edgeRouterRegistry.get(edge.routerKind);\n                const pointOnEdge = router.pointAt(edge, position);\n                const derivativeOnEdge = router.derivativeAt(edge, position);\n                let transform = '';\n                if (pointOnEdge && derivativeOnEdge) {\n                    transform += `translate(${pointOnEdge.x}, ${pointOnEdge.y})`;\n                    const angle = toDegrees(Math.atan2(derivativeOnEdge.y, derivativeOnEdge.x));\n                    if (placement.rotate) {\n                        let flippedAngle = angle;\n                        if (Math.abs(angle) > 90) {\n                             if (angle < 0)\n                                flippedAngle += 180;\n                            else if (angle > 0)\n                                flippedAngle -= 180;\n                        }\n                        transform += ` rotate(${flippedAngle})`;\n                        const alignment = this.getRotatedAlignment(element, placement, flippedAngle !== angle);\n                        transform += ` translate(${alignment.x}, ${alignment.y})`;\n                    } else {\n                        const alignment = this.getAlignment(element, placement, angle);\n                        transform += ` translate(${alignment.x}, ${alignment.y})`;\n                    }\n                    setAttr(vnode, 'transform', transform);\n                }\n            }\n        }\n        return vnode;\n    }\n\n    protected getRotatedAlignment(element: EdgeLayoutable & SModelElementImpl & BoundsAware, placement: EdgePlacement, flip: boolean) {\n        let x = isAlignable(element) ? element.alignment.x : 0;\n        let y = isAlignable(element) ? element.alignment.y : 0;\n        const bounds = element.bounds;\n        if (placement.side === 'on')\n            return { x: x - 0.5 * bounds.height, y: y - 0.5 * bounds.height};\n        if (flip) {\n            if (placement.position < 0.3333333)\n                x -= bounds.width + placement.offset;\n            else if (placement.position < 0.6666666)\n                x -= 0.5 * bounds.width;\n            else\n                x += placement.offset;\n            switch (placement.side) {\n                case 'left':\n                case 'bottom':\n                    y -= placement.offset + bounds.height;\n                    break;\n                case 'right':\n                case 'top':\n                    y += placement.offset;\n            }\n        } else {\n            if (placement.position < 0.3333333)\n                x += placement.offset;\n            else if (placement.position < 0.6666666)\n                x -= 0.5 * bounds.width;\n            else\n                x -= bounds.width + placement.offset;\n            switch (placement.side) {\n                case 'right':\n                case 'bottom':\n                    y += - placement.offset - bounds.height;\n                    break;\n                case 'left':\n                case 'top':\n                    y += placement.offset;\n            }\n        }\n        return { x, y };\n    }\n\n    protected getEdgePlacement(element: SModelElementImpl): EdgePlacement {\n        let current = element;\n        const allPlacements: EdgePlacement[] = [];\n        while (current !== undefined) {\n            const placement = (current as any).edgePlacement;\n            if (placement !== undefined)\n                allPlacements.push(placement);\n            if (current instanceof SChildElementImpl)\n                current = current.parent;\n            else\n                break;\n        }\n        return allPlacements.reverse().reduce(\n            (a, b) => { return {...a, ...b}; }, DEFAULT_EDGE_PLACEMENT);\n    }\n\n    protected getAlignment(label: EdgeLayoutable & SModelElementImpl & BoundsAware, placement: EdgePlacement, angle: number): Point {\n        const bounds = label.bounds;\n        const x = isAlignable(label) ? label.alignment.x - bounds.width : 0;\n        const y = isAlignable(label) ? label.alignment.y - bounds.height : 0;\n        if (placement.side === 'on') {\n            return { x: x + 0.5 * bounds.width, y: y + 0.5 * bounds.height};\n        }\n        const quadrant = this.getQuadrant(angle);\n        const midLeft = { x: placement.offset, y: y + 0.5 * bounds.height };\n        const topLeft = { x: placement.offset, y: y + bounds.height + placement.offset };\n        const topRight = { x: -bounds.width - placement.offset, y: y + bounds.height + placement.offset};\n        const midRight = { x: -bounds.width - placement.offset, y: y + 0.5 * bounds.height };\n        const bottomRight = { x: -bounds.width - placement.offset, y: y - placement.offset};\n        const bottomLeft = { x: placement.offset, y: y - placement.offset};\n        switch (placement.side) {\n            case 'left':\n                switch (quadrant.orientation) {\n                    case 'west':\n                        return Point.linear(topLeft, topRight, quadrant.position);\n                    case 'north':\n                        return Point.linear(topRight, bottomRight, quadrant.position);\n                    case 'east':\n                        return Point.linear(bottomRight, bottomLeft, quadrant.position);\n                    case 'south':\n                        return Point.linear(bottomLeft, topLeft, quadrant.position);\n                }\n                break;\n            case 'right':\n                switch (quadrant.orientation) {\n                    case 'west':\n                        return Point.linear(bottomRight, bottomLeft, quadrant.position);\n                    case 'north':\n                        return Point.linear(bottomLeft, topLeft, quadrant.position);\n                    case 'east':\n                        return Point.linear(topLeft, topRight, quadrant.position);\n                    case 'south':\n                        return Point.linear(topRight, bottomRight, quadrant.position);\n                }\n                break;\n            case 'top':\n                switch (quadrant.orientation) {\n                    case 'west':\n                        return Point.linear(bottomRight, bottomLeft, quadrant.position);\n                    case 'north':\n                        return this.linearFlip(bottomLeft, midLeft, midRight, bottomRight, quadrant.position);\n                    case 'east':\n                        return Point.linear(bottomRight, bottomLeft, quadrant.position);\n                    case 'south':\n                        return this.linearFlip(bottomLeft, midLeft, midRight, bottomRight, quadrant.position);\n                }\n                break;\n            case 'bottom':\n                switch (quadrant.orientation) {\n                    case 'west':\n                        return Point.linear(topLeft, topRight, quadrant.position);\n                    case 'north':\n                        return this.linearFlip(topRight, midRight, midLeft, topLeft, quadrant.position);\n                    case 'east':\n                        return Point.linear(topLeft, topRight, quadrant.position);\n                    case 'south':\n                        return this.linearFlip(topRight, midRight, midLeft, topLeft, quadrant.position);\n                }\n                break;\n        }\n        return {x: 0, y: 0};\n    }\n\n    protected getQuadrant(angle: number): {orientation: Orientation, position: number} {\n        if (Math.abs(angle) > 135)\n            return { orientation: 'west', position: (angle > 0 ? angle - 135 : angle + 225) / 90 };\n        else if (angle < -45)\n            return { orientation: 'north', position: (angle + 135) / 90 };\n        else if (angle < 45)\n            return { orientation: 'east', position: (angle + 45) / 90 };\n        else\n            return { orientation: 'south', position: (angle - 45) / 90 };\n    }\n\n    protected linearFlip(p0: Point, p1: Point, p2: Point, p3: Point, position: number) {\n        return position < 0.5 ? Point.linear(p0, p1, 2 * position) : Point.linear(p2, p3, 2 * position - 1);\n    }\n\n    postUpdate(): void {}\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { EdgeLayoutPostprocessor } from \"./edge-layout\";\n\nconst edgeLayoutModule = new ContainerModule(bind => {\n    bind(EdgeLayoutPostprocessor).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(EdgeLayoutPostprocessor);\n    bind(TYPES.HiddenVNodePostprocessor).toService(EdgeLayoutPostprocessor);\n});\n\nexport default edgeLayoutModule;\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { CreateElementAction } from 'sprotty-protocol/lib/actions';\nimport { Command, CommandExecutionContext, CommandReturn } from '../../base/commands/command';\nimport { SParentElementImpl, SChildElementImpl } from '../../base/model/smodel';\nimport { TYPES } from '../../base/types';\n\n@injectable()\nexport class CreateElementCommand extends Command {\n    static readonly KIND = CreateElementAction.KIND;\n\n    container: SParentElementImpl;\n    newElement: SChildElementImpl;\n\n    constructor(@inject(TYPES.Action) protected readonly action: CreateElementAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const container = context.root.index.getById(this.action.containerId);\n        if (container instanceof SParentElementImpl) {\n            this.container = container;\n            this.newElement = context.modelFactory.createElement(this.action.elementSchema);\n            this.container.add(this.newElement);\n        }\n        return context.root;\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        this.container.remove(this.newElement);\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        this.container.add(this.newElement);\n        return context.root;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { SModelElementImpl } from \"../../base/model/smodel\";\n\nexport const creatingOnDragFeature = Symbol('creatingOnDragFeature');\n\n/**\n *  Feature extension interface for {@link creatingOnDragFeature}.\n */\nexport interface CreatingOnDrag {\n    createAction(id: string): Action;\n}\n\nexport function isCreatingOnDrag<T extends SModelElementImpl>(element: T): element is T & CreatingOnDrag {\n    return element.hasFeature(creatingOnDragFeature) && (element as any).createAction !== undefined;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/** @jsx svg */\nimport { svg }\u00A0from './jsx';\n\nimport { VNode } from \"snabbdom\";\nimport { Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { IView, IViewArgs, RenderingContext } from \"../base/views/view\";\nimport { SNodeImpl, SPortImpl } from \"../graph/sgraph\";\nimport { ViewportRootElementImpl } from \"../features/viewport/viewport-root\";\nimport { SShapeElementImpl } from '../features/bounds/model';\nimport { ShapeView } from '../features/bounds/views';\nimport { Hoverable } from '../features/hover/model';\nimport { Selectable } from '../features/select/model';\nimport { Diamond } from '../utils/geometry';\nimport { SModelElementImpl } from '../base/model/smodel';\nimport { injectable } from 'inversify';\n\n@injectable()\nexport class SvgViewportView implements IView {\n    render(model: Readonly<ViewportRootElementImpl>, context: RenderingContext, args?: IViewArgs): VNode {\n        const transform = `scale(${model.zoom}) translate(${-model.scroll.x},${-model.scroll.y})`;\n        return <svg>\n            <g transform={transform}>\n                {context.renderChildren(model)}\n            </g>\n        </svg>;\n    }\n}\n\n@injectable()\nexport class CircularNodeView extends ShapeView {\n    render(node: Readonly<SShapeElementImpl & Hoverable & Selectable>, context: RenderingContext, args?: IViewArgs): VNode | undefined {\n        if (!this.isVisible(node, context)) {\n            return undefined;\n        }\n        const radius = this.getRadius(node);\n        return <g>\n            <circle class-sprotty-node={node instanceof SNodeImpl} class-sprotty-port={node instanceof SPortImpl}\n                    class-mouseover={node.hoverFeedback} class-selected={node.selected}\n                    r={radius} cx={radius} cy={radius}></circle>\n            {context.renderChildren(node)}\n        </g>;\n    }\n\n    protected getRadius(node: SShapeElementImpl): number {\n        const d = Math.min(node.size.width, node.size.height);\n        return d > 0 ? d / 2 : 0;\n    }\n}\n\n@injectable()\nexport class RectangularNodeView extends ShapeView {\n    render(node: Readonly<SShapeElementImpl & Hoverable & Selectable>, context: RenderingContext, args?: IViewArgs): VNode | undefined {\n        if (!this.isVisible(node, context)) {\n            return undefined;\n        }\n        return <g>\n            <rect class-sprotty-node={node instanceof SNodeImpl} class-sprotty-port={node instanceof SPortImpl}\n                  class-mouseover={node.hoverFeedback} class-selected={node.selected}\n                  x=\"0\" y=\"0\" width={Math.max(node.size.width, 0)} height={Math.max(node.size.height, 0)}></rect>\n            {context.renderChildren(node)}\n        </g>;\n    }\n}\n\n@injectable()\nexport class DiamondNodeView extends ShapeView {\n    render(node: Readonly<SShapeElementImpl & Hoverable & Selectable>, context: RenderingContext, args?: IViewArgs): VNode | undefined {\n        if (!this.isVisible(node, context)) {\n            return undefined;\n        }\n        const diamond = new Diamond({ height: Math.max(node.size.height, 0), width: Math.max(node.size.width, 0), x: 0, y: 0 });\n        const points = `${svgStr(diamond.topPoint)} ${svgStr(diamond.rightPoint)} ${svgStr(diamond.bottomPoint)} ${svgStr(diamond.leftPoint)}`;\n        return <g>\n            <polygon class-sprotty-node={node instanceof SNodeImpl} class-sprotty-port={node instanceof SPortImpl}\n                  class-mouseover={node.hoverFeedback} class-selected={node.selected}\n                  points={points} />\n            {context.renderChildren(node)}\n        </g>;\n    }\n}\n\nfunction svgStr(point: Point) {\n    return `${point.x},${point.y}`;\n}\n\n@injectable()\nexport class EmptyGroupView implements IView {\n    render(model: Readonly<SModelElementImpl>, context: RenderingContext): VNode {\n        return <g></g>;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject } from 'inversify';\nimport { Action, isAction, ApplyLabelEditAction } from 'sprotty-protocol/lib/actions';\nimport { CommandExecutionContext, CommandReturn, Command } from '../../base/commands/command';\nimport { SModelElementImpl } from '../../base/model/smodel';\nimport { TYPES } from '../../base/types';\nimport { MouseListener } from '../../base/views/mouse-tool';\nimport { KeyListener } from '../../base/views/key-tool';\nimport { matchesKeystroke } from '../../utils/keyboard';\nimport { isSelectable } from '../select/model';\nimport { toArray } from '../../utils/iterable';\nimport { EditableLabel, isEditableLabel, isWithEditableLabel } from './model';\n\nexport interface EditLabelAction extends Action {\n    kind: typeof EditLabelAction.KIND\n    labelId: string\n}\nexport namespace EditLabelAction {\n    export const KIND = 'EditLabel';\n\n    export function create(labelId: string): EditLabelAction {\n        return {\n            kind: KIND,\n            labelId\n        };\n    }\n}\n\nexport function isEditLabelAction(element?: any): element is EditLabelAction {\n    return isAction(element) && element.kind === EditLabelAction.KIND && 'labelId' in element;\n}\n\nexport function isApplyLabelEditAction(element?: any): element is ApplyLabelEditAction {\n    return isAction(element) && element.kind === ApplyLabelEditAction.KIND && 'labelId' in element && 'text' in element;\n}\n\nexport class ResolvedLabelEdit {\n    label: EditableLabel;\n    oldLabel: string;\n    newLabel: string;\n}\n\nexport class ApplyLabelEditCommand extends Command {\n    static readonly KIND = ApplyLabelEditAction.KIND;\n\n    protected resolvedLabelEdit: ResolvedLabelEdit;\n\n    constructor(@inject(TYPES.Action) protected readonly action: ApplyLabelEditAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const index = context.root.index;\n        const label = index.getById(this.action.labelId);\n        if (label && isEditableLabel(label)) {\n            this.resolvedLabelEdit = { label, oldLabel: label.text, newLabel: this.action.text };\n            label.text = this.action.text;\n        }\n        return context.root;\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        if (this.resolvedLabelEdit) {\n            this.resolvedLabelEdit.label.text = this.resolvedLabelEdit.oldLabel;\n        }\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        if (this.resolvedLabelEdit) {\n            this.resolvedLabelEdit.label.text = this.resolvedLabelEdit.newLabel;\n        }\n        return context.root;\n    }\n\n}\n\nexport interface IEditLabelValidator {\n    validate(value: string, label: EditableLabel & SModelElementImpl): Promise<EditLabelValidationResult>;\n}\n\nexport interface EditLabelValidationResult {\n    readonly severity: Severity;\n    readonly message?: string;\n}\n\nexport type Severity = 'ok' | 'warning' | 'error';\n\nexport class EditLabelMouseListener extends MouseListener {\n    override doubleClick(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        const editableLabel = getEditableLabel(target);\n        if (editableLabel) {\n            return [EditLabelAction.create(editableLabel.id)];\n        }\n        return [];\n    }\n}\n\nexport class EditLabelKeyListener extends KeyListener {\n    override keyDown(element: SModelElementImpl, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'F2')) {\n            const editableLabels = toArray(element.index.all()\n                .filter(e => isSelectable(e) && e.selected)).map(getEditableLabel)\n                .filter((e): e is EditableLabel & SModelElementImpl => e !== undefined);\n            if (editableLabels.length === 1) {\n                return [EditLabelAction.create(editableLabels[0].id)];\n            }\n        }\n        return [];\n    }\n}\n\nexport function getEditableLabel(element: SModelElementImpl): EditableLabel & SModelElementImpl | undefined {\n    if (isEditableLabel(element)) {\n        return element;\n    } else if (isWithEditableLabel(element) && element.editableLabel) {\n        return element.editableLabel;\n    }\n    return undefined;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from \"inversify\";\nimport { RequestAction, ResponseAction } from 'sprotty-protocol/lib/actions';\nimport { Bounds } from 'sprotty-protocol/lib/utils/geometry';\nimport { ViewerOptions } from '../../base/views/viewer-options';\nimport { isBoundsAware } from '../bounds/model';\nimport { ActionDispatcher } from '../../base/actions/action-dispatcher';\nimport { TYPES } from '../../base/types';\nimport { SModelRootImpl } from '../../base/model/smodel';\nimport { ILogger } from '../../utils/logging';\n\nexport interface ExportSvgAction extends ResponseAction {\n    kind: typeof ExportSvgAction.KIND;\n    svg: string\n    responseId: string\n}\nexport namespace ExportSvgAction {\n    export const KIND = 'exportSvg';\n\n    export function create(svg: string, requestId: string): ExportSvgAction {\n        return {\n            kind: KIND,\n            svg,\n            responseId: requestId\n        };\n    }\n}\n\n@injectable()\nexport class SvgExporter {\n\n    @inject(TYPES.ViewerOptions) protected options: ViewerOptions;\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: ActionDispatcher;\n    @inject(TYPES.ILogger) protected log: ILogger;\n\n    export(root: SModelRootImpl, request?: RequestAction<ExportSvgAction>): void {\n        if (typeof document !== 'undefined') {\n            const div = document.getElementById(this.options.hiddenDiv);\n            if (div !== null && div.firstElementChild && div.firstElementChild.tagName === 'svg') {\n                const svgElement = div.firstElementChild as SVGSVGElement;\n                const svg = this.createSvg(svgElement, root);\n                this.actionDispatcher.dispatch(ExportSvgAction.create(svg, request ? request.requestId : ''));\n            }\n        }\n    }\n\n    protected createSvg(svgElementOrig: SVGSVGElement, root: SModelRootImpl): string {\n        const serializer = new XMLSerializer();\n        const svgCopy = serializer.serializeToString(svgElementOrig);\n        const iframe: HTMLIFrameElement = document.createElement('iframe');\n        document.body.appendChild(iframe);\n        if (!iframe.contentWindow)\n            throw new Error('IFrame has no contentWindow');\n        const docCopy = iframe.contentWindow.document;\n        docCopy.open();\n        docCopy.write(svgCopy);\n        docCopy.close();\n        const svgElementNew = docCopy.getElementById(svgElementOrig.id)!;\n        svgElementNew.removeAttribute('opacity');\n        this.copyStyles(svgElementOrig, svgElementNew, ['width', 'height', 'opacity']);\n        svgElementNew.setAttribute('version', '1.1');\n        const bounds = this.getBounds(root);\n        svgElementNew.setAttribute('viewBox', `${bounds.x} ${bounds.y} ${bounds.width} ${bounds.height}`);\n        const svgCode = serializer.serializeToString(svgElementNew);\n        document.body.removeChild(iframe);\n        return svgCode;\n    }\n\n    protected copyStyles(source: Element, target: Element, skipedProperties: string[]) {\n        const sourceStyle = getComputedStyle(source);\n        const targetStyle = getComputedStyle(target);\n        let diffStyle = '';\n        for (let i = 0; i < sourceStyle.length; i++) {\n            const key = sourceStyle[i];\n            if (skipedProperties.indexOf(key) === -1) {\n                const value = sourceStyle.getPropertyValue(key);\n                if (targetStyle.getPropertyValue(key) !== value) {\n                    diffStyle += key + \":\" + value + \";\";\n                }\n            }\n        }\n        if (diffStyle !== '')\n            target.setAttribute('style', diffStyle);\n        // IE doesn't retrun anything on source.children\n        for (let i = 0; i < source.childNodes.length; ++i) {\n            const sourceChild = source.childNodes[i];\n            const targetChild = target.childNodes[i];\n            if (sourceChild instanceof Element)\n                this.copyStyles(sourceChild, targetChild as Element, []);\n        }\n    }\n\n    protected getBounds(root: SModelRootImpl) {\n        const allBounds: Bounds[] = [ Bounds.EMPTY ];\n        root.children.forEach(element => {\n            if (isBoundsAware(element)) {\n                allBounds.push(element.bounds);\n            }\n        });\n        return allBounds.reduce((one, two) => Bounds.combine(one, two));\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { Action, ComputedBoundsAction, RequestModelAction } from 'sprotty-protocol/lib/actions';\nimport { SModelElement, SModelRoot } from 'sprotty-protocol/lib/model';\nimport { Dimension, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SModelIndex } from 'sprotty-protocol/lib/utils/model-utils';\nimport { IActionDispatcher } from '../base/actions/action-dispatcher';\nimport { ActionHandlerRegistry, IActionHandler, IActionHandlerInitializer } from '../base/actions/action-handler';\nimport { ICommand } from '../base/commands/command';\nimport { TYPES } from '../base/types';\nimport { ViewerOptions } from '../base/views/viewer-options';\nimport { ExportSvgAction } from '../features/export/svg-exporter';\n\n/**\n * A model source is serving the model to the event cycle. It represents\n * the entry point to the client for external sources, such as model\n * editors.\n *\n * As an `IActionHandler` it listens to actions in and reacts to them with\n * commands or actions if necessary. This way, you can implement action\n * protocols between the client and the outside world.\n *\n * There are two default implementations for a ModelSource:\n *\n *  - The `LocalModelSource` handles the actions to calculate bounds and\n *    set/update the model\n *  - the `DiagramServerProxy` connects via websocket to a remote source.\n *    It can be used to connect to a model editor that provides the model,\n *    layouts diagrams, transfers selection and answers model queries from\n *    the client.\n */\n@injectable()\nexport abstract class ModelSource implements IActionHandler, IActionHandlerInitializer {\n\n    @inject(TYPES.IActionDispatcher) readonly actionDispatcher: IActionDispatcher;\n    @inject(TYPES.ViewerOptions) protected viewerOptions: ViewerOptions;\n\n    initialize(registry: ActionHandlerRegistry): void {\n        // Register this model source\n        registry.register(RequestModelAction.KIND, this);\n        registry.register(ExportSvgAction.KIND, this);\n    }\n\n    abstract get model(): SModelRoot;\n\n    abstract handle(action: Action): ICommand | Action | void;\n\n    /**\n     * Commit changes from the internal SModel back to the currentModel.\n     *\n     * This method is meant to be called only by CommitModelCommand and other commands\n     * that need to feed the current internal model back to the model source. It does\n     * not have any side effects such as triggering layout or bounds computation, as the\n     * internal model is already current. See `CommitModelAction` for details.\n     *\n     * @param newRoot the new model.\n     * @return the previous model.\n     */\n    abstract commitModel(newRoot: SModelRoot): Promise<SModelRoot> | SModelRoot;\n}\n\n\n@injectable()\nexport class ComputedBoundsApplicator {\n    apply(root: SModelRoot, action: ComputedBoundsAction): SModelIndex {\n        const index = new SModelIndex();\n        index.add(root);\n        for (const b of action.bounds) {\n            const element = index.getById(b.elementId);\n            if (element !== undefined)\n                this.applyBounds(element, b.newPosition, b.newSize);\n        }\n        if (action.alignments !== undefined) {\n            for (const a of action.alignments) {\n                const element = index.getById(a.elementId);\n                if (element !== undefined)\n                    this.applyAlignment(element, a.newAlignment);\n            }\n        }\n        return index;\n    }\n\n    protected applyAlignment(element: SModelElement, newAlignment: Point) {\n        const e = element as any;\n        e.alignment = { x: newAlignment.x, y: newAlignment.y };\n    }\n\n    protected applyBounds(element: SModelElement, newPosition: Point | undefined, newSize: Dimension) {\n        const e = element as any;\n        if (newPosition)\n            e.position = {...newPosition};\n        e.size = {...newSize};\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { Action } from 'sprotty-protocol/lib/actions';\nimport { SModelRoot } from 'sprotty-protocol/lib/model';\nimport { CommandExecutionContext, CommandReturn, SystemCommand } from '../base/commands/command';\nimport { SModelRootImpl } from '../base/model/smodel';\nimport { TYPES } from '../base/types';\nimport { ModelSource } from './model-source';\n\n/**\n * Commit the current SModel back to the model source.\n *\n * The SModel (AKA internal model) contains a lot of dirty/transitional state, such\n * as intermediate move postions or handles. When a user interaction that spans multiple\n * commands finishes, it fires a CommitModelAction to write the final changes back to\n * the model source.\n */\nexport interface CommitModelAction extends Action {\n    kind: typeof CommitModelAction.KIND;\n}\nexport namespace CommitModelAction {\n    export const KIND = 'commitModel';\n\n    export function create(): CommitModelAction {\n        return {\n            kind: KIND\n        };\n    }\n}\n\n@injectable()\nexport class CommitModelCommand extends SystemCommand {\n    static readonly KIND = CommitModelAction.KIND;\n\n    @inject(TYPES.ModelSource) modelSource: ModelSource;\n\n    originalModel: SModelRoot;\n    newModel: SModelRoot;\n\n    constructor(@inject(TYPES.Action) protected readonly action: CommitModelAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        this.newModel = context.modelFactory.createSchema(context.root);\n        return this.doCommit(this.newModel, context.root, true);\n    }\n\n    protected doCommit(model: SModelRoot, result: SModelRootImpl, doSetOriginal: boolean): CommandReturn {\n        const commitResult = this.modelSource.commitModel(model);\n        if (commitResult instanceof Promise) {\n            return commitResult.then(originalModel => {\n                if (doSetOriginal)\n                    this.originalModel = originalModel;\n                return result;\n            });\n        } else {\n            if (doSetOriginal)\n                this.originalModel = commitResult;\n            return result;\n        }\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        return this.doCommit(this.originalModel, context.root, false);\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        return this.doCommit(this.newModel, context.root, false);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2023 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject } from 'inversify';\nimport { Action, SetViewportAction } from 'sprotty-protocol/lib/actions';\nimport { Viewport } from 'sprotty-protocol/lib/model';\nimport { almostEquals, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SModelElementImpl, SModelRootImpl } from '../../base/model/smodel';\nimport { findParentByFeature } from '../../base/model/smodel-utils';\nimport { TYPES } from '../../base/types';\nimport { MouseListener } from '../../base/views/mouse-tool';\nimport { ViewerOptions } from '../../base/views/viewer-options';\nimport { getWindowScroll } from '../../utils/browser';\nimport { isViewport } from './model';\n\nexport function getZoom(label: SModelElementImpl) {\n    let zoom = 1;\n    const viewport = findParentByFeature(label, isViewport);\n    if (viewport) {\n        zoom = viewport.zoom;\n    }\n    return zoom;\n}\n\nexport class ZoomMouseListener extends MouseListener {\n\n    @inject(TYPES.ViewerOptions) protected viewerOptions: ViewerOptions;\n\n    override wheel(target: SModelElementImpl, event: WheelEvent): Action[] {\n        const viewport = findParentByFeature(target, isViewport);\n        if (!viewport) {\n            return [];\n        }\n        const newViewport = this.isScrollMode(event) ? this.processScroll(viewport, event) : this.processZoom(viewport, target, event);\n        if (newViewport) {\n            return [SetViewportAction.create(viewport.id, newViewport, { animate: false })];\n        }\n        return [];\n    }\n\n    protected isScrollMode(event: WheelEvent) {\n        return event.altKey;\n    }\n\n    protected processScroll(viewport: Viewport, event: WheelEvent): Viewport {\n        return {\n            scroll: {\n                x: viewport.scroll.x + event.deltaX,\n                y: viewport.scroll.y + event.deltaY\n            },\n            zoom: viewport.zoom\n        };\n    }\n\n    protected processZoom(viewport: Viewport, target: SModelElementImpl, event: WheelEvent): Viewport | undefined {\n        const zoomFactor = this.getZoomFactor(event);\n        if (zoomFactor > 1 && almostEquals(viewport.zoom, this.viewerOptions.zoomLimits.max)\n            || zoomFactor < 1 && almostEquals(viewport.zoom, this.viewerOptions.zoomLimits.min)) {\n            return;\n        }\n        const zoom = viewport.zoom * zoomFactor;\n        const viewportOffset = this.getViewportOffset(target.root, event);\n        const offsetFactor = 1.0 / zoom - 1.0 / viewport.zoom;\n        return {\n            scroll: {\n                x: viewport.scroll.x - offsetFactor * viewportOffset.x,\n                y: viewport.scroll.y - offsetFactor * viewportOffset.y\n            },\n            zoom\n        };\n    }\n\n    protected getViewportOffset(root: SModelRootImpl, event: WheelEvent): Point {\n        const canvasBounds = root.canvasBounds;\n        const windowScroll = getWindowScroll();\n        return {\n            x: event.clientX + windowScroll.x - canvasBounds.x,\n            y: event.clientY + windowScroll.y - canvasBounds.y\n        };\n    }\n\n    protected getZoomFactor(event: WheelEvent): number {\n        if (event.deltaMode === event.DOM_DELTA_PAGE)\n            return Math.exp(-event.deltaY * 0.5);\n        else if (event.deltaMode === event.DOM_DELTA_LINE)\n            return Math.exp(-event.deltaY * 0.05);\n        else // deltaMode === DOM_DELTA_PIXEL\n            return Math.exp(-event.deltaY * 0.005);\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2022 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, optional } from 'inversify';\nimport { Action, ApplyLabelEditAction } from 'sprotty-protocol/lib/actions';\nimport { IActionDispatcherProvider } from '../../base/actions/action-dispatcher';\nimport { IActionHandler } from '../../base/actions/action-handler';\nimport { ICommand } from '../../base/commands/command';\nimport { SModelElementImpl, SModelRootImpl } from '../../base/model/smodel';\nimport { TYPES } from '../../base/types';\nimport { AbstractUIExtension } from '../../base/ui-extensions/ui-extension';\nimport { SetUIExtensionVisibilityAction } from '../../base/ui-extensions/ui-extension-registry';\nimport { DOMHelper } from '../../base/views/dom-helper';\nimport { ViewerOptions } from '../../base/views/viewer-options';\nimport { CommitModelAction } from '../../model-source/commit-model';\nimport { matchesKeystroke, KeyCode, KeyboardModifier } from '../../utils/keyboard';\nimport { getAbsoluteClientBounds } from '../bounds/model';\nimport { getZoom } from '../viewport/zoom';\nimport { EditLabelValidationResult, IEditLabelValidator, isEditLabelAction, Severity } from './edit-label';\nimport { EditableLabel, isEditableLabel } from './model';\n\n/** Shows a UI extension for editing a label on emitted `EditLabelAction`s. */\n@injectable()\nexport class EditLabelActionHandler implements IActionHandler {\n    handle(action: Action): void | Action | ICommand {\n        if (isEditLabelAction(action)) {\n            return SetUIExtensionVisibilityAction.create({ extensionId: EditLabelUI.ID, visible: true, contextElementsId: [action.labelId] });\n        }\n    }\n}\n\nexport interface IEditLabelValidationDecorator {\n    decorate(input: HTMLInputElement | HTMLTextAreaElement, validationResult: EditLabelValidationResult): void;\n    dispose(input: HTMLInputElement | HTMLTextAreaElement): void;\n}\n\n@injectable()\nexport class EditLabelUI extends AbstractUIExtension {\n    static readonly ID = 'editLabelUi';\n\n    @inject(TYPES.IActionDispatcherProvider) public actionDispatcherProvider: IActionDispatcherProvider;\n    @inject(TYPES.ViewerOptions) protected viewerOptions: ViewerOptions;\n    @inject(TYPES.DOMHelper) protected domHelper: DOMHelper;\n    @inject(TYPES.IEditLabelValidator) @optional() public labelValidator: IEditLabelValidator;\n    @inject(TYPES.IEditLabelValidationDecorator) @optional() public validationDecorator: IEditLabelValidationDecorator;\n\n    protected inputElement: HTMLInputElement;\n    protected textAreaElement: HTMLTextAreaElement;\n\n    protected label?: EditableLabel & SModelElementImpl;\n    protected labelElement: HTMLElement | null;\n    protected validationTimeout?: number = undefined;\n    protected isActive: boolean = false;\n    protected blockApplyEditOnInvalidInput = true;\n    protected isCurrentLabelValid: boolean = true;\n    protected previousLabelContent?: string;\n\n    public id() { return EditLabelUI.ID; }\n    public containerClass() { return 'label-edit'; }\n\n    protected get labelId() { return this.label ? this.label.id : 'unknown'; }\n\n    protected initializeContents(containerElement: HTMLElement) {\n        containerElement.style.position = 'absolute';\n        this.inputElement = document.createElement('input');\n        this.textAreaElement = document.createElement('textarea');\n        [this.inputElement, this.textAreaElement].forEach((element) => {\n            element.onkeydown = event => this.applyLabelEditOnEvent(event, 'Enter');\n            this.configureAndAdd(element, containerElement);\n        });\n    }\n\n    protected configureAndAdd(element: HTMLInputElement | HTMLTextAreaElement, containerElement: HTMLElement) {\n        element.style.visibility = 'hidden';\n        element.style.position = 'absolute';\n        element.style.top = '0px';\n        element.style.left = '0px';\n        element.addEventListener('keydown', (event: KeyboardEvent) => this.hideIfEscapeEvent(event));\n        element.addEventListener('keyup', (event: KeyboardEvent) => this.validateLabelIfContentChange(event, element.value));\n        element.addEventListener('blur', () => window.setTimeout(() => this.applyLabelEdit(), 200));\n        containerElement.appendChild(element);\n    }\n\n    get editControl(): HTMLInputElement | HTMLTextAreaElement {\n        if (this.label && this.label.isMultiLine) {\n            return this.textAreaElement;\n        }\n        return this.inputElement;\n    }\n\n    protected hideIfEscapeEvent(event: KeyboardEvent) {\n        if (matchesKeystroke(event, 'Escape')) { this.hide(); }\n    }\n\n    protected applyLabelEditOnEvent(event: KeyboardEvent, code?: KeyCode, ...modifiers: KeyboardModifier[]) {\n        if (matchesKeystroke(event, code ? code : 'Enter', ...modifiers)) {\n            event.preventDefault();\n            this.applyLabelEdit();\n        }\n    }\n\n    protected validateLabelIfContentChange(event: KeyboardEvent, value: string) {\n        if (this.previousLabelContent === undefined || this.previousLabelContent !== value) {\n            this.previousLabelContent = value;\n            this.performLabelValidation(event, this.editControl.value);\n        }\n    }\n\n    protected async applyLabelEdit() {\n        if (!this.isActive) {\n            return;\n        }\n        if (this.label?.text === this.editControl.value) {\n            // no action necessary\n            this.hide();\n            return;\n        }\n        if (this.blockApplyEditOnInvalidInput) {\n            const result = await this.validateLabel(this.editControl.value);\n            if ('error' === result.severity) {\n                this.editControl.focus();\n                return;\n            }\n        }\n        this.actionDispatcherProvider()\n            .then((actionDispatcher) => actionDispatcher.dispatchAll([ApplyLabelEditAction.create(this.labelId, this.editControl.value), CommitModelAction.create()]))\n            .catch((reason) => this.logger.error(this, 'No action dispatcher available to execute apply label edit action', reason));\n        this.hide();\n    }\n\n    protected performLabelValidation(event: KeyboardEvent, value: string) {\n        if (this.validationTimeout) {\n            window.clearTimeout(this.validationTimeout);\n        }\n        this.validationTimeout = window.setTimeout(() => this.validateLabel(value), 200);\n    }\n\n    protected async validateLabel(value: string): Promise<EditLabelValidationResult> {\n        if (this.labelValidator && this.label) {\n            try {\n                const result = await this.labelValidator.validate(value, this.label);\n                this.isCurrentLabelValid = 'error' !== result.severity;\n                this.showValidationResult(result);\n                return result;\n            } catch (reason) {\n                this.logger.error(this, 'Error validating edited label', reason);\n            }\n        }\n        this.isCurrentLabelValid = true;\n        return { severity: <Severity>'ok', message: undefined };\n    }\n\n    protected showValidationResult(result: EditLabelValidationResult) {\n        this.clearValidationResult();\n        if (this.validationDecorator) {\n            this.validationDecorator.decorate(this.editControl, result);\n        }\n    }\n\n    protected clearValidationResult() {\n        if (this.validationDecorator) {\n            this.validationDecorator.dispose(this.editControl);\n        }\n    }\n\n    override show(root: Readonly<SModelRootImpl>, ...contextElementIds: string[]) {\n        if (!hasEditableLabel(contextElementIds, root) || this.isActive) {\n            return;\n        }\n        super.show(root, ...contextElementIds);\n        this.isActive = true;\n    }\n\n    override hide(): void {\n        this.editControl.style.visibility = 'hidden';\n        super.hide();\n        this.clearValidationResult();\n        this.isActive = false;\n        this.isCurrentLabelValid = true;\n        this.previousLabelContent = undefined;\n        if (this.labelElement) {\n            this.labelElement.style.visibility = 'visible';\n        }\n    }\n\n    protected override onBeforeShow(containerElement: HTMLElement, root: Readonly<SModelRootImpl>, ...contextElementIds: string[]) {\n        this.label = getEditableLabels(contextElementIds, root)[0];\n        this.previousLabelContent = this.label.text;\n        this.setPosition(containerElement);\n        this.applyTextContents();\n        this.applyFontStyling();\n        this.editControl.style.visibility = 'visible';\n        this.editControl.focus();\n    }\n\n    protected setPosition(containerElement: HTMLElement) {\n        let x = 0;\n        let y = 0;\n        let width = 100;\n        let height = 20;\n\n        if (this.label) {\n            const zoom = getZoom(this.label);\n            const bounds = getAbsoluteClientBounds(this.label, this.domHelper, this.viewerOptions);\n            x = bounds.x + (this.label.editControlPositionCorrection ? this.label.editControlPositionCorrection.x : 0) * zoom;\n            y = bounds.y + (this.label.editControlPositionCorrection ? this.label.editControlPositionCorrection.y : 0) * zoom;\n            height = (this.label.editControlDimension ? this.label.editControlDimension.height : height) * zoom;\n            width = (this.label.editControlDimension ? this.label.editControlDimension.width : width) * zoom;\n        }\n\n        containerElement.style.left = `${x}px`;\n        containerElement.style.top = `${y}px`;\n        containerElement.style.width = `${width}px`;\n        this.editControl.style.width = `${width}px`;\n        containerElement.style.height = `${height}px`;\n        this.editControl.style.height = `${height}px`;\n    }\n\n    protected applyTextContents() {\n        if (this.label) {\n            this.editControl.value = this.label.text;\n            if (this.editControl instanceof HTMLTextAreaElement) {\n                this.editControl.selectionStart = 0;\n                this.editControl.selectionEnd = 0;\n                this.editControl.scrollTop = 0;\n                this.editControl.scrollLeft = 0;\n            } else {\n                this.editControl.setSelectionRange(0, this.editControl.value.length);\n            }\n        }\n    }\n\n    protected applyFontStyling() {\n        if (this.label) {\n            this.labelElement = document.getElementById(this.domHelper.createUniqueDOMElementId(this.label));\n            if (this.labelElement) {\n                this.labelElement.style.visibility = 'hidden';\n                const style = window.getComputedStyle(this.labelElement);\n                this.editControl.style.font = style.font;\n                this.editControl.style.fontStyle = style.fontStyle;\n                this.editControl.style.fontFamily = style.fontFamily;\n                this.editControl.style.fontSize = scaledFont(style.fontSize, getZoom(this.label));\n                this.editControl.style.fontWeight = style.fontWeight;\n                this.editControl.style.lineHeight = style.lineHeight;\n            }\n        }\n    }\n}\n\nfunction hasEditableLabel(contextElementIds: string[], root: Readonly<SModelRootImpl>) {\n    return getEditableLabels(contextElementIds, root).length === 1;\n}\n\nfunction getEditableLabels(contextElementIds: string[], root: Readonly<SModelRootImpl>) {\n    return contextElementIds.map(id => root.index.getById(id)).filter(isEditableLabel);\n}\n\nfunction scaledFont(font: string, zoom: number): string {\n    return font.replace(/\\d+(\\.\\d+)?/, (match) => {\n        return String(Number.parseInt(match, 10) * zoom);\n    });\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from \"inversify\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { Command, CommandExecutionContext, CommandReturn } from \"../../base/commands/command\";\nimport { SModelElementImpl, SModelRootImpl, SParentElementImpl } from '../../base/model/smodel';\nimport { TYPES } from \"../../base/types\";\nimport { SRoutableElementImpl, SRoutingHandleImpl } from \"../routing/model\";\nimport { EdgeRouterRegistry } from \"../routing/routing\";\nimport { canEditRouting } from './model';\n\nexport interface SwitchEditModeAction extends Action {\n    kind: typeof SwitchEditModeAction.KIND;\n    elementsToActivate: string[]\n    elementsToDeactivate: string[]\n}\nexport namespace SwitchEditModeAction {\n    export const KIND = \"switchEditMode\";\n\n    export function create(options: { elementsToActivate?: string[], elementsToDeactivate?: string[] }): SwitchEditModeAction {\n        return {\n            kind: KIND,\n            elementsToActivate: options.elementsToActivate ?? [],\n            elementsToDeactivate: options.elementsToDeactivate ?? []\n        };\n    }\n}\n\n@injectable()\nexport class SwitchEditModeCommand extends Command {\n    static readonly KIND: string = SwitchEditModeAction.KIND;\n\n    @inject(EdgeRouterRegistry) edgeRouterRegistry: EdgeRouterRegistry;\n\n    protected elementsToActivate: SModelElementImpl[] = [];\n    protected elementsToDeactivate: SModelElementImpl[] = [];\n    protected handlesToRemove: { handle: SRoutingHandleImpl, parent: SRoutableElementImpl, point?: Point }[] = [];\n\n    constructor(@inject(TYPES.Action) protected readonly action: SwitchEditModeAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const index = context.root.index;\n        this.action.elementsToActivate.forEach(id => {\n            const element = index.getById(id);\n            if (element !== undefined )\n                this.elementsToActivate.push(element);\n        });\n        this.action.elementsToDeactivate.forEach(id => {\n            const element = index.getById(id);\n            if (element !== undefined)\n                this.elementsToDeactivate.push(element);\n            if (element instanceof SRoutingHandleImpl && element.parent instanceof SRoutableElementImpl) {\n                const parent = element.parent;\n                if (this.shouldRemoveHandle(element, parent)) {\n                    this.handlesToRemove.push({ handle: element, parent });\n                    this.elementsToDeactivate.push(parent);\n                    this.elementsToActivate.push(parent);\n                }\n            }\n        });\n        return this.doExecute(context);\n    }\n\n    protected doExecute(context: CommandExecutionContext): SModelRootImpl {\n        this.handlesToRemove.forEach(entry => {\n            entry.point = entry.parent.routingPoints.splice(entry.handle.pointIndex, 1)[0];\n        });\n        this.elementsToDeactivate.forEach(element => {\n            if (element instanceof SRoutableElementImpl)\n                element.removeAll(child => child instanceof SRoutingHandleImpl);\n            else if (element instanceof SRoutingHandleImpl) {\n                element.editMode = false;\n                if (element.danglingAnchor) {\n                    if (element.parent instanceof SRoutableElementImpl && element.danglingAnchor.original)  {\n                        if (element.parent.source === element.danglingAnchor)\n                            element.parent.sourceId = element.danglingAnchor.original.id;\n                        else if (element.parent.target === element.danglingAnchor)\n                            element.parent.targetId = element.danglingAnchor.original.id;\n                        element.danglingAnchor.parent.remove(element.danglingAnchor);\n                        element.danglingAnchor = undefined;\n                    }\n                }\n            }\n        });\n        this.elementsToActivate.forEach(element => {\n            if (canEditRouting(element) && element instanceof SParentElementImpl) {\n                const router = this.edgeRouterRegistry.get(element.routerKind);\n                router.createRoutingHandles(element);\n            } else if (element instanceof SRoutingHandleImpl)\n                element.editMode = true;\n        });\n        return context.root;\n    }\n\n    protected shouldRemoveHandle(handle: SRoutingHandleImpl, parent: SRoutableElementImpl): boolean {\n        if (handle.kind === 'junction') {\n            const route = this.edgeRouterRegistry.route(parent);\n            return route.find(rp => rp.pointIndex === handle.pointIndex) === undefined;\n        }\n        return false;\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        this.handlesToRemove.forEach(entry => {\n            if (entry.point !== undefined)\n                entry.parent.routingPoints.splice(entry.handle.pointIndex, 0, entry.point);\n        });\n        this.elementsToActivate.forEach(element => {\n            if (element instanceof SRoutableElementImpl)\n                element.removeAll(child => child instanceof SRoutingHandleImpl);\n            else if (element instanceof SRoutingHandleImpl)\n                element.editMode = false;\n        });\n        this.elementsToDeactivate.forEach(element => {\n            if (canEditRouting(element)) {\n                const router = this.edgeRouterRegistry.get(element.routerKind);\n                router.createRoutingHandles(element);\n            } else if (element instanceof SRoutingHandleImpl)\n                element.editMode = true;\n        });\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        return this.doExecute(context);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { ReconnectAction } from 'sprotty-protocol/lib/actions';\nimport { Command, CommandExecutionContext, CommandReturn } from '../../base/commands/command';\nimport { TYPES } from '../../base/types';\nimport { SRoutableElementImpl } from '../routing/model';\nimport { EdgeMemento, EdgeRouterRegistry } from '../routing/routing';\n\n@injectable()\nexport class ReconnectCommand extends Command {\n    static readonly KIND = ReconnectAction.KIND;\n\n    @inject(EdgeRouterRegistry) edgeRouterRegistry: EdgeRouterRegistry;\n\n    memento: EdgeMemento | undefined;\n\n    constructor(@inject(TYPES.Action) protected readonly action: ReconnectAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        this.doExecute(context);\n        return context.root;\n    }\n\n    private doExecute(context: CommandExecutionContext) {\n        const index = context.root.index;\n        const edge = index.getById(this.action.routableId);\n        if (edge instanceof SRoutableElementImpl) {\n            const router = this.edgeRouterRegistry.get(edge.routerKind);\n            const before = router.takeSnapshot(edge);\n            router.applyReconnect(edge, this.action.newSourceId, this.action.newTargetId);\n            const after = router.takeSnapshot(edge);\n            this.memento = {\n                edge: edge,\n                before,\n                after\n            };\n        }\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        if (this.memento) {\n            const router = this.edgeRouterRegistry.get(this.memento.edge.routerKind);\n            router.applySnapshot(this.memento.edge, this.memento.before);\n        }\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        if (this.memento) {\n            const router = this.edgeRouterRegistry.get(this.memento.edge.routerKind);\n            router.applySnapshot(this.memento.edge, this.memento.after);\n        }\n        return context.root;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { configureCommand } from \"../../base/commands/command-registration\";\nimport { configureActionHandler } from \"../../base/actions/action-handler\";\nimport { configureModelElement } from \"../../base/views/view\";\nimport { SDanglingAnchorImpl } from \"../../features/routing/model\";\nimport { EmptyGroupView } from \"../../lib/svg-views\";\nimport { DeleteElementCommand } from \"./delete\";\nimport { EditLabelMouseListener, ApplyLabelEditCommand, EditLabelKeyListener, EditLabelAction } from \"./edit-label\";\nimport { EditLabelUI, EditLabelActionHandler } from \"./edit-label-ui\";\nimport { SwitchEditModeCommand } from \"./edit-routing\";\nimport { ReconnectCommand } from \"./reconnect\";\n\nexport const edgeEditModule = new ContainerModule((bind, _unbind, isBound) => {\n    const context = { bind, isBound };\n    configureCommand(context, SwitchEditModeCommand);\n    configureCommand(context, ReconnectCommand);\n    configureCommand(context, DeleteElementCommand);\n    configureModelElement(context, 'dangling-anchor', SDanglingAnchorImpl, EmptyGroupView);\n});\n\nexport const labelEditModule = new ContainerModule((bind, _unbind, isBound) => {\n    bind(EditLabelMouseListener).toSelf().inSingletonScope();\n    bind(TYPES.MouseListener).toService(EditLabelMouseListener);\n    bind(EditLabelKeyListener).toSelf().inSingletonScope();\n    bind(TYPES.KeyListener).toService(EditLabelKeyListener);\n    configureCommand({ bind, isBound }, ApplyLabelEditCommand);\n});\n\nexport const labelEditUiModule = new ContainerModule((bind, _unbind, isBound) => {\n    const context = { bind, isBound };\n    configureActionHandler(context, EditLabelAction.KIND, EditLabelActionHandler);\n    bind(EditLabelUI).toSelf().inSingletonScope();\n    bind(TYPES.IUIExtension).toService(EditLabelUI);\n});\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElementImpl } from '../../base/model/smodel';\n\nexport const expandFeature = Symbol('expandFeature');\n\n/**\n * Model elements that implement this interface can be expanded/collapsed\n *\n * Feature extension interface for {@link expandFeature}.\n */\nexport interface Expandable {\n    expanded: boolean\n}\n\nexport function isExpandable(element: SModelElementImpl): element is SModelElementImpl & Expandable {\n    return element.hasFeature(expandFeature) && 'expanded' in element;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { Action, CollapseExpandAction } from 'sprotty-protocol/lib/actions';\nimport { SButtonImpl } from '../button/model';\nimport { findParentByFeature } from '../../base/model/smodel-utils';\nimport { isExpandable } from './model';\nimport { IButtonHandler } from '../button/button-handler';\n\n@injectable()\nexport class ExpandButtonHandler implements IButtonHandler {\n    static TYPE = 'button:expand';\n\n    buttonPressed(button: SButtonImpl): Action[] {\n        const expandable = findParentByFeature(button, isExpandable);\n        if (expandable !== undefined) {\n            return [ CollapseExpandAction.create({\n                expandIds:   expandable.expanded ? [] : [ expandable.id ],\n                collapseIds:  expandable.expanded ? [ expandable.id ] : []\n            })];\n        } else {\n            return [];\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n /** @jsx svg */\nimport { svg } from '../../lib/jsx';\n\nimport { VNode } from 'snabbdom';\nimport { IView, RenderingContext } from '../../base/views/view';\nimport { isExpandable } from './model';\nimport { findParentByFeature } from '../../base/model/smodel-utils';\nimport { SButtonImpl } from '../button/model';\nimport { injectable } from 'inversify';\n\n@injectable()\nexport class ExpandButtonView implements IView {\n    render(button: SButtonImpl, context: RenderingContext): VNode {\n        const expandable = findParentByFeature(button, isExpandable);\n        const path = (expandable !== undefined && expandable.expanded)\n            ? 'M 1,5 L 8,12 L 15,5 Z'\n            : 'M 1,8 L 8,15 L 8,1 Z';\n        return <g class-sprotty-button=\"{true}\" class-enabled=\"{button.enabled}\">\n                <rect x={0} y={0} width={16} height={16} opacity={0}></rect>\n                <path d={path}></path>\n            </g>;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from \"inversify\";\nimport { VNode } from 'snabbdom';\nimport { Action, generateRequestId, RequestAction } from \"sprotty-protocol/lib/actions\";\nimport { CommandExecutionContext, HiddenCommand, CommandResult } from '../../base/commands/command';\nimport { IVNodePostprocessor } from '../../base/views/vnode-postprocessor';\nimport { isSelectable } from '../select/model';\nimport { SModelElementImpl, SModelRootImpl } from '../../base/model/smodel';\nimport { KeyListener } from '../../base/views/key-tool';\nimport { matchesKeystroke } from '../../utils/keyboard';\nimport { isExportable } from './model';\nimport { SvgExporter, ExportSvgAction } from './svg-exporter';\nimport { isViewport } from '../viewport/model';\nimport { isHoverable } from '../hover/model';\nimport { TYPES } from '../../base/types';\n\n@injectable()\nexport class ExportSvgKeyListener extends KeyListener {\n    override keyDown(element: SModelElementImpl, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'KeyE', 'ctrlCmd', 'shift'))\n            return [ RequestExportSvgAction.create() ];\n        else\n            return [];\n    }\n}\n\nexport interface RequestExportSvgAction extends RequestAction<ExportSvgAction> {\n    kind: typeof RequestExportSvgAction.KIND\n}\nexport namespace RequestExportSvgAction {\n    export const KIND = 'requestExportSvg';\n\n    export function create(): RequestExportSvgAction {\n        return {\n            kind: KIND,\n            requestId: generateRequestId()\n        };\n    }\n}\n\nexport class ExportSvgCommand extends HiddenCommand {\n    static readonly KIND = RequestExportSvgAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: RequestExportSvgAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandResult {\n        if (isExportable(context.root)) {\n            const root = context.modelFactory.createRoot(context.root);\n            if (isExportable(root)) {\n                if (isViewport(root)) {\n                    root.zoom = 1;\n                    root.scroll = { x: 0, y: 0 };\n                }\n                root.index.all().forEach(element => {\n                    if (isSelectable(element) && element.selected)\n                        element.selected = false;\n                    if (isHoverable(element) && element.hoverFeedback)\n                        element.hoverFeedback = false;\n                });\n                return {\n                    model: root,\n                    modelChanged: true,\n                    cause: this.action\n                };\n            }\n        }\n        return {\n            model: context.root,\n            modelChanged: false\n        };\n    }\n}\n\n@injectable()\nexport class ExportSvgPostprocessor implements IVNodePostprocessor {\n\n    root: SModelRootImpl;\n\n    @inject(TYPES.SvgExporter) protected svgExporter: SvgExporter;\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        if (element instanceof SModelRootImpl)\n            this.root = element;\n        return vnode;\n    }\n\n    postUpdate(cause?: Action): void {\n        if (this.root && cause !== undefined && cause.kind === RequestExportSvgAction.KIND) {\n            this.svgExporter.export(this.root, cause as RequestExportSvgAction);\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from \"inversify\";\nimport { VNode } from \"snabbdom\";\nimport { Animation } from \"../../base/animations/animation\";\nimport { CommandExecutionContext } from \"../../base/commands/command\";\nimport { SModelRootImpl, SModelElementImpl, SChildElementImpl } from \"../../base/model/smodel\";\nimport { IVNodePostprocessor } from \"../../base/views/vnode-postprocessor\";\nimport { setAttr } from \"../../base/views/vnode-utils\";\nimport { Fadeable, isFadeable } from \"./model\";\n\nexport interface ResolvedElementFade {\n    element: SModelElementImpl & Fadeable\n    type: 'in' | 'out'\n}\n\nexport class FadeAnimation extends Animation {\n\n    constructor(protected model: SModelRootImpl,\n                public elementFades: ResolvedElementFade[],\n                context: CommandExecutionContext,\n                protected removeAfterFadeOut: boolean = false) {\n        super(context);\n    }\n\n    tween(t: number, context: CommandExecutionContext): SModelRootImpl {\n        for (const elementFade of this.elementFades) {\n            const element = elementFade.element;\n            if (elementFade.type === 'in') {\n                element.opacity = t;\n            } else if (elementFade.type === 'out') {\n                element.opacity = 1 - t;\n                if (t === 1 && this.removeAfterFadeOut && element instanceof SChildElementImpl) {\n                    element.parent.remove(element);\n                }\n            }\n        }\n        return this.model;\n    }\n\n}\n\n@injectable()\nexport class ElementFader implements IVNodePostprocessor {\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        if (isFadeable(element) && element.opacity !== 1) {\n            setAttr(vnode, 'opacity', element.opacity);\n        }\n        return vnode;\n    }\n\n    postUpdate(): void {\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { Action, RequestPopupModelAction, SetPopupModelAction, HoverFeedbackAction } from 'sprotty-protocol/lib/actions';\nimport { Bounds, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { matchesKeystroke } from '../../utils/keyboard';\nimport { TYPES } from '../../base/types';\nimport { SModelElementImpl, SModelRootImpl } from '../../base/model/smodel';\nimport { MouseListener } from '../../base/views/mouse-tool';\nimport { CommandExecutionContext, PopupCommand, SystemCommand, CommandReturn, ICommand } from '../../base/commands/command';\nimport { IActionHandler } from '../../base/actions/action-handler';\nimport { EMPTY_ROOT } from '../../base/model/smodel-factory';\nimport { KeyListener } from '../../base/views/key-tool';\nimport { findParentByFeature, findParent } from '../../base/model/smodel-utils';\nimport { ViewerOptions } from '../../base/views/viewer-options';\nimport { getAbsoluteBounds } from '../bounds/model';\nimport { hasPopupFeature, isHoverable } from './model';\n\n\n@injectable()\nexport class HoverFeedbackCommand extends SystemCommand {\n    static readonly KIND = HoverFeedbackAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected readonly action: HoverFeedbackAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const model: SModelRootImpl = context.root;\n        const modelElement: SModelElementImpl | undefined = model.index.getById(this.action.mouseoverElement);\n\n        if (modelElement) {\n            if (isHoverable(modelElement)) {\n                modelElement.hoverFeedback = this.action.mouseIsOver;\n            }\n        }\n\n        return this.redo(context);\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        return context.root;\n    }\n}\n\n@injectable()\nexport class SetPopupModelCommand extends PopupCommand {\n    static readonly KIND = SetPopupModelAction.KIND;\n\n    oldRoot: SModelRootImpl;\n    newRoot: SModelRootImpl;\n\n    constructor(@inject(TYPES.Action) protected readonly action: SetPopupModelAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        this.oldRoot = context.root;\n        this.newRoot = context.modelFactory.createRoot(this.action.newRoot);\n\n        return this.newRoot;\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        return this.oldRoot;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        return this.newRoot;\n    }\n}\n\nexport interface HoverState {\n    mouseOverTimer: number | undefined\n    mouseOutTimer: number | undefined\n    popupOpen: boolean\n    previousPopupElement: SModelElementImpl | undefined\n}\n\nexport abstract class AbstractHoverMouseListener extends MouseListener {\n\n    protected mouseIsDown: boolean;\n\n    @inject(TYPES.ViewerOptions) protected options: ViewerOptions;\n    @inject(TYPES.HoverState) protected state: HoverState;\n\n    override mouseDown(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        this.mouseIsDown = true;\n        return [];\n    }\n\n    override mouseUp(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        this.mouseIsDown = false;\n        return [];\n    }\n\n    protected stopMouseOutTimer(): void {\n        if (this.state.mouseOutTimer !== undefined) {\n            window.clearTimeout(this.state.mouseOutTimer);\n            this.state.mouseOutTimer = undefined;\n        }\n    }\n\n    protected startMouseOutTimer(): Promise<Action> {\n        this.stopMouseOutTimer();\n        return new Promise((resolve) => {\n            this.state.mouseOutTimer = window.setTimeout(() => {\n                this.state.popupOpen = false;\n                this.state.previousPopupElement = undefined;\n                resolve(SetPopupModelAction.create({ type: EMPTY_ROOT.type, id: EMPTY_ROOT.id }));\n            }, this.options.popupCloseDelay);\n        });\n    }\n\n    protected stopMouseOverTimer(): void {\n        if (this.state.mouseOverTimer !== undefined) {\n            window.clearTimeout(this.state.mouseOverTimer);\n            this.state.mouseOverTimer = undefined;\n        }\n    }\n}\n\n@injectable()\nexport class HoverMouseListener extends AbstractHoverMouseListener {\n\n    protected lastHoverFeedbackElementId?: string;\n\n    @inject(TYPES.ViewerOptions) protected override options: ViewerOptions;\n\n    protected computePopupBounds(target: SModelElementImpl, mousePosition: Point): Bounds {\n        // Default position: below the mouse cursor\n        let offset: Point = { x: -5, y: 20 };\n\n        const targetBounds = getAbsoluteBounds(target);\n        const canvasBounds = target.root.canvasBounds;\n        const boundsInWindow = Bounds.translate(targetBounds, canvasBounds);\n        const distRight = boundsInWindow.x + boundsInWindow.width - mousePosition.x;\n        const distBottom = boundsInWindow.y + boundsInWindow.height - mousePosition.y;\n        if (distBottom <= distRight && this.allowSidePosition(target, 'below', distBottom)) {\n            // Put the popup below the target element\n            offset = { x: -5, y: Math.round(distBottom + 5) };\n        } else if (distRight <= distBottom && this.allowSidePosition(target, 'right', distRight)) {\n            // Put the popup right of the target element\n            offset = { x: Math.round(distRight + 5), y: -5 };\n        }\n        let leftPopupPosition = mousePosition.x + offset.x;\n        const canvasRightBorderPosition = canvasBounds.x + canvasBounds.width;\n        if (leftPopupPosition > canvasRightBorderPosition) {\n            leftPopupPosition = canvasRightBorderPosition;\n        }\n        let topPopupPosition = mousePosition.y + offset.y;\n        const canvasBottomBorderPosition = canvasBounds.y + canvasBounds.height;\n        if (topPopupPosition > canvasBottomBorderPosition) {\n            topPopupPosition = canvasBottomBorderPosition;\n        }\n        return { x: leftPopupPosition, y: topPopupPosition, width: -1, height: -1 };\n    }\n\n    protected allowSidePosition(target: SModelElementImpl, side: 'above' | 'below' | 'left' | 'right', distance: number): boolean {\n        return !(target instanceof SModelRootImpl) && distance <= 150;\n    }\n\n    protected startMouseOverTimer(target: SModelElementImpl, event: MouseEvent): Promise<Action> {\n        this.stopMouseOverTimer();\n        return new Promise((resolve) => {\n            this.state.mouseOverTimer = window.setTimeout(() => {\n                const popupBounds = this.computePopupBounds(target, { x: event.pageX, y: event.pageY });\n                resolve(RequestPopupModelAction.create({ elementId: target.id, bounds: popupBounds }));\n\n                this.state.popupOpen = true;\n                this.state.previousPopupElement = target;\n            }, this.options.popupOpenDelay);\n        });\n    }\n\n    override mouseOver(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        const result: (Action | Promise<Action>)[] = [];\n        if (!this.mouseIsDown) {\n            const popupTarget = findParent(target, hasPopupFeature);\n            if (this.state.popupOpen && (popupTarget === undefined ||\n                this.state.previousPopupElement !== undefined && this.state.previousPopupElement.id !== popupTarget.id)) {\n                result.push(this.startMouseOutTimer());\n            } else {\n                this.stopMouseOverTimer();\n                this.stopMouseOutTimer();\n            }\n            if (popupTarget !== undefined &&\n                (this.state.previousPopupElement === undefined || this.state.previousPopupElement.id !== popupTarget.id)) {\n                result.push(this.startMouseOverTimer(popupTarget, event));\n            }\n            if (this.lastHoverFeedbackElementId) {\n                result.push(HoverFeedbackAction.create({ mouseoverElement: this.lastHoverFeedbackElementId, mouseIsOver: false }));\n                this.lastHoverFeedbackElementId = undefined;\n            }\n            const hoverTarget = findParentByFeature(target, isHoverable);\n            if (hoverTarget !== undefined) {\n                result.push(HoverFeedbackAction.create({ mouseoverElement: hoverTarget.id, mouseIsOver: true }));\n                this.lastHoverFeedbackElementId = hoverTarget.id;\n            }\n        }\n        return result;\n    }\n\n    override mouseOut(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        const result: (Action | Promise<Action>)[] = [];\n        if (!this.mouseIsDown) {\n            const elementUnderMouse = this.getElementFromEventPosition(event);\n            if (!this.isSprottyPopup(elementUnderMouse)) {\n                if (this.state.popupOpen) {\n                    const popupTarget = findParent(target, hasPopupFeature);\n                    if (this.state.previousPopupElement !== undefined && popupTarget !== undefined\n                        && this.state.previousPopupElement.id === popupTarget.id)\n                        result.push(this.startMouseOutTimer());\n                }\n                this.stopMouseOverTimer();\n                const hoverTarget = findParentByFeature(target, isHoverable);\n                if (hoverTarget !== undefined) {\n                    result.push(HoverFeedbackAction.create({ mouseoverElement: hoverTarget.id, mouseIsOver: false }));\n                    if (this.lastHoverFeedbackElementId && this.lastHoverFeedbackElementId !== hoverTarget.id) {\n                        result.push(HoverFeedbackAction.create({ mouseoverElement: this.lastHoverFeedbackElementId, mouseIsOver: false }));\n                    }\n                    this.lastHoverFeedbackElementId = undefined;\n                }\n            }\n        }\n        return result;\n    }\n\n    protected getElementFromEventPosition(event: MouseEvent) {\n        return document.elementFromPoint(event.x, event.y);\n    }\n\n    protected isSprottyPopup(element: Element | null): boolean {\n        return element\n            ? (element.id === this.options.popupDiv\n                || (!!element.parentElement && this.isSprottyPopup(element.parentElement)))\n            : false;\n    }\n\n    override mouseMove(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        const result: (Action | Promise<Action>)[] = [];\n\n        if (!this.mouseIsDown) {\n            if (this.state.previousPopupElement !== undefined && this.closeOnMouseMove(this.state.previousPopupElement, event)) {\n                result.push(this.startMouseOutTimer());\n            }\n\n            const popupTarget = findParent(target, hasPopupFeature);\n            if (popupTarget !== undefined && (this.state.previousPopupElement === undefined\n                || this.state.previousPopupElement.id !== popupTarget.id)) {\n                result.push(this.startMouseOverTimer(popupTarget, event));\n            }\n        }\n\n        return result;\n    }\n\n    protected closeOnMouseMove(target: SModelElementImpl, event: MouseEvent): boolean {\n        return target instanceof SModelRootImpl;\n    }\n\n}\n\n@injectable()\nexport class PopupHoverMouseListener extends AbstractHoverMouseListener {\n\n    override mouseOut(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [this.startMouseOutTimer()];\n    }\n\n    override mouseOver(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        this.stopMouseOutTimer();\n        this.stopMouseOverTimer();\n        return [];\n    }\n}\n\nexport class HoverKeyListener extends KeyListener {\n    override keyDown(element: SModelElementImpl, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'Escape')) {\n            return [SetPopupModelAction.create({ type: EMPTY_ROOT.type, id: EMPTY_ROOT.id })];\n        }\n        return [];\n    }\n}\n\n@injectable()\nexport class ClosePopupActionHandler implements IActionHandler {\n    protected popupOpen: boolean = false;\n\n    handle(action: Action): void | ICommand | Action {\n        if (action.kind === SetPopupModelCommand.KIND) {\n            this.popupOpen = (action as SetPopupModelAction).newRoot.type !== EMPTY_ROOT.type;\n        } else if (this.popupOpen) {\n            return  SetPopupModelAction.create({ id: EMPTY_ROOT.id, type: EMPTY_ROOT.type });\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElementImpl } from '../../base/model/smodel';\nimport { SShapeElementImpl, boundsFeature } from '../bounds/model';\nimport { hoverFeedbackFeature, popupFeature } from '../hover/model';\n\nexport const decorationFeature = Symbol('decorationFeature');\n\n/**\n * Feature extension interface for {@link decorationFeature}.\n */\nexport interface Decoration {\n}\n\nexport function isDecoration<T extends SModelElementImpl>(e: T): e is T & Decoration {\n    return e.hasFeature(decorationFeature);\n}\n\nexport class SDecoration extends SShapeElementImpl implements Decoration {\n    static readonly DEFAULT_FEATURES = [decorationFeature, boundsFeature, hoverFeedbackFeature, popupFeature];\n}\n\nexport type SIssueSeverity = 'error' | 'warning' | 'info';\n\nexport class SIssueMarker extends SDecoration {\n    issues: SIssue[];\n}\n\nexport class SIssue {\n    message: string;\n    severity: SIssueSeverity;\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/** @jsx svg */\nimport { svg } from '../../lib/jsx';\n\nimport { VNode } from 'snabbdom';\nimport { IView, RenderingContext } from '../../base/views/view';\nimport { SIssueMarker, SIssueSeverity } from './model';\nimport { setClass } from '../../base/views/vnode-utils';\nimport { injectable } from 'inversify';\n\n@injectable()\nexport class IssueMarkerView implements IView {\n    render(marker: SIssueMarker, context: RenderingContext): VNode {\n        const scale = 16 / 1792;\n        const trafo = `scale(${scale}, ${scale})`;\n        const maxSeverity = this.getMaxSeverity(marker);\n        const group = <g class-sprotty-issue={true}>\n            <g transform={trafo}>\n                <path d={this.getPath(maxSeverity)} />\n            </g>\n        </g>;\n        setClass(group, 'sprotty-' + maxSeverity, true);\n        return group;\n    }\n\n    protected getMaxSeverity(marker: SIssueMarker): SIssueSeverity {\n        let currentSeverity: SIssueSeverity = 'info';\n        for (const severity of marker.issues.map(s => s.severity)) {\n            if (severity === 'error' || (severity === 'warning' && currentSeverity === 'info'))\n                currentSeverity = severity;\n        }\n        return currentSeverity;\n    }\n\n    protected getPath(severity: SIssueSeverity) {\n        switch (severity) {\n            case 'error':\n            case 'warning':\n                // eslint-disable-next-line max-len\n                return \"M768 128q209 0 385.5 103t279.5 279.5 103 385.5-103 385.5-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103zm128 1247v-190q0-14-9-23.5t-22-9.5h-192q-13 0-23 10t-10 23v190q0 13 10 23t23 10h192q13 0 22-9.5t9-23.5zm-2-344l18-621q0-12-10-18-10-8-24-8h-220q-14 0-24 8-10 6-10 18l17 621q0 10 10 17.5t24 7.5h185q14 0 23.5-7.5t10.5-17.5z\";\n            case 'info':\n                // eslint-disable-next-line max-len\n                return \"M1024 1376v-160q0-14-9-23t-23-9h-96v-512q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v160q0 14 9 23t23 9h96v320h-96q-14 0-23 9t-9 23v160q0 14 9 23t23 9h448q14 0 23-9t9-23zm-128-896v-160q0-14-9-23t-23-9h-192q-14 0-23 9t-9 23v160q0 14 9 23t23 9h192q14 0 23-9t9-23zm640 416q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z\";\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from \"inversify\";\nimport { VNode } from \"snabbdom\";\nimport { SModelElementImpl, SChildElementImpl } from \"../../base/model/smodel\";\nimport { IVNodePostprocessor } from \"../../base/views/vnode-postprocessor\";\nimport { isDecoration, Decoration } from \"./model\";\nimport { setAttr } from \"../../base/views/vnode-utils\";\nimport { isSizeable } from \"../bounds/model\";\nimport { SRoutableElementImpl } from \"../routing/model\";\nimport { EdgeRouterRegistry } from \"../routing/routing\";\nimport { Point } from \"sprotty-protocol\";\n\n@injectable()\nexport class DecorationPlacer implements IVNodePostprocessor {\n\n    @inject(EdgeRouterRegistry) edgeRouterRegistry: EdgeRouterRegistry;\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        if (isDecoration(element)) {\n            const position = this.getPosition(element);\n            const translate = 'translate(' + position.x + ', ' + position.y + ')';\n            setAttr(vnode, 'transform', translate);\n        }\n        return vnode;\n    }\n\n    protected getPosition(element: SModelElementImpl & Decoration): Point {\n        if (element instanceof SChildElementImpl && element.parent instanceof SRoutableElementImpl) {\n            const route =  this.edgeRouterRegistry.route(element.parent);\n            if (route.length > 1) {\n                const index = Math.floor(0.5  * (route.length - 1));\n                const offset = isSizeable(element)\n                    ? {\n                        x: - 0.5 * element.bounds.width,\n                        y: - 0.5 * element.bounds.width\n                    }\n                    : Point.ORIGIN;\n                return {\n                    x: 0.5 * (route[index].x + route[index + 1].x) + offset.x,\n                    y: 0.5 * (route[index].y + route[index + 1].y) + offset.y\n                };\n            }\n        }\n        if (isSizeable(element))\n            return {\n                x: -0.666 * element.bounds.width,\n                y: -0.666 * element.bounds.height\n            };\n        return Point.ORIGIN;\n    }\n\n    postUpdate(): void {\n    }\n}\n", "(function (global, factory) {\ntypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\ntypeof define === 'function' && define.amd ? define(factory) :\n(global = global || self, global.TinyQueue = factory());\n}(this, function () { 'use strict';\n\nvar TinyQueue = function TinyQueue(data, compare) {\n    if ( data === void 0 ) data = [];\n    if ( compare === void 0 ) compare = defaultCompare;\n\n    this.data = data;\n    this.length = this.data.length;\n    this.compare = compare;\n\n    if (this.length > 0) {\n        for (var i = (this.length >> 1) - 1; i >= 0; i--) { this._down(i); }\n    }\n};\n\nTinyQueue.prototype.push = function push (item) {\n    this.data.push(item);\n    this.length++;\n    this._up(this.length - 1);\n};\n\nTinyQueue.prototype.pop = function pop () {\n    if (this.length === 0) { return undefined; }\n\n    var top = this.data[0];\n    var bottom = this.data.pop();\n    this.length--;\n\n    if (this.length > 0) {\n        this.data[0] = bottom;\n        this._down(0);\n    }\n\n    return top;\n};\n\nTinyQueue.prototype.peek = function peek () {\n    return this.data[0];\n};\n\nTinyQueue.prototype._up = function _up (pos) {\n    var ref = this;\n        var data = ref.data;\n        var compare = ref.compare;\n    var item = data[pos];\n\n    while (pos > 0) {\n        var parent = (pos - 1) >> 1;\n        var current = data[parent];\n        if (compare(item, current) >= 0) { break; }\n        data[pos] = current;\n        pos = parent;\n    }\n\n    data[pos] = item;\n};\n\nTinyQueue.prototype._down = function _down (pos) {\n    var ref = this;\n        var data = ref.data;\n        var compare = ref.compare;\n    var halfLength = this.length >> 1;\n    var item = data[pos];\n\n    while (pos < halfLength) {\n        var left = (pos << 1) + 1;\n        var best = data[left];\n        var right = left + 1;\n\n        if (right < this.length && compare(data[right], best) < 0) {\n            left = right;\n            best = data[right];\n        }\n        if (compare(best, item) >= 0) { break; }\n\n        data[pos] = best;\n        pos = left;\n    }\n\n    data[pos] = item;\n};\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nreturn TinyQueue;\n\n}));\n", "/********************************************************************************\n * Copyright (c) 2019 Rowan Winsemius and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n// Based on the sweepline implementation at https://github.com/rowanwins/sweepline-intersections\n// which is published under the terms of MIT, but has been adapted to the use case of sprotty.\nimport TinyQueue from \"tinyqueue\";\nimport { Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { PointToPointLine } from \"../../utils/geometry\";\nimport { Intersection } from \"./intersection-finder\";\nimport { RoutedPoint } from \"../routing/routing\";\n\n/*\n * The algorithm implemented in this module is loosely based on the Bentley-Ottmann algorithm for\n * finding intersection among line segments in `O((n+k) log n)`, whereas `n` is the number of line\n * segments and `k` is the number of intersections.\n * The underlying idea is to use a imaginary sweep line that moves over the x/y plane and testing\n * only the line segments for intersection that the sweepline currently crosses, instead of\n * testing all segment with each other, which would be `O(n^2)`.\n * It does so by generating a prioritized event queue for start and end events of the line segments\n * and working its way through the queue (i.e., sweeping).\n * More information can be found at https://en.wikipedia.org/wiki/Bentley%E2%80%93Ottmann_algorithm\n * In contrast to the original Bently-Ottmann algorithm, the implementation below does not use a tree\n * data structure to store the segments in order to simplify the implementation.\n * See also https://github.com/rowanwins/sweepline-intersections#algorithm-notes\n */\n\n/**\n * Add the specified `route` to the event `queue` from left to right.\n * @param routeId id of the route.\n * @param route the route as array of points.\n * @param queue the queue to add the route to.\n */\nexport function addRoute(routeId: string, route: RoutedPoint[], queue: TinyQueue<SweepEvent>) {\n    if (route.length < 1) return;\n    let currentPoint = route[0];\n    let nextPoint = undefined;\n    for (let i = 0; i < route.length - 1; i++) {\n        nextPoint = route[i + 1];\n\n        const e1 = new SweepEvent(routeId, currentPoint, i);\n        const e2 = new SweepEvent(routeId, nextPoint, i + 1);\n\n        e1.otherEvent = e2;\n        e2.otherEvent = e1;\n\n        if (checkWhichEventIsLeft(e1, e2) > 0) {\n            e2.isLeftEndpoint = true;\n            e1.isLeftEndpoint = false;\n        } else {\n            e1.isLeftEndpoint = true;\n            e2.isLeftEndpoint = false;\n        }\n        queue.push(e1);\n        queue.push(e2);\n\n        currentPoint = nextPoint;\n    }\n}\n\n/**\n * Returns which of the two events is left.\n * This is used to classify the endpoints of a segment when generating the\n * event queue.\n */\nexport function checkWhichEventIsLeft(e1: SweepEvent, e2: SweepEvent): 1 | -1 {\n    if (e1.point.x > e2.point.x) return 1;\n    if (e1.point.x < e2.point.x) return -1;\n    if (e1.point.y !== e2.point.y) return e1.point.y > e2.point.y ? 1 : -1;\n    return 1;\n}\n\n/**\n * An event -- or with other words a start or end point of a segment -- in the context\n * of the event queue for the sweep.\n *\n * Stores the original Sprotty `edgeId` and the segment index of this segment in the edge\n * to keep track of which edge and segment this event originated from.\n */\nexport class SweepEvent {\n    otherEvent: SweepEvent;\n    isLeftEndpoint: boolean;\n    constructor(readonly edgeId: string, readonly point: Point, readonly segmentIndex: number) { }\n}\n\n/**\n * A line segment consists of a start and a stop event.\n */\nexport class Segment {\n    readonly leftSweepEvent: SweepEvent;\n    readonly rightSweepEvent: SweepEvent;\n    constructor(event: SweepEvent) {\n        this.leftSweepEvent = event;\n        this.rightSweepEvent = event.otherEvent;\n    }\n}\n\n/**\n * Performs the main sweep algorithm on the specified event queue.\n *\n * An empty priority queue is created to store segments encountered.\n * An item is removed from the priority queue if the vertex is the left endpoint\n * of a segment, we test it against every other segment in the segment queue for\n * intersections with any intersection recorded. We then add the vertex (and it's\n * associated right endpoint) to the segment queue.\n * If we encounter a right endpoint we remove the first item from the segment queue.\n *\n * Each pair of segments are only tested once. And only segments that overlap on the\n * x plane are tested against each other.\n *\n * @param eventQueue the event queue.\n * @returns the identified intersections.\n */\nexport function runSweep(eventQueue: TinyQueue<SweepEvent>): Intersection[] {\n    const intersectionPoints: Intersection[] = [];\n    const outQueue = new TinyQueue<Segment>([], checkWhichSegmentHasRightEndpointFirst);\n    while (eventQueue.length) {\n        const event = eventQueue.pop();\n        if (event?.isLeftEndpoint) {\n            const segment = new Segment(event);\n            for (let i = 0; i < outQueue.data.length; i++) {\n                const otherSegment = outQueue.data[i];\n                const intersection = intersectionOfSegments(segment, otherSegment);\n                if (intersection) {\n                    intersectionPoints.push(\n                        <Intersection>{\n                            routable1: event.edgeId,\n                            routable2: otherSegment.leftSweepEvent.edgeId,\n                            segmentIndex1: getSegmentIndex(segment),\n                            segmentIndex2: getSegmentIndex(otherSegment),\n                            intersectionPoint: intersection\n                        }\n                    );\n                }\n            }\n            outQueue.push(segment);\n        } else if (event?.isLeftEndpoint === false) {\n            outQueue.pop();\n        }\n    }\n    return intersectionPoints;\n}\n\n/**\n * Specifies which of the two specified segments has a right endpoint first.\n * Used as a comparator to sort the event queue.\n */\nexport function checkWhichSegmentHasRightEndpointFirst(seg1: Segment, seg2: Segment): 1 | -1 {\n    if (seg1.rightSweepEvent.point.x > seg2.rightSweepEvent.point.x) return 1;\n    if (seg1.rightSweepEvent.point.x < seg2.rightSweepEvent.point.x) return -1;\n    if (seg1.rightSweepEvent.point.y !== seg2.rightSweepEvent.point.y) return seg1.rightSweepEvent.point.y < seg2.rightSweepEvent.point.y ? 1 : -1;\n    return 1;\n}\n\nexport function getSegmentIndex(segment: Segment): number {\n    return Math.min(segment.leftSweepEvent.segmentIndex, segment.rightSweepEvent.segmentIndex);\n}\n\n/**\n * Tests whether two segments intersect and returns the intersection point if existing.\n */\nexport function intersectionOfSegments(seg1: Segment, seg2: Segment): Point | undefined {\n    if (seg1.leftSweepEvent.edgeId === seg2.leftSweepEvent.edgeId) {\n        return undefined;\n    }\n    const seg1Line = new PointToPointLine(seg1.leftSweepEvent.point, seg1.rightSweepEvent.point);\n    const seg2Line = new PointToPointLine(seg2.leftSweepEvent.point, seg2.rightSweepEvent.point);\n    return seg1Line.intersection(seg2Line);\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from \"inversify\";\nimport { Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport TinyQueue from \"tinyqueue\";\nimport { EdgeRouting, IEdgeRoutePostprocessor, RoutedPoint } from \"../routing/routing\";\nimport { addRoute, checkWhichEventIsLeft, runSweep, SweepEvent } from \"./sweepline\";\n\nexport interface Intersection {\n    readonly routable1: string;\n    readonly segmentIndex1: number;\n    readonly routable2: string;\n    readonly segmentIndex2: number;\n    readonly intersectionPoint: Point;\n}\n\nexport interface IntersectingRoutedPoint extends RoutedPoint {\n    intersections: Intersection[];\n}\n\nexport function isIntersectingRoutedPoint(routedPoint: Point): routedPoint is IntersectingRoutedPoint {\n    return routedPoint !== undefined && 'intersections' in routedPoint && 'kind' in routedPoint;\n}\n\nexport const BY_X_THEN_Y = (a: Intersection, b: Intersection): number => {\n    if (a.intersectionPoint.x === b.intersectionPoint.x) {\n        return a.intersectionPoint.y - b.intersectionPoint.y;\n    }\n    return a.intersectionPoint.x - b.intersectionPoint.x;\n};\n\nexport const BY_DESCENDING_X_THEN_Y = (a: Intersection, b: Intersection): number => {\n    if (a.intersectionPoint.x === b.intersectionPoint.x) {\n        return a.intersectionPoint.y - b.intersectionPoint.y;\n    }\n    return b.intersectionPoint.x - a.intersectionPoint.x;\n};\n\nexport const BY_X_THEN_DESCENDING_Y = (a: Intersection, b: Intersection): number => {\n    if (a.intersectionPoint.x === b.intersectionPoint.x) {\n        return b.intersectionPoint.y - a.intersectionPoint.y;\n    }\n    return a.intersectionPoint.x - b.intersectionPoint.x;\n};\n\nexport const BY_DESCENDING_X_THEN_DESCENDING_Y = (a: Intersection, b: Intersection): number => {\n    if (a.intersectionPoint.x === b.intersectionPoint.x) {\n        return b.intersectionPoint.y - a.intersectionPoint.y;\n    }\n    return b.intersectionPoint.x - a.intersectionPoint.x;\n};\n\n/**\n * Finds intersections among edges and updates routed points to reflect those intersections.\n *\n * This only yields correct intersections among straight line segments and doesn't work with bezier curves.\n */\n@injectable()\nexport class IntersectionFinder implements IEdgeRoutePostprocessor {\n\n    /**\n     * Finds all intersections in the specified `routing` and replaces the `RoutedPoints` that are\n     * intersecting by adding intersection information to routing points (@see `IntersectingRoutedPoints`).\n     * @param routing the edge routing to find intersections for and update.\n     */\n    apply(routing: EdgeRouting) {\n        const intersections = this.find(routing);\n        this.addToRouting(intersections, routing);\n    }\n\n    /**\n     * Finds the intersections in the specified `routing` and returns them.\n     * @param routing the edge routing to find intersections for and update.\n     * @returns the identified intersections.\n     */\n    find(routing: EdgeRouting): Intersection[] {\n        const eventQueue = new TinyQueue<SweepEvent>(undefined, checkWhichEventIsLeft);\n        routing.routes.forEach((route, routeId) => {\n            if (this.isSupportedRoute(route)) {\n                addRoute(routeId, route, eventQueue);\n            }\n        });\n        return runSweep(eventQueue);\n    }\n\n    /**\n     * Specifies whether or not a specific route should be included in this intersection search or not.\n     *\n     * As this intersection finder only supports linear line segments, this method only returns `true`\n     * for routes that only contain routed points, which are either 'source', 'target' or 'linear'.\n     */\n    protected isSupportedRoute(route: RoutedPoint[]): boolean {\n        return route.find(point => point.kind !== 'source' && point.kind !== 'target' && point.kind !== 'linear') === undefined;\n    }\n\n    protected addToRouting(intersections: Intersection[], routing: EdgeRouting) {\n        for (const intersection of intersections) {\n            const routable1 = routing.get(intersection.routable1);\n            const routable2 = routing.get(intersection.routable2);\n            this.addIntersectionToRoutedPoint(intersection, routable1, intersection.segmentIndex1);\n            this.addIntersectionToRoutedPoint(intersection, routable2, intersection.segmentIndex2);\n        }\n    }\n\n    private addIntersectionToRoutedPoint(intersection: Intersection, routedPoint: RoutedPoint[] | undefined, segmentIndex: number) {\n        if (routedPoint && routedPoint.length > segmentIndex) {\n            const segment = routedPoint[segmentIndex + 1];\n            if (isIntersectingRoutedPoint(segment)) {\n                segment.intersections.push(intersection);\n            } else {\n                const intersectingRoutedPoint = { ...segment, intersections: [intersection] };\n                routedPoint[segmentIndex + 1] = intersectingRoutedPoint;\n            }\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2020 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, optional } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { Bounds, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { Action, DeleteElementAction, ReconnectAction, SelectAction, SelectAllAction, MoveAction } from 'sprotty-protocol/lib/actions';\nimport { Animation, CompoundAnimation } from '../../base/animations/animation';\nimport { CommandExecutionContext, ICommand, MergeableCommand, CommandReturn } from '../../base/commands/command';\nimport { SChildElementImpl, SModelElementImpl, SModelRootImpl } from '../../base/model/smodel';\nimport { findParentByFeature, translatePoint } from '../../base/model/smodel-utils';\nimport { TYPES } from '../../base/types';\nimport { MouseListener } from '../../base/views/mouse-tool';\nimport { IVNodePostprocessor } from '../../base/views/vnode-postprocessor';\nimport { setAttr } from '../../base/views/vnode-utils';\nimport { SEdgeImpl } from '../../graph/sgraph';\nimport { CommitModelAction } from '../../model-source/commit-model';\nimport { findChildrenAtPosition, isAlignable } from '../bounds/model';\nimport { CreatingOnDrag, isCreatingOnDrag } from '../edit/create-on-drag';\nimport { SwitchEditModeAction } from '../edit/edit-routing';\nimport { ReconnectCommand } from '../edit/reconnect';\nimport { edgeInProgressID, edgeInProgressTargetHandleID, isConnectable, SRoutableElementImpl, SRoutingHandleImpl } from '../routing/model';\nimport { EdgeMemento, EdgeRouterRegistry, EdgeSnapshot, RoutedPoint } from '../routing/routing';\nimport { isEdgeLayoutable } from '../edge-layout/model';\nimport { isSelectable } from '../select/model';\nimport { isViewport } from '../viewport/model';\nimport { isLocateable, isMoveable, Locateable } from './model';\nimport { ISnapper } from './snap';\n\nexport interface ElementMove {\n    elementId: string\n    elementType?: string\n    fromPosition?: Point\n    toPosition: Point\n}\n\nexport interface ResolvedElementMove {\n    element: SModelElementImpl & Locateable\n    fromPosition: Point\n    toPosition: Point\n}\n\nexport interface ResolvedHandleMove {\n    handle: SRoutingHandleImpl\n    fromPosition: Point\n    toPosition: Point\n}\n\n@injectable()\nexport class MoveCommand extends MergeableCommand {\n    static readonly KIND = MoveAction.KIND;\n\n    @inject(EdgeRouterRegistry) @optional() edgeRouterRegistry?: EdgeRouterRegistry;\n\n    protected resolvedMoves: Map<string, ResolvedElementMove> = new Map;\n    protected edgeMementi: EdgeMemento[] = [];\n\n    constructor(@inject(TYPES.Action) protected readonly action: MoveAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const index = context.root.index;\n        const edge2handleMoves = new Map<SRoutableElementImpl, ResolvedHandleMove[]>();\n        const attachedEdgeShifts = new Map<SRoutableElementImpl, Point>();\n        this.action.moves.forEach(move => {\n            const element = index.getById(move.elementId);\n            if (element instanceof SRoutingHandleImpl && this.edgeRouterRegistry) {\n                const edge = element.parent;\n                if (edge instanceof SRoutableElementImpl) {\n                    const resolvedMove = this.resolveHandleMove(element, edge, move);\n                    if (resolvedMove) {\n                        let movesByEdge = edge2handleMoves.get(edge);\n                        if (!movesByEdge) {\n                            movesByEdge = [];\n                            edge2handleMoves.set(edge, movesByEdge);\n                        }\n                        movesByEdge.push(resolvedMove);\n                    }\n                }\n            } else if (element && isLocateable(element)) {\n                const resolvedMove = this.resolveElementMove(element, move);\n                if (resolvedMove) {\n                    this.resolvedMoves.set(resolvedMove.element.id, resolvedMove);\n                    if (this.edgeRouterRegistry) {\n                        index.getAttachedElements(element).forEach(edge => {\n                            if (edge instanceof SRoutableElementImpl) {\n                                const existingDelta = attachedEdgeShifts.get(edge);\n                                const newDelta = Point.subtract(resolvedMove.toPosition, resolvedMove.fromPosition);\n                                const delta = (existingDelta)\n                                    ? Point.linear(existingDelta, newDelta, 0.5)\n                                    : newDelta;\n                                attachedEdgeShifts.set(edge, delta);\n                            }\n                        });\n                    }\n                }\n            }\n        });\n        this.doMove(edge2handleMoves, attachedEdgeShifts);\n        if (this.action.animate) {\n            this.undoMove();\n            return new CompoundAnimation(context.root, context, [\n                new MoveAnimation(context.root, this.resolvedMoves, context, false),\n                new MorphEdgesAnimation(context.root, this.edgeMementi, context, false)\n            ]).start();\n        }\n        return context.root;\n    }\n\n    protected resolveHandleMove(handle: SRoutingHandleImpl, edge: SRoutableElementImpl, move: ElementMove): ResolvedHandleMove | undefined {\n        let fromPosition = move.fromPosition;\n        if (!fromPosition) {\n            const router = this.edgeRouterRegistry!.get(edge.routerKind);\n            fromPosition = router.getHandlePosition(edge, router.route(edge), handle);\n        }\n        if (fromPosition)\n            return {\n                handle,\n                fromPosition,\n                toPosition: move.toPosition\n            };\n        return undefined;\n    }\n\n    protected resolveElementMove(element: SModelElementImpl & Locateable, move: ElementMove): ResolvedElementMove | undefined {\n        const fromPosition = move.fromPosition\n            || { x: element.position.x, y: element.position.y };\n        return {\n            element,\n            fromPosition,\n            toPosition: move.toPosition\n        };\n    }\n\n    protected doMove(edge2move: Map<SRoutableElementImpl, ResolvedHandleMove[]>, attachedEdgeShifts: Map<SRoutableElementImpl, Point>) {\n        this.resolvedMoves.forEach(res => {\n            res.element.position = res.toPosition;\n        });\n        // reset edges to state before\n        edge2move.forEach((moves, edge) => {\n            const router = this.edgeRouterRegistry!.get(edge.routerKind);\n            const before = router.takeSnapshot(edge);\n            router.applyHandleMoves(edge, moves);\n            const after = router.takeSnapshot(edge);\n            this.edgeMementi.push({ edge, before, after });\n        });\n        attachedEdgeShifts.forEach((delta, edge) => {\n            if (!edge2move.get(edge)) {\n                const router = this.edgeRouterRegistry!.get(edge.routerKind);\n                const before = router.takeSnapshot(edge);\n                if (edge.source\n                    && edge.target\n                    && this.resolvedMoves.get(edge.source.id)\n                    && this.resolvedMoves.get(edge.target.id)) {\n                    // move the entire edge when both source and target are moved\n                    edge.routingPoints = edge.routingPoints.map(rp => Point.add(rp, delta));\n                } else {\n                    // add/remove RPs according to the new source/target positions\n                    const updateHandles = isSelectable(edge) && edge.selected;\n                    router.cleanupRoutingPoints(edge, edge.routingPoints, updateHandles, this.action.finished);\n                }\n                const after = router.takeSnapshot(edge);\n                this.edgeMementi.push({ edge, before, after });\n            }\n        });\n    }\n\n    protected undoMove() {\n        this.resolvedMoves.forEach(res => {\n            (res.element as any).position = res.fromPosition;\n        });\n        this.edgeMementi.forEach(memento => {\n            const router = this.edgeRouterRegistry!.get(memento.edge.routerKind);\n            router.applySnapshot(memento.edge, memento.before);\n        });\n    }\n\n    undo(context: CommandExecutionContext): Promise<SModelRootImpl> {\n        return new CompoundAnimation(context.root, context, [\n            new MoveAnimation(context.root, this.resolvedMoves, context, true),\n            new MorphEdgesAnimation(context.root, this.edgeMementi, context, true)\n        ]).start();\n    }\n\n    redo(context: CommandExecutionContext): Promise<SModelRootImpl> {\n        return new CompoundAnimation(context.root, context, [\n            new MoveAnimation(context.root, this.resolvedMoves, context, false),\n            new MorphEdgesAnimation(context.root, this.edgeMementi, context, false)\n        ]).start();\n    }\n\n    override merge(other: ICommand, context: CommandExecutionContext) {\n        if (!this.action.animate && other instanceof MoveCommand) {\n            other.resolvedMoves.forEach(\n                (otherMove, otherElementId) => {\n                    const existingMove = this.resolvedMoves.get(otherElementId);\n                    if (existingMove) {\n                        existingMove.toPosition = otherMove.toPosition;\n                    } else {\n                        this.resolvedMoves.set(otherElementId, otherMove);\n                    }\n                }\n            );\n            other.edgeMementi.forEach(otherMemento => {\n                const existingMemento = this.edgeMementi.find(edgeMemento => edgeMemento.edge.id === otherMemento.edge.id);\n                if (existingMemento) {\n                    existingMemento.after = otherMemento.after;\n                } else {\n                    this.edgeMementi.push(otherMemento);\n                }\n            });\n            return true;\n        } else if (other instanceof ReconnectCommand) {\n            const otherMemento = other.memento;\n            if (otherMemento) {\n                const existingMemento = this.edgeMementi.find(edgeMemento => edgeMemento.edge.id === otherMemento.edge.id);\n                if (existingMemento) {\n                    existingMemento.after = otherMemento.after;\n                } else {\n                    this.edgeMementi.push(otherMemento);\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n}\n\nexport class MoveAnimation extends Animation {\n\n    constructor(protected model: SModelRootImpl,\n                public elementMoves: Map<string, ResolvedElementMove>,\n                context: CommandExecutionContext,\n                protected reverse: boolean = false) {\n        super(context);\n    }\n\n    tween(t: number) {\n        this.elementMoves.forEach((elementMove) => {\n            if (this.reverse) {\n                elementMove.element.position = {\n                    x: (1 - t) * elementMove.toPosition.x + t * elementMove.fromPosition.x,\n                    y: (1 - t) * elementMove.toPosition.y + t * elementMove.fromPosition.y\n                };\n            } else {\n                elementMove.element.position = {\n                    x: (1 - t) * elementMove.fromPosition.x + t * elementMove.toPosition.x,\n                    y: (1 - t) * elementMove.fromPosition.y + t * elementMove.toPosition.y\n                };\n            }\n        });\n        return this.model;\n    }\n}\n\ninterface ExpandedEdgeMorph {\n    startExpandedRoute: Point[],\n    endExpandedRoute: Point[],\n    memento: EdgeMemento\n}\n\nexport class MorphEdgesAnimation extends Animation {\n\n    protected expanded: ExpandedEdgeMorph[] = [];\n\n    constructor(protected model: SModelRootImpl,\n                originalMementi: EdgeMemento[],\n                context: CommandExecutionContext,\n                protected reverse: boolean = false) {\n        super(context);\n        originalMementi.forEach(edgeMemento => {\n            const start = this.reverse ? edgeMemento.after : edgeMemento.before;\n            const end = this.reverse ? edgeMemento.before : edgeMemento.after;\n            const startRoute = start.routedPoints;\n            const endRoute = end.routedPoints;\n            const maxRoutingPoints = Math.max(startRoute.length, endRoute.length);\n            this.expanded.push({\n                startExpandedRoute: this.growToSize(startRoute, maxRoutingPoints),\n                endExpandedRoute: this.growToSize(endRoute, maxRoutingPoints),\n                memento: edgeMemento\n            });\n        });\n    }\n\n    protected midPoint(edgeMemento: EdgeMemento): Point {\n        const edge = edgeMemento.edge;\n        const source = edgeMemento.edge.source!;\n        const target = edgeMemento.edge.target!;\n        return Point.linear(\n            translatePoint(Bounds.center(source.bounds), source.parent, edge.parent),\n            translatePoint(Bounds.center(target.bounds), target.parent, edge.parent),\n            0.5);\n    }\n\n    override start() {\n        this.expanded.forEach(morph => {\n            morph.memento.edge.removeAll(e => e instanceof SRoutingHandleImpl);\n        });\n        return super.start();\n    }\n\n    tween(t: number) {\n        if (t === 1) {\n            this.expanded.forEach(morph => {\n                const memento = morph.memento;\n                if (this.reverse)\n                    memento.before.router.applySnapshot(memento.edge, memento.before);\n                else\n                    memento.after.router.applySnapshot(memento.edge, memento.after);\n            });\n        } else {\n            this.expanded.forEach(morph => {\n                const newRoutingPoints: Point[] = [];\n                // ignore source and target anchor\n                for (let i = 1; i < morph.startExpandedRoute.length - 1; ++i)\n                    newRoutingPoints.push(Point.linear(morph.startExpandedRoute[i], morph.endExpandedRoute[i], t));\n\n                const closestSnapshot = t < 0.5 ? morph.memento.before : morph.memento.after;\n                const newSnapshot: EdgeSnapshot = {\n                    ...closestSnapshot,\n                    routingPoints: newRoutingPoints,\n                    routingHandles: []\n                };\n                closestSnapshot.router.applySnapshot(morph.memento.edge, newSnapshot);\n            });\n        }\n        return this.model;\n    }\n\n    protected growToSize(route: RoutedPoint[], targetSize: number): Point[] {\n        const diff = targetSize - route.length;\n        if (diff <= 0)\n            return route;\n        const result: Point[] = [];\n        result.push(route[0]);\n        const deltaDiff = 1 / (diff + 1);\n        const deltaSmaller = 1 / (route.length - 1);\n        let nextInsertion = 1;\n        for (let i = 1; i < route.length; ++i) {\n            const pos = deltaSmaller * i;\n            let insertions = 0;\n            while (pos > (nextInsertion + insertions) * deltaDiff)\n                ++insertions;\n            nextInsertion += insertions;\n            for (let j = 0; j < insertions; ++j) {\n                const p = Point.linear(route[i - 1], route[i], (j + 1) / (insertions + 1));\n                result.push(p);\n            }\n            result.push(route[i]);\n        }\n        return result;\n    }\n\n}\n\nexport class MoveMouseListener extends MouseListener {\n\n    @inject(EdgeRouterRegistry) @optional() edgeRouterRegistry?: EdgeRouterRegistry;\n    @inject(TYPES.ISnapper) @optional() snapper?: ISnapper;\n\n    hasDragged = false;\n    startDragPosition: Point | undefined;\n    elementId2startPos = new Map<string, Point>();\n\n    override mouseDown(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        if (event.button === 0) {\n            const moveable = findParentByFeature(target, isMoveable);\n            const isRoutingHandle = target instanceof SRoutingHandleImpl;\n            if (moveable !== undefined || isRoutingHandle || isCreatingOnDrag(target)) {\n                this.startDragPosition = { x: event.pageX, y: event.pageY };\n            } else {\n                this.startDragPosition = undefined;\n            }\n            this.hasDragged = false;\n            if (isCreatingOnDrag(target)) {\n                return this.startCreatingOnDrag(target, event);\n            } else if (isRoutingHandle) {\n                return this.activateRoutingHandle(target, event);\n            }\n        }\n        return [];\n    }\n\n    protected startCreatingOnDrag(target: CreatingOnDrag, event: MouseEvent): (Action | Promise<Action>)[] {\n        const result: Action[] = [];\n        result.push(SelectAllAction.create({ select: false }));\n        result.push(target.createAction(edgeInProgressID));\n        result.push(SelectAction.create({ selectedElementsIDs: [edgeInProgressID] }));\n        result.push(SwitchEditModeAction.create({ elementsToActivate: [edgeInProgressID] }));\n        result.push(SelectAction.create({ selectedElementsIDs: [edgeInProgressTargetHandleID] }));\n        result.push(SwitchEditModeAction.create({ elementsToActivate: [edgeInProgressTargetHandleID] }));\n        return result;\n    }\n\n    protected activateRoutingHandle(target: SRoutingHandleImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [SwitchEditModeAction.create({ elementsToActivate: [target.id] })];\n    }\n\n    override mouseMove(target: SModelElementImpl, event: MouseEvent): Action[] {\n        const result: Action[] = [];\n        if (event.buttons === 0)\n            this.mouseUp(target, event);\n        else if (this.startDragPosition) {\n            if (this.elementId2startPos.size === 0) {\n                this.collectStartPositions(target.root);\n            }\n            this.hasDragged = true;\n            const moveAction = this.getElementMoves(target, event, false);\n            if (moveAction)\n                result.push(moveAction);\n        }\n        return result;\n    }\n\n    protected collectStartPositions(root: SModelRootImpl) {\n        const selectedElements = new Set<SModelElementImpl>(root.index.all()\n            .filter(element => isSelectable(element) && element.selected));\n\n        selectedElements.forEach(element => {\n            if (!this.isChildOfSelected(selectedElements, element)) {\n                if (isMoveable(element))\n                    this.elementId2startPos.set(element.id, element.position);\n                else if (element instanceof SRoutingHandleImpl) {\n                    const position = this.getHandlePosition(element);\n                    if (position)\n                        this.elementId2startPos.set(element.id, position);\n                }\n            }\n        });\n    }\n\n    protected isChildOfSelected(selectedElements: Set<SModelElementImpl>, element: SModelElementImpl): boolean {\n        while (element instanceof SChildElementImpl) {\n            element = element.parent;\n            if (isMoveable(element) && selectedElements.has(element)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    protected getElementMoves(target: SModelElementImpl, event: MouseEvent, isFinished: boolean): MoveAction | undefined {\n        if (!this.startDragPosition)\n            return undefined;\n        const elementMoves: ElementMove[] = [];\n        const viewport = findParentByFeature(target, isViewport);\n        const zoom = viewport ? viewport.zoom : 1;\n        const delta = {\n            x: (event.pageX - this.startDragPosition.x) / zoom,\n            y: (event.pageY - this.startDragPosition.y) / zoom\n        };\n        this.elementId2startPos.forEach((startPosition, elementId) => {\n            const element = target.root.index.getById(elementId);\n            if (element) {\n                const move = this.createElementMove(element, startPosition, delta, event);\n                if (move) {\n                    elementMoves.push(move);\n                }\n            }\n        });\n        if (elementMoves.length > 0)\n            return MoveAction.create(elementMoves, { animate: false, finished: isFinished });\n        else\n            return undefined;\n    }\n\n    protected createElementMove(element: SModelElementImpl, startPosition: Point, delta: Point, event: MouseEvent): ElementMove | undefined {\n        const toPosition = this.snap({\n            x: startPosition.x + delta.x,\n            y: startPosition.y + delta.y\n        }, element, !event.shiftKey);\n        if (isMoveable(element)) {\n            return {\n                elementId: element.id,\n                elementType: element.type,\n                fromPosition: {\n                    x: element.position.x,\n                    y: element.position.y\n                },\n                toPosition\n            };\n        } else if (element instanceof SRoutingHandleImpl) {\n            const point = this.getHandlePosition(element);\n            if (point !== undefined) {\n                return {\n                    elementId: element.id,\n                    elementType: element.type,\n                    fromPosition: point,\n                    toPosition\n                };\n            }\n        }\n        return undefined;\n    }\n\n    protected snap(position: Point, element: SModelElementImpl, isSnap: boolean): Point {\n        if (isSnap && this.snapper)\n            return this.snapper.snap(position, element);\n        else\n            return position;\n    }\n\n    protected getHandlePosition(handle: SRoutingHandleImpl): Point | undefined {\n        if (this.edgeRouterRegistry) {\n            const parent = handle.parent;\n            if (!(parent instanceof SRoutableElementImpl))\n                return undefined;\n            const router = this.edgeRouterRegistry.get(parent.routerKind);\n            const route = router.route(parent);\n            return router.getHandlePosition(parent, route, handle);\n        }\n        return undefined;\n    }\n\n    override mouseEnter(target: SModelElementImpl, event: MouseEvent): Action[] {\n        if (target instanceof SModelRootImpl && event.buttons === 0 && !this.startDragPosition)\n            this.mouseUp(target, event);\n        return [];\n    }\n\n    override mouseUp(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        const result: Action[] = [];\n        if (this.startDragPosition) {\n            const moveAction = this.getElementMoves(target, event, true);\n            if (moveAction) {\n                result.push(moveAction);\n            }\n            target.root.index.all().forEach(element => {\n                if (element instanceof SRoutingHandleImpl) {\n                    result.push(...this.deactivateRoutingHandle(element, target, event));\n                }\n            });\n        }\n        if (!result.some(a => a.kind === ReconnectAction.KIND)) {\n            const edgeInProgress = target.root.index.getById(edgeInProgressID);\n            if (edgeInProgress instanceof SChildElementImpl) {\n                result.push(this.deleteEdgeInProgress(edgeInProgress));\n            }\n        }\n        if (this.hasDragged) {\n            result.push(CommitModelAction.create());\n        }\n        this.hasDragged = false;\n        this.startDragPosition = undefined;\n        this.elementId2startPos.clear();\n        return result;\n    }\n\n    protected deactivateRoutingHandle(element: SRoutingHandleImpl, target: SModelElementImpl, event: MouseEvent): Action[] {\n        const result: Action[] = [];\n        const parent = element.parent;\n        if (parent instanceof SRoutableElementImpl && element.danglingAnchor) {\n            const handlePos = this.getHandlePosition(element);\n            if (handlePos) {\n                const handlePosAbs = translatePoint(handlePos, element.parent, element.root);\n                const newEnd = findChildrenAtPosition(target.root, handlePosAbs)\n                    .find(e => isConnectable(e) && e.canConnect(parent, element.kind as ('source' | 'target')));\n                if (newEnd && this.hasDragged) {\n                    result.push(ReconnectAction.create({\n                        routableId: element.parent.id,\n                        newSourceId: element.kind === 'source' ? newEnd.id : parent.sourceId,\n                        newTargetId: element.kind === 'target' ? newEnd.id : parent.targetId\n                    }));\n                }\n            }\n        }\n        if (element.editMode) {\n            result.push(SwitchEditModeAction.create({ elementsToDeactivate: [element.id] }));\n        }\n        return result;\n    }\n\n    protected deleteEdgeInProgress(edgeInProgress: SChildElementImpl): Action {\n        const deleteIds: string[] = [];\n        deleteIds.push(edgeInProgressID);\n        edgeInProgress.children.forEach(c => {\n            if (c instanceof SRoutingHandleImpl && c.danglingAnchor)\n                deleteIds.push(c.danglingAnchor.id);\n        });\n        return DeleteElementAction.create(deleteIds);\n    }\n\n    override decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        return vnode;\n    }\n}\n\n@injectable()\nexport class LocationPostprocessor implements IVNodePostprocessor {\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        if (isEdgeLayoutable(element) && element.parent instanceof SEdgeImpl) {\n            // The element is handled by EdgeLayoutDecorator\n            return vnode;\n        }\n        let translate: string = '';\n        if (isLocateable(element) && element instanceof SChildElementImpl && element.parent !== undefined) {\n            const pos = element.position;\n            if (pos.x !== 0 || pos.y !== 0) {\n                translate = 'translate(' + pos.x + ', ' + pos.y + ')';\n            }\n        }\n        if (isAlignable(element)) {\n            const ali = element.alignment;\n            if (ali.x !== 0 || ali.y !== 0) {\n                if (translate.length > 0) {\n                    translate += ' ';\n                }\n                translate += 'translate(' + ali.x + ', ' + ali.y + ')';\n            }\n        }\n        if (translate.length > 0) {\n            setAttr(vnode, 'transform', translate);\n        }\n        return vnode;\n    }\n\n    postUpdate(): void {\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from \"inversify\";\nimport { Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { SModelElementImpl } from \"../../base/model/smodel\";\nimport { isBoundsAware } from \"../bounds/model\";\n\n/**\n * A snapper helps to align nodes and routing handles.\n */\nexport interface ISnapper {\n    /**\n     * @retruns the closest snapped position that for the `element` located at `position`\n     */\n    snap(position: Point, element: SModelElementImpl): Point\n}\n\n/**\n * A simple snapper that snaps the center of nodes and routing points to a grid.\n */\n@injectable()\nexport class CenterGridSnapper implements ISnapper {\n\n    get gridX() {\n        return 10;\n    }\n\n    get gridY() {\n        return 10;\n    }\n\n    snap(position: Point, element: SModelElementImpl): Point {\n        if (element && isBoundsAware(element))\n            return {\n                x: Math.round((position.x + 0.5 * element.bounds.width) / this.gridX) * this.gridX - 0.5 * element.bounds.width,\n                y: Math.round((position.y + 0.5 * element.bounds.height) / this.gridY) * this.gridY - 0.5 * element.bounds.height\n            };\n        else\n            return {\n                x: Math.round(position.x / this.gridX) * this.gridX,\n                y: Math.round(position.y / this.gridY) * this.gridY\n            };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElementImpl } from '../../base/model/smodel';\n\nexport const openFeature = Symbol('openFeature');\n\nexport function isOpenable(element: SModelElementImpl): element is SModelElementImpl  {\n    return element.hasFeature(openFeature);\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Action, OpenAction } from 'sprotty-protocol/lib/actions';\nimport { MouseListener } from '../../base/views/mouse-tool';\nimport { SModelElementImpl } from '../../base/model/smodel';\nimport { findParentByFeature } from '../../base/model/smodel-utils';\nimport { isOpenable } from './model';\n\n\nexport class OpenMouseListener extends MouseListener {\n    override doubleClick(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        const openableTarget = findParentByFeature(target, isOpenable);\n        if (openableTarget !== undefined) {\n            return [ OpenAction.create(openableTarget.id) ];\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Viewport } from 'sprotty-protocol/lib/model';\nimport { Bounds, Dimension } from 'sprotty-protocol/lib/utils/geometry';\nimport { hasOwnProperty } from 'sprotty-protocol/lib/utils/object';\nimport { SChildElementImpl, SModelRootImpl, SParentElementImpl } from '../../base/model/smodel';\nimport { transformToRootBounds } from '../../base/model/smodel-utils';\nimport { isBoundsAware } from '../bounds/model';\n\n/**\n * Model elements implementing this interface can be displayed on a projection bar.\n * _Note:_ If set, the projectedBounds property will be prefered over the model element bounds.\n * Otherwise model elements also have to be `BoundsAware` so their projections can be shown.\n */\nexport interface Projectable {\n    projectionCssClasses: string[],\n    projectedBounds?: Bounds,\n}\n\nexport function isProjectable(arg: unknown): arg is Projectable {\n    return hasOwnProperty(arg, 'projectionCssClasses');\n}\n\n/**\n * A projection can be shown in a horizontal or vertical bar to display an overview of the diagram.\n */\nexport interface ViewProjection {\n    elementId: string;\n    projectedBounds: Bounds;\n    cssClasses: string[];\n}\n\n/**\n * Gather all projections of elements contained in the given parent element.\n */\nexport function getProjections(parent: Readonly<SParentElementImpl>): ViewProjection[] | undefined {\n    let result: ViewProjection[] | undefined;\n    for (const child of parent.children) {\n        if (isProjectable(child) && child.projectionCssClasses.length > 0) {\n            const projectedBounds = getProjectedBounds(child);\n            if (projectedBounds) {\n                const projection: ViewProjection = {\n                    elementId: child.id,\n                    projectedBounds,\n                    cssClasses: child.projectionCssClasses\n                };\n                if (result) {\n                    result.push(projection);\n                } else {\n                    result = [projection];\n                }\n            }\n        }\n        if (child.children.length > 0) {\n            const childProj = getProjections(child);\n            if (childProj) {\n                if (result) {\n                    result.push(...childProj);\n                } else {\n                    result = childProj;\n                }\n            }\n        }\n    }\n    return result;\n}\n\n/**\n * Compute the projected bounds of the given model element, that is the absolute position in the diagram.\n */\nexport function getProjectedBounds(model: Readonly<SChildElementImpl & Projectable>): Bounds | undefined {\n    const parent = model.parent;\n    if (model.projectedBounds) {\n        let bounds = model.projectedBounds;\n        if (isBoundsAware(parent)) {\n            bounds = transformToRootBounds(parent, bounds);\n        }\n        return bounds;\n    } else if (isBoundsAware(model)) {\n        let bounds = model.bounds;\n        bounds = transformToRootBounds(parent, bounds);\n        return bounds;\n    }\n    return undefined;\n}\n\nconst MAX_COORD = 1_000_000_000;\n\n/**\n * Determine the total bounds of a model; this takes the viewport into consideration\n * so it can be shown in the projections.\n */\nexport function getModelBounds(model: SModelRootImpl & Viewport): Bounds | undefined {\n    let minX = MAX_COORD;\n    let minY = MAX_COORD;\n    let maxX = -MAX_COORD;\n    let maxY = -MAX_COORD;\n\n    const bounds = isBoundsAware(model) ? model.bounds : undefined;\n    if (bounds && Dimension.isValid(bounds)) {\n        // Get the bounds directly from the model if it returns a valid size\n        minX = bounds.x;\n        minY = bounds.y;\n        maxX = minX + bounds.width;\n        maxY = minY + bounds.height;\n    } else {\n        // Determine the min. / max coordinates of top-level model elements\n        // Note that this approach is slower, so provide valid bounds to speed up the process.\n        for (const element of model.children) {\n            if (isBoundsAware(element)) {\n                const b = element.bounds;\n                minX = Math.min(minX, b.x);\n                minY = Math.min(minY, b.y);\n                maxX = Math.max(maxX, b.x + b.width);\n                maxY = Math.max(maxY, b.y + b.height);\n            }\n        }\n    }\n\n    // Enlarge the bounds by the current viewport to ensure it always fits into the projection\n    minX = Math.min(minX, model.scroll.x);\n    minY = Math.min(minY, model.scroll.y);\n    maxX = Math.max(maxX, model.scroll.x + model.canvasBounds.width / model.zoom);\n    maxY = Math.max(maxY, model.scroll.y + model.canvasBounds.height / model.zoom);\n\n    if (minX < maxX && minY < maxY) {\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY\n        };\n    }\n    return undefined;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/** @jsx html */\nimport { html } from '../../lib/jsx';\n\nimport { injectable } from 'inversify';\nimport { VNode, VNodeStyle, h } from 'snabbdom';\nimport { Bounds } from 'sprotty-protocol/lib/utils/geometry';\nimport { IView, IViewArgs, RenderingContext } from '../../base/views/view';\nimport { setAttr, setClass } from '../../base/views/vnode-utils';\nimport { ViewportRootElementImpl } from '../viewport/viewport-root';\nimport { getModelBounds, getProjections, ViewProjection } from './model';\n\n/**\n * Special viewport root view that renders horizontal and vertical projection bars for quick navigation.\n */\n@injectable()\nexport class ProjectedViewportView implements IView {\n\n    render(model: Readonly<ViewportRootElementImpl>, context: RenderingContext, args?: IViewArgs): VNode {\n        const rootNode: VNode = <div class-sprotty-root={true}>\n            {this.renderSvg(model, context, args)}\n            {this.renderProjections(model, context, args)}\n        </div>;\n        setAttr(rootNode, 'tabindex', 0); // make root div focus-able\n        return rootNode;\n    }\n\n    protected renderSvg(model: Readonly<ViewportRootElementImpl>, context: RenderingContext, args?: IViewArgs): VNode {\n        const transform = `scale(${model.zoom}) translate(${-model.scroll.x},${-model.scroll.y})`;\n        const ns = 'http://www.w3.org/2000/svg';\n        return h('svg', { ns }, h('g', { ns, attrs: { transform } }, context.renderChildren(model)));\n    }\n\n    protected renderProjections(model: Readonly<ViewportRootElementImpl>, context: RenderingContext, args?: IViewArgs): VNode[] {\n        if (model.zoom <= 0) {\n            return [];\n        }\n        const modelBounds = getModelBounds(model);\n        if (!modelBounds) {\n            return [];\n        }\n        const projections = getProjections(model) ?? [];\n        return [\n            this.renderProjectionBar(projections, model, modelBounds, 'vertical'),\n            this.renderProjectionBar(projections, model, modelBounds, 'horizontal')\n        ];\n    }\n\n    protected renderProjectionBar(projections: ViewProjection[], model: Readonly<ViewportRootElementImpl>, modelBounds: Bounds, orientation: 'horizontal' | 'vertical'): VNode {\n        const params: ProjectionParams = { modelBounds, orientation } as ProjectionParams;\n        // NOTE: Here we assume that the projection bars have the same size as the diagram canvas, i.e. they are drawn as overlay above the canvas.\n        params.factor = orientation === 'horizontal' ? model.canvasBounds.width / modelBounds.width : model.canvasBounds.height / modelBounds.height;\n        params.zoomedFactor = params.factor / model.zoom;\n        return <div\n                class-sprotty-projection-bar={true}\n                class-horizontal={orientation === 'horizontal'}\n                class-vertical={orientation === 'vertical'} >\n            {this.renderViewport(model, params)}\n            {projections.map(p => this.renderProjection(p, model, params))}\n        </div>;\n    }\n\n    protected renderViewport(model: Readonly<ViewportRootElementImpl>, params: ProjectionParams): VNode {\n        let canvasSize, viewportPos: number;\n        if (params.orientation === 'horizontal') {\n            canvasSize = model.canvasBounds.width;\n            viewportPos = (model.scroll.x - params.modelBounds.x) * params.factor;\n        } else {\n            canvasSize = model.canvasBounds.height;\n            viewportPos = (model.scroll.y - params.modelBounds.y) * params.factor;\n        }\n        let viewportSize = canvasSize * params.zoomedFactor;\n        if (viewportPos < 0) {\n            viewportSize += viewportPos;\n            viewportPos = 0;\n        } else if (viewportPos > canvasSize) {\n            viewportPos = canvasSize;\n        }\n        if (viewportSize < 0) {\n            viewportSize = 0;\n        } else if (viewportPos + viewportSize > canvasSize) {\n            viewportSize = canvasSize - viewportPos;\n        }\n        const style: VNodeStyle = params.orientation === 'horizontal' ? {\n            left: `${viewportPos}px`,\n            width: `${viewportSize}px`\n        } : {\n            top: `${viewportPos}px`,\n            height: `${viewportSize}px`\n        };\n        return <div class-sprotty-viewport={true} style={style} />;\n    }\n\n    protected renderProjection(projection: ViewProjection, model: Readonly<ViewportRootElementImpl>, params: ProjectionParams): VNode {\n        let canvasSize, projPos, projSize: number;\n        if (params.orientation === 'horizontal') {\n            canvasSize = model.canvasBounds.width;\n            projPos = (projection.projectedBounds.x - params.modelBounds.x) * params.factor;\n            projSize = projection.projectedBounds.width * params.factor;\n        } else {\n            canvasSize = model.canvasBounds.height;\n            projPos = (projection.projectedBounds.y - params.modelBounds.y) * params.factor;\n            projSize = projection.projectedBounds.height * params.factor;\n        }\n        if (projPos < 0) {\n            projSize += projPos;\n            projPos = 0;\n        } else if (projPos > canvasSize) {\n            projPos = canvasSize;\n        }\n        if (projSize < 0) {\n            projSize = 0;\n        } else if (projPos + projSize > canvasSize) {\n            projSize = canvasSize - projPos;\n        }\n        const style: VNodeStyle = params.orientation === 'horizontal' ? {\n            left: `${projPos}px`,\n            width: `${projSize}px`\n        } : {\n            top: `${projPos}px`,\n            height: `${projSize}px`\n        };\n        const result = <div id={`${params.orientation}-projection:${projection.elementId}`} class-sprotty-projection={true} style={style} />;\n        projection.cssClasses.forEach(cl => setClass(result, cl, true));\n        return result;\n    }\n\n}\n\nexport type ProjectionParams = {\n    modelBounds: Bounds\n    orientation: 'horizontal' | 'vertical'\n    factor: number\n    zoomedFactor: number\n};\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { IAnchorComputer, ELLIPTIC_ANCHOR_KIND, RECTANGULAR_ANCHOR_KIND, DIAMOND_ANCHOR_KIND } from \"./anchor\";\nimport { SConnectableElementImpl } from \"./model\";\nimport { PointToPointLine, Diamond, intersection } from \"../../utils/geometry\";\nimport { injectable } from \"inversify\";\nimport { PolylineEdgeRouter } from \"./polyline-edge-router\";\nimport { almostEquals, Bounds, Point } from \"sprotty-protocol/lib/utils/geometry\";\n\n@injectable()\nexport class EllipseAnchor implements IAnchorComputer {\n\n    get kind() {\n        return PolylineEdgeRouter.KIND + ':' + ELLIPTIC_ANCHOR_KIND;\n    }\n\n    getAnchor(connectable: SConnectableElementImpl, refPoint: Point, offset: number = 0): Point {\n        const bounds = connectable.bounds;\n        const c = Bounds.center(bounds);\n        const dx = c.x - refPoint.x;\n        const dy = c.y - refPoint.y;\n        const distance = Math.sqrt(dx * dx + dy * dy);\n        const normX = (dx / distance) || 0;\n        const normY = (dy / distance) || 0;\n        return {\n            x: c.x - normX * (0.5 * bounds.width + offset),\n            y: c.y - normY * (0.5 * bounds.height + offset)\n        };\n    }\n}\n\n@injectable()\nexport class RectangleAnchor implements IAnchorComputer {\n\n    get kind() {\n        return PolylineEdgeRouter.KIND + ':' + RECTANGULAR_ANCHOR_KIND;\n    }\n\n    getAnchor(connectable: SConnectableElementImpl, refPoint: Point, offset: number = 0): Point {\n        const bounds = connectable.bounds;\n        const c = Bounds.center(bounds);\n        const finder = new NearestPointFinder(c, refPoint);\n        if (!almostEquals(c.y, refPoint.y)) {\n            const xTop = this.getXIntersection(bounds.y, c, refPoint);\n            if (xTop >= bounds.x && xTop <= bounds.x + bounds.width)\n                finder.addCandidate(xTop, bounds.y - offset);\n            const xBottom = this.getXIntersection(bounds.y + bounds.height, c, refPoint);\n            if (xBottom >= bounds.x && xBottom <= bounds.x + bounds.width)\n                finder.addCandidate(xBottom, bounds.y + bounds.height + offset);\n        }\n        if (!almostEquals(c.x, refPoint.x)) {\n            const yLeft = this.getYIntersection(bounds.x, c, refPoint);\n            if (yLeft >= bounds.y && yLeft <= bounds.y + bounds.height)\n                finder.addCandidate(bounds.x - offset, yLeft);\n            const yRight = this.getYIntersection(bounds.x + bounds.width, c, refPoint);\n            if (yRight >= bounds.y && yRight <= bounds.y + bounds.height)\n                finder.addCandidate(bounds.x + bounds.width + offset, yRight);\n        }\n        return finder.best;\n    }\n\n    protected getXIntersection(yIntersection: number, centerPoint: Point, point: Point): number {\n        const t = (yIntersection - centerPoint.y) / (point.y - centerPoint.y);\n        return (point.x - centerPoint.x) * t + centerPoint.x;\n    }\n\n    protected getYIntersection(xIntersection: number, centerPoint: Point, point: Point): number {\n        const t = (xIntersection - centerPoint.x) / (point.x - centerPoint.x);\n        return (point.y - centerPoint.y) * t + centerPoint.y;\n    }\n}\n\nclass NearestPointFinder {\n    protected currentBest: Point | undefined;\n    protected currentDist: number = -1;\n\n    constructor(protected centerPoint: Point, protected refPoint: Point) {\n    }\n\n    addCandidate(x: number, y: number) {\n        const dx = this.refPoint.x - x;\n        const dy = this.refPoint.y - y;\n        const dist = dx * dx + dy * dy;\n        if (this.currentDist < 0 || dist < this.currentDist) {\n            this.currentBest = {\n                x: x,\n                y: y\n            };\n            this.currentDist = dist;\n        }\n    }\n\n    get best(): Point {\n        if (this.currentBest === undefined)\n            return this.centerPoint;\n        else\n            return this.currentBest;\n    }\n}\n\n@injectable()\nexport class DiamondAnchor implements IAnchorComputer {\n\n    get kind() {\n        return PolylineEdgeRouter.KIND + ':' + DIAMOND_ANCHOR_KIND;\n    }\n\n    getAnchor(connectable: SConnectableElementImpl, refPoint: Point, offset: number): Point {\n        const bounds = connectable.bounds;\n        const referenceLine = new PointToPointLine(Bounds.center(bounds), refPoint);\n        const closestDiamondSide = new Diamond(bounds).closestSideLine(refPoint);\n        const anchorPoint = intersection(closestDiamondSide, referenceLine);\n        return Point.shiftTowards(anchorPoint, refPoint, offset);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { Action } from 'sprotty-protocol/lib/actions';\nimport { centerOfLine, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { ResolvedHandleMove } from '../move/move';\nimport { SDanglingAnchorImpl, SRoutableElementImpl, SRoutingHandleImpl } from './model';\nimport { SModelElementImpl } from '../../base/model/smodel';\nimport { EdgeRouterRegistry, RoutedPoint } from './routing';\nimport { AbstractEdgeRouter, LinearRouteOptions } from './abstract-edge-router';\nimport { MouseListener } from '../../base/views/mouse-tool';\nimport { Command, CommandExecutionContext, CommandReturn } from '../../base/commands/command';\nimport { TYPES } from \"../../base/types\";\nimport { SEdgeImpl } from '../../graph/sgraph';\n\n@injectable()\nexport class BezierEdgeRouter extends AbstractEdgeRouter {\n\n    static readonly KIND = 'bezier';\n    static readonly DEFAULT_BEZIER_HANDLE_OFFSET = 25;\n\n    get kind() {\n        return BezierEdgeRouter.KIND;\n    }\n\n    route(edge: SRoutableElementImpl): RoutedPoint[] {\n        if (!edge.source || !edge.target)\n            return [];\n        const rpCount = edge.routingPoints.length;\n        const source = edge.source;\n        const target = edge.target;\n\n        const result: RoutedPoint[] = [];\n        result.push({ kind: 'source', x: 0, y: 0 });\n        if (rpCount === 0) {\n            // initial values\n            const [h1, h2] = this.createDefaultBezierHandles(source.position, target.position);\n            result.push( { kind: 'bezier-control-after', x: h1.x, y: h1.y, pointIndex: 0 } );\n            result.push( { kind: 'bezier-control-before', x: h2.x, y: h2.y, pointIndex: 1 } );\n            edge.routingPoints.push(h1);\n            edge.routingPoints.push(h2);\n        } else if (rpCount >= 2) {\n            for (let i = 0; i < rpCount; i++) {\n                const p = edge.routingPoints[i];\n                if (i % 3 === 0) {\n                    result.push({ kind: 'bezier-control-after', x: p.x, y: p.y, pointIndex: i });\n                }\n                if ((i + 1) % 3 === 0) {\n                    result.push({ kind: 'bezier-junction', x: p.x, y: p.y, pointIndex: i });\n                } else if ((i + 2) % 3 === 0) {\n                    result.push({ kind: 'bezier-control-before', x: p.x, y: p.y, pointIndex: i });\n                }\n            }\n        }\n        result.push({ kind: 'target', x: 0, y: 0 });\n\n        // use \"ends\" of edge as reference or next bezier-junction\n        const p0 = rpCount > 2 ? edge.routingPoints[2] : target.position;\n        const pn = rpCount > 2 ? edge.routingPoints[edge.routingPoints.length - 3] : source.position;\n\n        const sourceAnchor = this.getTranslatedAnchor(source, p0, target.parent, edge, edge.sourceAnchorCorrection);\n        const targetAnchor = this.getTranslatedAnchor(target, pn, source.parent, edge, edge.targetAnchorCorrection);\n\n        result[0] = { kind: 'source', x: sourceAnchor.x, y: sourceAnchor.y };\n        result[result.length - 1] = { kind: 'target', x: targetAnchor.x, y: targetAnchor.y };\n\n        return result;\n    }\n\n    private createDefaultBezierHandles(relH1: Point, relH2: Point): [Point, Point] {\n        const h1 = {\n            x: relH1.x - BezierEdgeRouter.DEFAULT_BEZIER_HANDLE_OFFSET,\n            y: relH1.y\n        };\n        const h2 = {\n            x: relH2.x + BezierEdgeRouter.DEFAULT_BEZIER_HANDLE_OFFSET,\n            y: relH2.y\n        };\n        return [ h1, h2 ];\n    }\n\n    createRoutingHandles(edge: SRoutableElementImpl): void {\n        // route ensure there are at least 2 routed points\n        this.route(edge);\n\n        this.rebuildHandles(edge);\n    }\n\n    private rebuildHandles(edge: SRoutableElementImpl) {\n        this.addHandle(edge, 'source', 'routing-point', -2);\n        this.addHandle(edge, 'bezier-control-after', 'bezier-routing-point', 0);\n        this.addHandle(edge, 'bezier-add', 'bezier-create-routing-point', 0);\n        const rpCount = edge.routingPoints.length;\n\n        if (rpCount > 2) {\n            for (let i = 1; i < rpCount - 1; i += 3) {\n                this.addHandle(edge, 'bezier-control-before', 'bezier-routing-point', i);\n                // Add two circle for add/remove segments\n                this.addHandle(edge, 'bezier-add', 'bezier-create-routing-point', i + 1);\n                this.addHandle(edge, 'bezier-junction', 'routing-point', i + 1);\n                this.addHandle(edge, 'bezier-remove', 'bezier-remove-routing-point', i + 1);\n                this.addHandle(edge, 'bezier-control-after', 'bezier-routing-point', i + 2);\n\n                // re-position control-pairs\n                this.moveBezierControlPair(edge.routingPoints[i], i, edge);\n            }\n        }\n        this.addHandle(edge, 'bezier-control-before', 'bezier-routing-point', rpCount - 1);\n        this.addHandle(edge, 'target', 'routing-point', -1);\n    }\n\n    getInnerHandlePosition(edge: SRoutableElementImpl, route: RoutedPoint[], handle: SRoutingHandleImpl) {\n       if (handle.kind === 'bezier-control-before' || handle.kind === 'bezier-junction' || handle.kind === 'bezier-control-after') {\n            for (let i = 0; i < route.length; i++) {\n                const p = route[i];\n                if (p.pointIndex === handle.pointIndex && p.kind === handle.kind)\n                    return p;\n            }\n        } else if (handle.kind === 'bezier-add') {\n            const ctrlPoint = this.findBezierControl(edge, route, handle.pointIndex);\n            return { x: ctrlPoint.x, y: ctrlPoint.y + 12.5};\n        } else if (handle.kind === 'bezier-remove') {\n            const ctrlPoint = this.findBezierControl(edge, route, handle.pointIndex);\n            return { x: ctrlPoint.x, y: ctrlPoint.y - 12.5};\n        }\n        return undefined;\n    }\n\n    protected findBezierControl(edge: SRoutableElementImpl, route: RoutedPoint[], handleIndex: number): Point {\n        let result: Point = { x: route[0].x, y: route[0].y };\n        if (handleIndex > 0) {\n            for (const rp of route) {\n                if (rp.pointIndex !== undefined && rp.pointIndex === handleIndex && rp.kind === 'bezier-junction') {\n                    result = { x: rp.x, y: rp.y };\n                    break;\n                }\n            }\n        }\n        return result;\n    }\n\n    override applyHandleMoves(edge: SRoutableElementImpl, moves: ResolvedHandleMove[]): void {\n        moves.forEach(move => {\n            const handle = move.handle;\n            let orgPosition = { x: 0, y: 0 };\n            let relativePos, newControlPos, ctrlPointIndex;\n            const moveToPos = move.toPosition;\n\n            switch (handle.kind) {\n                case 'bezier-control-before':\n                case 'bezier-control-after':\n                    // find potential other handle/rp and move\n                    this.moveBezierControlPair(moveToPos, move.handle.pointIndex, edge);\n                    break;\n                case 'bezier-junction':\n                    const index = handle.pointIndex;\n                    if (index >= 0 && index < edge.routingPoints.length) {\n                        ctrlPointIndex = index - 1;\n                        orgPosition = edge.routingPoints[index];\n                        relativePos = edge.routingPoints[ctrlPointIndex];\n                        newControlPos = this.calcRelativeMove(orgPosition, moveToPos, relativePos);\n                        edge.routingPoints[index] = moveToPos;\n                        this.moveBezierControlPair(newControlPos, ctrlPointIndex, edge);\n                    }\n                    break;\n                case 'source':\n                    ctrlPointIndex = 0;\n                    relativePos = edge.routingPoints[ctrlPointIndex];\n\n                    if (!(edge.source instanceof SDanglingAnchorImpl)) {\n                        // detach source\n                        const anchor = new SDanglingAnchorImpl();\n                        anchor.id = edge.id + '_dangling-source';\n                        anchor.original = edge.source;\n                        anchor.position = move.toPosition;\n                        handle.root.add(anchor);\n                        handle.danglingAnchor = anchor;\n                        edge.sourceId = anchor.id;\n                        if (edge.source) orgPosition = edge.source.position;\n                    } else if (handle.danglingAnchor) {\n                        orgPosition = handle.danglingAnchor.position;\n                        handle.danglingAnchor.position = moveToPos;\n                    }\n                    newControlPos = this.calcRelativeMove(orgPosition, moveToPos, relativePos);\n                    this.moveBezierControlPair(newControlPos, ctrlPointIndex, edge);\n                    break;\n                case 'target':\n                    ctrlPointIndex = edge.routingPoints.length - 1;\n                    relativePos = edge.routingPoints[ctrlPointIndex];\n\n                    if (!(edge.target instanceof SDanglingAnchorImpl)) {\n                        // detach target\n                        const anchor = new SDanglingAnchorImpl();\n                        anchor.id = edge.id + '_dangling-target';\n                        anchor.original = edge.target;\n                        anchor.position = moveToPos;\n                        handle.root.add(anchor);\n                        handle.danglingAnchor = anchor;\n                        edge.targetId = anchor.id;\n                        if (edge.target) orgPosition = edge.target.position;\n                    } else if (handle.danglingAnchor) {\n                        orgPosition = handle.danglingAnchor.position;\n                        handle.danglingAnchor.position = moveToPos;\n                    }\n                    newControlPos = this.calcRelativeMove(orgPosition, moveToPos, relativePos);\n                    this.moveBezierControlPair(newControlPos, ctrlPointIndex, edge);\n                    break;\n                default:\n                    break;\n            }\n        });\n    }\n\n    protected applyInnerHandleMoves(edge: SRoutableElementImpl, moves: ResolvedHandleMove[]): void {\n        // not required\n    }\n\n    protected getOptions(edge: SRoutableElementImpl): LinearRouteOptions {\n        return  {\n            minimalPointDistance: 2,\n            standardDistance: 0.1,\n            selfEdgeOffset: 20\n        };\n    }\n\n    private calcRelativeMove(oldPos: Point, newPos: Point, relativePoint: Point): Point {\n        return {\n            x: relativePoint.x - (oldPos.x - newPos.x),\n            y: relativePoint.y - (oldPos.y - newPos.y)\n        };\n    }\n\n    public createNewBezierSegment(index: number, edge: SRoutableElementImpl): void {\n        const routingPoints = edge.routingPoints;\n\n        let bezierJunctionPos, start, end: Point;\n        if (routingPoints.length === 2) {\n            start = routingPoints[index < 0 ? 0 : index];\n            end = routingPoints[routingPoints.length - 1];\n            bezierJunctionPos = centerOfLine(start, end);\n        } else {\n            start = routingPoints[index];\n            end = routingPoints[index + 2];\n            bezierJunctionPos = centerOfLine(start, end);\n        }\n        const [h1, h2] = this.createDefaultBezierHandles(bezierJunctionPos, bezierJunctionPos);\n\n        routingPoints.splice(index + 1, 0, h1);\n        routingPoints.splice(index + 2, 0, bezierJunctionPos);\n        routingPoints.splice(index + 3, 0, h2);\n        // ensure handles are correctly positioned\n        this.moveBezierControlPair(h1, index + 1, edge);\n\n        // simple solution for now: just rebuildHandles\n        edge.removeAll(c => c instanceof SRoutingHandleImpl);\n        this.rebuildHandles(edge);\n    }\n\n    public removeBezierSegment(index: number, edge: SRoutableElementImpl): void {\n        const routingPoints = edge.routingPoints;\n\n        routingPoints.splice(index - 1, 3);\n\n        // simple solution for now: just rebuildHandles\n        edge.removeAll(c => c instanceof SRoutingHandleImpl);\n        this.rebuildHandles(edge);\n    }\n\n    private moveBezierControlPair(newPos: Point, ctrlPointIndex: number, edge: SRoutableElementImpl) {\n        if (ctrlPointIndex >= 0 && ctrlPointIndex < edge.routingPoints.length) {\n            // find neighbors\n            const before = ctrlPointIndex - 1;\n            const after = ctrlPointIndex + 1;\n\n            // this is the first control or the last control => nothing to do further\n            if (before < 0 || after === edge.routingPoints.length) {\n                edge.routingPoints[ctrlPointIndex] = newPos;\n            } else  {\n                // behind bezier-junction\n                if (ctrlPointIndex % 3 === 0) {\n                    this.setBezierMirror(edge, newPos, ctrlPointIndex, false);\n                // before bezier-junction\n                } else if ((ctrlPointIndex + 2) % 3 === 0) {\n                    this.setBezierMirror(edge, newPos, ctrlPointIndex, true);\n                }\n            }\n        }\n    }\n\n    private setBezierMirror(edge: SRoutableElementImpl, newPos: Point, pointIndex: number, before: boolean) {\n        edge.routingPoints[pointIndex] = newPos;\n        const jct = edge.routingPoints[before ? (pointIndex + 1) : (pointIndex - 1)];\n        edge.routingPoints[before ? (pointIndex + 2) : (pointIndex - 2)] = {\n            x: jct.x - (newPos.x - jct.x),\n            y: jct.y - (newPos.y - jct.y)\n        };\n    }\n\n}\n\n/**\n * Reacts on mouseDown events if the target kind is bezier-add or bezier-remove\n */\nexport class BezierMouseListener extends MouseListener {\n\n    override mouseDown(target: SModelElementImpl, event: MouseEvent): Action[] {\n        const result = [];\n        if (target instanceof SRoutingHandleImpl && (target.kind === 'bezier-add' || target.kind === 'bezier-remove')) {\n            if (target.type === 'bezier-create-routing-point') {\n                result.push(AddRemoveBezierSegmentAction.create('add', target.id));\n            } else if (target.type === 'bezier-remove-routing-point') {\n                result.push(AddRemoveBezierSegmentAction.create('remove', target.id));\n            }\n        }\n        return result;\n    }\n};\n\nexport interface AddRemoveBezierSegmentAction extends Action {\n    kind: typeof AddRemoveBezierSegmentAction.KIND\n    targetId: string\n    actionTask: 'add' | 'remove'\n}\n\nexport namespace AddRemoveBezierSegmentAction {\n    export const KIND = 'addRemoveBezierSegment';\n    export function create(actionTask: 'add' | 'remove', targetId: string): AddRemoveBezierSegmentAction {\n        return {\n            kind: KIND,\n            actionTask,\n            targetId\n        };\n    }\n}\n\n@injectable()\nexport class AddRemoveBezierSegmentCommand extends Command {\n    static readonly KIND = AddRemoveBezierSegmentAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected readonly action: AddRemoveBezierSegmentAction,\n        @inject(EdgeRouterRegistry) protected readonly edgeRouterRegistry?: EdgeRouterRegistry) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const index = context.root.index;\n        const target = index.getById(this.action.targetId);\n\n        if (this.edgeRouterRegistry && target instanceof SRoutingHandleImpl) {\n            const raw = this.edgeRouterRegistry.get((target.parent as SRoutableElementImpl).routerKind);\n            if (raw instanceof BezierEdgeRouter) {\n                const router = raw;\n\n                for (const child of context.root.children) {\n                    if (child.id === target.parent.id) {\n                        if (this.action.actionTask === 'add') {\n                            router.createNewBezierSegment(target.pointIndex, child as SEdgeImpl);\n                        } else if (this.action.actionTask === 'remove') {\n                            router.removeBezierSegment(target.pointIndex, child as SEdgeImpl);\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n\n        return context.root;\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        throw new Error('Method not implemented.');\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        throw new Error('Method not implemented.');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ELLIPTIC_ANCHOR_KIND, RECTANGULAR_ANCHOR_KIND, DIAMOND_ANCHOR_KIND } from \"./anchor\";\nimport { injectable } from \"inversify\";\nimport { DiamondAnchor, EllipseAnchor, RectangleAnchor } from './polyline-anchors';\nimport { BezierEdgeRouter } from './bezier-edge-router';\n\n@injectable()\nexport class BezierEllipseAnchor extends EllipseAnchor {\n\n    override get kind() {\n        return BezierEdgeRouter.KIND + ':' + ELLIPTIC_ANCHOR_KIND;\n    }\n}\n\n@injectable()\nexport class BezierRectangleAnchor extends RectangleAnchor {\n\n    override get kind() {\n        return BezierEdgeRouter.KIND + ':' + RECTANGULAR_ANCHOR_KIND;\n    }\n}\n\n@injectable()\nexport class BezierDiamondAnchor extends DiamondAnchor {\n\n    override get kind() {\n        return BezierEdgeRouter.KIND + ':' + DIAMOND_ANCHOR_KIND;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2020 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { almostEquals, Bounds, Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { translatePoint } from \"../../base/model/smodel-utils\";\nimport { ResolvedHandleMove } from \"../move/move\";\nimport { DefaultAnchors, AbstractEdgeRouter, LinearRouteOptions, Side } from \"./abstract-edge-router\";\nimport { SRoutableElementImpl, RoutingHandleKind, SRoutingHandleImpl } from \"./model\";\nimport { RoutedPoint } from \"./routing\";\n\nexport interface ManhattanRouterOptions extends LinearRouteOptions {\n    standardDistance: number;\n}\n\nexport class ManhattanEdgeRouter extends AbstractEdgeRouter {\n\n    static readonly KIND = 'manhattan';\n\n    get kind() {\n        return ManhattanEdgeRouter.KIND;\n    }\n\n    protected getOptions(edge: SRoutableElementImpl): ManhattanRouterOptions {\n        return {\n            standardDistance: 20,\n            minimalPointDistance: 3,\n            selfEdgeOffset: 0.25\n        };\n    }\n\n    route(edge: SRoutableElementImpl): RoutedPoint[] {\n        if (!edge.source || !edge.target)\n            return [];\n        const routedCorners = this.createRoutedCorners(edge);\n        const sourceRefPoint = routedCorners[0]\n            || translatePoint(Bounds.center(edge.target.bounds), edge.target.parent, edge.parent);\n        const sourceAnchor = this.getTranslatedAnchor(edge.source, sourceRefPoint, edge.parent, edge, edge.sourceAnchorCorrection);\n        const targetRefPoint = routedCorners[routedCorners.length - 1]\n            || translatePoint(Bounds.center(edge.source.bounds), edge.source.parent, edge.parent);\n        const targetAnchor = this.getTranslatedAnchor(edge.target, targetRefPoint, edge.parent, edge, edge.targetAnchorCorrection);\n        if (!sourceAnchor || !targetAnchor)\n            return [];\n        const routedPoints: RoutedPoint[] = [];\n        routedPoints.push({ kind: 'source', ...sourceAnchor});\n        routedCorners.forEach(corner => routedPoints.push(corner));\n        routedPoints.push({ kind: 'target', ...targetAnchor});\n        return routedPoints;\n    }\n\n    protected createRoutedCorners(edge: SRoutableElementImpl): RoutedPoint[] {\n        const sourceAnchors = new DefaultAnchors(edge.source!, edge.parent, 'source');\n        const targetAnchors = new DefaultAnchors(edge.target!, edge.parent, 'target');\n        if (edge.routingPoints.length > 0) {\n            const routingPointsCopy = edge.routingPoints.slice();\n            this.cleanupRoutingPoints(edge, routingPointsCopy, false, true);\n            if (routingPointsCopy.length > 0)\n                return routingPointsCopy.map((routingPoint, index) => {\n                    return <RoutedPoint> { kind: 'linear', pointIndex: index, ...routingPoint};\n                });\n        }\n        const options = this.getOptions(edge);\n        const corners = this.calculateDefaultCorners(edge, sourceAnchors, targetAnchors, options);\n        return corners.map(corner => {\n            return <RoutedPoint> { kind: 'linear', ...corner };\n        });\n    }\n\n    createRoutingHandles(edge: SRoutableElementImpl) {\n        const routedPoints = this.route(edge);\n        this.commitRoute(edge, routedPoints);\n        if (routedPoints.length > 0) {\n            this.addHandle(edge, 'source', 'routing-point', -2);\n            for (let i = 0; i < routedPoints.length - 1; ++i)\n                this.addHandle(edge, 'manhattan-50%', 'volatile-routing-point', i - 1);\n            this.addHandle(edge, 'target', 'routing-point', routedPoints.length - 2);\n        }\n    }\n\n    protected getInnerHandlePosition(edge: SRoutableElementImpl, route: RoutedPoint[], handle: SRoutingHandleImpl) {\n        const fraction = this.getFraction(handle.kind);\n        if (fraction !== undefined) {\n            const { start, end } = this.findRouteSegment(edge, route, handle.pointIndex);\n            if (start !== undefined && end !== undefined)\n                return Point.linear(start, end, fraction);\n        }\n        return undefined;\n    }\n\n    protected getFraction(kind: RoutingHandleKind): number | undefined {\n        switch (kind) {\n            case 'manhattan-50%': return 0.5;\n            default: return undefined;\n        }\n    }\n\n    protected applyInnerHandleMoves(edge: SRoutableElementImpl, moves: ResolvedHandleMove[]) {\n        const route = this.route(edge);\n        const routingPoints = edge.routingPoints;\n        const minimalPointDistance = this.getOptions(edge).minimalPointDistance;\n        moves.forEach(move => {\n            const handle = move.handle;\n            const index = handle.pointIndex;\n            const correctedX = this.correctX(routingPoints, index, move.toPosition.x, minimalPointDistance);\n            const correctedY = this.correctY(routingPoints, index, move.toPosition.y, minimalPointDistance);\n            switch (handle.kind) {\n                case 'manhattan-50%':\n                    if (index < 0) {\n                        if (routingPoints.length === 0) {\n                            routingPoints.push({ x: correctedX, y: correctedY });\n                            handle.pointIndex = 0;\n                        } else if (almostEquals(route[0].x, route[1].x)) {\n                            this.alignX(routingPoints, 0, correctedX);\n                        } else {\n                            this.alignY(routingPoints, 0, correctedY);\n                        }\n                    } else if (index < routingPoints.length - 1) {\n                        if (almostEquals(routingPoints[index].x, routingPoints[index + 1].x)) {\n                            this.alignX(routingPoints, index, correctedX);\n                            this.alignX(routingPoints, index + 1, correctedX);\n                        } else {\n                            this.alignY(routingPoints, index, correctedY);\n                            this.alignY(routingPoints, index + 1, correctedY);\n                        }\n                    } else {\n                        if (almostEquals(route[route.length - 2].x, route[route.length - 1].x)) {\n                            this.alignX(routingPoints, routingPoints.length - 1, correctedX);\n                        } else {\n                            this.alignY(routingPoints, routingPoints.length - 1, correctedY);\n                        }\n                    }\n                    break;\n            }\n        });\n    }\n\n    protected correctX(routingPoints: Point[], index: number, x: number, minimalPointDistance: number) {\n        if (index > 0 && Math.abs(x - routingPoints[index - 1].x) < minimalPointDistance)\n            return routingPoints[index - 1].x;\n        else if (index < routingPoints.length - 2 && Math.abs(x - routingPoints[index + 2].x) < minimalPointDistance)\n            return routingPoints[index + 2].x;\n        else\n            return x;\n    }\n\n    protected alignX(routingPoints: Point[], index: number, x: number) {\n        if (index >= 0 && index < routingPoints.length)\n            routingPoints[index] = {\n                x,\n                y: routingPoints[index].y\n            };\n    }\n\n    protected correctY(routingPoints: Point[], index: number, y: number, minimalPointDistance: number) {\n        if (index > 0 && Math.abs(y - routingPoints[index - 1].y) < minimalPointDistance)\n            return routingPoints[index - 1].y;\n        else if (index < routingPoints.length - 2 && Math.abs(y - routingPoints[index + 2].y) < minimalPointDistance)\n            return routingPoints[index + 2].y;\n        else\n            return y;\n    }\n\n    protected alignY(routingPoints: Point[], index: number, y: number) {\n        if (index >= 0 && index < routingPoints.length)\n            routingPoints[index] = {\n                x: routingPoints[index].x,\n                y\n            };\n    }\n\n    override cleanupRoutingPoints(edge: SRoutableElementImpl, routingPoints: Point[], updateHandles: boolean, addRoutingPoints: boolean) {\n        const sourceAnchors = new DefaultAnchors(edge.source!, edge.parent, \"source\");\n        const targetAnchors = new DefaultAnchors(edge.target!, edge.parent, \"target\");\n        if (this.resetRoutingPointsOnReconnect(edge, routingPoints, updateHandles, sourceAnchors, targetAnchors))\n            return;\n        // delete leading RPs inside the bounds of the source\n        for (let i = 0; i < routingPoints.length; ++i)\n            if (Bounds.includes(sourceAnchors.bounds, routingPoints[i])) {\n                routingPoints.splice(0, 1);\n                if (updateHandles) {\n                    this.removeHandle(edge, -1);\n                }\n            } else {\n                break;\n            }\n        // delete trailing RPs inside the bounds of the target\n        for (let i = routingPoints.length - 1; i >= 0; --i)\n            if (Bounds.includes(targetAnchors.bounds, routingPoints[i])) {\n                routingPoints.splice(i, 1);\n                if (updateHandles) {\n                    this.removeHandle(edge, i);\n                }\n            } else {\n                break;\n        }\n        if (routingPoints.length >= 2) {\n            const options = this.getOptions(edge);\n            for (let i = routingPoints.length - 2; i >= 0; --i) {\n                if (Point.manhattanDistance(routingPoints[i], routingPoints[i + 1]) < options.minimalPointDistance) {\n                    routingPoints.splice(i, 2);\n                    --i;\n                    if (updateHandles) {\n                        this.removeHandle(edge, i - 1);\n                        this.removeHandle(edge, i);\n                    }\n                }\n            }\n        }\n        if (addRoutingPoints) {\n            this.addAdditionalCorner(edge, routingPoints, sourceAnchors, targetAnchors, updateHandles);\n            this.addAdditionalCorner(edge, routingPoints, targetAnchors, sourceAnchors, updateHandles);\n            this.manhattanify(edge, routingPoints);\n        }\n    }\n\n    protected removeHandle(edge: SRoutableElementImpl, pointIndex: number) {\n        const toBeRemoved: SRoutingHandleImpl[] = [];\n        edge.children.forEach(child => {\n            if (child instanceof SRoutingHandleImpl) {\n                if (child.pointIndex > pointIndex)\n                    --child.pointIndex;\n                else if (child.pointIndex === pointIndex)\n                    toBeRemoved.push(child);\n            }\n        });\n        toBeRemoved.forEach(child => edge.remove(child));\n    }\n\n    protected addAdditionalCorner(edge: SRoutableElementImpl, routingPoints: Point[], currentAnchors: DefaultAnchors, otherAnchors: DefaultAnchors, updateHandles: boolean) {\n        if (routingPoints.length === 0)\n            return;\n        const refPoint = currentAnchors.kind === 'source' ? routingPoints[0] : routingPoints[routingPoints.length - 1];\n        const index = currentAnchors.kind === 'source' ? 0 : routingPoints.length;\n        const shiftIndex = index - (currentAnchors.kind === 'source' ? 1 : 0);\n        let isHorizontal: boolean;\n        if (routingPoints.length > 1) {\n            isHorizontal = index === 0\n            ? almostEquals(routingPoints[0].x, routingPoints[1].x)\n            : almostEquals(routingPoints[routingPoints.length - 1].x, routingPoints[routingPoints.length - 2].x);\n        } else {\n            const nearestSide = otherAnchors.getNearestSide(refPoint);\n            isHorizontal = nearestSide === Side.TOP || nearestSide === Side.BOTTOM;\n        }\n        if (isHorizontal) {\n            if (refPoint.y < currentAnchors.get(Side.TOP).y || refPoint.y > currentAnchors.get(Side.BOTTOM).y) {\n                const newPoint = { x: currentAnchors.get(Side.TOP).x, y: refPoint.y };\n                routingPoints.splice(index, 0, newPoint);\n                if (updateHandles) {\n                    edge.children.forEach(child => {\n                        if (child instanceof SRoutingHandleImpl && child.pointIndex >= shiftIndex)\n                            ++child.pointIndex;\n                    });\n                    this.addHandle(edge, 'manhattan-50%', 'volatile-routing-point', shiftIndex);\n                }\n            }\n        } else {\n            if (refPoint.x < currentAnchors.get(Side.LEFT).x || refPoint.x > currentAnchors.get(Side.RIGHT).x) {\n                const newPoint = { x: refPoint.x, y: currentAnchors.get(Side.LEFT).y };\n                routingPoints.splice(index, 0, newPoint);\n                if (updateHandles) {\n                    edge.children.forEach(child => {\n                        if (child instanceof SRoutingHandleImpl && child.pointIndex >= shiftIndex)\n                            ++child.pointIndex;\n                    });\n                    this.addHandle(edge, 'manhattan-50%', 'volatile-routing-point', shiftIndex);\n                }\n            }\n        }\n    }\n\n    /**\n     * Add artificial routing points to keep all angles rectilinear.\n     *\n     * This makes edge morphing look a lot smoother, where RP positions are interpolated\n     * linearly probably resulting in non-rectilinear angles. We don't add handles for\n     * these additional RPs.\n     */\n    protected manhattanify(edge: SRoutableElementImpl, routingPoints: Point[]) {\n        for (let i = 1; i < routingPoints.length; ++i) {\n            const isVertical = Math.abs(routingPoints[i - 1].x - routingPoints[i].x) < 1;\n            const isHorizontal = Math.abs(routingPoints[i - 1].y - routingPoints[i].y) < 1;\n            if (!isVertical && !isHorizontal) {\n                routingPoints.splice(i, 0, {\n                    x: routingPoints[i - 1].x,\n                    y: routingPoints[i].y\n                });\n                ++i;\n            }\n        }\n    }\n\n    protected override calculateDefaultCorners(edge: SRoutableElementImpl, sourceAnchors: DefaultAnchors, targetAnchors: DefaultAnchors, options: ManhattanRouterOptions): Point[] {\n        const selfEdge = super.calculateDefaultCorners(edge, sourceAnchors, targetAnchors, options);\n        if (selfEdge.length > 0)\n            return selfEdge;\n        const bestAnchors = this.getBestConnectionAnchors(edge, sourceAnchors, targetAnchors, options);\n        const sourceSide = bestAnchors.source;\n        const targetSide = bestAnchors.target;\n        const corners: Point[] = [];\n        const startPoint = sourceAnchors.get(sourceSide);\n        let endPoint = targetAnchors.get(targetSide);\n        switch (sourceSide) {\n            case Side.RIGHT:\n                switch (targetSide) {\n                    case Side.BOTTOM:\n                        corners.push({ x: endPoint.x, y: startPoint.y });\n                        break;\n                    case Side.TOP:\n                        corners.push({ x: endPoint.x, y: startPoint.y });\n                        break;\n                    case Side.RIGHT:\n                        corners.push({ x: Math.max(startPoint.x, endPoint.x) + 1.5 * options.standardDistance, y: startPoint.y });\n                        corners.push({ x: Math.max(startPoint.x, endPoint.x) + 1.5 * options.standardDistance, y: endPoint.y });\n                        break;\n                    case Side.LEFT:\n                        if (endPoint.y !== startPoint.y) {\n                            corners.push({ x: (startPoint.x + endPoint.x) / 2, y: startPoint.y });\n                            corners.push({ x: (startPoint.x + endPoint.x) / 2, y: endPoint.y });\n                        }\n                        break;\n                }\n                break;\n            case Side.LEFT:\n                switch (targetSide) {\n                    case Side.BOTTOM:\n                        corners.push({ x: endPoint.x, y: startPoint.y });\n                        break;\n                    case Side.TOP:\n                        corners.push({ x: endPoint.x, y: startPoint.y });\n                        break;\n                    default:\n                        endPoint = targetAnchors.get(Side.RIGHT);\n                        if (endPoint.y !== startPoint.y) {\n                            corners.push({ x: (startPoint.x + endPoint.x) / 2, y: startPoint.y });\n                            corners.push({ x: (startPoint.x + endPoint.x) / 2, y: endPoint.y });\n                        }\n                        break;\n                }\n                break;\n            case Side.TOP:\n                switch (targetSide) {\n                    case Side.RIGHT:\n                        if ((endPoint.x - startPoint.x) > 0) {\n                            corners.push({ x: startPoint.x, y: startPoint.y - options.standardDistance });\n                            corners.push({ x: endPoint.x + 1.5 * options.standardDistance, y: startPoint.y - options.standardDistance });\n                            corners.push({ x: endPoint.x + 1.5 * options.standardDistance, y: endPoint.y });\n                        } else {\n                            corners.push({ x: startPoint.x, y: endPoint.y });\n                        }\n                        break;\n                    case Side.LEFT:\n                        if ((endPoint.x - startPoint.x) < 0) {\n                            corners.push({ x: startPoint.x, y: startPoint.y - options.standardDistance });\n                            corners.push({ x: endPoint.x - 1.5 * options.standardDistance, y: startPoint.y - options.standardDistance });\n                            corners.push({ x: endPoint.x - 1.5 * options.standardDistance, y: endPoint.y });\n                        } else {\n                            corners.push({ x: startPoint.x, y: endPoint.y });\n                        }\n                        break;\n                    case Side.TOP:\n                        corners.push({ x: startPoint.x, y: Math.min(startPoint.y, endPoint.y) - 1.5 * options.standardDistance });\n                        corners.push({ x: endPoint.x, y: Math.min(startPoint.y, endPoint.y) - 1.5 * options.standardDistance });\n                        break;\n                    case Side.BOTTOM:\n                        if (endPoint.x !== startPoint.x) {\n                            corners.push({ x: startPoint.x, y: (startPoint.y + endPoint.y) / 2 });\n                            corners.push({ x: endPoint.x, y: (startPoint.y + endPoint.y) / 2 });\n                        }\n                        break;\n                }\n                break;\n            case Side.BOTTOM:\n                switch (targetSide) {\n                    case Side.RIGHT:\n                        if ((endPoint.x - startPoint.x) > 0) {\n                            corners.push({ x: startPoint.x, y: startPoint.y + options.standardDistance });\n                            corners.push({ x: endPoint.x + 1.5 * options.standardDistance, y: startPoint.y + options.standardDistance });\n                            corners.push({ x: endPoint.x + 1.5 * options.standardDistance, y: endPoint.y });\n                        } else {\n                            corners.push({ x: startPoint.x, y: endPoint.y });\n                        }\n                        break;\n                    case Side.LEFT:\n                        if ((endPoint.x - startPoint.x) < 0) {\n                            corners.push({ x: startPoint.x, y: startPoint.y + options.standardDistance });\n                            corners.push({ x: endPoint.x - 1.5 * options.standardDistance, y: startPoint.y + options.standardDistance });\n                            corners.push({ x: endPoint.x - 1.5 * options.standardDistance, y: endPoint.y });\n                        } else {\n                            corners.push({ x: startPoint.x, y: endPoint.y });\n                        }\n                        break;\n                    default:\n                        endPoint = targetAnchors.get(Side.TOP);\n                        if (endPoint.x !== startPoint.x) {\n                            corners.push({ x: startPoint.x, y: (startPoint.y + endPoint.y) / 2 });\n                            corners.push({ x: endPoint.x, y: (startPoint.y + endPoint.y) / 2 });\n                        }\n                        break;\n                }\n                break;\n        }\n        return corners;\n    }\n\n    protected getBestConnectionAnchors(edge: SRoutableElementImpl,\n                                        sourceAnchors: DefaultAnchors, targetAnchors: DefaultAnchors,\n                                        options: ManhattanRouterOptions): { source: Side, target: Side } {\n        // distance is enough\n        let sourcePoint = sourceAnchors.get(Side.RIGHT);\n        let targetPoint = targetAnchors.get(Side.LEFT);\n        if ((targetPoint.x - sourcePoint.x) > options.standardDistance)\n            return { source: Side.RIGHT, target: Side.LEFT };\n\n        sourcePoint = sourceAnchors.get(Side.LEFT);\n        targetPoint = targetAnchors.get(Side.RIGHT);\n        if ((sourcePoint.x - targetPoint.x) > options.standardDistance)\n            return { source: Side.LEFT, target: Side.RIGHT };\n\n        sourcePoint = sourceAnchors.get(Side.TOP);\n        targetPoint = targetAnchors.get(Side.BOTTOM);\n        if ((sourcePoint.y - targetPoint.y) > options.standardDistance)\n            return { source: Side.TOP, target: Side.BOTTOM };\n\n        sourcePoint = sourceAnchors.get(Side.BOTTOM);\n        targetPoint = targetAnchors.get(Side.TOP);\n        if ((targetPoint.y - sourcePoint.y) > options.standardDistance)\n            return { source: Side.BOTTOM, target: Side.TOP };\n\n        // One additional point\n        sourcePoint = sourceAnchors.get(Side.RIGHT);\n        targetPoint = targetAnchors.get(Side.TOP);\n        if (((targetPoint.x - sourcePoint.x) > 0.5 * options.standardDistance) && ((targetPoint.y - sourcePoint.y) > options.standardDistance))\n            return { source: Side.RIGHT, target: Side.TOP };\n\n        targetPoint = targetAnchors.get(Side.BOTTOM);\n        if (((targetPoint.x - sourcePoint.x) > 0.5 * options.standardDistance) && ((sourcePoint.y - targetPoint.y) > options.standardDistance))\n            return { source: Side.RIGHT, target: Side.BOTTOM };\n\n        sourcePoint = sourceAnchors.get(Side.LEFT);\n        targetPoint = targetAnchors.get(Side.BOTTOM);\n        if (((sourcePoint.x - targetPoint.x) > 0.5 * options.standardDistance) && ((sourcePoint.y - targetPoint.y) > options.standardDistance))\n            return { source: Side.LEFT, target: Side.BOTTOM };\n\n        targetPoint = targetAnchors.get(Side.TOP);\n        if (((sourcePoint.x - targetPoint.x) > 0.5 * options.standardDistance) && ((targetPoint.y - sourcePoint.y) > options.standardDistance))\n            return { source: Side.LEFT, target: Side.TOP };\n\n        sourcePoint = sourceAnchors.get(Side.TOP);\n        targetPoint = targetAnchors.get(Side.RIGHT);\n        if (((sourcePoint.y - targetPoint.y) > 0.5 * options.standardDistance) && ((sourcePoint.x - targetPoint.x) > options.standardDistance))\n            return { source: Side.TOP, target: Side.RIGHT };\n\n        targetPoint = targetAnchors.get(Side.LEFT);\n        if (((sourcePoint.y - targetPoint.y) > 0.5 * options.standardDistance) && ((targetPoint.x - sourcePoint.x) > options.standardDistance))\n            return { source: Side.TOP, target: Side.LEFT };\n\n        sourcePoint = sourceAnchors.get(Side.BOTTOM);\n        targetPoint = targetAnchors.get(Side.RIGHT);\n        if (((targetPoint.y - sourcePoint.y) > 0.5 * options.standardDistance) && ((sourcePoint.x - targetPoint.x) > options.standardDistance))\n            return { source: Side.BOTTOM, target: Side.RIGHT };\n\n        targetPoint = targetAnchors.get(Side.LEFT);\n        if (((targetPoint.y - sourcePoint.y) > 0.5 * options.standardDistance) && ((targetPoint.x - sourcePoint.x) > options.standardDistance))\n            return { source: Side.BOTTOM, target: Side.LEFT };\n\n        // Two points\n        // priority NN >> EE >> NE >> NW >> SE >> SW\n        sourcePoint = sourceAnchors.get(Side.TOP);\n        targetPoint = targetAnchors.get(Side.TOP);\n        if (!Bounds.includes(targetAnchors.bounds, sourcePoint) && !Bounds.includes(sourceAnchors.bounds, targetPoint)) {\n            if ((sourcePoint.y - targetPoint.y) < 0) {\n                if (Math.abs(sourcePoint.x - targetPoint.x) > ((sourceAnchors.bounds.width + options.standardDistance) / 2))\n                    return { source: Side.TOP, target: Side.TOP };\n            } else {\n                if (Math.abs(sourcePoint.x - targetPoint.x) > (targetAnchors.bounds.width / 2))\n                    return { source: Side.TOP, target: Side.TOP };\n            }\n        }\n\n        sourcePoint = sourceAnchors.get(Side.RIGHT);\n        targetPoint = targetAnchors.get(Side.RIGHT);\n        if (!Bounds.includes(targetAnchors.bounds, sourcePoint) && !Bounds.includes(sourceAnchors.bounds, targetPoint)) {\n            if ((sourcePoint.x - targetPoint.x) > 0) {\n                if (Math.abs(sourcePoint.y - targetPoint.y) > ((sourceAnchors.bounds.height + options.standardDistance) / 2))\n                    return { source: Side.RIGHT, target: Side.RIGHT };\n            } else if (Math.abs(sourcePoint.y - targetPoint.y) > (targetAnchors.bounds.height / 2))\n                return { source: Side.RIGHT, target: Side.RIGHT };\n        }\n\n        // Secondly, judge NE NW is available\n        sourcePoint = sourceAnchors.get(Side.TOP);\n        targetPoint = targetAnchors.get(Side.RIGHT);\n        if (!Bounds.includes(targetAnchors.bounds, sourcePoint) && !Bounds.includes(sourceAnchors.bounds, targetPoint))\n            return { source: Side.TOP, target: Side.RIGHT };\n\n        targetPoint = targetAnchors.get(Side.LEFT);\n        if (!Bounds.includes(targetAnchors.bounds, sourcePoint) && !Bounds.includes(sourceAnchors.bounds, targetPoint))\n            return { source: Side.TOP, target: Side.LEFT };\n\n        // Finally, judge SE SW is available\n        sourcePoint = sourceAnchors.get(Side.BOTTOM);\n        targetPoint = targetAnchors.get(Side.RIGHT);\n        if (!Bounds.includes(targetAnchors.bounds, sourcePoint) && !Bounds.includes(sourceAnchors.bounds, targetPoint))\n            return { source: Side.BOTTOM, target: Side.RIGHT };\n\n        targetPoint = targetAnchors.get(Side.LEFT);\n        if (!Bounds.includes(targetAnchors.bounds, sourcePoint) && !Bounds.includes(sourceAnchors.bounds, targetPoint))\n            return { source: Side.BOTTOM, target: Side.LEFT };\n\n        // Only to return to the\n        return { source: Side.RIGHT, target: Side.BOTTOM };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Bounds, Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { Line, PointToPointLine, intersection } from \"../../utils/geometry\";\nimport { RECTANGULAR_ANCHOR_KIND, IAnchorComputer, DIAMOND_ANCHOR_KIND, ELLIPTIC_ANCHOR_KIND } from \"./anchor\";\nimport { ManhattanEdgeRouter } from \"./manhattan-edge-router\";\nimport { SConnectableElementImpl } from \"./model\";\nimport { injectable } from \"inversify\";\n\n@injectable()\nexport class ManhattanRectangularAnchor implements IAnchorComputer {\n\n    static KIND = ManhattanEdgeRouter.KIND + ':' + RECTANGULAR_ANCHOR_KIND;\n\n    get kind() {\n        return ManhattanRectangularAnchor.KIND;\n    }\n\n    getAnchor(connectable: SConnectableElementImpl, refPoint: Point, offset: number): Point {\n        const b = connectable.bounds;\n        if (b.width <= 0 || b.height <= 0) {\n            return b;\n        }\n        const bounds: Bounds = {\n            x: b.x - offset,\n            y: b.y - offset,\n            width: b.width + 2 * offset,\n            height: b.height + 2 * offset\n        };\n        if (refPoint.x >= bounds.x && bounds.x + bounds.width >= refPoint.x) {\n            if (refPoint.y < bounds.y + 0.5 * bounds.height)\n            return { x: refPoint.x, y: bounds.y };\n            else\n            return { x: refPoint.x, y: bounds.y + bounds.height };\n        }\n        if (refPoint.y >= bounds.y && bounds.y + bounds.height >= refPoint.y) {\n            if (refPoint.x < bounds.x + 0.5 * bounds.width)\n            return { x: bounds.x, y: refPoint.y };\n            else\n            return { x: bounds.x + bounds.width, y: refPoint.y };\n        }\n        return Bounds.center(bounds);\n    }\n}\n\n@injectable()\nexport class ManhattanDiamondAnchor implements IAnchorComputer {\n\n    static KIND = ManhattanEdgeRouter.KIND + ':' + DIAMOND_ANCHOR_KIND;\n\n    get kind() {\n        return ManhattanDiamondAnchor.KIND;\n    }\n\n    getAnchor(connectable: SConnectableElementImpl, refPoint: Point, offset: number = 0): Point {\n        const b = connectable.bounds;\n        if (b.width <= 0 || b.height <= 0) {\n            return b;\n        }\n        const bounds = {\n            x: b.x - offset,\n            y: b.y - offset,\n            width: b.width + 2 * offset,\n            height: b.height + 2 * offset\n        };\n        const c = Bounds.center(bounds);\n\n        let outline: Line | undefined = undefined;\n        let refLine: Line | undefined = undefined;\n        if (refPoint.x >= bounds.x && refPoint.x <= bounds.x + bounds.width) {\n            if (bounds.x + 0.5 * bounds.width >= refPoint.x) {\n                refLine = new PointToPointLine(refPoint, { x: refPoint.x, y: c.y });\n                if (refPoint.y < c.y)\n                    outline = new PointToPointLine({ x: bounds.x, y: c.y }, { x: c.x, y: bounds.y });\n                else\n                    outline = new PointToPointLine({ x: bounds.x, y: c.y }, { x: c.x, y: bounds.y + bounds.height });\n            } else {\n                refLine = new PointToPointLine(refPoint, { x: refPoint.x, y: c.y });\n                if (refPoint.y < c.y)\n                    outline = new PointToPointLine({ x: bounds.x + bounds.width, y: c.y }, { x: c.x, y: bounds.y });\n                else\n                    outline = new PointToPointLine({ x: bounds.x + bounds.width, y: c.y }, { x: c.x, y: bounds.y + bounds.height });\n            }\n        } else if (refPoint.y >= bounds.y && refPoint.y <= bounds.y + bounds.height) {\n            if (bounds.y + 0.5 * bounds.height >= refPoint.y) {\n                refLine = new PointToPointLine(refPoint, { x: c.x , y: refPoint.y });\n                if (refPoint.x < c.x)\n                    outline = new PointToPointLine({ x: bounds.x, y: c.y }, { x: c.x, y: bounds.y });\n                else\n                    outline = new PointToPointLine({ x: bounds.x + bounds.width, y: c.y }, { x: c.x, y: bounds.y });\n            } else {\n                refLine = new PointToPointLine(refPoint, { x: c.x , y: refPoint.y });\n                if (refPoint.x < c.x)\n                    outline = new PointToPointLine({ x: bounds.x, y: c.y }, { x: c.x, y: bounds.y + bounds.height });\n                else\n                    outline = new PointToPointLine({ x: bounds.x + bounds.width, y: c.y }, { x: c.x, y: bounds.y + bounds.height });\n            }\n        }\n        if (!!refLine && !!outline)\n            return intersection(outline, refLine);\n        else\n            return c;\n    }\n}\n\n@injectable()\nexport class ManhattanEllipticAnchor implements IAnchorComputer {\n\n    static KIND = ManhattanEdgeRouter.KIND + ':' + ELLIPTIC_ANCHOR_KIND;\n\n    get kind() {\n        return ManhattanEllipticAnchor.KIND;\n    }\n\n    getAnchor(connectable: SConnectableElementImpl, refPoint: Point, offset: number = 0): Point {\n        const b = connectable.bounds;\n        if (b.width <= 0 || b.height <= 0) {\n            return b;\n        }\n        const bounds = {\n            x: b.x - offset,\n            y: b.y - offset,\n            width: b.width + 2 * offset,\n            height: b.height + 2 * offset\n        };\n        const c = Bounds.center(bounds);\n        const refRelative = Point.subtract(refPoint, c);\n        let x = c.x;\n        let y = c.y;\n        if (refPoint.x >= bounds.x && bounds.x + bounds.width >= refPoint.x) {\n            x += refRelative.x;\n            const dy = 0.5 * bounds.height * Math.sqrt(1 - (refRelative.x * refRelative.x) / (0.25 * bounds.width * bounds.width));\n            if (refRelative.y < 0)\n                y -= dy;\n            else\n                y += dy;\n        } else if (refPoint.y >= bounds.y && bounds.y + bounds.height >= refPoint.y) {\n            y += refRelative.y;\n            const dx = 0.5 * bounds.width * Math.sqrt(1 - (refRelative.y * refRelative.y) / (0.25 * bounds.height * bounds.height));\n            if (refRelative.x < 0)\n                x -= dx;\n            else\n                x += dx;\n        }\n        return { x, y };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { IViewArgs, IView, RenderingContext } from '../../base/views/view';\nimport { SRoutableElementImpl, getAbsoluteRouteBounds } from './model';\n\n@injectable()\nexport abstract class RoutableView implements IView {\n    /**\n     * Check whether the given model element is in the current viewport. Use this method\n     * in your `render` implementation to skip rendering in case the element is not visible.\n     * This can greatly enhance performance for large models.\n     */\n    isVisible(model: Readonly<SRoutableElementImpl>, route: Point[], context: RenderingContext): boolean {\n        if (context.targetKind === 'hidden') {\n            // Don't hide any element for hidden rendering\n            return true;\n        }\n        if (route.length === 0) {\n            // We should hide only if we know the element's route\n            return true;\n        }\n        const ab = getAbsoluteRouteBounds(model, route);\n        const canvasBounds = model.root.canvasBounds;\n        return ab.x <= canvasBounds.width\n            && ab.x + ab.width >= 0\n            && ab.y <= canvasBounds.height\n            && ab.y + ab.height >= 0;\n    }\n\n    abstract render(model: Readonly<SRoutableElementImpl>, context: RenderingContext, args?: IViewArgs): VNode | undefined;\n}\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from \"inversify\";\nimport { ResponseAction } from \"sprotty-protocol/lib/actions\";\nimport { TYPES } from \"../types\";\nimport { SystemCommand, CommandExecutionContext, CommandReturn } from \"./command\";\nimport { IActionDispatcher } from \"../actions/action-dispatcher\";\n\n/**\n * A command that does not modify the internal model, but retrieves information\n * from it by dispatching a response action.\n */\n@injectable()\nexport abstract class ModelRequestCommand extends SystemCommand {\n\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: IActionDispatcher;\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const result = this.retrieveResult(context);\n        this.actionDispatcher.dispatch(result);\n        return { model: context.root, modelChanged: false };\n    }\n\n    protected abstract retrieveResult(context: CommandExecutionContext): ResponseAction;\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        return { model: context.root, modelChanged: false };\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        return { model: context.root, modelChanged: false };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject } from 'inversify';\nimport { Viewport } from 'sprotty-protocol/lib/model';\nimport { Action, CenterAction, SetViewportAction } from 'sprotty-protocol/lib/actions';\nimport { almostEquals, Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SModelElementImpl, SModelRootImpl } from '../../base/model/smodel';\nimport { MouseListener } from '../../base/views/mouse-tool';\nimport { findParentByFeature } from '../../base/model/smodel-utils';\nimport { isViewport } from './model';\nimport { isMoveable } from '../move/model';\nimport { SRoutingHandleImpl } from '../routing/model';\nimport { getModelBounds } from '../projection/model';\nimport { hitsMouseEvent } from '../../utils/browser';\nimport { TYPES } from '../../base/types';\nimport { ViewerOptions } from '../../base/views/viewer-options';\n\nexport class ScrollMouseListener extends MouseListener {\n\n    @inject(TYPES.ViewerOptions) protected viewerOptions: ViewerOptions;\n\n    protected lastScrollPosition: Point |undefined;\n    protected scrollbar: HTMLElement | undefined;\n    protected scrollbarMouseDownTimeout: number | undefined;\n    protected scrollbarMouseDownDelay = 200;\n\n    override mouseDown(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        const moveable = findParentByFeature(target, isMoveable);\n        if (moveable === undefined && !(target instanceof SRoutingHandleImpl)) {\n            const viewport = findParentByFeature(target, isViewport);\n            if (viewport) {\n                this.lastScrollPosition = { x: event.pageX, y: event.pageY };\n                this.scrollbar = this.getScrollbar(event);\n                if (this.scrollbar) {\n                    window.clearTimeout(this.scrollbarMouseDownTimeout);\n                    return this.moveScrollBar(viewport, event, this.scrollbar, true)\n                        .map(action => new Promise(resolve => {\n                            this.scrollbarMouseDownTimeout = window.setTimeout(() => resolve(action), this.scrollbarMouseDownDelay);\n                        }));\n                }\n            } else {\n                this.lastScrollPosition = undefined;\n                this.scrollbar = undefined;\n            }\n        }\n        return [];\n    }\n\n    override mouseMove(target: SModelElementImpl, event: MouseEvent): Action[] {\n        if (event.buttons === 0) {\n            return this.mouseUp(target, event);\n        }\n        if (this.scrollbar) {\n            window.clearTimeout(this.scrollbarMouseDownTimeout);\n            const viewport = findParentByFeature(target, isViewport);\n            if (viewport) {\n                return this.moveScrollBar(viewport, event, this.scrollbar);\n            }\n        }\n        if (this.lastScrollPosition) {\n            const viewport = findParentByFeature(target, isViewport);\n            if (viewport) {\n                return this.dragCanvas(viewport, event, this.lastScrollPosition);\n            }\n        }\n        return [];\n    }\n\n    override mouseEnter(target: SModelElementImpl, event: MouseEvent): Action[] {\n        if (target instanceof SModelRootImpl && event.buttons === 0) {\n            this.mouseUp(target, event);\n        }\n        return [];\n    }\n\n    override mouseUp(target: SModelElementImpl, event: MouseEvent): Action[] {\n        this.lastScrollPosition = undefined;\n        this.scrollbar = undefined;\n        return [];\n    }\n\n    override doubleClick(target: SModelElementImpl, event: MouseEvent): Action[] {\n        const viewport = findParentByFeature(target, isViewport);\n        if (viewport) {\n            const scrollbar = this.getScrollbar(event);\n            if (scrollbar) {\n                window.clearTimeout(this.scrollbarMouseDownTimeout);\n                const targetElement = this.findClickTarget(scrollbar, event);\n                let elementId: string | undefined;\n                if (targetElement && targetElement.id.startsWith('horizontal-projection:')) {\n                    elementId = targetElement.id.substring('horizontal-projection:'.length);\n                } else if (targetElement && targetElement.id.startsWith('vertical-projection:')) {\n                    elementId = targetElement.id.substring('vertical-projection:'.length);\n                }\n                if (elementId) {\n                    return [CenterAction.create([elementId], { animate: true, retainZoom: true })];\n                }\n            }\n        }\n        return [];\n    }\n\n    protected dragCanvas(model: SModelRootImpl & Viewport, event: MouseEvent, lastScrollPosition: Point): Action[] {\n        let dx = (event.pageX - lastScrollPosition.x) / model.zoom;\n        if (dx > 0 && almostEquals(model.scroll.x, this.viewerOptions.horizontalScrollLimits.min)\n            || dx < 0 && almostEquals(model.scroll.x, this.viewerOptions.horizontalScrollLimits.max - model.canvasBounds.width / model.zoom)) {\n            dx = 0;\n        }\n        let dy = (event.pageY - lastScrollPosition.y) / model.zoom;\n        if (dy > 0 && almostEquals(model.scroll.y, this.viewerOptions.verticalScrollLimits.min)\n            || dy < 0 && almostEquals(model.scroll.y, this.viewerOptions.verticalScrollLimits.max - model.canvasBounds.height / model.zoom)) {\n            dy = 0;\n        }\n        if (dx === 0 && dy === 0) {\n            return [];\n        }\n        const newViewport: Viewport = {\n            scroll: {\n                x: model.scroll.x - dx,\n                y: model.scroll.y - dy,\n            },\n            zoom: model.zoom\n        };\n        this.lastScrollPosition = { x: event.pageX, y: event.pageY };\n        return [SetViewportAction.create(model.id, newViewport, { animate: false })];\n    }\n\n    protected moveScrollBar(model: SModelRootImpl & Viewport, event: MouseEvent, scrollbar: HTMLElement, animate: boolean = false): Action[] {\n        const modelBounds = getModelBounds(model);\n        if (!modelBounds || model.zoom <= 0) {\n            return [];\n        }\n        const scrollbarRect = scrollbar.getBoundingClientRect();\n        let newScroll: { x: number, y: number };\n        if (this.getScrollbarOrientation(scrollbar) === 'horizontal') {\n            if (scrollbarRect.width <= 0) {\n                return [];\n            }\n            const viewportSize = (model.canvasBounds.width / (model.zoom * modelBounds.width)) * scrollbarRect.width;\n            let position = event.clientX - scrollbarRect.x - viewportSize / 2;\n            if (position < 0) {\n                position = 0;\n            } else if (position > scrollbarRect.width - viewportSize) {\n                position = scrollbarRect.width - viewportSize;\n            }\n            newScroll = {\n                x: modelBounds.x + (position / scrollbarRect.width) * modelBounds.width,\n                y: model.scroll.y\n            };\n            if (newScroll.x < this.viewerOptions.horizontalScrollLimits.min) {\n                newScroll.x = this.viewerOptions.horizontalScrollLimits.min;\n            } else if (newScroll.x > this.viewerOptions.horizontalScrollLimits.max - model.canvasBounds.width / model.zoom) {\n                newScroll.x = this.viewerOptions.horizontalScrollLimits.max - model.canvasBounds.width / model.zoom;\n            }\n            if (almostEquals(newScroll.x, model.scroll.x)) {\n                return [];\n            }\n        } else {\n            if (scrollbarRect.height <= 0) {\n                return [];\n            }\n            const viewportSize = (model.canvasBounds.height / (model.zoom * modelBounds.height)) * scrollbarRect.height;\n            let position = event.clientY - scrollbarRect.y - viewportSize / 2;\n            if (position < 0) {\n                position = 0;\n            } else if (position > scrollbarRect.height - viewportSize) {\n                position = scrollbarRect.height - viewportSize;\n            }\n            newScroll = {\n                x: model.scroll.x,\n                y: modelBounds.y + (position / scrollbarRect.height) * modelBounds.height\n            };\n            if (newScroll.y < this.viewerOptions.verticalScrollLimits.min) {\n                newScroll.y = this.viewerOptions.verticalScrollLimits.min;\n            } else if (newScroll.y > this.viewerOptions.verticalScrollLimits.max - model.canvasBounds.height / model.zoom) {\n                newScroll.y = this.viewerOptions.verticalScrollLimits.max - model.canvasBounds.height / model.zoom;\n            }\n            if (almostEquals(newScroll.y, model.scroll.y)) {\n                return [];\n            }\n        }\n        return [SetViewportAction.create(model.id, { scroll: newScroll, zoom: model.zoom }, { animate })];\n    }\n\n    protected getScrollbar(event: MouseEvent): HTMLElement | undefined {\n        return findViewportScrollbar(event);\n    }\n\n    protected getScrollbarOrientation(scrollbar: HTMLElement): 'horizontal' | 'vertical' {\n        if (scrollbar.classList.contains('horizontal')) {\n            return 'horizontal';\n        } else {\n            return 'vertical';\n        }\n    }\n\n    protected findClickTarget(scrollbar: HTMLElement, event: MouseEvent): HTMLElement | undefined {\n        const matching = Array.from(scrollbar.children).filter(child =>\n            child.id && child.classList.contains('sprotty-projection') && hitsMouseEvent(child, event)\n        ) as HTMLElement[];\n        if (matching.length > 0) {\n            return matching[matching.length - 1];\n        }\n        return undefined;\n    }\n\n}\n\nexport function findViewportScrollbar(event: MouseEvent): HTMLElement | undefined {\n    let element = event.target as HTMLElement | null;\n    while (element) {\n        if (element.classList && element.classList.contains('sprotty-projection-bar')) {\n            return element;\n        }\n        element = element.parentElement;\n    }\n    return undefined;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, optional } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { Action, BringToFrontAction, GetSelectionAction, ResponseAction, SelectAction, SelectAllAction, SelectionResult } from 'sprotty-protocol/lib/actions';\nimport { Command, CommandExecutionContext } from '../../base/commands/command';\nimport { ModelRequestCommand } from '../../base/commands/request-command';\nimport { SChildElementImpl, SModelElementImpl, SModelRootImpl, SParentElementImpl } from '../../base/model/smodel';\nimport { findParentByFeature } from '../../base/model/smodel-utils';\nimport { TYPES } from '../../base/types';\nimport { KeyListener } from '../../base/views/key-tool';\nimport { MouseListener } from '../../base/views/mouse-tool';\nimport { setClass } from '../../base/views/vnode-utils';\nimport { isCtrlOrCmd } from '../../utils/browser';\nimport { toArray } from '../../utils/iterable';\nimport { matchesKeystroke } from '../../utils/keyboard';\nimport { ButtonHandlerRegistry } from '../button/button-handler';\nimport { SButtonImpl } from '../button/model';\nimport { SwitchEditModeAction } from '../edit/edit-routing';\nimport { SRoutingHandleImpl } from '../routing/model';\nimport { SRoutableElementImpl } from '../routing/model';\nimport { findViewportScrollbar } from '../viewport/scroll';\nimport { isSelectable, Selectable } from './model';\n\n@injectable()\nexport class SelectCommand extends Command {\n    static readonly KIND = SelectAction.KIND;\n\n    protected selected: (SChildElementImpl & Selectable)[] = [];\n    protected deselected: (SChildElementImpl & Selectable)[] = [];\n\n    constructor(@inject(TYPES.Action) public action: SelectAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): SModelRootImpl {\n        const model = context.root;\n        this.action.selectedElementsIDs.forEach(id => {\n            const element = model.index.getById(id);\n            if (element instanceof SChildElementImpl && isSelectable(element)) {\n                this.selected.push(element);\n            }\n        });\n        this.action.deselectedElementsIDs.forEach(id => {\n            const element = model.index.getById(id);\n            if (element instanceof SChildElementImpl && isSelectable(element)) {\n                this.deselected.push(element);\n            }\n        });\n        return this.redo(context);\n    }\n\n    undo(context: CommandExecutionContext): SModelRootImpl {\n        for (const element of this.selected) {\n            element.selected = false;\n        }\n        for (const element of this.deselected) {\n            element.selected = true;\n        }\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): SModelRootImpl {\n        for (const element of this.deselected) {\n            element.selected = false;\n        }\n        for (const element of this.selected) {\n            element.selected = true;\n        }\n        return context.root;\n    }\n}\n\n@injectable()\nexport class SelectAllCommand extends Command {\n    static readonly KIND = SelectAllAction.KIND;\n\n    protected previousSelection: Record<string, boolean> = {};\n\n    constructor(@inject(TYPES.Action) protected readonly action: SelectAllAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): SModelRootImpl {\n        this.selectAll(context.root, this.action.select);\n        return context.root;\n    }\n\n    protected selectAll(element: SParentElementImpl, newState: boolean): void {\n        if (isSelectable(element)) {\n            this.previousSelection[element.id] = element.selected;\n            element.selected = newState;\n        }\n        for (const child of element.children) {\n            this.selectAll(child, newState);\n        }\n    }\n\n    undo(context: CommandExecutionContext): SModelRootImpl {\n        const index = context.root.index;\n        Object.keys(this.previousSelection).forEach(id => {\n            const element = index.getById(id);\n            if (element !== undefined && isSelectable(element))\n                element.selected = this.previousSelection[id];\n        });\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): SModelRootImpl {\n        this.selectAll(context.root, this.action.select);\n        return context.root;\n    }\n}\n\nexport class SelectMouseListener extends MouseListener {\n\n    @inject(ButtonHandlerRegistry) @optional() protected buttonHandlerRegistry: ButtonHandlerRegistry;\n\n    wasSelected = false;\n    hasDragged = false;\n\n    override mouseDown(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        if (event.button !== 0) {\n            return [];\n        }\n        const buttonHandled = this.handleButton(target, event);\n        if (buttonHandled) {\n            return buttonHandled;\n        }\n        const selectableTarget = findParentByFeature(target, isSelectable);\n        if (selectableTarget !== undefined || target instanceof SModelRootImpl) {\n            this.hasDragged = false;\n        }\n        if (selectableTarget !== undefined) {\n            let deselectedElements: SModelElementImpl[] = [];\n            // multi-selection?\n            if (!isCtrlOrCmd(event)) {\n                deselectedElements = this.collectElementsToDeselect(target, selectableTarget);\n            }\n            if (selectableTarget !== undefined) {\n                if (!selectableTarget.selected) {\n                    this.wasSelected = false;\n                    return this.handleSelectTarget(selectableTarget, deselectedElements, event);\n                } else if (isCtrlOrCmd(event)) {\n                    this.wasSelected = false;\n                    return this.handleDeselectTarget(selectableTarget, event);\n                } else {\n                    this.wasSelected = true;\n                }\n            } else {\n                return this.handleDeselectAll(deselectedElements, event);\n            }\n        }\n        return [];\n    }\n\n    protected collectElementsToDeselect(target: SModelElementImpl, selectableTarget: (SModelElementImpl & Selectable) | undefined): SModelElementImpl[] {\n        return toArray(target.root.index.all()\n        .filter(element => isSelectable(element) && element.selected\n            && !(selectableTarget instanceof SRoutingHandleImpl && element === selectableTarget.parent as SModelElementImpl)));\n    }\n\n    protected handleButton(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] | undefined {\n        if (this.buttonHandlerRegistry !== undefined && target instanceof SButtonImpl && target.enabled) {\n            const buttonHandler = this.buttonHandlerRegistry.get(target.type);\n            if (buttonHandler !== undefined) {\n                return buttonHandler.buttonPressed(target);\n            }\n        }\n        return undefined;\n    }\n\n    protected handleSelectTarget(selectableTarget: SModelElementImpl & Selectable, deselectedElements: SModelElementImpl[], event: MouseEvent): (Action | Promise<Action>)[] {\n        const result: Action[] = [];\n        result.push(SelectAction.create({ selectedElementsIDs: [selectableTarget.id], deselectedElementsIDs: deselectedElements.map(e => e.id) }));\n        result.push(BringToFrontAction.create([selectableTarget.id]));\n        const routableDeselect = deselectedElements.filter(e => e instanceof SRoutableElementImpl).map(e => e.id);\n        if (selectableTarget instanceof SRoutableElementImpl) {\n            result.push(SwitchEditModeAction.create({ elementsToActivate: [selectableTarget.id], elementsToDeactivate: routableDeselect }));\n        } else if (routableDeselect.length > 0) {\n            result.push(SwitchEditModeAction.create({ elementsToDeactivate: routableDeselect }));\n        }\n        return result;\n    }\n\n    protected handleDeselectTarget(selectableTarget: SModelElementImpl & Selectable, event: MouseEvent): (Action | Promise<Action>)[] {\n        const result: Action[] = [];\n        result.push(SelectAction.create({ selectedElementsIDs: [], deselectedElementsIDs: [selectableTarget.id] }));\n        if (selectableTarget instanceof SRoutableElementImpl) {\n            result.push(SwitchEditModeAction.create({ elementsToDeactivate: [selectableTarget.id] }));\n        }\n        return result;\n    }\n\n    protected handleDeselectAll(deselectedElements: SModelElementImpl[], event: MouseEvent): (Action | Promise<Action>)[] {\n        const result: Action[] = [];\n        result.push(SelectAction.create({ selectedElementsIDs: [], deselectedElementsIDs: deselectedElements.map(e => e.id) }));\n        const routableDeselect = deselectedElements.filter(e => e instanceof SRoutableElementImpl).map(e => e.id);\n        if (routableDeselect.length > 0) {\n            result.push(SwitchEditModeAction.create({ elementsToDeactivate: routableDeselect }));\n        }\n        return result;\n    }\n\n    override mouseMove(target: SModelElementImpl, event: MouseEvent): Action[] {\n        this.hasDragged = true;\n        return [];\n    }\n\n    override mouseUp(target: SModelElementImpl, event: MouseEvent): (Action | Promise<Action>)[] {\n        if (event.button === 0) {\n            if (!this.hasDragged) {\n                const selectableTarget = findParentByFeature(target, isSelectable);\n                if (selectableTarget !== undefined) {\n                    if (this.wasSelected) {\n                        return [SelectAction.create({selectedElementsIDs:[selectableTarget.id],deselectedElementsIDs:[]})];\n                    }\n                } else if (target instanceof SModelRootImpl && !findViewportScrollbar(event)) {\n                    // Mouse up on root but not over ViewPort's scroll bars > deselect all\n                    return this.handleDeselectAll(this.collectElementsToDeselect(target, undefined), event);\n                }\n            }\n        }\n        this.hasDragged = false;\n        return [];\n    }\n\n    override decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        const selectableTarget = findParentByFeature(element, isSelectable);\n        if (selectableTarget !== undefined) {\n            setClass(vnode, 'selected', selectableTarget.selected);\n        }\n        return vnode;\n    }\n}\n\n@injectable()\nexport class GetSelectionCommand extends ModelRequestCommand {\n    static readonly KIND = GetSelectionAction.KIND;\n\n    protected previousSelection: Record<string, boolean> = {};\n\n    constructor(@inject(TYPES.Action) protected readonly action: GetSelectionAction) {\n        super();\n    }\n\n    protected retrieveResult(context: CommandExecutionContext): ResponseAction {\n        const selection = context.root.index.all()\n            .filter(e => isSelectable(e) && e.selected)\n            .map(e => e.id);\n        return SelectionResult.create(toArray(selection), this.action.requestId);\n    }\n\n}\n\nexport class SelectKeyboardListener extends KeyListener {\n    override keyDown(element: SModelElementImpl, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'KeyA', 'ctrlCmd')) {\n            return [ SelectAllAction.create()];\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Action, UndoAction, RedoAction } from 'sprotty-protocol/lib/actions';\nimport { matchesKeystroke } from '../../utils/keyboard';\nimport { KeyListener } from '../../base/views/key-tool';\nimport { SModelElementImpl } from '../../base/model/smodel';\nimport { isMac } from '../../utils/browser';\n\nexport class UndoRedoKeyListener extends KeyListener {\n    override keyDown(element: SModelElementImpl, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'KeyZ', 'ctrlCmd'))\n            return [UndoAction.create()];\n        if (matchesKeystroke(event, 'KeyZ', 'ctrlCmd', 'shift') || (!isMac() && matchesKeystroke(event, 'KeyY', 'ctrlCmd')))\n            return [RedoAction.create()];\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElement, SModelRoot } from 'sprotty-protocol/lib/model';\nimport { SModelRootImpl, SModelElementImpl, isParent, IModelIndex } from '../../base/model/smodel';\nimport { SModelIndex } from 'sprotty-protocol';\n\nexport interface Match {\n    left?: SModelElement\n    right?: SModelElement\n    leftParentId?: string\n    rightParentId?: string\n}\n\nexport interface MatchResult {\n    [id: string]: Match\n}\n\nexport function forEachMatch(matchResult: MatchResult, callback: (id: string, match: Match) => void): void {\n    Object.keys(matchResult).forEach(id => callback(id, matchResult[id]));\n}\n\nexport class ModelMatcher {\n    match(left: SModelRoot | SModelRootImpl, right: SModelRoot | SModelRootImpl): MatchResult {\n        const result: MatchResult = {};\n        this.matchLeft(left, result);\n        this.matchRight(right, result);\n        return result;\n    }\n\n    protected matchLeft(element: SModelElement | SModelElementImpl, result: MatchResult, parentId?: string): void {\n        let match = result[element.id];\n        if (match !== undefined) {\n            match.left = element;\n            match.leftParentId = parentId;\n        } else {\n            match = {\n                left: element,\n                leftParentId: parentId\n            };\n            result[element.id] = match;\n        }\n        if (isParent(element)) {\n            for (const child of element.children) {\n                this.matchLeft(child, result, element.id);\n            }\n        }\n    }\n\n    protected matchRight(element: SModelElement | SModelElementImpl, result: MatchResult, parentId?: string) {\n        let match = result[element.id];\n        if (match !== undefined) {\n            match.right = element;\n            match.rightParentId = parentId;\n        } else {\n            match = {\n                right: element,\n                rightParentId: parentId\n            };\n            result[element.id] = match;\n        }\n        if (isParent(element)) {\n            for (const child of element.children) {\n                this.matchRight(child, result, element.id);\n            }\n        }\n    }\n}\n\nexport function applyMatches(root: SModelRoot, matches: Match[], index?: IModelIndex): void {\n    if (root instanceof SModelRootImpl) {\n        index = root.index;\n    } else if (index === undefined) {\n        index = new SModelIndex();\n        index.add(root);\n    }\n    for (const match of matches) {\n        let newElementInserted = false;\n        if (match.left !== undefined && match.leftParentId !== undefined) {\n            const parent = index.getById(match.leftParentId);\n            if (parent !== undefined && parent.children !== undefined) {\n                const i = parent.children.indexOf(match.left);\n                if (i >= 0) {\n                    if (match.right !== undefined && match.leftParentId === match.rightParentId) {\n                        parent.children.splice(i, 1, match.right);\n                        newElementInserted = true;\n                    } else {\n                        parent.children.splice(i, 1);\n                    }\n                }\n                index.remove(match.left);\n            }\n        }\n        if (!newElementInserted && match.right !== undefined && match.rightParentId !== undefined) {\n            const parent = index.getById(match.rightParentId);\n            if (parent !== undefined) {\n                if (parent.children === undefined)\n                    parent.children = [];\n                parent.children.push(match.right);\n            }\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Dimension } from \"sprotty-protocol/lib/utils/geometry\";\nimport { Animation } from \"../../base/animations/animation\";\nimport { SModelRootImpl, SModelElementImpl } from \"../../base/model/smodel\";\nimport { CommandExecutionContext } from \"../../base/commands/command\";\nimport { BoundsAware } from './model';\n\nexport interface ResolvedElementResize {\n    element: SModelElementImpl & BoundsAware\n    fromDimension: Dimension\n    toDimension: Dimension\n}\n\nexport class ResizeAnimation extends Animation {\n    constructor(protected model: SModelRootImpl,\n        public elementResizes: Map<string, ResolvedElementResize>,\n        context: CommandExecutionContext,\n        protected reverse: boolean = false) {\n        super(context);\n    }\n\n    tween(t: number) {\n        this.elementResizes.forEach(\n            (elementResize) => {\n                const element = elementResize.element;\n                const newDimension: Dimension = (this.reverse) ? {\n                        width: (1 - t) * elementResize.toDimension.width + t * elementResize.fromDimension.width,\n                        height: (1 - t) * elementResize.toDimension.height + t * elementResize.fromDimension.height\n                    } : {\n                        width: (1 - t) * elementResize.fromDimension.width + t * elementResize.toDimension.width,\n                        height: (1 - t) * elementResize.fromDimension.height + t * elementResize.toDimension.height\n                    };\n                element.bounds = {\n                    x: element.bounds.x,\n                    y: element.bounds.y,\n                    width: newDimension.width,\n                    height: newDimension.height\n                };\n            }\n        );\n        return this.model;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2022 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject, optional } from 'inversify';\nimport { UpdateModelAction } from 'sprotty-protocol/lib/actions';\nimport { almostEquals, Dimension } from 'sprotty-protocol/lib/utils/geometry';\nimport { Animation, CompoundAnimation } from '../../base/animations/animation';\nimport { CommandExecutionContext, CommandReturn, Command } from '../../base/commands/command';\nimport { FadeAnimation, ResolvedElementFade } from '../fade/fade';\nimport { SModelRootImpl, SChildElementImpl, SModelElementImpl, SParentElementImpl } from '../../base/model/smodel';\nimport { MoveAnimation, ResolvedElementMove, MorphEdgesAnimation } from '../move/move';\nimport { Fadeable, isFadeable } from '../fade/model';\nimport { isLocateable } from '../move/model';\nimport { isSizeable } from '../bounds/model';\nimport { ViewportRootElementImpl } from '../viewport/viewport-root';\nimport { isSelectable } from '../select/model';\nimport { MatchResult, ModelMatcher, Match, forEachMatch } from './model-matching';\nimport { ResolvedElementResize, ResizeAnimation } from '../bounds/resize';\nimport { TYPES } from '../../base/types';\nimport { isViewport } from '../viewport/model';\nimport { EdgeRouterRegistry, EdgeSnapshot, EdgeMemento } from '../routing/routing';\nimport { SRoutableElementImpl } from '../routing/model';\nimport { containsSome } from '../../base/model/smodel-utils';\n\n\nexport interface UpdateAnimationData {\n    fades: ResolvedElementFade[]\n    moves?: ResolvedElementMove[]\n    resizes?: ResolvedElementResize[]\n    edgeMementi?: EdgeMemento[]\n}\n\n@injectable()\nexport class UpdateModelCommand extends Command {\n    static readonly KIND = UpdateModelAction.KIND;\n\n    oldRoot: SModelRootImpl;\n    newRoot: SModelRootImpl;\n\n    @inject(EdgeRouterRegistry) @optional() edgeRouterRegistry?: EdgeRouterRegistry;\n\n    constructor(@inject(TYPES.Action) protected readonly action: UpdateModelAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        let newRoot: SModelRootImpl;\n        if (this.action.newRoot !== undefined) {\n            newRoot = context.modelFactory.createRoot(this.action.newRoot);\n        } else {\n            newRoot = context.modelFactory.createRoot(context.root);\n            if (this.action.matches !== undefined)\n                this.applyMatches(newRoot, this.action.matches, context);\n        }\n        this.oldRoot = context.root;\n        this.newRoot = newRoot;\n        return this.performUpdate(this.oldRoot, this.newRoot, context);\n    }\n\n    protected performUpdate(oldRoot: SModelRootImpl, newRoot: SModelRootImpl, context: CommandExecutionContext): CommandReturn {\n        if ((this.action.animate === undefined || this.action.animate) && oldRoot.id === newRoot.id) {\n            let matchResult: MatchResult;\n            if (this.action.matches === undefined) {\n                const matcher = new ModelMatcher();\n                matchResult = matcher.match(oldRoot, newRoot);\n            } else {\n                matchResult = this.convertToMatchResult(this.action.matches, oldRoot, newRoot);\n            }\n            const animationOrRoot = this.computeAnimation(newRoot, matchResult, context);\n            if (animationOrRoot instanceof Animation)\n                return animationOrRoot.start();\n            else\n                return animationOrRoot;\n        } else {\n            if (oldRoot.type === newRoot.type && Dimension.isValid(oldRoot.canvasBounds))\n                newRoot.canvasBounds = oldRoot.canvasBounds;\n            if (isViewport(oldRoot) && isViewport(newRoot)) {\n                newRoot.zoom = oldRoot.zoom;\n                newRoot.scroll = oldRoot.scroll;\n            }\n            return newRoot;\n        }\n    }\n\n    protected applyMatches(root: SModelRootImpl, matches: Match[], context: CommandExecutionContext): void {\n        const index = root.index;\n        for (const match of matches) {\n            if (match.left !== undefined) {\n                const element = index.getById(match.left.id);\n                if (element instanceof SChildElementImpl)\n                    element.parent.remove(element);\n            }\n        }\n        for (const match of matches) {\n            if (match.right !== undefined) {\n                const element = context.modelFactory.createElement(match.right);\n                let parent: SModelElementImpl | undefined;\n                if (match.rightParentId !== undefined)\n                    parent = index.getById(match.rightParentId);\n                if (parent instanceof SParentElementImpl)\n                    parent.add(element);\n                else\n                    root.add(element);\n            }\n        }\n    }\n\n    protected convertToMatchResult(matches: Match[], leftRoot: SModelRootImpl, rightRoot: SModelRootImpl): MatchResult {\n        const result: MatchResult = {};\n        for (const match of matches) {\n            const converted: Match = {};\n            let id: string | undefined = undefined;\n            if (match.left !== undefined) {\n                id = match.left.id;\n                converted.left = leftRoot.index.getById(id);\n                converted.leftParentId = match.leftParentId;\n            }\n            if (match.right !== undefined) {\n                id = match.right.id;\n                converted.right = rightRoot.index.getById(id);\n                converted.rightParentId = match.rightParentId;\n            }\n            if (id !== undefined)\n                result[id] = converted;\n        }\n        return result;\n    }\n\n    protected computeAnimation(newRoot: SModelRootImpl, matchResult: MatchResult, context: CommandExecutionContext): SModelRootImpl | Animation {\n        const animationData: UpdateAnimationData = {\n            fades: [] as ResolvedElementFade[]\n        };\n        forEachMatch(matchResult, (id, match) => {\n            if (match.left !== undefined && match.right !== undefined) {\n                // The element is still there, but may have been moved\n                this.updateElement(match.left as SModelElementImpl, match.right as SModelElementImpl, animationData);\n            } else if (match.right !== undefined) {\n                // An element has been added\n                const right = match.right as SModelElementImpl;\n                if (isFadeable(right)) {\n                    right.opacity = 0;\n                    animationData.fades.push({\n                        element: right,\n                        type: 'in'\n                    });\n                }\n            } else if (match.left instanceof SChildElementImpl) {\n                // An element has been removed\n                const left = match.left;\n                if (isFadeable(left) && match.leftParentId !== undefined) {\n                    if (!containsSome(newRoot, left)) {\n                        const parent = newRoot.index.getById(match.leftParentId);\n                        if (parent instanceof SParentElementImpl) {\n                            const leftCopy = context.modelFactory.createElement(left) as SChildElementImpl & Fadeable;\n                            parent.add(leftCopy);\n                            animationData.fades.push({\n                                element: leftCopy,\n                                type: 'out'\n                            });\n                        }\n                    }\n                }\n            }\n        });\n\n        const animations = this.createAnimations(animationData, newRoot, context);\n        if (animations.length >= 2) {\n            return new CompoundAnimation(newRoot, context, animations);\n        } else if (animations.length === 1) {\n            return animations[0];\n        } else {\n            return newRoot;\n        }\n    }\n\n    protected updateElement(left: SModelElementImpl, right: SModelElementImpl, animationData: UpdateAnimationData): void {\n        if (isLocateable(left) && isLocateable(right)) {\n            const leftPos = left.position;\n            const rightPos = right.position;\n            if (!almostEquals(leftPos.x, rightPos.x) || !almostEquals(leftPos.y, rightPos.y)) {\n                if (animationData.moves === undefined)\n                    animationData.moves = [];\n                animationData.moves.push({\n                    element: right,\n                    fromPosition: leftPos,\n                    toPosition: rightPos\n                });\n                right.position = leftPos;\n            }\n        }\n        if (isSizeable(left) && isSizeable(right)) {\n            if (!Dimension.isValid(right.bounds)) {\n                right.bounds = {\n                    x: right.bounds.x,\n                    y: right.bounds.y,\n                    width: left.bounds.width,\n                    height: left.bounds.height\n                };\n            } else if (!almostEquals(left.bounds.width, right.bounds.width)\n                || !almostEquals(left.bounds.height, right.bounds.height)) {\n                if (animationData.resizes === undefined)\n                    animationData.resizes = [];\n                animationData.resizes.push({\n                    element: right,\n                    fromDimension: {\n                        width: left.bounds.width,\n                        height: left.bounds.height,\n                    },\n                    toDimension: {\n                        width: right.bounds.width,\n                        height: right.bounds.height,\n                    }\n                });\n            }\n        }\n        if (left instanceof SRoutableElementImpl && right instanceof SRoutableElementImpl && this.edgeRouterRegistry) {\n            if (animationData.edgeMementi === undefined)\n                animationData.edgeMementi = [];\n            animationData.edgeMementi.push({\n                edge: right,\n                before: this.takeSnapshot(left),\n                after: this.takeSnapshot(right),\n            });\n        }\n        if (isSelectable(left) && isSelectable(right)) {\n            right.selected = left.selected;\n        }\n        if (left instanceof SModelRootImpl && right instanceof SModelRootImpl) {\n            right.canvasBounds = left.canvasBounds;\n        }\n        if (left instanceof ViewportRootElementImpl && right instanceof ViewportRootElementImpl) {\n            right.scroll = left.scroll;\n            right.zoom = left.zoom;\n        }\n    }\n\n    protected takeSnapshot(edge: SRoutableElementImpl): EdgeSnapshot {\n        const router = this.edgeRouterRegistry!.get(edge.routerKind);\n        return router.takeSnapshot(edge);\n    }\n\n    protected createAnimations(data: UpdateAnimationData, root: SModelRootImpl, context: CommandExecutionContext): Animation[] {\n        const animations: Animation[] = [];\n        if (data.fades.length > 0) {\n            animations.push(new FadeAnimation(root, data.fades, context, true));\n        }\n        if (data.moves !== undefined && data.moves.length > 0) {\n            const movesMap: Map<string, ResolvedElementMove> = new Map;\n            for (const move of data.moves) {\n                movesMap.set(move.element.id, move);\n            }\n            animations.push(new MoveAnimation(root, movesMap, context, false));\n        }\n        if (data.resizes !== undefined && data.resizes.length > 0) {\n            const resizesMap: Map<string, ResolvedElementResize> = new Map;\n            for (const resize of data.resizes) {\n                resizesMap.set(resize.element.id, resize);\n            }\n            animations.push(new ResizeAnimation(root, resizesMap, context, false));\n        }\n        if (data.edgeMementi !== undefined && data.edgeMementi.length > 0) {\n            animations.push(new MorphEdgesAnimation(root, data.edgeMementi, context, false));\n        }\n        return animations;\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        return this.performUpdate(this.newRoot, this.oldRoot, context);\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        return this.performUpdate(this.oldRoot, this.newRoot, context);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2023 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from 'inversify';\nimport { GetViewportAction, ResponseAction, SetViewportAction, ViewportResult } from 'sprotty-protocol/lib/actions';\nimport { Viewport } from 'sprotty-protocol/lib/model';\nimport { Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { SModelElementImpl, SModelRootImpl } from '../../base/model/smodel';\nimport { MergeableCommand, ICommand, CommandExecutionContext, CommandReturn } from '../../base/commands/command';\nimport { Animation } from '../../base/animations/animation';\nimport { isViewport, limitViewport } from './model';\nimport { TYPES } from '../../base/types';\nimport { ModelRequestCommand } from '../../base/commands/request-command';\nimport { ViewerOptions } from '../../base/views/viewer-options';\n\n@injectable()\nexport class SetViewportCommand extends MergeableCommand {\n    static readonly KIND = SetViewportAction.KIND;\n\n    @inject(TYPES.ViewerOptions) protected viewerOptions: ViewerOptions;\n    protected element: SModelElementImpl & Viewport;\n    protected oldViewport: Viewport;\n    protected newViewport: Viewport;\n\n    constructor(@inject(TYPES.Action) protected readonly action: SetViewportAction) {\n        super();\n        this.newViewport = action.newViewport;\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const model = context.root;\n        const element = model.index.getById(this.action.elementId);\n        if (element && isViewport(element)) {\n            this.element = element;\n            this.oldViewport = {\n                scroll: this.element.scroll,\n                zoom: this.element.zoom,\n            };\n            const { zoomLimits, horizontalScrollLimits, verticalScrollLimits } = this.viewerOptions;\n            this.newViewport = limitViewport(this.newViewport, model.canvasBounds, horizontalScrollLimits, verticalScrollLimits, zoomLimits);\n            return this.setViewport(element, this.oldViewport, this.newViewport, context);\n        }\n        return context.root;\n    }\n\n    protected setViewport(element: SModelElementImpl, oldViewport: Viewport, newViewport: Viewport, context: CommandExecutionContext): CommandReturn {\n        if (element && isViewport(element)) {\n            if (this.action.animate) {\n                return new ViewportAnimation(element, oldViewport, newViewport, context).start();\n            } else {\n                element.scroll = newViewport.scroll;\n                element.zoom = newViewport.zoom;\n            }\n        }\n        return context.root;\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        return this.setViewport(this.element, this.newViewport, this.oldViewport, context);\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        return this.setViewport(this.element, this.oldViewport, this.newViewport, context);\n    }\n\n    override merge(command: ICommand, context: CommandExecutionContext): boolean {\n        if (!this.action.animate && command instanceof SetViewportCommand && this.element === command.element) {\n            this.newViewport = command.newViewport;\n            return true;\n        }\n        return false;\n    }\n}\n\nexport class GetViewportCommand extends ModelRequestCommand {\n    static readonly KIND = GetViewportAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected readonly action: GetViewportAction) {\n        super();\n    }\n\n    protected retrieveResult(context: CommandExecutionContext): ResponseAction {\n        const elem = context.root;\n        let viewport: Viewport;\n        if (isViewport(elem)) {\n            viewport = { scroll: elem.scroll, zoom: elem.zoom };\n        } else {\n            viewport = { scroll: Point.ORIGIN, zoom: 1 };\n        }\n        return ViewportResult.create(viewport, elem.canvasBounds, this.action.requestId);\n    }\n}\n\nexport class ViewportAnimation extends Animation {\n\n    protected zoomFactor: number;\n\n    constructor(protected element: SModelElementImpl & Viewport,\n                protected oldViewport: Viewport,\n                protected newViewport: Viewport,\n                protected override context: CommandExecutionContext) {\n        super(context);\n        this.zoomFactor = Math.log(newViewport.zoom / oldViewport.zoom);\n    }\n\n    tween(t: number, context: CommandExecutionContext): SModelRootImpl {\n        this.element.scroll = {\n            x: (1 - t) * this.oldViewport.scroll.x + t * this.newViewport.scroll.x,\n            y: (1 - t) * this.oldViewport.scroll.y + t * this.newViewport.scroll.y\n        };\n        this.element.zoom = this.oldViewport.zoom * Math.exp(t * this.zoomFactor);\n        return context.root;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2023 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Action, CenterAction, FitToScreenAction } from 'sprotty-protocol/lib/actions';\nimport { Viewport } from 'sprotty-protocol/lib/model';\nimport { almostEquals, Bounds, Dimension } from 'sprotty-protocol/lib/utils/geometry';\nimport { matchesKeystroke } from '../../utils/keyboard';\nimport { SChildElementImpl } from '../../base/model/smodel';\nimport { Command, CommandExecutionContext, CommandReturn } from '../../base/commands/command';\nimport { SModelElementImpl, SModelRootImpl } from '../../base/model/smodel';\nimport { KeyListener } from '../../base/views/key-tool';\nimport { isBoundsAware } from '../bounds/model';\nimport { isSelectable } from '../select/model';\nimport { ViewportAnimation } from './viewport';\nimport { isViewport, limitViewport } from './model';\nimport { injectable, inject } from 'inversify';\nimport { TYPES } from '../../base/types';\nimport { ViewerOptions } from '../../base/views/viewer-options';\n\n@injectable()\nexport abstract class BoundsAwareViewportCommand extends Command {\n\n    @inject(TYPES.ViewerOptions) protected viewerOptions: ViewerOptions;\n    oldViewport: Viewport;\n    newViewport?: Viewport;\n\n    constructor(protected readonly animate: boolean) {\n        super();\n    }\n\n    protected initialize(model: SModelRootImpl): void {\n        if (!isViewport(model)) {\n            return;\n        }\n        this.oldViewport = {\n            scroll: model.scroll,\n            zoom: model.zoom\n        };\n        const allBounds: Bounds[] = [];\n        this.getElementIds().forEach(id => {\n            const element = model.index.getById(id);\n            if (element && isBoundsAware(element)) {\n                allBounds.push(this.boundsInViewport(element, element.bounds, model));\n            }\n        });\n        if (allBounds.length === 0) {\n            model.index.all().forEach(element => {\n                if (isSelectable(element) && element.selected && isBoundsAware(element)) {\n                    allBounds.push(this.boundsInViewport(element, element.bounds, model));\n                }\n            });\n        }\n        if (allBounds.length === 0) {\n            model.index.all().forEach(element => {\n                if (isBoundsAware(element)) {\n                    allBounds.push(this.boundsInViewport(element, element.bounds, model));\n                }\n            });\n        }\n        if (allBounds.length !== 0) {\n            const bounds = allBounds.reduce((b0, b1) => Bounds.combine(b0, b1));\n            if (Dimension.isValid(bounds)) {\n                const newViewport = this.getNewViewport(bounds, model);\n                if (newViewport) {\n                    const { zoomLimits, horizontalScrollLimits, verticalScrollLimits } = this.viewerOptions;\n                    this.newViewport = limitViewport(newViewport, model.canvasBounds, horizontalScrollLimits, verticalScrollLimits, zoomLimits);\n                }\n            }\n        }\n    }\n\n    protected boundsInViewport(element: SModelElementImpl, bounds: Bounds, viewport: SModelRootImpl & Viewport): Bounds {\n        if (element instanceof SChildElementImpl && element.parent !== viewport)\n            return this.boundsInViewport(element.parent, element.parent.localToParent(bounds) as Bounds, viewport);\n        else\n            return bounds;\n    }\n\n    protected abstract getNewViewport(bounds: Bounds, model: SModelRootImpl): Viewport | undefined;\n\n    protected abstract getElementIds(): string[];\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        this.initialize(context.root);\n        return this.redo(context);\n    }\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        const model = context.root;\n        if (isViewport(model) && this.newViewport !== undefined && !this.equal(this.newViewport, this.oldViewport)) {\n            if (this.animate)\n                return new ViewportAnimation(model, this.newViewport, this.oldViewport, context).start();\n            else {\n                model.scroll = this.oldViewport.scroll;\n                model.zoom = this.oldViewport.zoom;\n            }\n        }\n        return model;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        const model = context.root;\n        if (isViewport(model) && this.newViewport !== undefined && !this.equal(this.newViewport, this.oldViewport)) {\n            if (this.animate) {\n               return new ViewportAnimation(model, this.oldViewport, this.newViewport, context).start();\n            } else {\n                model.scroll = this.newViewport.scroll;\n                model.zoom = this.newViewport.zoom;\n            }\n        }\n        return model;\n    }\n\n    protected equal(vp1: Viewport, vp2: Viewport): boolean {\n        return almostEquals(vp1.zoom, vp2.zoom) && almostEquals(vp1.scroll.x, vp2.scroll.x) && almostEquals(vp1.scroll.y, vp2.scroll.y);\n    }\n}\n\nexport class CenterCommand extends BoundsAwareViewportCommand {\n    static readonly KIND = CenterAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: CenterAction) {\n        super(action.animate);\n    }\n\n    getElementIds() {\n        return this.action.elementIds;\n    }\n\n    getNewViewport(bounds: Bounds, model: SModelRootImpl): Viewport | undefined {\n        if (!Dimension.isValid(model.canvasBounds)) {\n            return undefined;\n        }\n        let zoom = 1;\n        if (this.action.retainZoom && isViewport(model)) {\n            zoom = model.zoom;\n        } else if (this.action.zoomScale) {\n            zoom = this.action.zoomScale;\n        }\n        const c = Bounds.center(bounds);\n        return {\n            scroll: {\n                x: c.x - 0.5 * model.canvasBounds.width / zoom,\n                y: c.y - 0.5 * model.canvasBounds.height / zoom\n            },\n            zoom: zoom\n        };\n    }\n}\n\nexport class FitToScreenCommand extends BoundsAwareViewportCommand {\n    static readonly KIND = FitToScreenAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected readonly action: FitToScreenAction) {\n        super(action.animate);\n    }\n\n    getElementIds() {\n        return this.action.elementIds;\n    }\n\n    getNewViewport(bounds: Bounds, model: SModelRootImpl): Viewport | undefined {\n        if (!Dimension.isValid(model.canvasBounds)) {\n            return undefined;\n        }\n        const c = Bounds.center(bounds);\n        const delta = this.action.padding === undefined\n            ? 0\n            : 2 *  this.action.padding;\n        let zoom = Math.min(\n            model.canvasBounds.width / (bounds.width + delta),\n            model.canvasBounds.height / (bounds.height + delta));\n        if (this.action.maxZoom !== undefined)\n           zoom = Math.min(zoom, this.action.maxZoom);\n        if (zoom === Infinity) {\n            zoom = 1;\n        }\n        return {\n            scroll: {\n                x: c.x - 0.5 * model.canvasBounds.width / zoom,\n                y: c.y - 0.5 * model.canvasBounds.height / zoom\n            },\n            zoom: zoom\n        };\n    }\n}\n\nexport class CenterKeyboardListener extends KeyListener {\n    override keyDown(element: SModelElementImpl, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'KeyC', 'ctrlCmd', 'shift'))\n            return [CenterAction.create([])];\n        if (matchesKeystroke(event, 'KeyF', 'ctrlCmd', 'shift'))\n            return [FitToScreenAction.create([])];\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from 'inversify';\nimport { BringToFrontAction } from 'sprotty-protocol/lib/actions';\nimport { TYPES } from '../../base/types';\nimport { SModelRootImpl, SChildElementImpl, SModelElementImpl, SParentElementImpl } from '../../base/model/smodel';\nimport { Command, CommandExecutionContext } from '../../base/commands/command';\nimport { SRoutableElementImpl, SConnectableElementImpl } from '../routing/model';\n\nexport type ZOrderElement = {\n    element: SChildElementImpl\n    index: number\n};\n\n@injectable()\nexport class BringToFrontCommand extends Command {\n    static readonly KIND = BringToFrontAction.KIND;\n\n    protected selected: ZOrderElement[] = [];\n\n    constructor(@inject(TYPES.Action) public action: BringToFrontAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): SModelRootImpl {\n        const model = context.root;\n        this.action.elementIDs.forEach(id => {\n            const element = model.index.getById(id);\n            if (element instanceof SRoutableElementImpl) {\n                if (element.source)\n                    this.addToSelection(element.source);\n                if (element.target)\n                    this.addToSelection(element.target);\n            }\n            if (element instanceof SChildElementImpl) {\n                this.addToSelection(element);\n            }\n            this.includeConnectedEdges(element);\n        });\n        return this.redo(context);\n    }\n\n    protected includeConnectedEdges(element?: SModelElementImpl): void {\n        if (element instanceof SConnectableElementImpl) {\n            element.incomingEdges.forEach(edge => this.addToSelection(edge));\n            element.outgoingEdges.forEach(edge => this.addToSelection(edge));\n        }\n        if (element instanceof SParentElementImpl) {\n            for (const child of element.children) {\n                this.includeConnectedEdges(child);\n            }\n        }\n    }\n\n    protected addToSelection(element: SChildElementImpl): void {\n        this.selected.push({\n            element: element,\n            index: element.parent.children.indexOf(element)\n        });\n    }\n\n    undo(context: CommandExecutionContext): SModelRootImpl {\n        for (let i = this.selected.length - 1; i >= 0; i--) {\n            const selection = this.selected[i];\n            const element = selection.element;\n            element.parent.move(element, selection.index);\n        }\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): SModelRootImpl {\n        for (let i = 0; i < this.selected.length; i++) {\n            this.bringToFront(this.selected[i]);\n        }\n        return context.root;\n    }\n\n    protected bringToFront(selection: ZOrderElement) {\n        const element = selection.element;\n        const childrenLength = element.parent.children.length;\n        element.parent.move(element, childrenLength - 1);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { SetBoundsCommand, RequestBoundsCommand } from \"./bounds-manipulation\";\nimport { HiddenBoundsUpdater } from './hidden-bounds-updater';\nimport { configureLayout, Layouter, LayoutRegistry } from \"./layout\";\nimport { configureCommand } from \"../../base/commands/command-registration\";\nimport { HBoxLayouter } from \"./hbox-layout\";\nimport { VBoxLayouter } from \"./vbox-layout\";\nimport { StackLayouter} from \"./stack-layout\";\n\nconst boundsModule = new ContainerModule((bind, _unbind, isBound) => {\n    configureCommand({ bind, isBound }, SetBoundsCommand);\n    configureCommand({ bind, isBound }, RequestBoundsCommand);\n    bind(HiddenBoundsUpdater).toSelf().inSingletonScope();\n    bind(TYPES.HiddenVNodePostprocessor).toService(HiddenBoundsUpdater);\n    bind(TYPES.Layouter).to(Layouter).inSingletonScope();\n    bind(TYPES.LayoutRegistry).to(LayoutRegistry).inSingletonScope();\n\n    configureLayout({bind, isBound}, VBoxLayouter.KIND, VBoxLayouter);\n    configureLayout({bind, isBound}, HBoxLayouter.KIND, HBoxLayouter);\n    configureLayout({bind, isBound}, StackLayouter.KIND, StackLayouter);\n});\n\nexport default boundsModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { ButtonHandlerRegistry } from './button-handler';\n\nconst buttonModule = new ContainerModule(bind => {\n    bind(ButtonHandlerRegistry).toSelf().inSingletonScope();\n});\n\nexport default buttonModule;\n", "/********************************************************************************\n * Copyright (c) 2019 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { CommandPaletteActionProviderRegistry } from \"./action-providers\";\nimport { CommandPalette, CommandPaletteKeyListener } from \"./command-palette\";\n\nconst commandPaletteModule = new ContainerModule((bind) => {\n    bind(CommandPalette).toSelf().inSingletonScope();\n    bind(TYPES.IUIExtension).toService(CommandPalette);\n    bind(CommandPaletteKeyListener).toSelf().inSingletonScope();\n    bind(TYPES.KeyListener).toService(CommandPaletteKeyListener);\n    bind(CommandPaletteActionProviderRegistry).toSelf().inSingletonScope();\n    bind(TYPES.ICommandPaletteActionProviderRegistry).toService(CommandPaletteActionProviderRegistry);\n});\n\nexport default commandPaletteModule;\n", "/********************************************************************************\n * Copyright (c) 2019 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { ContainerModule } from \"inversify\";\n\nimport { IContextMenuService } from \"./context-menu-service\";\nimport { ContextMenuProviderRegistry } from \"./menu-providers\";\nimport { ContextMenuMouseListener } from \"./mouse-listener\";\nimport { TYPES } from \"../../base/types\";\n\nconst contextMenuModule = new ContainerModule(bind => {\n    bind(TYPES.IContextMenuServiceProvider).toProvider<IContextMenuService>(ctx => {\n        return () => {\n            return new Promise<IContextMenuService>((resolve, reject) => {\n                if (ctx.container.isBound(TYPES.IContextMenuService)) {\n                    resolve(ctx.container.get<IContextMenuService>(TYPES.IContextMenuService));\n                } else {\n                    reject();\n                }\n            });\n        };\n    });\n    bind(ContextMenuMouseListener).toSelf().inSingletonScope();\n    bind(TYPES.MouseListener).toService(ContextMenuMouseListener);\n    bind(TYPES.IContextMenuProviderRegistry).to(ContextMenuProviderRegistry);\n});\n\nexport default contextMenuModule;\n", "/********************************************************************************\n * Copyright (c) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { configureModelElement } from \"../../base/views/view\";\nimport { ContainerModule } from \"inversify\";\nimport { SIssueMarker } from \"./model\";\nimport { IssueMarkerView } from \"./views\";\nimport { TYPES } from \"../../base/types\";\nimport { DecorationPlacer } from \"./decoration-placer\";\n\nconst decorationModule = new ContainerModule((bind, _unbind, isBound)  => {\n    configureModelElement({ bind, isBound }, 'marker', SIssueMarker, IssueMarkerView);\n    bind(DecorationPlacer).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(DecorationPlacer);\n});\n\nexport default decorationModule;\n", "/********************************************************************************\n * Copyright (c) 2021 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { IntersectionFinder } from \"../edge-intersection/intersection-finder\";\n\nconst edgeIntersectionModule = new ContainerModule(bind => {\n    bind(IntersectionFinder).toSelf().inSingletonScope();\n    bind(TYPES.IEdgeRoutePostprocessor).toService(IntersectionFinder);\n});\n\nexport default edgeIntersectionModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { configureButtonHandler } from \"../button/button-handler\";\nimport { ExpandButtonHandler } from \"./expand\";\n\nconst expandModule = new ContainerModule((bind, _unbind, isBound) => {\n    configureButtonHandler({bind, isBound}, ExpandButtonHandler.TYPE, ExpandButtonHandler);\n});\n\nexport default expandModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from '../../base/types';\nimport { ExportSvgPostprocessor, ExportSvgKeyListener, ExportSvgCommand } from './export';\nimport { SvgExporter } from './svg-exporter';\nimport { configureCommand } from \"../../base/commands/command-registration\";\n\nconst exportSvgModule = new ContainerModule((bind, _unbind, isBound) => {\n    bind(ExportSvgKeyListener).toSelf().inSingletonScope();\n    bind(TYPES.KeyListener).toService(ExportSvgKeyListener);\n    bind(ExportSvgPostprocessor).toSelf().inSingletonScope();\n    bind(TYPES.HiddenVNodePostprocessor).toService(ExportSvgPostprocessor);\n    configureCommand({ bind, isBound }, ExportSvgCommand);\n    bind(TYPES.SvgExporter).to(SvgExporter).inSingletonScope();\n});\n\nexport default exportSvgModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { ElementFader } from \"./fade\";\n\nconst fadeModule = new ContainerModule(bind => {\n    bind(ElementFader).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(ElementFader);\n});\n\nexport default fadeModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from \"inversify\";\nimport { VNode } from \"snabbdom\";\nimport { TYPES } from \"../../base/types\";\nimport { IVNodePostprocessor } from \"../../base/views/vnode-postprocessor\";\nimport { ViewerOptions } from \"../../base/views/viewer-options\";\nimport { SModelElementImpl } from \"../../base/model/smodel\";\n\n@injectable()\nexport class PopupPositionUpdater implements IVNodePostprocessor {\n\n    @inject(TYPES.ViewerOptions) protected options: ViewerOptions;\n\n    decorate(vnode: VNode, element: SModelElementImpl): VNode {\n        return vnode;\n    }\n\n    postUpdate(): void {\n        const popupDiv = document.getElementById(this.options.popupDiv);\n        if (popupDiv !== null && typeof window !== 'undefined') {\n            const boundingClientRect = popupDiv.getBoundingClientRect();\n            if (window.innerHeight < boundingClientRect.height + boundingClientRect.top) {\n                popupDiv.style.top = (window.pageYOffset + window.innerHeight - boundingClientRect.height - 5) + 'px';\n            }\n\n            if (window.innerWidth < boundingClientRect.left + boundingClientRect.width) {\n                popupDiv.style.left = (window.pageXOffset + window.innerWidth - boundingClientRect.width - 5) + 'px';\n            }\n\n            if (boundingClientRect.left < 0) {\n                popupDiv.style.left = '0px';\n            }\n\n            if (boundingClientRect.top < 0) {\n                popupDiv.style.top = '0px';\n            }\n        }\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport {\n    HoverMouseListener, PopupHoverMouseListener, HoverFeedbackCommand, SetPopupModelCommand,\n    HoverKeyListener, HoverState, ClosePopupActionHandler\n} from \"./hover\";\nimport { PopupPositionUpdater } from \"./popup-position-updater\";\nimport { configureCommand } from \"../../base/commands/command-registration\";\nimport { configureActionHandler } from \"../../base/actions/action-handler\";\nimport { FitToScreenCommand, CenterCommand } from \"../viewport/center-fit\";\nimport { SetViewportCommand } from \"../viewport/viewport\";\nimport { MoveCommand } from \"../move/move\";\n\nconst hoverModule = new ContainerModule((bind, _unbind, isBound) => {\n    bind(PopupPositionUpdater).toSelf().inSingletonScope();\n    bind(TYPES.PopupVNodePostprocessor).toService(PopupPositionUpdater);\n    bind(HoverMouseListener).toSelf().inSingletonScope();\n    bind(TYPES.MouseListener).toService(HoverMouseListener);\n    bind(PopupHoverMouseListener).toSelf().inSingletonScope();\n    bind(TYPES.PopupMouseListener).toService(PopupHoverMouseListener);\n    bind(HoverKeyListener).toSelf().inSingletonScope();\n    bind(TYPES.KeyListener).toService(HoverKeyListener);\n    bind<HoverState>(TYPES.HoverState).toConstantValue({\n        mouseOverTimer: undefined,\n        mouseOutTimer: undefined,\n        popupOpen: false,\n        previousPopupElement: undefined\n    });\n    bind(ClosePopupActionHandler).toSelf().inSingletonScope();\n\n    const context = { bind, isBound };\n    configureCommand(context, HoverFeedbackCommand);\n    configureCommand(context, SetPopupModelCommand);\n    configureActionHandler(context, SetPopupModelCommand.KIND, ClosePopupActionHandler);\n    configureActionHandler(context, FitToScreenCommand.KIND, ClosePopupActionHandler);\n    configureActionHandler(context, CenterCommand.KIND, ClosePopupActionHandler);\n    configureActionHandler(context, SetViewportCommand.KIND, ClosePopupActionHandler);\n    configureActionHandler(context, MoveCommand.KIND, ClosePopupActionHandler);\n});\n\nexport default hoverModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from '../../base/types';\nimport { MoveCommand, MoveMouseListener, LocationPostprocessor } from './move';\nimport { configureCommand } from \"../../base/commands/command-registration\";\n\nconst moveModule = new ContainerModule((bind, _unbind, isBound) => {\n    bind(MoveMouseListener).toSelf().inSingletonScope();\n    bind(TYPES.MouseListener).toService(MoveMouseListener);\n    configureCommand({ bind, isBound }, MoveCommand);\n    bind(LocationPostprocessor).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(LocationPostprocessor);\n    bind(TYPES.HiddenVNodePostprocessor).toService(LocationPostprocessor);\n});\n\nexport default moveModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { OpenMouseListener } from \"./open\";\n\nconst openModule = new ContainerModule(bind => {\n    bind(OpenMouseListener).toSelf().inSingletonScope();\n    bind(TYPES.MouseListener).toService(OpenMouseListener);\n});\n\nexport default openModule;\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { ManhattanEdgeRouter } from \"./manhattan-edge-router\";\nimport { PolylineEdgeRouter } from \"./polyline-edge-router\";\nimport { ManhattanRectangularAnchor, ManhattanEllipticAnchor, ManhattanDiamondAnchor } from \"./manhattan-anchors\";\nimport { RectangleAnchor, EllipseAnchor, DiamondAnchor } from \"./polyline-anchors\";\nimport { AnchorComputerRegistry } from \"./anchor\";\nimport { EdgeRouterRegistry } from \"./routing\";\nimport { AddRemoveBezierSegmentCommand, BezierEdgeRouter } from './bezier-edge-router';\nimport { BezierDiamondAnchor, BezierEllipseAnchor, BezierRectangleAnchor } from './bezier-anchors';\nimport { configureCommand } from \"../../base/commands/command-registration\";\n\nconst routingModule = new ContainerModule((bind, _unbind, isBound) => {\n    bind(EdgeRouterRegistry).toSelf().inSingletonScope();\n\n    bind(AnchorComputerRegistry).toSelf().inSingletonScope();\n\n    bind(ManhattanEdgeRouter).toSelf().inSingletonScope();\n    bind(TYPES.IEdgeRouter).toService(ManhattanEdgeRouter);\n    bind(ManhattanEllipticAnchor).toSelf().inSingletonScope();\n    bind(TYPES.IAnchorComputer).toService(ManhattanEllipticAnchor);\n    bind(ManhattanRectangularAnchor).toSelf().inSingletonScope();\n    bind(TYPES.IAnchorComputer).toService(ManhattanRectangularAnchor);\n    bind(ManhattanDiamondAnchor).toSelf().inSingletonScope();\n    bind(TYPES.IAnchorComputer).toService(ManhattanDiamondAnchor);\n\n    bind(PolylineEdgeRouter).toSelf().inSingletonScope();\n    bind(TYPES.IEdgeRouter).toService(PolylineEdgeRouter);\n    bind(EllipseAnchor).toSelf().inSingletonScope();\n    bind(TYPES.IAnchorComputer).toService(EllipseAnchor);\n    bind(RectangleAnchor).toSelf().inSingletonScope();\n    bind(TYPES.IAnchorComputer).toService(RectangleAnchor);\n    bind(DiamondAnchor).toSelf().inSingletonScope();\n    bind(TYPES.IAnchorComputer).toService(DiamondAnchor);\n\n    bind(BezierEdgeRouter).toSelf().inSingletonScope();\n    bind(TYPES.IEdgeRouter).toService(BezierEdgeRouter);\n    bind(BezierEllipseAnchor).toSelf().inSingletonScope();\n    bind(TYPES.IAnchorComputer).toService(BezierEllipseAnchor);\n    bind(BezierRectangleAnchor).toSelf().inSingletonScope();\n    bind(TYPES.IAnchorComputer).toService(BezierRectangleAnchor);\n    bind(BezierDiamondAnchor).toSelf().inSingletonScope();\n    bind(TYPES.IAnchorComputer).toService(BezierDiamondAnchor);\n\n    configureCommand({ bind, isBound }, AddRemoveBezierSegmentCommand);\n});\n\nexport default routingModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { SelectCommand, SelectAllCommand, SelectKeyboardListener, SelectMouseListener, GetSelectionCommand } from \"./select\";\nimport { configureCommand } from \"../../base/commands/command-registration\";\n\nconst selectModule = new ContainerModule((bind, _unbind, isBound) => {\n    configureCommand({ bind, isBound }, SelectCommand);\n    configureCommand({ bind, isBound }, SelectAllCommand);\n    configureCommand({ bind, isBound }, GetSelectionCommand);\n    bind(SelectKeyboardListener).toSelf().inSingletonScope();\n    bind(TYPES.KeyListener).toService(SelectKeyboardListener);\n    bind(SelectMouseListener).toSelf().inSingletonScope();\n    bind(TYPES.MouseListener).toService(SelectMouseListener);\n});\n\nexport default selectModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { UndoRedoKeyListener } from \"./undo-redo\";\n\nconst undoRedoModule = new ContainerModule(bind => {\n    bind(UndoRedoKeyListener).toSelf().inSingletonScope();\n    bind(TYPES.KeyListener).toService(UndoRedoKeyListener);\n});\n\nexport default undoRedoModule;\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { configureCommand } from \"../../base/commands/command-registration\";\nimport { UpdateModelCommand } from \"./update-model\";\n\nconst updateModule = new ContainerModule((bind, _unbind, isBound) => {\n    configureCommand({ bind, isBound }, UpdateModelCommand);\n});\n\nexport default updateModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { TYPES } from \"../../base/types\";\nimport { CenterCommand, CenterKeyboardListener, FitToScreenCommand } from \"./center-fit\";\nimport { SetViewportCommand, GetViewportCommand } from \"./viewport\";\nimport { ScrollMouseListener } from \"./scroll\";\nimport { ZoomMouseListener } from \"./zoom\";\nimport { configureCommand } from \"../../base/commands/command-registration\";\n\nconst viewportModule = new ContainerModule((bind , _unbind, isBound) => {\n    configureCommand({ bind, isBound }, CenterCommand);\n    configureCommand({ bind, isBound }, FitToScreenCommand);\n    configureCommand({ bind, isBound }, SetViewportCommand);\n    configureCommand({ bind, isBound }, GetViewportCommand);\n    bind(CenterKeyboardListener).toSelf().inSingletonScope();\n    bind(TYPES.KeyListener).toService(CenterKeyboardListener);\n    bind(ScrollMouseListener).toSelf().inSingletonScope();\n    bind(ZoomMouseListener).toSelf().inSingletonScope();\n    bind(TYPES.MouseListener).toService(ScrollMouseListener);\n    bind(TYPES.MouseListener).toService(ZoomMouseListener);\n});\n\nexport default viewportModule;\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { configureCommand } from \"../../base/commands/command-registration\";\nimport { BringToFrontCommand } from './zorder';\n\nconst zorderModule = new ContainerModule((bind, _unbind, isBound) => {\n    configureCommand({ bind, isBound }, BringToFrontCommand);\n});\n\nexport default zorderModule;\n", "/********************************************************************************\n * Copyright (c) 2017-2022 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/** @jsx svg */\nimport { inject, injectable } from 'inversify';\nimport { VNode } from \"snabbdom\";\nimport { Point } from 'sprotty-protocol/lib/utils/geometry';\nimport { getSubType } from 'sprotty-protocol/lib/utils/model-utils';\nimport { IView, IViewArgs, RenderingContext } from \"../base/views/view\";\nimport { setAttr } from '../base/views/vnode-utils';\nimport { ShapeView } from '../features/bounds/views';\nimport {\n    BY_DESCENDING_X_THEN_DESCENDING_Y,\n    BY_DESCENDING_X_THEN_Y,\n    BY_X_THEN_DESCENDING_Y,\n    BY_X_THEN_Y,\n    IntersectingRoutedPoint,\n    Intersection,\n    isIntersectingRoutedPoint\n} from '../features/edge-intersection/intersection-finder';\nimport { isEdgeLayoutable } from '../features/edge-layout/model';\nimport { SRoutableElementImpl, SRoutingHandleImpl } from '../features/routing/model';\nimport { EdgeRouterRegistry, RoutedPoint } from '../features/routing/routing';\nimport { RoutableView } from '../features/routing/views';\nimport { svg } from '../lib/jsx';\nimport { PointToPointLine } from '../utils/geometry';\nimport { SCompartmentImpl, SEdgeImpl, SGraphImpl, SLabelImpl } from \"./sgraph\";\n\n/**\n * IView component that turns an SGraph element and its children into a tree of virtual DOM elements.\n */\n@injectable()\nexport class SGraphView implements IView {\n\n    @inject(EdgeRouterRegistry) edgeRouterRegistry: EdgeRouterRegistry;\n\n    render(model: Readonly<SGraphImpl>, context: RenderingContext): VNode {\n        const edgeRouting = this.edgeRouterRegistry.routeAllChildren(model);\n        const transform = `scale(${model.zoom}) translate(${-model.scroll.x},${-model.scroll.y})`;\n        return <svg class-sprotty-graph={true}>\n            <g transform={transform}>\n                {context.renderChildren(model, { edgeRouting })}\n            </g>\n        </svg>;\n    }\n\n}\n\n@injectable()\nexport class PolylineEdgeView extends RoutableView {\n\n    @inject(EdgeRouterRegistry) edgeRouterRegistry: EdgeRouterRegistry;\n\n    render(edge: Readonly<SEdgeImpl>, context: RenderingContext, args?: IViewArgs): VNode | undefined {\n        const route = this.edgeRouterRegistry.route(edge, args);\n        if (route.length === 0) {\n            return this.renderDanglingEdge(\"Cannot compute route\", edge, context);\n        }\n        if (!this.isVisible(edge, route, context)) {\n            if (edge.children.length === 0) {\n                return undefined;\n            }\n            // The children of an edge are not necessarily inside the bounding box of the route,\n            // so we need to render a group to ensure the children have a chance to be rendered.\n            return <g>{context.renderChildren(edge, { route })}</g>;\n        }\n\n        return <g class-sprotty-edge={true} class-mouseover={edge.hoverFeedback}>\n            {this.renderLine(edge, route, context, args)}\n            {this.renderAdditionals(edge, route, context)}\n            {context.renderChildren(edge, { route })}\n        </g>;\n    }\n\n    protected renderLine(edge: SEdgeImpl, segments: Point[], context: RenderingContext, args?: IViewArgs): VNode {\n        const firstPoint = segments[0];\n        let path = `M ${firstPoint.x},${firstPoint.y}`;\n        for (let i = 1; i < segments.length; i++) {\n            const p = segments[i];\n            path += ` L ${p.x},${p.y}`;\n        }\n        return <path d={path} />;\n    }\n\n    protected renderAdditionals(edge: SEdgeImpl, segments: Point[], context: RenderingContext): VNode[] {\n        // here we need to render the control points?\n        return [];\n    }\n\n    protected renderDanglingEdge(message: string, edge: SEdgeImpl, context: RenderingContext): VNode {\n        return <text class-sprotty-edge-dangling={true} title={message}>?</text>;\n    }\n}\n\n/**\n * A `PolylineEdgeView` that renders jumps over intersections.\n *\n * In order to find intersections, `IntersectionFinder` needs to be configured as a `TYPES.IEdgeRoutePostprocessor`\n * so that that intersections are declared as `IntersectingRoutedPoint` in the computed routes.\n *\n * This view only draws correct line jumps for intersections among straight line segments and doesn't work with bezier curves.\n *\n * @see IntersectionFinder\n * @see IntersectingRoutedPoint\n * @see EdgeRouterRegistry\n */\n@injectable()\nexport class JumpingPolylineEdgeView extends PolylineEdgeView {\n\n    protected jumpOffsetBefore = 5;\n    protected jumpOffsetAfter = 5;\n    protected skipOffsetBefore = 3;\n    protected skipOffsetAfter = 2;\n\n    protected override renderLine(edge: SEdgeImpl, segments: Point[], context: RenderingContext, args?: IViewArgs): VNode {\n        let path = '';\n        for (let i = 0; i < segments.length; i++) {\n            const p = segments[i];\n            if (i === 0) {\n                path = `M ${p.x},${p.y}`;\n            }\n            if (isIntersectingRoutedPoint(p)) {\n                path += this.intersectionPath(edge, segments, p, args);\n            }\n            if (i !== 0) {\n                path += ` L ${p.x},${p.y}`;\n            }\n        }\n        return <path d={path} />;\n    }\n\n    /**\n     * Returns a path that takes the intersections into account by drawing a line jump or a gap for intersections on that path.\n     */\n    protected intersectionPath(edge: SEdgeImpl, segments: Point[], intersectingPoint: IntersectingRoutedPoint, args?: IViewArgs): string {\n        if (intersectingPoint.intersections.length < 1) {\n            return '';\n        }\n\n        const segment = this.getLineSegment(edge, intersectingPoint.intersections[0], args, segments);\n        const intersections = this.getIntersectionsSortedBySegmentDirection(segment, intersectingPoint);\n\n        let path = '';\n        for (const intersection of intersections) {\n            const otherLineSegment = this.getOtherLineSegment(edge, intersection, args);\n            if (otherLineSegment === undefined) {\n                continue;\n            }\n            const currentLineSegment = this.getLineSegment(edge, intersection, args, segments);\n            const intersectionPoint = intersection.intersectionPoint;\n            if (this.shouldDrawLineJumpOnIntersection(currentLineSegment, otherLineSegment)) {\n                path += this.createJumpPath(intersectionPoint, currentLineSegment);\n            } else if (this.shouldDrawLineGapOnIntersection(currentLineSegment, otherLineSegment)) {\n                path += this.createGapPath(intersectionPoint, currentLineSegment);\n            }\n        }\n\n        return path;\n    }\n\n    /**\n     * Returns the intersections sorted by the direction of the `lineSegment`.\n     *\n     * The coordinate system goes from left to right and top to bottom.\n     * Thus, x increases to the right and y increases downwards.\n     *\n     * We need to draw the intersections in the order of the direction of the line segment.\n     * To draw a line pointing north, we need to order intersections by Y in a descending order.\n     * To draw a line pointing south, we need to order intersections by Y in an ascending order.\n     */\n    protected getIntersectionsSortedBySegmentDirection(lineSegment: PointToPointLine, intersectingPoint: IntersectingRoutedPoint) {\n        switch (lineSegment.direction) {\n            case 'north':\n            case 'north-east':\n                return intersectingPoint.intersections.sort(BY_X_THEN_DESCENDING_Y);\n\n            case 'south':\n            case 'south-east':\n            case 'east':\n                return intersectingPoint.intersections.sort(BY_X_THEN_Y);\n\n            case 'south-west':\n            case 'west':\n                return intersectingPoint.intersections.sort(BY_DESCENDING_X_THEN_Y);\n\n            case 'north-west':\n                return intersectingPoint.intersections.sort(BY_DESCENDING_X_THEN_DESCENDING_Y);\n        }\n    }\n\n    /**\n     * Whether or not to draw a line jump on an intersection for the `currentLineSegment`.\n     * This should usually be inverse of `shouldDrawLineGapOnIntersection()`.\n     */\n    protected shouldDrawLineJumpOnIntersection(currentLineSegment: PointToPointLine, otherLineSegment: PointToPointLine) {\n        return Math.abs(currentLineSegment.slopeOrMax) < Math.abs(otherLineSegment.slopeOrMax);\n    }\n\n    /**\n     * Whether or not to draw a line gap on an intersection for the `currentLineSegment`.\n     * This should usually be inverse of `shouldDrawLineJumpOnIntersection()`.\n     */\n    protected shouldDrawLineGapOnIntersection(currentLineSegment: PointToPointLine, otherLineSegment: PointToPointLine) {\n        return !this.shouldDrawLineJumpOnIntersection(currentLineSegment, otherLineSegment);\n    }\n\n    protected getLineSegment(edge: SRoutableElementImpl, intersection: Intersection, args?: IViewArgs, segments?: Point[]): PointToPointLine {\n        const route = segments ? segments : this.edgeRouterRegistry.route(edge, args);\n        const index = intersection.routable1 === edge.id ? intersection.segmentIndex1 : intersection.segmentIndex2;\n        return new PointToPointLine(route[index], route[index + 1]);\n    }\n\n    protected getOtherLineSegment(currentEdge: SEdgeImpl, intersection: Intersection, args?: IViewArgs): PointToPointLine | undefined {\n        const otherEdgeId = intersection.routable1 === currentEdge.id ? intersection.routable2 : intersection.routable1;\n        const otherEdge = currentEdge.index.getById(otherEdgeId);\n        if (!(otherEdge instanceof SRoutableElementImpl)) {\n            return undefined;\n        }\n        return this.getLineSegment(otherEdge, intersection, args);\n    }\n\n    protected createJumpPath(intersectionPoint: Point, lineSegment: PointToPointLine): string {\n        const anchorBefore = Point.shiftTowards(intersectionPoint, lineSegment.p1, this.jumpOffsetBefore);\n        const anchorAfter = Point.shiftTowards(intersectionPoint, lineSegment.p2, this.jumpOffsetAfter);\n        const rotation = lineSegment.p1.x < lineSegment.p2.x ? 1 : 0;\n        return ` L ${anchorBefore.x},${anchorBefore.y} A 1,1 0,0 ${rotation} ${anchorAfter.x},${anchorAfter.y}`;\n    }\n\n    protected createGapPath(intersectionPoint: Point, lineSegment: PointToPointLine): string {\n        let offsetBefore;\n        let offsetAfter;\n        if (intersectionPoint.y < lineSegment.p1.y) {\n            offsetBefore = -this.skipOffsetBefore;\n            offsetAfter = this.jumpOffsetAfter + this.skipOffsetAfter;\n        } else {\n            offsetBefore = this.jumpOffsetBefore + this.skipOffsetAfter;\n            offsetAfter = -this.skipOffsetBefore;\n        }\n        const anchorBefore = Point.shiftTowards(intersectionPoint, lineSegment.p1, offsetBefore);\n        const anchorAfter = Point.shiftTowards(intersectionPoint, lineSegment.p2, offsetAfter);\n        return ` L ${anchorBefore.x},${anchorBefore.y} M ${anchorAfter.x},${anchorAfter.y}`;\n    }\n\n}\n\n/**\n * A `PolylineEdgeView` that renders gaps on intersections.\n *\n * In order to find intersections, `IntersectionFinder` needs to be configured as a `TYPES.IEdgeRoutePostprocessor`\n * so that that intersections are declared as `IntersectingRoutedPoint` in the computed routes.\n *\n * This view only draws correct gaps for intersections among straight line segments and doesn't work with bezier curves.\n *\n * @see IntersectionFinder\n * @see IntersectingRoutedPoint\n * @see EdgeRouterRegistry\n */\n@injectable()\nexport class PolylineEdgeViewWithGapsOnIntersections extends JumpingPolylineEdgeView {\n\n    protected override skipOffsetBefore = 3;\n    protected override skipOffsetAfter = 3;\n\n    protected override shouldDrawLineJumpOnIntersection(currentLineSegment: PointToPointLine, otherLineSegment: PointToPointLine) {\n        return false;\n    }\n\n    protected override shouldDrawLineGapOnIntersection(currentLineSegment: PointToPointLine, otherLineSegment: PointToPointLine) {\n        return Math.abs(currentLineSegment.slopeOrMax) >= Math.abs(otherLineSegment.slopeOrMax);\n    }\n\n    protected override createGapPath(intersectionPoint: Point, lineSegment: PointToPointLine): string {\n        const anchorBefore = Point.shiftTowards(intersectionPoint, lineSegment.p1, this.skipOffsetBefore);\n        const anchorAfter = Point.shiftTowards(intersectionPoint, lineSegment.p2, this.skipOffsetAfter);\n        return ` L ${anchorBefore.x},${anchorBefore.y} M ${anchorAfter.x},${anchorAfter.y}`;\n    }\n\n}\n\n@injectable()\nexport class BezierCurveEdgeView extends RoutableView {\n\n    @inject(EdgeRouterRegistry) edgeRouterRegistry: EdgeRouterRegistry;\n\n    render(edge: Readonly<SEdgeImpl>, context: RenderingContext, args?: IViewArgs): VNode | undefined {\n        const route = this.edgeRouterRegistry.route(edge, args);\n        if (route.length === 0) {\n            return this.renderDanglingEdge(\"Cannot compute route\", edge, context);\n        }\n        if (!this.isVisible(edge, route, context)) {\n            if (edge.children.length === 0) {\n                return undefined;\n            }\n            // The children of an edge are not necessarily inside the bounding box of the route,\n            // so we need to render a group to ensure the children have a chance to be rendered.\n            return <g>{context.renderChildren(edge, { route })}</g>;\n        }\n\n        return <g class-sprotty-edge={true} class-mouseover={edge.hoverFeedback}>\n            {this.renderLine(edge, route, context, args)}\n            {this.renderAdditionals(edge, route, context)}\n            {context.renderChildren(edge, { route })}\n        </g>;\n    }\n\n    protected renderLine(edge: SEdgeImpl, segments: Point[], context: RenderingContext, args?: IViewArgs): VNode {\n        /**\n         * Example for two splines:\n         * SVG:\n         * <path d=\"M0,300 C0,150 300,150 300,300 S600,450 600,300\" />\n         *\n         * Segments input layout:\n         * routingPoints[0] = source;\n         * routingPoints[1] = controlForSource;\n         * routingPoints[2] = controlForSegment1;\n         * routingPoints[3] = segment;\n         * routingPoints[4] = controlForSegment2;\n         * routingPoints[5] = controlForTarget;\n         * routingPoints[6] = target;\n         */\n        let path = '';\n        if (segments.length >= 4) {\n            path += this.buildMainSegment(segments);\n            const pointsLeft = segments.length - 4;\n            if (pointsLeft > 0 && pointsLeft % 3 === 0) {\n                for (let i = 4; i < segments.length; i += 3) {\n                    path += this.addSpline(segments, i);\n                }\n            }\n        }\n        return <path d={path} />;\n    }\n\n    private buildMainSegment(segments: Point[]) {\n        const s = segments[0];\n        const h1 = segments[1];\n        const h2 = segments[2];\n        const t = segments[3];\n        return `M${s.x},${s.y} C${h1.x},${h1.y} ${h2.x},${h2.y} ${t.x},${t.y}`;\n    }\n\n    private addSpline(segments: Point[], index: number) {\n        // We have two controls for each junction, but SVG does not therefore index is jumped over\n        const c = segments[index + 1];\n        const p = segments[index + 2];\n        return ` S${c.x},${c.y} ${p.x},${p.y}`;\n    }\n\n    protected renderAdditionals(edge: SEdgeImpl, segments: Point[], context: RenderingContext): VNode[] {\n        return [];\n    }\n\n    protected renderDanglingEdge(message: string, edge: SEdgeImpl, context: RenderingContext): VNode {\n        return <text class-sprotty-edge-dangling={true} title={message}>?</text>;\n    }\n}\n\n@injectable()\nexport class SRoutingHandleView implements IView {\n\n    @inject(EdgeRouterRegistry) edgeRouterRegistry: EdgeRouterRegistry;\n\n    minimalPointDistance: number = 10;\n\n    render(handle: Readonly<SRoutingHandleImpl>, context: RenderingContext, args?: { route?: RoutedPoint[] }): VNode {\n        if (args && args.route) {\n            if (handle.parent instanceof SRoutableElementImpl) {\n                const router = this.edgeRouterRegistry.get(handle.parent.routerKind);\n                const theRoute = args.route === undefined ? this.edgeRouterRegistry.route(handle.parent, args) : args.route;\n                const position = router.getHandlePosition(handle.parent, theRoute, handle);\n                if (position !== undefined) {\n                    const node = <circle class-sprotty-routing-handle={true}\n                        class-selected={handle.selected} class-mouseover={handle.hoverFeedback}\n                        cx={position.x} cy={position.y} r={this.getRadius()} />;\n                    setAttr(node, 'data-kind', handle.kind);\n                    return node;\n                }\n            }\n        }\n        // Fallback: Create an empty group\n        return <g />;\n    }\n\n    getRadius(): number {\n        return 7;\n    }\n}\n\n@injectable()\nexport class SLabelView extends ShapeView {\n    render(label: Readonly<SLabelImpl>, context: RenderingContext): VNode | undefined {\n        if (!isEdgeLayoutable(label) && !this.isVisible(label, context)) {\n            return undefined;\n        }\n        const vnode = <text class-sprotty-label={true}>{label.text}</text>;\n        const subType = getSubType(label);\n        if (subType) {\n            setAttr(vnode, 'class', subType);\n        }\n        return vnode;\n    }\n}\n\n@injectable()\nexport class SCompartmentView implements IView {\n    render(compartment: Readonly<SCompartmentImpl>, context: RenderingContext, args?: IViewArgs): VNode | undefined {\n        const translate = `translate(${compartment.bounds.x}, ${compartment.bounds.y})`;\n        const vnode = <g transform={translate} class-sprotty-comp=\"{true}\">\n            {context.renderChildren(compartment)}\n        </g>;\n        const subType = getSubType(compartment);\n        if (subType)\n            setAttr(vnode, 'class', subType);\n        return vnode;\n    }\n}\n\n@injectable()\nexport class SBezierCreateHandleView extends SRoutingHandleView {\n\n    override render(handle: Readonly<SRoutingHandleImpl>, context: RenderingContext, args?: { route?: RoutedPoint[] }): VNode {\n        if (args) {\n            const theRoute = args.route;\n            if (theRoute && handle.parent instanceof SRoutableElementImpl) {\n                const router = this.edgeRouterRegistry.get(handle.parent.routerKind);\n                const position = router.getHandlePosition(handle.parent, theRoute, handle);\n                if (position !== undefined) {\n\n                    const translation = \"translate(\" + position.x + \", \" + position.y + \")\";\n                    const textOffsetX = -5.5;\n                    const textOffsetY = 5.5;\n                    const text = (handle.kind === \"bezier-add\") ? \"+\" : \"-\";\n                    const node =\n                        <g transform={translation} class-sprotty-routing-handle={true}\n                            class-selected={handle.selected} class-mouseover={handle.hoverFeedback}>\n                            <circle r={this.getRadius()} />\n                            <text x={textOffsetX} y={textOffsetY} attrs-text-align=\"middle\"\n                                style-font-family=\"monospace\" style-pointer-events=\"none\" style-fill=\"white\">{text}</text>\n                        </g>;\n                    setAttr(node, 'data-kind', handle.kind);\n                    return node;\n                }\n            }\n        }\n        // Fallback: Create an empty group\n        return <g />;\n    }\n}\n\n@injectable()\nexport class SBezierControlHandleView extends SRoutingHandleView {\n\n    override render(handle: Readonly<SRoutingHandleImpl>, context: RenderingContext, args?: { route?: RoutedPoint[] }): VNode {\n        if (args) {\n            const theRoute = args.route;\n            if (theRoute && handle.parent instanceof SRoutableElementImpl) {\n                const router = this.edgeRouterRegistry.get(handle.parent.routerKind);\n                const position = router.getHandlePosition(handle.parent, theRoute, handle) as any;\n                if (position !== undefined) {\n\n                    let pathEndPos: Point | undefined;\n                    for (let i = 0; i < theRoute.length; i++) {\n                        const elem = theRoute[i];\n                        if (elem.kind === position.kind && elem.pointIndex === position.pointIndex) {\n                            if (handle.kind === 'bezier-control-before') {\n                                pathEndPos = theRoute[i + 1];\n                            } else {\n                                pathEndPos = theRoute[i - 1];\n                            }\n                            break;\n                        }\n                    }\n\n                    let node;\n                    if (pathEndPos) {\n                        const coords = `M ${position.x}, ${position.y} L ${pathEndPos.x}, ${pathEndPos.y}`;\n                        node =\n                            <g class-sprotty-routing-handle={true} class-selected={handle.selected} class-mouseover={handle.hoverFeedback}>\n                                <path d={coords} stroke=\"grey\" style-stroke-width=\"2px\"></path>\n                                <circle cx={position.x} cy={position.y} r={this.getRadius()} />\n                            </g>;\n                    } else {\n                        node = <circle class-sprotty-routing-handle={true} class-selected={handle.selected} class-mouseover={handle.hoverFeedback}\n                            cx={position.x} cy={position.y} r={this.getRadius()} />;\n                    }\n\n                    setAttr(node, 'data-kind', handle.kind);\n                    return node;\n                }\n            }\n        }\n        // Fallback: Create an empty group\n        return <g />;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from \"inversify\";\nimport { configureCommand } from \"../base/commands/command-registration\";\nimport { TYPES } from \"../base/types\";\nimport { CommitModelCommand } from \"./commit-model\";\nimport { ComputedBoundsApplicator, ModelSource } from \"./model-source\";\n\n/**\n * This container module does NOT provide any binding for TYPES.ModelSource because that needs to be\n * done according to the needs of the application. You can choose between a local (LocalModelSource)\n * and a remote (e.g. WebSocketDiagramServer) implementation.\n */\nconst modelSourceModule = new ContainerModule((bind, _unbind, isBound) => {\n    bind(TYPES.ModelSourceProvider).toProvider<ModelSource>((context) => {\n        return () => {\n            return new Promise<ModelSource>((resolve) => {\n                resolve(context.container.get<ModelSource>(TYPES.ModelSource));\n            });\n        };\n    });\n    configureCommand({bind, isBound}, CommitModelCommand);\n    bind(TYPES.IActionHandlerInitializer).toService(TYPES.ModelSource);\n    bind(ComputedBoundsApplicator).toSelf().inSingletonScope();\n});\n\nexport default modelSourceModule;\n", "/********************************************************************************\n * Copyright (c) 2019 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Container, ContainerModule } from 'inversify';\nimport defaultModule from '../base/di.config';\nimport modelSourceModule from '../model-source/di.config';\nimport boundsModule from '../features/bounds/di.config';\nimport buttonModule from '../features/button/di.config';\nimport commandPaletteModule from '../features/command-palette/di.config';\nimport contextMenuModule from '../features/context-menu/di.config';\nimport decorationModule from '../features/decoration/di.config';\nimport edgeLayoutModule from '../features/edge-layout/di.config';\nimport { edgeEditModule, labelEditModule, labelEditUiModule } from '../features/edit/di.config';\nimport expandModule from '../features/expand/di.config';\nimport exportModule from '../features/export/di.config';\nimport fadeModule from '../features/fade/di.config';\nimport hoverModule from '../features/hover/di.config';\nimport moveModule from '../features/move/di.config';\nimport openModule from '../features/open/di.config';\nimport routingModule from '../features/routing/di.config';\nimport selectModule from '../features/select/di.config';\nimport undoRedoModule from '../features/undo-redo/di.config';\nimport updateModule from '../features/update/di.config';\nimport viewportModule from '../features/viewport/di.config';\nimport zorderModule from '../features/zorder/di.config';\n\nexport interface LoadModuleOptions {\n    exclude?: ContainerModule[]\n}\n\n/**\n * Load the default set of container modules provided by Sprotty.\n */\nexport function loadDefaultModules(container: Container, options?: LoadModuleOptions) {\n    const modules = [\n        defaultModule, modelSourceModule, boundsModule, buttonModule,\n        commandPaletteModule, contextMenuModule, decorationModule, edgeEditModule,\n        edgeLayoutModule, expandModule, exportModule, fadeModule,\n        hoverModule, labelEditModule, labelEditUiModule, moveModule,\n        openModule, routingModule, selectModule, undoRedoModule,\n        updateModule, viewportModule, zorderModule\n    ];\n    if (options && options.exclude) {\n        for (const mod of options.exclude) {\n            const index = modules.indexOf(mod);\n            if (index >= 0)\n                modules.splice(index, 1);\n        }\n    }\n    container.load(...modules);\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { h, vnode, VNode, VNodeData } from 'snabbdom';\n\nfunction buildVNodeData(attrs: { [key: string]: string }) {\n    const data: VNodeData = {};\n    const addData = (memo: Record<string, string> | null, name: string) => {\n        if (name !== 'style' && name !== 'class') {\n            const val = unescapeEntities(attrs[name]);\n            memo ? memo[name] = val : memo = { [name]: val };\n        }\n        return memo;\n    };\n    const _attrs = Object.keys(attrs).reduce(addData, null);\n\n    if (_attrs) {\n        data.attrs = _attrs;\n    }\n\n    const style = parseStyle(attrs);\n    if (style) {\n        data.style = style;\n    }\n\n    const classes = parseClass(attrs);\n    if (classes) {\n        data.class = classes;\n    }\n    return data;\n}\n\nfunction parseStyle(attrs: { [key: string]: string }) {\n    const addStyle = (memo: Record<string, string> | null, styleProp: string) => {\n        const res = styleProp.split(':');\n        const name = transformName(res[0].trim());\n        if (name) {\n            const val = res[1].replace('!important', '').trim();\n            memo ? memo[name] = val : memo = { [name]: val };\n        }\n        return memo;\n    };\n    try {\n        return attrs.style.split(';').reduce(addStyle, null);\n    } catch (e) {\n        return null;\n    }\n}\n\nfunction parseClass(attrs: { [key: string]: string }) {\n    const addClass = (memo: Record<string, boolean> | null, className: string) => {\n        className = className.trim();\n        if (className) {\n            memo ? memo[className] = true : memo = { [className]: true };\n        }\n        return memo;\n    };\n    try {\n        return attrs.class.split(' ').reduce(addClass, null);\n    } catch (e) {\n        return null;\n    }\n}\n\nfunction transformName(name: string) {\n    // Replace -a with A to help camel case style property names.\n    name = name.replace(/-(\\w)/g, function _replace($1, $2) {\n        return $2.toUpperCase();\n    });\n    // Handle properties that start with a -.\n    const firstChar = name.charAt(0).toLowerCase();\n    return `${firstChar}${name.substring(1)}`;\n}\n\n// Regex for matching HTML entities.\nconst entityRegex = new RegExp('&[a-z0-9#]+;', 'gi');\n// Element for setting innerHTML for transforming entities.\nlet el: HTMLDivElement | null = null;\n\nfunction unescapeEntities(text: string) {\n    // Create the element using the context if it doesn't exist.\n    if (!el) {\n        el = document.createElement('div');\n    }\n    return text.replace(entityRegex, (entity) => {\n        if (el === null) return '';\n        el.innerHTML = entity;\n        return el.textContent === null ? '' : el.textContent;\n    });\n}\n\nfunction recurse(doc: Node, func: (node: Node, parent: Node | null) => void) {\n    let node: Node | null = doc;\n    let parent: Node | null = null;\n    const stack: Node[] = [];\n\n    const setChild = (n: Node) => {\n        const child = n.firstChild;\n        if (child !== null) {\n            parent = n;\n        }\n        node = child;\n    };\n    func(node, parent);\n    setChild(node);\n\n    while (true) {\n        while (node) {\n            stack.push(node);\n            func(node, parent);\n            setChild(node);\n        }\n        const _node = stack.pop();\n        node = _node ? _node : null;\n        if (!stack.length) break;\n        parent = stack[stack.length - 1];\n        if (node) {\n            const sibling = node.nextSibling;\n            if (sibling == null) {\n                parent = stack[stack.length - 1];\n            }\n            node = sibling;\n        }\n    }\n}\n\nlet vdom: VNode | null = null;\nconst vnodeMap = new Map<Node, VNode>();\nlet delimited = false;\n\nfunction toVNode(node: Node, parent: Node | null) {\n\n    let current: VNode | undefined;\n    if (parent !== null) {\n        current = vnodeMap.get(parent);\n    }\n\n    switch (node?.nodeType) {\n        // element\n        case 1: {\n            if (current === undefined) return;\n            current.children = current.children ? current.children : [];\n            const children = current.children;\n            const attributes = (node as Element).attributes;\n            const attrs: { [key: string]: string } = {};\n            for (let i = 0; i < attributes.length; i++) {\n                const attr = attributes.item(i);\n                if (attr) {\n                    attrs[attr.name] = attr.value;\n                }\n            }\n            const vn = h(node.nodeName, buildVNodeData(attrs));\n            children.push(vn);\n            vnodeMap.set(node, vn);\n            break;\n        }\n        // text\n        case 3: {\n            const text = node.textContent;\n            if (text !== null && current !== undefined) {\n                current.children = current.children ? current.children : [];\n                const children = current.children;\n                const lastData = children.length > 0 ? children[children.length - 1] : null;\n                if (!delimited && typeof lastData !== 'string' && lastData !== null && lastData.sel === undefined) {\n                    lastData.text = lastData.text + text;\n                } else {\n                    children.push(vnode(undefined, undefined, undefined, text, undefined));\n                }\n                delimited = false;\n            }\n            break;\n        }\n        case 8: {\n            delimited = true;\n            break;\n        }\n        // document\n        case 9: {\n            vdom = vnode(undefined, undefined, [], undefined, undefined);\n            vnodeMap.set(node, vdom);\n            break;\n        }\n        default:\n            break;\n    }\n}\n\nfunction stripVNode(vnodes: VNode | null) {\n    const children = vnodes?.children;\n    if (typeof children === 'undefined') return null;\n    if (children.length === 1 && typeof children[0] !== 'string') return children[0];\n    return null;\n}\n\nexport default function virtualizeString(html?: string) {\n\n    const parser = new window.DOMParser();\n    if (parser === undefined || html === undefined || html === '') return null;\n\n    const doc = parser.parseFromString(html, \"application/xml\");\n\n    if (doc?.firstChild?.nodeName === 'parsererror') {\n        const error = `${doc?.firstChild?.textContent}`;\n        return h('parsererror', [error]);\n    }\n\n    delimited = false;\n    vdom = null;\n    recurse(doc, toVNode);\n\n    if (vdom === null) return null;\n    return stripVNode(vdom);\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2020 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelElement as SModelElementSchema, SModelRoot as SModelRootSchema } from 'sprotty-protocol/lib/model';\nimport { Bounds, Dimension, Point } from \"sprotty-protocol/lib/utils/geometry\";\nimport { SModelRootImpl, SChildElementImpl } from \"../base/model/smodel\";\nimport { BoundsAware, boundsFeature, Alignable, alignFeature, isBoundsAware } from \"../features/bounds/model\";\nimport { Locateable, moveFeature } from \"../features/move/model\";\nimport { Selectable, selectFeature } from \"../features/select/model\";\nimport { SNodeImpl, SPortImpl } from '../graph/sgraph';\nimport { RECTANGULAR_ANCHOR_KIND, DIAMOND_ANCHOR_KIND, ELLIPTIC_ANCHOR_KIND } from \"../features/routing/anchor\";\n\n/**\n * A node that is represented by a circle.\n */\nexport class CircularNode extends SNodeImpl {\n    override get anchorKind() {\n        return ELLIPTIC_ANCHOR_KIND;\n    }\n}\n\n/**\n * A node that is represented by a rectangle.\n */\nexport class RectangularNode extends SNodeImpl {\n    override get anchorKind() {\n        return RECTANGULAR_ANCHOR_KIND;\n    }\n}\n\n/**\n * A node that is represented by a diamond.\n */\nexport class DiamondNode extends SNodeImpl {\n    override get anchorKind() {\n        return DIAMOND_ANCHOR_KIND;\n    }\n}\n\n/**\n * A port that is represented by a circle.\n */\nexport class CircularPort extends SPortImpl {\n    override get anchorKind() {\n        return ELLIPTIC_ANCHOR_KIND;\n    }\n}\n\n/**\n * A port that is represented by a rectangle.\n */\nexport class RectangularPort extends SPortImpl {\n    override get anchorKind() {\n        return RECTANGULAR_ANCHOR_KIND;\n    }\n}\n\n/**\n * Serializable schema for HtmlRoot.\n *\n * @deprecated Use `HtmlRoot` from `sprotty-protocol` instead.\n */\nexport interface HtmlRootSchema extends SModelRootSchema {\n    classes?: string[]\n}\n\n/**\n * Root model element class for HTML content. Usually this is rendered with a `div` DOM element.\n */\nexport class HtmlRootImpl extends SModelRootImpl {\n    classes: string[] = [];\n}\n\n/** @deprecated Use `HtmlRootImpl` instead. */\nexport const HtmlRoot = HtmlRootImpl;\n\n/**\n * Serializable schema for PreRenderedElement.\n *\n * @deprecated Use `PreRenderedElement` from `sprotty-protocol` instead.\n */\nexport interface PreRenderedElementSchema extends SModelElementSchema {\n    code: string\n}\n\n/**\n * Pre-rendered elements contain HTML or SVG code to be transferred to the DOM. This can be useful to\n * render complex figures or to compute the view on the server instead of the client code.\n */\nexport class PreRenderedElementImpl extends SChildElementImpl {\n    code: string;\n}\n\n/** @deprecated Use `PreRenderedElementImpl` instead. */\nexport const PreRenderedElement = PreRenderedElementImpl;\n\n/**\n * Serializable schema for ShapedPreRenderedElement.\n *\n * @deprecated Use `ShapedPreRenderedElement` from `sprotty-protocol` instead.\n */\nexport interface ShapedPreRenderedElementSchema extends PreRenderedElementSchema {\n    position?: Point\n    size?: Dimension\n}\n\n/**\n * Same as PreRenderedElement, but with a position and a size.\n */\nexport class ShapedPreRenderedElementImpl extends PreRenderedElementImpl implements BoundsAware, Locateable, Selectable, Alignable {\n    static readonly DEFAULT_FEATURES = [moveFeature, boundsFeature, selectFeature, alignFeature];\n\n    position: Point = Point.ORIGIN;\n    size: Dimension = Dimension.EMPTY;\n    selected: boolean = false;\n    alignment: Point = Point.ORIGIN;\n\n    get bounds(): Bounds {\n        return {\n            x: this.position.x,\n            y: this.position.y,\n            width: this.size.width,\n            height: this.size.height\n        };\n    }\n\n    set bounds(newBounds: Bounds) {\n        this.position = {\n            x: newBounds.x,\n            y: newBounds.y\n        };\n        this.size = {\n            width: newBounds.width,\n            height: newBounds.height\n        };\n    }\n\n}\n\n/** @deprecated Use `ShapedPreRenderedElementImpl` instead. */\nexport const ShapedPreRenderedElement = ShapedPreRenderedElementImpl;\n\n/**\n * A `foreignObject` element to be transferred to the DOM within the SVG.\n *\n * This can be useful to to benefit from e.g. HTML rendering features, such as line wrapping, inside of\n * the SVG diagram.  Note that `foreignObject` is not supported by all browsers and SVG viewers may not\n * support rendering the `foreignObject` content.\n *\n * If no dimensions are specified in the schema element, this element will obtain the dimension of\n * its parent to fill the entire available room. Thus, this element requires specified bounds itself\n * or bounds to be available for its parent.\n */\nexport class ForeignObjectElementImpl extends ShapedPreRenderedElementImpl {\n    namespace: string;\n    override get bounds(): Bounds {\n        if (Dimension.isValid(this.size)) {\n            return {\n                x: this.position.x,\n                y: this.position.y,\n                width: this.size.width,\n                height: this.size.height\n            };\n        } else if (isBoundsAware(this.parent)) {\n            return {\n                x: this.position.x,\n                y: this.position.y,\n                width: this.parent.bounds.width,\n                height: this.parent.bounds.height\n            };\n        }\n        return Bounds.EMPTY;\n    }\n}\n\n/** @deprecated Use `ForeignObjectElementImpl` instead. */\nexport const ForeignObjectElement = ForeignObjectElementImpl;\n\n/**\n * Serializable schema for ForeignObjectElement.\n *\n * @deprecated Use `ForeignObjectElement` from `sprotty-protocol` instead.\n */\nexport interface ForeignObjectElementSchema extends ShapedPreRenderedElementSchema {\n    /** The namespace to be assigned to the elements inside of the `foreignObject`. */\n    namespace: string\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2020 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/** @jsx svg */\nimport { svg }\u00A0from './jsx';\nimport { injectable } from \"inversify\";\nimport virtualize from \"./virtualize\";\nimport { VNode } from \"snabbdom\";\nimport { IView, RenderingContext } from \"../base/views/view\";\nimport { setNamespace, setAttr } from \"../base/views/vnode-utils\";\nimport { ShapeView } from \"../features/bounds/views\";\nimport { ForeignObjectElementImpl, PreRenderedElementImpl, ShapedPreRenderedElementImpl } from \"./model\";\n\n@injectable()\nexport class PreRenderedView extends ShapeView {\n    render(model: Readonly<PreRenderedElementImpl>, context: RenderingContext): VNode | undefined {\n        if (model instanceof ShapedPreRenderedElementImpl && !this.isVisible(model, context)) {\n            return undefined;\n        }\n        const node = virtualize(model.code);\n        if (node === null) return undefined;\n        this.correctNamespace(node);\n        return node;\n    }\n\n    protected correctNamespace(node: VNode) {\n        if (node.sel === 'svg' || node.sel === 'g')\n            setNamespace(node, 'http://www.w3.org/2000/svg');\n    }\n}\n\n/**\n * An SVG `foreignObject` view with a namespace specified by the provided `ForeignObjectElement`.\n * Note that `foreignObject` may not be supported by all browsers or SVG viewers.\n */\n@injectable()\nexport class ForeignObjectView implements IView {\n    render(model: ForeignObjectElementImpl, context: RenderingContext): VNode | undefined{\n        const foreignObjectContents = virtualize(model.code);\n        if (foreignObjectContents === null) return undefined;\n        const node = <g>\n            <foreignObject requiredFeatures='http://www.w3.org/TR/SVG11/feature#Extensibility'\n                height={model.bounds.height} width={model.bounds.width} x={0} y={0}>\n                {foreignObjectContents}\n            </foreignObject>\n            {context.renderChildren(model)}\n        </g>;\n        setAttr(node, 'class', model.type);\n        setNamespace(foreignObjectContents, model.namespace);\n        return node;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n /** @jsx html */\nimport { html }\u00A0from './jsx';\n\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { IView, RenderingContext } from '../base/views/view';\nimport { setClass } from '../base/views/vnode-utils';\nimport { HtmlRootImpl } from './model';\n\n/**\n * View for `HtmlRoot` elements. Typically this is used in hover popup boxes.\n */\n@injectable()\nexport class HtmlRootView implements IView {\n    render(model: HtmlRootImpl, context: RenderingContext): VNode {\n        const root = <div>\n            { context.renderChildren(model) }\n        </div>;\n        for (const c of model.classes) {\n            setClass(root, c, true);\n        }\n        return root;\n    }\n}\n", "/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nvar isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { saveAs } from 'file-saver';\nimport { inject, injectable } from 'inversify';\nimport {\n    Action, OpenAction, ActionMessage, isActionMessage, CollapseExpandAction, CollapseExpandAllAction,\n    ComputedBoundsAction, RequestModelAction, RequestPopupModelAction, SetModelAction, UpdateModelAction\n} from 'sprotty-protocol/lib/actions';\nimport { SModelRoot } from 'sprotty-protocol/lib/model';\nimport { ActionHandlerRegistry } from '../base/actions/action-handler';\nimport { ICommand } from '../base/commands/command';\nimport { SetModelCommand } from '../base/features/set-model';\nimport { TYPES } from '../base/types';\nimport { RequestBoundsCommand } from '../features/bounds/bounds-manipulation';\nimport { ExportSvgAction } from '../features/export/svg-exporter';\nimport { UpdateModelCommand } from '../features/update/update-model';\nimport { ILogger } from '../utils/logging';\nimport { ComputedBoundsApplicator, ModelSource } from './model-source';\n\n/**\n * Sent by the external server when to signal a state change.\n */\nexport class ServerStatusAction {\n    static KIND = 'serverStatus';\n    kind = ServerStatusAction.KIND;\n    severity: string;\n    message: string;\n}\n\nconst receivedFromServerProperty = '__receivedFromServer';\n\n/**\n * A ModelSource that communicates with an external model provider, e.g.\n * a model editor.\n *\n * This class defines which actions are sent to and received from the\n * external model source.\n */\n@injectable()\nexport abstract class DiagramServerProxy extends ModelSource {\n\n    @inject(TYPES.ILogger) protected logger: ILogger;\n    @inject(ComputedBoundsApplicator) protected readonly computedBoundsApplicator: ComputedBoundsApplicator;\n\n    clientId: string;\n\n    protected currentRoot: SModelRoot = {\n        type: 'NONE',\n        id: 'ROOT'\n    };\n\n    protected lastSubmittedModelType: string;\n\n    override get model(): SModelRoot {\n        return this.currentRoot;\n    }\n\n    override initialize(registry: ActionHandlerRegistry): void {\n        super.initialize(registry);\n\n        // Register actions to be sent to the remote server\n        registry.register(ComputedBoundsAction.KIND, this);\n        registry.register(RequestBoundsCommand.KIND, this);\n        registry.register(RequestPopupModelAction.KIND, this);\n        registry.register(CollapseExpandAction.KIND, this);\n        registry.register(CollapseExpandAllAction.KIND, this);\n        registry.register(OpenAction.KIND, this);\n        registry.register(ServerStatusAction.KIND, this);\n\n        if (!this.clientId) {\n            this.clientId = this.viewerOptions.baseDiv;\n        }\n    }\n\n    handle(action: Action): void | ICommand | Action {\n        const forwardToServer = this.handleLocally(action);\n        if (forwardToServer) {\n            this.forwardToServer(action);\n        }\n    }\n\n    protected forwardToServer(action: Action): void {\n        const message: ActionMessage = {\n            clientId: this.clientId,\n            action: action\n        };\n        this.logger.log(this, 'sending', message);\n        this.sendMessage(message);\n    }\n\n    /**\n     * Send a message to the remote diagram server.\n     */\n    protected abstract sendMessage(message: ActionMessage): void;\n\n    /**\n     * Called when a message is received from the remote diagram server.\n     */\n    protected messageReceived(data: any): void {\n        const object = typeof(data) === 'string' ? JSON.parse(data) : data;\n        if (isActionMessage(object) && object.action) {\n            if (!object.clientId || object.clientId === this.clientId) {\n                (object.action as any)[receivedFromServerProperty] = true;\n                this.logger.log(this, 'receiving', object);\n                this.actionDispatcher.dispatch(object.action).then(() => {\n                    this.storeNewModel(object.action);\n                });\n            }\n        } else {\n            this.logger.error(this, 'received data is not an action message', object);\n        }\n    }\n\n    /**\n     * Check whether the given action should be handled locally. Returns true if the action should\n     * still be sent to the server, and false if it's only handled locally.\n     */\n    protected handleLocally(action: Action): boolean {\n        this.storeNewModel(action);\n        switch (action.kind) {\n            case ComputedBoundsAction.KIND:\n                return this.handleComputedBounds(action as ComputedBoundsAction);\n            case RequestModelAction.KIND:\n                return this.handleRequestModel(action as RequestModelAction);\n            case RequestBoundsCommand.KIND:\n                return false;\n            case ExportSvgAction.KIND:\n                return this.handleExportSvgAction(action as ExportSvgAction);\n            case ServerStatusAction.KIND:\n                return this.handleServerStateAction(action as ServerStatusAction);\n        }\n        return !(action as any)[receivedFromServerProperty];\n    }\n\n    /**\n     * Put the new model contained in the given action into the model storage, if there is any.\n     */\n    protected storeNewModel(action: Action): void {\n        if (action.kind === SetModelCommand.KIND\n            || action.kind === UpdateModelCommand.KIND\n            || action.kind === RequestBoundsCommand.KIND) {\n            const newRoot = (action as any).newRoot;\n            if (newRoot) {\n                this.currentRoot = newRoot as SModelRoot;\n                if (action.kind === SetModelCommand.KIND || action.kind === UpdateModelCommand.KIND) {\n                    this.lastSubmittedModelType = newRoot.type;\n                }\n            }\n        }\n    }\n\n    protected handleRequestModel(action: RequestModelAction): boolean {\n        const newOptions = {\n            needsClientLayout: this.viewerOptions.needsClientLayout,\n            needsServerLayout: this.viewerOptions.needsServerLayout,\n            ...action.options\n        };\n        const newAction = {\n            ...action,\n            options: newOptions\n        };\n        this.forwardToServer(newAction);\n        return false;\n    }\n\n    /**\n     * If the server requires to compute a layout, the computed bounds are forwarded. Otherwise they\n     * are applied to the current model locally and a model update is triggered.\n     */\n    protected handleComputedBounds(action: ComputedBoundsAction): boolean {\n        if (this.viewerOptions.needsServerLayout) {\n            return true;\n        } else {\n            const root = this.currentRoot;\n            this.computedBoundsApplicator.apply(root, action);\n            if (root.type === this.lastSubmittedModelType) {\n                this.actionDispatcher.dispatch(UpdateModelAction.create(root));\n            } else {\n                this.actionDispatcher.dispatch(SetModelAction.create(root));\n            }\n            this.lastSubmittedModelType = root.type;\n            return false;\n        }\n    }\n\n    protected handleExportSvgAction(action: ExportSvgAction): boolean {\n        const blob = new Blob([action.svg], { type: 'text/plain;charset=utf-8' });\n        saveAs(blob, 'diagram.svg');\n        return false;\n    }\n\n    protected handleServerStateAction(action: ServerStatusAction): boolean {\n        return false;\n    }\n\n    commitModel(newRoot: SModelRoot): Promise<SModelRoot> | SModelRoot {\n        const previousRoot = this.currentRoot;\n        this.currentRoot = newRoot;\n        return previousRoot;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { saveAs } from 'file-saver';\nimport { inject, injectable, optional } from 'inversify';\nimport {\n    Action, ComputedBoundsAction, RequestBoundsAction, RequestModelAction, RequestPopupModelAction,\n    SetModelAction, SetPopupModelAction, UpdateModelAction\n} from 'sprotty-protocol/lib/actions';\nimport { SModelElement, SModelRoot, Viewport} from 'sprotty-protocol/lib/model';\nimport { IModelLayoutEngine, GetViewportAction, ViewportResult, GetSelectionAction, SelectionResult } from 'sprotty-protocol';\nimport { Bounds } from 'sprotty-protocol/lib/utils/geometry';\nimport { SModelIndex, findElement } from 'sprotty-protocol/lib/utils/model-utils';\nimport { ILogger } from '../utils/logging';\nimport { FluentIterable } from '../utils/iterable';\nimport { TYPES } from '../base/types';\nimport { ActionHandlerRegistry } from '../base/actions/action-handler';\nimport { EMPTY_ROOT } from '../base/model/smodel-factory';\nimport { ExportSvgAction } from '../features/export/svg-exporter';\nimport { applyMatches, Match } from '../features/update/model-matching';\nimport { ModelSource, ComputedBoundsApplicator } from './model-source';\n\nexport interface IPopupModelProvider {\n    getPopupModel(request: RequestPopupModelAction, element?: SModelElement): SModelRoot | undefined;\n}\n\n/**\n * A model source that allows to set and modify the model through function calls.\n * This class can be used as a facade over the action-based API of sprotty. It handles\n * actions for bounds calculation and model updates.\n */\n@injectable()\nexport class LocalModelSource extends ModelSource {\n\n    @inject(TYPES.ILogger) protected readonly logger: ILogger;\n    @inject(ComputedBoundsApplicator) protected readonly computedBoundsApplicator: ComputedBoundsApplicator;\n    @inject(TYPES.IPopupModelProvider)@optional() protected popupModelProvider?: IPopupModelProvider;\n    @inject(TYPES.IModelLayoutEngine)@optional() protected layoutEngine?: IModelLayoutEngine;\n\n    protected currentRoot: SModelRoot = EMPTY_ROOT;\n\n    /**\n     * The `type` property of the model root is used to determine whether a model update\n     * is a change of the previous model or a totally new one.\n     */\n    protected lastSubmittedModelType: string;\n\n    override get model(): SModelRoot {\n        return this.currentRoot;\n    }\n\n    set model(root: SModelRoot) {\n        this.setModel(root);\n    }\n\n    override initialize(registry: ActionHandlerRegistry): void {\n        super.initialize(registry);\n\n        // Register actions to be handled by the `handle` method\n        registry.register(ComputedBoundsAction.KIND, this);\n        registry.register(RequestPopupModelAction.KIND, this);\n    }\n\n    /**\n     * Set the model without incremental update.\n     */\n    setModel(newRoot: SModelRoot): Promise<void> {\n        this.currentRoot = newRoot;\n        return this.submitModel(newRoot, false);\n    }\n\n    commitModel(newRoot: SModelRoot): Promise<SModelRoot> | SModelRoot {\n        const previousRoot = this.currentRoot;\n        this.currentRoot = newRoot;\n        return previousRoot;\n    }\n\n    /**\n     * Apply an incremental update to the model with an animation showing the transition to\n     * the new state. If `newRoot` is undefined, the current root is submitted; in that case\n     * it is assumed that it has been modified before.\n     */\n    updateModel(newRoot?: SModelRoot): Promise<void> {\n        if (newRoot === undefined) {\n            return this.submitModel(this.currentRoot, true);\n        } else {\n            this.currentRoot = newRoot;\n            return this.submitModel(newRoot, true);\n        }\n    }\n\n    /**\n     * Get the current selection from the model.\n     */\n    async getSelection(): Promise<FluentIterable<SModelElement>> {\n        const res = await this.actionDispatcher.request<SelectionResult>(GetSelectionAction.create());\n        const result: SModelElement[] = [];\n        this.gatherSelectedElements(this.currentRoot, new Set(res.selectedElementsIDs), result);\n        return result;\n    }\n\n    private gatherSelectedElements(element: SModelElement, selected: Set<string>, result: SModelElement[]): void {\n        if (selected.has(element.id)) {\n            result.push(element);\n        }\n        if (element.children) {\n            for (const child of element.children) {\n                this.gatherSelectedElements(child, selected, result);\n            }\n        }\n    }\n\n    /**\n     * Get the current viewport from the model.\n     */\n    async getViewport(): Promise<Viewport & { canvasBounds: Bounds }> {\n        const res = await this.actionDispatcher.request<ViewportResult>(GetViewportAction.create());\n        return {\n            scroll: res.viewport.scroll,\n            zoom: res.viewport.zoom,\n            canvasBounds: res.canvasBounds\n        };\n    }\n\n    /**\n     * If client layout is active, run a `RequestBoundsAction` and wait for the resulting\n     * `ComputedBoundsAction`, otherwise call `doSubmitModel(\u2026)` directly.\n     */\n    protected async submitModel(newRoot: SModelRoot, update: boolean | Match[], cause?: Action): Promise<void> {\n        if (this.viewerOptions.needsClientLayout) {\n            const computedBounds = await this.actionDispatcher.request<ComputedBoundsAction>(RequestBoundsAction.create(newRoot));\n            const index = this.computedBoundsApplicator.apply(this.currentRoot, computedBounds);\n            await this.doSubmitModel(newRoot, true, cause, index);\n        } else {\n            await this.doSubmitModel(newRoot, update, cause);\n        }\n    }\n\n    /**\n     * Submit the given model with an `UpdateModelAction` or a `SetModelAction` depending on the\n     * `update` argument. If available, the model layout engine is invoked first.\n     */\n    protected async doSubmitModel(newRoot: SModelRoot, update: boolean | Match[],\n            cause?: Action, index?: SModelIndex): Promise<void> {\n        if (this.layoutEngine !== undefined) {\n            try {\n                const layoutResult = this.layoutEngine.layout(newRoot, index);\n                if (layoutResult instanceof Promise)\n                    newRoot = await layoutResult;\n                else if (layoutResult !== undefined)\n                    newRoot = layoutResult;\n            } catch (error) {\n                this.logger.error(this, error.toString(), error.stack);\n            }\n        }\n\n        const lastSubmittedModelType = this.lastSubmittedModelType;\n        this.lastSubmittedModelType = newRoot.type;\n        if (cause && cause.kind === RequestModelAction.KIND && (cause as RequestModelAction).requestId) {\n            const request = cause as RequestModelAction;\n            await this.actionDispatcher.dispatch(SetModelAction.create(newRoot, request.requestId));\n        } else if (update && newRoot.type === lastSubmittedModelType) {\n            const input = Array.isArray(update) ? update : newRoot;\n            await this.actionDispatcher.dispatch(UpdateModelAction.create(input, { animate: true, cause }));\n        } else {\n            await this.actionDispatcher.dispatch(SetModelAction.create(newRoot));\n        }\n    }\n\n    /**\n     * Modify the current model with an array of matches.\n     */\n    applyMatches(matches: Match[]): Promise<void> {\n        const root = this.currentRoot;\n        applyMatches(root, matches);\n        return this.submitModel(root, matches);\n    }\n\n    /**\n     * Modify the current model by adding new elements.\n     */\n    addElements(elements: (SModelElement | { element: SModelElement, parentId: string })[]): Promise<void> {\n        const matches: Match[] = [];\n        for (const e of elements) {\n            const anye: any = e;\n            if (typeof anye.element === 'object' && typeof anye.parentId === 'string') {\n                matches.push({\n                    right: anye.element,\n                    rightParentId: anye.parentId\n                });\n            } else if (typeof anye.id === 'string') {\n                matches.push({\n                    right: anye,\n                    rightParentId: this.currentRoot.id\n                });\n            }\n        }\n        return this.applyMatches(matches);\n    }\n\n    /**\n     * Modify the current model by removing elements.\n     */\n    removeElements(elements: (string | { elementId: string, parentId: string })[]): Promise<void> {\n        const matches: Match[] = [];\n        const index = new SModelIndex();\n        index.add(this.currentRoot);\n        for (const e of elements) {\n            const anye: any = e;\n            if (anye.elementId !== undefined && anye.parentId !== undefined) {\n                const element = index.getById(anye.elementId);\n                if (element !== undefined) {\n                    matches.push({\n                        left: element,\n                        leftParentId: anye.parentId\n                    });\n                }\n            } else {\n                const element = index.getById(anye);\n                if (element !== undefined) {\n                    matches.push({\n                        left: element,\n                        leftParentId: this.currentRoot.id\n                    });\n                }\n            }\n        }\n        return this.applyMatches(matches);\n    }\n\n\n    // ----- Methods for handling incoming actions ----------------------------\n\n    handle(action: Action): void {\n        switch (action.kind) {\n            case RequestModelAction.KIND:\n                this.handleRequestModel(action as RequestModelAction);\n                break;\n            case ComputedBoundsAction.KIND:\n                this.computedBoundsApplicator.apply(this.currentRoot, action as ComputedBoundsAction);\n                break;\n            case RequestPopupModelAction.KIND:\n                this.handleRequestPopupModel(action as RequestPopupModelAction);\n                break;\n            case ExportSvgAction.KIND:\n                this.handleExportSvgAction(action as ExportSvgAction);\n                break;\n        }\n    }\n\n    protected handleRequestModel(action: RequestModelAction): void {\n        this.submitModel(this.currentRoot, false, action);\n    }\n\n    protected handleRequestPopupModel(action: RequestPopupModelAction): void {\n        if (this.popupModelProvider !== undefined) {\n            const element = findElement(this.currentRoot, action.elementId);\n            const popupRoot = this.popupModelProvider.getPopupModel(action, element);\n            if (popupRoot !== undefined) {\n                popupRoot.canvasBounds = action.bounds;\n                this.actionDispatcher.dispatch(SetPopupModelAction.create(popupRoot, action.requestId));\n            }\n        }\n    }\n\n    protected handleExportSvgAction(action: ExportSvgAction): void {\n        const blob = new Blob([action.svg], { type: 'text/plain;charset=utf-8' });\n        saveAs(blob, 'diagram.svg');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from 'inversify';\nimport { LoggingAction } from 'sprotty-protocol/lib/actions';\nimport { ILogger, LogLevel } from '../utils/logging';\nimport { TYPES } from '../base/types';\nimport { ModelSource } from './model-source';\n\n/**\n * A logger that forwards messages of type 'error', 'warn', and 'info' to the model source.\n */\n@injectable()\nexport class ForwardingLogger implements ILogger {\n\n    @inject(TYPES.ModelSourceProvider) protected modelSourceProvider: () => Promise<ModelSource>;\n    @inject(TYPES.LogLevel) public logLevel: LogLevel;\n\n    error(thisArg: any, message: string, ...params: any[]): void {\n        if (this.logLevel >= LogLevel.error)\n            this.forward(thisArg, message, LogLevel.error, params);\n    }\n\n    warn(thisArg: any, message: string, ...params: any[]): void {\n        if (this.logLevel >= LogLevel.warn)\n            this.forward(thisArg, message, LogLevel.warn, params);\n    }\n\n    info(thisArg: any, message: string, ...params: any[]): void {\n        if (this.logLevel >= LogLevel.info)\n            this.forward(thisArg, message, LogLevel.info, params);\n    }\n\n    log(thisArg: any, message: string, ...params: any[]): void {\n        if (this.logLevel >= LogLevel.log) {\n            // We cannot forward 'log' level messages since that would lead to endless loops\n            try {\n                const caller = typeof thisArg === 'object' ? thisArg.constructor.name : String(thisArg);\n                console.log.apply(thisArg, [caller + ': ' + message, ...params]);\n            } catch (error) {}\n        }\n    }\n\n    protected forward(thisArg: any, message: string, logLevel: LogLevel, params: any[]) {\n        const date = new Date();\n        const action = LoggingAction.create({\n            message,\n            severity: LogLevel[logLevel],\n            time: date.toLocaleTimeString(),\n            caller: typeof thisArg === 'object' ? thisArg.constructor.name : String(thisArg),\n            params: params.map(p => JSON.stringify(p))\n        });\n        this.modelSourceProvider().then(modelSource => {\n            try {\n                modelSource.handle(action);\n            } catch (error) {\n                try {\n                    console.log.apply(thisArg, [message, action, error]);\n                } catch (e) {}\n            }\n        });\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { ActionMessage } from 'sprotty-protocol/lib/actions';\nimport { DiagramServerProxy } from './diagram-server';\n\n/**\n * An external ModelSource that connects to the model provider using a websocket.\n */\n@injectable()\nexport class WebSocketDiagramServerProxy extends DiagramServerProxy {\n\n    protected webSocket?: WebSocket;\n\n    listen(webSocket: WebSocket): void {\n        webSocket.addEventListener('message', event => {\n            this.messageReceived(event.data);\n        });\n        webSocket.addEventListener('error', event => {\n            this.logger.error(this, 'error event received', event);\n        });\n        this.webSocket = webSocket;\n    }\n\n    disconnect() {\n        if (this.webSocket) {\n            this.webSocket.close();\n            this.webSocket = undefined;\n        }\n    }\n\n    protected sendMessage(message: ActionMessage): void {\n        if (this.webSocket) {\n            this.webSocket.send(JSON.stringify(message));\n        } else {\n            throw new Error('WebSocket is not connected');\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport interface RGBColor {\n    red: number\n    green: number\n    blue: number\n}\n\nexport function rgb(red: number, green: number, blue: number): RGBColor {\n    return {\n        red: red,\n        green: green,\n        blue: blue\n    };\n}\n\nexport function toSVG(c: RGBColor): string {\n    return 'rgb(' + c.red + ',' + c.green + ',' + c.blue + ')';\n}\n\nexport class ColorMap {\n\n    constructor(protected stops: RGBColor[]) {\n    }\n\n    getColor(t: number): RGBColor {\n        t = Math.max(0, Math.min(0.99999999, t));\n        const i = Math.floor(t * this.stops.length);\n        return this.stops[i];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n// ------------------ Base ------------------\n\nexport * from './base/actions/action';\nexport * from './base/actions/action-dispatcher';\nexport * from './base/actions/action-handler';\nexport * from './base/actions/diagram-locker';\n\nexport * from './base/animations/animation-frame-syncer';\nexport * from './base/animations/animation';\nexport * from './base/animations/easing';\n\nexport * from './base/commands/command';\nexport * from './base/commands/command-registration';\nexport * from './base/commands/command-stack-options';\nexport * from './base/commands/command-stack';\n\nexport * from './base/features/initialize-canvas';\nexport * from './base/features/set-model';\n\nexport * from './base/model/smodel-factory';\nexport * from './base/model/smodel-utils';\nexport * from './base/model/smodel';\n\nexport * from './base/ui-extensions/ui-extension-registry';\nexport * from './base/ui-extensions/ui-extension';\n\nexport * from './base/views/key-tool';\nexport * from './base/views/mouse-tool';\nexport * from './base/views/thunk-view';\nexport * from './base/views/view';\nexport * from './base/views/viewer-cache';\nexport * from './base/views/viewer-options';\nexport * from './base/views/viewer';\nexport * from './base/views/vnode-postprocessor';\nexport * from './base/views/vnode-utils';\n\nexport * from './base/types';\n\nimport defaultModule from './base/di.config';\nexport { defaultModule };\n\n\n// ------------------ Features ------------------\n\nexport * from './features/bounds/bounds-manipulation';\nexport * from './features/bounds/hidden-bounds-updater';\nexport * from './features/bounds/layout';\nexport * from './features/bounds/model';\nexport * from './features/bounds/vbox-layout';\nexport * from './features/bounds/hbox-layout';\nexport * from './features/bounds/stack-layout';\nexport * from './features/bounds/views';\n\nexport * from './features/button/button-handler';\nexport * from './features/button/model';\n\nexport * from './features/command-palette/action-providers';\nexport * from './features/command-palette/command-palette';\n\nexport * from './features/context-menu/context-menu-service';\nexport * from './features/context-menu/menu-providers';\nexport * from './features/context-menu/mouse-listener';\n\nexport * from './features/edge-layout/di.config';\nexport * from './features/edge-layout/edge-layout';\nexport * from './features/edge-layout/model';\n\nexport * from './features/edit/create';\nexport * from './features/edit/create-on-drag';\nexport * from './features/edit/di.config';\nexport * from './features/edit/delete';\nexport * from './features/edit/edit-label';\nexport * from './features/edit/edit-label-ui';\nexport * from './features/edit/edit-routing';\nexport * from './features/edit/model';\nexport * from './features/edit/reconnect';\n\nexport * from './features/expand/expand';\nexport * from './features/expand/model';\nexport * from './features/expand/views';\n\nexport * from './features/export/export';\nexport * from './features/export/model';\nexport * from './features/export/svg-exporter';\n\nexport * from './features/fade/fade';\nexport * from './features/fade/model';\n\nexport * from './features/hover/hover';\nexport * from './features/hover/model';\n\nexport * from './features/decoration/model';\nexport * from './features/decoration/views';\nexport * from './features/decoration/decoration-placer';\n\nexport * from './features/edge-intersection/intersection-finder';\nexport * from './features/edge-intersection/sweepline';\n\nexport * from './features/move/model';\nexport * from './features/move/move';\nexport * from './features/move/snap';\n\nexport * from './features/nameable/model';\n\nexport * from './features/open/open';\nexport * from './features/open/model';\n\nexport * from './features/projection/model';\nexport * from './features/projection/views';\n\nexport * from './features/routing/anchor';\nexport * from './features/routing/abstract-edge-router';\nexport * from './features/routing/bezier-anchors';\nexport * from './features/routing/bezier-edge-router';\nexport * from './features/routing/manhattan-anchors';\nexport * from './features/routing/manhattan-edge-router';\nexport * from './features/routing/model';\nexport * from './features/routing/polyline-anchors';\nexport * from './features/routing/polyline-edge-router';\nexport * from './features/routing/routing';\nexport * from './features/routing/views';\n\nexport * from './features/select/model';\nexport * from './features/select/select';\n\nexport * from './features/undo-redo/undo-redo';\n\nexport * from './features/update/model-matching';\nexport * from './features/update/update-model';\n\nexport * from './features/viewport/center-fit';\nexport * from './features/viewport/model';\nexport * from './features/viewport/scroll';\nexport * from './features/viewport/viewport-root';\nexport * from './features/viewport/viewport';\nexport * from './features/viewport/zoom';\n\nexport * from './features/zorder/zorder';\n\nimport boundsModule from './features/bounds/di.config';\nimport buttonModule from './features/button/di.config';\nimport commandPaletteModule from './features/command-palette/di.config';\nimport contextMenuModule from './features/context-menu/di.config';\nimport decorationModule from './features/decoration/di.config';\nimport edgeIntersectionModule from './features/edge-intersection/di.config';\nimport edgeLayoutModule from './features/edge-layout/di.config';\nimport expandModule from './features/expand/di.config';\nimport exportModule from './features/export/di.config';\nimport fadeModule from './features/fade/di.config';\nimport hoverModule from './features/hover/di.config';\nimport moveModule from './features/move/di.config';\nimport openModule from './features/open/di.config';\nimport routingModule from './features/routing/di.config';\nimport selectModule from './features/select/di.config';\nimport undoRedoModule from './features/undo-redo/di.config';\nimport updateModule from './features/update/di.config';\nimport viewportModule from './features/viewport/di.config';\nimport zorderModule from './features/zorder/di.config';\n\nexport {\n    boundsModule, buttonModule, commandPaletteModule, contextMenuModule, decorationModule,\n    edgeIntersectionModule, edgeLayoutModule, expandModule, exportModule, fadeModule, hoverModule, moveModule,\n    openModule, routingModule, selectModule, undoRedoModule, updateModule, viewportModule, zorderModule\n};\n\n// ------------------ Graph ------------------\n\nexport * from './graph/sgraph';\nexport * from './graph/views';\n\n\n// ------------------ Library ------------------\n\nexport * from './lib/modules';\nexport * from './lib/generic-views';\nexport * from './lib/html-views';\nexport * from './lib/jsx';\nexport * from './lib/model';\nexport * from './lib/svg-views';\n\n\n// ------------------ Model Source ------------------\n\nexport * from './model-source/commit-model';\nexport * from './model-source/diagram-server';\nexport * from './model-source/local-model-source';\nexport * from './model-source/logging';\nexport * from './model-source/model-source';\nexport * from './model-source/websocket';\n\nimport modelSourceModule from './model-source/di.config';\nexport { modelSourceModule };\n\n\n// ------------------ Utilities ------------------\n\nexport * from './utils/browser';\nexport * from './utils/codicon';\nexport * from './utils/color';\nexport * from './utils/geometry';\nexport * from './utils/inversify';\nexport * from './utils/logging';\nexport * from './utils/registry';\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/**\n * Simple implementation of the deferred pattern.\n * An object that exposes a promise and functions to resolve and reject it.\n */\nexport class Deferred<T> {\n    resolve: (value?: T | PromiseLike<T>) => void;\n    reject: (reason?: any) => void;\n    readonly promise: Promise<T>;\n    private _state: DeferredState = 'unresolved';\n\n\n    constructor() {\n        this.promise = new Promise<T>((resolve, reject) => {\n            this.resolve = resolve;\n            this.reject = reject;\n        });\n        this.promise.then(\n            res => this._state = 'resolved',\n            rej => this._state = 'rejected'\n        );\n    }\n\n    private set state(state: DeferredState) {\n        if (this._state === 'unresolved') {\n            this._state = state;\n        }\n    }\n\n    get state(): DeferredState {\n        return this._state;\n    }\n}\n\nexport type DeferredState = 'resolved' | 'rejected' | 'unresolved';\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport function isObject(data: unknown): data is Record<PropertyKey, unknown> {\n    return typeof data === 'object' && data !== null;\n}\n\nexport type TypeOf<T> =\n    T extends number ? 'number'\n    : T extends string ? 'string'\n    : T extends boolean ? 'boolean'\n    : T extends bigint ? 'bigint'\n    : T extends symbol ? 'symbol'\n    : T extends Function ? 'function'\n    : T extends object ? 'object'\n    : 'undefined';\n\nexport function hasOwnProperty<K extends PropertyKey, T>(arg: unknown, key: K | K[], type?: TypeOf<T> | ((v: unknown) => v is T)): arg is Record<K, T> {\n    if (!isObject(arg)) {\n        return false;\n    }\n    if (Array.isArray(key)) {\n        for (const k of key) {\n            if (!Object.prototype.hasOwnProperty.call(arg, k)) {\n                return false;\n            }\n            if (typeof type === 'string' && typeof arg[k] !== type) {\n                return false;\n            } else if (typeof type === 'function' && !type(arg[k])) {\n                return false;\n            }\n        }\n    } else {\n        if (!Object.prototype.hasOwnProperty.call(arg, key)) {\n            return false;\n        }\n        if (typeof type === 'string') {\n            return typeof arg[key] === type;\n        }\n        if (typeof type === 'function') {\n            return type(arg[key]);\n        }\n    }\n    return true;\n}\n\nexport function safeAssign<T extends {}>(target: T, partial: Partial<T>): T {\n    return Object.assign(target, partial);\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { hasOwnProperty } from \"./object\";\n\n/**\n * A Point is composed of the (x,y) coordinates of an object.\n */\nexport interface Point {\n    readonly x: number\n    readonly y: number\n}\n\nexport namespace Point {\n    /**\n     * (x,y) coordinates of the origin.\n     */\n    export const ORIGIN: Point = Object.freeze({\n        x: 0,\n        y: 0\n    });\n\n    /**\n     * Adds two points.\n     * @param {Point} p1 - First point\n     * @param {Point} p2 - Second point\n     * @returns {Point} The sum of the two points\n     */\n    export function add(p1: Point, p2: Point): Point {\n        return {\n            x: p1.x + p2.x,\n            y: p1.y + p2.y\n        };\n    }\n\n    /**\n     * Subtracts two points.\n     * @param {Point} p1 - First point\n     * @param {Point} p2 - Second point\n     * @returns {Point} The difference of the two points\n     */\n    export function subtract(p1: Point, p2: Point): Point {\n        return {\n            x: p1.x - p2.x,\n            y: p1.y - p2.y\n        };\n    }\n\n    /**\n     * Specifies whether a point has exactly the same coordinates as another point.\n     * @param {Point} point1 a point\n     * @param {Point} point2 another point\n     * @returns {boolean} `true` if `point1` has exactly the same `x` and `y` values as `point2`, `false` otherwise.\n     */\n    export function equals(point1: Point, point2: Point): boolean {\n        return point1.x === point2.x && point1.y === point2.y;\n    }\n\n    /**\n     * Computes a point that is the original `point` shifted towards `refPoint` by the given `distance`.\n     * @param {Point} point - Point to shift\n     * @param {Point} refPoint - Point to shift towards\n     * @param {Point} distance - Distance to shift\n     */\n    export function shiftTowards(point: Point, refPoint: Point, distance: number): Point {\n        const diff = subtract(refPoint, point);\n        const normalized = normalize(diff);\n        const shift = { x: normalized.x * distance, y: normalized.y * distance };\n        return add(point, shift);\n    }\n\n    /**\n     * Computes the normalized vector from the vector given in `point`; that is, computing its unit vector.\n     * @param {Point} point - Point representing the vector to be normalized\n     * @returns {Point} The normalized point\n     */\n    export function normalize(point: Point): Point {\n        const mag = magnitude(point);\n        if (mag === 0 || mag === 1) {\n            return ORIGIN;\n        }\n        return {\n            x: point.x / mag,\n            y: point.y / mag\n        };\n    }\n\n    /**\n     * Computes the magnitude of the vector given in `point`.\n     * @param {Point} point - Point representing the vector to compute the magnitude for\n     * @returns {number} The magnitude or also known as length of the `point`\n     */\n    export function magnitude(point: Point): number {\n        return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n    }\n\n    /**\n     * Calculates a linear combination of p0 and p1 using lambda, i.e.\n     *   (1-lambda) * p0 + lambda * p1\n     */\n    export function linear(p0: Point, p1: Point, lambda: number): Point {\n        return {\n            x: (1 - lambda) * p0.x + lambda * p1.x,\n            y: (1 - lambda) * p0.y + lambda * p1.y\n        };\n    }\n\n    /**\n     * Returns the \"straight line\" distance between two points.\n     * @param {Point} a - First point\n     * @param {Point} b - Second point\n     * @returns {number} The Eucledian distance\n     */\n    export function euclideanDistance(a: Point, b: Point): number {\n        const dx = b.x - a.x;\n        const dy = b.y - a.y;\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n\n    /**\n     * Returns the distance between two points in a grid, using a\n     * strictly vertical and/or horizontal path (versus straight line).\n     * @param {Point} a - First point\n     * @param {Point} b - Second point\n     * @returns {number} The Manhattan distance\n     */\n    export function manhattanDistance(a: Point, b: Point): number {\n        return Math.abs(b.x - a.x) + Math.abs(b.y - a.y);\n    }\n\n    /**\n     * Returns the maximum of the horizontal and the vertical distance.\n     * @param {Point} a - First point\n     * @param {Point} b - Second point\n     * @returns {number} The maximum distance\n     */\n    export function maxDistance(a: Point, b: Point): number {\n        return Math.max(Math.abs(b.x - a.x), Math.abs(b.y - a.y));\n    }\n}\n\n/**\n * Computes the angle in radians of the given point to the x-axis of the coordinate system.\n * The result is in the range [-pi, pi].\n * @param {Point} p - A point in the Eucledian plane\n */\nexport function angleOfPoint(p: Point): number {\n    return Math.atan2(p.y, p.x);\n}\n\n/**\n * Computes the angle in radians between the two given points (relative to the origin of the coordinate system).\n * The result is in the range [0, pi]. Returns NaN if the points are equal.\n * @param {Point} a - First point\n * @param {Point} b - Second point\n */\nexport function angleBetweenPoints(a: Point, b: Point): number {\n    const lengthProduct = Math.sqrt((a.x * a.x + a.y * a.y) * (b.x * b.x + b.y * b.y));\n    if (isNaN(lengthProduct) || lengthProduct === 0)\n        return NaN;\n    const dotProduct = a.x * b.x + a.y * b.y;\n    return Math.acos(dotProduct / lengthProduct);\n}\n\n/**\n * Computes the center of the line segment spanned by the two given points.\n * @param {Point} s - Start point of the line\n * @param {Point} e - End point of the line\n */\nexport function centerOfLine(s: Point, e: Point): Point {\n    const b: Bounds = {\n        x: s.x > e.x ? e.x : s.x,\n        y: s.y > e.y ? e.y : s.y,\n        width: Math.abs(e.x - s.x),\n        height: Math.abs(e.y - s.y)\n    };\n    return Bounds.center(b);\n}\n\n/**\n * The Dimension of an object is composed of its width and height.\n */\nexport interface Dimension {\n    readonly width: number\n    readonly height: number\n}\n\nexport namespace Dimension {\n    /**\n     * A dimension with both width and height set to a negative value, which is considered as undefined.\n     */\n    export const EMPTY: Dimension = Object.freeze({\n        width: -1,\n        height: -1\n    });\n\n    /**\n     * Checks whether the given dimention is valid, i.e. the width and height are non-zero.\n     * @param {Dimension} b - Dimension object\n     * @returns {boolean} `true` if the dimension is valid\n     */\n    export function isValid(d: Dimension): boolean {\n        return d.width >= 0 && d.height >= 0;\n    }\n}\n\n/**\n * The bounds are the position (x, y) and dimension (width, height) of an object.\n */\nexport interface Bounds extends Point, Dimension {\n}\n\nexport function isBounds(element: unknown): element is Bounds {\n    return hasOwnProperty(element, ['x', 'y', 'width', 'height']);\n}\n\nexport namespace Bounds {\n    export const EMPTY: Bounds = Object.freeze({\n        x: 0,\n        y: 0,\n        width: -1,\n        height: -1\n    });\n\n    /**\n     * Combines the bounds of two objects into one, so that the new bounds\n     * are the minimum bounds that covers both of the original bounds.\n     * @param {Bounds} b0 - First bounds object\n     * @param {Bounds} b1 - Second bounds object\n     * @returns {Bounds} The combined bounds\n     */\n    export function combine(b0: Bounds, b1: Bounds): Bounds {\n        if (!Dimension.isValid(b0))\n            return Dimension.isValid(b1) ? b1 : EMPTY;\n        if (!Dimension.isValid(b1))\n            return b0;\n        const minX = Math.min(b0.x, b1.x);\n        const minY = Math.min(b0.y, b1.y);\n        const maxX = Math.max(b0.x + (b0.width >= 0 ? b0.width : 0), b1.x + (b1.width >= 0 ? b1.width : 0));\n        const maxY = Math.max(b0.y + (b0.height >= 0 ? b0.height : 0), b1.y + (b1.height >= 0 ? b1.height : 0));\n        return {\n            x: minX, y: minY, width: maxX - minX, height: maxY - minY\n        };\n    }\n\n    /**\n     * Translates the given bounds.\n     * @param {Bounds} b - Bounds object\n     * @param {Point} p - Vector by which to translate the bounds\n     * @returns {Bounds} The translated bounds\n     */\n    export function translate(b: Bounds, p: Point): Bounds {\n        return {\n            x: b.x + p.x,\n            y: b.y + p.y,\n            width: b.width,\n            height: b.height\n        };\n    }\n\n    /**\n     * Returns the center point of the bounds of an object\n     * @param {Bounds} b - Bounds object\n     * @returns {Point} the center point\n     */\n    export function center(b: Bounds): Point {\n        return {\n            x: b.x + (b.width >= 0 ? 0.5 * b.width : 0),\n            y: b.y + (b.height >= 0 ? 0.5 * b.height : 0)\n        };\n    }\n\n    /**\n    * Checks whether the point p is included in the bounds b.\n    */\n    export function includes(b: Bounds, p: Point): boolean {\n        return p.x >= b.x && p.x <= b.x + b.width && p.y >= b.y && p.y <= b.y + b.height;\n    }\n}\n\n/**\n * Converts from radians to degrees\n * @param {number} a - A value in radians\n * @returns {number} The converted value\n */\nexport function toDegrees(a: number): number {\n    return a * 180 / Math.PI;\n}\n\n/**\n * Converts from degrees to radians\n * @param {number} a - A value in degrees\n * @returns {number} The converted value\n */\nexport function toRadians(a: number): number {\n    return a * Math.PI / 180;\n}\n\n/**\n * Returns whether two numbers are almost equal, within a small margin (0.001)\n * @param {number} a - First number\n * @param {number} b - Second number\n * @returns {boolean} True if the two numbers are almost equal\n */\nexport function almostEquals(a: number, b: number): boolean {\n    return Math.abs(a - b) < 1e-3;\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Alignable, BoundsAware, SModelElement, SModelRoot } from '../model';\nimport { ComputedBoundsAction } from '../actions';\n\n/**\n * Clone a given model. This function requires that the model is serializable, so it's\n * free of cycles and functions.\n */\nexport function cloneModel<T extends SModelElement>(model: T): T {\n    return JSON.parse(JSON.stringify(model));\n}\n\n/**\n * Apply the computed bounds to the given model. This ensures that the model has complete\n * information about positions and sizes derived from its actual rendering in the frontend.\n */\nexport function applyBounds(root: SModelRoot, action: ComputedBoundsAction) {\n    const index = new SModelIndex();\n    index.add(root);\n    for (const b of action.bounds) {\n        const element = index.getById(b.elementId);\n        if (element) {\n            const bae = element as SModelElement & BoundsAware;\n            if (b.newPosition) {\n                bae.position = { x: b.newPosition.x, y: b.newPosition.y };\n            }\n            if (b.newSize) {\n                bae.size = { width: b.newSize.width, height: b.newSize.height };\n            }\n        }\n    }\n    if (action.alignments) {\n        for (const a of action.alignments) {\n            const element = index.getById(a.elementId);\n            if (element) {\n                const alignable = element as SModelElement & Alignable;\n                alignable.alignment = { x: a.newAlignment.x, y: a.newAlignment.y };\n            }\n        }\n    }\n}\n\n/**\n * Model element types can include a colon to separate the basic type and a sub-type. This function\n * extracts the basic type of a model element.\n */\nexport function getBasicType(element: { type: string }): string {\n    if (!element.type) {\n        return '';\n    }\n    const colonIndex = element.type.indexOf(':');\n    return colonIndex >= 0 ? element.type.substring(0, colonIndex) : element.type;\n}\n\n/**\n * Model element types can include a colon to separate the basic type and a sub-type. This function\n * extracts the sub-type of a model element.\n */\nexport function getSubType(schema: { type: string }): string {\n    if (!schema.type) {\n        return '';\n    }\n    const colonIndex = schema.type.indexOf(':');\n    return colonIndex >= 0 ? schema.type.substring(colonIndex + 1) : schema.type;\n}\n\n/**\n * Find the element with the given identifier. If you need to find multiple elements, using an\n * `SModelIndex` might be more effective.\n */\nexport function findElement(parent: SModelElement, elementId: string): SModelElement | undefined {\n    if (parent.id === elementId)\n        return parent;\n    if (parent.children !== undefined) {\n        for (const child of parent.children) {\n            const result = findElement(child, elementId);\n            if (result !== undefined)\n                return result;\n        }\n    }\n    return undefined;\n}\n\n/**\n * Used to speed up model element lookup by id.\n * This index implementation is for the serializable _external model_ defined in `sprotty-protocol`.\n */\nexport class SModelIndex {\n\n    private readonly id2element: Map<string, SModelElement> = new Map();\n    private id2parent: Map<string, SModelElement> = new Map();\n\n    add(element: SModelElement): void {\n        if (!element.id) {\n            throw new Error(\"Model element has no ID.\");\n        } else if (this.contains(element)) {\n            throw new Error(\"Duplicate ID in model: \" + element.id);\n        }\n        this.id2element.set(element.id, element);\n        if (Array.isArray(element.children)) {\n            for (const child of element.children) {\n                this.add(child as any);\n                this.id2parent.set(child.id, element);\n            }\n        }\n    }\n\n    remove(element: SModelElement): void {\n        this.id2element.delete(element.id);\n        if (Array.isArray(element.children)) {\n            for (const child of element.children) {\n                this.id2parent.delete(child.id);\n                this.remove(child as any);\n            }\n        }\n    }\n\n    contains(element: SModelElement): boolean {\n        return this.id2element.has(element.id);\n    }\n\n    getById(id: string): SModelElement | undefined {\n        return this.id2element.get(id);\n    }\n\n    getParent(id: string): SModelElement | undefined {\n        return this.id2parent.get(id);\n    }\n\n    getRoot(element: SModelElement): SModelRoot {\n        let current: SModelElement | undefined = element;\n        while (current) {\n            const parent = this.id2parent.get(current.id);\n            if (parent === undefined) {\n                return current;\n            }\n            current = parent;\n        }\n        throw new Error(\"Element has no root\");\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { SModelRoot, SModelElement, Viewport } from './model';\nimport { Bounds, Point, Dimension } from './utils/geometry';\nimport { JsonAny, JsonMap } from './utils/json';\nimport { hasOwnProperty } from './utils/object';\n\n/**\n * Wrapper for actions when transferring them between client and server.\n * The `clientId` is used to identify the specific diagram instance in the client.\n */\nexport interface ActionMessage {\n    clientId: string\n    action: Action\n}\n\nexport function isActionMessage(object: unknown): object is ActionMessage {\n    return hasOwnProperty(object, 'action');\n}\n\n/**\n * An action describes a change to the model declaratively.\n * It is a plain data structure, and as such transferable between server and client.\n */\nexport interface Action {\n    kind: string;\n}\n\nexport function isAction(object?: unknown): object is Action {\n    return hasOwnProperty<string, string>(object, 'kind', 'string');\n}\n\n/**\n * A request action is tied to the expectation of receiving a corresponding response action.\n * The `requestId` property is used to match the received response with the original request.\n */\nexport interface RequestAction<Res extends ResponseAction> extends Action {\n    requestId: string\n\n    /**\n     * Used to ensure correct typing. Clients must not use this property\n     */\n    readonly _?: Res;\n}\n\nexport function isRequestAction(object?: Action): object is RequestAction<ResponseAction> {\n    return hasOwnProperty<string, string>(object, 'requestId', 'string');\n}\n\nlet requestContext = '';\nlet nextRequestId = 1;\n/**\n * Generate a unique `requestId` for a request action.\n */\nexport function generateRequestId(): string {\n    return `${requestContext}_${nextRequestId++}`;\n}\n\n/**\n * Configure the context in which request actions are created. This is typically either\n * 'client' or 'server' to avoid collisions of request IDs.\n */\nexport function setRequestContext(context: string): void {\n    requestContext = context;\n}\n\n/**\n * A response action is sent to respond to a request action. The `responseId` must match\n * the `requestId` of the preceding request. In case the `responseId` is empty or undefined,\n * the action is handled as standalone, i.e. it was fired without a preceding request.\n */\nexport interface ResponseAction extends Action {\n    responseId: string;\n}\n\n/**\n * A response action is sent to respond to a request action. The `responseId` must match\n * the `requestId` of the preceding request. In case the `responseId` is empty or undefined,\n * the action is handled as standalone, i.e. it was fired without a preceding request.\n */\n\nexport function isResponseAction(object?: Action): object is ResponseAction {\n    return hasOwnProperty<string, string>(object, 'responseId', 'string') && object.responseId !== '';\n}\n\n/**\n * A reject action is fired to indicate that a request must be rejected.\n */\nexport interface RejectAction extends ResponseAction {\n    kind: typeof RejectAction.KIND\n    message: string\n    detail?: JsonAny\n}\nexport namespace RejectAction {\n    export const KIND = 'rejectRequest';\n\n    export function create(options: { message: string, detail?: JsonAny, requestId: string }): RejectAction {\n        return {\n            kind: KIND,\n            message: options.message,\n            detail: options.detail,\n            responseId: options.requestId\n        };\n    }\n}\n\n/**\n * Sent from the client to the model source (e.g. a DiagramServer) in order to request a model. Usually this\n * is the first message that is sent to the source, so it is also used to initiate the communication.\n * The response is a SetModelAction or an UpdateModelAction.\n */\nexport interface RequestModelAction extends RequestAction<SetModelAction> {\n    kind: typeof RequestModelAction.KIND\n    options?: JsonMap\n}\nexport namespace RequestModelAction {\n    export const KIND = 'requestModel';\n\n    export function create(options?: JsonMap): RequestModelAction {\n        return {\n            kind: KIND,\n            options,\n            requestId: generateRequestId()\n        };\n    }\n}\n\n/**\n * Sent from the model source to the client in order to set the model. If a model is already present, it is replaced.\n */\nexport interface SetModelAction extends ResponseAction {\n    kind: typeof SetModelAction.KIND\n    newRoot: SModelRoot\n}\nexport namespace SetModelAction {\n    export const KIND = 'setModel';\n\n    export function create(newRoot: SModelRoot, requestId: string = ''): SetModelAction {\n        return {\n            kind: KIND,\n            newRoot,\n            responseId: requestId\n        };\n    }\n}\n\n/**\n * Sent from the model source to the client in order to update the model. If no model is present yet,\n * this behaves the same as a SetModelAction. The transition from the old model to the new one can be animated.\n */\nexport interface UpdateModelAction {\n    kind: typeof UpdateModelAction.KIND\n    newRoot?: SModelRoot\n    matches?: Match[]\n    animate?: boolean\n    cause?: Action\n}\nexport namespace UpdateModelAction {\n    export const KIND = 'updateModel';\n\n    export function create(input: SModelRoot | Match[], options: { animate?: boolean, cause?: Action } = {}): UpdateModelAction {\n        if (Array.isArray(input)) {\n            return {\n                kind: KIND,\n                matches: input,\n                animate: options.animate,\n                cause: options.cause\n            };\n        } else {\n            return {\n                kind: KIND,\n                newRoot: input,\n                animate: options.animate,\n                cause: options.cause\n            };\n        }\n    }\n}\n\nexport interface Match {\n    left?: SModelElement\n    right?: SModelElement\n    leftParentId?: string\n    rightParentId?: string\n}\n\n/**\n * Triggered when the user hovers the mouse pointer over an element to get a popup with details on\n * that element. This action is sent from the client to the model source, e.g. a DiagramServer.\n * The response is a SetPopupModelAction.\n */\nexport interface RequestPopupModelAction extends RequestAction<SetPopupModelAction> {\n    kind: typeof RequestPopupModelAction.KIND\n    elementId: string\n    bounds: Bounds\n}\nexport namespace RequestPopupModelAction {\n    export const KIND = 'requestPopupModel';\n\n    export function create(options: { elementId: string, bounds: Bounds }): RequestPopupModelAction {\n        return {\n            kind: KIND,\n            elementId: options.elementId,\n            bounds: options.bounds,\n            requestId: generateRequestId()\n        };\n    }\n}\n\n/**\n * Sent from the model source to the client to display a popup in response to a RequestPopupModelAction.\n * This action can also be used to remove any existing popup by choosing EMPTY_ROOT as root element.\n */\nexport interface SetPopupModelAction extends ResponseAction {\n    kind: typeof SetPopupModelAction.KIND\n    newRoot: SModelRoot\n}\nexport namespace SetPopupModelAction {\n    export const KIND = 'setPopupModel';\n\n    export function create(newRoot: SModelRoot, requestId: string = ''): SetPopupModelAction {\n        return {\n            kind: KIND,\n            newRoot,\n            responseId: requestId\n        };\n    }\n}\n\n/**\n * Sent from the model source (e.g. a DiagramServer) to the client to update the bounds of some\n * (or all) model elements.\n */\nexport interface SetBoundsAction extends Action {\n    kind: typeof SetBoundsAction.KIND\n    bounds: ElementAndBounds[]\n}\nexport namespace SetBoundsAction {\n    export const KIND = 'setBounds';\n\n    export function create(bounds: ElementAndBounds[]): SetBoundsAction {\n        return {\n            kind: KIND,\n            bounds\n        };\n    }\n}\n\n/**\n * Sent from the model source to the client to request bounds for the given model. The model is\n * rendered invisibly so the bounds can derived from the DOM. The response is a ComputedBoundsAction.\n * This hidden rendering round-trip is necessary if the client is responsible for parts of the layout\n * (see `needsClientLayout` viewer option).\n */\nexport interface RequestBoundsAction extends RequestAction<ComputedBoundsAction> {\n    kind: typeof RequestBoundsAction.KIND\n    newRoot: SModelRoot\n}\nexport namespace RequestBoundsAction {\n    export const KIND = 'requestBounds';\n\n    export function create(newRoot: SModelRoot): RequestBoundsAction {\n        return {\n            kind: KIND,\n            newRoot,\n            requestId: generateRequestId()\n        };\n    }\n}\n\n/**\n * Sent from the client to the model source (e.g. a DiagramServer) to transmit the result of bounds\n * computation as a response to a RequestBoundsAction. If the server is responsible for parts of\n * the layout (see `needsServerLayout` viewer option), it can do so after applying the computed bounds\n * received with this action. Otherwise there is no need to send the computed bounds to the server,\n * so they can be processed locally by the client.\n */\nexport interface ComputedBoundsAction extends ResponseAction {\n    kind: typeof ComputedBoundsAction.KIND\n    bounds: ElementAndBounds[]\n    revision?: number\n    alignments?: ElementAndAlignment[]\n}\nexport namespace ComputedBoundsAction {\n    export const KIND = 'computedBounds';\n\n    export function create(bounds: ElementAndBounds[], options: { revision?: number, alignments?: ElementAndAlignment[], requestId?: string } = {}): ComputedBoundsAction {\n        return {\n            kind: KIND,\n            bounds,\n            revision: options.revision,\n            alignments: options.alignments,\n            responseId: options.requestId ?? ''\n        };\n    }\n}\n\n/**\n * Associates new bounds with a model element, which is referenced via its id.\n */\nexport interface ElementAndBounds {\n    elementId: string\n    newPosition?: Point\n    newSize: Dimension\n}\n\n/**\n * Associates a new alignment with a model element, which is referenced via its id.\n */\nexport interface ElementAndAlignment {\n    elementId: string\n    newAlignment: Point\n}\n\n/**\n * Transport logging data to be stored elsewhere.\n */\nexport interface LoggingAction extends Action {\n    kind: typeof LoggingAction.KIND;\n    severity: string\n    time: string\n    caller: string\n    message: string\n    params: string[]\n}\nexport namespace LoggingAction {\n    export const KIND = 'logging';\n\n    export function create(options: { severity: string, time: string, caller: string, message: string, params: string[] }): LoggingAction {\n        return {\n            kind: KIND,\n            ...options\n        };\n    }\n}\n\n/**\n * Triggered when the user changes the selection, e.g. by clicking on a selectable element. The resulting\n * SelectCommand changes the `selected` state accordingly, so the elements can be rendered differently.\n * This action is also forwarded to the diagram server, if present, so it may react on the selection change.\n * Furthermore, the server can send such an action to the client in order to change the selection programmatically.\n */\nexport interface SelectAction {\n    kind: typeof SelectAction.KIND\n    selectedElementsIDs: string[]\n    deselectedElementsIDs: string[]\n}\nexport namespace SelectAction {\n    export const KIND = 'elementSelected';\n\n    export function create(options: { selectedElementsIDs?: string[], deselectedElementsIDs?: string[] }): SelectAction {\n        return {\n            kind: KIND,\n            selectedElementsIDs: options.selectedElementsIDs ?? [],\n            deselectedElementsIDs: options.deselectedElementsIDs ?? []\n        };\n    }\n}\n\n/**\n * Programmatic action for selecting or deselecting all elements.\n * If `select` is true, all elements are selected, otherwise they are deselected.\n */\nexport interface SelectAllAction {\n    kind: typeof SelectAllAction.KIND\n    select: boolean\n}\nexport namespace SelectAllAction {\n    export const KIND = 'allSelected';\n\n    export function create(options: { select?: boolean } = {}): SelectAllAction {\n        return {\n            kind: KIND,\n            select: options.select ?? true\n        };\n    }\n}\n\n/**\n * Request action for retrieving the current selection.\n */\nexport interface GetSelectionAction extends RequestAction<SelectionResult> {\n    kind: typeof GetSelectionAction.KIND\n}\nexport namespace GetSelectionAction {\n    export const KIND = 'getSelection';\n\n    export function create(): GetSelectionAction {\n        return {\n            kind: KIND,\n            requestId: generateRequestId()\n        };\n    }\n}\n\n/**\n * Result for a `GetSelectionAction`.\n */\nexport interface SelectionResult extends ResponseAction {\n    kind: typeof SelectionResult.KIND\n    selectedElementsIDs: string[]\n}\nexport namespace SelectionResult {\n    export const KIND = 'selectionResult';\n\n    export function create(selectedElementsIDs: string[], requestId: string): SelectionResult {\n        return {\n            kind: KIND,\n            selectedElementsIDs,\n            responseId: requestId\n        };\n    }\n}\n\n/**\n * Sent from the client to the model source to recalculate a diagram when elements\n * are collapsed/expanded by the client.\n */\nexport interface CollapseExpandAction {\n    kind: typeof CollapseExpandAction.KIND\n    expandIds: string[]\n    collapseIds: string[]\n}\nexport namespace CollapseExpandAction {\n    export const KIND = 'collapseExpand';\n\n    export function create(options: { expandIds?: string[], collapseIds?: string[] }): CollapseExpandAction {\n        return {\n            kind: KIND,\n            expandIds: options.expandIds ?? [],\n            collapseIds: options.collapseIds ?? []\n        };\n    }\n}\n\n/**\n * Programmatic action for expanding or collapsing all elements.\n * If `expand` is true, all elements are expanded, otherwise they are collapsed.\n */\nexport interface CollapseExpandAllAction {\n    kind: typeof CollapseExpandAllAction.KIND\n    expand: boolean\n}\nexport namespace CollapseExpandAllAction {\n    export const KIND = 'collapseExpandAll';\n\n    export function create(options: { expand?: boolean } = {}): CollapseExpandAllAction {\n        return {\n            kind: KIND,\n            expand: options.expand ?? true\n        };\n    }\n}\n\nexport interface OpenAction {\n    kind: typeof OpenAction.KIND\n    elementId: string\n}\nexport namespace OpenAction {\n    export const KIND = 'open';\n\n    export function create(elementId: string): OpenAction {\n        return {\n            kind: KIND,\n            elementId\n        };\n    }\n}\n\n/**\n * Request a layout of the diagram or the selected elements only.\n */\nexport interface LayoutAction {\n    kind: typeof LayoutAction.KIND\n    layoutType?: string\n    elementIds?: string[]\n}\nexport namespace LayoutAction {\n    export const KIND = 'layout';\n\n    export function create(options: { layoutType?: string, elementIds?: string[] } = {}): LayoutAction {\n        return {\n            kind: KIND,\n            layoutType: options.layoutType,\n            elementIds: options.elementIds\n        };\n    }\n}\n\n/**\n * Triggered when the user requests the viewer to center on the current model. The resulting\n * CenterCommand changes the scroll setting of the viewport accordingly.\n * It also resets the zoom to its default if retainZoom is false.\n * This action can also be sent from the model source to the client in order to perform such a\n * viewport change programmatically.\n */\nexport interface CenterAction extends Action {\n    kind: typeof CenterAction.KIND\n    elementIds: string[]\n    animate: boolean\n    retainZoom: boolean\n    zoomScale?: number\n}\nexport namespace CenterAction {\n    export const KIND = 'center';\n\n    export function create(elementIds: string[], options: { animate?: boolean, retainZoom?: boolean, zoomScale?: number } = {}): CenterAction {\n        return {\n            kind: KIND,\n            elementIds,\n            animate: options.animate ?? true,\n            retainZoom: options.retainZoom ?? false,\n            zoomScale: options.zoomScale\n        };\n    }\n}\n\n/**\n * Triggered when the user requests the viewer to fit its content to the available drawing area.\n * The resulting FitToScreenCommand changes the zoom and scroll settings of the viewport so the model\n * can be shown completely. This action can also be sent from the model source to the client in order\n * to perform such a viewport change programmatically.\n */\nexport interface FitToScreenAction extends Action {\n    kind: typeof FitToScreenAction.KIND;\n    elementIds: string[]\n    padding?: number\n    maxZoom?: number\n    animate: boolean\n}\nexport namespace FitToScreenAction {\n    export const KIND = 'fit';\n\n    export function create(elementIds: string[], options: { padding?: number, maxZoom?: number, animate?: boolean } = {}): FitToScreenAction {\n        return {\n            kind: KIND,\n            elementIds,\n            padding: options.padding,\n            maxZoom: options.maxZoom,\n            animate: options.animate ?? true\n        };\n    }\n}\n\n/**\n * Directly set the diagram viewport to the given scroll and zoom values.\n * The ID of the viewport element to manipulate must be given with the action\n * (usually it is the root element's ID).\n */\nexport interface SetViewportAction extends Action {\n    kind: typeof SetViewportAction.KIND;\n    elementId: string\n    newViewport: Viewport\n    animate: boolean\n}\nexport namespace SetViewportAction {\n    export const KIND = 'viewport';\n\n    export function create(elementId: string, newViewport: Viewport, options: { animate?: boolean } = {}): SetViewportAction {\n        return {\n            kind: KIND,\n            elementId,\n            newViewport,\n            animate: options.animate ?? true\n        };\n    }\n}\n\n/**\n * Request action for retrieving the current viewport and canvas bounds.\n */\nexport interface GetViewportAction extends RequestAction<ViewportResult> {\n    kind: typeof GetViewportAction.KIND;\n}\nexport namespace GetViewportAction {\n    export const KIND = 'getViewport';\n\n    export function create(): GetViewportAction {\n        return {\n            kind: KIND,\n            requestId: generateRequestId()\n        };\n    }\n}\n\n/**\n * Response to a `GetViewportAction`.\n */\nexport interface ViewportResult extends ResponseAction {\n    kind: typeof ViewportResult.KIND;\n    viewport: Viewport\n    canvasBounds: Bounds\n}\nexport namespace ViewportResult {\n    export const KIND = 'viewportResult';\n\n    export function create(viewport: Viewport, canvasBounds: Bounds, requestId: string): ViewportResult {\n        return {\n            kind: KIND,\n            viewport,\n            canvasBounds,\n            responseId: requestId\n        };\n    }\n}\n\n/**\n * Action to render the selected elements in front of others by manipulating the z-order.\n */\nexport interface BringToFrontAction extends Action {\n    kind: typeof BringToFrontAction.KIND;\n    elementIDs: string[]\n}\nexport namespace BringToFrontAction {\n    export const KIND = 'bringToFront';\n\n    export function create(elementIDs: string[]): BringToFrontAction {\n        return {\n            kind: KIND,\n            elementIDs\n        };\n    }\n}\n\n/**\n * Undo the previous operation on the stack of operations.\n */\nexport interface UndoAction extends Action {\n    kind: typeof UndoAction.KIND;\n}\nexport namespace UndoAction {\n    export const KIND = 'undo';\n\n    export function create(): UndoAction {\n        return {\n            kind: KIND\n        };\n    }\n}\n\n/**\n * Redo a previously undone operation.\n */\nexport interface RedoAction extends Action {\n    kind: typeof RedoAction.KIND;\n}\nexport namespace RedoAction {\n    export const KIND = 'redo';\n\n    export function create(): RedoAction {\n        return {\n            kind: KIND\n        };\n    }\n}\n\n/**\n * Move an arbitrary set of elements to new positions.\n */\nexport interface MoveAction extends Action {\n    kind: typeof MoveAction.KIND\n    moves: ElementMove[]\n    animate: boolean\n    finished: boolean\n}\nexport namespace MoveAction {\n    export const KIND = 'move';\n\n    export function create(moves: ElementMove[], options: { animate?: boolean, finished?: boolean } = {}): MoveAction {\n        return {\n            kind: KIND,\n            moves,\n            animate: options.animate ?? true,\n            finished: options.finished ?? false\n        };\n    }\n}\n\nexport interface ElementMove {\n    elementId: string\n    elementType?: string\n    fromPosition?: Point\n    toPosition: Point\n}\n\n/**\n * Triggered when the user puts the mouse pointer over an element.\n */\nexport interface HoverFeedbackAction extends Action {\n    kind: typeof HoverFeedbackAction.KIND\n    mouseoverElement: string\n    mouseIsOver: boolean\n}\nexport namespace HoverFeedbackAction {\n    export const KIND = 'hoverFeedback';\n\n    export function create(options: { mouseoverElement: string, mouseIsOver: boolean }): HoverFeedbackAction {\n        return {\n            kind: KIND,\n            mouseoverElement: options.mouseoverElement,\n            mouseIsOver: options.mouseIsOver\n        };\n    }\n}\n\n/**\n * Create an element with the given schema and add it to the diagram.\n */\nexport interface CreateElementAction extends Action {\n    kind: typeof CreateElementAction.KIND\n    containerId: string\n    elementSchema: SModelElement\n}\nexport namespace CreateElementAction {\n    export const KIND = 'createElement';\n\n    export function create(elementSchema: SModelElement, options: { containerId: string }): CreateElementAction {\n        return {\n            kind: KIND,\n            elementSchema,\n            containerId: options.containerId\n        };\n    }\n}\n\n/**\n * Delete a set of elements identified by their IDs.\n */\nexport interface DeleteElementAction extends Action {\n    kind: typeof DeleteElementAction.KIND\n    elementIds: string[]\n}\nexport namespace DeleteElementAction {\n    export const KIND = 'delete';\n\n    export function create(elementIds: string[]): DeleteElementAction {\n        return {\n            kind: KIND,\n            elementIds\n        };\n    }\n}\n\n/**\n * Apply a text change to a label element.\n */\nexport interface ApplyLabelEditAction extends Action {\n    kind: typeof ApplyLabelEditAction.KIND;\n    labelId: string,\n    text: string\n}\nexport namespace ApplyLabelEditAction {\n    export const KIND = 'applyLabelEdit';\n\n    export function create(labelId: string, text: string): ApplyLabelEditAction {\n        return {\n            kind: KIND,\n            labelId,\n            text\n        };\n    }\n}\n\n/**\n * Change the source or target node of a routable element (edge of a graph).\n */\nexport interface ReconnectAction extends Action {\n    kind: typeof ReconnectAction.KIND\n    routableId: string\n    newSourceId?: string\n    newTargetId?: string\n}\nexport namespace ReconnectAction {\n    export const KIND = 'reconnect';\n\n    export function create(options: { routableId: string, newSourceId?: string, newTargetId?: string }): ReconnectAction {\n        return {\n            kind: KIND,\n            routableId: options.routableId,\n            newSourceId: options.newSourceId,\n            newTargetId: options.newTargetId\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/** Helper type to describe any defined object*/\nexport type AnyObject = object;\n\nexport namespace AnyObject {\n    /**\n     * Type guard to check wether a given object is of type {@link AnyObject}.\n     * @param object The object to check.\n     * @returns The given object as {@link AnyObject} or `false`.\n     */\n    export function is(object: unknown): object is AnyObject {\n        // eslint-disable-next-line no-null/no-null\n        return object !== null && typeof object === 'object';\n    }\n}\n\n/**\n * Utility type to capture all primitive types.\n */\nexport type Primitive = string | number | boolean | bigint | symbol | undefined | null;\n\n/**\n * Utility type to describe objects that have a constructor function i.e. classes.\n */\nexport interface Constructor<T, A extends any[] = any[]> {\n    new (...args: A): T;\n}\n\n/**\n * Utility type to declare a given type `T` as writable. Essentially this removes\n * all readonly modifiers of the type`s properties. Please use with care and only in instances\n * where you know that overwriting a readonly property is safe and doesn't cause unknown unintended side effects.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport type Writable<T> = { -readonly [P in keyof T]: Writable<T[P]> };\n\n/**\n * Utility type to describe a value as might be provided as a promise.\n */\nexport type MaybePromise<T> = T | PromiseLike<T>;\n\n/**\n * Utility type to describe typeguard functions.\n */\nexport type TypeGuard<T> = (element: any) => element is T;\n\n/**\n * Utility function that create a typeguard function for a given class constructor.\n * Essentially this wraps an instance of check as typeguard function.\n * @param constructor The constructor of the class for which the typeguard should be created.\n * @returns The typeguard for this class.\n */\nexport function toTypeGuard<G>(constructor: Constructor<G>): TypeGuard<G> {\n    return (element: any): element is G => element instanceof constructor;\n}\n\n/**\n * Utility type that represents an arbitrary function. Should be used instead\n * of the default `Function` type which is considered to be unsafe.\n */\nexport type SafeFunction<T = any> = (...args: any[]) => T;\n\n/**\n * Validates whether the given object has a property of type `string` with the given key.\n * @param object The object that should be validated\n * @param propertyKey The key of the property\n * @param optional Flag to indicate wether the property can be optional i.e. also return true if the given key is undefined\n * @returns `true` if the object has property with matching key of type `string`.\n */\nexport function hasStringProp(object: AnyObject, propertyKey: string, optional = false): boolean {\n    const property = (object as any)[propertyKey];\n    return property !== undefined ? typeof property === 'string' : optional;\n}\n\n/**\n * Validates whether the given object has a property of type `boolean` with the given key.\n * @param object The object that should be validated\n * @param propertyKey The key of the property\n * @param optional Flag to indicate wether the property can be optional i.e. also return true if the given key is undefined\n * @returns `true` if the object has property with matching key of type `boolean`.\n */\nexport function hasBooleanProp(object: AnyObject, propertyKey: string, optional = false): boolean {\n    const property = (object as any)[propertyKey];\n    return property !== undefined ? typeof property === 'boolean' : optional;\n}\n\n/**\n * Validates whether the given object has a property of type `number` with the given key.\n * @param object The object that should be validated\n * @param propertyKey The key of the property\n * @param optional Flag to indicate wether the property can be optional i.e. also return true if the given key is undefined\n * @returns `true` if the object has property with matching key of type `number`.\n */\nexport function hasNumberProp(object: AnyObject, propertyKey: string, optional = false): boolean {\n    const property = (object as any)[propertyKey];\n    return property !== undefined ? typeof property === 'number' : optional;\n}\n\n/**\n * Validates whether the given object has a property of type `object` with the given key.\n * @param object The object that should be validated\n * @param propertyKey The key of the property\n * @param optional Flag to indicate wether the property can be optional i.e. also return true if the given key is undefined\n * @returns `true` if the object has property with matching key of type `object`.\n */\nexport function hasObjectProp<T extends string>(object: AnyObject, propertyKey: T, optional = false): boolean {\n    const property = (object as any)[propertyKey];\n    return property !== undefined ? AnyObject.is(property) : optional;\n}\n\n/**\n * Validates whether the given object has a property of type `function` with the given key.\n * @param object The object that should be validated\n * @param propertyKey The key of the property\n * @param optional Flag to indicate wether the property can be optional i.e. also return true if the given key is undefined\n * @returns `true` if the object has property with matching key of type `function`.\n */\nexport function hasFunctionProp(object: AnyObject, propertyKey: string, optional = false): boolean {\n    const property = (object as any)[propertyKey];\n    return property !== undefined ? typeof property === 'function' : optional;\n}\n\n/**\n * Validates whether the given object has a property of type `Array` with the given key.\n * @param object The object that should be validated\n * @param propertyKey The key of the property\n * @param optional Flag to indicate wether the property can be optional i.e. also return true if the given key is undefined\n * @returns `true` if the object has property with matching key of type `Array`.\n */\nexport function hasArrayProp(object: AnyObject, propertyKey: string, optional = false): boolean {\n    const property = (object as any)[propertyKey];\n    return property !== undefined ? Array.isArray(property) : optional;\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport * as sprotty from 'sprotty-protocol/lib/actions';\nimport { AnyObject, TypeGuard, hasArrayProp, hasStringProp } from '../utils/type-util';\n\n/**\n * An action is a declarative description of a behavior that shall be invoked by the receiver upon receipt of the action.\n * It is a plain data structure, and as such transferable between server and client. An action must never contain actual\n * SModelElement instances, but either refer to them via their ids or contain serializable schema for model elements.\n * Additional typeguard functions are provided via the corresponding namespace.\n */\nexport interface Action extends sprotty.Action {\n    /**\n     * Unique identifier specifying the kind of action to process.\n     */\n    kind: string;\n}\n\nexport namespace Action {\n    export function is(object: any): object is Action {\n        return AnyObject.is(object) && hasStringProp(object, 'kind');\n    }\n    /**\n     * Typeguard function to check wether the given object is an {@link Action} with the given `kind`.\n     * @param object The object to check.\n     * @param kind  The expected action kind.\n     * @returns A type literal indicating wether the given object is an action with the given kind.\n     */\n    export function hasKind(object: any, kind: string): object is Action {\n        return Action.is(object) && object.kind === kind;\n    }\n}\n\n/**\n * A general message serves as an envelope carrying an action to be transmitted between the client and the server via a DiagramServer.\n * @typeParam A the {@link Action} type that is contained by this message.\n * A typeguard function is provided via the corresponding namespace.\n */\nexport interface ActionMessage<A extends Action = Action> extends sprotty.ActionMessage {\n    /**\n     * The unique client id\n     *  */\n    clientId: string;\n\n    /**\n     * The action to execute.\n     */\n    action: A;\n}\n\nexport namespace ActionMessage {\n    export function is<A extends Action>(object: any, typeguard?: TypeGuard<A>): object is ActionMessage<A> {\n        const actionGuard = typeguard ?? Action.is;\n        return AnyObject.is(object) && hasStringProp(object, 'clientId') && 'action' in object && actionGuard(object.action);\n    }\n}\n\n/**\n * A request action is tied to the expectation of receiving a corresponding response action. The requestId property is used to match the\n * received response with the original request. Typically its not necessary to create an explicit requestId. The requestId can be set\n * to an empty string. The action dispatcher than auto generates an request id if needed (i.e. the action was dispatched as request).\n *\n\n * A typeguard function, and a generic helper function to generate a request id are provided via the corresponding namespace.\n */\nexport interface RequestAction<Res extends ResponseAction> extends Action, sprotty.RequestAction<Res> {\n    /**\n     * Unique id for this request. In order to match a response to this request, the response needs to have the same id.\n     */\n    requestId: string;\n    /**\n     * Used to ensure correct typing. Clients must not use this property\n     */\n    readonly _?: Res;\n}\n\nexport namespace RequestAction {\n    export function is(object: any): object is RequestAction<ResponseAction> {\n        return Action.is(object) && hasStringProp(object, 'requestId');\n    }\n\n    /**\n     * Typeguard function to check wether the given object is an {@link RequestAction} with the given `kind`.\n     * @param object The object to check.\n     * @param kind  The expected action kind.\n     * @returns A type literal indicating wether the given object is a request action with the given kind.\n     */\n    export function hasKind(object: any, kind: string): object is Action {\n        return RequestAction.is(object) && object.kind === kind;\n    }\n\n    export function generateRequestId(): string {\n        return sprotty.generateRequestId();\n    }\n}\n\n/**\n * A response action is sent to respond to a request action. The responseId must match the requestId of the preceding request.\n * In case the responseId is empty, the action is handled as standalone, i.e. it was fired without a preceding request.\n * The action dispatcher of the GLSP server has a special handling for {@link RequestAction} handlers\n * and automatically sets the `responseId` of the corresponding responseAction. So on the server side its typically enough\n * to set the `responseId` to an empty string and rely on the `ActionDispatcher` for assigning the correct `responseId.\n * Additional typeguard functions are provided via the corresponding namespace.\n */\nexport interface ResponseAction extends Action, sprotty.ResponseAction {\n    /**\n     * Id corresponding to the request this action responds to.\n     */\n    responseId: string;\n}\n\nexport namespace ResponseAction {\n    export function is(object: any): object is ResponseAction {\n        return Action.is(object) && hasStringProp(object, 'responseId');\n    }\n\n    /**\n     * Typeguard function to check wether the given object is an {@link ResponseAction} with a non-empty response id.\n     * @param object The object to check.\n     * @returns A type literal indicating wether the given object is a response action with a non-empty response id.\n     */\n    export function hasValidResponseId(object: any): object is ResponseAction {\n        return ResponseAction.is(object) && object.responseId !== '';\n    }\n}\n\n/**\n * A reject action is a {@link ResponseAction} fired to indicate that a certain {@link ResponseAction}\n * has been rejected.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `RejectActions`.\n */\nexport interface RejectAction extends ResponseAction, sprotty.RejectAction {\n    kind: typeof RejectAction.KIND;\n    /**\n     * A human-readable description of the reject reason. Typically this is an error message\n     * that has been thrown when handling the corresponding {@link RequestAction}.\n     */\n    message: string;\n    /**\n     * Optional additional details.\n     */\n    detail?: string;\n}\n\nexport namespace RejectAction {\n    export const KIND = 'rejectRequest';\n\n    export function is(object: unknown): object is RejectAction {\n        return Action.hasKind(object, RejectAction.KIND) && hasStringProp(object, 'message');\n    }\n\n    export function create(message: string, options: { detail?: string; responseId?: string } = {}): RejectAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            message,\n            ...options\n        };\n    }\n}\n\n/**\n * Operations are actions that denote requests from the client to _modify_ the model. Model modifications are always performed by the\n * server. After a successful modification, the server sends the updated model back to the client using the `UpdateModelAction`.\n * An operation contains a dedicated `isOperation` property that is used as a discriminator. This is necessary so that the server\n * can distinguish between plain actions and operations.\n * The corresponding namespace offers a helper function for type guard checks.\n */\nexport interface Operation extends Action {\n    /**\n     * Discriminator property to make operations distinguishable from plain {@link Action}s.\n     */\n    isOperation: true;\n}\n\nexport namespace Operation {\n    export function is(object: unknown): object is Operation {\n        return Action.is(object) && 'isOperation' in object && object.isOperation === true;\n    }\n\n    /**\n     * Typeguard function to check wether the given object is an {@link Operation} with the given `kind`.\n     * @param object The object to check.\n     * @param kind  The expected operation kind.\n     * @returns A type literal indicating wether the given object is an operation with the given kind.\n     */\n    export function hasKind(object: unknown, kind: string): object is Operation {\n        return Operation.is(object) && object.kind === kind;\n    }\n}\n\n/**\n * An operation that executes a list of sub-operations.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `CompoundOperations`.\n */\nexport interface CompoundOperation extends Operation {\n    kind: typeof CompoundOperation.KIND;\n    /**\n     * List of operations that should be executed.\n     */\n    operationList: Operation[];\n}\n\nexport namespace CompoundOperation {\n    export const KIND = 'compound';\n\n    export function is(object: unknown): object is CompoundOperation {\n        return Operation.hasKind(object, KIND) && hasArrayProp(object, 'operationList');\n    }\n\n    export function create(operationList: Operation[]): CompoundOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            operationList\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { hasStringProp } from '../utils/type-util';\nimport { Action } from './base-protocol';\n\n/**\n * Sent by the server (or the client) to signal a status change.\n * If a timeout is given the respective status should disappear after the timeout is reached.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `StatusAction`s.\n */\nexport interface StatusAction extends Action {\n    kind: typeof StatusAction.KIND;\n    /**\n     * The severity of the status.\n     */\n    severity: SeverityLevel;\n\n    /**\n     * The user-facing message describing the status.\n     */\n    message: string;\n\n    /**\n     * Timeout after which a displayed status should disappear.\n     */\n    timeout?: number;\n}\n\nexport namespace StatusAction {\n    export const KIND = 'status';\n\n    export function is(object: unknown): object is StatusAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'severity') && hasStringProp(object, 'message');\n    }\n\n    export function create(message: string, options: { severity?: SeverityLevel; timeout?: number } = {}): StatusAction {\n        return {\n            kind: KIND,\n            severity: 'INFO',\n            message,\n            ...options\n        };\n    }\n}\n\n/**\n * The possible server status severity levels.\n */\n\nexport type SeverityLevel = 'NONE' | 'INFO' | 'WARNING' | 'ERROR' | 'FATAL' | 'OK';\n\n/**\n * Sent by the server (or the client) to notify the user about something of interest. Typically this message is handled by\n * the client by showing a message to the user with the application's message service.\n * If a timeout is given the respective message should disappear after the timeout is reached.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `MessageAction`s.\n */\nexport interface MessageAction extends Action {\n    kind: typeof MessageAction.KIND;\n\n    severity: SeverityLevel;\n\n    /**\n     * The message that shall be shown to the user.\n     */\n    message: string;\n\n    /**\n     * Further details on the message.\n     */\n    details?: string;\n}\n\nexport namespace MessageAction {\n    export const KIND = 'message';\n\n    export function is(object: unknown): object is MessageAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'message') && hasStringProp(object, 'severity');\n    }\n\n    export function create(\n        message: string,\n        options: {\n            severity?: SeverityLevel;\n            details?: string;\n        } = {}\n    ): MessageAction {\n        return {\n            kind: KIND,\n            message,\n            severity: 'INFO',\n            ...options\n        };\n    }\n}\n\n/**\n * Sent to request presenting the progress of a long running process in the UI.\n */\nexport interface StartProgressAction extends Action {\n    kind: typeof StartProgressAction.KIND;\n\n    /**\n     * An ID that can be used in subsequent `updateProgress` and `endProgress` events to make them refer to the same progress reporting.\n     */\n    progressId: string;\n    /**\n     * Short title of the progress reporting. Shown in the UI to describe the long running process.\n     */\n    title: string;\n    /**\n     * Optional additional progress message. Shown in the UI to describe the long running process.\n     */\n    message?: string;\n    /**\n     * Progress percentage to display (value range: 0 to 100). If omitted no percentage is shown.\n     */\n    percentage?: number;\n}\n\nexport namespace StartProgressAction {\n    export const KIND = 'startProgress';\n\n    export function is(object: unknown): object is StartProgressAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'progressId') && hasStringProp(object, 'title');\n    }\n\n    export function create(options: { progressId: string; title: string; message?: string; percentage?: number }): StartProgressAction {\n        return {\n            kind: KIND,\n            ...options\n        };\n    }\n}\n\n/**\n * Sent to presenting an update of the progress of a long running process in the UI.\n */\nexport interface UpdateProgressAction extends Action {\n    kind: typeof UpdateProgressAction.KIND;\n\n    /**\n     * The ID of the progress reporting to update.\n     */\n    progressId: string;\n    /**\n     * The message to show in the progress reporting.\n     */\n    message?: string;\n    /**\n     * The percentage (value range: 0 to 100) to show in the progress reporting.\n     */\n    percentage?: number;\n}\n\nexport namespace UpdateProgressAction {\n    export const KIND = 'updateProgress';\n\n    export function is(object: unknown): object is UpdateProgressAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'progressId');\n    }\n\n    export function create(\n        progressId: string,\n        options: {\n            message?: string;\n            percentage?: number;\n        } = {}\n    ): UpdateProgressAction {\n        return {\n            kind: KIND,\n            progressId,\n            ...options\n        };\n    }\n}\n\n/**\n * Sent to end the reporting of a progress.\n */\nexport interface EndProgressAction extends Action {\n    kind: typeof EndProgressAction.KIND;\n\n    /**\n     * The ID of the progress reporting to update.\n     */\n    progressId: string;\n    /**\n     * The message to show in the progress reporting.\n     */\n    message?: string;\n}\n\nexport namespace EndProgressAction {\n    export const KIND = 'endProgress';\n\n    export function is(object: unknown): object is EndProgressAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'progressId');\n    }\n\n    export function create(progressId: string, message?: string): EndProgressAction {\n        return {\n            kind: KIND,\n            progressId,\n            message\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { hasObjectProp } from '../utils/type-util';\nimport { Action, Operation, RequestAction, ResponseAction } from './base-protocol';\nimport { EditorContext } from './types';\n\n/**\n * Requests the clipboard data for the current editor context, i.e., the selected elements, in a clipboard-compatible format.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `RequestClipboardDataActions`.\n */\nexport interface RequestClipboardDataAction extends RequestAction<SetClipboardDataAction> {\n    kind: typeof RequestClipboardDataAction.KIND;\n\n    editorContext: EditorContext;\n}\n\nexport namespace RequestClipboardDataAction {\n    export const KIND = 'requestClipboardData';\n\n    export function is(object: unknown): object is RequestClipboardDataAction {\n        return RequestAction.hasKind(object, KIND) && hasObjectProp(object, 'editorContext');\n    }\n\n    export function create(editorContext: EditorContext, options: { requestId?: string } = {}): RequestClipboardDataAction {\n        return {\n            kind: KIND,\n            requestId: '',\n            editorContext,\n            ...options\n        };\n    }\n}\n\n/**\n * Server response to a {@link RequestClipboardDataAction} containing the selected elements as clipboard-compatible format.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetClipboardDataActions`.\n */\nexport interface SetClipboardDataAction extends ResponseAction {\n    kind: typeof SetClipboardDataAction.KIND;\n\n    /**\n     * The data to be added into the clipboard. This data will be sent back to the server on paste.\n     */\n    clipboardData: ClipboardData;\n}\n\nexport namespace SetClipboardDataAction {\n    export const KIND = 'setClipboardData';\n\n    export function is(object: unknown): object is SetClipboardDataAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'clipboardData');\n    }\n\n    export function create(clipboardData: ClipboardData, options: { responseId?: string } = {}): SetClipboardDataAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            clipboardData,\n            ...options\n        };\n    }\n}\n\n/**\n * Requests a cut operation from the server, i.e., deleting the selected elements from the model. Before submitting a `CutOperation`\n * a client should ensure that the cut elements are put into the clipboard.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `CutOperations`.\n */\nexport interface CutOperation extends Operation {\n    kind: typeof CutOperation.KIND;\n\n    editorContext: EditorContext;\n}\n\nexport namespace CutOperation {\n    export const KIND = 'cut';\n\n    export function is(object: unknown): object is CutOperation {\n        return Operation.hasKind(object, KIND) && hasObjectProp(object, 'editorContext');\n    }\n\n    export function create(editorContext: EditorContext): CutOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            editorContext\n        };\n    }\n}\n\n/**\n * Requests a paste operation from the server by providing the current clipboard data. Typically this means that elements should be created\n *  based on the data in the clipboard.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `PasteOperations`.\n */\nexport interface PasteOperation extends Operation {\n    kind: typeof PasteOperation.KIND;\n\n    editorContext: EditorContext;\n\n    /**\n     * The clipboard data that should be pasted to the editor's last recorded mouse position (see `editorContext`).\n     */\n    clipboardData: ClipboardData;\n}\n\nexport namespace PasteOperation {\n    export const KIND = 'paste';\n\n    export function is(object: unknown): object is PasteOperation {\n        return Operation.hasKind(object, KIND) && hasObjectProp(object, 'clipboardData') && hasObjectProp(object, 'editorContext');\n    }\n\n    export function create(options: { editorContext: EditorContext; clipboardData: ClipboardData }): PasteOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            ...options\n        };\n    }\n}\n/**\n * In GLSP the clipboard needs to be managed by the client but the conversion from the selection to be copied into a\n * clipboard-compatible format is handled by the server. By default, GLSP use application/json as exchange format.\n */\nexport interface ClipboardData {\n    [format: string]: string;\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { hasArrayProp, hasObjectProp, hasStringProp } from '../utils/type-util';\nimport { Action, RequestAction, ResponseAction } from './base-protocol';\nimport { Args, EditorContext, LabeledAction } from './types';\n\n/**\n * The `RequestContextActions` is sent from the client to the server to request the available actions for the context with id contextId.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `RequestContextActions`.\n */\nexport interface RequestContextActions extends RequestAction<SetContextActions> {\n    kind: typeof RequestContextActions.KIND;\n\n    /**\n     * The identifier for the context.\n     */\n    contextId: string;\n\n    editorContext: EditorContext;\n}\n\nexport namespace RequestContextActions {\n    export const KIND = 'requestContextActions';\n\n    export function is(object: unknown): object is RequestContextActions {\n        return RequestAction.hasKind(object, KIND) && hasStringProp(object, 'contextId') && hasObjectProp(object, 'editorContext');\n    }\n\n    export function create(options: { contextId: string; editorContext: EditorContext; requestId?: string }): RequestContextActions {\n        return {\n            kind: KIND,\n            requestId: '',\n            ...options\n        };\n    }\n}\n\n/**\n * The `SetContextActions` is the response to a {@link RequestContextActions} containing all actions for the queried context.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetContextsActions`.\n */\nexport interface SetContextActions extends ResponseAction {\n    kind: typeof SetContextActions.KIND;\n\n    /**\n     * The actions available in the queried context.\n     */\n    readonly actions: LabeledAction[];\n\n    /**\n     * Custom arguments.\n     */\n    args?: Args;\n}\n\nexport namespace SetContextActions {\n    export const KIND = 'setContextActions';\n\n    export function is(object: unknown): object is SetContextActions {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'actions');\n    }\n\n    export function create(actions: LabeledAction[], options: { args?: Args; responseId?: string } = {}): SetContextActions {\n        return {\n            kind: KIND,\n            responseId: '',\n            actions,\n            ...options\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { hasArrayProp, hasStringProp } from '../utils/type-util';\nimport { Operation } from './base-protocol';\nimport { Args, ElementAndRoutingPoints } from './types';\n\n/**\n * If the source and/or target element of an edge should be adapted, the client can send a `ReconnectEdgeOperation` to the server.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `ReconnectEdgeOperations`.\n */\nexport interface ReconnectEdgeOperation extends Operation {\n    kind: typeof ReconnectEdgeOperation.KIND;\n\n    /**\n     * The edge element that should be reconnected.\n     */\n    edgeElementId: string;\n\n    /**\n     * The (new) source element of the edge.\n     */\n    sourceElementId: string;\n\n    /**\n     * The (new) target element of the edge.\n     */\n    targetElementId: string;\n\n    /*\n     * Additional arguments for custom behavior.\n     */\n    args?: Args;\n}\n\nexport namespace ReconnectEdgeOperation {\n    export const KIND = 'reconnectEdge';\n\n    export function is(object: unknown): object is ReconnectEdgeOperation {\n        return (\n            Operation.hasKind(object, KIND) &&\n            hasStringProp(object, 'edgeElementId') &&\n            hasStringProp(object, 'sourceElementId') &&\n            hasStringProp(object, 'targetElementId')\n        );\n    }\n\n    export function create(options: {\n        edgeElementId: string;\n        sourceElementId: string;\n        targetElementId: string;\n        args?: Args;\n    }): ReconnectEdgeOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            ...options\n        };\n    }\n}\n\n/**\n * An edge may have zero or more routing points that \"re-direct\" the edge between the source and the target element. In order to set these\n * routing points the client may send a `ChangeRoutingPointsOperation`.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `ChangeRoutingPointsOperations`.\n */\nexport interface ChangeRoutingPointsOperation extends Operation {\n    kind: typeof ChangeRoutingPointsOperation.KIND;\n\n    /**\n     * The routing points of the edge (may be empty).\n     */\n    newRoutingPoints: ElementAndRoutingPoints[];\n}\n\nexport namespace ChangeRoutingPointsOperation {\n    export const KIND = 'changeRoutingPoints';\n\n    export function is(object: unknown): object is ChangeRoutingPointsOperation {\n        return Operation.hasKind(object, KIND) && hasArrayProp(object, 'newRoutingPoints');\n    }\n\n    export function create(newRoutingPoints: ElementAndRoutingPoints[]): ChangeRoutingPointsOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            newRoutingPoints\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Point } from 'sprotty-protocol';\nimport * as sprotty from 'sprotty-protocol/lib/actions';\nimport { hasArrayProp, hasStringProp } from '../utils/type-util';\nimport { Operation } from './base-protocol';\nimport { Args } from './types';\n\n/**\n * Common interface for all create {@link Operation}s in GLSP.\n * The corresponding namespace offers a helper function for type guard checks.\n */\nexport interface CreateOperation extends Operation {\n    /**\n     * The type of the element that should be created.\n     */\n    elementTypeId: string;\n    /**\n     * Optional additional arguments for the server to execute the create operation.\n     */\n    args?: Args;\n}\n\nexport namespace CreateOperation {\n    export function is(object: unknown): object is CreateOperation {\n        return Operation.is(object) && hasStringProp(object, 'elementTypeId');\n    }\n\n    /**\n     * Typeguard function to check wether the given object is a {@link CreateOperation} with the given `kind`.\n     * @param object The object to check.\n     * @param kind  The expected operation kind.\n     * @returns A type literal indicating wether the given object is a create operation with the given kind.\n     */\n    export function hasKind(object: unknown, kind: string): object is CreateOperation {\n        return CreateOperation.is(object) && object.kind === kind;\n    }\n}\n\n/**\n * In order to create a node in the model the client can send a CreateNodeOperation with the necessary information to create\n * the element that corresponds to that node in the source model.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `CreateNodeOperations`.\n */\nexport interface CreateNodeOperation extends CreateOperation {\n    kind: typeof CreateNodeOperation.KIND;\n\n    /*\n     * The location at which the operation shall be executed.\n     */\n    location?: Point;\n\n    /*\n     * The id of container element in which the node should be created. If not defined\n     * the root element will be used.\n     */\n    containerId?: string;\n}\n\nexport namespace CreateNodeOperation {\n    export const KIND = 'createNode';\n\n    export function is(object: unknown): object is CreateNodeOperation {\n        return CreateOperation.hasKind(object, KIND);\n    }\n\n    export function create(\n        elementTypeId: string,\n        options: { location?: Point; containerId?: string; args?: Args } = {}\n    ): CreateNodeOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            elementTypeId,\n            ...options\n        };\n    }\n}\n/**\n * In order to create an edge in the model the client can send a `CreateEdgeOperation` with the necessary information to create\n * the element that corresponds to that edge in the source model.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `CreateEdgeOperations`.\n */\nexport interface CreateEdgeOperation extends CreateOperation {\n    kind: typeof CreateEdgeOperation.KIND;\n\n    sourceElementId: string;\n\n    targetElementId: string;\n}\n\nexport namespace CreateEdgeOperation {\n    export const KIND = 'createEdge';\n\n    export function is(object: unknown): object is CreateEdgeOperation {\n        return (\n            CreateOperation.hasKind(object, KIND) && hasStringProp(object, 'sourceElementId') && hasStringProp(object, 'targetElementId')\n        );\n    }\n\n    export function create(options: {\n        elementTypeId: string;\n        sourceElementId: string;\n        targetElementId: string;\n        args?: Args;\n    }): CreateEdgeOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            ...options\n        };\n    }\n}\n/**\n * The client sends a `DeleteElementOperation` to the server to request the deletion of an element from the source model.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `DeleteElementOperations`.\n */\nexport interface DeleteElementOperation extends Operation, Omit<sprotty.DeleteElementAction, 'kind'> {\n    kind: typeof DeleteElementOperation.KIND;\n\n    /**\n     * The ids of the elements to be deleted.\n     */\n    elementIds: string[];\n}\n\nexport namespace DeleteElementOperation {\n    export const KIND = 'deleteElement';\n\n    export function is(object: unknown): object is DeleteElementOperation {\n        return Operation.hasKind(object, KIND) && hasArrayProp(object, 'elementIds');\n    }\n\n    export function create(elementIds: string[]): DeleteElementOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            elementIds\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Bounds } from 'sprotty-protocol';\nimport * as sprotty from 'sprotty-protocol/lib/actions';\nimport { GModelRootSchema } from '../model/model-schema';\nimport { hasObjectProp, hasStringProp } from '../utils/type-util';\nimport { Action, RequestAction, ResponseAction } from './base-protocol';\n\n/**\n * Triggered when the user hovers the mouse pointer over an element to get a popup with details on that element.\n * This action is sent from the client to the server. The response is a `SetPopupModelAction`.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `RequestPopupModelActions`.\n */\nexport interface RequestPopupModelAction extends RequestAction<SetPopupModelAction>, sprotty.RequestPopupModelAction {\n    kind: typeof RequestPopupModelAction.KIND;\n\n    /**\n     * The identifier of the elements for which a popup is requested.\n     */\n    elementId: string;\n\n    /**\n     * The popup bounds declaring the position of the popup. Optionally the desired dimension.\n     */\n    bounds: Bounds;\n}\n\nexport namespace RequestPopupModelAction {\n    export const KIND = 'requestPopupModel';\n\n    export function is(object: unknown): object is RequestPopupModelAction {\n        return RequestAction.hasKind(object, KIND) && hasStringProp(object, 'elementId') && hasObjectProp(object, 'bounds');\n    }\n\n    export function create(options: { elementId: string; bounds: Bounds; requestId?: string }): RequestPopupModelAction {\n        return {\n            kind: KIND,\n            requestId: '',\n            ...options\n        };\n    }\n}\n\n/**\n * Sent from the server to the client to display a popup in response to a RequestPopupModelAction. This action can also be used to remove\n * unknown existing popup by choosing EMPTY_ROOT as root element.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetPopupModelActions`.\n */\nexport interface SetPopupModelAction extends ResponseAction, sprotty.SetPopupModelAction {\n    kind: typeof SetPopupModelAction.KIND;\n\n    newRoot: GModelRootSchema;\n}\n\nexport namespace SetPopupModelAction {\n    export const KIND = 'setPopupModel';\n\n    export function is(object: unknown): object is SetPopupModelAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'newRoot');\n    }\n\n    export function create(newRoot: GModelRootSchema, options: { responseId?: string } = {}): SetPopupModelAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            newRoot,\n            ...options\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2022 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { JsonPrimitive } from 'sprotty-protocol';\nimport { AnyObject, hasArrayProp, hasObjectProp, hasStringProp } from '../utils/type-util';\nimport { Action, RequestAction, ResponseAction } from './base-protocol';\nimport { Args, EditorContext } from './types';\n\n/**\n * A `NavigationTarget` identifies the object we want to navigate to via its uri and may further provide a label to display to the user.\n * The corresponding namespace offers a set of utility function to interact with `NavigationTargets`.\n */\nexport interface NavigationTarget {\n    /**\n     * URI to identify the object we want to navigate to.\n     */\n    uri: string;\n\n    /**\n     * Optional label to display to the user.\n     */\n    label?: string;\n\n    /**\n     * Domain-specific arguments that may be interpreted directly or resolved further.\n     */\n    args?: Args;\n}\n\nexport namespace NavigationTarget {\n    export function is(object: unknown): object is NavigationTarget {\n        return AnyObject.is(object) && hasStringProp(object, 'uri');\n    }\n    /**\n     *  Generic key to store element ids as additional argument\n     */\n    export const ELEMENT_IDS = 'elementIds';\n    /**\n     * The separator that is used to store he values for the {@link ELEMENT_IDS} as a single string.\n     */\n    export const ELEMENT_IDS_SEPARATOR = '&';\n    /**\n     *  Generic key ot store the line property of a {@link TextPosition} as additional argument.\n     */\n    export const TEXT_LINE = 'line';\n    /**\n     *  Generic key ot store the character property of a {@link TextPosition} as additional argument.\n     */\n    export const TEXT_COLUMN = 'column';\n\n    /**\n     * Denotes the position of the cursor in a text element.\n     */\n    export interface TextPosition {\n        line: number;\n        /**\n         * The character number within the line. Also refereed to as column.\n         */\n        character: number;\n    }\n\n    /**\n     * Utility function to check wether the given {@link NavigationTarget} has additional arguments defined.\n     * @param target The navigation target to check.\n     * @returns `true` if the navigation target has a non-empty `args` property, `false`\n     */\n    export function hasArguments(target: NavigationTarget): boolean {\n        return target.args !== undefined && Object.keys(target.args).length > 0;\n    }\n\n    /**\n     * Adds a new key-value pair to the additional arguments of the given {@link NavigationTarget}.\n     * @param target The navigation target.\n     * @param key The key of the new argument.\n     * @param value The (primitive) value of the new argument.\n     */\n    export function addArgument(target: NavigationTarget, key: string, value: JsonPrimitive): void {\n        if (!target.args) {\n            target.args = {};\n        }\n        target.args[key] = value;\n    }\n\n    /**\n     * Retrieves the element ids that have been stored with the generic {@link ELEMENT_IDS} key from the args of the\n     * given target.\n     * @param target The navigation target.\n     * @returns An array with the parsed element ids. The array is empty if no {@link ELEMENT_IDS} key is present in the args\n     * of the navigation target.\n     */\n    export function getElementIds(target: NavigationTarget): string[] {\n        if (!target?.args?.[ELEMENT_IDS]) {\n            return [];\n        }\n        const elementIdsValue = target.args[ELEMENT_IDS].toString();\n        return elementIdsValue.split(ELEMENT_IDS_SEPARATOR);\n    }\n\n    /**\n     * Stores the given element ids in the given {@link NavigationTarget} as additional arguments using the generic {@link ELEMENT_IDS} key.\n     * @param target The navigation target.\n     * @param elementIds The element ids that should be stored.\n     * @returns the value of the {@link ELEMENT_IDS} key after storing the given element ids.\n     */\n    export function setElementIds(target: NavigationTarget, ...elementIds: string[]): string {\n        if (target.args === undefined) {\n            target.args = {};\n        }\n        return (target.args[ELEMENT_IDS] = elementIds.join(ELEMENT_IDS_SEPARATOR));\n    }\n\n    /**\n     * Stores the given {@link TextPosition} in the given {@link NavigationTarget} as additional arguments using\n     * the generic {@link TEXT_LINE} & {@link TEXT_COLUMN} keys.\n     * @param target The navigation target.\n     * @param position The text position that should be stored.\n     */\n    export function setTextPosition(target: NavigationTarget, position: TextPosition | undefined): void {\n        if (position) {\n            if (target.args === undefined) {\n                target.args = {};\n            }\n            target.args[TEXT_LINE] = position.line;\n            target.args[TEXT_COLUMN] = position.character;\n        }\n    }\n\n    /**\n     * Retrieves the {@link TextPosition} that have been stored with the generic {@link TEXT_LINE} & {@link TEXT_COLUMN} keys\n     * from the args of the given target.\n     * @param target The navigation target.\n     * @returns The parsed text position or `undefined` if one of the generic text keys is not present in the args\n     * of the navigation target.\n     */\n    export function getTextPosition(target: NavigationTarget): TextPosition | undefined {\n        if (!target.args || !target.args[TEXT_LINE] || !target.args[TEXT_COLUMN]) {\n            return undefined;\n        }\n        return {\n            line: Number(target.args[TEXT_LINE]),\n            character: Number(target.args[TEXT_COLUMN])\n        };\n    }\n}\n\n/**\n * Action that is usually sent from the client to the server to request navigation targets for a specific navigation type such as\n * `documentation` or `implementation` in the given editor context.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `RequestNavigationTargetsActions`.\n */\nexport interface RequestNavigationTargetsAction extends RequestAction<SetNavigationTargetsAction> {\n    kind: typeof RequestNavigationTargetsAction.KIND;\n\n    /**\n     * Identifier of the type of navigation targets we want to retrieve, e.g., 'documentation', 'implementation', etc.\n     */\n    targetTypeId: string;\n\n    editorContext: EditorContext;\n}\n\nexport namespace RequestNavigationTargetsAction {\n    export const KIND = 'requestNavigationTargets';\n\n    export function is(object: unknown): object is RequestNavigationTargetsAction {\n        return RequestAction.hasKind(object, KIND) && hasStringProp(object, 'targetTypeId') && hasObjectProp(object, 'editorContext');\n    }\n\n    export function create(options: {\n        targetTypeId: string;\n        editorContext: EditorContext;\n        requestId?: string;\n    }): RequestNavigationTargetsAction {\n        return {\n            kind: KIND,\n            requestId: '',\n            ...options\n        };\n    }\n}\n\n/**\n * Response action from the server following a {@link RequestNavigationTargetsAction}. It contains all available navigation targets for the\n * queried target type in the provided editor context. The server may also provide additional information using the arguments, e.g.,\n * warnings, that can be interpreted by the client.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetNavigationTargetsActions`.\n */\nexport interface SetNavigationTargetsAction extends ResponseAction {\n    kind: typeof SetNavigationTargetsAction.KIND;\n\n    targets: NavigationTarget[];\n\n    /**\n     * Custom arguments that may be interpreted by the client.\n     */\n    args?: Args;\n}\n\nexport namespace SetNavigationTargetsAction {\n    export const KIND = 'setNavigationTargets';\n\n    export function is(object: unknown): object is SetNavigationTargetsAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'targets');\n    }\n\n    export function create(targets: NavigationTarget[], options: { args?: Args; responseId?: string } = {}): SetNavigationTargetsAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            targets,\n            ...options\n        };\n    }\n}\n\n/**\n * Action that triggers the navigation to a particular navigation target, such as element IDs, queries, etc..\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `NavigateToTargetActions`.\n */\nexport interface NavigateToTargetAction extends Action {\n    kind: typeof NavigateToTargetAction.KIND;\n\n    target: NavigationTarget;\n}\n\nexport namespace NavigateToTargetAction {\n    export const KIND = 'navigateToTarget';\n\n    export function is(object: unknown): object is NavigateToTargetAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'target');\n    }\n\n    export function create(target: NavigationTarget): NavigateToTargetAction {\n        return {\n            kind: KIND,\n            target\n        };\n    }\n}\n\n/**\n * If a client cannot navigate to a target directly, a {@link ResolveNavigationTargetAction} may be sent to the server to resolve the\n * navigation target to one or more model elements. This may be useful in cases where the resolution of each target is expensive or the\n * client architecture requires an indirection.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `ResolveNavigationTargetActions`.\n */\nexport interface ResolveNavigationTargetAction extends RequestAction<SetResolvedNavigationTargetAction> {\n    kind: typeof ResolveNavigationTargetAction.KIND;\n\n    /**\n     * The navigation target to resolve.\n     */\n    navigationTarget: NavigationTarget;\n}\n\nexport namespace ResolveNavigationTargetAction {\n    export const KIND = 'resolveNavigationTarget';\n\n    export function is(object: unknown): object is ResolveNavigationTargetAction {\n        return RequestAction.hasKind(object, KIND) && hasObjectProp(object, 'navigationTarget');\n    }\n\n    export function create(navigationTarget: NavigationTarget, options: { requestId?: string } = {}): ResolveNavigationTargetAction {\n        return {\n            kind: KIND,\n            requestId: '',\n            navigationTarget,\n            ...options\n        };\n    }\n}\n\n/**\n * An action sent from the server in response to a {@link ResolveNavigationTargetAction}. The response contains the resolved element ids\n * for the given target and may contain additional information in the args property.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetResolvedNavigationTargetActions`.\n */\nexport interface SetResolvedNavigationTargetAction extends ResponseAction {\n    kind: typeof SetResolvedNavigationTargetAction.KIND;\n\n    /**\n     * The element ids of the resolved navigation target.\n     */\n    elementIds: string[];\n\n    /**\n     * Custom arguments that may be interpreted by the client.\n     */\n    args?: Args;\n}\n\nexport namespace SetResolvedNavigationTargetAction {\n    export const KIND = 'setResolvedNavigationTarget';\n\n    export function is(object: unknown): object is SetResolvedNavigationTargetAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'elementIds');\n    }\n\n    export function create(elementIds: string[], options: { args?: Args; responseId?: string } = {}): SetResolvedNavigationTargetAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            elementIds,\n            ...options\n        };\n    }\n}\n\n/**\n * If a {@link NavigationTarget} cannot be resolved or the resolved target is something that is not part of our source model, e.g.,\n * a separate documentation file, a {@link NavigateToExternalTargetAction} may be sent. Since the target it outside of the model scope such\n * an action would be typically handled by an integration layer (such as the surrounding IDE).\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `NavigateToExternalTargetActions`.\n */\nexport interface NavigateToExternalTargetAction extends Action {\n    kind: typeof NavigateToExternalTargetAction.KIND;\n\n    /**\n     * The diagram-external target to which the client shall navigate.\n     */\n    target: NavigationTarget;\n}\n\nexport namespace NavigateToExternalTargetAction {\n    export const KIND = 'navigateToExternalTarget';\n\n    export function is(object: unknown): object is NavigateToExternalTargetAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'target');\n    }\n\n    export function create(target: NavigationTarget): NavigateToExternalTargetAction {\n        return {\n            kind: KIND,\n            target\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Constructor, Primitive } from './type-util';\n\n/**\n * A union type for for objects that can either be a single element or and array of elements.\n */\nexport type MaybeArray<T> = T | T[];\n\n/**\n * Returns the first element of the given array.\n * @param array the array.\n * @returns the element at index 0.\n */\nexport function first<T>(array: T[]): T;\n\n/**\n * Returns the first n elements of the given array.\n * @param array The array.\n * @param n The number of elements that should be returned\n * @returns The first n elements of the array\n */\nexport function first<T>(array: T[], n: number): T[];\nexport function first<T>(array: T[], n?: number): T[] | T {\n    if (n) {\n        return array.filter((_, index) => index < n);\n    }\n    return array[0];\n}\n\n/**\n * Returns the last element of the given array.\n * @param array The array.\n * @returns The last element in the array.\n */\nexport function last<T>(array: T[]): T;\n\n/**\n * Returns the last n elements of the given array.\n * @param array The array.\n * @param n The number of elements that should be returned\n * @returns The last n elements of the array\n */\nexport function last<T>(array: T[], n: number): T[];\nexport function last<T>(array: T[], n?: number): T[] | T {\n    if (n) {\n        return array.filter((_, index) => array.length - index <= n);\n    }\n    return array[array.length - 1];\n}\n\n/**\n * Plucks (i.e. extracts) the property value that corresponds to the given key from all objects of the array.\n * @param array The array which should be plucked.\n * @param key  The key of the property that should be extracted.\n * @returns A new array containing the plugged property for each element of the array.\n */\nexport function pluck<T, K extends keyof T>(array: T[], key: K): Array<T[K]> {\n    return array.map(element => element[key]);\n}\n\n/**\n * Removes the given values from the given array (if present).\n * @param array The array to execute the remove operation on.\n * @param values The values that should be removed from the array.\n */\nexport function remove<T>(array: T[], ...values: T[]): void {\n    values.forEach(value => {\n        const index = array.indexOf(value);\n        if (index >= 0) {\n            array.splice(index, 1);\n        }\n    });\n}\n\n/**\n * Push an array of values to the given array. The values can either be single objects of a concrete type `T`\n * or can also be nested arrays of T. If nested arrays are passed the they will be destructured (i.e. flattened)\n * so that they can be pushed to the given array.\n * @param array The array to push to.\n * @param toPush The values of {@link MaybeArray}s that should be pushed.\n */\nexport function flatPush<T>(array: T[], toPush: MaybeArray<T>[]): void {\n    toPush.forEach(value => (Array.isArray(value) ? array.push(...value) : array.push(value)));\n}\n\n/**\n * Helper function to convert a {@link MaybeArray} into an array.\n * @param maybe The MaybeArray to convert\n * @returns The corresponding array\n */\nexport function asArray<T>(maybe: MaybeArray<T>): T[] {\n    if (Array.isArray(maybe)) {\n        return maybe;\n    }\n    return [maybe];\n}\n/**\n * Adds the given values to the given array. The add operation is executed distinct meaning\n * a value will not be pushed to the array if its already present in the array.\n * @param array The array to push to.\n * @param values The values that should be added distinctively.\n */\nexport function distinctAdd<T>(array: T[], ...values: T[]): void {\n    values.forEach(value => {\n        if (!array.includes(value)) {\n            array.push(value);\n        }\n    });\n}\n\n/**\n * A typeguard function to check wether a given object is an array of a specific type `T`. As it checks the type of each individual\n * array element this guard check is expensive and should only be used in cases where complete type-safety is required.\n * @param object The object to check.\n * @param typeGuard A typeguard to check the type of the individual elements.\n * @param supportEmpty A flag to determine wether empty arrays should pass the typeguard check.\n * @returns A type predicate indicating wether the given object has passed the type guard check.\n */\nexport function isArrayOfType<T>(object: unknown, typeGuard: (elem: unknown) => elem is T, supportEmpty = false): object is T[] {\n    return isArrayMatching(object, element => typeGuard(element), supportEmpty);\n}\n\n/**\n * A typeguard function to check wether a given object is an array of a class`T`. As it checks the wether each individual element\n * is an instance of the given class this  guard check is expensive and should only be used in cases where complete type-safety is required.\n * @param object The object to check.\n * @param constructor The constructor for the class under test.\n * @param supportEmpty A flag to determine wether empty arrays should pass the typeguard check.\n * @returns A type predicate indicating wether the given object has passed the type guard check.\n */\nexport function isArrayOfClass<T>(object: unknown, constructor: Constructor<T>, supportEmpty = false): object is T[] {\n    return isArrayMatching(object, element => element instanceof constructor, supportEmpty);\n}\n\n/**\n * A typeguard function to check wether a given object is an array of a {@link PrimitiveType} `T. As it checks the type of each individual\n * array element this guard check is expensive and should only be used in cases where complete type-safety is required.\n * @param object The object to check.\n * @param primitiveType The expected primitive type of the elements.\n * @param supportEmpty A flag to determine wether empty arrays should pass the typeguard check.\n * @returns A type predicate indicating wether the given object has passed the type guard check.\n */\nexport function isArrayOfPrimitive<T>(object: unknown, primitiveType: Primitive, supportEmpty = false): object is T[] {\n    return isArrayMatching(object, element => typeof element === primitiveType, supportEmpty);\n}\n\n/**\n * A typeguard function to check wether a given object is an array of a strings. As it checks the type of each individual\n * array element this guard check is expensive and should only be used in cases where complete type-safety is required.\n * @param object The object to check.\n * @param supportEmpty A flag to determine wether empty arrays should pass the typeguard check.\n * @returns A type predicate indicating wether the given object has passed the type guard check.\n */\nexport function isStringArray(object: unknown, supportEmpty = false): object is string[] {\n    return isArrayOfPrimitive(object, 'string', supportEmpty);\n}\n\n/**\n * A typeguard function to check wether a given object is an array where each element matches the given predicate.\n * @param object The object to check.\n * @param predicate The predicate to test with.\n * @param supportEmpty A flag to determine wether empty arrays be matched by the predicate..\n * @returns `true` if the given object is an array and all elements match the given predicate. `false` otherwise.\n */\nexport function isArrayMatching(object: unknown, predicate: (elem: unknown) => boolean, supportEmpty = false): boolean {\n    return Array.isArray(object) && object.every(predicate) && (supportEmpty || object.length > 0);\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport * as sprotty from 'sprotty-protocol/lib/actions';\nimport { isStringArray } from '../utils/array-util';\nimport { hasArrayProp, hasBooleanProp } from '../utils/type-util';\nimport { Action } from './base-protocol';\n\n/**\n * Triggered when the user changes the selection, e.g. by clicking on a selectable element. The action should trigger a change in the\n * selected state accordingly, so the elements can be rendered differently. The server can send such an action to the client in order to\n * change the selection remotely.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SelectActions`.\n */\nexport interface SelectAction extends Action, sprotty.SelectAction {\n    kind: typeof SelectAction.KIND;\n\n    /**\n     * The identifiers of the elements to mark as selected.\n     */\n    selectedElementsIDs: string[];\n\n    /**\n     * The identifiers of the elements to mark as not selected.\n     */\n    deselectedElementsIDs: string[];\n\n    /**\n     * Whether all currently selected elements should be deselected.\n     */\n    deselectAll?: boolean;\n}\n\nexport namespace SelectAction {\n    export const KIND = 'elementSelected';\n\n    export function is(object: unknown): object is SelectAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'selectedElementsIDs') && hasArrayProp(object, 'deselectedElementsIDs');\n    }\n\n    export function create(options: { selectedElementsIDs?: string[]; deselectedElementsIDs?: string[] | boolean } = {}): SelectAction {\n        const deselectedElementsIDs = options.deselectedElementsIDs ?? [];\n        return {\n            kind: KIND,\n            selectedElementsIDs: options.selectedElementsIDs ?? [],\n            deselectedElementsIDs: isStringArray(deselectedElementsIDs, true) ? deselectedElementsIDs : [],\n            deselectAll: typeof deselectedElementsIDs === 'boolean' ? deselectedElementsIDs : false\n        };\n    }\n\n    export function addSelection(selectedElementsIDs: string[]): SelectAction {\n        return create({ selectedElementsIDs });\n    }\n\n    export function removeSelection(deselectedElementsIDs: string[]): SelectAction {\n        return create({ deselectedElementsIDs });\n    }\n\n    export function setSelection(selectedElementsIDs: string[]): SelectAction {\n        return create({ selectedElementsIDs, deselectedElementsIDs: true });\n    }\n}\n\n/**\n * Programmatic action for selecting or deselecting all elements.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SelectAllActions`.\n */\nexport interface SelectAllAction extends Action, sprotty.SelectAllAction {\n    kind: typeof SelectAllAction.KIND;\n\n    /**\n     * If `select` is true, all elements are selected, otherwise they are deselected.\n     */\n    select: boolean;\n}\n\nexport namespace SelectAllAction {\n    export const KIND = 'allSelected';\n\n    export function is(object: unknown): object is SelectAllAction {\n        return Action.hasKind(object, KIND) && hasBooleanProp(object, 'select');\n    }\n\n    export function create(select = true): SelectAllAction {\n        return {\n            kind: KIND,\n            select\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport * as sprotty from 'sprotty-protocol/lib/actions';\nimport { hasObjectProp, hasStringProp } from '../utils/type-util';\nimport { Action, Operation, RequestAction, ResponseAction } from './base-protocol';\nimport { Args } from './types';\n\n/**\n * Requests the validation of the given text in the context of the provided model element. Typically sent from the client to the server.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `NewActions`.\n */\nexport interface RequestEditValidationAction extends RequestAction<SetEditValidationResultAction> {\n    kind: typeof RequestEditValidationAction.KIND;\n\n    /**\n     * Context in which the text is validated, e.g., 'label-edit'.\n     */\n    contextId: string;\n\n    /**\n     * Model element that is being edited.\n     */\n    modelElementId: string;\n\n    /**\n     * Text that should be validated for the given context and the model element.\n     */\n    text: string;\n}\n\nexport namespace RequestEditValidationAction {\n    export const KIND = 'requestEditValidation';\n\n    export function is(object: unknown): object is RequestEditValidationAction {\n        return (\n            RequestAction.hasKind(object, KIND) &&\n            hasStringProp(object, 'contextId') &&\n            hasStringProp(object, 'modelElementId') &&\n            hasStringProp(object, 'text')\n        );\n    }\n\n    export function create(options: {\n        contextId: string;\n        modelElementId: string;\n        text: string;\n        requestId?: string;\n    }): RequestEditValidationAction {\n        return {\n            kind: KIND,\n            requestId: '',\n            ...options\n        };\n    }\n}\n\n/**\n * Response to a {@link RequestEditValidationAction} containing the validation result for applying a text on a certain model element.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetEditValidationResultActions`.\n */\nexport interface SetEditValidationResultAction extends ResponseAction {\n    kind: typeof SetEditValidationResultAction.KIND;\n\n    status: ValidationStatus;\n\n    /*\n     * Additional arguments for custom behavior.\n     */\n    args?: Args;\n}\n\nexport namespace SetEditValidationResultAction {\n    export const KIND = 'setEditValidationResult';\n\n    export function is(object: unknown): object is SetEditValidationResultAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'status');\n    }\n\n    export function create(status: ValidationStatus, options: { args?: Args; responseId?: string } = {}): SetEditValidationResultAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            status,\n            ...options\n        };\n    }\n}\n\n/**\n * A very common use case in domain models is the support of labels that display textual information to the user.\n * To apply new text to such a label element the client may send an ApplyLabelEditOperation to the server. Typically this is\n * done by the client after it has received a error free validation result via {@link SetEditValidationResultAction} from the server.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `ApplyLabelEditOperations`.\n */\nexport interface ApplyLabelEditOperation extends Operation, sprotty.ApplyLabelEditAction {\n    kind: typeof ApplyLabelEditOperation.KIND;\n\n    /**\n     * Identifier of the label model element.\n     */\n    labelId: string;\n\n    /**\n     * Text that should be applied on the label.\n     */\n    text: string;\n}\n\nexport namespace ApplyLabelEditOperation {\n    export const KIND = 'applyLabelEdit';\n\n    export function is(object: unknown): object is ApplyLabelEditOperation {\n        return Operation.hasKind(object, KIND) && hasStringProp(object, 'labelId') && hasStringProp(object, 'text');\n    }\n\n    export function create(options: { labelId: string; text: string }): ApplyLabelEditOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            ...options\n        };\n    }\n}\n\n/**\n * The serializable result of an an validation request.\n * Tje corresponding namespace offers the default severity values\n * and other utility functions.\n */\nexport interface ValidationStatus {\n    /**\n     * The severity of the validation returned by the server.\n     */\n    readonly severity: ValidationStatus.Severity;\n\n    /**\n     * The validation status message which may be rendered in the view.\n     */\n    readonly message?: string;\n\n    /**\n     * A potential error that encodes more details.\n     */\n    readonly error?: ResponseError;\n}\n\nexport namespace ValidationStatus {\n    /**\n     * The default {@link ValidationStatus} severity levels used in GLSP.\n     */\n    export enum Severity {\n        FATAL,\n        ERROR,\n        WARNING,\n        INFO,\n        OK,\n        NONE\n    }\n\n    /**\n     * An empty {@link ValidationStatus}.\n     */\n    export const NONE: ValidationStatus = {\n        severity: Severity.NONE,\n        message: '',\n        error: { code: -1, message: '', data: {} }\n    };\n\n    /**\n     * Utility function to check wether the given {@link ValidationStatus} has\n     * a severity that is considered to be OK.\n     * @param validationStatus The validation status to check.\n     * @returns `true` if the given status has a non critical severity, `false` otherwise.\n     */\n    export function isOk(validationStatus: ValidationStatus): boolean {\n        return (\n            validationStatus.severity === Severity.OK ||\n            validationStatus.severity === Severity.INFO ||\n            validationStatus.severity === Severity.NONE\n        );\n    }\n\n    /**\n     * Utility function to check wether the given {@link ValidationStatus} has\n     * a `warning` severity.\n     * @param validationStatus The validation status to check.\n     * @returns `true` if the given status has a `warning` severity, `false` otherwise.\n     */\n    export function isWarning(validationStatus: ValidationStatus): boolean {\n        return validationStatus.severity === Severity.WARNING;\n    }\n\n    /**\n     * Utility function to check wether the given {@link ValidationStatus} has\n     * an `error` or `fatal` severity.\n     * @param validationStatus The validation status to check.\n     * @returns `true` if the given status has a `error` or `fatal` severity, `false` otherwise.\n     */\n    export function isError(validationStatus: ValidationStatus): boolean {\n        return validationStatus.severity === Severity.ERROR || validationStatus.severity === Severity.FATAL;\n    }\n}\n\n/**\n * The serializable format of an error that occurred during validation.\n */\nexport interface ResponseError {\n    /**\n     * Code identifying the error kind.\n     */\n    readonly code: number;\n\n    /**\n     * Error message.\n     */\n    readonly message: string;\n\n    /**\n     * Additional custom data, e.g., a serialized stacktrace.\n     */\n    readonly data: Record<string, unknown>;\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2022 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { GModelElementSchema } from '../model/model-schema';\nimport { hasArrayProp, hasBooleanProp, hasStringProp } from '../utils/type-util';\nimport { Action, RequestAction, ResponseAction } from './base-protocol';\n\n/**\n * Type hints are used to define what modifications are supported on the different element types.\n * The rationale is to avoid a client-server round-trip for user feedback of each synchronous user interaction.\n */\nexport interface TypeHint {\n    /**\n     * The id of the element.\n     */\n    readonly elementTypeId: string;\n\n    /**\n     * Specifies whether the element can be relocated.\n     */\n    readonly repositionable: boolean;\n\n    /**\n     * Specifies whether the element can be deleted\n     */\n    readonly deletable: boolean;\n}\n\n/**\n * A {@link TypeHint} with additional modification properties for shape elements.\n */\nexport interface ShapeTypeHint extends TypeHint {\n    /**\n     * Specifies whether the element can be resized.\n     */\n    readonly resizable: boolean;\n\n    /**\n     * Specifies whether the element can be moved to another parent\n     */\n    readonly reparentable: boolean;\n\n    /**\n     * The types of elements that can be contained by this element (if unknown)\n     */\n    readonly containableElementTypeIds?: string[];\n}\n\n/**\n * A {@link TypeHint} with additional modification properties for edge elements.\n */\nexport interface EdgeTypeHint extends TypeHint {\n    /**\n     * Specifies whether the routing points of the edge can be changed\n     * i.e. edited by the user.\n     */\n    readonly routable: boolean;\n\n    /**\n     * Allowed source element types for this edge type.\n     * If not defined unknown element can be used as source element for this edge.\n     */\n    readonly sourceElementTypeIds?: string[];\n\n    /**\n     * Allowed target element types for this edge type\n     *  If not defined unknown element can be used as target element for this edge.\n     */\n    readonly targetElementTypeIds?: string[];\n\n    /**\n     * Indicates whether this type hint is dynamic or not. Dynamic edge type hints\n     * require an additional runtime check before creating an edge, when checking\n     * source and target element types is not sufficient.\n     *\n     * @see {@link RequestCheckEdgeAction}\n     */\n    readonly dynamic?: boolean;\n}\n\n/**\n * Sent from the client to the server in order to request hints on whether certain modifications are allowed for a specific element type.\n * The `RequestTypeHintsAction` is optional, but should usually be among the first messages sent from the client to the server after\n * receiving the model via `RequestModelAction`. The response is a {@link SetTypeHintsAction}.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `RequestTypeHintsActions`.\n */\nexport interface RequestTypeHintsAction extends RequestAction<SetTypeHintsAction> {\n    kind: typeof RequestTypeHintsAction.KIND;\n}\n\nexport namespace RequestTypeHintsAction {\n    export const KIND = 'requestTypeHints';\n\n    export function is(object: unknown): object is RequestTypeHintsAction {\n        return RequestAction.hasKind(object, KIND);\n    }\n\n    export function create(options: { requestId?: string } = {}): RequestTypeHintsAction {\n        return {\n            kind: KIND,\n            requestId: '',\n            ...options\n        };\n    }\n}\n\n/**\n * Sent from the server to the client in order to provide hints certain modifications are allowed for a specific element type.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetTypeHintsActions`.\n */\nexport interface SetTypeHintsAction extends ResponseAction {\n    kind: typeof SetTypeHintsAction.KIND;\n\n    shapeHints: ShapeTypeHint[];\n\n    edgeHints: EdgeTypeHint[];\n}\n\nexport namespace SetTypeHintsAction {\n    export const KIND = 'setTypeHints';\n\n    export function is(object: unknown): object is SetTypeHintsAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'shapeHints') && hasArrayProp(object, 'edgeHints');\n    }\n\n    export function create(options: { shapeHints: ShapeTypeHint[]; edgeHints: EdgeTypeHint[]; responseId?: string }): SetTypeHintsAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            ...options\n        };\n    }\n}\n\n/**\n * Sent from the client to the server to check wether the provided edge context information is valid i.e.\n * creation of an edge with the given edge type and source/target element is allowed by the server.\n * Typically this action is dispatched by edge creation tools in the creation phase of an edge that's associated\n * with a dynamic {@link EdgeTypeHint}.\n */\nexport interface RequestCheckEdgeAction extends RequestAction<CheckEdgeResultAction> {\n    kind: typeof RequestCheckEdgeAction.KIND;\n\n    /**\n     * The element type of the edge being created.\n     */\n    edgeType: string;\n\n    /**\n     * The ID of the edge source element.\n     */\n    sourceElementId: string;\n\n    /**\n     * The ID of the edge target element to check.\n     */\n    targetElementId?: string;\n}\n\nexport namespace RequestCheckEdgeAction {\n    export const KIND = 'requestCheckEdge';\n\n    export function is(object: unknown): object is RequestCheckEdgeAction {\n        return (\n            Action.hasKind(object, KIND) &&\n            hasStringProp(object, 'edgeType') &&\n            hasStringProp(object, 'sourceElementId') &&\n            hasStringProp(object, 'targetElementId', true)\n        );\n    }\n\n    export function create(options: {\n        sourceElement: GModelElementSchema | string;\n        targetElement?: GModelElementSchema | string;\n        edgeType: string;\n        requestId?: string;\n    }): RequestCheckEdgeAction {\n        return {\n            kind: KIND,\n            edgeType: options.edgeType,\n            sourceElementId: getElementTypeId(options.sourceElement),\n            targetElementId: options.targetElement ? getElementTypeId(options.targetElement) : undefined,\n            requestId: options.requestId ?? ''\n        };\n    }\n}\n\nfunction getElementTypeId(element: GModelElementSchema | string): string {\n    if (typeof element === 'string') {\n        return element;\n    }\n    return element.id;\n}\n\n/**\n * Send from the server to the client as a response for a {@link RequestCheckEdgeAction}. It provides\n * a boolean indicating whether the edge context information provided by the corresponding request action is valid\n * i.e. creation of an  edge with the given edge type and source/target element is allowed.\n */\nexport interface CheckEdgeResultAction extends ResponseAction {\n    kind: typeof CheckEdgeResultAction.KIND;\n\n    /**\n     * true if the selected element is a valid target for this edge,\n     * false otherwise.\n     */\n    isValid: boolean;\n    /**\n     * The element type of the edge that has been checked.\n     */\n    edgeType: string;\n\n    /**\n     * The ID of the source element of the edge that has been checked.\n     */\n    sourceElementId: string;\n    /**\n     * The ID of the target element of the edge that has been checked.\n     */\n    targetElementId?: string;\n}\n\nexport namespace CheckEdgeResultAction {\n    export const KIND = 'checkEdgeTargetResult';\n\n    export function is(object: unknown): object is CheckEdgeResultAction {\n        return (\n            Action.hasKind(object, KIND) &&\n            hasBooleanProp(object, 'isValid') &&\n            hasStringProp(object, 'edgeType') &&\n            hasStringProp(object, 'sourceElementId') &&\n            hasStringProp(object, 'targetElementId', true)\n        );\n    }\n\n    export function create(options: {\n        isValid: boolean;\n        edgeType: string;\n        sourceElementId: string;\n        targetElementId?: string;\n        responseId?: string;\n    }): CheckEdgeResultAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            ...options\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { hasArrayProp } from '../utils/type-util';\nimport { Action, RequestAction, ResponseAction } from './base-protocol';\n\n/**\n * Validation in GLSP is performed by using validation markers. A marker represents the validation result for a single model element\n */\nexport interface Marker {\n    /**\n     * Short label describing this marker message, e.g., short validation message\n     */\n    readonly label: string;\n    /**\n     * Full description of this marker, e.g., full validation message\n     */\n    readonly description: string;\n    /**\n     * Id of the model element this marker refers to\n     */\n    readonly elementId: string;\n    /**\n     * Marker kind, e.g., info, warning, error or custom kind\n     */\n    readonly kind: string;\n}\n\n/**\n * The default marker kinds used in GLSP\n */\nexport namespace MarkerKind {\n    export const INFO = 'info';\n    export const WARNING = 'warning';\n    export const ERROR = 'error';\n}\n\n/**\n * The default reasons for markers.\n */\nexport namespace MarkersReason {\n    /** Markers resulting from a batch validation */\n    export const BATCH = 'batch';\n    /** Markers resulting from a live validation */\n    export const LIVE = 'live';\n}\n\n/**\n * Action to retrieve markers for the specified model elements. Sent from the client to the server.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `RequestMarkersActions`.\n */\nexport interface RequestMarkersAction extends RequestAction<SetMarkersAction> {\n    kind: typeof RequestMarkersAction.KIND;\n\n    /**\n     * The elements for which markers are requested, may be just the root element.\n     */\n    elementsIDs: string[];\n\n    /**\n     * The reason for this request, such as `batch` or `live` validation. `batch` by default.\n     */\n    reason?: string;\n}\n\nexport namespace RequestMarkersAction {\n    export const KIND = 'requestMarkers';\n\n    export function is(object: unknown): object is RequestMarkersAction {\n        return RequestAction.hasKind(object, KIND) && hasArrayProp(object, 'elementsIDs');\n    }\n\n    export function create(elementsIDs: string[], options: { requestId?: string; reason?: string } = {}): RequestMarkersAction {\n        return {\n            kind: KIND,\n            requestId: '',\n            elementsIDs,\n            reason: MarkersReason.BATCH,\n            ...options\n        };\n    }\n}\n\n/**\n * Instructs the client to add markers to the diagram.\n * Typically, this is a response to the {@link RequestMarkersAction} containing all validation markers, but can be sent by the server at\n * unknown time.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetMarkersActions`.\n */\nexport interface SetMarkersAction extends ResponseAction {\n    kind: typeof SetMarkersAction.KIND;\n\n    /**\n     * The list of markers to be added to the diagram.\n     */\n    readonly markers: Marker[];\n\n    /**\n     * The reason for message, such as `batch` or `live` validation.\n     */\n    reason?: string;\n}\n\nexport namespace SetMarkersAction {\n    export const KIND = 'setMarkers';\n\n    export function is(object: unknown): object is SetMarkersAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'markers');\n    }\n\n    export function create(markers: Marker[], options: { responseId?: string; reason?: string } = {}): SetMarkersAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            markers,\n            reason: MarkersReason.BATCH,\n            ...options\n        };\n    }\n}\n\n/**\n * Action for clearing makers of a model\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `DeleteMarkersActions`. Can be sent by either the client or the server.\n */\nexport interface DeleteMarkersAction extends Action {\n    kind: typeof DeleteMarkersAction.KIND;\n\n    /**\n     * The list of markers that has been requested by the `RequestMarkersAction`.\n     */\n    markers: Marker[];\n}\n\nexport namespace DeleteMarkersAction {\n    export const KIND = 'deleteMarkers';\n\n    export function is(object: unknown): object is DeleteMarkersAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'markers');\n    }\n\n    export function create(markers: Marker[]): DeleteMarkersAction {\n        return {\n            kind: KIND,\n            markers\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport * as sprotty from 'sprotty-protocol/lib/actions';\nimport { GModelRootSchema } from '../model/model-schema';\nimport { hasObjectProp, hasStringProp } from '../utils/type-util';\nimport { Action, RequestAction, ResponseAction } from './base-protocol';\nimport { Args } from './types';\n\n/**\n * Sent from the server to the client in order to set the model. If a model is already present, it is replaced.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `RequestModelActions`.\n */\nexport interface RequestModelAction extends RequestAction<SetModelAction>, sprotty.RequestModelAction {\n    kind: typeof RequestModelAction.KIND;\n\n    /**\n     * Additional options used to compute the graphical model.\n     */\n    options?: Args;\n}\n\nexport namespace RequestModelAction {\n    export const KIND = 'requestModel';\n\n    export function is(object: unknown): object is RequestModelAction {\n        return RequestAction.hasKind(object, KIND);\n    }\n\n    export function create(options: { options?: Args; requestId?: string } = {}): RequestModelAction {\n        return {\n            kind: KIND,\n            requestId: '',\n            ...options\n        };\n    }\n}\n\n/**\n * Sent from the server to the client in order to set the model. If a model is already present, it is replaced.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetModelActions`.\n */\nexport interface SetModelAction extends ResponseAction, sprotty.SetModelAction {\n    kind: typeof SetModelAction.KIND;\n    /**\n     * The new graphical model root.\n     */\n    newRoot: GModelRootSchema;\n}\n\nexport namespace SetModelAction {\n    export const KIND = 'setModel';\n\n    export function is(object: unknown): object is SetModelAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'newRoot');\n    }\n\n    export function create(newRoot: GModelRootSchema, options: { responseId?: string } = {}): SetModelAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            newRoot,\n            ...options\n        };\n    }\n}\n\n/**\n * Sent from the server to the client in order to update the model. If no model is present yet, this behaves the same as\n * a {@link SetModelAction}. The transition from the old model to the new one can be animated.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `UpdateModelActions`.\n */\nexport interface UpdateModelAction extends Action, Omit<sprotty.UpdateModelAction, 'matches' | 'cause'> {\n    kind: typeof UpdateModelAction.KIND;\n\n    newRoot: GModelRootSchema;\n    /**\n     * Boolean flag to indicate wether updated/changed elements should be animated in the diagram.\n     */\n    animate?: boolean;\n}\n\nexport namespace UpdateModelAction {\n    export const KIND = 'updateModel';\n\n    export function is(action: unknown): action is UpdateModelAction {\n        return Action.hasKind(action, KIND) && hasObjectProp(action, 'newRoot');\n    }\n\n    export function create(newRoot: GModelRootSchema, options: { animate?: boolean } = {}): UpdateModelAction {\n        return {\n            kind: KIND,\n            newRoot,\n            animate: true,\n            ...options\n        };\n    }\n}\n\n/**\n * Sent from the server to the client in order to indicate that the source model has changed.\n * The source model denotes the data source from which the diagram has been originally derived (such as a file, a database, etc.).\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SourceModelChangedActions`.\n */\nexport interface SourceModelChangedAction extends Action {\n    kind: typeof SourceModelChangedAction.KIND;\n\n    /**\n     * A human readable name of the source model (e.g. the file name).\n     */\n    sourceModelName: string;\n}\n\nexport namespace SourceModelChangedAction {\n    export const KIND = 'sourceModelChanged';\n\n    export function is(object: unknown): object is SourceModelChangedAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'sourceModelName');\n    }\n\n    export function create(sourceModelName: string): SourceModelChangedAction {\n        return {\n            kind: KIND,\n            sourceModelName: sourceModelName\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2022 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { hasStringProp } from '../utils/type-util';\nimport { Action } from './base-protocol';\n\n/**\n * Sent from the client to the server to set the model into a specific editor mode, allowing the server to react to certain\n * requests differently depending on the mode. A client may also listen to this action to prevent certain user interactions preemptively.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetEditModeActions`.\n */\nexport interface SetEditModeAction extends Action {\n    kind: typeof SetEditModeAction.KIND;\n\n    /**\n     * The new edit mode of the diagram.\n     */\n    editMode: string;\n}\n\nexport namespace SetEditModeAction {\n    export const KIND = 'setEditMode';\n\n    export function is(object: unknown): object is SetEditModeAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'editMode');\n    }\n\n    export function create(editMode: string): SetEditModeAction {\n        return {\n            kind: KIND,\n            editMode\n        };\n    }\n}\n\n/**\n * The potential default values for the `editMode` property of  a {@link SetEditModeAction}.\n */\nexport namespace EditMode {\n    export const READONLY = 'readonly';\n    export const EDITABLE = 'editable';\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport * as sprotty from 'sprotty-protocol/lib/actions';\nimport { GModelRootSchema } from '..';\nimport { hasArrayProp, hasObjectProp } from '../utils/type-util';\nimport { Action, Operation, RequestAction, ResponseAction } from './base-protocol';\nimport { ElementAndAlignment, ElementAndBounds, ElementAndRoutingPoints } from './types';\n\n/**\n * Sent from the server to the client to request bounds for the given model. The model is rendered invisibly so the bounds can\n * derived from the DOM. The response is a ComputedBoundsAction. This hidden rendering round-trip is necessary if the client is responsible\n * for parts of the layout.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `RequestBoundsActions`.\n */\nexport interface RequestBoundsAction extends RequestAction<ComputedBoundsAction>, Omit<sprotty.RequestBoundsAction, '_'> {\n    kind: typeof RequestBoundsAction.KIND;\n\n    /**\n     * The model root element for which to compute the bounds.\n     */\n    newRoot: GModelRootSchema;\n}\n\nexport namespace RequestBoundsAction {\n    export const KIND = 'requestBounds';\n\n    export function is(object: unknown): object is RequestBoundsAction {\n        return RequestAction.hasKind(object, KIND) && hasObjectProp(object, 'newRoot');\n    }\n\n    export function create(newRoot: GModelRootSchema, options: { requestId?: string } = {}): RequestBoundsAction {\n        return {\n            kind: KIND,\n            requestId: '',\n            newRoot,\n            ...options\n        };\n    }\n}\n\n/**\n * Sent from the client to the server to transmit the result of bounds computation as a response to a {@link RequestBoundsAction}.\n * If the server is responsible for parts of the layout, it can do so after applying the computed bounds received with this action.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `ComputedBoundsActions`.\n */\nexport interface ComputedBoundsAction extends ResponseAction, sprotty.ComputedBoundsAction {\n    kind: typeof ComputedBoundsAction.KIND;\n    /**\n     * The new bounds of the model elements.\n     */\n    bounds: ElementAndBounds[];\n\n    /*\n     * The revision number.\n     */\n    revision?: number;\n\n    /**\n     * The new alignment of the model elements.\n     */\n    alignments?: ElementAndAlignment[];\n\n    /**\n     * The route of the model elements.\n     */\n    routes?: ElementAndRoutingPoints[];\n}\n\nexport namespace ComputedBoundsAction {\n    export const KIND = 'computedBounds';\n\n    export function is(object: unknown): object is ComputedBoundsAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'bounds');\n    }\n\n    export function create(\n        bounds: ElementAndBounds[],\n        options: {\n            revision?: number;\n            responseId?: string;\n            alignments?: ElementAndAlignment[];\n            routes?: ElementAndRoutingPoints[];\n        } = {}\n    ): ComputedBoundsAction {\n        return {\n            kind: KIND,\n            responseId: '',\n            bounds,\n            ...options\n        };\n    }\n}\n\n/**\n * Request a layout of the diagram or the selected elements only.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `LayoutOperations`.\n */\nexport interface LayoutOperation extends Operation, Omit<sprotty.LayoutAction, 'layoutType'> {\n    kind: typeof LayoutOperation.KIND;\n\n    /**\n     * The identifiers of the elements that should be layouted, will default to the root element if not defined.\n     */\n    elementIds?: string[];\n}\n\nexport namespace LayoutOperation {\n    export const KIND = 'layout';\n\n    export function is(object: unknown): object is LayoutOperation {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'elementIds');\n    }\n\n    export function create(elementIds?: string[]): LayoutOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            elementIds\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { hasBooleanProp, hasStringProp } from '../utils/type-util';\nimport { Action, RequestAction, ResponseAction } from './base-protocol';\n\n/**\n * Sent from the client to the server in order to persist the current model state back to the source model.\n * A new fileUri can be defined to save the model to a new destination different from its original source model.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SaveModelActions`.\n */\nexport interface SaveModelAction extends Action {\n    kind: typeof SaveModelAction.KIND;\n    /**\n     *  The optional destination file uri.\n     */\n    fileUri?: string;\n}\n\nexport namespace SaveModelAction {\n    export const KIND = 'saveModel';\n\n    export function is(object: unknown): object is SaveModelAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(options: { fileUri?: string } = {}): SaveModelAction {\n        return {\n            kind: KIND,\n            ...options\n        };\n    }\n}\n\n/**\n * The server sends this action to indicate to the client that the current model state on the server does not correspond\n * to the persisted model state of the source model. A client may ignore such an action or use it to indicate to the user the dirty state.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `SetDirtyStateActions`.\n */\nexport interface SetDirtyStateAction extends Action {\n    kind: typeof SetDirtyStateAction.KIND;\n    /**\n     * True if the current model state is dirty\n     */\n    isDirty: boolean;\n\n    /**\n     * A string indicating the reason for the dirty state change e.g 'operation', 'undo',...\n     */\n    reason?: DirtyStateChangeReason;\n}\n\nexport type DirtyStateChangeReason = 'operation' | 'undo' | 'redo' | 'save' | 'external';\n\nexport namespace SetDirtyStateAction {\n    export const KIND = 'setDirtyState';\n\n    export function is(object: unknown): object is SetDirtyStateAction {\n        return Action.hasKind(object, KIND) && hasBooleanProp(object, 'isDirty');\n    }\n\n    export function create(isDirty: boolean, options: { reason?: DirtyStateChangeReason } = {}): SetDirtyStateAction {\n        return {\n            kind: KIND,\n            isDirty,\n            ...options\n        };\n    }\n}\n\n/**\n * A `RequestExportSvgAction` is sent by the client (or the server) to initiate the SVG export of the current diagram.\n * The handler of this action is expected to retrieve the diagram SVG and should send a {@link ExportSvgAction} as response.\n * Typically the {@link ExportSvgAction} is handled directly on client side.\n */\nexport interface RequestExportSvgAction extends RequestAction<ExportSvgAction> {\n    kind: typeof RequestExportSvgAction.KIND;\n}\nexport namespace RequestExportSvgAction {\n    export const KIND = 'requestExportSvg';\n\n    export function is(object: unknown): object is RequestExportSvgAction {\n        return RequestAction.hasKind(object, KIND);\n    }\n\n    export function create(options: { requestId?: string } = {}): RequestExportSvgAction {\n        return {\n            kind: KIND,\n            requestId: '',\n            ...options\n        };\n    }\n}\n\n/**\n * The client sends an `ExportSvgAction` to indicate that the diagram, which represents the current model state,\n * should be exported in SVG format. The action only provides the diagram SVG as plain string. The expected result of executing\n * an `ExportSvgAction` is a new file in SVG-format on the underlying filesystem. However, other details like the target destination,\n * concrete file name, file extension etc. are not specified in the protocol. So it is the responsibility of the action handler to\n * process this information accordingly and export the result to the underlying filesystem.\n */\nexport interface ExportSvgAction extends ResponseAction {\n    kind: typeof ExportSvgAction.KIND;\n    svg: string;\n    responseId: string;\n}\nexport namespace ExportSvgAction {\n    export const KIND = 'exportSvg';\n\n    export function is(object: unknown): object is ExportSvgAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'svg');\n    }\n\n    export function create(svg: string, options: { responseId?: string } = {}): ExportSvgAction {\n        return {\n            kind: KIND,\n            svg,\n            responseId: '',\n            ...options\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Point } from 'sprotty-protocol';\nimport { hasArrayProp, hasStringProp } from '../utils/type-util';\nimport { Operation } from './base-protocol';\nimport { ElementAndBounds } from './types';\n\n/**\n * Triggers the position or size change of elements. This action concerns only the element's graphical size and position.\n * Whether an element can be resized or repositioned may be specified by the server with a `TypeHint` to allow for immediate user feedback\n * before resizing or repositioning.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `ChangeBoundsOperations`.\n */\nexport interface ChangeBoundsOperation extends Operation {\n    kind: typeof ChangeBoundsOperation.KIND;\n\n    newBounds: ElementAndBounds[];\n}\n\nexport namespace ChangeBoundsOperation {\n    export const KIND = 'changeBounds';\n\n    export function is(object: unknown): object is ChangeBoundsOperation {\n        return Operation.hasKind(object, KIND) && hasArrayProp(object, 'newBounds');\n    }\n\n    export function create(newBounds: ElementAndBounds[]): ChangeBoundsOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            newBounds\n        };\n    }\n}\n\n/**\n * The client sends a `ChangeContainerOperation` to the server to request the a semantic move i.e. the corresponding element\n * should be moved form its current container to the target container.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `ChangeContainerOperations`.\n */\nexport interface ChangeContainerOperation extends Operation {\n    kind: typeof ChangeContainerOperation.KIND;\n\n    /**\n     * The element to be changed.\n     */\n    elementId: string;\n\n    /**\n     * The element container of the changeContainer operation.\n     */\n    targetContainerId: string;\n\n    /**\n     * The graphical location.\n     */\n    location?: Point;\n}\n\nexport namespace ChangeContainerOperation {\n    export const KIND = 'changeContainer';\n\n    export function is(object: unknown): object is ChangeContainerOperation {\n        return Operation.hasKind(object, KIND) && hasStringProp(object, 'elementId') && hasStringProp(object, 'targetContainerId');\n    }\n\n    export function create(options: { elementId: string; targetContainerId: string; location?: Point }): ChangeContainerOperation {\n        return {\n            kind: KIND,\n            isOperation: true,\n            ...options\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { hasStringProp } from '../utils/type-util';\nimport { Action } from './base-protocol';\nimport { Args } from './types';\n\n/**\n * Triggers the enablement of the tool that is responsible for creating nodes and initializes it with the creation of nodes of the given\n * `elementTypeId`.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `TriggerNodeCreationActions`.\n */\nexport interface TriggerNodeCreationAction extends Action {\n    kind: typeof TriggerNodeCreationAction.KIND;\n\n    /**\n     * The type of edge that should be created by the nodes creation tool.\n     */\n    elementTypeId: string;\n\n    /**\n     * Custom arguments.\n     */\n    args?: Args;\n}\n\nexport namespace TriggerNodeCreationAction {\n    export const KIND = 'triggerNodeCreation';\n\n    export function is(object: unknown): object is TriggerNodeCreationAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'elementTypeId');\n    }\n\n    export function create(elementTypeId: string, options: { args?: Args } = {}): TriggerNodeCreationAction {\n        return {\n            kind: KIND,\n            elementTypeId,\n            ...options\n        };\n    }\n}\n\n/**\n * Triggers the enablement of the tool that is responsible for creating edges and initializes it with the creation of edges of the given\n * `elementTypeId`.\n * <Insert documentation>\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `TriggerEdgeCreationActions`.\n */\nexport interface TriggerEdgeCreationAction extends Action {\n    kind: typeof TriggerEdgeCreationAction.KIND;\n\n    /**\n     * The type of edge that should be created by the edge creation tool.\n     */\n    elementTypeId: string;\n\n    /**\n     * Custom arguments.\n     */\n    args?: Args;\n}\n\nexport namespace TriggerEdgeCreationAction {\n    export const KIND = 'triggerEdgeCreation';\n\n    export function is(object: unknown): object is TriggerEdgeCreationAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'elementTypeId');\n    }\n\n    export function create(elementTypeId: string, options: { args?: Args } = {}): TriggerEdgeCreationAction {\n        return {\n            kind: KIND,\n            elementTypeId,\n            ...options\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport * as sprotty from 'sprotty-protocol';\nimport { Dimension, Point } from 'sprotty-protocol';\nimport { AnyObject, hasArrayProp, hasStringProp } from '../utils/type-util';\nimport { Action } from './base-protocol';\nimport { TriggerEdgeCreationAction, TriggerNodeCreationAction } from './tool-palette';\n// A collection of convenience and utility types that are used in the GLSP action protocol.\n\n/**\n * A key-value pair structure for primitive typed custom arguments.\n */\nexport interface Args {\n    [key: string]: sprotty.JsonPrimitive;\n}\n\n/**\n * The ElementAndBounds type is used to associate new bounds with a model element, which is referenced via its id.\n */\nexport interface ElementAndBounds extends sprotty.ElementAndBounds {\n    /**\n     * The identifier of the element.\n     */\n    elementId: string;\n    /**\n     * The new size of the element.\n     */\n    newSize: Dimension;\n    /**\n     * The new position of the element.\n     */\n    newPosition?: Point;\n}\n\n/**\n * The `ElementAndAlignment` type is used to associate a new alignment with a model element, which is referenced via its id.\n * Typically used to align label relative to their parent element.\n */\nexport interface ElementAndAlignment extends sprotty.ElementAndAlignment {\n    /**\n     * The identifier of the element.\n     */\n    elementId: string;\n    /**\n     * The new alignment of the element.\n     */\n    newAlignment: Point;\n}\n\n/**\n * The `ElementAndRoutingPoints` type is used to associate an edge with specific routing points.\n */\nexport interface ElementAndRoutingPoints {\n    /**\n     * The identifier of an element.\n     */\n    elementId: string;\n\n    /**\n     * The new list of routing points.\n     */\n    newRoutingPoints?: Point[];\n}\n\n/**\n * The `EditorContext` may be used to represent the current state of the editor for particular actions.\n * It encompasses the last recorded mouse position, the list of selected elements, and may contain\n * custom arguments to encode additional state information.\n */\nexport interface EditorContext {\n    /**\n     * The list of selected element identifiers.\n     */\n    readonly selectedElementIds: string[];\n\n    /**\n     * The last recorded mouse position.\n     */\n    readonly lastMousePosition?: Point;\n\n    /**\n     * Custom arguments.\n     */\n    readonly args?: Args;\n}\n\nexport namespace EditorContext {\n    export function is(object: unknown): object is EditorContext {\n        return AnyObject.is(object) && hasArrayProp(object, 'selectedElementIds');\n    }\n}\n/**\n * Labeled actions are used to denote a group of actions in a user-interface context, e.g., to define an entry in the command palette or\n * in the context menu.\n * The corresponding namespace offers a helper function for type guard checks.\n */\nexport interface LabeledAction {\n    /**\n     * Group label.\n     */\n    label: string;\n\n    /**\n     * Actions in the group.\n     */\n    actions: Action[];\n    /**\n     * Optional group icon.\n     */\n    icon?: string;\n}\n\nexport namespace LabeledAction {\n    export function is(object: unknown): object is LabeledAction {\n        return AnyObject.is(object) && hasStringProp(object, 'label') && hasArrayProp(object, 'actions');\n    }\n\n    export function toActionArray(input: LabeledAction | Action[] | Action): Action[] {\n        if (Array.isArray(input)) {\n            return input;\n        } else if (LabeledAction.is(input)) {\n            return input.actions;\n        }\n        return [input];\n    }\n}\n\n/**\n * A special {@link LabeledAction} that is used to denote actions that should be triggered when the user\n * click a tool palette item (e.g. a button to create a new node).,\n */\nexport interface PaletteItem extends LabeledAction {\n    /** Technical id of the palette item. */\n    readonly id: string;\n    /** String indicating the order. */\n    readonly sortString: string;\n    /** Children of this item. If this item has children, the client will know to render them as sub group. */\n    readonly children?: PaletteItem[];\n}\n\nexport namespace PaletteItem {\n    export function is(object: unknown): object is PaletteItem {\n        return LabeledAction.is(object) && hasStringProp(object, 'id') && hasStringProp(object, 'sortString');\n    }\n\n    export function getTriggerAction(item?: PaletteItem): TriggerElementCreationAction | undefined {\n        if (item) {\n            const initialActions = item.actions\n                .filter(a => isTriggerElementCreationAction(a))\n                .map(action => action as TriggerElementCreationAction);\n            return initialActions.length > 0 ? initialActions[0] : undefined;\n        }\n        return undefined;\n    }\n\n    export type TriggerElementCreationAction = TriggerEdgeCreationAction | TriggerNodeCreationAction;\n\n    export function isTriggerElementCreationAction(object: unknown): object is TriggerElementCreationAction {\n        return TriggerNodeCreationAction.is(object) || TriggerEdgeCreationAction.is(object);\n    }\n}\n\n/**\n * A special {@link LabeledAction} that is used to denote items in a menu.\n */\nexport interface MenuItem extends LabeledAction {\n    /** Technical id of the menu item. */\n    readonly id: string;\n    /** String indicating the order. */\n    readonly sortString?: string;\n    /** String indicating the grouping (separators). Items with equal group will be in the same group. */\n    readonly group?: string;\n    /**\n     * The optional parent id can be used to add this element as a child of another element provided by another menu provider.\n     * The `parentId` must be fully qualified in the form of `a.b.c`, whereas `a`, `b` and `c` are referring to the IDs of other elements.\n     * Note that this attribute will only be considered for root items of a provider and not for children of provided items.\n     */\n    readonly parentId?: string;\n    /** Function determining whether the element is enabled. */\n    readonly isEnabled?: () => boolean;\n    /** Function determining whether the element is visible. */\n    readonly isVisible?: () => boolean;\n    /** Function determining whether the element is toggled on or off. */\n    readonly isToggled?: () => boolean;\n    /** Children of this item. If this item has children, they will be added into a submenu of this item. */\n    children?: MenuItem[];\n}\n\nexport namespace MenuItem {\n    export function is(object: unknown): object is MenuItem {\n        return LabeledAction.is(object) && hasStringProp(object, 'id');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport * as sprotty from 'sprotty-protocol/lib/actions';\nimport { Action } from './base-protocol';\n/**\n * Trigger an undo of the latest executed command.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `UndoAction`.\n */\nexport interface UndoAction extends Omit<sprotty.UndoAction, 'kind'> {\n    kind: typeof UndoAction.KIND;\n}\n\nexport namespace UndoAction {\n    export const KIND = 'glspUndo';\n\n    export function is(object: unknown): object is UndoAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(): UndoAction {\n        return {\n            kind: KIND\n        };\n    }\n}\n\n/**\n * Trigger a redo of the latest undone command.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `RedoAction`.\n */\nexport interface RedoAction extends Omit<sprotty.RedoAction, 'kind'> {\n    kind: typeof RedoAction.KIND;\n}\n\nexport namespace RedoAction {\n    export const KIND = 'glspRedo';\n\n    export function is(object: unknown): object is RedoAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(): RedoAction {\n        return {\n            kind: KIND\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport * as sprotty from 'sprotty-protocol/lib/actions';\nimport { hasArrayProp, hasBooleanProp } from '../utils/type-util';\nimport { Action } from './base-protocol';\n\n/**\n * Centers the viewport on the elements with the given identifiers. It changes the scroll setting of the viewport accordingly and resets\n * the zoom to its default. This action is usually be created on the client but it can also be sent by the server in order to perform such\n * a viewport change remotely.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `CenterActions`.\n */\nexport interface CenterAction extends Action, sprotty.CenterAction {\n    kind: typeof CenterAction.KIND;\n\n    /**\n     * The identifier of the elements on which the viewport should be centered.\n     * If empty the root element will be used.\n     */\n    elementIds: string[];\n\n    /**\n     * Indicate if the modification of the viewport should be realized with or without support of animations.\n     */\n    animate: boolean;\n\n    /**\n     * Indicates whether the zoom level should be kept.\n     */\n    retainZoom: boolean;\n}\n\nexport namespace CenterAction {\n    export const KIND = 'center';\n\n    export function is(object: unknown): object is CenterAction {\n        return Action.hasKind(object, KIND) && hasBooleanProp(object, 'animate') && hasBooleanProp(object, 'retainZoom');\n    }\n\n    export function create(elementIds: string[], options: { animate?: boolean; retainZoom?: boolean } = {}): CenterAction {\n        return {\n            kind: KIND,\n            animate: true,\n            retainZoom: false,\n            elementIds,\n            ...options\n        };\n    }\n}\n\n/**\n * Triggers to fit all or a list of elements into the available diagram canvas.\n * The corresponding namespace declares the action kind as constant and offers helper functions for type guard checks\n * and creating new `CenterActions`.\n */\nexport interface FitToScreenAction extends Action, sprotty.FitToScreenAction {\n    kind: typeof FitToScreenAction.KIND;\n\n    /**\n     * The identifier of the elements to fit on screen.\n     */\n    elementIds: string[];\n\n    /**\n     * The padding that should be visible on the viewport.\n     */\n    padding?: number;\n\n    /**\n     * The max zoom level authorized.\n     */\n    maxZoom?: number;\n\n    /**\n     * Indicate if the action should be performed with animation support or not.\n     */\n    animate: boolean;\n}\n\nexport namespace FitToScreenAction {\n    export const KIND = 'fit';\n\n    export function is(object: unknown): object is FitToScreenAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'elementIds') && hasBooleanProp(object, 'animate');\n    }\n\n    export function create(\n        elementIds: string[],\n        options: { padding?: number; maxZoom?: number; animate?: boolean } = {}\n    ): FitToScreenAction {\n        return {\n            kind: KIND,\n            animate: true,\n            elementIds,\n            ...options\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nexport * from './base-protocol';\nexport * from './client-notification';\nexport * from './clipboard';\nexport * from './contexts';\nexport * from './edge-modification';\nexport * from './element-creation';\nexport * from './element-hover';\nexport * from './element-navigation';\nexport * from './element-selection';\nexport * from './element-text-editing';\nexport * from './element-type-hints';\nexport * from './element-validation';\nexport * from './model-data';\nexport * from './model-edit-mode';\nexport * from './model-layout';\nexport * from './model-saving';\nexport * from './node-modification';\nexport * from './tool-palette';\nexport * from './types';\nexport * from './undo-redo';\nexport * from './viewport';\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ServerActionHandlerRegistry } from './action-handler';\nimport {\n    Action, isResponseAction, ResponseAction, RequestModelAction, ComputedBoundsAction, LayoutAction, RequestBoundsAction,\n    RequestAction, generateRequestId, SetModelAction, UpdateModelAction, RejectAction, isRequestAction\n} from './actions';\nimport { DiagramServices, DiagramState, IDiagramGenerator, IModelLayoutEngine } from './diagram-services';\nimport { SModelRoot } from './model';\nimport { Deferred } from './utils/async';\nimport { applyBounds, cloneModel } from './utils/model-utils';\n\n/**\n * An instance of this class is responsible for handling a single diagram client. It holds the current\n * state of the diagram and manages communication with the client via actions.\n */\nexport class DiagramServer {\n\n    readonly state: DiagramState & {\n        lastSubmittedModelType?: string\n    } = {\n        currentRoot: {\n            type: 'NONE',\n            id: 'ROOT'\n        },\n        revision: 0\n    };\n    readonly dispatch: <A extends Action>(action: A) => Promise<void>;\n\n    protected readonly diagramGenerator: IDiagramGenerator;\n    protected readonly layoutEngine?: IModelLayoutEngine;\n    protected actionHandlerRegistry?: ServerActionHandlerRegistry;\n    protected readonly requests = new Map<string, Deferred<ResponseAction>>();\n\n    constructor(dispatch: <A extends Action>(action: A) => Promise<void>,\n                services: DiagramServices) {\n        this.dispatch = dispatch;\n        this.diagramGenerator = services.DiagramGenerator;\n        this.layoutEngine = services.ModelLayoutEngine;\n        this.actionHandlerRegistry = services.ServerActionHandlerRegistry;\n    }\n\n    /**\n     * Set the model and submit it to the client.\n     */\n    setModel(newRoot: SModelRoot): Promise<void> {\n        newRoot.revision = ++this.state.revision;\n        this.state.currentRoot = newRoot;\n        return this.submitModel(newRoot, false);\n    }\n\n    /**\n     * Update the model to a new state and submit it to the client.\n     */\n    updateModel(newRoot: SModelRoot): Promise<void> {\n        newRoot.revision = ++this.state.revision;\n        this.state.currentRoot = newRoot;\n        return this.submitModel(newRoot, true);\n    }\n\n    /**\n     * Whether the client needs to compute the layout of parts of the model. This affects the behavior\n     * of `submitModel`.\n     *\n     * This setting is determined by the `DiagramOptions` that are received with the `RequestModelAction`\n     * from the client. If the client does not specify whether it needs client layout, the default value\n     * is `true`.\n     */\n    get needsClientLayout(): boolean {\n        if (this.state.options && this.state.options.needsClientLayout !== undefined) {\n            return !!this.state.options.needsClientLayout;\n        }\n        return true;\n    }\n\n    /**\n     * Whether the server needs to compute the layout of parts of the model. This affects the behavior\n     * of `submitModel`.\n     *\n     * This setting is determined by the `DiagramOptions` that are received with the `RequestModelAction`\n     * from the client. If the client does not specify whether it needs server layout, the default value\n     * is `false`.\n     */\n    get needsServerLayout(): boolean {\n        if (this.state.options && this.state.options.needsServerLayout !== undefined) {\n            return !!this.state.options.needsServerLayout;\n        }\n        return false;\n    }\n\n    /**\n     * Called when an action is received from the client.\n     */\n    accept(action: Action): Promise<void> {\n        if (isResponseAction(action)) {\n            const id = action.responseId;\n            const future = this.requests.get(id);\n            if (future) {\n                this.requests.delete(id);\n                if (action.kind === RejectAction.KIND) {\n                    const rejectAction: RejectAction = action as any;\n                    future.reject(new Error(rejectAction.message));\n                    console.warn(`Request with id ${action.responseId} failed: ${rejectAction.message}`, rejectAction.detail);\n                } else {\n                    future.resolve(action);\n                }\n                return Promise.resolve();\n            }\n            console.info('No matching request for response:', action);\n        }\n        return this.handleAction(action);\n    }\n\n    /**\n     * Send a request action to the client. The resulting promise is resolved when a matching\n     * response is received and rejected when a `RejectAction` is received.\n     */\n    request<Res extends ResponseAction>(action: RequestAction<Res>): Promise<Res> {\n        if (!action.requestId) {\n            action.requestId = 'server_' + generateRequestId();\n        }\n        const future = new Deferred<Res>();\n        this.requests.set(action.requestId, future as any);\n        this.dispatch(action).catch(err => {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.requests.delete(action.requestId!);\n            future.reject(err);\n        });\n        return future.promise;\n    }\n\n    /**\n     * Send a `RejectAction` to the client to notify that a request could not be fulfilled.\n     */\n    rejectRemoteRequest(action: Action | undefined, error: Error): void {\n        if (action && isRequestAction(action)) {\n            this.dispatch({\n                kind: RejectAction.KIND,\n                responseId: action.requestId,\n                message: error.message,\n                detail: error.stack\n            });\n        }\n    }\n\n    protected handleAction(action: Action): Promise<void> {\n        // Find a matching action handler in the registry\n        const handlers = this.actionHandlerRegistry?.getHandler(action.kind);\n        if (handlers && handlers.length === 1) {\n            return handlers[0](action, this.state, this);\n        } else if (handlers && handlers.length > 1) {\n            return Promise.all(handlers.map(h => h(action, this.state, this))) as Promise<any>;\n        }\n        // If no handler is registered, call one of the default handling methods\n        switch (action.kind) {\n            case RequestModelAction.KIND:\n                return this.handleRequestModel(action as RequestModelAction);\n            case ComputedBoundsAction.KIND:\n                return this.handleComputedBounds(action as ComputedBoundsAction);\n            case LayoutAction.KIND:\n                return this.handleLayout(action as LayoutAction);\n        }\n        // We don't know this action kind, sigh\n        console.warn(`Unhandled action from client: ${action.kind}`);\n        return Promise.resolve();\n    }\n\n    protected async handleRequestModel(action: RequestModelAction): Promise<void> {\n        this.state.options = action.options;\n        try {\n            const newRoot = await this.diagramGenerator.generate({\n                options: this.state.options ?? {},\n                state: this.state\n            });\n            newRoot.revision = ++this.state.revision;\n            this.state.currentRoot = newRoot;\n            await this.submitModel(this.state.currentRoot, false, action);\n        } catch (err) {\n            this.rejectRemoteRequest(action, err as Error);\n            console.error('Failed to generate diagram:', err);\n        }\n    }\n\n    /**\n     * Submit a model to the client after it has been updated in the server state.\n     */\n     protected async submitModel(newRoot: SModelRoot, update: boolean, cause?: Action): Promise<void> {\n        if (this.needsClientLayout) {\n            if (!this.needsServerLayout) {\n                // In this case the client won't send us the computed bounds\n                this.dispatch({ kind: RequestBoundsAction.KIND, newRoot });\n            } else {\n                const request = RequestBoundsAction.create(newRoot);\n                const response = await this.request<ComputedBoundsAction>(request);\n                const currentRoot = this.state.currentRoot;\n                if (response.revision === currentRoot.revision) {\n                    applyBounds(currentRoot, response);\n                    await this.doSubmitModel(currentRoot, update, cause);\n                } else {\n                    this.rejectRemoteRequest(cause, new Error(`Model revision does not match: ${response.revision}`));\n                }\n            }\n        } else {\n            await this.doSubmitModel(newRoot, update, cause);\n        }\n    }\n\n    private async doSubmitModel(newRoot: SModelRoot, update: boolean, cause?: Action): Promise<void> {\n        if (newRoot.revision !== this.state.revision) {\n            return;\n        }\n        if (this.needsServerLayout && this.layoutEngine) {\n            newRoot = await this.layoutEngine.layout(newRoot);\n        }\n        const modelType = newRoot.type;\n        if (cause && cause.kind === RequestModelAction.KIND) {\n            const requestId = (cause as RequestModelAction).requestId;\n            const response = SetModelAction.create(newRoot, requestId);\n            await this.dispatch(response);\n        } else if (update && modelType === this.state.lastSubmittedModelType) {\n            await this.dispatch({ kind: UpdateModelAction.KIND, newRoot, cause });\n        } else {\n            await this.dispatch({ kind: SetModelAction.KIND, newRoot });\n        }\n        this.state.lastSubmittedModelType = modelType;\n    }\n\n    protected handleComputedBounds(action: ComputedBoundsAction): Promise<void> {\n        if (action.revision !== this.state.currentRoot.revision) {\n            return Promise.reject();\n        }\n        applyBounds(this.state.currentRoot, action);\n        return Promise.resolve();\n    }\n\n    protected async handleLayout(action: LayoutAction): Promise<void> {\n        if (!this.layoutEngine) {\n            return;\n        }\n        if (!this.needsServerLayout) {\n            let newRoot = cloneModel(this.state.currentRoot);\n            newRoot = await this.layoutEngine.layout(newRoot);\n            newRoot.revision = ++this.state.revision;\n            this.state.currentRoot = newRoot;\n        }\n        await this.doSubmitModel(this.state.currentRoot, true, action);\n    }\n\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Bounds, Point, Dimension } from './utils/geometry';\nimport { hasOwnProperty } from './utils/object';\n\n/**\n * Base type for all elements of the diagram model.\n * Each model element must have a unique ID and a type that is used to look up its view.\n */\nexport interface SModelElement {\n    type: string\n    id: string\n    children?: SModelElement[]\n    cssClasses?: string[]\n}\n\n/**\n * Base type for the root element of the diagram model tree.\n */\nexport interface SModelRoot extends SModelElement {\n    canvasBounds?: Bounds\n    revision?: number\n}\n\n/**\n * Model elements that implement this interface have a position and a size.\n */\nexport interface BoundsAware {\n    position: Point\n    size: Dimension\n}\n\n/**\n * Used to adjust elements whose bounding box is not at the origin, e.g. labels\n * or pre-rendered SVG figures.\n */\nexport interface Alignable {\n    alignment: Point\n}\n\n/**\n * A viewport has a scroll position and a zoom factor. Usually these properties are\n * applied to the root element to enable navigating through the diagram.\n */\nexport interface Viewport extends Scrollable, Zoomable {\n}\n\n/**\n * Usually the root of a model is also a viewport.\n */\nexport interface ViewportRootElement extends SModelRoot {\n    scroll?: Point\n    zoom?: number\n    position?: Point\n    size?: Dimension\n}\n\n/**\n * A scrollable element has a scroll position, which indicates the top left corner of the\n * visible area.\n */\nexport interface Scrollable {\n    scroll: Point\n}\n\nexport function isScrollable(element: SModelElement | Scrollable): element is Scrollable {\n    return hasOwnProperty(element, 'scroll');\n}\n\n/**\n * A zoomable element can be scaled so it appears smaller or larger than its actual size.\n * The zoom value 1 is the default scale where the content is drawn with its actual size.\n */\nexport interface Zoomable {\n    zoom: number\n}\n\nexport function isZoomable(element: SModelElement | Zoomable): element is Zoomable {\n    return hasOwnProperty(element, 'zoom');\n}\n\n/**\n * Root element for graph-like models.\n */\nexport interface SGraph extends SModelRoot {\n    children: SModelElement[]\n    bounds?: Bounds\n    scroll?: Point\n    zoom?: number\n    layoutOptions?: ModelLayoutOptions\n}\n\n/**\n * Options to control the \"micro layout\" of a model element, i.e. the arrangement of its content\n * using simple algorithms such as horizontal or vertical box layout.\n */\nexport type ModelLayoutOptions = { [key: string]: string | number | boolean };\n\nexport interface SShapeElement extends SModelElement {\n    position?: Point\n    size?: Dimension\n    layoutOptions?: ModelLayoutOptions\n}\n\n/**\n * Model element class for nodes, which are the main entities in a graph. A node can be connected to\n * another node via an SEdge. Such a connection can be direct, i.e. the node is the source or target of\n * the edge, or indirect through a port, i.e. it contains an SPort which is the source or target of the edge.\n */\nexport interface SNode extends SShapeElement {\n    layout?: string\n    selected?: boolean\n    hoverFeedback?: boolean\n    opacity?: number\n    anchorKind?: string\n}\n\n/**\n * A port is a connection point for edges. It should always be contained in an SNode.\n */\nexport interface SPort extends SShapeElement {\n    selected?: boolean\n    hoverFeedback?: boolean\n    opacity?: number\n    anchorKind?: string\n}\n\n/**\n * Model element class for edges, which are the connectors in a graph. An edge has a source and a target,\n * each of which can be either a node or a port. The source and target elements are referenced via their ids.\n */\nexport interface SEdge extends SModelElement {\n    sourceId: string\n    targetId: string\n    routerKind?: string\n    routingPoints?: Point[]\n    selected?: boolean\n    hoverFeedback?: boolean\n    opacity?: number\n}\n\n/**\n * A label can be attached to a node, edge, or port, and contains some text to be rendered in its view.\n */\nexport interface SLabel extends SShapeElement {\n    text: string\n    selected?: boolean\n}\n\n/**\n * A compartment is used to group multiple child elements such as labels of a node. Usually a `vbox`\n * or `hbox` layout is used to arrange these children.\n */\nexport interface SCompartment extends SShapeElement {\n    layout?: string\n}\n\n/**\n * Root model element class for HTML content. Usually this is rendered with a `div` DOM element.\n */\nexport interface HtmlRoot extends SModelRoot {\n    classes?: string[]\n}\n\n/**\n * Pre-rendered elements contain HTML or SVG code to be transferred to the DOM. This can be useful to\n * render complex figures or to compute the view on the server instead of the client code.\n */\nexport interface PreRenderedElement extends SModelElement {\n    code: string\n}\n\n/**\n * Same as PreRenderedElement, but with a position and a size.\n */\nexport interface ShapedPreRenderedElement extends PreRenderedElement {\n    position?: Point\n    size?: Dimension\n}\n\n/**\n * A `foreignObject` element to be transferred to the DOM within the SVG.\n *\n * This can be useful to to benefit from e.g. HTML rendering features, such as line wrapping, inside of\n * the SVG diagram.  Note that `foreignObject` is not supported by all browsers and SVG viewers may not\n * support rendering the `foreignObject` content.\n *\n * If no dimensions are specified in the schema element, this element will obtain the dimension of\n * its parent to fill the entire available room. Thus, this element requires specified bounds itself\n * or bounds to be available for its parent.\n */\nexport interface ForeignObjectElement extends ShapedPreRenderedElement {\n    /** The namespace to be assigned to the elements inside of the `foreignObject`. */\n    namespace: string\n}\n", "/********************************************************************************\n * Copyright (c) 2021 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport * from './actions';\nexport * from './diagram-server';\nexport * from './diagram-services';\nexport * from './model';\nexport * from './utils/async';\nexport * from './utils/geometry';\nexport * from './utils/json';\nexport * from './utils/model-utils';\nexport * from './utils/object';\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.stringArray = exports.array = exports.func = exports.error = exports.number = exports.string = exports.boolean = void 0;\nfunction boolean(value) {\n    return value === true || value === false;\n}\nexports.boolean = boolean;\nfunction string(value) {\n    return typeof value === 'string' || value instanceof String;\n}\nexports.string = string;\nfunction number(value) {\n    return typeof value === 'number' || value instanceof Number;\n}\nexports.number = number;\nfunction error(value) {\n    return value instanceof Error;\n}\nexports.error = error;\nfunction func(value) {\n    return typeof value === 'function';\n}\nexports.func = func;\nfunction array(value) {\n    return Array.isArray(value);\n}\nexports.array = array;\nfunction stringArray(value) {\n    return array(value) && value.every(elem => string(elem));\n}\nexports.stringArray = stringArray;\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Message = exports.NotificationType9 = exports.NotificationType8 = exports.NotificationType7 = exports.NotificationType6 = exports.NotificationType5 = exports.NotificationType4 = exports.NotificationType3 = exports.NotificationType2 = exports.NotificationType1 = exports.NotificationType0 = exports.NotificationType = exports.RequestType9 = exports.RequestType8 = exports.RequestType7 = exports.RequestType6 = exports.RequestType5 = exports.RequestType4 = exports.RequestType3 = exports.RequestType2 = exports.RequestType1 = exports.RequestType = exports.RequestType0 = exports.AbstractMessageSignature = exports.ParameterStructures = exports.ResponseError = exports.ErrorCodes = void 0;\nconst is = require(\"./is\");\n/**\n * Predefined error codes.\n */\nvar ErrorCodes;\n(function (ErrorCodes) {\n    // Defined by JSON RPC\n    ErrorCodes.ParseError = -32700;\n    ErrorCodes.InvalidRequest = -32600;\n    ErrorCodes.MethodNotFound = -32601;\n    ErrorCodes.InvalidParams = -32602;\n    ErrorCodes.InternalError = -32603;\n    /**\n     * This is the start range of JSON RPC reserved error codes.\n     * It doesn't denote a real error code. No application error codes should\n     * be defined between the start and end range. For backwards\n     * compatibility the `ServerNotInitialized` and the `UnknownErrorCode`\n     * are left in the range.\n     *\n     * @since 3.16.0\n    */\n    ErrorCodes.jsonrpcReservedErrorRangeStart = -32099;\n    /** @deprecated use  jsonrpcReservedErrorRangeStart */\n    ErrorCodes.serverErrorStart = -32099;\n    /**\n     * An error occurred when write a message to the transport layer.\n     */\n    ErrorCodes.MessageWriteError = -32099;\n    /**\n     * An error occurred when reading a message from the transport layer.\n     */\n    ErrorCodes.MessageReadError = -32098;\n    /**\n     * The connection got disposed or lost and all pending responses got\n     * rejected.\n     */\n    ErrorCodes.PendingResponseRejected = -32097;\n    /**\n     * The connection is inactive and a use of it failed.\n     */\n    ErrorCodes.ConnectionInactive = -32096;\n    /**\n     * Error code indicating that a server received a notification or\n     * request before the server has received the `initialize` request.\n     */\n    ErrorCodes.ServerNotInitialized = -32002;\n    ErrorCodes.UnknownErrorCode = -32001;\n    /**\n     * This is the end range of JSON RPC reserved error codes.\n     * It doesn't denote a real error code.\n     *\n     * @since 3.16.0\n    */\n    ErrorCodes.jsonrpcReservedErrorRangeEnd = -32000;\n    /** @deprecated use  jsonrpcReservedErrorRangeEnd */\n    ErrorCodes.serverErrorEnd = -32000;\n})(ErrorCodes || (exports.ErrorCodes = ErrorCodes = {}));\n/**\n * An error object return in a response in case a request\n * has failed.\n */\nclass ResponseError extends Error {\n    constructor(code, message, data) {\n        super(message);\n        this.code = is.number(code) ? code : ErrorCodes.UnknownErrorCode;\n        this.data = data;\n        Object.setPrototypeOf(this, ResponseError.prototype);\n    }\n    toJson() {\n        const result = {\n            code: this.code,\n            message: this.message\n        };\n        if (this.data !== undefined) {\n            result.data = this.data;\n        }\n        return result;\n    }\n}\nexports.ResponseError = ResponseError;\nclass ParameterStructures {\n    constructor(kind) {\n        this.kind = kind;\n    }\n    static is(value) {\n        return value === ParameterStructures.auto || value === ParameterStructures.byName || value === ParameterStructures.byPosition;\n    }\n    toString() {\n        return this.kind;\n    }\n}\nexports.ParameterStructures = ParameterStructures;\n/**\n * The parameter structure is automatically inferred on the number of parameters\n * and the parameter type in case of a single param.\n */\nParameterStructures.auto = new ParameterStructures('auto');\n/**\n * Forces `byPosition` parameter structure. This is useful if you have a single\n * parameter which has a literal type.\n */\nParameterStructures.byPosition = new ParameterStructures('byPosition');\n/**\n * Forces `byName` parameter structure. This is only useful when having a single\n * parameter. The library will report errors if used with a different number of\n * parameters.\n */\nParameterStructures.byName = new ParameterStructures('byName');\n/**\n * An abstract implementation of a MessageType.\n */\nclass AbstractMessageSignature {\n    constructor(method, numberOfParams) {\n        this.method = method;\n        this.numberOfParams = numberOfParams;\n    }\n    get parameterStructures() {\n        return ParameterStructures.auto;\n    }\n}\nexports.AbstractMessageSignature = AbstractMessageSignature;\n/**\n * Classes to type request response pairs\n */\nclass RequestType0 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 0);\n    }\n}\nexports.RequestType0 = RequestType0;\nclass RequestType extends AbstractMessageSignature {\n    constructor(method, _parameterStructures = ParameterStructures.auto) {\n        super(method, 1);\n        this._parameterStructures = _parameterStructures;\n    }\n    get parameterStructures() {\n        return this._parameterStructures;\n    }\n}\nexports.RequestType = RequestType;\nclass RequestType1 extends AbstractMessageSignature {\n    constructor(method, _parameterStructures = ParameterStructures.auto) {\n        super(method, 1);\n        this._parameterStructures = _parameterStructures;\n    }\n    get parameterStructures() {\n        return this._parameterStructures;\n    }\n}\nexports.RequestType1 = RequestType1;\nclass RequestType2 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 2);\n    }\n}\nexports.RequestType2 = RequestType2;\nclass RequestType3 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 3);\n    }\n}\nexports.RequestType3 = RequestType3;\nclass RequestType4 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 4);\n    }\n}\nexports.RequestType4 = RequestType4;\nclass RequestType5 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 5);\n    }\n}\nexports.RequestType5 = RequestType5;\nclass RequestType6 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 6);\n    }\n}\nexports.RequestType6 = RequestType6;\nclass RequestType7 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 7);\n    }\n}\nexports.RequestType7 = RequestType7;\nclass RequestType8 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 8);\n    }\n}\nexports.RequestType8 = RequestType8;\nclass RequestType9 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 9);\n    }\n}\nexports.RequestType9 = RequestType9;\nclass NotificationType extends AbstractMessageSignature {\n    constructor(method, _parameterStructures = ParameterStructures.auto) {\n        super(method, 1);\n        this._parameterStructures = _parameterStructures;\n    }\n    get parameterStructures() {\n        return this._parameterStructures;\n    }\n}\nexports.NotificationType = NotificationType;\nclass NotificationType0 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 0);\n    }\n}\nexports.NotificationType0 = NotificationType0;\nclass NotificationType1 extends AbstractMessageSignature {\n    constructor(method, _parameterStructures = ParameterStructures.auto) {\n        super(method, 1);\n        this._parameterStructures = _parameterStructures;\n    }\n    get parameterStructures() {\n        return this._parameterStructures;\n    }\n}\nexports.NotificationType1 = NotificationType1;\nclass NotificationType2 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 2);\n    }\n}\nexports.NotificationType2 = NotificationType2;\nclass NotificationType3 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 3);\n    }\n}\nexports.NotificationType3 = NotificationType3;\nclass NotificationType4 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 4);\n    }\n}\nexports.NotificationType4 = NotificationType4;\nclass NotificationType5 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 5);\n    }\n}\nexports.NotificationType5 = NotificationType5;\nclass NotificationType6 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 6);\n    }\n}\nexports.NotificationType6 = NotificationType6;\nclass NotificationType7 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 7);\n    }\n}\nexports.NotificationType7 = NotificationType7;\nclass NotificationType8 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 8);\n    }\n}\nexports.NotificationType8 = NotificationType8;\nclass NotificationType9 extends AbstractMessageSignature {\n    constructor(method) {\n        super(method, 9);\n    }\n}\nexports.NotificationType9 = NotificationType9;\nvar Message;\n(function (Message) {\n    /**\n     * Tests if the given message is a request message\n     */\n    function isRequest(message) {\n        const candidate = message;\n        return candidate && is.string(candidate.method) && (is.string(candidate.id) || is.number(candidate.id));\n    }\n    Message.isRequest = isRequest;\n    /**\n     * Tests if the given message is a notification message\n     */\n    function isNotification(message) {\n        const candidate = message;\n        return candidate && is.string(candidate.method) && message.id === void 0;\n    }\n    Message.isNotification = isNotification;\n    /**\n     * Tests if the given message is a response message\n     */\n    function isResponse(message) {\n        const candidate = message;\n        return candidate && (candidate.result !== void 0 || !!candidate.error) && (is.string(candidate.id) || is.number(candidate.id) || candidate.id === null);\n    }\n    Message.isResponse = isResponse;\n})(Message || (exports.Message = Message = {}));\n", "\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LRUCache = exports.LinkedMap = exports.Touch = void 0;\nvar Touch;\n(function (Touch) {\n    Touch.None = 0;\n    Touch.First = 1;\n    Touch.AsOld = Touch.First;\n    Touch.Last = 2;\n    Touch.AsNew = Touch.Last;\n})(Touch || (exports.Touch = Touch = {}));\nclass LinkedMap {\n    constructor() {\n        this[_a] = 'LinkedMap';\n        this._map = new Map();\n        this._head = undefined;\n        this._tail = undefined;\n        this._size = 0;\n        this._state = 0;\n    }\n    clear() {\n        this._map.clear();\n        this._head = undefined;\n        this._tail = undefined;\n        this._size = 0;\n        this._state++;\n    }\n    isEmpty() {\n        return !this._head && !this._tail;\n    }\n    get size() {\n        return this._size;\n    }\n    get first() {\n        return this._head?.value;\n    }\n    get last() {\n        return this._tail?.value;\n    }\n    has(key) {\n        return this._map.has(key);\n    }\n    get(key, touch = Touch.None) {\n        const item = this._map.get(key);\n        if (!item) {\n            return undefined;\n        }\n        if (touch !== Touch.None) {\n            this.touch(item, touch);\n        }\n        return item.value;\n    }\n    set(key, value, touch = Touch.None) {\n        let item = this._map.get(key);\n        if (item) {\n            item.value = value;\n            if (touch !== Touch.None) {\n                this.touch(item, touch);\n            }\n        }\n        else {\n            item = { key, value, next: undefined, previous: undefined };\n            switch (touch) {\n                case Touch.None:\n                    this.addItemLast(item);\n                    break;\n                case Touch.First:\n                    this.addItemFirst(item);\n                    break;\n                case Touch.Last:\n                    this.addItemLast(item);\n                    break;\n                default:\n                    this.addItemLast(item);\n                    break;\n            }\n            this._map.set(key, item);\n            this._size++;\n        }\n        return this;\n    }\n    delete(key) {\n        return !!this.remove(key);\n    }\n    remove(key) {\n        const item = this._map.get(key);\n        if (!item) {\n            return undefined;\n        }\n        this._map.delete(key);\n        this.removeItem(item);\n        this._size--;\n        return item.value;\n    }\n    shift() {\n        if (!this._head && !this._tail) {\n            return undefined;\n        }\n        if (!this._head || !this._tail) {\n            throw new Error('Invalid list');\n        }\n        const item = this._head;\n        this._map.delete(item.key);\n        this.removeItem(item);\n        this._size--;\n        return item.value;\n    }\n    forEach(callbackfn, thisArg) {\n        const state = this._state;\n        let current = this._head;\n        while (current) {\n            if (thisArg) {\n                callbackfn.bind(thisArg)(current.value, current.key, this);\n            }\n            else {\n                callbackfn(current.value, current.key, this);\n            }\n            if (this._state !== state) {\n                throw new Error(`LinkedMap got modified during iteration.`);\n            }\n            current = current.next;\n        }\n    }\n    keys() {\n        const state = this._state;\n        let current = this._head;\n        const iterator = {\n            [Symbol.iterator]: () => {\n                return iterator;\n            },\n            next: () => {\n                if (this._state !== state) {\n                    throw new Error(`LinkedMap got modified during iteration.`);\n                }\n                if (current) {\n                    const result = { value: current.key, done: false };\n                    current = current.next;\n                    return result;\n                }\n                else {\n                    return { value: undefined, done: true };\n                }\n            }\n        };\n        return iterator;\n    }\n    values() {\n        const state = this._state;\n        let current = this._head;\n        const iterator = {\n            [Symbol.iterator]: () => {\n                return iterator;\n            },\n            next: () => {\n                if (this._state !== state) {\n                    throw new Error(`LinkedMap got modified during iteration.`);\n                }\n                if (current) {\n                    const result = { value: current.value, done: false };\n                    current = current.next;\n                    return result;\n                }\n                else {\n                    return { value: undefined, done: true };\n                }\n            }\n        };\n        return iterator;\n    }\n    entries() {\n        const state = this._state;\n        let current = this._head;\n        const iterator = {\n            [Symbol.iterator]: () => {\n                return iterator;\n            },\n            next: () => {\n                if (this._state !== state) {\n                    throw new Error(`LinkedMap got modified during iteration.`);\n                }\n                if (current) {\n                    const result = { value: [current.key, current.value], done: false };\n                    current = current.next;\n                    return result;\n                }\n                else {\n                    return { value: undefined, done: true };\n                }\n            }\n        };\n        return iterator;\n    }\n    [(_a = Symbol.toStringTag, Symbol.iterator)]() {\n        return this.entries();\n    }\n    trimOld(newSize) {\n        if (newSize >= this.size) {\n            return;\n        }\n        if (newSize === 0) {\n            this.clear();\n            return;\n        }\n        let current = this._head;\n        let currentSize = this.size;\n        while (current && currentSize > newSize) {\n            this._map.delete(current.key);\n            current = current.next;\n            currentSize--;\n        }\n        this._head = current;\n        this._size = currentSize;\n        if (current) {\n            current.previous = undefined;\n        }\n        this._state++;\n    }\n    addItemFirst(item) {\n        // First time Insert\n        if (!this._head && !this._tail) {\n            this._tail = item;\n        }\n        else if (!this._head) {\n            throw new Error('Invalid list');\n        }\n        else {\n            item.next = this._head;\n            this._head.previous = item;\n        }\n        this._head = item;\n        this._state++;\n    }\n    addItemLast(item) {\n        // First time Insert\n        if (!this._head && !this._tail) {\n            this._head = item;\n        }\n        else if (!this._tail) {\n            throw new Error('Invalid list');\n        }\n        else {\n            item.previous = this._tail;\n            this._tail.next = item;\n        }\n        this._tail = item;\n        this._state++;\n    }\n    removeItem(item) {\n        if (item === this._head && item === this._tail) {\n            this._head = undefined;\n            this._tail = undefined;\n        }\n        else if (item === this._head) {\n            // This can only happened if size === 1 which is handle\n            // by the case above.\n            if (!item.next) {\n                throw new Error('Invalid list');\n            }\n            item.next.previous = undefined;\n            this._head = item.next;\n        }\n        else if (item === this._tail) {\n            // This can only happened if size === 1 which is handle\n            // by the case above.\n            if (!item.previous) {\n                throw new Error('Invalid list');\n            }\n            item.previous.next = undefined;\n            this._tail = item.previous;\n        }\n        else {\n            const next = item.next;\n            const previous = item.previous;\n            if (!next || !previous) {\n                throw new Error('Invalid list');\n            }\n            next.previous = previous;\n            previous.next = next;\n        }\n        item.next = undefined;\n        item.previous = undefined;\n        this._state++;\n    }\n    touch(item, touch) {\n        if (!this._head || !this._tail) {\n            throw new Error('Invalid list');\n        }\n        if ((touch !== Touch.First && touch !== Touch.Last)) {\n            return;\n        }\n        if (touch === Touch.First) {\n            if (item === this._head) {\n                return;\n            }\n            const next = item.next;\n            const previous = item.previous;\n            // Unlink the item\n            if (item === this._tail) {\n                // previous must be defined since item was not head but is tail\n                // So there are more than on item in the map\n                previous.next = undefined;\n                this._tail = previous;\n            }\n            else {\n                // Both next and previous are not undefined since item was neither head nor tail.\n                next.previous = previous;\n                previous.next = next;\n            }\n            // Insert the node at head\n            item.previous = undefined;\n            item.next = this._head;\n            this._head.previous = item;\n            this._head = item;\n            this._state++;\n        }\n        else if (touch === Touch.Last) {\n            if (item === this._tail) {\n                return;\n            }\n            const next = item.next;\n            const previous = item.previous;\n            // Unlink the item.\n            if (item === this._head) {\n                // next must be defined since item was not tail but is head\n                // So there are more than on item in the map\n                next.previous = undefined;\n                this._head = next;\n            }\n            else {\n                // Both next and previous are not undefined since item was neither head nor tail.\n                next.previous = previous;\n                previous.next = next;\n            }\n            item.next = undefined;\n            item.previous = this._tail;\n            this._tail.next = item;\n            this._tail = item;\n            this._state++;\n        }\n    }\n    toJSON() {\n        const data = [];\n        this.forEach((value, key) => {\n            data.push([key, value]);\n        });\n        return data;\n    }\n    fromJSON(data) {\n        this.clear();\n        for (const [key, value] of data) {\n            this.set(key, value);\n        }\n    }\n}\nexports.LinkedMap = LinkedMap;\nclass LRUCache extends LinkedMap {\n    constructor(limit, ratio = 1) {\n        super();\n        this._limit = limit;\n        this._ratio = Math.min(Math.max(0, ratio), 1);\n    }\n    get limit() {\n        return this._limit;\n    }\n    set limit(limit) {\n        this._limit = limit;\n        this.checkTrim();\n    }\n    get ratio() {\n        return this._ratio;\n    }\n    set ratio(ratio) {\n        this._ratio = Math.min(Math.max(0, ratio), 1);\n        this.checkTrim();\n    }\n    get(key, touch = Touch.AsNew) {\n        return super.get(key, touch);\n    }\n    peek(key) {\n        return super.get(key, Touch.None);\n    }\n    set(key, value) {\n        super.set(key, value, Touch.Last);\n        this.checkTrim();\n        return this;\n    }\n    checkTrim() {\n        if (this.size > this._limit) {\n            this.trimOld(Math.round(this._limit * this._ratio));\n        }\n    }\n}\nexports.LRUCache = LRUCache;\n", "\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Disposable = void 0;\nvar Disposable;\n(function (Disposable) {\n    function create(func) {\n        return {\n            dispose: func\n        };\n    }\n    Disposable.create = create;\n})(Disposable || (exports.Disposable = Disposable = {}));\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nlet _ral;\nfunction RAL() {\n    if (_ral === undefined) {\n        throw new Error(`No runtime abstraction layer installed`);\n    }\n    return _ral;\n}\n(function (RAL) {\n    function install(ral) {\n        if (ral === undefined) {\n            throw new Error(`No runtime abstraction layer provided`);\n        }\n        _ral = ral;\n    }\n    RAL.install = install;\n})(RAL || (RAL = {}));\nexports.default = RAL;\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Emitter = exports.Event = void 0;\nconst ral_1 = require(\"./ral\");\nvar Event;\n(function (Event) {\n    const _disposable = { dispose() { } };\n    Event.None = function () { return _disposable; };\n})(Event || (exports.Event = Event = {}));\nclass CallbackList {\n    add(callback, context = null, bucket) {\n        if (!this._callbacks) {\n            this._callbacks = [];\n            this._contexts = [];\n        }\n        this._callbacks.push(callback);\n        this._contexts.push(context);\n        if (Array.isArray(bucket)) {\n            bucket.push({ dispose: () => this.remove(callback, context) });\n        }\n    }\n    remove(callback, context = null) {\n        if (!this._callbacks) {\n            return;\n        }\n        let foundCallbackWithDifferentContext = false;\n        for (let i = 0, len = this._callbacks.length; i < len; i++) {\n            if (this._callbacks[i] === callback) {\n                if (this._contexts[i] === context) {\n                    // callback & context match => remove it\n                    this._callbacks.splice(i, 1);\n                    this._contexts.splice(i, 1);\n                    return;\n                }\n                else {\n                    foundCallbackWithDifferentContext = true;\n                }\n            }\n        }\n        if (foundCallbackWithDifferentContext) {\n            throw new Error('When adding a listener with a context, you should remove it with the same context');\n        }\n    }\n    invoke(...args) {\n        if (!this._callbacks) {\n            return [];\n        }\n        const ret = [], callbacks = this._callbacks.slice(0), contexts = this._contexts.slice(0);\n        for (let i = 0, len = callbacks.length; i < len; i++) {\n            try {\n                ret.push(callbacks[i].apply(contexts[i], args));\n            }\n            catch (e) {\n                // eslint-disable-next-line no-console\n                (0, ral_1.default)().console.error(e);\n            }\n        }\n        return ret;\n    }\n    isEmpty() {\n        return !this._callbacks || this._callbacks.length === 0;\n    }\n    dispose() {\n        this._callbacks = undefined;\n        this._contexts = undefined;\n    }\n}\nclass Emitter {\n    constructor(_options) {\n        this._options = _options;\n    }\n    /**\n     * For the public to allow to subscribe\n     * to events from this Emitter\n     */\n    get event() {\n        if (!this._event) {\n            this._event = (listener, thisArgs, disposables) => {\n                if (!this._callbacks) {\n                    this._callbacks = new CallbackList();\n                }\n                if (this._options && this._options.onFirstListenerAdd && this._callbacks.isEmpty()) {\n                    this._options.onFirstListenerAdd(this);\n                }\n                this._callbacks.add(listener, thisArgs);\n                const result = {\n                    dispose: () => {\n                        if (!this._callbacks) {\n                            // disposable is disposed after emitter is disposed.\n                            return;\n                        }\n                        this._callbacks.remove(listener, thisArgs);\n                        result.dispose = Emitter._noop;\n                        if (this._options && this._options.onLastListenerRemove && this._callbacks.isEmpty()) {\n                            this._options.onLastListenerRemove(this);\n                        }\n                    }\n                };\n                if (Array.isArray(disposables)) {\n                    disposables.push(result);\n                }\n                return result;\n            };\n        }\n        return this._event;\n    }\n    /**\n     * To be kept private to fire an event to\n     * subscribers\n     */\n    fire(event) {\n        if (this._callbacks) {\n            this._callbacks.invoke.call(this._callbacks, event);\n        }\n    }\n    dispose() {\n        if (this._callbacks) {\n            this._callbacks.dispose();\n            this._callbacks = undefined;\n        }\n    }\n}\nexports.Emitter = Emitter;\nEmitter._noop = function () { };\n", "\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CancellationTokenSource = exports.CancellationToken = void 0;\nconst ral_1 = require(\"./ral\");\nconst Is = require(\"./is\");\nconst events_1 = require(\"./events\");\nvar CancellationToken;\n(function (CancellationToken) {\n    CancellationToken.None = Object.freeze({\n        isCancellationRequested: false,\n        onCancellationRequested: events_1.Event.None\n    });\n    CancellationToken.Cancelled = Object.freeze({\n        isCancellationRequested: true,\n        onCancellationRequested: events_1.Event.None\n    });\n    function is(value) {\n        const candidate = value;\n        return candidate && (candidate === CancellationToken.None\n            || candidate === CancellationToken.Cancelled\n            || (Is.boolean(candidate.isCancellationRequested) && !!candidate.onCancellationRequested));\n    }\n    CancellationToken.is = is;\n})(CancellationToken || (exports.CancellationToken = CancellationToken = {}));\nconst shortcutEvent = Object.freeze(function (callback, context) {\n    const handle = (0, ral_1.default)().timer.setTimeout(callback.bind(context), 0);\n    return { dispose() { handle.dispose(); } };\n});\nclass MutableToken {\n    constructor() {\n        this._isCancelled = false;\n    }\n    cancel() {\n        if (!this._isCancelled) {\n            this._isCancelled = true;\n            if (this._emitter) {\n                this._emitter.fire(undefined);\n                this.dispose();\n            }\n        }\n    }\n    get isCancellationRequested() {\n        return this._isCancelled;\n    }\n    get onCancellationRequested() {\n        if (this._isCancelled) {\n            return shortcutEvent;\n        }\n        if (!this._emitter) {\n            this._emitter = new events_1.Emitter();\n        }\n        return this._emitter.event;\n    }\n    dispose() {\n        if (this._emitter) {\n            this._emitter.dispose();\n            this._emitter = undefined;\n        }\n    }\n}\nclass CancellationTokenSource {\n    get token() {\n        if (!this._token) {\n            // be lazy and create the token only when\n            // actually needed\n            this._token = new MutableToken();\n        }\n        return this._token;\n    }\n    cancel() {\n        if (!this._token) {\n            // save an object by returning the default\n            // cancelled token when cancellation happens\n            // before someone asks for the token\n            this._token = CancellationToken.Cancelled;\n        }\n        else {\n            this._token.cancel();\n        }\n    }\n    dispose() {\n        if (!this._token) {\n            // ensure to initialize with an empty token if we had none\n            this._token = CancellationToken.None;\n        }\n        else if (this._token instanceof MutableToken) {\n            // actually dispose\n            this._token.dispose();\n        }\n    }\n}\nexports.CancellationTokenSource = CancellationTokenSource;\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SharedArrayReceiverStrategy = exports.SharedArraySenderStrategy = void 0;\nconst cancellation_1 = require(\"./cancellation\");\nvar CancellationState;\n(function (CancellationState) {\n    CancellationState.Continue = 0;\n    CancellationState.Cancelled = 1;\n})(CancellationState || (CancellationState = {}));\nclass SharedArraySenderStrategy {\n    constructor() {\n        this.buffers = new Map();\n    }\n    enableCancellation(request) {\n        if (request.id === null) {\n            return;\n        }\n        const buffer = new SharedArrayBuffer(4);\n        const data = new Int32Array(buffer, 0, 1);\n        data[0] = CancellationState.Continue;\n        this.buffers.set(request.id, buffer);\n        request.$cancellationData = buffer;\n    }\n    async sendCancellation(_conn, id) {\n        const buffer = this.buffers.get(id);\n        if (buffer === undefined) {\n            return;\n        }\n        const data = new Int32Array(buffer, 0, 1);\n        Atomics.store(data, 0, CancellationState.Cancelled);\n    }\n    cleanup(id) {\n        this.buffers.delete(id);\n    }\n    dispose() {\n        this.buffers.clear();\n    }\n}\nexports.SharedArraySenderStrategy = SharedArraySenderStrategy;\nclass SharedArrayBufferCancellationToken {\n    constructor(buffer) {\n        this.data = new Int32Array(buffer, 0, 1);\n    }\n    get isCancellationRequested() {\n        return Atomics.load(this.data, 0) === CancellationState.Cancelled;\n    }\n    get onCancellationRequested() {\n        throw new Error(`Cancellation over SharedArrayBuffer doesn't support cancellation events`);\n    }\n}\nclass SharedArrayBufferCancellationTokenSource {\n    constructor(buffer) {\n        this.token = new SharedArrayBufferCancellationToken(buffer);\n    }\n    cancel() {\n    }\n    dispose() {\n    }\n}\nclass SharedArrayReceiverStrategy {\n    constructor() {\n        this.kind = 'request';\n    }\n    createCancellationTokenSource(request) {\n        const buffer = request.$cancellationData;\n        if (buffer === undefined) {\n            return new cancellation_1.CancellationTokenSource();\n        }\n        return new SharedArrayBufferCancellationTokenSource(buffer);\n    }\n}\nexports.SharedArrayReceiverStrategy = SharedArrayReceiverStrategy;\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Semaphore = void 0;\nconst ral_1 = require(\"./ral\");\nclass Semaphore {\n    constructor(capacity = 1) {\n        if (capacity <= 0) {\n            throw new Error('Capacity must be greater than 0');\n        }\n        this._capacity = capacity;\n        this._active = 0;\n        this._waiting = [];\n    }\n    lock(thunk) {\n        return new Promise((resolve, reject) => {\n            this._waiting.push({ thunk, resolve, reject });\n            this.runNext();\n        });\n    }\n    get active() {\n        return this._active;\n    }\n    runNext() {\n        if (this._waiting.length === 0 || this._active === this._capacity) {\n            return;\n        }\n        (0, ral_1.default)().timer.setImmediate(() => this.doRunNext());\n    }\n    doRunNext() {\n        if (this._waiting.length === 0 || this._active === this._capacity) {\n            return;\n        }\n        const next = this._waiting.shift();\n        this._active++;\n        if (this._active > this._capacity) {\n            throw new Error(`To many thunks active`);\n        }\n        try {\n            const result = next.thunk();\n            if (result instanceof Promise) {\n                result.then((value) => {\n                    this._active--;\n                    next.resolve(value);\n                    this.runNext();\n                }, (err) => {\n                    this._active--;\n                    next.reject(err);\n                    this.runNext();\n                });\n            }\n            else {\n                this._active--;\n                next.resolve(result);\n                this.runNext();\n            }\n        }\n        catch (err) {\n            this._active--;\n            next.reject(err);\n            this.runNext();\n        }\n    }\n}\nexports.Semaphore = Semaphore;\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ReadableStreamMessageReader = exports.AbstractMessageReader = exports.MessageReader = void 0;\nconst ral_1 = require(\"./ral\");\nconst Is = require(\"./is\");\nconst events_1 = require(\"./events\");\nconst semaphore_1 = require(\"./semaphore\");\nvar MessageReader;\n(function (MessageReader) {\n    function is(value) {\n        let candidate = value;\n        return candidate && Is.func(candidate.listen) && Is.func(candidate.dispose) &&\n            Is.func(candidate.onError) && Is.func(candidate.onClose) && Is.func(candidate.onPartialMessage);\n    }\n    MessageReader.is = is;\n})(MessageReader || (exports.MessageReader = MessageReader = {}));\nclass AbstractMessageReader {\n    constructor() {\n        this.errorEmitter = new events_1.Emitter();\n        this.closeEmitter = new events_1.Emitter();\n        this.partialMessageEmitter = new events_1.Emitter();\n    }\n    dispose() {\n        this.errorEmitter.dispose();\n        this.closeEmitter.dispose();\n    }\n    get onError() {\n        return this.errorEmitter.event;\n    }\n    fireError(error) {\n        this.errorEmitter.fire(this.asError(error));\n    }\n    get onClose() {\n        return this.closeEmitter.event;\n    }\n    fireClose() {\n        this.closeEmitter.fire(undefined);\n    }\n    get onPartialMessage() {\n        return this.partialMessageEmitter.event;\n    }\n    firePartialMessage(info) {\n        this.partialMessageEmitter.fire(info);\n    }\n    asError(error) {\n        if (error instanceof Error) {\n            return error;\n        }\n        else {\n            return new Error(`Reader received error. Reason: ${Is.string(error.message) ? error.message : 'unknown'}`);\n        }\n    }\n}\nexports.AbstractMessageReader = AbstractMessageReader;\nvar ResolvedMessageReaderOptions;\n(function (ResolvedMessageReaderOptions) {\n    function fromOptions(options) {\n        let charset;\n        let result;\n        let contentDecoder;\n        const contentDecoders = new Map();\n        let contentTypeDecoder;\n        const contentTypeDecoders = new Map();\n        if (options === undefined || typeof options === 'string') {\n            charset = options ?? 'utf-8';\n        }\n        else {\n            charset = options.charset ?? 'utf-8';\n            if (options.contentDecoder !== undefined) {\n                contentDecoder = options.contentDecoder;\n                contentDecoders.set(contentDecoder.name, contentDecoder);\n            }\n            if (options.contentDecoders !== undefined) {\n                for (const decoder of options.contentDecoders) {\n                    contentDecoders.set(decoder.name, decoder);\n                }\n            }\n            if (options.contentTypeDecoder !== undefined) {\n                contentTypeDecoder = options.contentTypeDecoder;\n                contentTypeDecoders.set(contentTypeDecoder.name, contentTypeDecoder);\n            }\n            if (options.contentTypeDecoders !== undefined) {\n                for (const decoder of options.contentTypeDecoders) {\n                    contentTypeDecoders.set(decoder.name, decoder);\n                }\n            }\n        }\n        if (contentTypeDecoder === undefined) {\n            contentTypeDecoder = (0, ral_1.default)().applicationJson.decoder;\n            contentTypeDecoders.set(contentTypeDecoder.name, contentTypeDecoder);\n        }\n        return { charset, contentDecoder, contentDecoders, contentTypeDecoder, contentTypeDecoders };\n    }\n    ResolvedMessageReaderOptions.fromOptions = fromOptions;\n})(ResolvedMessageReaderOptions || (ResolvedMessageReaderOptions = {}));\nclass ReadableStreamMessageReader extends AbstractMessageReader {\n    constructor(readable, options) {\n        super();\n        this.readable = readable;\n        this.options = ResolvedMessageReaderOptions.fromOptions(options);\n        this.buffer = (0, ral_1.default)().messageBuffer.create(this.options.charset);\n        this._partialMessageTimeout = 10000;\n        this.nextMessageLength = -1;\n        this.messageToken = 0;\n        this.readSemaphore = new semaphore_1.Semaphore(1);\n    }\n    set partialMessageTimeout(timeout) {\n        this._partialMessageTimeout = timeout;\n    }\n    get partialMessageTimeout() {\n        return this._partialMessageTimeout;\n    }\n    listen(callback) {\n        this.nextMessageLength = -1;\n        this.messageToken = 0;\n        this.partialMessageTimer = undefined;\n        this.callback = callback;\n        const result = this.readable.onData((data) => {\n            this.onData(data);\n        });\n        this.readable.onError((error) => this.fireError(error));\n        this.readable.onClose(() => this.fireClose());\n        return result;\n    }\n    onData(data) {\n        try {\n            this.buffer.append(data);\n            while (true) {\n                if (this.nextMessageLength === -1) {\n                    const headers = this.buffer.tryReadHeaders(true);\n                    if (!headers) {\n                        return;\n                    }\n                    const contentLength = headers.get('content-length');\n                    if (!contentLength) {\n                        this.fireError(new Error(`Header must provide a Content-Length property.\\n${JSON.stringify(Object.fromEntries(headers))}`));\n                        return;\n                    }\n                    const length = parseInt(contentLength);\n                    if (isNaN(length)) {\n                        this.fireError(new Error(`Content-Length value must be a number. Got ${contentLength}`));\n                        return;\n                    }\n                    this.nextMessageLength = length;\n                }\n                const body = this.buffer.tryReadBody(this.nextMessageLength);\n                if (body === undefined) {\n                    /** We haven't received the full message yet. */\n                    this.setPartialMessageTimer();\n                    return;\n                }\n                this.clearPartialMessageTimer();\n                this.nextMessageLength = -1;\n                // Make sure that we convert one received message after the\n                // other. Otherwise it could happen that a decoding of a second\n                // smaller message finished before the decoding of a first larger\n                // message and then we would deliver the second message first.\n                this.readSemaphore.lock(async () => {\n                    const bytes = this.options.contentDecoder !== undefined\n                        ? await this.options.contentDecoder.decode(body)\n                        : body;\n                    const message = await this.options.contentTypeDecoder.decode(bytes, this.options);\n                    this.callback(message);\n                }).catch((error) => {\n                    this.fireError(error);\n                });\n            }\n        }\n        catch (error) {\n            this.fireError(error);\n        }\n    }\n    clearPartialMessageTimer() {\n        if (this.partialMessageTimer) {\n            this.partialMessageTimer.dispose();\n            this.partialMessageTimer = undefined;\n        }\n    }\n    setPartialMessageTimer() {\n        this.clearPartialMessageTimer();\n        if (this._partialMessageTimeout <= 0) {\n            return;\n        }\n        this.partialMessageTimer = (0, ral_1.default)().timer.setTimeout((token, timeout) => {\n            this.partialMessageTimer = undefined;\n            if (token === this.messageToken) {\n                this.firePartialMessage({ messageToken: token, waitingTime: timeout });\n                this.setPartialMessageTimer();\n            }\n        }, this._partialMessageTimeout, this.messageToken, this._partialMessageTimeout);\n    }\n}\nexports.ReadableStreamMessageReader = ReadableStreamMessageReader;\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WriteableStreamMessageWriter = exports.AbstractMessageWriter = exports.MessageWriter = void 0;\nconst ral_1 = require(\"./ral\");\nconst Is = require(\"./is\");\nconst semaphore_1 = require(\"./semaphore\");\nconst events_1 = require(\"./events\");\nconst ContentLength = 'Content-Length: ';\nconst CRLF = '\\r\\n';\nvar MessageWriter;\n(function (MessageWriter) {\n    function is(value) {\n        let candidate = value;\n        return candidate && Is.func(candidate.dispose) && Is.func(candidate.onClose) &&\n            Is.func(candidate.onError) && Is.func(candidate.write);\n    }\n    MessageWriter.is = is;\n})(MessageWriter || (exports.MessageWriter = MessageWriter = {}));\nclass AbstractMessageWriter {\n    constructor() {\n        this.errorEmitter = new events_1.Emitter();\n        this.closeEmitter = new events_1.Emitter();\n    }\n    dispose() {\n        this.errorEmitter.dispose();\n        this.closeEmitter.dispose();\n    }\n    get onError() {\n        return this.errorEmitter.event;\n    }\n    fireError(error, message, count) {\n        this.errorEmitter.fire([this.asError(error), message, count]);\n    }\n    get onClose() {\n        return this.closeEmitter.event;\n    }\n    fireClose() {\n        this.closeEmitter.fire(undefined);\n    }\n    asError(error) {\n        if (error instanceof Error) {\n            return error;\n        }\n        else {\n            return new Error(`Writer received error. Reason: ${Is.string(error.message) ? error.message : 'unknown'}`);\n        }\n    }\n}\nexports.AbstractMessageWriter = AbstractMessageWriter;\nvar ResolvedMessageWriterOptions;\n(function (ResolvedMessageWriterOptions) {\n    function fromOptions(options) {\n        if (options === undefined || typeof options === 'string') {\n            return { charset: options ?? 'utf-8', contentTypeEncoder: (0, ral_1.default)().applicationJson.encoder };\n        }\n        else {\n            return { charset: options.charset ?? 'utf-8', contentEncoder: options.contentEncoder, contentTypeEncoder: options.contentTypeEncoder ?? (0, ral_1.default)().applicationJson.encoder };\n        }\n    }\n    ResolvedMessageWriterOptions.fromOptions = fromOptions;\n})(ResolvedMessageWriterOptions || (ResolvedMessageWriterOptions = {}));\nclass WriteableStreamMessageWriter extends AbstractMessageWriter {\n    constructor(writable, options) {\n        super();\n        this.writable = writable;\n        this.options = ResolvedMessageWriterOptions.fromOptions(options);\n        this.errorCount = 0;\n        this.writeSemaphore = new semaphore_1.Semaphore(1);\n        this.writable.onError((error) => this.fireError(error));\n        this.writable.onClose(() => this.fireClose());\n    }\n    async write(msg) {\n        return this.writeSemaphore.lock(async () => {\n            const payload = this.options.contentTypeEncoder.encode(msg, this.options).then((buffer) => {\n                if (this.options.contentEncoder !== undefined) {\n                    return this.options.contentEncoder.encode(buffer);\n                }\n                else {\n                    return buffer;\n                }\n            });\n            return payload.then((buffer) => {\n                const headers = [];\n                headers.push(ContentLength, buffer.byteLength.toString(), CRLF);\n                headers.push(CRLF);\n                return this.doWrite(msg, headers, buffer);\n            }, (error) => {\n                this.fireError(error);\n                throw error;\n            });\n        });\n    }\n    async doWrite(msg, headers, data) {\n        try {\n            await this.writable.write(headers.join(''), 'ascii');\n            return this.writable.write(data);\n        }\n        catch (error) {\n            this.handleError(error, msg);\n            return Promise.reject(error);\n        }\n    }\n    handleError(error, msg) {\n        this.errorCount++;\n        this.fireError(error, msg, this.errorCount);\n    }\n    end() {\n        this.writable.end();\n    }\n}\nexports.WriteableStreamMessageWriter = WriteableStreamMessageWriter;\n", "\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AbstractMessageBuffer = void 0;\nconst CR = 13;\nconst LF = 10;\nconst CRLF = '\\r\\n';\nclass AbstractMessageBuffer {\n    constructor(encoding = 'utf-8') {\n        this._encoding = encoding;\n        this._chunks = [];\n        this._totalLength = 0;\n    }\n    get encoding() {\n        return this._encoding;\n    }\n    append(chunk) {\n        const toAppend = typeof chunk === 'string' ? this.fromString(chunk, this._encoding) : chunk;\n        this._chunks.push(toAppend);\n        this._totalLength += toAppend.byteLength;\n    }\n    tryReadHeaders(lowerCaseKeys = false) {\n        if (this._chunks.length === 0) {\n            return undefined;\n        }\n        let state = 0;\n        let chunkIndex = 0;\n        let offset = 0;\n        let chunkBytesRead = 0;\n        row: while (chunkIndex < this._chunks.length) {\n            const chunk = this._chunks[chunkIndex];\n            offset = 0;\n            column: while (offset < chunk.length) {\n                const value = chunk[offset];\n                switch (value) {\n                    case CR:\n                        switch (state) {\n                            case 0:\n                                state = 1;\n                                break;\n                            case 2:\n                                state = 3;\n                                break;\n                            default:\n                                state = 0;\n                        }\n                        break;\n                    case LF:\n                        switch (state) {\n                            case 1:\n                                state = 2;\n                                break;\n                            case 3:\n                                state = 4;\n                                offset++;\n                                break row;\n                            default:\n                                state = 0;\n                        }\n                        break;\n                    default:\n                        state = 0;\n                }\n                offset++;\n            }\n            chunkBytesRead += chunk.byteLength;\n            chunkIndex++;\n        }\n        if (state !== 4) {\n            return undefined;\n        }\n        // The buffer contains the two CRLF at the end. So we will\n        // have two empty lines after the split at the end as well.\n        const buffer = this._read(chunkBytesRead + offset);\n        const result = new Map();\n        const headers = this.toString(buffer, 'ascii').split(CRLF);\n        if (headers.length < 2) {\n            return result;\n        }\n        for (let i = 0; i < headers.length - 2; i++) {\n            const header = headers[i];\n            const index = header.indexOf(':');\n            if (index === -1) {\n                throw new Error(`Message header must separate key and value using ':'\\n${header}`);\n            }\n            const key = header.substr(0, index);\n            const value = header.substr(index + 1).trim();\n            result.set(lowerCaseKeys ? key.toLowerCase() : key, value);\n        }\n        return result;\n    }\n    tryReadBody(length) {\n        if (this._totalLength < length) {\n            return undefined;\n        }\n        return this._read(length);\n    }\n    get numberOfBytes() {\n        return this._totalLength;\n    }\n    _read(byteCount) {\n        if (byteCount === 0) {\n            return this.emptyBuffer();\n        }\n        if (byteCount > this._totalLength) {\n            throw new Error(`Cannot read so many bytes!`);\n        }\n        if (this._chunks[0].byteLength === byteCount) {\n            // super fast path, precisely first chunk must be returned\n            const chunk = this._chunks[0];\n            this._chunks.shift();\n            this._totalLength -= byteCount;\n            return this.asNative(chunk);\n        }\n        if (this._chunks[0].byteLength > byteCount) {\n            // fast path, the reading is entirely within the first chunk\n            const chunk = this._chunks[0];\n            const result = this.asNative(chunk, byteCount);\n            this._chunks[0] = chunk.slice(byteCount);\n            this._totalLength -= byteCount;\n            return result;\n        }\n        const result = this.allocNative(byteCount);\n        let resultOffset = 0;\n        let chunkIndex = 0;\n        while (byteCount > 0) {\n            const chunk = this._chunks[chunkIndex];\n            if (chunk.byteLength > byteCount) {\n                // this chunk will survive\n                const chunkPart = chunk.slice(0, byteCount);\n                result.set(chunkPart, resultOffset);\n                resultOffset += byteCount;\n                this._chunks[chunkIndex] = chunk.slice(byteCount);\n                this._totalLength -= byteCount;\n                byteCount -= byteCount;\n            }\n            else {\n                // this chunk will be entirely read\n                result.set(chunk, resultOffset);\n                resultOffset += chunk.byteLength;\n                this._chunks.shift();\n                this._totalLength -= chunk.byteLength;\n                byteCount -= chunk.byteLength;\n            }\n        }\n        return result;\n    }\n}\nexports.AbstractMessageBuffer = AbstractMessageBuffer;\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createMessageConnection = exports.ConnectionOptions = exports.MessageStrategy = exports.CancellationStrategy = exports.CancellationSenderStrategy = exports.CancellationReceiverStrategy = exports.RequestCancellationReceiverStrategy = exports.IdCancellationReceiverStrategy = exports.ConnectionStrategy = exports.ConnectionError = exports.ConnectionErrors = exports.LogTraceNotification = exports.SetTraceNotification = exports.TraceFormat = exports.TraceValues = exports.Trace = exports.NullLogger = exports.ProgressType = exports.ProgressToken = void 0;\nconst ral_1 = require(\"./ral\");\nconst Is = require(\"./is\");\nconst messages_1 = require(\"./messages\");\nconst linkedMap_1 = require(\"./linkedMap\");\nconst events_1 = require(\"./events\");\nconst cancellation_1 = require(\"./cancellation\");\nvar CancelNotification;\n(function (CancelNotification) {\n    CancelNotification.type = new messages_1.NotificationType('$/cancelRequest');\n})(CancelNotification || (CancelNotification = {}));\nvar ProgressToken;\n(function (ProgressToken) {\n    function is(value) {\n        return typeof value === 'string' || typeof value === 'number';\n    }\n    ProgressToken.is = is;\n})(ProgressToken || (exports.ProgressToken = ProgressToken = {}));\nvar ProgressNotification;\n(function (ProgressNotification) {\n    ProgressNotification.type = new messages_1.NotificationType('$/progress');\n})(ProgressNotification || (ProgressNotification = {}));\nclass ProgressType {\n    constructor() {\n    }\n}\nexports.ProgressType = ProgressType;\nvar StarRequestHandler;\n(function (StarRequestHandler) {\n    function is(value) {\n        return Is.func(value);\n    }\n    StarRequestHandler.is = is;\n})(StarRequestHandler || (StarRequestHandler = {}));\nexports.NullLogger = Object.freeze({\n    error: () => { },\n    warn: () => { },\n    info: () => { },\n    log: () => { }\n});\nvar Trace;\n(function (Trace) {\n    Trace[Trace[\"Off\"] = 0] = \"Off\";\n    Trace[Trace[\"Messages\"] = 1] = \"Messages\";\n    Trace[Trace[\"Compact\"] = 2] = \"Compact\";\n    Trace[Trace[\"Verbose\"] = 3] = \"Verbose\";\n})(Trace || (exports.Trace = Trace = {}));\nvar TraceValues;\n(function (TraceValues) {\n    /**\n     * Turn tracing off.\n     */\n    TraceValues.Off = 'off';\n    /**\n     * Trace messages only.\n     */\n    TraceValues.Messages = 'messages';\n    /**\n     * Compact message tracing.\n     */\n    TraceValues.Compact = 'compact';\n    /**\n     * Verbose message tracing.\n     */\n    TraceValues.Verbose = 'verbose';\n})(TraceValues || (exports.TraceValues = TraceValues = {}));\n(function (Trace) {\n    function fromString(value) {\n        if (!Is.string(value)) {\n            return Trace.Off;\n        }\n        value = value.toLowerCase();\n        switch (value) {\n            case 'off':\n                return Trace.Off;\n            case 'messages':\n                return Trace.Messages;\n            case 'compact':\n                return Trace.Compact;\n            case 'verbose':\n                return Trace.Verbose;\n            default:\n                return Trace.Off;\n        }\n    }\n    Trace.fromString = fromString;\n    function toString(value) {\n        switch (value) {\n            case Trace.Off:\n                return 'off';\n            case Trace.Messages:\n                return 'messages';\n            case Trace.Compact:\n                return 'compact';\n            case Trace.Verbose:\n                return 'verbose';\n            default:\n                return 'off';\n        }\n    }\n    Trace.toString = toString;\n})(Trace || (exports.Trace = Trace = {}));\nvar TraceFormat;\n(function (TraceFormat) {\n    TraceFormat[\"Text\"] = \"text\";\n    TraceFormat[\"JSON\"] = \"json\";\n})(TraceFormat || (exports.TraceFormat = TraceFormat = {}));\n(function (TraceFormat) {\n    function fromString(value) {\n        if (!Is.string(value)) {\n            return TraceFormat.Text;\n        }\n        value = value.toLowerCase();\n        if (value === 'json') {\n            return TraceFormat.JSON;\n        }\n        else {\n            return TraceFormat.Text;\n        }\n    }\n    TraceFormat.fromString = fromString;\n})(TraceFormat || (exports.TraceFormat = TraceFormat = {}));\nvar SetTraceNotification;\n(function (SetTraceNotification) {\n    SetTraceNotification.type = new messages_1.NotificationType('$/setTrace');\n})(SetTraceNotification || (exports.SetTraceNotification = SetTraceNotification = {}));\nvar LogTraceNotification;\n(function (LogTraceNotification) {\n    LogTraceNotification.type = new messages_1.NotificationType('$/logTrace');\n})(LogTraceNotification || (exports.LogTraceNotification = LogTraceNotification = {}));\nvar ConnectionErrors;\n(function (ConnectionErrors) {\n    /**\n     * The connection is closed.\n     */\n    ConnectionErrors[ConnectionErrors[\"Closed\"] = 1] = \"Closed\";\n    /**\n     * The connection got disposed.\n     */\n    ConnectionErrors[ConnectionErrors[\"Disposed\"] = 2] = \"Disposed\";\n    /**\n     * The connection is already in listening mode.\n     */\n    ConnectionErrors[ConnectionErrors[\"AlreadyListening\"] = 3] = \"AlreadyListening\";\n})(ConnectionErrors || (exports.ConnectionErrors = ConnectionErrors = {}));\nclass ConnectionError extends Error {\n    constructor(code, message) {\n        super(message);\n        this.code = code;\n        Object.setPrototypeOf(this, ConnectionError.prototype);\n    }\n}\nexports.ConnectionError = ConnectionError;\nvar ConnectionStrategy;\n(function (ConnectionStrategy) {\n    function is(value) {\n        const candidate = value;\n        return candidate && Is.func(candidate.cancelUndispatched);\n    }\n    ConnectionStrategy.is = is;\n})(ConnectionStrategy || (exports.ConnectionStrategy = ConnectionStrategy = {}));\nvar IdCancellationReceiverStrategy;\n(function (IdCancellationReceiverStrategy) {\n    function is(value) {\n        const candidate = value;\n        return candidate && (candidate.kind === undefined || candidate.kind === 'id') && Is.func(candidate.createCancellationTokenSource) && (candidate.dispose === undefined || Is.func(candidate.dispose));\n    }\n    IdCancellationReceiverStrategy.is = is;\n})(IdCancellationReceiverStrategy || (exports.IdCancellationReceiverStrategy = IdCancellationReceiverStrategy = {}));\nvar RequestCancellationReceiverStrategy;\n(function (RequestCancellationReceiverStrategy) {\n    function is(value) {\n        const candidate = value;\n        return candidate && candidate.kind === 'request' && Is.func(candidate.createCancellationTokenSource) && (candidate.dispose === undefined || Is.func(candidate.dispose));\n    }\n    RequestCancellationReceiverStrategy.is = is;\n})(RequestCancellationReceiverStrategy || (exports.RequestCancellationReceiverStrategy = RequestCancellationReceiverStrategy = {}));\nvar CancellationReceiverStrategy;\n(function (CancellationReceiverStrategy) {\n    CancellationReceiverStrategy.Message = Object.freeze({\n        createCancellationTokenSource(_) {\n            return new cancellation_1.CancellationTokenSource();\n        }\n    });\n    function is(value) {\n        return IdCancellationReceiverStrategy.is(value) || RequestCancellationReceiverStrategy.is(value);\n    }\n    CancellationReceiverStrategy.is = is;\n})(CancellationReceiverStrategy || (exports.CancellationReceiverStrategy = CancellationReceiverStrategy = {}));\nvar CancellationSenderStrategy;\n(function (CancellationSenderStrategy) {\n    CancellationSenderStrategy.Message = Object.freeze({\n        sendCancellation(conn, id) {\n            return conn.sendNotification(CancelNotification.type, { id });\n        },\n        cleanup(_) { }\n    });\n    function is(value) {\n        const candidate = value;\n        return candidate && Is.func(candidate.sendCancellation) && Is.func(candidate.cleanup);\n    }\n    CancellationSenderStrategy.is = is;\n})(CancellationSenderStrategy || (exports.CancellationSenderStrategy = CancellationSenderStrategy = {}));\nvar CancellationStrategy;\n(function (CancellationStrategy) {\n    CancellationStrategy.Message = Object.freeze({\n        receiver: CancellationReceiverStrategy.Message,\n        sender: CancellationSenderStrategy.Message\n    });\n    function is(value) {\n        const candidate = value;\n        return candidate && CancellationReceiverStrategy.is(candidate.receiver) && CancellationSenderStrategy.is(candidate.sender);\n    }\n    CancellationStrategy.is = is;\n})(CancellationStrategy || (exports.CancellationStrategy = CancellationStrategy = {}));\nvar MessageStrategy;\n(function (MessageStrategy) {\n    function is(value) {\n        const candidate = value;\n        return candidate && Is.func(candidate.handleMessage);\n    }\n    MessageStrategy.is = is;\n})(MessageStrategy || (exports.MessageStrategy = MessageStrategy = {}));\nvar ConnectionOptions;\n(function (ConnectionOptions) {\n    function is(value) {\n        const candidate = value;\n        return candidate && (CancellationStrategy.is(candidate.cancellationStrategy) || ConnectionStrategy.is(candidate.connectionStrategy) || MessageStrategy.is(candidate.messageStrategy));\n    }\n    ConnectionOptions.is = is;\n})(ConnectionOptions || (exports.ConnectionOptions = ConnectionOptions = {}));\nvar ConnectionState;\n(function (ConnectionState) {\n    ConnectionState[ConnectionState[\"New\"] = 1] = \"New\";\n    ConnectionState[ConnectionState[\"Listening\"] = 2] = \"Listening\";\n    ConnectionState[ConnectionState[\"Closed\"] = 3] = \"Closed\";\n    ConnectionState[ConnectionState[\"Disposed\"] = 4] = \"Disposed\";\n})(ConnectionState || (ConnectionState = {}));\nfunction createMessageConnection(messageReader, messageWriter, _logger, options) {\n    const logger = _logger !== undefined ? _logger : exports.NullLogger;\n    let sequenceNumber = 0;\n    let notificationSequenceNumber = 0;\n    let unknownResponseSequenceNumber = 0;\n    const version = '2.0';\n    let starRequestHandler = undefined;\n    const requestHandlers = new Map();\n    let starNotificationHandler = undefined;\n    const notificationHandlers = new Map();\n    const progressHandlers = new Map();\n    let timer;\n    let messageQueue = new linkedMap_1.LinkedMap();\n    let responsePromises = new Map();\n    let knownCanceledRequests = new Set();\n    let requestTokens = new Map();\n    let trace = Trace.Off;\n    let traceFormat = TraceFormat.Text;\n    let tracer;\n    let state = ConnectionState.New;\n    const errorEmitter = new events_1.Emitter();\n    const closeEmitter = new events_1.Emitter();\n    const unhandledNotificationEmitter = new events_1.Emitter();\n    const unhandledProgressEmitter = new events_1.Emitter();\n    const disposeEmitter = new events_1.Emitter();\n    const cancellationStrategy = (options && options.cancellationStrategy) ? options.cancellationStrategy : CancellationStrategy.Message;\n    function createRequestQueueKey(id) {\n        if (id === null) {\n            throw new Error(`Can't send requests with id null since the response can't be correlated.`);\n        }\n        return 'req-' + id.toString();\n    }\n    function createResponseQueueKey(id) {\n        if (id === null) {\n            return 'res-unknown-' + (++unknownResponseSequenceNumber).toString();\n        }\n        else {\n            return 'res-' + id.toString();\n        }\n    }\n    function createNotificationQueueKey() {\n        return 'not-' + (++notificationSequenceNumber).toString();\n    }\n    function addMessageToQueue(queue, message) {\n        if (messages_1.Message.isRequest(message)) {\n            queue.set(createRequestQueueKey(message.id), message);\n        }\n        else if (messages_1.Message.isResponse(message)) {\n            queue.set(createResponseQueueKey(message.id), message);\n        }\n        else {\n            queue.set(createNotificationQueueKey(), message);\n        }\n    }\n    function cancelUndispatched(_message) {\n        return undefined;\n    }\n    function isListening() {\n        return state === ConnectionState.Listening;\n    }\n    function isClosed() {\n        return state === ConnectionState.Closed;\n    }\n    function isDisposed() {\n        return state === ConnectionState.Disposed;\n    }\n    function closeHandler() {\n        if (state === ConnectionState.New || state === ConnectionState.Listening) {\n            state = ConnectionState.Closed;\n            closeEmitter.fire(undefined);\n        }\n        // If the connection is disposed don't sent close events.\n    }\n    function readErrorHandler(error) {\n        errorEmitter.fire([error, undefined, undefined]);\n    }\n    function writeErrorHandler(data) {\n        errorEmitter.fire(data);\n    }\n    messageReader.onClose(closeHandler);\n    messageReader.onError(readErrorHandler);\n    messageWriter.onClose(closeHandler);\n    messageWriter.onError(writeErrorHandler);\n    function triggerMessageQueue() {\n        if (timer || messageQueue.size === 0) {\n            return;\n        }\n        timer = (0, ral_1.default)().timer.setImmediate(() => {\n            timer = undefined;\n            processMessageQueue();\n        });\n    }\n    function handleMessage(message) {\n        if (messages_1.Message.isRequest(message)) {\n            handleRequest(message);\n        }\n        else if (messages_1.Message.isNotification(message)) {\n            handleNotification(message);\n        }\n        else if (messages_1.Message.isResponse(message)) {\n            handleResponse(message);\n        }\n        else {\n            handleInvalidMessage(message);\n        }\n    }\n    function processMessageQueue() {\n        if (messageQueue.size === 0) {\n            return;\n        }\n        const message = messageQueue.shift();\n        try {\n            const messageStrategy = options?.messageStrategy;\n            if (MessageStrategy.is(messageStrategy)) {\n                messageStrategy.handleMessage(message, handleMessage);\n            }\n            else {\n                handleMessage(message);\n            }\n        }\n        finally {\n            triggerMessageQueue();\n        }\n    }\n    const callback = (message) => {\n        try {\n            // We have received a cancellation message. Check if the message is still in the queue\n            // and cancel it if allowed to do so.\n            if (messages_1.Message.isNotification(message) && message.method === CancelNotification.type.method) {\n                const cancelId = message.params.id;\n                const key = createRequestQueueKey(cancelId);\n                const toCancel = messageQueue.get(key);\n                if (messages_1.Message.isRequest(toCancel)) {\n                    const strategy = options?.connectionStrategy;\n                    const response = (strategy && strategy.cancelUndispatched) ? strategy.cancelUndispatched(toCancel, cancelUndispatched) : cancelUndispatched(toCancel);\n                    if (response && (response.error !== undefined || response.result !== undefined)) {\n                        messageQueue.delete(key);\n                        requestTokens.delete(cancelId);\n                        response.id = toCancel.id;\n                        traceSendingResponse(response, message.method, Date.now());\n                        messageWriter.write(response).catch(() => logger.error(`Sending response for canceled message failed.`));\n                        return;\n                    }\n                }\n                const cancellationToken = requestTokens.get(cancelId);\n                // The request is already running. Cancel the token\n                if (cancellationToken !== undefined) {\n                    cancellationToken.cancel();\n                    traceReceivedNotification(message);\n                    return;\n                }\n                else {\n                    // Remember the cancel but still queue the message to\n                    // clean up state in process message.\n                    knownCanceledRequests.add(cancelId);\n                }\n            }\n            addMessageToQueue(messageQueue, message);\n        }\n        finally {\n            triggerMessageQueue();\n        }\n    };\n    function handleRequest(requestMessage) {\n        if (isDisposed()) {\n            // we return here silently since we fired an event when the\n            // connection got disposed.\n            return;\n        }\n        function reply(resultOrError, method, startTime) {\n            const message = {\n                jsonrpc: version,\n                id: requestMessage.id\n            };\n            if (resultOrError instanceof messages_1.ResponseError) {\n                message.error = resultOrError.toJson();\n            }\n            else {\n                message.result = resultOrError === undefined ? null : resultOrError;\n            }\n            traceSendingResponse(message, method, startTime);\n            messageWriter.write(message).catch(() => logger.error(`Sending response failed.`));\n        }\n        function replyError(error, method, startTime) {\n            const message = {\n                jsonrpc: version,\n                id: requestMessage.id,\n                error: error.toJson()\n            };\n            traceSendingResponse(message, method, startTime);\n            messageWriter.write(message).catch(() => logger.error(`Sending response failed.`));\n        }\n        function replySuccess(result, method, startTime) {\n            // The JSON RPC defines that a response must either have a result or an error\n            // So we can't treat undefined as a valid response result.\n            if (result === undefined) {\n                result = null;\n            }\n            const message = {\n                jsonrpc: version,\n                id: requestMessage.id,\n                result: result\n            };\n            traceSendingResponse(message, method, startTime);\n            messageWriter.write(message).catch(() => logger.error(`Sending response failed.`));\n        }\n        traceReceivedRequest(requestMessage);\n        const element = requestHandlers.get(requestMessage.method);\n        let type;\n        let requestHandler;\n        if (element) {\n            type = element.type;\n            requestHandler = element.handler;\n        }\n        const startTime = Date.now();\n        if (requestHandler || starRequestHandler) {\n            const tokenKey = requestMessage.id ?? String(Date.now()); //\n            const cancellationSource = IdCancellationReceiverStrategy.is(cancellationStrategy.receiver)\n                ? cancellationStrategy.receiver.createCancellationTokenSource(tokenKey)\n                : cancellationStrategy.receiver.createCancellationTokenSource(requestMessage);\n            if (requestMessage.id !== null && knownCanceledRequests.has(requestMessage.id)) {\n                cancellationSource.cancel();\n            }\n            if (requestMessage.id !== null) {\n                requestTokens.set(tokenKey, cancellationSource);\n            }\n            try {\n                let handlerResult;\n                if (requestHandler) {\n                    if (requestMessage.params === undefined) {\n                        if (type !== undefined && type.numberOfParams !== 0) {\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InvalidParams, `Request ${requestMessage.method} defines ${type.numberOfParams} params but received none.`), requestMessage.method, startTime);\n                            return;\n                        }\n                        handlerResult = requestHandler(cancellationSource.token);\n                    }\n                    else if (Array.isArray(requestMessage.params)) {\n                        if (type !== undefined && type.parameterStructures === messages_1.ParameterStructures.byName) {\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InvalidParams, `Request ${requestMessage.method} defines parameters by name but received parameters by position`), requestMessage.method, startTime);\n                            return;\n                        }\n                        handlerResult = requestHandler(...requestMessage.params, cancellationSource.token);\n                    }\n                    else {\n                        if (type !== undefined && type.parameterStructures === messages_1.ParameterStructures.byPosition) {\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InvalidParams, `Request ${requestMessage.method} defines parameters by position but received parameters by name`), requestMessage.method, startTime);\n                            return;\n                        }\n                        handlerResult = requestHandler(requestMessage.params, cancellationSource.token);\n                    }\n                }\n                else if (starRequestHandler) {\n                    handlerResult = starRequestHandler(requestMessage.method, requestMessage.params, cancellationSource.token);\n                }\n                const promise = handlerResult;\n                if (!handlerResult) {\n                    requestTokens.delete(tokenKey);\n                    replySuccess(handlerResult, requestMessage.method, startTime);\n                }\n                else if (promise.then) {\n                    promise.then((resultOrError) => {\n                        requestTokens.delete(tokenKey);\n                        reply(resultOrError, requestMessage.method, startTime);\n                    }, error => {\n                        requestTokens.delete(tokenKey);\n                        if (error instanceof messages_1.ResponseError) {\n                            replyError(error, requestMessage.method, startTime);\n                        }\n                        else if (error && Is.string(error.message)) {\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed with message: ${error.message}`), requestMessage.method, startTime);\n                        }\n                        else {\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed unexpectedly without providing any details.`), requestMessage.method, startTime);\n                        }\n                    });\n                }\n                else {\n                    requestTokens.delete(tokenKey);\n                    reply(handlerResult, requestMessage.method, startTime);\n                }\n            }\n            catch (error) {\n                requestTokens.delete(tokenKey);\n                if (error instanceof messages_1.ResponseError) {\n                    reply(error, requestMessage.method, startTime);\n                }\n                else if (error && Is.string(error.message)) {\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed with message: ${error.message}`), requestMessage.method, startTime);\n                }\n                else {\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed unexpectedly without providing any details.`), requestMessage.method, startTime);\n                }\n            }\n        }\n        else {\n            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.MethodNotFound, `Unhandled method ${requestMessage.method}`), requestMessage.method, startTime);\n        }\n    }\n    function handleResponse(responseMessage) {\n        if (isDisposed()) {\n            // See handle request.\n            return;\n        }\n        if (responseMessage.id === null) {\n            if (responseMessage.error) {\n                logger.error(`Received response message without id: Error is: \\n${JSON.stringify(responseMessage.error, undefined, 4)}`);\n            }\n            else {\n                logger.error(`Received response message without id. No further error information provided.`);\n            }\n        }\n        else {\n            const key = responseMessage.id;\n            const responsePromise = responsePromises.get(key);\n            traceReceivedResponse(responseMessage, responsePromise);\n            if (responsePromise !== undefined) {\n                responsePromises.delete(key);\n                try {\n                    if (responseMessage.error) {\n                        const error = responseMessage.error;\n                        responsePromise.reject(new messages_1.ResponseError(error.code, error.message, error.data));\n                    }\n                    else if (responseMessage.result !== undefined) {\n                        responsePromise.resolve(responseMessage.result);\n                    }\n                    else {\n                        throw new Error('Should never happen.');\n                    }\n                }\n                catch (error) {\n                    if (error.message) {\n                        logger.error(`Response handler '${responsePromise.method}' failed with message: ${error.message}`);\n                    }\n                    else {\n                        logger.error(`Response handler '${responsePromise.method}' failed unexpectedly.`);\n                    }\n                }\n            }\n        }\n    }\n    function handleNotification(message) {\n        if (isDisposed()) {\n            // See handle request.\n            return;\n        }\n        let type = undefined;\n        let notificationHandler;\n        if (message.method === CancelNotification.type.method) {\n            const cancelId = message.params.id;\n            knownCanceledRequests.delete(cancelId);\n            traceReceivedNotification(message);\n            return;\n        }\n        else {\n            const element = notificationHandlers.get(message.method);\n            if (element) {\n                notificationHandler = element.handler;\n                type = element.type;\n            }\n        }\n        if (notificationHandler || starNotificationHandler) {\n            try {\n                traceReceivedNotification(message);\n                if (notificationHandler) {\n                    if (message.params === undefined) {\n                        if (type !== undefined) {\n                            if (type.numberOfParams !== 0 && type.parameterStructures !== messages_1.ParameterStructures.byName) {\n                                logger.error(`Notification ${message.method} defines ${type.numberOfParams} params but received none.`);\n                            }\n                        }\n                        notificationHandler();\n                    }\n                    else if (Array.isArray(message.params)) {\n                        // There are JSON-RPC libraries that send progress message as positional params although\n                        // specified as named. So convert them if this is the case.\n                        const params = message.params;\n                        if (message.method === ProgressNotification.type.method && params.length === 2 && ProgressToken.is(params[0])) {\n                            notificationHandler({ token: params[0], value: params[1] });\n                        }\n                        else {\n                            if (type !== undefined) {\n                                if (type.parameterStructures === messages_1.ParameterStructures.byName) {\n                                    logger.error(`Notification ${message.method} defines parameters by name but received parameters by position`);\n                                }\n                                if (type.numberOfParams !== message.params.length) {\n                                    logger.error(`Notification ${message.method} defines ${type.numberOfParams} params but received ${params.length} arguments`);\n                                }\n                            }\n                            notificationHandler(...params);\n                        }\n                    }\n                    else {\n                        if (type !== undefined && type.parameterStructures === messages_1.ParameterStructures.byPosition) {\n                            logger.error(`Notification ${message.method} defines parameters by position but received parameters by name`);\n                        }\n                        notificationHandler(message.params);\n                    }\n                }\n                else if (starNotificationHandler) {\n                    starNotificationHandler(message.method, message.params);\n                }\n            }\n            catch (error) {\n                if (error.message) {\n                    logger.error(`Notification handler '${message.method}' failed with message: ${error.message}`);\n                }\n                else {\n                    logger.error(`Notification handler '${message.method}' failed unexpectedly.`);\n                }\n            }\n        }\n        else {\n            unhandledNotificationEmitter.fire(message);\n        }\n    }\n    function handleInvalidMessage(message) {\n        if (!message) {\n            logger.error('Received empty message.');\n            return;\n        }\n        logger.error(`Received message which is neither a response nor a notification message:\\n${JSON.stringify(message, null, 4)}`);\n        // Test whether we find an id to reject the promise\n        const responseMessage = message;\n        if (Is.string(responseMessage.id) || Is.number(responseMessage.id)) {\n            const key = responseMessage.id;\n            const responseHandler = responsePromises.get(key);\n            if (responseHandler) {\n                responseHandler.reject(new Error('The received response has neither a result nor an error property.'));\n            }\n        }\n    }\n    function stringifyTrace(params) {\n        if (params === undefined || params === null) {\n            return undefined;\n        }\n        switch (trace) {\n            case Trace.Verbose:\n                return JSON.stringify(params, null, 4);\n            case Trace.Compact:\n                return JSON.stringify(params);\n            default:\n                return undefined;\n        }\n    }\n    function traceSendingRequest(message) {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if ((trace === Trace.Verbose || trace === Trace.Compact) && message.params) {\n                data = `Params: ${stringifyTrace(message.params)}\\n\\n`;\n            }\n            tracer.log(`Sending request '${message.method} - (${message.id})'.`, data);\n        }\n        else {\n            logLSPMessage('send-request', message);\n        }\n    }\n    function traceSendingNotification(message) {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if (trace === Trace.Verbose || trace === Trace.Compact) {\n                if (message.params) {\n                    data = `Params: ${stringifyTrace(message.params)}\\n\\n`;\n                }\n                else {\n                    data = 'No parameters provided.\\n\\n';\n                }\n            }\n            tracer.log(`Sending notification '${message.method}'.`, data);\n        }\n        else {\n            logLSPMessage('send-notification', message);\n        }\n    }\n    function traceSendingResponse(message, method, startTime) {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if (trace === Trace.Verbose || trace === Trace.Compact) {\n                if (message.error && message.error.data) {\n                    data = `Error data: ${stringifyTrace(message.error.data)}\\n\\n`;\n                }\n                else {\n                    if (message.result) {\n                        data = `Result: ${stringifyTrace(message.result)}\\n\\n`;\n                    }\n                    else if (message.error === undefined) {\n                        data = 'No result returned.\\n\\n';\n                    }\n                }\n            }\n            tracer.log(`Sending response '${method} - (${message.id})'. Processing request took ${Date.now() - startTime}ms`, data);\n        }\n        else {\n            logLSPMessage('send-response', message);\n        }\n    }\n    function traceReceivedRequest(message) {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if ((trace === Trace.Verbose || trace === Trace.Compact) && message.params) {\n                data = `Params: ${stringifyTrace(message.params)}\\n\\n`;\n            }\n            tracer.log(`Received request '${message.method} - (${message.id})'.`, data);\n        }\n        else {\n            logLSPMessage('receive-request', message);\n        }\n    }\n    function traceReceivedNotification(message) {\n        if (trace === Trace.Off || !tracer || message.method === LogTraceNotification.type.method) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if (trace === Trace.Verbose || trace === Trace.Compact) {\n                if (message.params) {\n                    data = `Params: ${stringifyTrace(message.params)}\\n\\n`;\n                }\n                else {\n                    data = 'No parameters provided.\\n\\n';\n                }\n            }\n            tracer.log(`Received notification '${message.method}'.`, data);\n        }\n        else {\n            logLSPMessage('receive-notification', message);\n        }\n    }\n    function traceReceivedResponse(message, responsePromise) {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        if (traceFormat === TraceFormat.Text) {\n            let data = undefined;\n            if (trace === Trace.Verbose || trace === Trace.Compact) {\n                if (message.error && message.error.data) {\n                    data = `Error data: ${stringifyTrace(message.error.data)}\\n\\n`;\n                }\n                else {\n                    if (message.result) {\n                        data = `Result: ${stringifyTrace(message.result)}\\n\\n`;\n                    }\n                    else if (message.error === undefined) {\n                        data = 'No result returned.\\n\\n';\n                    }\n                }\n            }\n            if (responsePromise) {\n                const error = message.error ? ` Request failed: ${message.error.message} (${message.error.code}).` : '';\n                tracer.log(`Received response '${responsePromise.method} - (${message.id})' in ${Date.now() - responsePromise.timerStart}ms.${error}`, data);\n            }\n            else {\n                tracer.log(`Received response ${message.id} without active response promise.`, data);\n            }\n        }\n        else {\n            logLSPMessage('receive-response', message);\n        }\n    }\n    function logLSPMessage(type, message) {\n        if (!tracer || trace === Trace.Off) {\n            return;\n        }\n        const lspMessage = {\n            isLSPMessage: true,\n            type,\n            message,\n            timestamp: Date.now()\n        };\n        tracer.log(lspMessage);\n    }\n    function throwIfClosedOrDisposed() {\n        if (isClosed()) {\n            throw new ConnectionError(ConnectionErrors.Closed, 'Connection is closed.');\n        }\n        if (isDisposed()) {\n            throw new ConnectionError(ConnectionErrors.Disposed, 'Connection is disposed.');\n        }\n    }\n    function throwIfListening() {\n        if (isListening()) {\n            throw new ConnectionError(ConnectionErrors.AlreadyListening, 'Connection is already listening');\n        }\n    }\n    function throwIfNotListening() {\n        if (!isListening()) {\n            throw new Error('Call listen() first.');\n        }\n    }\n    function undefinedToNull(param) {\n        if (param === undefined) {\n            return null;\n        }\n        else {\n            return param;\n        }\n    }\n    function nullToUndefined(param) {\n        if (param === null) {\n            return undefined;\n        }\n        else {\n            return param;\n        }\n    }\n    function isNamedParam(param) {\n        return param !== undefined && param !== null && !Array.isArray(param) && typeof param === 'object';\n    }\n    function computeSingleParam(parameterStructures, param) {\n        switch (parameterStructures) {\n            case messages_1.ParameterStructures.auto:\n                if (isNamedParam(param)) {\n                    return nullToUndefined(param);\n                }\n                else {\n                    return [undefinedToNull(param)];\n                }\n            case messages_1.ParameterStructures.byName:\n                if (!isNamedParam(param)) {\n                    throw new Error(`Received parameters by name but param is not an object literal.`);\n                }\n                return nullToUndefined(param);\n            case messages_1.ParameterStructures.byPosition:\n                return [undefinedToNull(param)];\n            default:\n                throw new Error(`Unknown parameter structure ${parameterStructures.toString()}`);\n        }\n    }\n    function computeMessageParams(type, params) {\n        let result;\n        const numberOfParams = type.numberOfParams;\n        switch (numberOfParams) {\n            case 0:\n                result = undefined;\n                break;\n            case 1:\n                result = computeSingleParam(type.parameterStructures, params[0]);\n                break;\n            default:\n                result = [];\n                for (let i = 0; i < params.length && i < numberOfParams; i++) {\n                    result.push(undefinedToNull(params[i]));\n                }\n                if (params.length < numberOfParams) {\n                    for (let i = params.length; i < numberOfParams; i++) {\n                        result.push(null);\n                    }\n                }\n                break;\n        }\n        return result;\n    }\n    const connection = {\n        sendNotification: (type, ...args) => {\n            throwIfClosedOrDisposed();\n            let method;\n            let messageParams;\n            if (Is.string(type)) {\n                method = type;\n                const first = args[0];\n                let paramStart = 0;\n                let parameterStructures = messages_1.ParameterStructures.auto;\n                if (messages_1.ParameterStructures.is(first)) {\n                    paramStart = 1;\n                    parameterStructures = first;\n                }\n                let paramEnd = args.length;\n                const numberOfParams = paramEnd - paramStart;\n                switch (numberOfParams) {\n                    case 0:\n                        messageParams = undefined;\n                        break;\n                    case 1:\n                        messageParams = computeSingleParam(parameterStructures, args[paramStart]);\n                        break;\n                    default:\n                        if (parameterStructures === messages_1.ParameterStructures.byName) {\n                            throw new Error(`Received ${numberOfParams} parameters for 'by Name' notification parameter structure.`);\n                        }\n                        messageParams = args.slice(paramStart, paramEnd).map(value => undefinedToNull(value));\n                        break;\n                }\n            }\n            else {\n                const params = args;\n                method = type.method;\n                messageParams = computeMessageParams(type, params);\n            }\n            const notificationMessage = {\n                jsonrpc: version,\n                method: method,\n                params: messageParams\n            };\n            traceSendingNotification(notificationMessage);\n            return messageWriter.write(notificationMessage).catch((error) => {\n                logger.error(`Sending notification failed.`);\n                throw error;\n            });\n        },\n        onNotification: (type, handler) => {\n            throwIfClosedOrDisposed();\n            let method;\n            if (Is.func(type)) {\n                starNotificationHandler = type;\n            }\n            else if (handler) {\n                if (Is.string(type)) {\n                    method = type;\n                    notificationHandlers.set(type, { type: undefined, handler });\n                }\n                else {\n                    method = type.method;\n                    notificationHandlers.set(type.method, { type, handler });\n                }\n            }\n            return {\n                dispose: () => {\n                    if (method !== undefined) {\n                        notificationHandlers.delete(method);\n                    }\n                    else {\n                        starNotificationHandler = undefined;\n                    }\n                }\n            };\n        },\n        onProgress: (_type, token, handler) => {\n            if (progressHandlers.has(token)) {\n                throw new Error(`Progress handler for token ${token} already registered`);\n            }\n            progressHandlers.set(token, handler);\n            return {\n                dispose: () => {\n                    progressHandlers.delete(token);\n                }\n            };\n        },\n        sendProgress: (_type, token, value) => {\n            // This should not await but simple return to ensure that we don't have another\n            // async scheduling. Otherwise one send could overtake another send.\n            return connection.sendNotification(ProgressNotification.type, { token, value });\n        },\n        onUnhandledProgress: unhandledProgressEmitter.event,\n        sendRequest: (type, ...args) => {\n            throwIfClosedOrDisposed();\n            throwIfNotListening();\n            let method;\n            let messageParams;\n            let token = undefined;\n            if (Is.string(type)) {\n                method = type;\n                const first = args[0];\n                const last = args[args.length - 1];\n                let paramStart = 0;\n                let parameterStructures = messages_1.ParameterStructures.auto;\n                if (messages_1.ParameterStructures.is(first)) {\n                    paramStart = 1;\n                    parameterStructures = first;\n                }\n                let paramEnd = args.length;\n                if (cancellation_1.CancellationToken.is(last)) {\n                    paramEnd = paramEnd - 1;\n                    token = last;\n                }\n                const numberOfParams = paramEnd - paramStart;\n                switch (numberOfParams) {\n                    case 0:\n                        messageParams = undefined;\n                        break;\n                    case 1:\n                        messageParams = computeSingleParam(parameterStructures, args[paramStart]);\n                        break;\n                    default:\n                        if (parameterStructures === messages_1.ParameterStructures.byName) {\n                            throw new Error(`Received ${numberOfParams} parameters for 'by Name' request parameter structure.`);\n                        }\n                        messageParams = args.slice(paramStart, paramEnd).map(value => undefinedToNull(value));\n                        break;\n                }\n            }\n            else {\n                const params = args;\n                method = type.method;\n                messageParams = computeMessageParams(type, params);\n                const numberOfParams = type.numberOfParams;\n                token = cancellation_1.CancellationToken.is(params[numberOfParams]) ? params[numberOfParams] : undefined;\n            }\n            const id = sequenceNumber++;\n            let disposable;\n            if (token) {\n                disposable = token.onCancellationRequested(() => {\n                    const p = cancellationStrategy.sender.sendCancellation(connection, id);\n                    if (p === undefined) {\n                        logger.log(`Received no promise from cancellation strategy when cancelling id ${id}`);\n                        return Promise.resolve();\n                    }\n                    else {\n                        return p.catch(() => {\n                            logger.log(`Sending cancellation messages for id ${id} failed`);\n                        });\n                    }\n                });\n            }\n            const requestMessage = {\n                jsonrpc: version,\n                id: id,\n                method: method,\n                params: messageParams\n            };\n            traceSendingRequest(requestMessage);\n            if (typeof cancellationStrategy.sender.enableCancellation === 'function') {\n                cancellationStrategy.sender.enableCancellation(requestMessage);\n            }\n            return new Promise(async (resolve, reject) => {\n                const resolveWithCleanup = (r) => {\n                    resolve(r);\n                    cancellationStrategy.sender.cleanup(id);\n                    disposable?.dispose();\n                };\n                const rejectWithCleanup = (r) => {\n                    reject(r);\n                    cancellationStrategy.sender.cleanup(id);\n                    disposable?.dispose();\n                };\n                const responsePromise = { method: method, timerStart: Date.now(), resolve: resolveWithCleanup, reject: rejectWithCleanup };\n                try {\n                    await messageWriter.write(requestMessage);\n                    responsePromises.set(id, responsePromise);\n                }\n                catch (error) {\n                    logger.error(`Sending request failed.`);\n                    // Writing the message failed. So we need to reject the promise.\n                    responsePromise.reject(new messages_1.ResponseError(messages_1.ErrorCodes.MessageWriteError, error.message ? error.message : 'Unknown reason'));\n                    throw error;\n                }\n            });\n        },\n        onRequest: (type, handler) => {\n            throwIfClosedOrDisposed();\n            let method = null;\n            if (StarRequestHandler.is(type)) {\n                method = undefined;\n                starRequestHandler = type;\n            }\n            else if (Is.string(type)) {\n                method = null;\n                if (handler !== undefined) {\n                    method = type;\n                    requestHandlers.set(type, { handler: handler, type: undefined });\n                }\n            }\n            else {\n                if (handler !== undefined) {\n                    method = type.method;\n                    requestHandlers.set(type.method, { type, handler });\n                }\n            }\n            return {\n                dispose: () => {\n                    if (method === null) {\n                        return;\n                    }\n                    if (method !== undefined) {\n                        requestHandlers.delete(method);\n                    }\n                    else {\n                        starRequestHandler = undefined;\n                    }\n                }\n            };\n        },\n        hasPendingResponse: () => {\n            return responsePromises.size > 0;\n        },\n        trace: async (_value, _tracer, sendNotificationOrTraceOptions) => {\n            let _sendNotification = false;\n            let _traceFormat = TraceFormat.Text;\n            if (sendNotificationOrTraceOptions !== undefined) {\n                if (Is.boolean(sendNotificationOrTraceOptions)) {\n                    _sendNotification = sendNotificationOrTraceOptions;\n                }\n                else {\n                    _sendNotification = sendNotificationOrTraceOptions.sendNotification || false;\n                    _traceFormat = sendNotificationOrTraceOptions.traceFormat || TraceFormat.Text;\n                }\n            }\n            trace = _value;\n            traceFormat = _traceFormat;\n            if (trace === Trace.Off) {\n                tracer = undefined;\n            }\n            else {\n                tracer = _tracer;\n            }\n            if (_sendNotification && !isClosed() && !isDisposed()) {\n                await connection.sendNotification(SetTraceNotification.type, { value: Trace.toString(_value) });\n            }\n        },\n        onError: errorEmitter.event,\n        onClose: closeEmitter.event,\n        onUnhandledNotification: unhandledNotificationEmitter.event,\n        onDispose: disposeEmitter.event,\n        end: () => {\n            messageWriter.end();\n        },\n        dispose: () => {\n            if (isDisposed()) {\n                return;\n            }\n            state = ConnectionState.Disposed;\n            disposeEmitter.fire(undefined);\n            const error = new messages_1.ResponseError(messages_1.ErrorCodes.PendingResponseRejected, 'Pending response rejected since connection got disposed');\n            for (const promise of responsePromises.values()) {\n                promise.reject(error);\n            }\n            responsePromises = new Map();\n            requestTokens = new Map();\n            knownCanceledRequests = new Set();\n            messageQueue = new linkedMap_1.LinkedMap();\n            // Test for backwards compatibility\n            if (Is.func(messageWriter.dispose)) {\n                messageWriter.dispose();\n            }\n            if (Is.func(messageReader.dispose)) {\n                messageReader.dispose();\n            }\n        },\n        listen: () => {\n            throwIfClosedOrDisposed();\n            throwIfListening();\n            state = ConnectionState.Listening;\n            messageReader.listen(callback);\n        },\n        inspect: () => {\n            // eslint-disable-next-line no-console\n            (0, ral_1.default)().console.log('inspect');\n        }\n    };\n    connection.onNotification(LogTraceNotification.type, (params) => {\n        if (trace === Trace.Off || !tracer) {\n            return;\n        }\n        const verbose = trace === Trace.Verbose || trace === Trace.Compact;\n        tracer.log(params.message, verbose ? params.verbose : undefined);\n    });\n    connection.onNotification(ProgressNotification.type, (params) => {\n        const handler = progressHandlers.get(params.token);\n        if (handler) {\n            handler(params.value);\n        }\n        else {\n            unhandledProgressEmitter.fire(params);\n        }\n    });\n    return connection;\n}\nexports.createMessageConnection = createMessageConnection;\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\n/// <reference path=\"../../typings/thenable.d.ts\" />\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ProgressType = exports.ProgressToken = exports.createMessageConnection = exports.NullLogger = exports.ConnectionOptions = exports.ConnectionStrategy = exports.AbstractMessageBuffer = exports.WriteableStreamMessageWriter = exports.AbstractMessageWriter = exports.MessageWriter = exports.ReadableStreamMessageReader = exports.AbstractMessageReader = exports.MessageReader = exports.SharedArrayReceiverStrategy = exports.SharedArraySenderStrategy = exports.CancellationToken = exports.CancellationTokenSource = exports.Emitter = exports.Event = exports.Disposable = exports.LRUCache = exports.Touch = exports.LinkedMap = exports.ParameterStructures = exports.NotificationType9 = exports.NotificationType8 = exports.NotificationType7 = exports.NotificationType6 = exports.NotificationType5 = exports.NotificationType4 = exports.NotificationType3 = exports.NotificationType2 = exports.NotificationType1 = exports.NotificationType0 = exports.NotificationType = exports.ErrorCodes = exports.ResponseError = exports.RequestType9 = exports.RequestType8 = exports.RequestType7 = exports.RequestType6 = exports.RequestType5 = exports.RequestType4 = exports.RequestType3 = exports.RequestType2 = exports.RequestType1 = exports.RequestType0 = exports.RequestType = exports.Message = exports.RAL = void 0;\nexports.MessageStrategy = exports.CancellationStrategy = exports.CancellationSenderStrategy = exports.CancellationReceiverStrategy = exports.ConnectionError = exports.ConnectionErrors = exports.LogTraceNotification = exports.SetTraceNotification = exports.TraceFormat = exports.TraceValues = exports.Trace = void 0;\nconst messages_1 = require(\"./messages\");\nObject.defineProperty(exports, \"Message\", { enumerable: true, get: function () { return messages_1.Message; } });\nObject.defineProperty(exports, \"RequestType\", { enumerable: true, get: function () { return messages_1.RequestType; } });\nObject.defineProperty(exports, \"RequestType0\", { enumerable: true, get: function () { return messages_1.RequestType0; } });\nObject.defineProperty(exports, \"RequestType1\", { enumerable: true, get: function () { return messages_1.RequestType1; } });\nObject.defineProperty(exports, \"RequestType2\", { enumerable: true, get: function () { return messages_1.RequestType2; } });\nObject.defineProperty(exports, \"RequestType3\", { enumerable: true, get: function () { return messages_1.RequestType3; } });\nObject.defineProperty(exports, \"RequestType4\", { enumerable: true, get: function () { return messages_1.RequestType4; } });\nObject.defineProperty(exports, \"RequestType5\", { enumerable: true, get: function () { return messages_1.RequestType5; } });\nObject.defineProperty(exports, \"RequestType6\", { enumerable: true, get: function () { return messages_1.RequestType6; } });\nObject.defineProperty(exports, \"RequestType7\", { enumerable: true, get: function () { return messages_1.RequestType7; } });\nObject.defineProperty(exports, \"RequestType8\", { enumerable: true, get: function () { return messages_1.RequestType8; } });\nObject.defineProperty(exports, \"RequestType9\", { enumerable: true, get: function () { return messages_1.RequestType9; } });\nObject.defineProperty(exports, \"ResponseError\", { enumerable: true, get: function () { return messages_1.ResponseError; } });\nObject.defineProperty(exports, \"ErrorCodes\", { enumerable: true, get: function () { return messages_1.ErrorCodes; } });\nObject.defineProperty(exports, \"NotificationType\", { enumerable: true, get: function () { return messages_1.NotificationType; } });\nObject.defineProperty(exports, \"NotificationType0\", { enumerable: true, get: function () { return messages_1.NotificationType0; } });\nObject.defineProperty(exports, \"NotificationType1\", { enumerable: true, get: function () { return messages_1.NotificationType1; } });\nObject.defineProperty(exports, \"NotificationType2\", { enumerable: true, get: function () { return messages_1.NotificationType2; } });\nObject.defineProperty(exports, \"NotificationType3\", { enumerable: true, get: function () { return messages_1.NotificationType3; } });\nObject.defineProperty(exports, \"NotificationType4\", { enumerable: true, get: function () { return messages_1.NotificationType4; } });\nObject.defineProperty(exports, \"NotificationType5\", { enumerable: true, get: function () { return messages_1.NotificationType5; } });\nObject.defineProperty(exports, \"NotificationType6\", { enumerable: true, get: function () { return messages_1.NotificationType6; } });\nObject.defineProperty(exports, \"NotificationType7\", { enumerable: true, get: function () { return messages_1.NotificationType7; } });\nObject.defineProperty(exports, \"NotificationType8\", { enumerable: true, get: function () { return messages_1.NotificationType8; } });\nObject.defineProperty(exports, \"NotificationType9\", { enumerable: true, get: function () { return messages_1.NotificationType9; } });\nObject.defineProperty(exports, \"ParameterStructures\", { enumerable: true, get: function () { return messages_1.ParameterStructures; } });\nconst linkedMap_1 = require(\"./linkedMap\");\nObject.defineProperty(exports, \"LinkedMap\", { enumerable: true, get: function () { return linkedMap_1.LinkedMap; } });\nObject.defineProperty(exports, \"LRUCache\", { enumerable: true, get: function () { return linkedMap_1.LRUCache; } });\nObject.defineProperty(exports, \"Touch\", { enumerable: true, get: function () { return linkedMap_1.Touch; } });\nconst disposable_1 = require(\"./disposable\");\nObject.defineProperty(exports, \"Disposable\", { enumerable: true, get: function () { return disposable_1.Disposable; } });\nconst events_1 = require(\"./events\");\nObject.defineProperty(exports, \"Event\", { enumerable: true, get: function () { return events_1.Event; } });\nObject.defineProperty(exports, \"Emitter\", { enumerable: true, get: function () { return events_1.Emitter; } });\nconst cancellation_1 = require(\"./cancellation\");\nObject.defineProperty(exports, \"CancellationTokenSource\", { enumerable: true, get: function () { return cancellation_1.CancellationTokenSource; } });\nObject.defineProperty(exports, \"CancellationToken\", { enumerable: true, get: function () { return cancellation_1.CancellationToken; } });\nconst sharedArrayCancellation_1 = require(\"./sharedArrayCancellation\");\nObject.defineProperty(exports, \"SharedArraySenderStrategy\", { enumerable: true, get: function () { return sharedArrayCancellation_1.SharedArraySenderStrategy; } });\nObject.defineProperty(exports, \"SharedArrayReceiverStrategy\", { enumerable: true, get: function () { return sharedArrayCancellation_1.SharedArrayReceiverStrategy; } });\nconst messageReader_1 = require(\"./messageReader\");\nObject.defineProperty(exports, \"MessageReader\", { enumerable: true, get: function () { return messageReader_1.MessageReader; } });\nObject.defineProperty(exports, \"AbstractMessageReader\", { enumerable: true, get: function () { return messageReader_1.AbstractMessageReader; } });\nObject.defineProperty(exports, \"ReadableStreamMessageReader\", { enumerable: true, get: function () { return messageReader_1.ReadableStreamMessageReader; } });\nconst messageWriter_1 = require(\"./messageWriter\");\nObject.defineProperty(exports, \"MessageWriter\", { enumerable: true, get: function () { return messageWriter_1.MessageWriter; } });\nObject.defineProperty(exports, \"AbstractMessageWriter\", { enumerable: true, get: function () { return messageWriter_1.AbstractMessageWriter; } });\nObject.defineProperty(exports, \"WriteableStreamMessageWriter\", { enumerable: true, get: function () { return messageWriter_1.WriteableStreamMessageWriter; } });\nconst messageBuffer_1 = require(\"./messageBuffer\");\nObject.defineProperty(exports, \"AbstractMessageBuffer\", { enumerable: true, get: function () { return messageBuffer_1.AbstractMessageBuffer; } });\nconst connection_1 = require(\"./connection\");\nObject.defineProperty(exports, \"ConnectionStrategy\", { enumerable: true, get: function () { return connection_1.ConnectionStrategy; } });\nObject.defineProperty(exports, \"ConnectionOptions\", { enumerable: true, get: function () { return connection_1.ConnectionOptions; } });\nObject.defineProperty(exports, \"NullLogger\", { enumerable: true, get: function () { return connection_1.NullLogger; } });\nObject.defineProperty(exports, \"createMessageConnection\", { enumerable: true, get: function () { return connection_1.createMessageConnection; } });\nObject.defineProperty(exports, \"ProgressToken\", { enumerable: true, get: function () { return connection_1.ProgressToken; } });\nObject.defineProperty(exports, \"ProgressType\", { enumerable: true, get: function () { return connection_1.ProgressType; } });\nObject.defineProperty(exports, \"Trace\", { enumerable: true, get: function () { return connection_1.Trace; } });\nObject.defineProperty(exports, \"TraceValues\", { enumerable: true, get: function () { return connection_1.TraceValues; } });\nObject.defineProperty(exports, \"TraceFormat\", { enumerable: true, get: function () { return connection_1.TraceFormat; } });\nObject.defineProperty(exports, \"SetTraceNotification\", { enumerable: true, get: function () { return connection_1.SetTraceNotification; } });\nObject.defineProperty(exports, \"LogTraceNotification\", { enumerable: true, get: function () { return connection_1.LogTraceNotification; } });\nObject.defineProperty(exports, \"ConnectionErrors\", { enumerable: true, get: function () { return connection_1.ConnectionErrors; } });\nObject.defineProperty(exports, \"ConnectionError\", { enumerable: true, get: function () { return connection_1.ConnectionError; } });\nObject.defineProperty(exports, \"CancellationReceiverStrategy\", { enumerable: true, get: function () { return connection_1.CancellationReceiverStrategy; } });\nObject.defineProperty(exports, \"CancellationSenderStrategy\", { enumerable: true, get: function () { return connection_1.CancellationSenderStrategy; } });\nObject.defineProperty(exports, \"CancellationStrategy\", { enumerable: true, get: function () { return connection_1.CancellationStrategy; } });\nObject.defineProperty(exports, \"MessageStrategy\", { enumerable: true, get: function () { return connection_1.MessageStrategy; } });\nconst ral_1 = require(\"./ral\");\nexports.RAL = ral_1.default;\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst api_1 = require(\"../common/api\");\nclass MessageBuffer extends api_1.AbstractMessageBuffer {\n    constructor(encoding = 'utf-8') {\n        super(encoding);\n        this.asciiDecoder = new TextDecoder('ascii');\n    }\n    emptyBuffer() {\n        return MessageBuffer.emptyBuffer;\n    }\n    fromString(value, _encoding) {\n        return (new TextEncoder()).encode(value);\n    }\n    toString(value, encoding) {\n        if (encoding === 'ascii') {\n            return this.asciiDecoder.decode(value);\n        }\n        else {\n            return (new TextDecoder(encoding)).decode(value);\n        }\n    }\n    asNative(buffer, length) {\n        if (length === undefined) {\n            return buffer;\n        }\n        else {\n            return buffer.slice(0, length);\n        }\n    }\n    allocNative(length) {\n        return new Uint8Array(length);\n    }\n}\nMessageBuffer.emptyBuffer = new Uint8Array(0);\nclass ReadableStreamWrapper {\n    constructor(socket) {\n        this.socket = socket;\n        this._onData = new api_1.Emitter();\n        this._messageListener = (event) => {\n            const blob = event.data;\n            blob.arrayBuffer().then((buffer) => {\n                this._onData.fire(new Uint8Array(buffer));\n            }, () => {\n                (0, api_1.RAL)().console.error(`Converting blob to array buffer failed.`);\n            });\n        };\n        this.socket.addEventListener('message', this._messageListener);\n    }\n    onClose(listener) {\n        this.socket.addEventListener('close', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('close', listener));\n    }\n    onError(listener) {\n        this.socket.addEventListener('error', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('error', listener));\n    }\n    onEnd(listener) {\n        this.socket.addEventListener('end', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('end', listener));\n    }\n    onData(listener) {\n        return this._onData.event(listener);\n    }\n}\nclass WritableStreamWrapper {\n    constructor(socket) {\n        this.socket = socket;\n    }\n    onClose(listener) {\n        this.socket.addEventListener('close', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('close', listener));\n    }\n    onError(listener) {\n        this.socket.addEventListener('error', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('error', listener));\n    }\n    onEnd(listener) {\n        this.socket.addEventListener('end', listener);\n        return api_1.Disposable.create(() => this.socket.removeEventListener('end', listener));\n    }\n    write(data, encoding) {\n        if (typeof data === 'string') {\n            if (encoding !== undefined && encoding !== 'utf-8') {\n                throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${encoding}`);\n            }\n            this.socket.send(data);\n        }\n        else {\n            this.socket.send(data);\n        }\n        return Promise.resolve();\n    }\n    end() {\n        this.socket.close();\n    }\n}\nconst _textEncoder = new TextEncoder();\nconst _ril = Object.freeze({\n    messageBuffer: Object.freeze({\n        create: (encoding) => new MessageBuffer(encoding)\n    }),\n    applicationJson: Object.freeze({\n        encoder: Object.freeze({\n            name: 'application/json',\n            encode: (msg, options) => {\n                if (options.charset !== 'utf-8') {\n                    throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${options.charset}`);\n                }\n                return Promise.resolve(_textEncoder.encode(JSON.stringify(msg, undefined, 0)));\n            }\n        }),\n        decoder: Object.freeze({\n            name: 'application/json',\n            decode: (buffer, options) => {\n                if (!(buffer instanceof Uint8Array)) {\n                    throw new Error(`In a Browser environments only Uint8Arrays are supported.`);\n                }\n                return Promise.resolve(JSON.parse(new TextDecoder(options.charset).decode(buffer)));\n            }\n        })\n    }),\n    stream: Object.freeze({\n        asReadableStream: (socket) => new ReadableStreamWrapper(socket),\n        asWritableStream: (socket) => new WritableStreamWrapper(socket)\n    }),\n    console: console,\n    timer: Object.freeze({\n        setTimeout(callback, ms, ...args) {\n            const handle = setTimeout(callback, ms, ...args);\n            return { dispose: () => clearTimeout(handle) };\n        },\n        setImmediate(callback, ...args) {\n            const handle = setTimeout(callback, 0, ...args);\n            return { dispose: () => clearTimeout(handle) };\n        },\n        setInterval(callback, ms, ...args) {\n            const handle = setInterval(callback, ms, ...args);\n            return { dispose: () => clearInterval(handle) };\n        },\n    })\n});\nfunction RIL() {\n    return _ril;\n}\n(function (RIL) {\n    function install() {\n        api_1.RAL.install(_ril);\n    }\n    RIL.install = install;\n})(RIL || (RIL = {}));\nexports.default = RIL;\n", "\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createMessageConnection = exports.BrowserMessageWriter = exports.BrowserMessageReader = void 0;\nconst ril_1 = require(\"./ril\");\n// Install the browser runtime abstract.\nril_1.default.install();\nconst api_1 = require(\"../common/api\");\n__exportStar(require(\"../common/api\"), exports);\nclass BrowserMessageReader extends api_1.AbstractMessageReader {\n    constructor(port) {\n        super();\n        this._onData = new api_1.Emitter();\n        this._messageListener = (event) => {\n            this._onData.fire(event.data);\n        };\n        port.addEventListener('error', (event) => this.fireError(event));\n        port.onmessage = this._messageListener;\n    }\n    listen(callback) {\n        return this._onData.event(callback);\n    }\n}\nexports.BrowserMessageReader = BrowserMessageReader;\nclass BrowserMessageWriter extends api_1.AbstractMessageWriter {\n    constructor(port) {\n        super();\n        this.port = port;\n        this.errorCount = 0;\n        port.addEventListener('error', (event) => this.fireError(event));\n    }\n    write(msg) {\n        try {\n            this.port.postMessage(msg);\n            return Promise.resolve();\n        }\n        catch (error) {\n            this.handleError(error, msg);\n            return Promise.reject(error);\n        }\n    }\n    handleError(error, msg) {\n        this.errorCount++;\n        this.fireError(error, msg, this.errorCount);\n    }\n    end() {\n    }\n}\nexports.BrowserMessageWriter = BrowserMessageWriter;\nfunction createMessageConnection(reader, writer, logger, options) {\n    if (logger === undefined) {\n        logger = api_1.NullLogger;\n    }\n    if (api_1.ConnectionStrategy.is(options)) {\n        options = { connectionStrategy: options };\n    }\n    return (0, api_1.createMessageConnection)(reader, writer, logger, options);\n}\nexports.createMessageConnection = createMessageConnection;\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport * as jsonrpc from 'vscode-jsonrpc';\nimport { Disposable } from './disposable';\nimport { SafeFunction } from './type-util';\n\n/**\n * GLSP event/emitter API. Reuses the API provided by\n * `vscode-jsonrpc` and overrides certain type definitions to match the type\n * definitions provided by GLSP (Event, Disposable)\n */\n\n/**\n * Represents a typed event. Listener functions can subscribe for a event\n * and will be called when the event is fired. Typically events are provided by services via\n * public property. For example assume we have a service `myService` that exposes a\n * `onStartupComplete` event. Then a listener could be registered like this\n * ```ts\n *      const disposable= this.myService.onStartupComplete(event=> doSomething(event));\n *\n *     // If the listener should be unregistered again, simply call\n *      disposable.dispose()\n * ```\n */\nexport interface Event<T> extends jsonrpc.Event<T> {\n    /**\n     *\n     * @param listener The listener function will be called when the event happens.\n     * @param thisArgs The 'this' which will be used when calling the event listener.\n     * @param disposables An array to which the {@link Disposable} for removing the listener will be added.\n     * @returns a {@link Disposable} to remove the listener again.\n     */\n    (listener: (e: T) => unknown, thisArgs?: unknown, disposables?: Disposable[]): Disposable;\n}\n\n/**\n * Optional options that can be passed to the constructor\n * of an {@link Emitter}.\n */\nexport interface EmitterOptions {\n    /**\n     * Callback function that will be invoked after the first\n     * listener has been registered for the emitter\n     */\n    onFirstListenerAdd?: SafeFunction<void>;\n    /**\n     * Callback function that will be invoked after the last\n     * listener has been removed from the emitter\n     */\n    onLastListenerRemove?: SafeFunction<void>;\n}\n\nexport class Emitter<T> extends jsonrpc.Emitter<T> implements Disposable {\n    constructor(options: EmitterOptions = {}) {\n        super(options);\n    }\n\n    /**\n     * The even that is managed by this emitter.\n     * Intended for the public to allow to subscribe to the emitter`s events.\n     */\n    override get event(): Event<T> {\n        return super.event;\n    }\n\n    /**\n     * Fires and event and notifies all registered listeners\n     */\n    override fire(event: T): void {\n        super.fire(event);\n    }\n}\n\n/**\n * Common interface for events that are fired on a single value change\n */\nexport interface ValueChange<T> {\n    oldValue: T;\n    newValue: T;\n}\n", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = rng;\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto != 'undefined' && typeof msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\nfunction rng() {\n  if (!getRandomValues) {\n    throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n  }\n\n  return getRandomValues(rnds8);\n}\n\nmodule.exports = exports.default;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex; // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n\n  return [bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]]].join('');\n}\n\nvar _default = bytesToUuid;\nexports.default = _default;\nmodule.exports = exports.default;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _rng = _interopRequireDefault(require(\"./rng.js\"));\n\nvar _bytesToUuid = _interopRequireDefault(require(\"./bytesToUuid.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\nvar _nodeId;\n\nvar _clockseq; // Previous uuid creation time\n\n\nvar _lastMSecs = 0;\nvar _lastNSecs = 0; // See https://github.com/uuidjs/uuid for API details\n\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq; // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n\n  if (node == null || clockseq == null) {\n    var seedBytes = options.random || (options.rng || _rng.default)();\n\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [seedBytes[0] | 0x01, seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]];\n    }\n\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  } // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n\n\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime(); // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1; // Time since last uuid creation (in msecs)\n\n  var dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 10000; // Per 4.2.1.2, Bump clockseq on clock regression\n\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  } // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n\n\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  } // Per 4.2.1.2 Throw error if too many uuids are requested\n\n\n  if (nsecs >= 10000) {\n    throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq; // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n\n  msecs += 12219292800000; // `time_low`\n\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff; // `time_mid`\n\n  var tmh = msecs / 0x100000000 * 10000 & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff; // `time_high_and_version`\n\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n\n  b[i++] = tmh >>> 16 & 0xff; // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n\n  b[i++] = clockseq >>> 8 | 0x80; // `clock_seq_low`\n\n  b[i++] = clockseq & 0xff; // `node`\n\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : (0, _bytesToUuid.default)(b);\n}\n\nvar _default = v1;\nexports.default = _default;\nmodule.exports = exports.default;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = _default;\nexports.URL = exports.DNS = void 0;\n\nvar _bytesToUuid = _interopRequireDefault(require(\"./bytesToUuid.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction uuidToBytes(uuid) {\n  // Note: We assume we're being passed a valid uuid string\n  var bytes = [];\n  uuid.replace(/[a-fA-F0-9]{2}/g, function (hex) {\n    bytes.push(parseInt(hex, 16));\n  });\n  return bytes;\n}\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  var bytes = new Array(str.length);\n\n  for (var i = 0; i < str.length; i++) {\n    bytes[i] = str.charCodeAt(i);\n  }\n\n  return bytes;\n}\n\nconst DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexports.DNS = DNS;\nconst URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexports.URL = URL;\n\nfunction _default(name, version, hashfunc) {\n  var generateUUID = function (value, namespace, buf, offset) {\n    var off = buf && offset || 0;\n    if (typeof value == 'string') value = stringToBytes(value);\n    if (typeof namespace == 'string') namespace = uuidToBytes(namespace);\n    if (!Array.isArray(value)) throw TypeError('value must be an array of bytes');\n    if (!Array.isArray(namespace) || namespace.length !== 16) throw TypeError('namespace must be uuid string or an Array of 16 byte values'); // Per 4.3\n\n    var bytes = hashfunc(namespace.concat(value));\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      for (var idx = 0; idx < 16; ++idx) {\n        buf[off + idx] = bytes[idx];\n      }\n    }\n\n    return buf || (0, _bytesToUuid.default)(bytes);\n  }; // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name;\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n/*\n * Browser-compatible JavaScript MD5\n *\n * Modification of JavaScript MD5\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\nfunction md5(bytes) {\n  if (typeof bytes == 'string') {\n    var msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = new Array(msg.length);\n\n    for (var i = 0; i < msg.length; i++) bytes[i] = msg.charCodeAt(i);\n  }\n\n  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));\n}\n/*\n * Convert an array of little-endian words to an array of bytes\n */\n\n\nfunction md5ToHexEncodedArray(input) {\n  var i;\n  var x;\n  var output = [];\n  var length32 = input.length * 32;\n  var hexTab = '0123456789abcdef';\n  var hex;\n\n  for (i = 0; i < length32; i += 8) {\n    x = input[i >> 5] >>> i % 32 & 0xff;\n    hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);\n    output.push(hex);\n  }\n\n  return output;\n}\n/*\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n */\n\n\nfunction wordsToMd5(x, len) {\n  /* append padding */\n  x[len >> 5] |= 0x80 << len % 32;\n  x[(len + 64 >>> 9 << 4) + 14] = len;\n  var i;\n  var olda;\n  var oldb;\n  var oldc;\n  var oldd;\n  var a = 1732584193;\n  var b = -271733879;\n  var c = -1732584194;\n  var d = 271733878;\n\n  for (i = 0; i < x.length; i += 16) {\n    olda = a;\n    oldb = b;\n    oldc = c;\n    oldd = d;\n    a = md5ff(a, b, c, d, x[i], 7, -680876936);\n    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n    b = md5gg(b, c, d, a, x[i], 20, -373897302);\n    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n    d = md5hh(d, a, b, c, x[i], 11, -358537222);\n    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n    a = md5ii(a, b, c, d, x[i], 6, -198630844);\n    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n    a = safeAdd(a, olda);\n    b = safeAdd(b, oldb);\n    c = safeAdd(c, oldc);\n    d = safeAdd(d, oldd);\n  }\n\n  return [a, b, c, d];\n}\n/*\n * Convert an array bytes to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n */\n\n\nfunction bytesToWords(input) {\n  var i;\n  var output = [];\n  output[(input.length >> 2) - 1] = undefined;\n\n  for (i = 0; i < output.length; i += 1) {\n    output[i] = 0;\n  }\n\n  var length8 = input.length * 8;\n\n  for (i = 0; i < length8; i += 8) {\n    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;\n  }\n\n  return output;\n}\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\n\n\nfunction safeAdd(x, y) {\n  var lsw = (x & 0xffff) + (y & 0xffff);\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return msw << 16 | lsw & 0xffff;\n}\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\n\n\nfunction bitRotateLeft(num, cnt) {\n  return num << cnt | num >>> 32 - cnt;\n}\n/*\n * These functions implement the four basic operations the algorithm uses.\n */\n\n\nfunction md5cmn(q, a, b, x, s, t) {\n  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n\nfunction md5ff(a, b, c, d, x, s, t) {\n  return md5cmn(b & c | ~b & d, a, b, x, s, t);\n}\n\nfunction md5gg(a, b, c, d, x, s, t) {\n  return md5cmn(b & d | c & ~d, a, b, x, s, t);\n}\n\nfunction md5hh(a, b, c, d, x, s, t) {\n  return md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n\nfunction md5ii(a, b, c, d, x, s, t) {\n  return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\nvar _default = md5;\nexports.default = _default;\nmodule.exports = exports.default;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _v = _interopRequireDefault(require(\"./v35.js\"));\n\nvar _md = _interopRequireDefault(require(\"./md5.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst v3 = (0, _v.default)('v3', 0x30, _md.default);\nvar _default = v3;\nexports.default = _default;\nmodule.exports = exports.default;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _rng = _interopRequireDefault(require(\"./rng.js\"));\n\nvar _bytesToUuid = _interopRequireDefault(require(\"./bytesToUuid.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof options == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n\n  options = options || {};\n\n  var rnds = options.random || (options.rng || _rng.default)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || (0, _bytesToUuid.default)(rnds);\n}\n\nvar _default = v4;\nexports.default = _default;\nmodule.exports = exports.default;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n// Adapted from Chris Veness' SHA1 code at\n// http://www.movable-type.co.uk/scripts/sha1.html\nfunction f(s, x, y, z) {\n  switch (s) {\n    case 0:\n      return x & y ^ ~x & z;\n\n    case 1:\n      return x ^ y ^ z;\n\n    case 2:\n      return x & y ^ x & z ^ y & z;\n\n    case 3:\n      return x ^ y ^ z;\n  }\n}\n\nfunction ROTL(x, n) {\n  return x << n | x >>> 32 - n;\n}\n\nfunction sha1(bytes) {\n  var K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n  var H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n\n  if (typeof bytes == 'string') {\n    var msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = new Array(msg.length);\n\n    for (var i = 0; i < msg.length; i++) bytes[i] = msg.charCodeAt(i);\n  }\n\n  bytes.push(0x80);\n  var l = bytes.length / 4 + 2;\n  var N = Math.ceil(l / 16);\n  var M = new Array(N);\n\n  for (var i = 0; i < N; i++) {\n    M[i] = new Array(16);\n\n    for (var j = 0; j < 16; j++) {\n      M[i][j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];\n    }\n  }\n\n  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);\n  M[N - 1][14] = Math.floor(M[N - 1][14]);\n  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;\n\n  for (var i = 0; i < N; i++) {\n    var W = new Array(80);\n\n    for (var t = 0; t < 16; t++) W[t] = M[i][t];\n\n    for (var t = 16; t < 80; t++) {\n      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);\n    }\n\n    var a = H[0];\n    var b = H[1];\n    var c = H[2];\n    var d = H[3];\n    var e = H[4];\n\n    for (var t = 0; t < 80; t++) {\n      var s = Math.floor(t / 20);\n      var T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;\n      e = d;\n      d = c;\n      c = ROTL(b, 30) >>> 0;\n      b = a;\n      a = T;\n    }\n\n    H[0] = H[0] + a >>> 0;\n    H[1] = H[1] + b >>> 0;\n    H[2] = H[2] + c >>> 0;\n    H[3] = H[3] + d >>> 0;\n    H[4] = H[4] + e >>> 0;\n  }\n\n  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];\n}\n\nvar _default = sha1;\nexports.default = _default;\nmodule.exports = exports.default;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _v = _interopRequireDefault(require(\"./v35.js\"));\n\nvar _sha = _interopRequireDefault(require(\"./sha1.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst v5 = (0, _v.default)('v5', 0x50, _sha.default);\nvar _default = v5;\nexports.default = _default;\nmodule.exports = exports.default;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"v1\", {\n  enumerable: true,\n  get: function () {\n    return _v.default;\n  }\n});\nObject.defineProperty(exports, \"v3\", {\n  enumerable: true,\n  get: function () {\n    return _v2.default;\n  }\n});\nObject.defineProperty(exports, \"v4\", {\n  enumerable: true,\n  get: function () {\n    return _v3.default;\n  }\n});\nObject.defineProperty(exports, \"v5\", {\n  enumerable: true,\n  get: function () {\n    return _v4.default;\n  }\n});\n\nvar _v = _interopRequireDefault(require(\"./v1.js\"));\n\nvar _v2 = _interopRequireDefault(require(\"./v3.js\"));\n\nvar _v3 = _interopRequireDefault(require(\"./v4.js\"));\n\nvar _v4 = _interopRequireDefault(require(\"./v5.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport * as uuid from 'uuid';\n\nimport { ActionMessage } from '../action-protocol';\nimport { Disposable } from '../utils/disposable';\nimport { Event } from '../utils/event';\nimport { DisposeClientSessionParameters, InitializeClientSessionParameters, InitializeParameters, InitializeResult } from './types';\nimport { AnyObject, hasStringProp } from '../utils/type-util';\n\nexport class ApplicationIdProvider {\n    private static _applicationId?: string;\n    static get(): string {\n        if (!ApplicationIdProvider._applicationId) {\n            ApplicationIdProvider._applicationId = uuid.v4();\n        }\n        return ApplicationIdProvider._applicationId;\n    }\n}\n\nexport type ActionMessageHandler = (message: ActionMessage) => void;\n\nexport enum ClientState {\n    /**\n     * The client has been created.\n     */\n    Initial,\n    /**\n     * `Start` has been called on the client and the start process is still on-going.\n     */\n    Starting,\n    /**\n     * The client failed to complete the start process.\n     */\n    StartFailed,\n    /**\n     * The client was successfully started and is now running.\n     */\n    Running,\n    /**\n     * `Stop` has been called on the client and the stop process is still on-going.\n     */\n    Stopping,\n    /**\n     * The client stopped and disposed the server connection. Thus, action messages can no longer be sent.\n     */\n    Stopped,\n    /**\n     * An error was encountered while connecting to the server. No action messages can be sent.\n     */\n    ServerError\n}\n\nexport interface GLSPClient {\n    /**\n     * Unique client Id.\n     */\n    readonly id: string;\n\n    /**\n     * Current client state.\n     */\n    readonly currentState: ClientState;\n\n    /**\n     * Initializes the client and the server connection. During the start procedure the client is in the\n     * `Starting` state and will transition to either `Running` or `StartFailed`. Calling this method\n     *  if the client is already running has no effect.\n     *\n     * @returns A promise that resolves if the startup was successful.\n     */\n    start(): Promise<void>;\n\n    /**\n     * Send an `initialize` request to the server. The server needs to be initialized in order to accept and\n     * process other requests and notifications. The {@link InitializeResult} ist cached and can be retrieved\n     * via the {@link GLSPClient.initializeResult} property.\n     * Only the first method invocation actually sends a request to the server. Subsequent invocations simply\n     * return the cached result.\n     *\n     * @param params Initialize parameters\n     * @returns A promise of the {@link InitializeResult}.\n     */\n    initializeServer(params: InitializeParameters): Promise<InitializeResult>;\n\n    /**\n     * The cached {@link {InitializeResult}. Is `undefined` if the server has not been initialized yet via\n     * the {@link GLSPClient.initializeServer} method.\n     */\n    readonly initializeResult: InitializeResult | undefined;\n\n    /**\n     * Event that is fired once the first invocation of {@link GLSPClient.initializeServer} has been completed.\n     */\n    readonly onServerInitialized: Event<InitializeResult>;\n\n    /**\n     * Send an `initializeClientSession` request to the server. One client application may open several session.\n     * Each individual diagram on the client side counts as one session and has to provide\n     * a unique clientId.\n     *\n     * @param params InitializeClientSession parameters\n     * @returns A promise that resolves if the initialization was successful\n     */\n    initializeClientSession(params: InitializeClientSessionParameters): Promise<void>;\n\n    /**\n     * Sends a `disposeClientSession` request to the server. This request has to be sent at the end of client session lifecycle\n     * e.g. when an editor widget is closed.\n     *\n     * @param params DisposeClientSession parameters\n     * @returns A promise that resolves if the disposal was successful\n     */\n    disposeClientSession(params: DisposeClientSessionParameters): Promise<void>;\n\n    /**\n     * Send a `shutdown` notification to the server.\n     */\n    shutdownServer(): void;\n\n    /**\n     * Stops the client and disposes unknown resources. During the stop procedure the client is in the `Stopping` state and will\n     * transition to either `Stopped` or `ServerError`.\n     *\n     * @returns A promise that resolves after the server was stopped and disposed.\n     */\n    stop(): Promise<void>;\n\n    /**\n     * Send an action message to the server.\n     *\n     * @param message The message\n     */\n    sendActionMessage(message: ActionMessage): void;\n\n    /**\n     * Sets a handler/listener for action messages received from the server.\n     * Can be scoped to a particular client session by passing the corresponding `clientId`.\n     *\n     * @param handler The action message handler\n     * @param clientId If passed given action message handler will only be invoked for action messages with this client id.\n     * @returns A {@link Disposable} that can be used to unregister the handler\n     */\n    onActionMessage(handler: ActionMessageHandler, clientId?: string): Disposable;\n}\nexport namespace GLSPClient {\n    export interface Options {\n        id: string;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n    export function isOptions(object: unknown): object is Options {\n        return AnyObject.is(object) && hasStringProp(object, 'id');\n    }\n\n    export const protocolVersion = '1.0.0';\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Deferred } from 'sprotty-protocol';\nimport { Disposable } from 'vscode-jsonrpc';\nimport { Action, ActionMessage } from '../action-protocol/base-protocol';\nimport { distinctAdd, remove } from '../utils/array-util';\nimport { Emitter, Event } from '../utils/event';\nimport { ActionMessageHandler, ClientState, GLSPClient } from './glsp-client';\nimport { GLSPClientProxy, GLSPServer } from './glsp-server';\nimport { DisposeClientSessionParameters, InitializeClientSessionParameters, InitializeParameters, InitializeResult } from './types';\n\nexport const GLOBAL_HANDLER_ID = '*';\n/**\n * A simple {@link GLSPClient} implementation for use cases where the client & server are running\n * in the same context/process without a communication layer (like json-rpc) between. The client\n * directly communicates with a given {@link GLSPServer} instance.\n */\nexport class BaseGLSPClient implements GLSPClient {\n    protected state: ClientState;\n    protected _server?: GLSPServer;\n    protected serverDeferred = new Deferred<GLSPServer>();\n    protected onStartDeferred = new Deferred<void>();\n    protected onStopDeferred = new Deferred<void>();\n    readonly proxy: GLSPClientProxy;\n    protected startupTimeout = 1500;\n    protected actionMessageHandlers: Map<string, ActionMessageHandler[]> = new Map([[GLOBAL_HANDLER_ID, []]]);\n    protected _initializeResult: InitializeResult;\n\n    protected onServerInitializedEmitter = new Emitter<InitializeResult>();\n    get onServerInitialized(): Event<InitializeResult> {\n        return this.onServerInitializedEmitter.event;\n    }\n\n    constructor(protected options: GLSPClient.Options) {\n        this.state = ClientState.Initial;\n        this.proxy = this.createProxy();\n    }\n\n    protected createProxy(): GLSPClientProxy {\n        return {\n            process: message => {\n                const handlers = this.actionMessageHandlers.get(message.clientId) ?? this.actionMessageHandlers.get(GLOBAL_HANDLER_ID);\n                if (!handlers) {\n                    console.warn('No ActionMessageHandler is configured- Cannot process server message', message);\n                    return;\n                }\n                handlers.forEach(handler => handler(message));\n            }\n        };\n    }\n\n    configureServer(server: GLSPServer): void {\n        if (this.state === ClientState.Running) {\n            throw new Error('Could not configure new server. The GLSPClient is already running');\n        }\n        this.serverDeferred.resolve(server);\n    }\n\n    start(): Promise<void> {\n        if (this.state === ClientState.Running) {\n            return this.onStartDeferred.promise;\n        }\n\n        this.state = ClientState.Starting;\n        const timeOut = new Promise<GLSPServer>((_, reject) =>\n            setTimeout(() => {\n                reject(new Error('Could not start client. No server is configured'));\n            }, this.startupTimeout)\n        );\n        Promise.race([this.serverDeferred.promise, timeOut])\n            .then(server => {\n                this._server = server;\n                this.state = ClientState.Running;\n                this.onStartDeferred.resolve();\n            })\n            .catch(error => {\n                this.state = ClientState.StartFailed;\n                this.onStartDeferred.reject(error);\n            });\n\n        return this.onStartDeferred.promise;\n    }\n\n    async initializeServer(params: InitializeParameters): Promise<InitializeResult> {\n        if (!this._initializeResult) {\n            this._initializeResult = await this.checkedServer.initialize(params);\n            this.onServerInitializedEmitter.fire(this._initializeResult);\n        }\n        return this._initializeResult;\n    }\n\n    get initializeResult(): InitializeResult | undefined {\n        return this._initializeResult;\n    }\n\n    initializeClientSession(params: InitializeClientSessionParameters): Promise<void> {\n        return this.checkedServer.initializeClientSession(params);\n    }\n\n    disposeClientSession(params: DisposeClientSessionParameters): Promise<void> {\n        return this.checkedServer.disposeClientSession(params);\n    }\n\n    shutdownServer(): void {\n        this.checkedServer.shutdown();\n    }\n\n    async stop(): Promise<void> {\n        if (this.state === ClientState.Stopped || this.state === ClientState.Stopping) {\n            return this.onStop();\n        }\n\n        this.state = ClientState.Stopping;\n        try {\n            if (this._server) {\n                this._server.shutdown();\n            }\n        } finally {\n            this.state = ClientState.Stopped;\n            this.onStopDeferred.resolve();\n        }\n    }\n\n    sendActionMessage(message: ActionMessage<Action>): void {\n        this.checkedServer.process(message);\n    }\n\n    onActionMessage(handler: ActionMessageHandler, clientId?: string): Disposable {\n        if (!clientId) {\n            distinctAdd(this.actionMessageHandlers.get(GLOBAL_HANDLER_ID)!, handler);\n            return Disposable.create(() => remove(this.actionMessageHandlers.get(GLOBAL_HANDLER_ID)!, handler));\n        }\n        if (!this.actionMessageHandlers.has(clientId)) {\n            this.actionMessageHandlers.set(clientId, [handler]);\n        } else {\n            distinctAdd(this.actionMessageHandlers.get(clientId)!, handler);\n        }\n        return Disposable.create(() => remove(this.actionMessageHandlers.get(clientId)!, handler));\n    }\n\n    get currentState(): ClientState {\n        return this.state;\n    }\n\n    onStart(): Promise<void> {\n        return this.onStartDeferred.promise;\n    }\n\n    onStop(): Promise<void> {\n        return this.onStopDeferred.promise;\n    }\n\n    get id(): string {\n        return this.options.id;\n    }\n\n    protected checkState(): void | never {\n        if (this.state !== ClientState.Running) {\n            throw new Error(`Client with id '${this.id}' is not in 'Running' state`);\n        }\n    }\n\n    protected get checkedServer(): GLSPServer {\n        this.checkState();\n        if (!this._server) {\n            throw new Error(`No server is configured for GLSPClient with id '${this.id}'`);\n        }\n        return this._server;\n    }\n\n    setStartupTimeout(ms: number): void {\n        this.startupTimeout = ms;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2022-2023 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ActionMessage } from '../action-protocol';\nimport { DisposeClientSessionParameters, InitializeClientSessionParameters, InitializeParameters, InitializeResult } from './types';\n\n/**\n * Interface for implementations of a ts server component.\n * Based on the specification of the Graphical Language Server Protocol:\n * https://www.eclipse.org/glsp/documentation/protocol/\n */\nexport interface GLSPServer {\n    /**\n     *\n     * The `initialize` request has to be the first request from the client to the server. Until the server has responded\n     * with an {@link InitializeResult} no other request or notification can be handled and is expected to throw an\n     * error. A client is uniquely identified by an `applicationId` and has to specify on which `protocolVersion` it is\n     * based on. In addition, custom arguments can be provided in the `args` map to allow for custom initialization\n     * behavior on the server.\n     *\n     * After successfully initialization all {@link GLSPServerListener}s are notified via the\n     * {@link GLSPServerListener.serverInitialized} method.\n     *\n     * @param params the {@link InitializeParameters}.\n     * @returns A promise of the {@link InitializeResult} .\n     *\n     * @throws {@link Error} Subsequent initialize requests return the {@link InitializeResult} of the initial request\n     * if the given application id and protocol version are matching, otherwise the promise rejects with an error.\n     *\n     */\n    initialize(params: InitializeParameters): Promise<InitializeResult>;\n\n    /**\n     * The `initializeClientSession` request is sent to the server whenever a new graphical representation (diagram) is\n     * created. Each individual diagram on the client side counts as one session and has to provide a unique\n     * `clientSessionId` and its `diagramType`. In addition, custom arguments can be provided in the `args` map to allow\n     * for custom initialization behavior on the server. Subsequent `initializeClientSession` requests for the same\n     * client id and diagram type are expected to resolve successfully but don't have an actual effect because the\n     * corresponding client session is  already initialized.\n     *\n     * @param params the {@link InitializeClientSessionParameters}.\n     * @returns A promise that completes when the initialization was successful.\n     */\n    initializeClientSession(params: InitializeClientSessionParameters): Promise<void>;\n\n    /**\n     * The 'DisposeClientSession' request is sent to the server when a graphical representation (diagram) is no longer\n     * needed, e.g. the tab containing the diagram widget has been closed. The session is identified by its unique\n     * `clientSessionId`. In addition, custom arguments can be provided in the `args` map to allow for custom dispose\n     * behavior on the server.\n     *\n     * @param params the {@link DisposeClientSessionParameters}.\n     * @returns A `void` promise that completes if the disposal was successful.\n     *\n     */\n    disposeClientSession(params: DisposeClientSessionParameters): Promise<void>;\n\n    /**\n     * A `process` notification is sent from the client to server when the server should handle i.e. process a specific\n     * {@link ActionMessage}. Any communication that is performed between initialization and shutdown is handled by\n     * sending action messages, either from the client to the server or from the server to the client. This is the core\n     * part of the Graphical Language Server Protocol.\n     *\n     * @param message The {@link ActionMessage} that should be processed.\n     */\n    process(message: ActionMessage): void;\n\n    /**\n     * The `shutdown` notification is sent from the client to the server if the client disconnects from the server (e.g.\n     * the client application has been closed).\n     * This gives the server a chance to clean up and dispose unknown resources dedicated to the client and its sessions.\n     * All {@link GLSPServerListener}s are notified via the {@link GLSPServerListener.serverShutDown} method.\n     * Afterwards the server instance is considered to be disposed and can no longer be used for handling requests.\n     *\n     */\n    shutdown(): void;\n\n    /**\n     * Register a new {@link GLSPServerListener}.\n     *\n     * @param listener The listener that should be registered.\n     * @returns `true` if the listener was registered successfully, `false` otherwise (e.g. listener is already\n     *         registered).\n     */\n    addListener(listener: GLSPServerListener): boolean;\n\n    /**\n     * Unregister a {@link GLSPServerListener}.\n     *\n     * @param listener The listener that should be removed\n     * @returns 'true' if the listener was unregistered successfully, `false` otherwise (e.g. listener is was not\n     *         registered in the first place).\n     */\n    removeListener(listener: GLSPServerListener): boolean;\n}\n\nexport const GLSPServer = Symbol('GLSPServer');\n\n/**\n * A listener to track the connection status of {@link GLSPClient}s (i.e. client applications).\n * Gets notified when a new GLSP client connects or disconnects.\n */\nexport interface GLSPServerListener {\n    /**\n     * Triggered after a GLSPServer has been initialized via the {@link GLSPServer.initialize()}\n     * method.\n     *\n     * @param server The GLSPServer which has been initialized.\n     */\n    serverInitialized?(server: GLSPServer): void;\n\n    /**\n     * Triggered after the {@link GLSPServer.shutdown()} method has been invoked.\n     *\n     * @param glspServer The glspServer which has been shut down.\n     */\n    serverShutDown?(server: GLSPServer): void;\n}\nexport const GLSPServerListener = Symbol('GLSPServerListener');\n\n/**\n * Communication proxy interface used by the GLSP servers to send action messages to clients.\n * The default `JsonrpcClientProxy` used an underlying jsonrpc message connection for sending the action messages.\n */\nexport interface GLSPClientProxy {\n    /**\n     * A `process` notification is sent from the server to server to the client when the client should handle i.e.\n     * process a specific {@link ActionMessage}. Any communication that is performed between initialization and shutdown\n     * is handled by sending action messages, either from the client to the server or from the server to the client. This\n     * is the core part of the Graphical Language Server Protocol.\n     *\n     * @param message The {@link ActionMessage} that should be processed.\n     */\n    process(message: ActionMessage): void;\n}\nexport const GLSPClientProxy = Symbol('GLSPClientProxy');\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { MessageConnection, NotificationType, NotificationType0, RequestType } from 'vscode-jsonrpc';\nimport { ActionMessage } from '../../action-protocol/base-protocol';\nimport { MaybePromise } from '../../utils/type-util';\nimport { GLSPClient } from '../glsp-client';\nimport { DisposeClientSessionParameters, InitializeClientSessionParameters, InitializeParameters, InitializeResult } from '../types';\n\nexport type ConnectionProvider = MessageConnection | (() => MaybePromise<MessageConnection>);\n\nexport namespace JsonrpcGLSPClient {\n    export interface Options extends GLSPClient.Options {\n        connectionProvider: ConnectionProvider;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n    export function isOptions(object: unknown): object is Options {\n        return GLSPClient.isOptions(object) && 'connectionProvider' in object;\n    }\n\n    export const ActionMessageNotification = new NotificationType<ActionMessage>('process');\n    export const InitializeRequest = new RequestType<InitializeParameters, InitializeResult, void>('initialize');\n    export const InitializeClientSessionRequest = new RequestType<InitializeClientSessionParameters, void, void>('initializeClientSession');\n    export const DisposeClientSessionRequest = new RequestType<DisposeClientSessionParameters, void, void>('disposeClientSession');\n\n    export const ShutdownNotification = new NotificationType0('shutdown');\n    export const ClientNotReadyMsg = 'JsonrpcGLSPClient is not ready yet';\n\n    export function error(message: string, ...optionalParams: unknown[]): void {\n        console.error(`[JsonrpcGLSPClient] ${message}`, optionalParams);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { Disposable, Message, MessageConnection } from 'vscode-jsonrpc';\nimport { ActionMessage } from '../../action-protocol';\nimport { Emitter, Event } from '../../utils/event';\nimport { ActionMessageHandler, ClientState, GLSPClient } from '../glsp-client';\nimport { GLSPClientProxy } from '../glsp-server';\nimport { DisposeClientSessionParameters, InitializeClientSessionParameters, InitializeParameters, InitializeResult } from '../types';\nimport { ConnectionProvider, JsonrpcGLSPClient } from './glsp-jsonrpc-client';\n\nexport class BaseJsonrpcGLSPClient implements GLSPClient {\n    readonly id: string;\n    protected readonly connectionProvider: ConnectionProvider;\n    protected connectionPromise?: Promise<MessageConnection>;\n    protected resolvedConnection?: MessageConnection;\n    protected state: ClientState;\n    protected onStop?: Promise<void>;\n    protected _initializeResult: InitializeResult | undefined;\n\n    protected onServerInitializedEmitter = new Emitter<InitializeResult>();\n    get onServerInitialized(): Event<InitializeResult> {\n        return this.onServerInitializedEmitter.event;\n    }\n\n    constructor(options: JsonrpcGLSPClient.Options) {\n        Object.assign(this, options);\n        this.state = ClientState.Initial;\n    }\n\n    shutdownServer(): void {\n        this.checkedConnection.sendNotification(JsonrpcGLSPClient.ShutdownNotification);\n    }\n\n    async initializeServer(params: InitializeParameters): Promise<InitializeResult> {\n        if (!this._initializeResult) {\n            this._initializeResult = await this.checkedConnection.sendRequest(JsonrpcGLSPClient.InitializeRequest, params);\n            this.onServerInitializedEmitter.fire(this._initializeResult);\n        }\n        return this._initializeResult;\n    }\n\n    get initializeResult(): InitializeResult | undefined {\n        return this._initializeResult;\n    }\n\n    initializeClientSession(params: InitializeClientSessionParameters): Promise<void> {\n        return this.checkedConnection.sendRequest(JsonrpcGLSPClient.InitializeClientSessionRequest, params);\n    }\n\n    disposeClientSession(params: DisposeClientSessionParameters): Promise<void> {\n        return this.checkedConnection.sendRequest(JsonrpcGLSPClient.DisposeClientSessionRequest, params);\n    }\n\n    onActionMessage(handler: ActionMessageHandler, clientId?: string): Disposable {\n        return this.checkedConnection.onNotification(JsonrpcGLSPClient.ActionMessageNotification, msg => {\n            if (!clientId || msg.clientId === clientId) {\n                handler(msg);\n            }\n        });\n    }\n\n    sendActionMessage(message: ActionMessage): void {\n        this.checkedConnection.sendNotification(JsonrpcGLSPClient.ActionMessageNotification, message);\n    }\n\n    protected get checkedConnection(): MessageConnection {\n        if (!this.isConnectionActive()) {\n            throw new Error(JsonrpcGLSPClient.ClientNotReadyMsg);\n        }\n        return this.resolvedConnection!;\n    }\n\n    async start(): Promise<void> {\n        if (this.state === ClientState.Running) {\n            return;\n        }\n        try {\n            this.state = ClientState.Starting;\n            const connection = await this.resolveConnection();\n            connection.listen();\n            this.resolvedConnection = connection;\n            this.state = ClientState.Running;\n        } catch (error) {\n            JsonrpcGLSPClient.error('Failed to start connection to server', error);\n            this.state = ClientState.StartFailed;\n        }\n    }\n\n    stop(): Promise<void> {\n        if (!this.connectionPromise) {\n            this.state = ClientState.Stopped;\n            return Promise.resolve();\n        }\n        if (this.state === ClientState.Stopping && this.onStop) {\n            return this.onStop;\n        }\n        this.state = ClientState.Stopping;\n        return (this.onStop = this.resolveConnection().then(connection => {\n            connection.dispose();\n            this.state = ClientState.Stopped;\n            this.onStop = undefined;\n            this.connectionPromise = undefined;\n            this.resolvedConnection = undefined;\n        }));\n    }\n\n    protected resolveConnection(): Promise<MessageConnection> {\n        if (!this.connectionPromise) {\n            this.connectionPromise = this.doCreateConnection();\n        }\n        return this.connectionPromise;\n    }\n\n    protected async doCreateConnection(): Promise<MessageConnection> {\n        const connection = typeof this.connectionProvider === 'function' ? await this.connectionProvider() : this.connectionProvider;\n        connection.onError(data => this.handleConnectionError(data[0], data[1], data[2]));\n        connection.onClose(() => this.handleConnectionClosed());\n        return connection;\n    }\n\n    protected handleConnectionError(error: Error, message: Message | undefined, count: number | undefined): void {\n        JsonrpcGLSPClient.error('Connection to server is erroring. Shutting down server.', error);\n        this.stop();\n        this.state = ClientState.ServerError;\n    }\n\n    protected handleConnectionClosed(): void {\n        if (this.state === ClientState.Stopping || this.state === ClientState.Stopped) {\n            return;\n        }\n        try {\n            if (this.resolvedConnection) {\n                this.resolvedConnection.dispose();\n                this.connectionPromise = undefined;\n                this.resolvedConnection = undefined;\n            }\n        } catch (error) {\n            // Disposing a connection could fail if error cases.\n        }\n\n        JsonrpcGLSPClient.error('Connection to server got closed. Server will not be restarted.');\n        this.state = ClientState.ServerError;\n    }\n\n    isConnectionActive(): boolean {\n        return this.state === ClientState.Running && !!this.resolvedConnection;\n    }\n\n    get currentState(): ClientState {\n        return this.state;\n    }\n}\n\n/**\n * Default {@link GLSPClientProxy} implementation for jsonrpc-based client-server communication with typescript based servers.\n */\n@injectable()\nexport class JsonrpcClientProxy implements GLSPClientProxy {\n    protected clientConnection?: MessageConnection;\n    protected enableLogging: boolean;\n\n    initialize(clientConnection: MessageConnection, enableLogging = false): void {\n        this.clientConnection = clientConnection;\n        this.enableLogging = enableLogging;\n    }\n\n    process(message: ActionMessage): void {\n        if (this.enableLogging) {\n            console.log(`Send action '${message.action.kind}' to client '${message.clientId}'`);\n        }\n        this.clientConnection?.sendNotification(JsonrpcGLSPClient.ActionMessageNotification, message);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { MessageConnection } from 'vscode-jsonrpc';\nimport { GLSPServer } from '../glsp-server';\nimport { DisposeClientSessionParameters, InitializeClientSessionParameters, InitializeParameters } from '../types';\nimport { JsonrpcGLSPClient } from './glsp-jsonrpc-client';\n\n/**\n * Configure the given client connection to forward the requests and notifications to the given {@link GLSPServer} instance.\n * @param clientConnection JSON-RPC client connection.\n * @param glspServer The GLSP Server which should react to requests & notifications.\n */\nexport function configureClientConnection(clientConnection: MessageConnection, glspServer: GLSPServer): void {\n    clientConnection.onRequest(JsonrpcGLSPClient.InitializeRequest.method, (params: InitializeParameters) => glspServer.initialize(params));\n    clientConnection.onRequest(JsonrpcGLSPClient.InitializeClientSessionRequest, (params: InitializeClientSessionParameters) =>\n        glspServer.initializeClientSession(params)\n    );\n    clientConnection.onRequest(JsonrpcGLSPClient.DisposeClientSessionRequest, (params: DisposeClientSessionParameters) =>\n        glspServer.disposeClientSession(params)\n    );\n    clientConnection.onNotification(JsonrpcGLSPClient.ActionMessageNotification, message => glspServer.process(message));\n\n    clientConnection.listen();\n}\n", "/********************************************************************************\n * Copyright (c) 2023 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n// based on https://github.com/TypeFox/monaco-languageclient/blob/vwj-2.0.1/packages/vscode-ws-jsonrpc/src/socket/reader.ts\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) 2018-2022 TypeFox GmbH (http://www.typefox.io). All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nimport {\n    AbstractMessageReader,\n    AbstractMessageWriter,\n    createMessageConnection,\n    DataCallback,\n    Disposable,\n    Logger,\n    Message,\n    MessageConnection\n} from 'vscode-jsonrpc';\n\n/**\n * A wrapper interface that enables the reuse of the {@link WebSocketMessageReader} and {@link WebSocketMessageWriter}\n * independent of the underlying WebSocket implementation/library. e.g. one could use Socket.io instead of plain WebSockets\n */\nexport interface WebSocketWrapper extends Disposable {\n    send(content: string | ArrayBufferLike | ArrayBufferView): void;\n    onMessage(cb: (data: unknown) => void): void;\n    onError(cb: (reason: unknown) => void): void;\n    onClose(cb: (code: number, reason: string) => void): void;\n}\n\n/**\n * Creates a {@link WebSocketWrapper} for the given plain WebSocket\n * @param socket The socket to wrap\n */\nexport function wrap(socket: WebSocket): WebSocketWrapper {\n    return {\n        send: content => socket.send(content),\n        onMessage: cb => (socket.onmessage = event => cb(event.data)),\n        onClose: cb => (socket.onclose = event => cb(event.code, event.reason)),\n        onError: cb =>\n            (socket.onerror = event => {\n                if ('error' in event) {\n                    cb(event.error);\n                }\n            }),\n        dispose: () => socket.close()\n    };\n}\n\n/**\n * A `vscode-jsonrpc` {@link MessageReader} that reads messages from an underlying {@link WebSocketWrapper}.\n */\nexport class WebSocketMessageReader extends AbstractMessageReader {\n    protected state: 'initial' | 'listening' | 'closed' = 'initial';\n    protected callback?: DataCallback;\n    protected eventQueue: Array<{ message?: unknown; error?: unknown }> = [];\n\n    constructor(protected readonly socket: WebSocketWrapper) {\n        super();\n        this.socket.onMessage(message => this.handleMessage(message));\n        this.socket.onError(error => this.fireError(error));\n        this.socket.onClose(() => this.fireClose());\n    }\n\n    listen(callback: DataCallback): Disposable {\n        if (this.state === 'initial') {\n            this.state = 'listening';\n            this.callback = callback;\n            this.eventQueue.forEach(event => {\n                if (event.message) {\n                    this.handleMessage(event.message);\n                } else if (event.error) {\n                    this.fireError(event.error);\n                } else {\n                    this.fireClose();\n                }\n            });\n            this.eventQueue = [];\n        }\n        return Disposable.create(() => {\n            this.callback = undefined;\n            this.eventQueue = [];\n        });\n    }\n\n    protected handleMessage(message: any): void {\n        if (this.state === 'initial') {\n            this.eventQueue.push({ message });\n        } else if (this.state === 'listening') {\n            const data = JSON.parse(message);\n            this.callback!(data);\n        }\n    }\n\n    protected override fireError(error: unknown): void {\n        if (this.state === 'initial') {\n            this.eventQueue.push({ error });\n        } else if (this.state === 'listening') {\n            super.fireError(error);\n        }\n    }\n\n    protected override fireClose(): void {\n        if (this.state === 'initial') {\n            this.eventQueue.push({});\n        } else if (this.state === 'listening') {\n            super.fireClose();\n        }\n        this.state = 'closed';\n    }\n}\n\n/**\n * A `vscode-jsonrpc` {@link MessageReader} that writes messages to an underlying {@link WebSocketWrapper}.\n */\nexport class WebSocketMessageWriter extends AbstractMessageWriter {\n    protected errorCount = 0;\n\n    constructor(protected readonly socket: WebSocketWrapper) {\n        super();\n    }\n\n    end(): void {\n        /** no-op */\n    }\n\n    async write(msg: Message): Promise<void> {\n        try {\n            const content = JSON.stringify(msg);\n            this.socket.send(content);\n        } catch (e) {\n            this.errorCount++;\n            this.fireError(e, msg, this.errorCount);\n        }\n    }\n}\n\n/**\n * Create a `vscode-jsonrpc` {@link MessageConnection} on top of a given {@link WebSocketWrapper}.\n */\nexport function createWebSocketConnection(socket: WebSocketWrapper, logger?: Logger): MessageConnection {\n    const reader = new WebSocketMessageReader(socket);\n    const writer = new WebSocketMessageWriter(socket);\n    return createMessageConnection(reader, writer, logger);\n}\n\n/**\n * Creates a new {@link MessageConnection} on top of the given websocket on open.\n * @param webSocket The target webSocket\n * @param onConnection Optional callback that is invoked after the connection has been created\n * @param logger Optional connection logger\n * @returns A promise of the created connection\n */\nexport function listen(\n    webSocket: WebSocket,\n    onConnection?: (connection: MessageConnection) => void,\n    logger?: Logger\n): Promise<MessageConnection> {\n    return new Promise(resolve => {\n        webSocket.onopen = () => {\n            const socket = wrap(webSocket);\n            const connection = createWebSocketConnection(socket, logger);\n            onConnection?.(connection);\n            resolve(connection);\n        };\n    });\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Logger, MessageConnection } from 'vscode-jsonrpc';\nimport { MaybePromise } from '../../utils/type-util';\nimport { createWebSocketConnection, wrap } from './websocket-connection';\n\nexport interface GLSPWebSocketOptions {\n    /**\n     * Allow automatic reconnect of WebSocket connections\n     * @default true\n     */\n    reconnecting?: boolean;\n    /**\n     * Max attempts of reconnects\n     * @default Infinity\n     */\n    reconnectAttempts?: number;\n    /**\n     * The time delay in milliseconds between reconnect attempts\n     * @default 1000\n     */\n    reconnectDelay?: number;\n}\n\nexport const GLSPConnectionHandler = Symbol('GLSPConnectionHandler');\nexport interface GLSPConnectionHandler {\n    onConnection?(connection: MessageConnection): MaybePromise<void>;\n    onReconnect?(connection: MessageConnection): MaybePromise<void>;\n    logger?: Logger;\n}\n\nexport class GLSPWebSocketProvider {\n    protected webSocket: WebSocket;\n    protected reconnectTimer: NodeJS.Timer;\n    protected reconnectAttempts = 0;\n\n    protected options: GLSPWebSocketOptions = {\n        // default values\n        reconnecting: true,\n        reconnectAttempts: Infinity,\n        reconnectDelay: 1000\n    };\n\n    constructor(protected url: string, options?: GLSPWebSocketOptions) {\n        this.options = Object.assign(this.options, options);\n    }\n\n    protected createWebSocket(url: string): WebSocket {\n        return new WebSocket(url);\n    }\n\n    listen(handler: GLSPConnectionHandler, isReconnecting = false): Promise<MessageConnection> {\n        this.webSocket = this.createWebSocket(this.url);\n\n        this.webSocket.onerror = (): void => {\n            handler.logger?.error('GLSPWebSocketProvider Connection to server errored. Please make sure that the server is running!');\n            clearInterval(this.reconnectTimer);\n            this.webSocket.close();\n        };\n\n        return new Promise(resolve => {\n            this.webSocket.onopen = (): void => {\n                clearInterval(this.reconnectTimer);\n                const wrappedSocket = wrap(this.webSocket);\n                const wsConnection = createWebSocketConnection(wrappedSocket, handler.logger);\n\n                this.webSocket.onclose = (): void => {\n                    const { reconnecting, reconnectAttempts, reconnectDelay } = this.options;\n                    if (reconnecting) {\n                        if (this.reconnectAttempts >= reconnectAttempts!) {\n                            handler.logger?.error(\n                                'GLSPWebSocketProvider WebSocket reconnect failed - maximum number reconnect attempts ' +\n                                    `(${reconnectAttempts}) was exceeded!`\n                            );\n                        } else {\n                            this.reconnectTimer = setInterval(() => {\n                                handler.logger?.warn('GLSPWebSocketProvider reconnecting...');\n                                this.listen(handler, true);\n                                this.reconnectAttempts++;\n                            }, reconnectDelay!);\n                        }\n                    } else {\n                        handler.logger?.error('GLSPWebSocketProvider WebSocket will not reconnect - closing the connection now!');\n                    }\n                };\n\n                if (isReconnecting) {\n                    handler.logger?.warn('GLSPWebSocketProvider Reconnecting!');\n                    handler.onReconnect?.(wsConnection);\n                } else {\n                    handler.logger?.warn('GLSPWebSocketProvider Initializing!');\n                    handler.onConnection?.(wsConnection);\n                }\n                resolve(wsConnection);\n            };\n        });\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2022 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/**\n * The default types for graphical model elements available in GLSP.\n */\nexport namespace DefaultTypes {\n    // HTML elements\n    export const HTML = 'html';\n\n    // generic types\n    export const FOREIGN_OBJECT = 'foreign-object';\n    export const PRE_RENDERED = 'pre-rendered';\n    export const SHAPE_PRE_RENDERED = 'shape-pre-rendered';\n\n    // SVG elements\n    export const SVG = 'svg';\n\n    // graph types\n    export const GRAPH = 'graph';\n    export const NODE = 'node';\n    export const COMPARTMENT = 'comp';\n    export const COMPARTMENT_HEADER = 'comp:header';\n    export const EDGE = 'edge';\n    export const PORT = 'port';\n    export const ROUTING_POINT = 'routing-point';\n    export const VOLATILE_ROUTING_POINT = `volatile-${ROUTING_POINT}`;\n    export const LABEL = 'label';\n\n    // UI elements\n    export const BUTTON = 'button';\n    export const BUTTON_EXPAND = 'button:expand';\n    export const ISSUE_MARKER = 'marker';\n\n    // shapes\n    export const NODE_CIRCLE = 'node:circle';\n    export const NODE_RECTANGLE = 'node:rectangle';\n    export const NODE_DIAMOND = 'node:diamond';\n}\n", "/********************************************************************************\n * Copyright (c) 2022-2023 STMicroelectronics and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    SCompartment as GCompartmentSchema,\n    SEdge as GEdgeSchema,\n    ForeignObjectElement as GForeignObjectElementSchema,\n    SGraph as GGraphSchema,\n    HtmlRoot as GHtmlRootSchema,\n    SLabel as GLabelSchema,\n    SModelElement as GModelElementSchema,\n    SModelRoot as GModelRootSchema,\n    SNode as GNodeSchema,\n    SPort as GPortSchema,\n    PreRenderedElement as GPreRenderedElementSchema,\n    SShapeElement as GShapeElementSchema,\n    ShapedPreRenderedElement as GShapePreRenderedElementSchema,\n    ViewportRootElement as GViewPortRootElementSchema\n} from 'sprotty-protocol/lib/model';\nimport { hasStringProp } from '../utils/type-util';\n\n/** Serializable representation of GModel elements. This is the transfer format\n * used to exchange model information between client and server. Both the client and\n * server have a deserialization mechanism in place to convert a GModelElementSchema\n * into the corresponding class-based model (or EMF-based in case of the Java Server).\n *\n * To ensure sprotty compatibility all types are just aliases of the corresponding Sprotty SModel API element.\n */\n\nexport function isGModelElementSchema(object: any): object is GModelElementSchema {\n    return typeof object === 'object' && hasStringProp(object, 'type') && hasStringProp(object, 'id');\n}\n\nexport {\n    GCompartmentSchema,\n    GEdgeSchema,\n    GForeignObjectElementSchema,\n    GGraphSchema,\n    GHtmlRootSchema,\n    GLabelSchema,\n    GModelElementSchema,\n    GModelRootSchema,\n    GNodeSchema,\n    GPortSchema,\n    GPreRenderedElementSchema,\n    GShapeElementSchema,\n    GShapePreRenderedElementSchema,\n    GViewPortRootElementSchema\n};\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n/* eslint-disable @typescript-eslint/no-shadow */\n\nimport {\n    BringToFrontAction,\n    CollapseExpandAction,\n    CollapseExpandAllAction,\n    GetSelectionAction,\n    GetViewportAction,\n    HoverFeedbackAction,\n    MoveAction,\n    OpenAction,\n    SelectionResult,\n    SetBoundsAction,\n    SetViewportAction,\n    ViewportResult\n} from 'sprotty-protocol/lib/actions';\nimport { Action, RequestAction } from './action-protocol/base-protocol';\nimport { hasArrayProp, hasBooleanProp, hasObjectProp, hasStringProp } from './utils/type-util';\n\n/*\n * Subset of the actions defined in sprotty-protocol that are reused as is i.e. they don't have a dedicated\n * replacement in the GLSP action protocol.\n *\n * Module augmentation is used to provide utility functions (typeguards etc.) via corresponding namespace.\n */\n\ndeclare module 'sprotty-protocol/lib/actions' {\n    namespace BringToFrontAction {\n        function is(object: unknown): object is BringToFrontAction;\n    }\n    namespace CollapseExpandAction {\n        function is(object: unknown): object is CollapseExpandAction;\n    }\n    namespace CollapseExpandAllAction {\n        function is(object: unknown): object is CollapseExpandAllAction;\n    }\n    namespace GetSelectionAction {\n        function is(object: unknown): object is GetSelectionAction;\n    }\n    namespace GetViewportAction {\n        function is(object: unknown): object is GetViewportAction;\n    }\n    namespace HoverFeedbackAction {\n        function is(object: unknown): object is HoverFeedbackAction;\n    }\n    namespace MoveAction {\n        function is(object: unknown): object is MoveAction;\n    }\n    namespace OpenAction {\n        function is(object: unknown): object is OpenAction;\n    }\n    namespace SelectionResult {\n        function is(object: unknown): object is SelectionResult;\n    }\n    namespace SetBoundsAction {\n        function is(object: unknown): object is SetBoundsAction;\n    }\n    namespace SetViewportAction {\n        function is(object: unknown): object is SetViewportAction;\n    }\n    namespace ViewportResult {\n        function is(object: unknown): object is ViewportResult;\n    }\n}\n\nCollapseExpandAction.is = (object): object is CollapseExpandAction =>\n    Action.hasKind(object, CollapseExpandAction.KIND) && hasArrayProp(object, 'expandIds') && hasArrayProp(object, 'collapseIds');\n\nCollapseExpandAllAction.is = (object): object is CollapseExpandAllAction =>\n    Action.hasKind(object, CollapseExpandAllAction.KIND) && hasBooleanProp(object, 'expand');\n\nGetSelectionAction.is = (object): object is GetSelectionAction => RequestAction.hasKind(object, GetSelectionAction.KIND);\n\nGetViewportAction.is = (object): object is GetViewportAction => RequestAction.hasKind(object, GetViewportAction.KIND);\n\nHoverFeedbackAction.is = (object): object is HoverFeedbackAction =>\n    Action.hasKind(object, HoverFeedbackAction.KIND) && hasStringProp(object, 'mouseoverElement') && hasBooleanProp(object, 'mouseIsOver');\n\nMoveAction.is = (object): object is MoveAction =>\n    Action.hasKind(object, MoveAction.KIND) &&\n    hasArrayProp(object, 'moves') &&\n    hasBooleanProp(object, 'animate') &&\n    hasBooleanProp(object, 'finished');\n\nOpenAction.is = (object): object is OpenAction => Action.hasKind(object, OpenAction.KIND) && hasStringProp(object, 'elementId');\n\nSelectionResult.is = (object): object is SelectionResult =>\n    Action.hasKind(object, SelectionResult.KIND) && hasArrayProp(object, 'selectedElementsIDs');\n\nSetBoundsAction.is = (object): object is SetBoundsAction => Action.hasKind(object, SetBoundsAction.KIND) && hasObjectProp(object, 'bounds');\n\nSetViewportAction.is = (object): object is SetViewportAction =>\n    Action.hasKind(object, SetViewportAction.KIND) &&\n    hasStringProp(object, 'elementId') &&\n    hasObjectProp(object, 'newViewport') &&\n    hasBooleanProp(object, 'animate');\n\nViewportResult.is = (object): object is ViewportResult =>\n    Action.hasKind(object, ViewportResult.KIND) && hasObjectProp(object, 'viewport') && hasObjectProp(object, 'canvasBounds');\n\nexport {\n    BringToFrontAction,\n    CollapseExpandAction,\n    CollapseExpandAllAction,\n    GetSelectionAction,\n    GetViewportAction,\n    HoverFeedbackAction,\n    MoveAction,\n    OpenAction,\n    SelectionResult,\n    SetBoundsAction,\n    SetViewportAction,\n    ViewportResult\n};\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Container, ContainerModule, interfaces } from 'inversify';\nimport { MaybeArray, asArray, distinctAdd, remove } from './array-util';\nimport { hasFunctionProp, hasNumberProp } from './type-util';\n\n/**\n * A wrapper interface to get access to the binding related functions\n * for an inversify container.\n */\nexport interface BindingContext {\n    bind: interfaces.Bind;\n    unbind: interfaces.Unbind;\n    isBound: interfaces.IsBound;\n    rebind: interfaces.Rebind;\n}\n\n/**\n * Initializes a container with the given {@link ContainerConfiguration}. The container configuration\n * consists of the set of {@link ContainerModule}s that should be loaded in the container.\n * In addition, for more fine-grained control {@link ModuleConfiguration}s can be passed as part fo the container configuration\n * Module loading is distinct,this means each module will only get loaded once even if it is configured multiple times.\n  @param containerConfigurations\n *          Custom modules to be loaded in addition to the default modules and/or default modules that should be excluded.\n  @returns The initialized container.\n */\nexport function initializeContainer(container: Container, ...containerConfigurations: ContainerConfiguration): Container {\n    const modules = resolveContainerConfiguration(...containerConfigurations);\n    container.load(...modules);\n    return container;\n}\n\n/**\n *  Processes the given container configurations and returns the corresponding set of {@link ContainerModule}s.\n * @param containerConfigurations The container configurations to resolves\n * @returns an Array of resolved container modules\n */\nexport function resolveContainerConfiguration(...containerConfigurations: ContainerConfiguration): ContainerModule[] {\n    const modules: ContainerModule[] = [];\n    containerConfigurations.forEach(config => {\n        if (isContainerModule(config)) {\n            distinctAdd(modules, config);\n        } else {\n            if (config.remove) {\n                remove(modules, ...asArray(config.remove));\n            }\n            if (config.add) {\n                distinctAdd(modules, ...asArray(config.add));\n            }\n        }\n    });\n    return modules;\n}\n/**\n * The container modules might originate form different inversify contexts (e.g. `inversify` vs. `@theia/core/shared/inversify`).\n * If this is the case an instanceof check can return  false negative.\n * => use a simple typeguard instead.\n */\nfunction isContainerModule(config: ContainerModule | ModuleConfiguration): config is ContainerModule {\n    return hasNumberProp(config, 'id') && hasFunctionProp(config, 'registry');\n}\n\n/**\n * Union type for the set of {@link ContainerModule}s and addition {@link ModuleConfiguration}s\n * used to configure a DI container.\n */\nexport type ContainerConfiguration = Array<ContainerModule | ModuleConfiguration>;\n\n/**\n * Can be passed to create DI container utility functions to configure additional modules or\n * remove (i.e. not load) default modules.\n */\nexport interface ModuleConfiguration {\n    /** Set of modules that should be loaded into the container. Loading */\n    add?: MaybeArray<ContainerModule>;\n    /** Set of modules that should be loaded into the container */\n    remove?: MaybeArray<ContainerModule>;\n}\n\n/**\n * Optional constructor options for {@link FeatureModule}s.\n */\nexport interface FeatureModuleOptions {\n    /**\n     * The set of feature modules that is required in order for this module to load.\n     */\n    requires?: MaybeArray<FeatureModule>;\n    /**\n     * Optional `featureId` that should be used. If omitted an id will be autogenerated\n     */\n    featureId?: symbol;\n}\n/**\n * A `FeatureModule` is a specialized {@link ContainerModule} that can declare dependencies to other {@link FeatureModule}.\n * A feature module will only be loaded into a container if all of its required modules haven been loaded before. T\n * Each feature module binds its `featureId` be default. This enables querying of existing container to check wether a\n * feature module has been loaded into this container.\n */\n\nexport class FeatureModule extends ContainerModule {\n    readonly featureId: symbol;\n\n    readonly requires?: MaybeArray<FeatureModule>;\n\n    constructor(registry: interfaces.ContainerModuleCallBack, options: FeatureModuleOptions = {}) {\n        super((bind, unbind, isBound, ...rest) => {\n            if (this.configure(bind, isBound)) {\n                registry(bind, unbind, isBound, ...rest);\n            }\n        });\n        this.featureId = options.featureId ?? this.createFeatureId();\n        this.requires = options.requires;\n    }\n\n    protected createFeatureId(): symbol {\n        return Symbol(this.id);\n    }\n\n    /**\n     * Configures the feature module i.e. checks if the requirements are met.\n     * If this is the case the {@link FeatureModule.featureId} will be bound and the module will be loaded\n     * @param bind container bind function\n     * @param isBound container isBound function\n     * @returns `true` if all requirements are met and the module is loaded. `false` otherwise\n     */\n    configure(bind: interfaces.Bind, isBound: interfaces.IsBound): boolean {\n        if (this.checkRequirements(isBound)) {\n            bind(this.featureId).toConstantValue(this.featureId);\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Checks if all required {@link FeatureModule}s are already loaded/bound in the container.\n     * @param isBound The `isBound` property of the module callback. Used to check the required modules.\n     * @returns `true` if all requirements are met, `false` otherwise\n     */\n    protected checkRequirements(isBound: interfaces.IsBound): boolean {\n        return this.requires ? asArray(this.requires).every(module => isBound(module.featureId)) : true;\n    }\n\n    isLoaded(context: Pick<BindingContext, 'isBound'>): boolean {\n        return context.isBound(this.featureId);\n    }\n}\n/**\n * Checks wether the given service identifier is already bound in the given context\n * then either calls  the `bind` or `rebind` function respectively.\n *\n * As this is just a convenience function\n * ```ts\n * bindOrRebind({bind,isBound,rebind}, MyService).to(SomeOtherService);\n * ```\n * is equivalent to:\n * ```\n * if (isBound(MyService)) {\n *    rebind(MyService).to(SomeOtherService);\n * } else {\n *    bind(MyService).to(SomeOtherService);\n * }\n * ```\n * @param context The binding context\n * @param serviceIdentifier The service identifier\n * @returns The result of the `bind` or `rebind` function\n */\nexport function bindOrRebind<T>(\n    context: Omit<BindingContext, 'unbind'>,\n    serviceIdentifier: interfaces.ServiceIdentifier<T>\n): interfaces.BindingToSyntax<T> {\n    if (context.isBound(serviceIdentifier)) {\n        return context.rebind(serviceIdentifier);\n    }\n    return context.bind(serviceIdentifier);\n}\n\n/**\n * Only binds the given service identifier if it's not already bound in the given context.\n *\n * As this is just a convenience function\n * ```ts\n * lazyBind({bind,isBound}, MyService)?.to(SomeOtherService);\n * ```\n * is equivalent to:\n * ```\n * if (!isBound(MyService)) {\n *    bind(MyService).to(SomeOtherService);\n * }\n * ```\n * @param context The binding context\n * @param serviceIdentifier The service identifier\n * @returns The result of the `bind` function or `undefined` if the service was already bound\n */\nexport function lazyBind<T>(\n    context: Pick<BindingContext, 'bind' | 'isBound'>,\n    serviceIdentifier: interfaces.ServiceIdentifier<T>\n): interfaces.BindingToSyntax<T> | undefined {\n    if (context.isBound(serviceIdentifier)) {\n        return undefined;\n    }\n    return context.bind(serviceIdentifier);\n}\n\n/**\n * Binds the given service identifier to the given target service in the given context.\n * In addition, the target service is bound to itself in singleton scope. This ensures\n * that services can be rebound individually even if they are multi-injected.\n *\n * As this is just a convenience function\n * ```ts\n * bindAsService(bind,SomeOtherService,MyServiceImpl);\n * ```\n * is equivalent to:\n * ```ts\n * bind(MyServiceImpl).toSelf.inSingletonScope():\n * bind(SomeOtherService).toService(MyServiceImpl);\n * ```\n * @param serviceIdentifier\n * @param toServiceIdentifier\n */\nexport function bindAsService<S, T extends S>(\n    context: Pick<BindingContext, 'bind'> | interfaces.Bind,\n    serviceIdentifier: interfaces.ServiceIdentifier<S>,\n    targetService: interfaces.ServiceIdentifier<T>\n): void {\n    const bind = typeof context === 'object' ? context.bind.bind(context) : context;\n    bind(targetService).toSelf().inSingletonScope();\n    bind(serviceIdentifier).toService(targetService);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport * as jsonrpc from 'vscode-jsonrpc';\nimport { remove } from '../utils/array-util';\nimport { AnyObject, hasFunctionProp } from '../utils/type-util';\n\n/**\n * Interface for objects that can or need to be disposed properly.\n */\nexport interface Disposable extends jsonrpc.Disposable {\n    /**\n     * Dispose this object.\n     */\n    dispose(): void;\n}\n\nexport namespace Disposable {\n    export function is(value: unknown): value is Disposable {\n        return AnyObject.is(value) && hasFunctionProp(value, 'dispose');\n    }\n\n    /**\n     * Creates a new empty i.e. no-op {@link Disposable}.\n     * @returns the newly created disposable\n     */\n    export function empty(): Disposable {\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        return { dispose: () => {} };\n    }\n\n    /**\n     * Creates a new {@link Disposable} that delegates to the given callback.\n     * @param cb The callback that should be invoked on dispose\n     * @returns the newly created disposable\n     */\n    export function create(cb: () => void): Disposable {\n        return { dispose: cb };\n    }\n}\n\n/**\n * Reusable base class to manage a collection of {@link Disposable}s.\n */\nexport class DisposableCollection implements Disposable {\n    protected readonly disposables: Disposable[] = [];\n    errorHandler?: (err: unknown) => void;\n\n    constructor(...toDispose: Disposable[]) {\n        toDispose.forEach(d => this.push(d));\n        this.errorHandler = err => console.error(err);\n    }\n\n    dispose(): void {\n        if (this.disposed) {\n            return;\n        }\n        try {\n            while (!this.disposed) {\n                this.disposables.pop()?.dispose();\n            }\n        } catch (err) {\n            this.errorHandler?.(err);\n        }\n    }\n\n    get disposed(): boolean {\n        return this.disposables.length === 0;\n    }\n\n    /**\n     * Pushes the given disposables to the collection.\n     * @param disposables The disposables that should be added\n     * @returns A disposable that removes the previously pushed values from the collection when invoked\n     */\n    push(...disposables: Disposable[]): Disposable {\n        this.disposables.push(...disposables);\n        return Disposable.create(() => remove(this.disposables, ...disposables));\n    }\n\n    get isDisposed(): boolean {\n        return this.disposed;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n// Partial reexport of sprotty-protocol\nexport { Viewport } from 'sprotty-protocol/lib/model';\nexport * from 'sprotty-protocol/lib/utils/async';\nexport * from 'sprotty-protocol/lib/utils/geometry';\nexport * from 'sprotty-protocol/lib/utils/json';\nexport { applyBounds, cloneModel, findElement, getBasicType, getSubType } from 'sprotty-protocol/lib/utils/model-utils';\n// Default export of @eclipse-glsp/protocol\nexport * from './action-protocol';\nexport * from './client-server-protocol/base-glsp-client';\nexport * from './client-server-protocol/glsp-client';\nexport * from './client-server-protocol/glsp-server';\nexport * from './client-server-protocol/jsonrpc/base-jsonrpc-glsp-client';\nexport * from './client-server-protocol/jsonrpc/glsp-jsonrpc-client';\nexport * from './client-server-protocol/jsonrpc/glsp-jsonrpc-server';\nexport * from './client-server-protocol/jsonrpc/websocket-connection';\nexport * from './client-server-protocol/jsonrpc/ws-connection-provider';\nexport * from './client-server-protocol/types';\nexport * from './model/default-types';\nexport * from './model/model-schema';\nexport * from './sprotty-actions';\nexport * from './utils/array-util';\nexport * from './utils/di-util';\nexport * from './utils/disposable';\nexport * from './utils/event';\nexport * from './utils/type-util';\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Action, LabeledAction, Point } from '@eclipse-glsp/protocol';\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport {\n    SButtonImpl as GButton,\n    SModelElementImpl as GModelElement,\n    SModelRootImpl as GModelRoot,\n    ICommand,\n    IActionHandler as SIActionHandler,\n    IButtonHandler as SIButtonHandler,\n    ICommandPaletteActionProvider as SICommandPaletteActionProvider,\n    IContextMenuItemProvider as SIContextMenuItemProvider,\n    KeyListener as SKeyListener,\n    MouseListener as SMouseListener\n} from 'sprotty';\n\n/*\n * The GLSP-protocol comes with its own type definition for `Action`. However, sprotty\n * also has a separate `Action` definition that is heavily integrated into core API concepts.\n * While these two definitions are fully compatible it messes up IDE support for auto import\n * when implementing/overriding these API Concepts. To bypass this issue we create sub types\n * of the sprotty API concepts that use the Action definition from GLSP and export them instead.\n */\n\n/**\n * An action handler accepts an action and reacts to it by returning either a command to be\n * executed, or another action to be dispatched.\n */\nexport interface IActionHandler extends SIActionHandler {\n    handle(action: Action): ICommand | Action | void;\n}\n\nexport interface IButtonHandler extends SIButtonHandler {\n    buttonPressed(button: GButton): (Action | Promise<Action>)[];\n}\n\nexport interface ICommandPaletteActionProvider extends SICommandPaletteActionProvider {\n    getActions(root: Readonly<GModelRoot>, text: string, lastMousePosition?: Point, index?: number): Promise<LabeledAction[]>;\n}\n\nexport interface IContextMenuItemProvider extends SIContextMenuItemProvider {\n    getItems(root: Readonly<GModelRoot>, lastMousePosition?: Point): Promise<LabeledAction[]>;\n}\n\n@injectable()\nexport class KeyListener extends SKeyListener {\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        return [];\n    }\n\n    override keyUp(element: GModelElement, event: KeyboardEvent): Action[] {\n        return [];\n    }\n}\n\n@injectable()\nexport class MouseListener extends SMouseListener {\n    override mouseOver(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override mouseOut(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override mouseEnter(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override mouseLeave(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override mouseDown(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override mouseMove(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override mouseUp(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override wheel(target: GModelElement, event: WheelEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override doubleClick(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override contextMenu(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override dragOver(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override drop(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return [];\n    }\n\n    override decorate(vnode: VNode, element: GModelElement): VNode {\n        return vnode;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { TYPES as SprottyTYPES } from 'sprotty';\n/**\n * Reexport of the TYPES namespace of sprotty augments with additional GLSP specific service\n * identifiers.\n *\n */\nexport const TYPES = {\n    ...SprottyTYPES,\n    IAsyncClipboardService: Symbol('IAsyncClipboardService'),\n    IEditorContextServiceProvider: Symbol('IEditorContextProvider'),\n    IFeedbackActionDispatcher: Symbol('IFeedbackActionDispatcher'),\n    IToolFactory: Symbol('Factory<Tool>'),\n    ITypeHintProvider: Symbol('ITypeHintProvider'),\n    IMovementRestrictor: Symbol('IMovementRestrictor'),\n    ISelectionListener: Symbol('ISelectionListener'),\n    ISModelRootListener: Symbol('ISModelRootListener'),\n    IContextMenuProvider: Symbol('IContextMenuProvider'),\n    ICopyPasteHandler: Symbol('ICopyPasteHandler'),\n    ITool: Symbol('ITool'),\n    IDefaultTool: Symbol('IDefaultTool'),\n    IEditModeListener: Symbol('IEditModeListener'),\n    IMarqueeBehavior: Symbol('IMarqueeBehavior'),\n    IElementNavigator: Symbol('IElementNavigator'),\n    ILocalElementNavigator: Symbol('ILocalElementNavigator'),\n    IDiagramOptions: Symbol('IDiagramOptions'),\n    IDiagramStartup: Symbol('IDiagramStartup'),\n    IToolManager: Symbol('IToolManager')\n};\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n/* eslint-disable no-restricted-imports */\n\nimport { FeatureModule } from '@eclipse-glsp/protocol';\nimport sprottyButtonModule from 'sprotty/lib/features/button/di.config';\nimport sprottyEdgeIntersectionModule from 'sprotty/lib/features/edge-intersection/di.config';\nimport sprottyEdgeLayoutModule from 'sprotty/lib/features/edge-layout/di.config';\nimport {\n    edgeEditModule as sprottyEdgeEditModule,\n    labelEditUiModule as sprottyLabelEditUiModule\n} from 'sprotty/lib/features/edit/di.config';\nimport sprottyExpandModule from 'sprotty/lib/features/expand/di.config';\nimport sprottyFadeModule from 'sprotty/lib/features/fade/di.config';\nimport sprottyMoveModule from 'sprotty/lib/features/move/di.config';\nimport sprottyUpdateModule from 'sprotty/lib/features/update/di.config';\nimport sprottyZorderModule from 'sprotty/lib/features/zorder/di.config';\nimport sprottyModelSourceModule from 'sprotty/lib/model-source/di.config';\nimport sprottyDefaultModule from 'sprotty/lib/base/di.config';\nimport sprottyOpenModule from 'sprotty/lib/features/open/di.config';\n\nexport const buttonModule = new FeatureModule(sprottyButtonModule.registry);\nexport const edgeEditModule = new FeatureModule(sprottyEdgeEditModule.registry);\nexport const edgeIntersectionModule = new FeatureModule(sprottyEdgeIntersectionModule.registry);\nexport const edgeLayoutModule = new FeatureModule(sprottyEdgeLayoutModule.registry);\nexport const expandModule = new FeatureModule(sprottyExpandModule.registry);\nexport const fadeModule = new FeatureModule(sprottyFadeModule.registry);\nexport const labelEditUiModule = new FeatureModule(sprottyLabelEditUiModule.registry);\nexport const modelSourceModule = new FeatureModule(sprottyModelSourceModule.registry);\nexport const moveModule = new FeatureModule(sprottyMoveModule.registry);\nexport const openModule = new FeatureModule(sprottyOpenModule.registry);\nexport const updateModule = new FeatureModule(sprottyUpdateModule.registry);\nexport const zorderModule = new FeatureModule(sprottyZorderModule.registry);\n\nexport { sprottyDefaultModule };\n", "/********************************************************************************\n * Copyright (c) 2022-2023 STMicroelectronics  and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/**\n * Selective custom reexport of the sprotty API. Also provides augmentations/adaptions\n * of certain type definitions for GLSP. Using this custom reexport allows us to gracefully\n * update to newer sprotty versions without hard API breaks.\n */\n\n/**\n * @eclipse-glsp/protocol\n */\nexport * from '@eclipse-glsp/protocol';\n\nexport * from './action-override';\n\n/*\n * sprotty\n */\n// ------------------ Base ------------------\n\n// Exclude  definition for labeled actions\n// export * from 'sprotty/lib/base/actions/action';\nexport * from 'sprotty/lib/base/actions/action-dispatcher';\nexport {\n    ActionHandlerRegistration,\n    ActionHandlerRegistry,\n    IActionHandlerInitializer,\n    configureActionHandler,\n    onAction\n} from 'sprotty/lib/base/actions/action-handler';\nexport * from 'sprotty/lib/base/actions/diagram-locker';\n\nexport * from 'sprotty/lib/base/animations/animation';\nexport * from 'sprotty/lib/base/animations/animation-frame-syncer';\nexport * from 'sprotty/lib/base/animations/easing';\n\nexport * from 'sprotty/lib/base/commands/command';\nexport * from 'sprotty/lib/base/commands/command-registration';\nexport * from 'sprotty/lib/base/commands/command-stack';\nexport * from 'sprotty/lib/base/commands/command-stack-options';\n\nexport * from 'sprotty/lib/base/features/initialize-canvas';\nexport * from 'sprotty/lib/base/features/set-model';\n// Exclude SModelElementImpl as it as exported with augmentation module\nexport {\n    FeatureSet,\n    SChildElementImpl as GChildElement,\n    SModelElementImpl as GModelElement,\n    SModelRootImpl as GModelRoot,\n    SParentElementImpl as GParentElement,\n    IModelIndex,\n    ModelIndexImpl,\n    createRandomId,\n    isParent\n} from 'sprotty/lib/base/model/smodel';\n\nexport {\n    CustomFeatures,\n    EMPTY_ROOT,\n    SModelElementConstructor as GModelElementConstructor,\n    SModelElementRegistration as GModelElementRegistration,\n    SModelFactory as GModelFactory,\n    IModelFactory,\n    // exported without alias we extend it in glsp-client to `GModelRegistry`\n    SModelRegistry,\n    createFeatureSet\n} from 'sprotty/lib/base/model/smodel-factory';\nexport * from 'sprotty/lib/base/model/smodel-utils';\n\nexport * from 'sprotty/lib/base/ui-extensions/ui-extension';\nexport * from 'sprotty/lib/base/ui-extensions/ui-extension-registry';\n\nexport * from 'sprotty/lib/base/views/dom-helper';\nexport { KeyTool } from 'sprotty/lib/base/views/key-tool';\nexport { MouseEventKind, MousePositionTracker, MouseTool, PopupMouseTool } from 'sprotty/lib/base/views/mouse-tool';\nexport * from 'sprotty/lib/base/views/thunk-view';\nexport * from 'sprotty/lib/base/views/view';\nexport * from 'sprotty/lib/base/views/viewer';\nexport * from 'sprotty/lib/base/views/viewer-cache';\nexport * from 'sprotty/lib/base/views/viewer-options';\nexport * from 'sprotty/lib/base/views/vnode-postprocessor';\nexport * from 'sprotty/lib/base/views/vnode-utils';\n\n// Exclude sprotty types and export augmented GLSP types instead\n// export * from 'sprotty/lib/base/types';\nexport * from './types';\n\n// ------------------ Features ------------------\nexport * from 'sprotty/lib/features/bounds/abstract-layout';\nexport * from 'sprotty/lib/features/bounds/bounds-manipulation';\nexport * from 'sprotty/lib/features/bounds/hbox-layout';\nexport * from 'sprotty/lib/features/bounds/hidden-bounds-updater';\nexport * from 'sprotty/lib/features/bounds/layout';\nexport * from 'sprotty/lib/features/bounds/layout-options';\nexport {\n    Alignable,\n    BoundsAware,\n    SShapeElementImpl as GShapeElement,\n    LayoutContainer,\n    LayoutableChild,\n    ModelLayoutOptions,\n    boundsFeature,\n    findChildrenAtPosition,\n    getAbsoluteBounds,\n    getAbsoluteClientBounds,\n    isAlignable,\n    isBoundsAware,\n    isLayoutContainer,\n    isLayoutableChild,\n    isSizeable,\n    layoutContainerFeature,\n    layoutableChildFeature\n} from 'sprotty/lib/features/bounds/model';\n// exclude stack layout as its not supported in GLSP\n// export * from 'sprotty/lib/features/bounds/stack-layout';\nexport * from 'sprotty/lib/features/bounds/vbox-layout';\nexport * from 'sprotty/lib/features/bounds/views';\n\nexport { ButtonHandlerRegistry, IButtonHandlerRegistration, configureButtonHandler } from 'sprotty/lib/features/button/button-handler';\nexport { SButtonImpl as GButton, SButtonSchema as GButtonSchema } from 'sprotty/lib/features/button/model';\n\nexport {\n    CommandPaletteActionProviderRegistry,\n    RevealNamedElementActionProvider\n} from 'sprotty/lib/features/command-palette/action-providers';\nexport * from 'sprotty/lib/features/command-palette/command-palette';\n\n// Exclude menu item. Aready provided by glsp-protocol\nexport { Anchor, IContextMenuService, IContextMenuServiceProvider } from 'sprotty/lib/features/context-menu/context-menu-service';\nexport { ContextMenuProviderRegistry, DeleteContextMenuItemProvider } from 'sprotty/lib/features/context-menu/menu-providers';\nexport * from 'sprotty/lib/features/context-menu/mouse-listener';\n\nexport * from 'sprotty/lib/features/edge-layout/di.config';\nexport * from 'sprotty/lib/features/edge-layout/edge-layout';\nexport * from 'sprotty/lib/features/edge-layout/model';\n// Exclude client-side creation features (not supported in GLSP)\n// export * from 'sprotty/lib/features/edit/create';\n// export * from 'sprotty/lib/features/edit/create-on-drag';\nexport * from 'sprotty/lib/features/edit/delete';\nexport * from 'sprotty/lib/features/edit/edit-label';\nexport * from 'sprotty/lib/features/edit/edit-label-ui';\nexport * from 'sprotty/lib/features/edit/edit-routing';\nexport * from 'sprotty/lib/features/edit/model';\n// export * from 'sprotty/lib/features/edit/reconnect';\n\nexport * from 'sprotty/lib/features/expand/expand';\nexport * from 'sprotty/lib/features/expand/model';\nexport * from 'sprotty/lib/features/expand/views';\n// Exclude RequestExportSvgAction. Already provided by glsp-protocol\nexport { ExportSvgCommand, ExportSvgKeyListener, ExportSvgPostprocessor } from 'sprotty/lib/features/export/export';\nexport * from 'sprotty/lib/features/export/model';\n// Exclude ExportSvgAction. Already provided by glsp-protocol\nexport { SvgExporter } from 'sprotty/lib/features/export/svg-exporter';\n\nexport * from 'sprotty/lib/features/fade/fade';\nexport * from 'sprotty/lib/features/fade/model';\n\nexport * from 'sprotty/lib/features/hover/hover';\nexport * from 'sprotty/lib/features/hover/model';\nexport * from 'sprotty/lib/features/hover/popup-position-updater';\n\n// Alias SModel types\nexport * from 'sprotty/lib/features/decoration/decoration-placer';\nexport {\n    Decoration,\n    SDecoration as GDecoration,\n    SIssue as GIssue,\n    SIssueSeverity as GIssueSeverity,\n    // Export as is, we extend it glsp-client to `GIssueMarker`\n    SIssueMarker\n} from 'sprotty/lib/features/decoration/model';\nexport * from 'sprotty/lib/features/decoration/views';\n\nexport * from 'sprotty/lib/features/edge-intersection/intersection-finder';\nexport * from 'sprotty/lib/features/edge-intersection/sweepline';\n\nexport * from 'sprotty/lib/features/move/model';\nexport * from 'sprotty/lib/features/move/move';\nexport * from 'sprotty/lib/features/move/snap';\n\nexport * from 'sprotty/lib/features/nameable/model';\n\nexport * from 'sprotty/lib/features/open/model';\nexport * from 'sprotty/lib/features/open/open';\n\nexport * from 'sprotty/lib/features/projection/model';\nexport * from 'sprotty/lib/features/projection/views';\n\nexport * from 'sprotty/lib/features/routing/abstract-edge-router';\nexport * from 'sprotty/lib/features/routing/anchor';\nexport * from 'sprotty/lib/features/routing/bezier-anchors';\nexport * from 'sprotty/lib/features/routing/bezier-edge-router';\nexport * from 'sprotty/lib/features/routing/manhattan-anchors';\nexport * from 'sprotty/lib/features/routing/manhattan-edge-router';\n// Alias SModel types\nexport {\n    Connectable,\n    SConnectableElementImpl as GConnectableElement,\n    SDanglingAnchorImpl as GDanglingAnchor,\n    SRoutableElementImpl as GRoutableElement,\n    SRoutingHandleImpl as GRoutingHandle,\n    RoutingHandleKind,\n    connectableFeature,\n    edgeInProgressID,\n    edgeInProgressTargetHandleID,\n    getAbsoluteRouteBounds,\n    getRouteBounds,\n    isConnectable\n} from 'sprotty/lib/features/routing/model';\nexport * from 'sprotty/lib/features/routing/polyline-anchors';\nexport * from 'sprotty/lib/features/routing/polyline-edge-router';\nexport * from 'sprotty/lib/features/routing/routing';\nexport * from 'sprotty/lib/features/routing/views';\n\nexport * from 'sprotty/lib/features/select/model';\n// Alias Select commands with sprotty prefix to avoid clash with glsp-client\nexport {\n    GetSelectionCommand,\n    SelectKeyboardListener,\n    SelectMouseListener,\n    SelectAllCommand as SprottySelectAllCommand,\n    SelectCommand as SprottySelectCommand\n} from 'sprotty/lib/features/select/select';\n\n// Exclude undo-redo as the client provides its own implementation\n// export * from 'sprotty/lib/features/undo-redo/undo-redo';\n\nexport * from 'sprotty/lib/features/update/model-matching';\nexport * from 'sprotty/lib/features/update/update-model';\n\nexport * from 'sprotty/lib/features/viewport/center-fit';\nexport * from 'sprotty/lib/features/viewport/model';\nexport * from 'sprotty/lib/features/viewport/scroll';\n// Alias SModel types\nexport * from 'sprotty/lib/features/viewport/viewport';\nexport { ViewportRootElementImpl as GViewportRootElement } from 'sprotty/lib/features/viewport/viewport-root';\nexport * from 'sprotty/lib/features/viewport/zoom';\n\nexport * from 'sprotty/lib/features/zorder/zorder';\n\n// ------------------ Graph ------------------\n// Alias SModel types\nexport {\n    SCompartmentImpl as GCompartment,\n    SGraphIndex as GGraphIndex,\n    SLabelImpl as GLabel,\n    SNodeImpl as GNode,\n    SPortImpl as GPort,\n    // Exported as is, we extend it in glsp-client to GEdge\n    SEdgeImpl,\n    // Exported as is, we extend it in glsp-client to GGraph\n    SGraphImpl\n} from 'sprotty/lib/graph/sgraph';\n// Alias SModel types\nexport {\n    BezierCurveEdgeView,\n    SBezierControlHandleView as GBezierControlHandleView,\n    SBezierCreateHandleView as GBezierCreateHandleView,\n    SCompartmentView as GCompartmentView,\n    SGraphView as GGraphView,\n    SLabelView as GLabelView,\n    SRoutingHandleView as GRoutingHandleView,\n    JumpingPolylineEdgeView,\n    PolylineEdgeView,\n    PolylineEdgeViewWithGapsOnIntersections\n} from 'sprotty/lib/graph/views';\n\nexport * from './feature-modules';\n\n// ------------------ Library ------------------\n\nexport * from 'sprotty/lib/lib/generic-views';\nexport * from 'sprotty/lib/lib/html-views';\nexport * from 'sprotty/lib/lib/jsx';\n// Alias SModel types\nexport {\n    CircularNode,\n    CircularPort,\n    DiamondNode,\n    ForeignObjectElementImpl as GForeignObjectElement,\n    HtmlRootImpl as GHtmlRoot,\n    PreRenderedElementImpl as GPreRenderedElement,\n    ShapedPreRenderedElementImpl as GShapedPreRenderedElement,\n    RectangularNode,\n    RectangularPort\n} from 'sprotty/lib/lib/model';\nexport * from 'sprotty/lib/lib/modules';\nexport * from 'sprotty/lib/lib/svg-views';\n\n// ------------------ Model Source ------------------\nexport * from 'sprotty/lib/model-source/commit-model';\n// Exclude as not supported in GLSP\n// export * from 'sprotty/lib/model-source/diagram-server';\n// export * from 'sprotty/lib/model-source/local-model-source';\nexport * from 'sprotty/lib/model-source/logging';\nexport * from 'sprotty/lib/model-source/model-source';\n// export * from 'sprotty/lib/model-source/websocket';\n\n// ------------------ Utilities ------------------\nexport * from 'sprotty/lib/utils/browser';\nexport * from 'sprotty/lib/utils/codicon';\nexport * from 'sprotty/lib/utils/color';\nexport * from 'sprotty/lib/utils/geometry';\nexport * from 'sprotty/lib/utils/inversify';\nexport * from 'sprotty/lib/utils/iterable';\nexport * from 'sprotty/lib/utils/keyboard';\nexport * from 'sprotty/lib/utils/logging';\nexport * from 'sprotty/lib/utils/registry';\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport {\n    Action,\n    Deferred,\n    Disposable,\n    Emitter,\n    InitializeCanvasBoundsAction,\n    SetModelAction,\n    UpdateModelAction\n} from '@eclipse-glsp/sprotty';\n\n/**\n * The constraint defining when the initialization of the GLSP model is completed.\n *\n * Many actions, such as the `CenterAction`, can only be successfully processed if\n * the GLSP model initialization is completed, that is, the model has been set,\n * its bounds have been computed, the canvas bounds are available, etc.\n *\n * An injectable implementation of this constraint will be used by the\n * `GLSPActionDispatcher` to determine when the initialization is completed.\n * The action dispatcher therefore provides a promise via `onceInitialized()`\n * to trigger clients that want to dispatch an action, once the initialization\n * is done.\n *\n * For most of the cases `DefaultInitializationConstraint` can be used. In fact,\n * it is bound by default. However, custom implementations can rebind other\n * implementations of this constraint to, for instance, delay further before the\n * `onceInitialized()` promise is fulfilled by the `GLSPActionDispatcher`.\n */\n@injectable()\nexport abstract class ModelInitializationConstraint {\n    protected completion: Deferred<void> = new Deferred();\n\n    protected _isCompleted = false;\n    get isCompleted(): boolean {\n        return this._isCompleted;\n    }\n\n    protected onInitializedEmitter = new Emitter<void>();\n\n    /**\n     * Register a listener that will be invoked once the initialization process\n     * has been completed. If the initialization is already completed on registration\n     * the given listener will be invoked right away\n     * @param listener\n     */\n    onInitialized(listener: () => void): Disposable;\n\n    /**\n     * Retrieve a promise that resolves once the initialization process\n     * has been completed.\n     * @returns the initialization promise\n     */\n    onInitialized(): Promise<void>;\n    onInitialized(listener?: () => void): Promise<void> | Disposable {\n        if (!listener) {\n            return this.completion.promise;\n        }\n        if (this.isCompleted) {\n            listener();\n            return Disposable.empty();\n        }\n        return this.onInitializedEmitter.event(listener);\n    }\n\n    protected setCompleted(): void {\n        if (!this.isCompleted) {\n            this._isCompleted = true;\n            this.completion.resolve();\n            this.onInitializedEmitter.fire();\n            this.onInitializedEmitter.dispose();\n        }\n    }\n\n    notifyDispatched(action: Action): void {\n        if (this.isCompleted) {\n            return;\n        }\n        if (this.isInitializedAfter(action)) {\n            this.setCompleted();\n        }\n    }\n\n    /**\n     * Central method to check the initialization state. Is invoked\n     * for every action dispatched by the `ActionDispatcher` (until the initialization has completed).\n     *  Should\n     * return `true` once the action has been passed which marks the end\n     * of the initialization process.\n     * @param action The last dispatched action\n     */\n    abstract isInitializedAfter(action: Action): boolean;\n}\n\n/**\n * Default initialization constraint triggers after a non-empty `UpdateModelAction`\n * and a subsequent `InitializeCanvasBoundsAction`.\n */\n@injectable()\nexport class DefaultModelInitializationConstraint extends ModelInitializationConstraint {\n    protected seenNonEmptyModelAction = false;\n\n    isInitializedAfter(action: Action): boolean {\n        if (this.isNonEmptyModelAction(action)) {\n            this.seenNonEmptyModelAction = true;\n        } else if (this.seenNonEmptyModelAction && action.kind === InitializeCanvasBoundsAction.KIND) {\n            return true;\n        }\n        return false;\n    }\n\n    protected isNonEmptyModelAction(action: Action): boolean {\n        if (SetModelAction.is(action) || UpdateModelAction.is(action)) {\n            return action.newRoot.type !== 'NONE';\n        }\n        return false;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { Action, ActionDispatcher, RequestAction, ResponseAction } from '@eclipse-glsp/sprotty';\nimport { ModelInitializationConstraint } from './model/model-initialization-constraint';\n\n@injectable()\nexport class GLSPActionDispatcher extends ActionDispatcher {\n    protected readonly timeouts: Map<string, NodeJS.Timeout> = new Map();\n    protected initializedConstraint = false;\n\n    @inject(ModelInitializationConstraint)\n    protected initializationConstraint: ModelInitializationConstraint;\n\n    override initialize(): Promise<void> {\n        return super.initialize().then(() => this.startModelInitialization());\n    }\n\n    startModelInitialization(): void {\n        if (!this.initializedConstraint) {\n            this.logger.log(this, 'Starting model initialization mode');\n            this.initializationConstraint.onInitialized(() => this.logger.log(this, 'Model initialization completed'));\n            this.initializedConstraint = true;\n        }\n    }\n\n    onceModelInitialized(): Promise<void> {\n        return this.initializationConstraint.onInitialized();\n    }\n\n    hasHandler(action: Action): boolean {\n        return this.actionHandlerRegistry.get(action.kind).length > 0;\n    }\n\n    /**\n     * Processes all given actions, by dispatching them to the corresponding handlers, after the model initialization is completed.\n     *\n     * @param actions The actions that should be dispatched after the model initialization\n     */\n    dispatchOnceModelInitialized(...actions: Action[]): void {\n        this.initializationConstraint.onInitialized(() => this.dispatchAll(actions));\n    }\n\n    override async dispatch(action: Action): Promise<void> {\n        const result = await super.dispatch(action);\n        this.initializationConstraint.notifyDispatched(action);\n        return result;\n    }\n\n    protected override handleAction(action: Action): Promise<void> {\n        if (ResponseAction.hasValidResponseId(action)) {\n            // clear timeout\n            const timeout = this.timeouts.get(action.responseId);\n            if (timeout !== undefined) {\n                clearTimeout(timeout);\n                this.timeouts.delete(action.responseId);\n            }\n\n            // Check if we have a pending request for the response.\n            // If not the  we clear the responseId => action will be dispatched normally\n            const deferred = this.requests.get(action.responseId);\n            if (deferred === undefined) {\n                action.responseId = '';\n            }\n        }\n        return super.handleAction(action);\n    }\n\n    override request<Res extends ResponseAction>(action: RequestAction<Res>): Promise<Res> {\n        if (!action.requestId && action.requestId === '') {\n            // No request id has been specified. So we use a generated one.\n            action.requestId = RequestAction.generateRequestId();\n        }\n        return super.request(action);\n    }\n\n    /**\n     * Dispatch a request and waits for a response until the timeout given in `timeoutMs` has\n     * been reached. The returned promise is resolved when a response with matching identifier\n     * is dispatched or when the timeout has been reached. That response is _not_ passed to the\n     * registered action handlers. Instead, it is the responsibility of the caller of this method\n     * to handle the response properly. For example, it can be sent to the registered handlers by\n     * passing it again to the `dispatch` method.\n     * If `rejectOnTimeout` is set to false (default) the returned promise will be resolved with\n     * no value, otherwise it will be rejected.\n     */\n    requestUntil<Res extends ResponseAction>(\n        action: RequestAction<Res>,\n        timeoutMs = 2000,\n        rejectOnTimeout = false\n    ): Promise<Res | undefined> {\n        if (!action.requestId && action.requestId === '') {\n            // No request id has been specified. So we use a generated one.\n            action.requestId = RequestAction.generateRequestId();\n        }\n\n        const requestId = action.requestId;\n        const timeout = setTimeout(() => {\n            const deferred = this.requests.get(requestId);\n            if (deferred !== undefined) {\n                // cleanup\n                clearTimeout(timeout);\n                this.requests.delete(requestId);\n\n                const notification = 'Request ' + requestId + ' (' + action + ') time out after ' + timeoutMs + 'ms.';\n                if (rejectOnTimeout) {\n                    deferred.reject(notification);\n                } else {\n                    this.logger.info(this, notification);\n                    deferred.resolve();\n                }\n            }\n        }, timeoutMs);\n        this.timeouts.set(requestId, timeout);\n\n        return super.request<Res>(action);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { ActionHandlerRegistry } from '@eclipse-glsp/sprotty';\n\n@injectable()\nexport class GLSPActionHandlerRegistry extends ActionHandlerRegistry {\n    /**\n     * Retrieve a set of all action kinds for which (at least) one\n     * handler is registered\n     * @returns the set of handled action kinds\n     */\n    getHandledActionKinds(): string[] {\n        return Array.from(this.elements.keys());\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Args, GModelElement } from '@eclipse-glsp/sprotty';\n\nexport const argsFeature = Symbol('argsFeature');\n\n/**\n * Adds an optional `args` property to a {@link GModelElement}. This allows\n * to add arbitrary arguments to the element (on client or server side) without having\n * to extend the model class.\n *\n * Feature extension interface for {@link argsFeature}.\n */\nexport interface ArgsAware {\n    args?: Args;\n}\n\nexport function isArgsAware(element: GModelElement): element is GModelElement & ArgsAware {\n    return element.hasFeature(argsFeature);\n}\n\nexport function hasArgs(element?: GModelElement): element is GModelElement & Required<ArgsAware> {\n    return element !== undefined && isArgsAware(element) && element.args !== undefined;\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { hasStringProp, LabeledAction } from '@eclipse-glsp/sprotty';\n\n/** A special {@link LabeledAction} that has a `text` property in addition to the `label  */\nexport interface AutoCompleteValue extends LabeledAction {\n    readonly text: string;\n}\n\nexport namespace AutoCompleteValue {\n    export function is(object: any): object is AutoCompleteValue {\n        return LabeledAction.is(object) && hasStringProp(object, 'text');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { ValidationStatus, codiconCSSString } from '@eclipse-glsp/sprotty';\n\nexport interface IValidationDecorator {\n    decorateValidationResult(status: ValidationStatus): void;\n    isValidatedOk(): boolean;\n    invalidate(): void;\n    dispose(): void;\n}\n\nexport namespace IValidationDecorator {\n    export const NO_DECORATION: IValidationDecorator = {\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        decorateValidationResult(_status: ValidationStatus) {},\n        isValidatedOk(): boolean {\n            return false;\n        },\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        invalidate() {},\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        dispose() {}\n    };\n}\n\nexport class ValidationDecorator implements IValidationDecorator {\n    warningClasses = ['warning'];\n    warningIconClasses = codiconCSSString('warning');\n    errorClasses = ['error'];\n    errorIconClasses = codiconCSSString('error');\n\n    isValidated = false;\n    hasValidationError = false;\n\n    protected decorationDiv?: HTMLDivElement;\n\n    constructor(protected containerElement: HTMLElement) {}\n\n    decorateValidationResult(status: ValidationStatus): void {\n        if (ValidationStatus.isError(status)) {\n            this.hasValidationError = true;\n            this.decorateError(status.message ? status.message : 'Error');\n        } else if (ValidationStatus.isWarning(status)) {\n            this.hasValidationError = false;\n            this.decorateWarning(status.message ? status.message : 'Warning');\n        } else {\n            this.hasValidationError = false;\n            this.dispose();\n        }\n        this.isValidated = true;\n    }\n\n    protected decorateError(message: string): void {\n        this.switchCssClasses(this.containerElement, this.errorClasses);\n        const div = this.createDecorationDiv();\n        this.switchCssClasses(div, this.errorClasses);\n        div.innerHTML = `<span class=\"${this.errorIconClasses}\"></span> ${message}`;\n        this.adjustPosition();\n    }\n\n    protected decorateWarning(message: string): void {\n        this.switchCssClasses(this.containerElement, this.warningClasses);\n        const div = this.createDecorationDiv();\n        this.switchCssClasses(div, this.warningClasses);\n        div.innerHTML = `<span class=\"${this.warningIconClasses}\"></span> ${message}`;\n        this.adjustPosition();\n    }\n\n    protected switchCssClasses(element: HTMLElement, cssClasses: string[]): void {\n        element.classList.remove(...this.errorClasses, ...this.warningClasses);\n        element.classList.add(...cssClasses);\n    }\n\n    protected createDecorationDiv(): HTMLDivElement {\n        if (!this.decorationDiv) {\n            this.containerElement.classList.add('validation');\n            this.decorationDiv = document.createElement('div');\n            this.decorationDiv.style.width = `${this.decorationContainerWidth()}px`;\n            this.decorationDiv.classList.add('validation-decorator');\n            this.containerElement.appendChild(this.decorationDiv);\n        }\n        return this.decorationDiv;\n    }\n\n    protected decorationContainerWidth(): number {\n        return this.containerElement.clientWidth - 5;\n    }\n\n    protected adjustPosition(): void {\n        if (this.decorationDiv) {\n            const height = this.decorationDiv.clientHeight + 2;\n            this.decorationDiv.style.top = `-${height}px`;\n        }\n    }\n\n    isValidatedOk(): boolean {\n        return this.isValidated && !this.hasValidationError;\n    }\n\n    invalidate(): void {\n        this.isValidated = false;\n    }\n\n    dispose(): void {\n        this.hasValidationError = false;\n        this.isValidated = false;\n        if (this.decorationDiv && this.containerElement && this.containerElement.contains(this.decorationDiv)) {\n            this.containerElement.removeChild(this.decorationDiv);\n            this.switchCssClasses(this.containerElement, []);\n            this.decorationDiv = undefined;\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { AutocompleteResult, AutocompleteSettings } from 'autocompleter';\nimport {\n    Action,\n    ILogger,\n    LabeledAction,\n    GModelRoot,\n    ValidationStatus,\n    codiconCSSClasses,\n    matchesKeystroke,\n    toArray\n} from '@eclipse-glsp/sprotty';\nimport { AutoCompleteValue } from './auto-complete-actions';\nimport { IValidationDecorator } from './validation-decorator';\n\nexport interface AutoCompleteSettings {\n    readonly noSuggestionsMessage?: string;\n    readonly suggestionsClass?: string;\n    readonly debounceWaitMs?: number;\n    readonly showOnFocus?: boolean;\n}\n\nexport type CloseReason = 'submission' | 'blur' | 'escape';\nexport interface InputValidator {\n    validate(input: string): Promise<ValidationStatus>;\n}\n\nexport interface SuggestionProvider {\n    provideSuggestions(input: string): Promise<LabeledAction[]>;\n}\n\nexport interface InputValueInitializer {\n    initializeValue(containerElement: HTMLElement, root: Readonly<GModelRoot>, ...contextElementIds: string[]): string;\n}\n\nexport interface SuggestionSubmitHandler {\n    executeFromSuggestion(input: LabeledAction | Action | Action[]): void;\n}\n\nexport interface TextSubmitHandler {\n    executeFromTextOnlyInput(input: string): void;\n}\n\nexport interface AutoCompleteWidgetOptions {\n    visibleSuggestionsChanged?: (suggestions: LabeledAction[]) => void;\n    selectedSuggestionChanged?: (suggestion?: LabeledAction) => void;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst configureAutocomplete: (settings: AutocompleteSettings<LabeledAction>) => AutocompleteResult = require('autocompleter');\n\n/**\n * The `AutoCompleteWidget` is a reusable UI element that provides a text input supporting auto-completion,\n * validation, validation messages, etc.\n *\n * An example for using it is available in the workflow diagram:\n * https://github.com/eclipse-glsp/glsp-client/blob/master/examples/workflow-glsp/src/direct-task-editing/direct-task-editor.ts\n */\nexport class AutoCompleteWidget {\n    loadingIndicatorClasses = codiconCSSClasses('loading', false, true, ['loading']);\n\n    protected containerElement: HTMLElement;\n    protected inputElement: HTMLInputElement;\n    protected loadingIndicator: HTMLSpanElement;\n    protected autoCompleteResult: AutocompleteResult;\n    protected contextActions?: LabeledAction[];\n    protected previousContent?: string;\n\n    protected inputValidator?: InputValidator;\n    protected validationDecorator: IValidationDecorator = IValidationDecorator.NO_DECORATION;\n\n    protected textSubmitHandler?: TextSubmitHandler;\n\n    constructor(\n        public autoSuggestionSettings: AutoCompleteSettings,\n        public suggestionProvider: SuggestionProvider,\n        public suggestionSubmitHandler: SuggestionSubmitHandler,\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        protected notifyClose: (reason: CloseReason) => void = () => {},\n        protected logger?: ILogger,\n        protected options?: AutoCompleteWidgetOptions\n    ) {}\n\n    configureValidation(\n        inputValidator: InputValidator,\n        validationDecorator: IValidationDecorator = IValidationDecorator.NO_DECORATION\n    ): void {\n        this.inputValidator = inputValidator;\n        this.validationDecorator = validationDecorator;\n    }\n\n    configureTextSubmitHandler(textSubmitHandler: TextSubmitHandler): void {\n        this.textSubmitHandler = textSubmitHandler;\n    }\n\n    initialize(containerElement: HTMLElement): void {\n        this.containerElement = containerElement;\n        this.inputElement = this.createInputElement();\n        this.containerElement.appendChild(this.inputElement);\n        this.containerElement.style.position = 'absolute';\n    }\n\n    protected createInputElement(): HTMLInputElement {\n        const inputElement = document.createElement('input');\n        inputElement.style.position = 'absolute';\n        inputElement.spellcheck = false;\n        inputElement.autocapitalize = 'false';\n        inputElement.autocomplete = 'off';\n        inputElement.style.width = '100%';\n        inputElement.addEventListener('keydown', event => this.handleKeyDown(event));\n        inputElement.addEventListener('blur', () => {\n            if (this.containerElement.style.visibility !== 'hidden') {\n                window.setTimeout(() => this.notifyClose('blur'), 200);\n            }\n        });\n\n        return inputElement;\n    }\n\n    protected handleKeyDown(event: KeyboardEvent): void {\n        if (matchesKeystroke(event, 'Escape')) {\n            this.notifyClose('escape');\n            return;\n        }\n        if (matchesKeystroke(event, 'Enter') && !this.isInputElementChanged() && this.isSuggestionAvailable()) {\n            return;\n        }\n        if (this.isInputElementChanged()) {\n            this.invalidateValidationResultAndContextActions();\n        }\n        if (!matchesKeystroke(event, 'Enter') || this.isSuggestionAvailable()) {\n            return;\n        }\n        if (!this.validationDecorator.isValidatedOk()) {\n            event.stopImmediatePropagation();\n            return;\n        }\n        if (this.textSubmitHandler) {\n            this.executeFromTextOnlyInput();\n            this.notifyClose('submission');\n        }\n    }\n\n    protected isInputElementChanged(): boolean {\n        return this.inputElement.value !== this.previousContent;\n    }\n\n    protected invalidateValidationResultAndContextActions(): void {\n        this.contextActions = undefined;\n        this.validationDecorator.invalidate();\n    }\n\n    open(root: Readonly<GModelRoot>, ...contextElementIds: string[]): void {\n        this.contextActions = undefined;\n        this.autoCompleteResult = configureAutocomplete(this.autocompleteSettings(root));\n        this.previousContent = this.inputElement.value;\n        this.inputElement.setSelectionRange(0, this.inputElement.value.length);\n        this.inputElement.focus();\n    }\n\n    protected autocompleteSettings(root: Readonly<GModelRoot>): AutocompleteSettings<LabeledAction> {\n        return {\n            input: this.inputElement,\n            emptyMsg: this.autoSuggestionSettings.noSuggestionsMessage,\n            className: this.autoSuggestionSettings.suggestionsClass,\n            showOnFocus: this.autoSuggestionSettings.showOnFocus,\n            debounceWaitMs: this.autoSuggestionSettings.debounceWaitMs,\n            minLength: -1,\n            fetch: (text: string, update: (items: LabeledAction[]) => void) => this.updateSuggestions(update, text, root),\n            onSelect: (item: LabeledAction) => this.onSelect(item),\n            render: (item: LabeledAction, currentValue: string): HTMLDivElement | undefined => this.renderSuggestions(item, currentValue),\n            customize: (input, inputRect, container, maxHeight) => {\n                this.customizeInputElement(input, inputRect, container, maxHeight);\n            }\n        };\n    }\n\n    protected customizeInputElement(\n        input: HTMLInputElement | HTMLTextAreaElement,\n        inputRect: DOMRect,\n        container: HTMLDivElement,\n        maxHeight: number\n    ): void {\n        // move container into our UIExtension container as this is already positioned correctly\n        if (this.containerElement) {\n            this.containerElement.appendChild(container);\n\n            if (this.options && this.options.selectedSuggestionChanged) {\n                const selectedElement = container.querySelector('.selected');\n                // eslint-disable-next-line no-null/no-null\n                if (selectedElement !== null && selectedElement !== undefined) {\n                    const index = Array.from(container.children).indexOf(selectedElement);\n                    this.options.selectedSuggestionChanged(this.contextActions?.[index]);\n                } else {\n                    this.options.selectedSuggestionChanged(undefined);\n                }\n            }\n        }\n    }\n\n    protected updateSuggestions(\n        update: (items: LabeledAction[]) => void,\n        text: string,\n        root: Readonly<GModelRoot>,\n        ...contextElementIds: string[]\n    ): void {\n        this.onLoading();\n        this.doUpdateSuggestions(text, root)\n            .then(actions => {\n                this.contextActions = this.filterActions(text, actions);\n                update(this.contextActions);\n                this.options?.visibleSuggestionsChanged?.(this.contextActions);\n                this.onLoaded('success');\n            })\n            .catch(reason => {\n                if (this.logger) {\n                    this.logger.error(this, 'Failed to obtain suggestions', reason);\n                }\n                this.onLoaded('error');\n            });\n    }\n\n    protected onLoading(): void {\n        if (this.loadingIndicator && this.containerElement.contains(this.loadingIndicator)) {\n            return;\n        }\n        this.loadingIndicator = document.createElement('span');\n        this.loadingIndicator.classList.add(...this.loadingIndicatorClasses);\n        this.containerElement.appendChild(this.loadingIndicator);\n    }\n\n    protected doUpdateSuggestions(text: string, root: Readonly<GModelRoot>, ...contextElementIds: string[]): Promise<LabeledAction[]> {\n        return this.suggestionProvider.provideSuggestions(text);\n    }\n\n    protected onLoaded(_success: 'success' | 'error'): void {\n        if (this.containerElement.contains(this.loadingIndicator)) {\n            this.containerElement.removeChild(this.loadingIndicator);\n        }\n        this.validationDecorator.invalidate();\n        this.validateInputIfNoContextActions();\n        this.previousContent = this.inputElement.value;\n    }\n\n    protected renderSuggestions(item: LabeledAction, value: string): HTMLDivElement {\n        const itemElement = document.createElement('div');\n        const wordMatcher = this.escapeForRegExp(value).split(' ').join('|');\n        const regex = new RegExp(wordMatcher, 'gi');\n        if (item.icon) {\n            this.renderIcon(itemElement, item.icon);\n        }\n        itemElement.innerHTML += item.label.replace(regex, match => '<em>' + match + '</em>').replace(/ /g, '&nbsp;');\n        return itemElement;\n    }\n\n    protected escapeForRegExp(value: string): string {\n        return value.replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\n    }\n\n    protected renderIcon(itemElement: HTMLDivElement, icon: string): void {\n        itemElement.innerHTML += `<span class=\"icon ${icon}\"></span>`;\n    }\n\n    protected filterActions(filterText: string, actions: LabeledAction[]): LabeledAction[] {\n        return toArray(\n            actions.filter(action => {\n                const label = action.label.toLowerCase();\n                const searchWords = filterText.split(' ');\n                return searchWords.every(word => label.indexOf(word.toLowerCase()) !== -1);\n            })\n        );\n    }\n\n    protected onSelect(item: LabeledAction): void {\n        if (AutoCompleteValue.is(item)) {\n            this.inputElement.value = item.text;\n            // trigger update of suggestions with an keyup event\n            window.setTimeout(() => this.inputElement.dispatchEvent(new Event('keyup')));\n        } else {\n            this.executeFromSuggestion(item);\n            this.notifyClose('submission');\n        }\n    }\n\n    protected validateInputIfNoContextActions(): void {\n        if (this.isNoOrExactlyOneMatchingContextAction()) {\n            this.validateInput();\n        } else {\n            this.validationDecorator.dispose();\n        }\n    }\n\n    private isNoOrExactlyOneMatchingContextAction(): boolean | undefined {\n        return (\n            !this.isSuggestionAvailable() ||\n            (this.contextActions && this.contextActions.length === 1 && this.inputElement.value.endsWith(this.contextActions[0].label))\n        );\n    }\n\n    protected isSuggestionAvailable(): boolean | undefined {\n        return this.contextActions && this.contextActions.length > 0;\n    }\n\n    validateInput(): void {\n        if (this.inputValidator) {\n            this.inputValidator\n                .validate(this.inputElement.value)\n                .then(result => this.validationDecorator.decorateValidationResult(result))\n                .catch(error => this.handleErrorDuringValidation(error));\n        }\n    }\n\n    protected handleErrorDuringValidation(error: Error): void {\n        if (this.logger) {\n            this.logger.error(this, 'Failed to validate input', error);\n        }\n        this.validationDecorator.dispose();\n    }\n\n    protected executeFromSuggestion(input: LabeledAction | Action[] | Action): void {\n        this.suggestionSubmitHandler.executeFromSuggestion(input);\n    }\n\n    protected executeFromTextOnlyInput(): void {\n        if (this.textSubmitHandler) {\n            this.textSubmitHandler.executeFromTextOnlyInput(this.inputElement.value);\n        }\n    }\n\n    get inputField(): HTMLInputElement {\n        return this.inputElement;\n    }\n\n    dispose(): void {\n        this.validationDecorator.dispose();\n        if (this.autoCompleteResult) {\n            this.autoCompleteResult.destroy();\n        }\n    }\n}\n\nexport function toActionArray(input: LabeledAction | Action[] | Action): Action[] {\n    if (LabeledAction.is(input)) {\n        return input.actions;\n    } else if (Action.is(input)) {\n        return [input];\n    }\n    return [];\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable, multiInject, optional, preDestroy } from 'inversify';\nimport {\n    CommandStack,\n    Disposable,\n    DisposableCollection,\n    Emitter,\n    Event,\n    ICommand,\n    GModelRoot,\n    SetModelCommand,\n    TYPES,\n    UpdateModelCommand\n} from '@eclipse-glsp/sprotty';\n\n/**\n * A hook to listen for model root changes. Will be called after a server update\n * has been processed\n */\nexport interface ISModelRootListener {\n    modelRootChanged(root: Readonly<GModelRoot>): void;\n}\n\n@injectable()\nexport class GLSPCommandStack extends CommandStack implements Disposable {\n    @multiInject(TYPES.ISModelRootListener)\n    @optional()\n    protected modelRootListeners: ISModelRootListener[] = [];\n    protected toDispose = new DisposableCollection();\n\n    protected override initialize(): void {\n        super.initialize();\n        this.toDispose.push(this.onModelRootChangedEmitter);\n        this.modelRootListeners.forEach(listener => this.onModelRootChanged(root => listener.modelRootChanged(root)));\n    }\n\n    @preDestroy()\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    protected onModelRootChangedEmitter = new Emitter<Readonly<GModelRoot>>();\n    get onModelRootChanged(): Event<Readonly<GModelRoot>> {\n        return this.onModelRootChangedEmitter.event;\n    }\n\n    override undo(): Promise<GModelRoot> {\n        this.logger.warn(\n            this,\n            'GLSPCommandStack.undo() was called. This should never happen as the GLSP server is responsible for handling undo requests'\n        );\n        return this.currentModel;\n    }\n\n    override redo(): Promise<GModelRoot> {\n        this.logger.warn(\n            this,\n            'GLSPCommandStack.redo() was called. This should never happen as the GLSP server is responsible for handling redo requests'\n        );\n        return this.currentModel;\n    }\n\n    override execute(command: ICommand): Promise<GModelRoot> {\n        const result = super.execute(command);\n        if (command instanceof SetModelCommand || command instanceof UpdateModelCommand) {\n            result.then(root => this.notifyListeners(root));\n        }\n        return result;\n    }\n\n    protected notifyListeners(root: Readonly<GModelRoot>): void {\n        this.onModelRootChangedEmitter.fire(root);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Action, MouseListener, GModelElement } from '@eclipse-glsp/sprotty';\n\n/**\n * A mouse listener that is aware of prior mouse dragging.\n *\n * Therefore, this listener distinguishes between mouse up events after dragging and\n * mouse up events without prior dragging. Subclasses may override the methods\n * `draggingMouseUp` and/or `nonDraggingMouseUp` to react to only these specific kinds\n * of mouse up events.\n */\nexport class DragAwareMouseListener extends MouseListener {\n    protected _isMouseDown = false;\n    protected _isMouseDrag = false;\n\n    override mouseDown(target: GModelElement, event: MouseEvent): Action[] {\n        this._isMouseDown = true;\n        return [];\n    }\n\n    override mouseMove(target: GModelElement, event: MouseEvent): Action[] {\n        if (this._isMouseDown) {\n            this._isMouseDrag = true;\n        }\n        return [];\n    }\n\n    override mouseUp(element: GModelElement, event: MouseEvent): Action[] {\n        this._isMouseDown = false;\n        if (this._isMouseDrag) {\n            this._isMouseDrag = false;\n            return this.draggingMouseUp(element, event);\n        }\n\n        return this.nonDraggingMouseUp(element, event);\n    }\n\n    nonDraggingMouseUp(element: GModelElement, event: MouseEvent): Action[] {\n        return [];\n    }\n\n    draggingMouseUp(element: GModelElement, event: MouseEvent): Action[] {\n        return [];\n    }\n\n    get isMouseDrag(): boolean {\n        return this._isMouseDrag;\n    }\n\n    get isMouseDown(): boolean {\n        return this._isMouseDown;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    BoundsAware,\n    distinctAdd,\n    EdgeRouterRegistry,\n    ElementAndBounds,\n    ElementAndRoutingPoints,\n    FluentIterable,\n    isBoundsAware,\n    isMoveable,\n    isSelectable,\n    isSelected,\n    ModelIndexImpl,\n    Point,\n    remove,\n    RoutedPoint,\n    Selectable,\n    GModelElement,\n    GRoutableElement,\n    GRoutingHandle,\n    TypeGuard,\n    GModelElementSchema\n} from '@eclipse-glsp/sprotty';\n\n/**\n * Helper type to represent a filter predicate for {@link GModelElement}s. This is used to retrieve\n * elements from the {@link ModelIndexImpl} that also conform to a second type `T`. Its mainly used for\n * retrieving elements that also implement a certain model features (e.g. selectable)\n */\nexport type ModelFilterPredicate<T> = (modelElement: GModelElement) => modelElement is GModelElement & T;\n\n/**\n * Retrieves all elements from the given {@link ModelIndexImpl} that match the given {@link ModelFilterPredicate}\n * @param index The {@link ModelIndexImpl}.\n * @param predicate The {@link ModelFilterPredicate} that should be used.\n * @returns A {@link FluentIterable} of all indexed element that match the predicate\n * (correctly casted to also include the additional type of the predicate).\n */\nexport function filter<T>(index: ModelIndexImpl, predicate: ModelFilterPredicate<T>): FluentIterable<GModelElement & T> {\n    return index.all().filter(predicate) as FluentIterable<GModelElement & T>;\n}\n\n/**\n * Retrieves all elements from the given {@link ModelIndexImpl} that match the given {@link ModelFilterPredicate} and executes\n * the given runnable for each element of the result set.\n * @param index The {@link ModelIndexImpl}.\n * @param predicate The {@link ModelFilterPredicate} that should be used.\n * @param runnable The runnable that should be executed for each matching element.\n */\nexport function forEachElement<T>(\n    index: ModelIndexImpl,\n    predicate: ModelFilterPredicate<T>,\n    runnable: (modelElement: GModelElement & T) => void\n): void {\n    filter(index, predicate).forEach(runnable);\n}\n\n/**\n * Retrieves an array of all elements that match the given {@link ModelFilterPredicate} from the given {@link ModelIndexImpl}.\n * @param index The {@link ModelIndexImpl}.\n * @param predicate The {@link ModelFilterPredicate} that should be used.\n * @returns An array of all indexed element that match the predicate\n * (correctly casted to also include the additional type of the predicate).\n */\nexport function getMatchingElements<T>(index: ModelIndexImpl, predicate: ModelFilterPredicate<T>): (GModelElement & T)[] {\n    return Array.from(filter(index, predicate));\n}\n\n/**\n * Invokes the given model index to retrieve the corresponding model elements for the given set of ids. Ids that\n * have no corresponding element in the index will be ignored.\n * @param index THe model index.\n * @param elementsIDs The element ids.\n * @param guard Optional typeguard. If defined only elements that match the guard will be returned.\n * @returns An array of the model elements that correspond to the given ids and filter predicate.\n */\nexport function getElements<S extends GModelElement>(index: ModelIndexImpl, elementsIDs: string[], guard?: TypeGuard<S>): S[] {\n    // Internal filter function that filters out undefined model elements and runs an optional typeguard check.\n    const filterFn = (element?: GModelElement): element is S => {\n        if (element !== undefined) {\n            return guard ? guard(element) : true;\n        }\n        return false;\n    };\n    return elementsIDs.map(id => index.getById(id)).filter(filterFn);\n}\n/**\n * Retrieves the amount of currently selected elements in the given {@link ModelIndexImpl}.\n * @param index The {@link ModelIndexImpl}.\n * @returns The amount of selected elements.\n */\nexport function getSelectedElementCount(index: ModelIndexImpl): number {\n    let selected = 0;\n    forEachElement(index, isSelected, element => selected++);\n    return selected;\n}\n\n/**\n * Helper function to check wether an any element is selected in the given {@link ModelIndexImpl}.\n * @param index The {@link ModelIndexImpl}.\n * @returns `true` if at least one element is selected, `false` otherwise.\n */\nexport function hasSelectedElements(index: ModelIndexImpl): boolean {\n    return getSelectedElementCount(index) > 0;\n}\n\n/**\n * Helper function to check wether an element is defined. Can be used as {@link ModelFilterPredicate}.\n * @param element The element that should be checked.\n * @returns the type predicate for `T`\n */\nexport function isNotUndefined<T>(element: T | undefined): element is T {\n    return element !== undefined;\n}\n\n/**\n * Adds a set of css classes to the given {@link GModelElement}.\n * @param element The element to which the css classes should be added.\n * @param cssClasses The set of css classes as string array.\n */\nexport function addCssClasses(element: GModelElement, cssClasses: string[]): void {\n    const elementCssClasses: string[] = element.cssClasses ?? [];\n    distinctAdd(elementCssClasses, ...cssClasses);\n    element.cssClasses = elementCssClasses;\n}\n\n/**\n * Removes a set of css classes from the given {@link GModelElement}.\n * @param element The element from which the css classes should be removed.\n * @param cssClasses The set of css classes as string array.\n */\nexport function removeCssClasses(root: GModelElement, cssClasses: string[]): void {\n    if (!root.cssClasses || root.cssClasses.length === 0) {\n        return;\n    }\n    remove(root.cssClasses, ...cssClasses);\n}\n\nexport function isNonRoutableSelectedMovableBoundsAware(element: GModelElement): element is SelectableBoundsAware {\n    return isNonRoutableSelectedBoundsAware(element) && isMoveable(element);\n}\n\n/**\n * A typeguard function to check wether a given {@link GModelElement} implements the {@link BoundsAware} model feature,\n * the {@link Selectable} model feature and is actually selected. In addition, the element must not be a {@link GRoutableElement}.\n * @param element The element to check.\n * @returns A type predicate indicating wether the element is of type {@link SelectableBoundsAware}.\n */\nexport function isNonRoutableSelectedBoundsAware(element: GModelElement): element is SelectableBoundsAware {\n    return isBoundsAware(element) && isSelected(element) && !isRoutable(element);\n}\n\n/**\n * A type guard function to check wether a given {@link GModelElement} is a {@link GRoutableElement}.\n * @param element The element to check.\n * @returns A type predicate indicating wether the element is a {@link GRoutableElement}.\n */\nexport function isRoutable<T extends GModelElement>(element: T): element is T & GRoutableElement {\n    return element instanceof GRoutableElement && (element as any).routingPoints !== undefined;\n}\n\n/**\n * A typeguard function to check wether a given {@link GModelElement} is a {@link SRoutingHandle}.\n * @param element The element to check.\n * @returns A type predicate indicating wether the element is a {@link SRoutingHandle}\n */\nexport function isRoutingHandle(element: GModelElement | undefined): element is GRoutingHandle {\n    return element !== undefined && element instanceof GRoutingHandle;\n}\n\n/**\n * A typeguard function to check wether a given {@link GModelElement} implements the {@link Selectable} model feature and\n * the {@link BoundsAware} model feature.\n * @returns A type predicate indicating wether the element is of type {@link SelectableBoundsAware}.\n */\nexport function isSelectableAndBoundsAware(element: GModelElement): element is SelectableBoundsAware {\n    return isSelectable(element) && isBoundsAware(element);\n}\n\n/**\n * Union type to describe {@link GModelElement}s that implement the {@link Selectable} and {@link BoundsAware} feature.\n */\nexport type SelectableBoundsAware = GModelElement & BoundsAware & Selectable;\n\n/**\n * Union type to describe {@link GModelElement}s that implement the {@link BoundsAware} feature.\n */\nexport type BoundsAwareModelElement = GModelElement & BoundsAware;\n\n/**\n * Helper function to translate a given {@link GModelElement} into its corresponding {@link ElementAndBounds} representation.\n * @param element The element to translate.\n * @returns The corresponding {@link ElementAndBounds} for the given element.\n */\nexport function toElementAndBounds(element: BoundsAwareModelElement): ElementAndBounds {\n    return {\n        elementId: element.id,\n        newPosition: {\n            x: element.bounds.x,\n            y: element.bounds.y\n        },\n        newSize: {\n            width: element.bounds.width,\n            height: element.bounds.height\n        }\n    };\n}\n\n/**\n * Helper function to translate a given {@link GRoutableElement} into its corresponding\n * {@link ElementAndRoutingPoints} representation.\n * @param element The element to translate.\n * @returns The corresponding {@link ElementAndRoutingPoints} for the given element.\n */\nexport function toElementAndRoutingPoints(element: GRoutableElement): ElementAndRoutingPoints {\n    return {\n        elementId: element.id,\n        newRoutingPoints: element.routingPoints\n    };\n}\n/** All routing points. */\nexport const ALL_ROUTING_POINTS = undefined;\n\n/** Pure routing point data kinds. */\nexport const ROUTING_POINT_KINDS = ['linear', 'bezier-junction'];\n\n/** Pure route data kinds. */\nexport const ROUTE_KINDS = [...ROUTING_POINT_KINDS, 'source', 'target'];\n\n/**\n * Helper function to calculate the {@link ElementAndRoutingPoints} for a given {@link GRoutableElement}.\n * If client layout is activated, i.e., the edge routing registry is given and has a router for the element, then the routing\n * points from the calculated route are used, otherwise we use the already specified routing points of the {@link GRoutableElement}.\n * @param element The element to translate.\n * @param routerRegistry the edge router registry.\n * @returns The corresponding {@link ElementAndRoutingPoints} for the given element.\n */\nexport function calcElementAndRoutingPoints(element: GRoutableElement, routerRegistry?: EdgeRouterRegistry): ElementAndRoutingPoints {\n    const newRoutingPoints = routerRegistry ? calcRoute(element, routerRegistry, ROUTING_POINT_KINDS) : element.routingPoints;\n    return { elementId: element.id, newRoutingPoints };\n}\n\n/**\n * Helper function to calculate the route for a given {@link GRoutableElement}.\n * If client layout is activated, i.e., the edge routing registry is given and has a router for the element, then the points\n * from the calculated route are used, otherwise we use the already specified routing points of the {@link GRoutableElement}.\n * @param element The element to translate.\n * @param routerRegistry the edge router registry.\n * @returns The corresponding route for the given element.\n */\nexport function calcElementAndRoute(element: GRoutableElement, routerRegistry?: EdgeRouterRegistry): ElementAndRoutingPoints {\n    let route: Point[] | undefined = routerRegistry ? calcRoute(element, routerRegistry, ROUTE_KINDS) : undefined;\n    if (!route) {\n        // add source and target to the routing points\n        route = [...element.routingPoints];\n        route.splice(0, 0, element.source?.position || Point.ORIGIN);\n        route.push(element.target?.position || Point.ORIGIN);\n    }\n    return { elementId: element.id, newRoutingPoints: route };\n}\n\n/**\n * Helper function to calculate the route for a given {@link GRoutableElement} by filtering duplicate points.\n * @param element The element to translate.\n * @param routerRegistry the edge router registry.\n * @param pointKinds the routing point kinds that should be considered.\n * @param tolerance the tolerance applied to a point's coordinates to determine duplicates.\n * @returns The corresponding route for the given element.\n */\nexport function calcRoute(\n    element: GRoutableElement,\n    routerRegistry: EdgeRouterRegistry,\n    pointKinds: string[] | undefined = ALL_ROUTING_POINTS,\n    tolerance = Number.EPSILON\n): RoutedPoint[] | undefined {\n    const route = routerRegistry.get(element.routerKind).route(element);\n    const calculatedRoute: RoutedPoint[] = [];\n    for (const point of route) {\n        // only include points we are actually interested in\n        if (pointKinds && !pointKinds.includes(point.kind)) {\n            continue;\n        }\n        // check if we are a duplicate based on coordinates in the already calculated route\n        if (\n            ROUTING_POINT_KINDS.includes(point.kind) &&\n            calculatedRoute.find(calculatedPoint => Point.maxDistance(point, calculatedPoint) < tolerance)\n        ) {\n            continue;\n        }\n        calculatedRoute.push(point);\n    }\n    return calculatedRoute;\n}\n\n/**\n * Convenience function to retrieve the model element type from a given input. The input\n * can either be a {@link GModelElement}, {@link GModelElementSchema} or a string.\n * @param input The type input.\n * @returns The corresponding model type as string.\n */\nexport function getElementTypeId(input: GModelElement | GModelElementSchema | string): string {\n    if (typeof input === 'string') {\n        return input;\n    } else {\n        return input.type;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, multiInject, optional, postConstruct, preDestroy } from 'inversify';\nimport {\n    Action,\n    Command,\n    CommandExecutionContext,\n    Disposable,\n    DisposableCollection,\n    Emitter,\n    Event,\n    GChildElement,\n    ILogger,\n    GModelElement,\n    GModelRoot,\n    SelectAction,\n    SelectAllAction,\n    Selectable,\n    SprottySelectAllCommand,\n    SprottySelectCommand,\n    TYPES,\n    hasArrayProp,\n    isSelectable,\n    pluck\n} from '@eclipse-glsp/sprotty';\nimport { getElements, getMatchingElements } from '../utils/gmodel-util';\nimport { ISModelRootListener } from './command-stack';\nimport { IFeedbackActionDispatcher } from './feedback/feedback-action-dispatcher';\n\nexport interface ISelectionListener {\n    selectionChanged(root: Readonly<GModelRoot>, selectedElements: string[], deselectedElements?: string[]): void;\n}\n\nexport interface SelectionChange {\n    root: Readonly<GModelRoot>;\n    selectedElements: string[];\n    deselectedElements: string[];\n}\n\n@injectable()\nexport class SelectionService implements ISModelRootListener, Disposable {\n    protected root: Readonly<GModelRoot>;\n    protected selectedElementIDs: Set<string> = new Set();\n\n    @inject(TYPES.IFeedbackActionDispatcher)\n    protected feedbackDispatcher: IFeedbackActionDispatcher;\n\n    @inject(TYPES.ILogger)\n    protected logger: ILogger;\n\n    @multiInject(TYPES.ISelectionListener)\n    @optional()\n    protected selectionListeners: ISelectionListener[] = [];\n\n    protected toDispose = new DisposableCollection();\n\n    @postConstruct()\n    protected initialize(): void {\n        this.toDispose.push(this.onSelectionChangedEmitter);\n        this.selectionListeners.forEach(listener =>\n            this.onSelectionChanged(change => listener.selectionChanged(change.root, change.selectedElements, change.deselectedElements))\n        );\n    }\n\n    @preDestroy()\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    protected onSelectionChangedEmitter = new Emitter<SelectionChange>();\n    get onSelectionChanged(): Event<SelectionChange> {\n        return this.onSelectionChangedEmitter.event;\n    }\n\n    modelRootChanged(root: Readonly<GModelRoot>): void {\n        this.updateSelection(root, [], []);\n    }\n\n    updateSelection(root: Readonly<GModelRoot>, select: string[], deselect: string[]): void {\n        if (root === undefined && select.length === 0 && deselect.length === 0) {\n            return;\n        }\n        const prevRoot = this.root;\n        const prevSelectedElementIDs = new Set(this.selectedElementIDs);\n\n        // update root\n        this.root = root;\n\n        // update selected element IDs and collect deselected elements\n        // - select all elements that are not deselected at the same time (no-op)\n        // - deselect all elements that are not selected at the same time (no-op) but was selected\n        const toSelect = [...select].filter(selectId => deselect.indexOf(selectId) === -1);\n        const toDeselect = [...deselect].filter(deselectId => select.indexOf(deselectId) === -1 && this.selectedElementIDs.has(deselectId));\n        for (const id of toDeselect) {\n            this.selectedElementIDs.delete(id);\n        }\n        for (const id of toSelect) {\n            this.selectedElementIDs.add(id);\n        }\n\n        const deselectedElementIDs = new Set(toDeselect);\n        // see if selected elements still exist in the updated root\n        for (const id of this.selectedElementIDs) {\n            const element = root.index.getById(id);\n            if (element === undefined) {\n                this.selectedElementIDs.delete(id);\n                if (prevRoot !== undefined && prevRoot.index.getById(id)) {\n                    deselectedElementIDs.add(id);\n                }\n            }\n        }\n\n        // only send out changes if there actually are changes, i.e., the root or the selected elements changed\n        const selectionChanged =\n            prevSelectedElementIDs.size !== this.selectedElementIDs.size ||\n            ![...prevSelectedElementIDs].every(value => this.selectedElementIDs.has(value));\n        if (selectionChanged) {\n            // aggregate to feedback action handling all elements as only the last feedback is restored\n            this.dispatchFeedback([\n                SelectFeedbackAction.create({\n                    selectedElementsIDs: [...this.selectedElementIDs],\n                    deselectedElementsIDs: [...deselectedElementIDs]\n                })\n            ]);\n        }\n\n        const rootChanged = prevRoot !== root;\n        if (rootChanged || selectionChanged) {\n            // notify listeners after the feedback action\n            this.notifyListeners(this.root, this.selectedElementIDs, deselectedElementIDs);\n        }\n    }\n\n    dispatchFeedback(actions: Action[]): void {\n        this.feedbackDispatcher.registerFeedback(this, actions);\n    }\n\n    notifyListeners(root: GModelRoot, selectedElementIDs: Set<string>, deselectedElementIDs: Set<string>): void {\n        this.onSelectionChangedEmitter.fire({\n            root,\n            selectedElements: Array.from(selectedElementIDs),\n            deselectedElements: Array.from(deselectedElementIDs)\n        });\n    }\n\n    getModelRoot(): Readonly<GModelRoot> {\n        return this.root;\n    }\n\n    getSelectedElements(): Readonly<GModelElement & Selectable>[] {\n        return !this.root ? [] : getElements(this.root.index, Array.from(this.selectedElementIDs), isSelectable);\n    }\n\n    /**\n     * QUERY METHODS\n     */\n\n    getSelectedElementIDs(): string[] {\n        return [...this.selectedElementIDs];\n    }\n\n    hasSelectedElements(): boolean {\n        return this.selectedElementIDs.size > 0;\n    }\n\n    isSingleSelection(): boolean {\n        return this.selectedElementIDs.size === 1;\n    }\n\n    isMultiSelection(): boolean {\n        return this.selectedElementIDs.size > 1;\n    }\n}\n\n/**\n * Handles a {@link SelectAction} and propagates the new selection to the {@link SelectionService}.\n * Other tools might be selection-sensitive which means {@link SelectAction}s must be processed as fast as possible.\n * Handling the action with a command ensures that the action is processed before the next render tick.\n */\n@injectable()\nexport class SelectCommand extends Command {\n    static readonly KIND = SprottySelectCommand.KIND;\n\n    protected selected: GModelElement[] = [];\n    protected deselected: GModelElement[] = [];\n\n    constructor(@inject(TYPES.Action) public action: SelectAction, @inject(SelectionService) public selectionService: SelectionService) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): GModelRoot {\n        const model = context.root;\n        const selectionGuard = (element: any): element is GModelElement => element instanceof GChildElement && isSelectable(element);\n        const selectedElements = getElements(model.index, this.action.selectedElementsIDs, selectionGuard);\n        const deselectedElements = this.action.deselectAll\n            ? this.selectionService.getSelectedElements()\n            : getElements(model.index, this.action.deselectedElementsIDs, selectionGuard);\n\n        this.selectionService.updateSelection(model, pluck(selectedElements, 'id'), pluck(deselectedElements, 'id'));\n        return model;\n    }\n\n    // Basically no-op since client-side undo is not supported in GLSP.\n    undo(context: CommandExecutionContext): GModelRoot {\n        return context.root;\n    }\n\n    // Basically no-op since client-side redo is not supported in GLSP.\n    redo(context: CommandExecutionContext): GModelRoot {\n        return context.root;\n    }\n}\n\n/**\n * Handles a {@link SelectAllAction} and propagates the new selection to the {@link SelectionService}.\n * Other tools might be selection-sensitive which means {@link SelectionAllAction}s must be processed as fast as possible.\n * Handling the action with a command ensures that the action is processed before the next render tick.\n */\n@injectable()\nexport class SelectAllCommand extends Command {\n    static readonly KIND = SprottySelectAllCommand.KIND;\n    protected previousSelection: Map<string, boolean> = new Map<string, boolean>();\n\n    constructor(@inject(TYPES.Action) public action: SelectAllAction, @inject(SelectionService) public selectionService: SelectionService) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): GModelRoot {\n        const model = context.root;\n        const selectionGuard = (element: any): element is GModelElement => element instanceof GChildElement && isSelectable(element);\n\n        const selectables = getMatchingElements(model.index, selectionGuard);\n        const selectableIds = pluck(selectables, 'id');\n        if (this.action.select) {\n            this.selectionService.updateSelection(model, selectableIds, []);\n        } else {\n            this.selectionService.updateSelection(model, [], selectableIds);\n        }\n\n        return model;\n    }\n\n    // Basically no-op since client-side undo is not supported in GLSP.\n    undo(context: CommandExecutionContext): GModelRoot {\n        return context.root;\n    }\n\n    // Basically no-op since client-side redo is not supported in GLSP.\n    redo(context: CommandExecutionContext): GModelRoot {\n        return context.root;\n    }\n}\n\nexport interface SelectFeedbackAction extends Omit<SelectAction, 'kind'>, Action {\n    kind: typeof SelectFeedbackAction.KIND;\n}\n\nexport namespace SelectFeedbackAction {\n    export const KIND = 'selectFeedback';\n\n    export function is(object: any): object is SelectFeedbackAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'selectedElementsIDs') && hasArrayProp(object, 'deselectedElementsIDs');\n    }\n\n    export function create(options?: { selectedElementsIDs?: string[]; deselectedElementsIDs?: string[] | boolean }): SelectFeedbackAction {\n        return { ...SelectAction.create(options), kind: KIND };\n    }\n\n    export function addSelection(selectedElementsIDs: string[]): SelectFeedbackAction {\n        return { ...SelectAction.addSelection(selectedElementsIDs), kind: KIND };\n    }\n\n    export function removeSelection(deselectedElementsIDs: string[]): SelectFeedbackAction {\n        return { ...SelectAction.removeSelection(deselectedElementsIDs), kind: KIND };\n    }\n\n    export function setSelection(selectedElementsIDs: string[]): SelectFeedbackAction {\n        return { ...SelectAction.setSelection(selectedElementsIDs), kind: KIND };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, multiInject, optional, postConstruct, preDestroy } from 'inversify';\nimport {\n    Action,\n    Args,\n    Disposable,\n    DisposableCollection,\n    EditMode,\n    EditorContext,\n    Emitter,\n    Event,\n    IActionHandler,\n    MaybePromise,\n    MousePositionTracker,\n    GModelElement,\n    GModelRoot,\n    SetDirtyStateAction,\n    SetEditModeAction,\n    TYPES,\n    ValueChange\n} from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from './action-dispatcher';\nimport { IDiagramOptions, IDiagramStartup } from './model/diagram-loader';\nimport { SelectionService } from './selection-service';\n\nexport interface IEditModeListener {\n    editModeChanged(newValue: string, oldValue: string): void;\n}\n\nexport type DirtyStateChange = Pick<SetDirtyStateAction, 'isDirty' | 'reason'>;\n/**\n * The `EditorContextService` is a central injectable component that gives read-only access to\n * certain aspects of the diagram, such as the currently selected elements, the model root,\n * the edit mode, the latest position of the mouse in the diagram.\n *\n * It has been introduced for two main reasons:\n * 1. to simplify accessing the model root and the current selection from components that are\n *    not commands,\n * 2. to conveniently create an EditorContext, which is a context object sent as part of several\n *    actions to the server to describe the current state of the editor (selection, last mouse\n *    position, etc.).\n */\n@injectable()\nexport class EditorContextService implements IActionHandler, Disposable, IDiagramStartup {\n    @inject(SelectionService)\n    protected selectionService: SelectionService;\n\n    @inject(MousePositionTracker)\n    protected mousePositionTracker: MousePositionTracker;\n\n    @inject(TYPES.IDiagramOptions)\n    protected diagramOptions: IDiagramOptions;\n\n    @multiInject(TYPES.IEditModeListener)\n    @optional()\n    protected editModeListeners: IEditModeListener[] = [];\n\n    @inject(GLSPActionDispatcher)\n    protected actionDispatcher: GLSPActionDispatcher;\n\n    protected _editMode: string;\n    protected onEditModeChangedEmitter = new Emitter<ValueChange<string>>();\n    get onEditModeChanged(): Event<ValueChange<string>> {\n        return this.onEditModeChangedEmitter.event;\n    }\n\n    protected _isDirty: boolean;\n    protected onDirtyStateChangedEmitter = new Emitter<DirtyStateChange>();\n    get onDirtyStateChanged(): Event<DirtyStateChange> {\n        return this.onDirtyStateChangedEmitter.event;\n    }\n\n    protected toDispose = new DisposableCollection();\n\n    @postConstruct()\n    protected initialize(): void {\n        this._editMode = this.diagramOptions.editMode ?? EditMode.EDITABLE;\n        this.toDispose.push(this.onEditModeChangedEmitter, this.onDirtyStateChangedEmitter);\n        this.editModeListeners.forEach(listener =>\n            this.onEditModeChanged(change => listener.editModeChanged(change.newValue, change.oldValue))\n        );\n    }\n\n    @preDestroy()\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n    get(args?: Args): EditorContext {\n        return {\n            selectedElementIds: Array.from(this.selectionService.getSelectedElementIDs()),\n            lastMousePosition: this.mousePositionTracker.lastPositionOnDiagram,\n            args\n        };\n    }\n\n    getWithSelection(selectedElementIds: string[], args?: Args): EditorContext {\n        return {\n            selectedElementIds,\n            lastMousePosition: this.mousePositionTracker.lastPositionOnDiagram,\n            args\n        };\n    }\n\n    handle(action: Action): void {\n        if (SetEditModeAction.is(action)) {\n            this.handleSetEditModeAction(action);\n        } else if (SetDirtyStateAction.is(action)) {\n            this.handleSetDirtyStateAction(action);\n        }\n    }\n\n    protected handleSetEditModeAction(action: SetEditModeAction): void {\n        const oldValue = this._editMode;\n        this._editMode = action.editMode;\n        this.onEditModeChangedEmitter.fire({ newValue: this.editMode, oldValue });\n    }\n\n    protected handleSetDirtyStateAction(action: SetDirtyStateAction): void {\n        if (action.isDirty !== this._isDirty) {\n            this._isDirty = action.isDirty;\n            this.onDirtyStateChangedEmitter.fire(action);\n        }\n    }\n\n    get sourceUri(): string | undefined {\n        return this.diagramOptions.sourceUri;\n    }\n\n    get editMode(): string {\n        return this._editMode;\n    }\n\n    get diagramType(): string {\n        return this.diagramOptions.diagramType;\n    }\n\n    get clientId(): string {\n        return this.diagramOptions.clientId;\n    }\n\n    get modelRoot(): Readonly<GModelRoot> {\n        return this.selectionService.getModelRoot();\n    }\n\n    get selectedElements(): Readonly<GModelElement>[] {\n        return this.selectionService.getSelectedElements();\n    }\n\n    get isReadonly(): boolean {\n        return this.editMode === EditMode.READONLY;\n    }\n\n    get isDirty(): boolean {\n        return this._isDirty;\n    }\n\n    postRequestModel(): MaybePromise<void> {\n        this.actionDispatcher.dispatch(SetEditModeAction.create(this.editMode));\n    }\n}\n\nexport type EditorContextServiceProvider = () => Promise<EditorContextService>;\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { Action, Disposable, IActionDispatcher, ILogger, TYPES } from '@eclipse-glsp/sprotty';\n\nexport interface IFeedbackEmitter {}\n\n/**\n * Dispatcher for actions that are meant to show visual feedback on\n * the diagram that is not part of the diagram sent from the server\n * after a model update.\n *\n * The purpose of this dispatcher is to re-establish the feedback\n * after the model has been updated or reset by the server, as this would\n * overwrite the already established feedback, in case it is drawn by\n * extending the `GModelRoot`. Therefore, tools can register themselves\n * as feedback emitters with actions they want to place for showing\n * feedback. This dispatcher will then re-establish all feedback actions\n * of the registered emitters, whenever the `GModelRoot` has been set or updated.\n */\nexport interface IFeedbackActionDispatcher {\n    /**\n     * Registers `actions` to be sent out by a `feedbackEmitter`.\n     * @param feedbackEmitter the emitter sending out feedback actions.\n     * @param feedbackActions the actions to be sent out.\n     * @param cleanupActions the actions to be sent out when the feedback is de-registered through the returned Disposable.\n     * @returns A 'Disposable' that de-registers the feedback and cleans up any pending feedback with the given `cleanupActions`.\n     */\n    registerFeedback(feedbackEmitter: IFeedbackEmitter, feedbackActions: Action[], cleanupActions?: Action[]): Disposable;\n\n    /**\n     * Deregisters a `feedbackEmitter` from this dispatcher and thereafter\n     * dispatches the provided `actions`.\n     * @param feedbackEmitter the emitter to be deregistered.\n     * @param cleanupActions the actions to be dispatched right after the deregistration.\n     * These actions do not have to be related to the actions sent out by the\n     * deregistered `feedbackEmitter`. The purpose of these actions typically is\n     * to reset the normal state of the diagram without the feedback (e.g., reset a\n     * CSS class that was set by a feedbackEmitter).\n     */\n    deregisterFeedback(feedbackEmitter: IFeedbackEmitter, cleanupActions?: Action[]): void;\n\n    /**\n     * Retrieve all `actions` sent out by currently registered `feedbackEmitter`.\n     */\n    getRegisteredFeedback(): Action[];\n}\n\n@injectable()\nexport class FeedbackActionDispatcher implements IFeedbackActionDispatcher {\n    protected registeredFeedback: Map<IFeedbackEmitter, Action[]> = new Map();\n\n    @inject(TYPES.IActionDispatcherProvider) protected actionDispatcher: () => Promise<IActionDispatcher>;\n    @inject(TYPES.ILogger) protected logger: ILogger;\n\n    registerFeedback(feedbackEmitter: IFeedbackEmitter, feedbackActions: Action[], cleanupActions?: Action[] | undefined): Disposable {\n        if (feedbackActions.length > 0) {\n            this.registeredFeedback.set(feedbackEmitter, feedbackActions);\n            this.dispatchFeedback(feedbackActions, feedbackEmitter);\n        }\n        return Disposable.create(() => this.deregisterFeedback(feedbackEmitter, cleanupActions));\n    }\n\n    deregisterFeedback(feedbackEmitter: IFeedbackEmitter, cleanupActions?: Action[] | undefined): void {\n        this.registeredFeedback.delete(feedbackEmitter);\n        if (cleanupActions && cleanupActions.length > 0) {\n            this.dispatchFeedback(cleanupActions, feedbackEmitter);\n        }\n    }\n\n    getRegisteredFeedback(): Action[] {\n        const result: Action[] = [];\n        this.registeredFeedback.forEach(actions => result.push(...actions));\n        return result;\n    }\n\n    getRegisteredFeedbackEmitters(action: Action): IFeedbackEmitter[] {\n        const result: IFeedbackEmitter[] = [];\n        this.registeredFeedback.forEach((actions, emitter) => {\n            if (actions.includes(action)) {\n                result.push(emitter);\n            }\n        });\n        return result;\n    }\n\n    protected async dispatchFeedback(actions: Action[], feedbackEmitter: IFeedbackEmitter): Promise<void> {\n        try {\n            const actionDispatcher = await this.actionDispatcher();\n            await actionDispatcher.dispatchAll(actions);\n            this.logger.info(this, `Dispatched feedback actions for ${feedbackEmitter}`);\n        } catch (reason) {\n            this.logger.error(this, 'Failed to dispatch feedback actions', reason);\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Command, CommandExecutionContext, CommandReturn } from '@eclipse-glsp/sprotty';\n\nexport abstract class FeedbackCommand extends Command {\n    // used by the `FeedbackAwareUpdateModelCommand`\n    readonly priority: number = 0;\n\n    undo(context: CommandExecutionContext): CommandReturn {\n        return context.root;\n    }\n\n    redo(context: CommandExecutionContext): CommandReturn {\n        return context.root;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, optional } from 'inversify';\nimport {\n    ActionHandlerRegistry,\n    Animation,\n    Command,\n    CommandActionHandler,\n    CommandExecutionContext,\n    CommandReturn,\n    ILogger,\n    MorphEdgesAnimation,\n    GModelRoot,\n    TYPES,\n    UpdateAnimationData,\n    UpdateModelAction,\n    UpdateModelCommand,\n    toTypeGuard\n} from '@eclipse-glsp/sprotty';\nimport { IFeedbackActionDispatcher } from './feedback-action-dispatcher';\nimport { FeedbackCommand } from './feedback-command';\n\n/**\n * A special {@link UpdateModelCommand} that retrieves all registered {@link Action}s from the {@link IFeedbackActionDispatcher}\n * (if present) and applies their feedback to the `newRoot` before performing the update. This enables persistent client-side feedback\n * across model updates initiated by the GLSP server.\n */\n@injectable()\nexport class FeedbackAwareUpdateModelCommand extends UpdateModelCommand {\n    @inject(TYPES.ILogger)\n    protected logger: ILogger;\n\n    @inject(TYPES.IFeedbackActionDispatcher)\n    @optional()\n    protected feedbackActionDispatcher: IFeedbackActionDispatcher;\n\n    protected actionHandlerRegistry?: ActionHandlerRegistry;\n\n    constructor(\n        @inject(TYPES.Action) action: UpdateModelAction,\n        @inject(TYPES.ActionHandlerRegistryProvider)\n        actionHandlerRegistryProvider: () => Promise<ActionHandlerRegistry>\n    ) {\n        super({ animate: true, ...action });\n        actionHandlerRegistryProvider().then(registry => (this.actionHandlerRegistry = registry));\n    }\n\n    protected override performUpdate(oldRoot: GModelRoot, newRoot: GModelRoot, context: CommandExecutionContext): CommandReturn {\n        if (this.feedbackActionDispatcher && this.actionHandlerRegistry) {\n            // Create a temporary context which defines the `newRoot` as `root`\n            // This way we do not corrupt the redo/undo behavior of the super class\n            const tempContext: CommandExecutionContext = {\n                ...context,\n                root: newRoot\n            };\n\n            const feedbackCommands = this.getFeedbackCommands(this.actionHandlerRegistry);\n            feedbackCommands.forEach(command => command.execute(tempContext));\n        }\n\n        return super.performUpdate(oldRoot, newRoot, context);\n    }\n\n    protected getFeedbackCommands(registry: ActionHandlerRegistry): Command[] {\n        const result: Command[] = [];\n        this.feedbackActionDispatcher.getRegisteredFeedback().forEach(action => {\n            const commands = registry\n                .get(action.kind)\n                .filter<CommandActionHandler>(toTypeGuard(CommandActionHandler))\n                .map(handler => handler.handle(action));\n            result.push(...commands);\n        });\n        // sort commands descanting by priority\n        return result.sort((a, b) => this.getPriority(b) - this.getPriority(a));\n    }\n\n    protected getPriority(command: Partial<FeedbackCommand>): number {\n        return command.priority ?? 0;\n    }\n\n    // Override the `createAnimations` implementation and remove the animation for edge morphing. Otherwise routing & reconnect\n    // handles flicker after each server update.\n    protected override createAnimations(data: UpdateAnimationData, root: GModelRoot, context: CommandExecutionContext): Animation[] {\n        const animations = super.createAnimations(data, root, context);\n        return animations.filter(animation => !(animation instanceof MorphEdgesAnimation));\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Action, hasBooleanProp } from '@eclipse-glsp/sprotty';\n\n/**\n * A `FocusStateChangedAction` is dispatched by the client whenever the\n * diagram focus changes (i.e. focus loss or focus gain).\n */\nexport interface FocusStateChangedAction extends Action {\n    kind: typeof FocusStateChangedAction.KIND;\n    /**\n     * The new focus state of the diagram.\n     */\n    hasFocus: boolean;\n}\n\nexport namespace FocusStateChangedAction {\n    export const KIND = 'focusStateChanged';\n\n    export function is(object: any): object is FocusStateChangedAction {\n        return Action.hasKind(object, KIND) && hasBooleanProp(object, 'hasFocus');\n    }\n\n    export function create(hasFocus = true): FocusStateChangedAction {\n        return {\n            kind: KIND,\n            hasFocus\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { Action, IActionHandler, ICommand, TYPES, ViewerOptions } from '@eclipse-glsp/sprotty';\nimport { FocusStateChangedAction } from './focus-state-change-action';\n\n@injectable()\nexport class FocusTracker implements IActionHandler {\n    protected inActiveCssClass = 'inactive';\n    protected _hasFocus = true;\n    protected _focusElement: HTMLOrSVGElement | null;\n    protected _diagramElement: HTMLElement | null;\n\n    @inject(TYPES.ViewerOptions) protected options: ViewerOptions;\n\n    get hasFocus(): boolean {\n        return this._hasFocus;\n    }\n\n    get focusElement(): HTMLOrSVGElement | null {\n        return this._focusElement;\n    }\n\n    get diagramElement(): HTMLElement | null {\n        return this._diagramElement;\n    }\n\n    handle(action: Action): void | Action | ICommand {\n        if (FocusStateChangedAction.is(action)) {\n            this._hasFocus = action.hasFocus;\n            this._focusElement = document.activeElement as HTMLOrSVGElement | null;\n            this._diagramElement = document.getElementById(this.options.baseDiv);\n            if (!this._diagramElement) {\n                return;\n            }\n            if (this.hasFocus) {\n                if (this._diagramElement.classList.contains(this.inActiveCssClass)) {\n                    this._diagramElement.classList.remove(this.inActiveCssClass);\n                }\n            } else {\n                this._diagramElement.classList.add(this.inActiveCssClass);\n            }\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { AnyObject, hasNumberProp } from '@eclipse-glsp/sprotty';\n\n/**\n * A common interface for services/listeners that should be\n * orderable by a type or rank/priority.\n */\nexport interface Ranked {\n    rank: number;\n}\n\nexport namespace Ranked {\n    export const DEFAULT_RANK = 0;\n    export function is(object: unknown): object is Ranked {\n        return AnyObject.is(object) && hasNumberProp(object, 'rank');\n    }\n\n    /**\n     * Tries to retrieve the rank form the given object. If the object\n     * implements the {@link Ranked} interface the corresponding rank is returned\n     * otherwise the {@link DEFAULT_RANK} is returned.\n     * @param object\n     */\n    export function getRank(object: unknown): number {\n        return is(object) ? object.rank : DEFAULT_RANK;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, preDestroy } from 'inversify';\nimport {\n    Action,\n    ActionMessage,\n    Disposable,\n    DisposableCollection,\n    DisposeClientSessionParameters,\n    GLSPClient,\n    GModelRootSchema,\n    ILogger,\n    InitializeClientSessionParameters,\n    InitializeResult,\n    ModelSource,\n    TYPES\n} from '@eclipse-glsp/sprotty';\nimport { GLSPActionHandlerRegistry } from '../action-handler-registry';\nimport { IDiagramOptions } from './diagram-loader';\n/**\n * A helper interface that allows the client to mark actions that have been received from the server.\n */\nexport interface ServerAction extends Action {\n    __receivedFromServer: true;\n}\n\nexport namespace ServerAction {\n    export function is(object: unknown): object is ServerAction {\n        return Action.is(object) && '__receivedFromServer' in object && object.__receivedFromServer === true;\n    }\n\n    /**\n     * Mark the given action as {@link ServerAction} by attaching the \"_receivedFromServer\" property\n     * @param action The action that should be marked as server action\n     */\n    export function mark(action: Action): void {\n        (action as ServerAction).__receivedFromServer = true;\n    }\n}\n\n/**\n * Central component for enabling the client-server action flow with the help of an underlying {@link GLSPClient}.\n * Handles & forwards actions that are intended for the GLSP server. In addition, it handles {@link ActionMessage}s received\n * from the server and dispatches the corresponding actions locally.\n *\n * Note that in sprotty a {@link ModelSource} is serving the model to the event cycle and\n * is used to commit the local (i.e. client-side) model back to the source.\n * However, in GLSP the update flow is reversed meaning that changes to the source model are applied\n * on the server side and then an update is sent to the client.\n */\n@injectable()\nexport class GLSPModelSource extends ModelSource implements Disposable {\n    @inject(TYPES.ILogger)\n    protected logger: ILogger;\n\n    @inject(TYPES.IDiagramOptions)\n    protected options: IDiagramOptions;\n\n    protected toDispose = new DisposableCollection();\n    clientId: string;\n\n    protected _currentRoot: GModelRootSchema;\n    protected registry: GLSPActionHandlerRegistry;\n    protected glspClient?: GLSPClient;\n\n    get diagramType(): string {\n        return this.options.diagramType;\n    }\n\n    get sourceUri(): string | undefined {\n        return this.options.sourceUri;\n    }\n\n    /**\n     * Configure forwarding of server-handled actions to the given {@link GLSPClient} and\n     * handling of action received from the `GLSPClient` (i.e. server). It is expected that the\n     * given GLSP client has already been initialized.\n     * @param glspClient The GLSP  to use.\n     * @throws An error if the given `GLSPClient` has not been initialized yet or if the set of server handled\n     *         action kinds could not be derived from the initialize result\n     */\n    configure(glspClient: GLSPClient): Promise<void> {\n        this.glspClient = glspClient;\n        if (!glspClient.initializeResult) {\n            throw new Error('Could not configure model source. The GLSP client is not initialized yet!');\n        }\n\n        const initializeParams = this.createInitializeClientSessionParameters(glspClient.initializeResult);\n        this.configureServeActions(glspClient.initializeResult);\n\n        this.toDispose.push(\n            glspClient.onActionMessage(message => this.messageReceived(message), this.clientId),\n            Disposable.create(() => glspClient.disposeClientSession(this.createDisposeClientSessionParameters()))\n        );\n\n        return glspClient!.initializeClientSession(initializeParams);\n    }\n\n    protected createInitializeClientSessionParameters(_initializeResult: InitializeResult): InitializeClientSessionParameters {\n        const clientActionKinds = this.registry.getHandledActionKinds();\n        return {\n            clientSessionId: this.clientId,\n            clientActionKinds,\n            diagramType: this.diagramType\n        };\n    }\n\n    protected createDisposeClientSessionParameters(): DisposeClientSessionParameters {\n        return {\n            clientSessionId: this.clientId\n        };\n    }\n\n    protected configureServeActions(initializeResult: InitializeResult): void {\n        const serverActions = initializeResult.serverActions[this.diagramType];\n        if (serverActions?.length === 0) {\n            throw new Error(`No server-handled actions could be derived from the initialize result for diagramType: ${this.diagramType}!`);\n        }\n        serverActions.forEach(action => this.registry.register(action, this));\n    }\n\n    protected messageReceived(message: ActionMessage): void {\n        if (this.clientId !== message.clientId) {\n            return;\n        }\n        const action = message.action;\n        ServerAction.mark(action);\n        this.logger.log(this, 'receiving', action);\n        this.actionDispatcher.dispatch(action);\n    }\n\n    override initialize(registry: GLSPActionHandlerRegistry): void {\n        // Registering actions here is discouraged and it's recommended\n        // to implemented dedicated action handlers.\n        if (!this.clientId) {\n            this.clientId = this.options.clientId ?? this.viewerOptions.baseDiv;\n        }\n\n        this.registry = registry;\n    }\n\n    handle(action: Action): void {\n        // Handling additional actions here is discouraged and it's recommended\n        // to implemented dedicated action handlers.\n        if (this.shouldForwardToServer(action)) {\n            this.forwardToServer(action);\n        }\n    }\n\n    protected forwardToServer(action: Action): void {\n        const message: ActionMessage = {\n            clientId: this.clientId,\n            action: action\n        };\n        this.logger.log(this, 'sending', message);\n        if (this.glspClient) {\n            this.glspClient.sendActionMessage(message);\n        } else {\n            throw new Error('GLSPClient is not connected');\n        }\n    }\n\n    protected shouldForwardToServer(action: Action): boolean {\n        return !ServerAction.is(action);\n    }\n\n    commitModel(newRoot: GModelRootSchema): GModelRootSchema {\n        /* In GLSP the model update flow is server-driven. i.e. changes to the graphical model are applied\n         * on server-side an only the server can issue a model update.\n         * The internal/local model should never be committed back to the model source i.e. GLSP server.\n         * => no-op implementation that simply returns the `newRoot`\n         */\n        this._currentRoot = newRoot;\n        return newRoot;\n    }\n\n    override get model(): GModelRootSchema {\n        return this._currentRoot;\n    }\n\n    @preDestroy()\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, multiInject, optional, postConstruct } from 'inversify';\nimport {\n    AnyObject,\n    ApplicationIdProvider,\n    Args,\n    EMPTY_ROOT,\n    GLSPClient,\n    InitializeParameters,\n    MaybePromise,\n    RequestModelAction,\n    SetModelAction,\n    StatusAction,\n    TYPES,\n    hasNumberProp\n} from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../action-dispatcher';\nimport { Ranked } from '../ranked';\nimport { GLSPModelSource } from './glsp-model-source';\nimport { ModelInitializationConstraint } from './model-initialization-constraint';\n\n/**\n * Configuration options for a specific GLSP diagram instance.\n */\nexport interface IDiagramOptions {\n    /**\n     * Unique id associated with this diagram. Used on the server side to identify the\n     * corresponding client session.\n     */\n    clientId: string;\n    /**\n     * The diagram type i.e. diagram language this diagram is associated with.\n     */\n    diagramType: string;\n    /**\n     * The provider function to retrieve the GLSP client used by this diagram to communicate with the server.\n     * Multiple invocations of the provder function should always return the same `GLSPClient` instance.\n     */\n    glspClientProvider: () => Promise<GLSPClient>;\n    /**\n     * The file source URI associated with this diagram.\n     */\n    sourceUri?: string;\n    /**\n     * The initial edit mode of diagram. Defaults to `editable`.\n     */\n    editMode?: string;\n}\n\n/**\n * Services that implement startup hooks which are invoked during the {@link DiagramLoader.load} process.\n * Typically used to dispatch additional initial actions and/or activate UI extensions on startup.\n * Execution order is derived by the `rank` property of the service. If not present, the {@link Ranked.DEFAULT_RANK} will be assumed.\n */\nexport interface IDiagramStartup extends Partial<Ranked> {\n    /**\n     * Hook for services that should be executed before the underlying GLSP client is configured and the server is initialized.\n     */\n    preInitialize?(): MaybePromise<void>;\n    /**\n     * Hook for services that should be executed before the initial model loading request (i.e. `RequestModelAction`) but\n     * after the underlying GLSP client has been configured and the server is initialized.\n     */\n    preRequestModel?(): MaybePromise<void>;\n    /**\n     * Hook for services that should be executed after the initial model loading request (i.e. `RequestModelAction`).\n     * Note that this hook is invoked directly after the `RequestModelAction` has been dispatched. It does not necessarily wait\n     * until the client-server update roundtrip is completed. If you need to wait until the diagram is fully initialized use the\n     * {@link postModelInitialization} hook.\n     */\n    postRequestModel?(): MaybePromise<void>;\n    /* Hook for services that should be executed after the diagram model is fully initialized\n     * (i.e. `ModelInitializationConstraint` is completed).\n     */\n    postModelInitialization?(): MaybePromise<void>;\n}\n\nexport namespace IDiagramStartup {\n    export function is(object: unknown): object is IDiagramStartup {\n        return (\n            AnyObject.is(object) &&\n            hasNumberProp(object, 'rank', true) &&\n            ('preInitialize' in object ||\n                'preRequestModel' in object ||\n                'postRequestModel' in object ||\n                'postModelInitialization' in object)\n        );\n    }\n}\n\nexport interface DiagramLoadingOptions {\n    /**\n     * Optional custom options that should be used the initial {@link RequestModelAction}.\n     * These options will be merged with the default options (`diagramType` and `sourceUri`).\n     * Defaults to an empty object if not defined.\n     */\n    requestModelOptions?: Args;\n\n    /**\n     * Optional partial {@link InitializeParameters} that should be used for `initializeServer` request if the underlying\n     * {@link GLSPClient} has not been initialized yet.\n     */\n    initializeParameters?: Partial<InitializeParameters>;\n\n    /**\n     * Flag to enable/disable client side notifications during the loading process.\n     * Defaults to `true` if not defined\n     */\n    enableNotifications?: boolean;\n}\n\nexport interface ResolvedDiagramLoadingOptions {\n    requestModelOptions: Args;\n    initializeParameters: InitializeParameters;\n    enableNotifications: boolean;\n}\n\n/**\n * The central component responsible for initializing the diagram and loading the graphical model\n * from the GLSP server.\n * Invoking the {@link DiagramLoader.load} method is typically the first operation that is executed after\n * a diagram DI container has been created.\n */\n@injectable()\nexport class DiagramLoader {\n    @inject(TYPES.IDiagramOptions)\n    protected options: IDiagramOptions;\n\n    @inject(GLSPActionDispatcher)\n    protected actionDispatcher: GLSPActionDispatcher;\n\n    @multiInject(TYPES.IDiagramStartup)\n    @optional()\n    protected diagramStartups: IDiagramStartup[] = [];\n\n    @inject(GLSPModelSource)\n    protected modelSource: GLSPModelSource;\n\n    @inject(ModelInitializationConstraint)\n    protected modelInitializationConstraint: ModelInitializationConstraint;\n\n    @postConstruct()\n    protected postConstruct(): void {\n        this.diagramStartups.sort((a, b) => Ranked.getRank(a) - Ranked.getRank(b));\n    }\n\n    async load(options: DiagramLoadingOptions = {}): Promise<void> {\n        const resolvedOptions: ResolvedDiagramLoadingOptions = {\n            requestModelOptions: {\n                sourceUri: this.options.sourceUri ?? '',\n                diagramType: this.options.diagramType,\n                ...options.requestModelOptions\n            },\n            initializeParameters: {\n                applicationId: ApplicationIdProvider.get(),\n                protocolVersion: GLSPClient.protocolVersion,\n                ...options.initializeParameters\n            },\n            enableNotifications: options.enableNotifications ?? true\n        };\n        // Set empty place holder model until actual model from server is available\n        await this.actionDispatcher.dispatch(SetModelAction.create(EMPTY_ROOT));\n        await this.invokeStartupHook('preInitialize');\n        await this.initialize(resolvedOptions);\n        await this.invokeStartupHook('preRequestModel');\n        await this.requestModel(resolvedOptions);\n        await this.invokeStartupHook('postRequestModel');\n        this.modelInitializationConstraint.onInitialized(() => this.invokeStartupHook('postModelInitialization'));\n    }\n\n    protected async invokeStartupHook(hook: keyof Omit<IDiagramStartup, 'rank'>): Promise<void> {\n        for (const startup of this.diagramStartups) {\n            await startup[hook]?.();\n        }\n    }\n\n    protected async requestModel(options: ResolvedDiagramLoadingOptions): Promise<void> {\n        const response = await this.actionDispatcher.request<SetModelAction>(\n            RequestModelAction.create({ options: options.requestModelOptions })\n        );\n        return this.actionDispatcher.dispatch(response);\n    }\n\n    protected async initialize(options: ResolvedDiagramLoadingOptions): Promise<void> {\n        if (options.enableNotifications) {\n            await this.actionDispatcher.dispatch(StatusAction.create('Initializing...', { severity: 'INFO' }));\n        }\n\n        const glspClient = await this.options.glspClientProvider();\n        await glspClient.start();\n        if (!glspClient.initializeResult) {\n            await glspClient.initializeServer(options.initializeParameters);\n        }\n        this.modelSource.configure(glspClient);\n\n        if (options.enableNotifications) {\n            this.actionDispatcher.dispatch(StatusAction.create('', { severity: 'NONE' }));\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { GModelElement, GModelElementConstructor, SModelRegistry } from '@eclipse-glsp/sprotty';\nimport { injectable } from 'inversify';\nimport { argsFeature } from '../args-feature';\n\n/**\n *  Model element classes registered here are considered automatically when constructing a model from its schema.\n *  Use the `configureModelElement` utility function to register a model element and its target render view in the\n *  corresponding factories.\n */\n@injectable()\nexport class GModelRegistry extends SModelRegistry {\n    /* Overwrite the `register` method to only log an info message (instead of thrown an error) if\n       an existing registration is overwritten */\n    override register(key: string, factory: (u: void) => GModelElement): void {\n        if (key === undefined) {\n            throw new Error('Key is undefined');\n        }\n        if (this.hasKey(key)) {\n            // do not throw error but log overwriting\n            console.log(`Factory for model element '${key}' will be overwritten.`);\n        }\n        this.elements.set(key, factory);\n    }\n\n    protected override getDefaultFeatures(constr: GModelElementConstructor): readonly symbol[] | undefined {\n        // Add the argsFeature per default to all model elements\n        const features = [...(super.getDefaultFeatures(constr) ?? [])];\n        if (!features.includes(argsFeature)) {\n            features.push(argsFeature);\n        }\n        return features;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { MouseListener, GModelElement } from '@eclipse-glsp/sprotty';\n\n/**\n * A mouse listener that clears the document selection on click\n *\n * Clicking on SVG elements doesn't update the document selection. In the context of diagramming\n * with GLSP, this is unnatural, as the user would expect that clicking in the diagram (e.g. to\n * select a diagram element) would clear any other selection state in the DOM. From a technical\n * point of view, an active selection in the document after clicking into the diagram may also\n * lead to bogus target elements in certain browser events, such as clipboard events, etc.\n *\n * This listener helps to overcome this problem by actively clearing any existing selection in\n * the document, if the user clicks into the diagram.\n */\n@injectable()\nexport class SelectionClearingMouseListener extends MouseListener {\n    override mouseDown(_target: GModelElement, event: MouseEvent): never[] {\n        const selection = document.getSelection();\n        // eslint-disable-next-line no-null/no-null\n        if (selection === null) {\n            return [];\n        }\n        selection.removeAllRanges();\n        selection.addRange(document.createRange());\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Action, AnyObject, hasArrayProp, hasBooleanProp, hasFunctionProp, hasStringProp } from '@eclipse-glsp/sprotty';\n\n/**\n * Action to enable the tools of the specified `toolIds`.\n */\nexport interface EnableToolsAction extends Action {\n    kind: typeof EnableToolsAction.KIND;\n    toolIds: string[];\n}\nexport namespace EnableToolsAction {\n    export const KIND = 'enable-tools';\n\n    export function is(object: unknown): object is EnableToolsAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'toolIds');\n    }\n\n    export function create(toolIds: string[]): EnableToolsAction {\n        return {\n            kind: KIND,\n            toolIds\n        };\n    }\n}\n\n/**\n * Action to disable the currently active tools and enable the default tools instead.\n */\nexport interface EnableDefaultToolsAction extends Action {\n    kind: typeof EnableDefaultToolsAction.KIND;\n}\nexport namespace EnableDefaultToolsAction {\n    export const KIND = 'enable-default-tools';\n\n    export function is(object: unknown): object is EnableToolsAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(): EnableDefaultToolsAction {\n        return {\n            kind: KIND\n        };\n    }\n}\n\n/** A tool that can be managed by a `ToolManager`.\n */\nexport interface Tool {\n    readonly id: string;\n    /* Notifies the tool to become active. */\n    enable(): void;\n    /* Notifies the tool to become inactive. */\n    disable(): void;\n    /** Optional flag indicating wether this tool is an edit tool.\n     *  Edit tools are inactive when a diagram is in `readonly` edit mode.\n     */\n    isEditTool?: boolean;\n}\n\nexport namespace Tool {\n    export function is(object: unknown): object is Tool {\n        return (\n            AnyObject.is(object) &&\n            hasStringProp(object, 'id') &&\n            hasFunctionProp(object, 'enable') &&\n            hasFunctionProp(object, 'disable') &&\n            hasBooleanProp(object, 'isEditTool', true)\n        );\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, multiInject, optional } from 'inversify';\nimport {\n    Action,\n    EditMode,\n    IActionHandler,\n    ICommand,\n    KeyListener,\n    GModelElement,\n    TYPES,\n    distinctAdd,\n    matchesKeystroke\n} from '@eclipse-glsp/sprotty';\nimport { EditorContextService, EditorContextServiceProvider } from '../editor-context-service';\nimport { EnableDefaultToolsAction, EnableToolsAction, Tool } from './tool';\n/**\n * A tool manager coordinates the state of tools in the context of an editor.\n *\n * One instance of a tool manager is intended per editor, coordinating the state of all tools within\n * this editor. A tool can be active or not. A tool manager ensures that activating a set of tools\n * will disable all other tools, allowing them to invoke behavior when they become enabled or disabled.\n */\nexport interface IToolManager {\n    /** All tools managed by this tool manager. */\n    readonly managedTools: Tool[];\n\n    /** The tools that are enabled by default, whenever no other tool is enabled. */\n    readonly defaultTools: Tool[];\n\n    /** The currently active tools, which are either specifically enabled tools, or the default tools. */\n    readonly activeTools: Tool[];\n\n    /**\n     * Enables the tools with the specified `toolIds`.\n     * Therefore, this manager first disables currently active tools and then enable the\n     * tools indicated in `toolIds`, making them the currently active tools. If this manager\n     * doesn't manage one or more tools specified in `toolIds`, it'll do nothing. If not a\n     * single tool that shall be enabled was found in the managed tools, it'll fall back to\n     * the default tools.\n     *\n     * @param tools The tools to be enabled.\n     */\n    enable(toolIds: string[]): void;\n\n    /**\n     * Enables all default tools.\n     */\n    enableDefaultTools(): void;\n\n    /** Disables all currently active tools. After this call, no tool will be active anymore. */\n    disableActiveTools(): void;\n\n    registerDefaultTools(...tools: Tool[]): void;\n\n    registerTools(...tools: Tool[]): void;\n}\n\n/**\n * The default {@link IToolManager} implementation. Allows\n * registration of tools via Dependency Injection.\n */\n@injectable()\nexport class ToolManager implements IToolManager {\n    readonly actives: Tool[] = [];\n\n    protected editorContext?: EditorContextService;\n\n    constructor(\n        @multiInject(TYPES.ITool)\n        @optional()\n        readonly tools: Tool[] = [],\n        @multiInject(TYPES.IDefaultTool)\n        @optional()\n        readonly defaultTools: Tool[],\n        @inject(TYPES.IEditorContextServiceProvider) protected contextServiceProvider: EditorContextServiceProvider\n    ) {\n        this.registerTools(...this.tools);\n        this.registerDefaultTools(...this.defaultTools);\n        this.enableDefaultTools();\n        this.contextServiceProvider().then(editorContext => {\n            editorContext.onEditModeChanged(change => this.editModeChanged(change.newValue, change.oldValue));\n            this.editorContext = editorContext;\n        });\n    }\n\n    get managedTools(): Tool[] {\n        return this.defaultTools.concat(this.tools);\n    }\n\n    get activeTools(): Tool[] {\n        return this.actives;\n    }\n\n    registerDefaultTools(...tools: Tool[]): void {\n        distinctAdd(this.defaultTools, ...tools);\n    }\n\n    registerTools(...tools: Tool[]): void {\n        distinctAdd(this.tools, ...tools);\n    }\n\n    disableActiveTools(): void {\n        this.actives.forEach(tool => tool.disable());\n        this.actives.splice(0, this.actives.length);\n    }\n\n    enableDefaultTools(): void {\n        this.enable(this.defaultTools.map(tool => tool.id));\n    }\n\n    enable(toolIds: string[]): void {\n        this.disableActiveTools();\n        let tools = toolIds.map(id => this.tool(id));\n        if (this.editorContext && this.editorContext.isReadonly) {\n            tools = tools.filter(tool => !tool?.isEditTool);\n        }\n        tools.forEach(tool => {\n            if (tool !== undefined) {\n                tool.enable();\n                this.actives.push(tool);\n            }\n        });\n    }\n\n    tool(toolId: string): Tool | undefined {\n        return this.managedTools.find(tool => tool.id === toolId);\n    }\n\n    disableEditTools(): void {\n        this.disableActiveTools();\n        this.enable(this.defaultTools.filter(tool => !tool.isEditTool).map(tool => tool.id));\n    }\n\n    editModeChanged(newValue: string, oldValue: string): void {\n        if (oldValue === newValue) {\n            return;\n        }\n        if (newValue === EditMode.READONLY) {\n            this.disableEditTools();\n        } else if (newValue === EditMode.EDITABLE) {\n            this.enableDefaultTools();\n        }\n    }\n}\n\n@injectable()\nexport class ToolManagerActionHandler implements IActionHandler {\n    @inject(TYPES.IToolManager)\n    readonly toolManager: IToolManager;\n\n    handle(action: Action): void | ICommand | Action {\n        if (EnableDefaultToolsAction.is(action)) {\n            this.toolManager.enableDefaultTools();\n        } else if (EnableToolsAction.is(action)) {\n            this.toolManager.enable((action as EnableToolsAction).toolIds);\n        }\n    }\n}\n\n@injectable()\nexport class DefaultToolsEnablingKeyListener extends KeyListener {\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'Escape')) {\n            return [EnableDefaultToolsAction.create()];\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable, multiInject, optional } from 'inversify';\nimport { Action, Disposable, MouseListener, MouseTool, GModelElement, GModelRoot, TYPES } from '@eclipse-glsp/sprotty';\nimport { Ranked } from '../ranked';\n\n/**\n * Custom helper type to declare the explicit mouse listener methods\n * of {@link MouseListener} i.e. omitting the `decorate` method.\n */\ntype MouseListenerMethods = keyof Omit<MouseListener, 'decorate'>;\n\n@injectable()\nexport class GLSPMouseTool extends MouseTool {\n    protected rankedMouseListeners: Map<number, MouseListener[]>;\n\n    constructor(@multiInject(TYPES.MouseListener) @optional() protected override mouseListeners: MouseListener[] = []) {\n        super(mouseListeners);\n        this.rankedMouseListeners = groupBy(mouseListeners, listener => Ranked.getRank(listener));\n    }\n\n    override register(mouseListener: MouseListener): void {\n        super.register(mouseListener);\n        this.rankedMouseListeners = groupBy(this.mouseListeners, listener => Ranked.getRank(listener));\n    }\n\n    registerListener(mouseListener: MouseListener): Disposable {\n        this.register(mouseListener);\n        return Disposable.create(() => this.deregister(mouseListener));\n    }\n\n    override deregister(mouseListener: MouseListener): void {\n        super.deregister(mouseListener);\n        this.rankedMouseListeners = groupBy(this.mouseListeners, listener => Ranked.getRank(listener));\n    }\n\n    protected override handleEvent<K extends MouseListenerMethods>(methodName: K, model: GModelRoot, event: MouseEvent): void {\n        this.focusOnMouseEvent(methodName, model);\n        const element = this.getTargetElement(model, event);\n        if (!element) {\n            return;\n        }\n        this.notifyListenersByRank(element, methodName, event);\n    }\n\n    protected async notifyListenersByRank<K extends MouseListenerMethods>(\n        element: GModelElement,\n        methodName: K,\n        event: MouseEvent\n    ): Promise<void> {\n        for (const rank of this.rankedMouseListeners) {\n            await this.dispatchActions(rank[1], methodName, element, event);\n        }\n    }\n\n    protected async dispatchActions<K extends MouseListenerMethods>(\n        mouseListeners: MouseListener[],\n        methodName: K,\n        element: GModelElement,\n        event: MouseEvent\n    ): Promise<void> {\n        const actions = mouseListeners.map(listener => listener[methodName](element, event as WheelEvent)).reduce((a, b) => a.concat(b));\n        if (actions.length > 0) {\n            event.preventDefault();\n            for (const actionOrPromise of actions) {\n                if (Action.is(actionOrPromise)) {\n                    await this.actionDispatcher.dispatch(actionOrPromise);\n                } else {\n                    actionOrPromise.then((action: Action) => {\n                        this.actionDispatcher.dispatch(action);\n                    });\n                }\n            }\n        }\n    }\n}\n\nfunction groupBy<K, T>(array: Array<T>, keyFunction: (x: T) => K): Map<K, T[]> {\n    const unsortedMap = array.reduce((result: Map<K, T[]>, item: T) => {\n        const key = keyFunction(item);\n        if (!result.has(key)) {\n            result.set(key, [item]);\n        } else {\n            const entries = result.get(key);\n            if (entries) {\n                entries.push(item);\n            }\n        }\n        return result;\n    }, new Map<K, T[]>());\n    return new Map<K, T[]>([...unsortedMap.entries()].sort());\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { IView, ViewRegistry } from '@eclipse-glsp/sprotty';\nimport { injectable } from 'inversify';\n\n/**\n * Allows to look up the IView for a given GModelElement based on its type.\n */\n@injectable()\nexport class GViewRegistry extends ViewRegistry {\n    /* Overwrite the `register` method to only log an info message (instead of thrown an error) if\n       an existing registration is overwritten */\n    override register(key: string, instance: IView): void {\n        if (key === undefined) {\n            throw new Error('Key is undefined');\n        }\n        if (this.hasKey(key)) {\n            // do not throw error but log overwriting\n            console.log(`View instance for type '${key}' will be overwritten.`);\n        }\n        this.elements.set(key, instance);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { Action, CommandExecutionContext, GModelElement, GModelRoot, TYPES, hasArrayProp } from '@eclipse-glsp/sprotty';\nimport { addCssClasses, getElements, removeCssClasses } from '../../utils/gmodel-util';\nimport { FeedbackCommand } from './feedback-command';\n\nexport interface ModifyCSSFeedbackAction extends Action {\n    kind: typeof ModifyCSSFeedbackAction.KIND;\n\n    elementIds?: string[];\n    add?: string[];\n    remove?: string[];\n}\n\nexport namespace ModifyCSSFeedbackAction {\n    export const KIND = 'modifyCSSFeedback';\n\n    export function is(object: any): object is ModifyCSSFeedbackAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'elementIds');\n    }\n\n    export function create(options: { elements?: (string | GModelElement)[]; add?: string[]; remove?: string[] }): ModifyCSSFeedbackAction {\n        const { elements, ...rest } = options;\n        const elementIds = elements ? elements.map(element => (typeof element === 'string' ? element : element.id)) : undefined;\n        return {\n            kind: KIND,\n            elementIds,\n            ...rest\n        };\n    }\n}\n\n@injectable()\nexport class ModifyCssFeedbackCommand extends FeedbackCommand {\n    static readonly KIND = ModifyCSSFeedbackAction.KIND;\n\n    constructor(@inject(TYPES.Action) readonly action: ModifyCSSFeedbackAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): GModelRoot {\n        const elements = this.action.elementIds ? getElements(context.root.index, this.action.elementIds) : [context.root];\n\n        elements.forEach(e => {\n            if (this.action.remove) {\n                removeCssClasses(e, this.action.remove);\n            }\n\n            if (this.action.add) {\n                addCssClasses(e, this.action.add);\n            }\n        });\n\n        return context.root;\n    }\n}\n\nexport enum CursorCSS {\n    DEFAULT = 'default-mode',\n    OVERLAP_FORBIDDEN = 'overlap-forbidden-mode',\n    NODE_CREATION = 'node-creation-mode',\n    EDGE_CREATION_SOURCE = 'edge-creation-select-source-mode',\n    EDGE_CREATION_TARGET = 'edge-creation-select-target-mode',\n    EDGE_RECONNECT = 'edge-reconnect-select-target-mode',\n    EDGE_CHECK_PENDING = 'edge-check-pending-mode',\n    OPERATION_NOT_ALLOWED = 'edge-modification-not-allowed-mode',\n    ELEMENT_DELETION = 'element-deletion-mode',\n    RESIZE_NESW = 'resize-nesw-mode',\n    RESIZE_NWSE = 'resize-nwse-mode',\n    MOVE = 'move-mode',\n    MARQUEE = 'marquee-mode'\n}\n\nexport function cursorFeedbackAction(cursorCss?: CursorCSS): ModifyCSSFeedbackAction {\n    const add = [];\n    if (cursorCss) {\n        add.push(cursorCss);\n    }\n    return ModifyCSSFeedbackAction.create({ add, remove: Object.values(CursorCSS) });\n}\n\nexport function applyCssClasses(element: GModelElement, ...add: string[]): ModifyCSSFeedbackAction {\n    return ModifyCSSFeedbackAction.create({ elements: [element], add });\n}\n\nexport function deleteCssClasses(element: GModelElement, ...remove: string[]): ModifyCSSFeedbackAction {\n    return ModifyCSSFeedbackAction.create({ elements: [element], remove });\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { GModelElement, GModelElementSchema } from '@eclipse-glsp/sprotty';\n\nexport const containerFeature = Symbol('containable');\n\n/**\n *  Feature extension interface for {@link containerFeature}.\n */\nexport interface Containable {\n    isContainableElement(input: GModelElement | GModelElementSchema | string): boolean;\n}\n\nexport function isContainable(element: GModelElement): element is GModelElement & Containable {\n    return element.hasFeature(containerFeature);\n}\n\nexport const reparentFeature = Symbol('reparentFeature');\n\n/**\n *  Feature extension interface for {@link reparentFeature}.\n */\nexport interface Reparentable {}\n\nexport function isReparentable(element: GModelElement): element is GModelElement & Reparentable {\n    return element.hasFeature(reparentFeature);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    Args,\n    Bounds,\n    GModelElementSchema,\n    GShapeElement,\n    Point,\n    SEdgeImpl,\n    SGraphImpl,\n    getRouteBounds,\n    isBounds\n} from '@eclipse-glsp/sprotty';\nimport { ArgsAware, argsFeature } from './base/args-feature';\nimport { Containable, containerFeature } from './features/hints/model';\n\nexport class GGraph extends SGraphImpl implements Containable, ArgsAware {\n    static override readonly DEFAULT_FEATURES = [...SGraphImpl.DEFAULT_FEATURES, containerFeature, argsFeature];\n    args?: Args;\n    isContainableElement(_input: string | GShapeElement | GModelElementSchema): boolean {\n        return true;\n    }\n}\n\nexport class GEdge extends SEdgeImpl implements ArgsAware {\n    static override readonly DEFAULT_FEATURES = [...SEdgeImpl.DEFAULT_FEATURES, argsFeature];\n\n    args?: Args;\n\n    override localToParent(point: Point | Bounds): Bounds {\n        const bounds = getRouteBounds(this.routingPoints);\n        const result = {\n            x: point.x + bounds.x,\n            y: point.y + bounds.y,\n            width: -1,\n            height: -1\n        };\n        if (isBounds(point)) {\n            result.width = point.width;\n            result.height = point.height;\n        }\n        return result;\n    }\n\n    override parentToLocal(point: Point | Bounds): Bounds {\n        const bounds = getRouteBounds(this.routingPoints);\n        const result = {\n            x: point.x - bounds.x,\n            y: point.y - bounds.y,\n            width: -1,\n            height: -1\n        };\n        if (isBounds(point)) {\n            result.width = point.width;\n            result.height = point.height;\n        }\n        return result;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    Bounds,\n    BoundsAwareViewportCommand,\n    Dimension,\n    GChildElement,\n    GModelElement,\n    GModelRoot,\n    TYPES,\n    Viewport,\n    getRouteBounds,\n    hasArrayProp,\n    isViewport\n} from '@eclipse-glsp/sprotty';\nimport { calcElementAndRoute } from '../../utils/gmodel-util';\nimport { GEdge } from '../../model';\n\nexport interface RepositionAction extends Action {\n    kind: typeof RepositionAction.KIND;\n    elementIDs: string[];\n}\n\nexport namespace RepositionAction {\n    export const KIND = 'repositionAction';\n\n    export function is(object: any): object is RepositionAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'elementIDs');\n    }\n\n    export function create(elementIDs: string[]): RepositionAction {\n        return {\n            kind: KIND,\n            elementIDs\n        };\n    }\n}\n\n/**\n * Moves the viewport to an unvisible element, while maintaining the current zoom level.\n */\n@injectable()\nexport class RepositionCommand extends BoundsAwareViewportCommand {\n    static readonly KIND = RepositionAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: RepositionAction) {\n        super(true);\n    }\n\n    protected override boundsInViewport(element: GModelElement, bounds: Bounds, viewport: GModelRoot & Viewport): Bounds {\n        if (element instanceof GChildElement && element.parent !== viewport) {\n            return this.boundsInViewport(element.parent, element.parent.localToParent(bounds) as Bounds, viewport);\n        } else if (element instanceof GEdge) {\n            const edgeBounds = getRouteBounds(calcElementAndRoute(element).newRoutingPoints ?? []);\n\n            if (element instanceof GChildElement && element.parent !== viewport) {\n                return this.boundsInViewport(element.parent, element.parent.localToParent(edgeBounds), viewport);\n            }\n\n            return edgeBounds;\n        }\n\n        return bounds;\n    }\n\n    getElementIds(): string[] {\n        return this.action.elementIDs;\n    }\n\n    getNewViewport(bounds: Bounds, model: GModelRoot): Viewport | undefined {\n        if (!Dimension.isValid(model.canvasBounds)) {\n            return undefined;\n        }\n\n        if (isViewport(model)) {\n            const zoom = model.zoom;\n            const c = Bounds.center(bounds);\n\n            if (this.isFullyVisible(bounds, model)) {\n                return undefined;\n            } else {\n                return {\n                    scroll: {\n                        x: c.x - (0.5 * model.canvasBounds.width) / zoom,\n                        y: c.y - (0.5 * model.canvasBounds.height) / zoom\n                    },\n                    zoom: zoom\n                };\n            }\n        }\n\n        return undefined;\n    }\n\n    protected isFullyVisible(bounds: Bounds, viewport: GModelRoot & Viewport): boolean {\n        return (\n            bounds.x >= viewport.scroll.x &&\n            bounds.x + bounds.width <= viewport.scroll.x + viewport.canvasBounds.width / viewport.zoom &&\n            bounds.y >= viewport.scroll.y &&\n            bounds.y + bounds.height <= viewport.scroll.y + viewport.canvasBounds.height / viewport.zoom\n        );\n    }\n}\n", "/**\n * @license\n * Lodash <https://lodash.com/>\n * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n;(function() {\n\n  /** Used as a safe reference for `undefined` in pre-ES5 environments. */\n  var undefined;\n\n  /** Used as the semantic version number. */\n  var VERSION = '4.17.21';\n\n  /** Used as the size to enable large array optimizations. */\n  var LARGE_ARRAY_SIZE = 200;\n\n  /** Error message constants. */\n  var CORE_ERROR_TEXT = 'Unsupported core-js use. Try https://npms.io/search?q=ponyfill.',\n      FUNC_ERROR_TEXT = 'Expected a function',\n      INVALID_TEMPL_VAR_ERROR_TEXT = 'Invalid `variable` option passed into `_.template`';\n\n  /** Used to stand-in for `undefined` hash values. */\n  var HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n  /** Used as the maximum memoize cache size. */\n  var MAX_MEMOIZE_SIZE = 500;\n\n  /** Used as the internal argument placeholder. */\n  var PLACEHOLDER = '__lodash_placeholder__';\n\n  /** Used to compose bitmasks for cloning. */\n  var CLONE_DEEP_FLAG = 1,\n      CLONE_FLAT_FLAG = 2,\n      CLONE_SYMBOLS_FLAG = 4;\n\n  /** Used to compose bitmasks for value comparisons. */\n  var COMPARE_PARTIAL_FLAG = 1,\n      COMPARE_UNORDERED_FLAG = 2;\n\n  /** Used to compose bitmasks for function metadata. */\n  var WRAP_BIND_FLAG = 1,\n      WRAP_BIND_KEY_FLAG = 2,\n      WRAP_CURRY_BOUND_FLAG = 4,\n      WRAP_CURRY_FLAG = 8,\n      WRAP_CURRY_RIGHT_FLAG = 16,\n      WRAP_PARTIAL_FLAG = 32,\n      WRAP_PARTIAL_RIGHT_FLAG = 64,\n      WRAP_ARY_FLAG = 128,\n      WRAP_REARG_FLAG = 256,\n      WRAP_FLIP_FLAG = 512;\n\n  /** Used as default options for `_.truncate`. */\n  var DEFAULT_TRUNC_LENGTH = 30,\n      DEFAULT_TRUNC_OMISSION = '...';\n\n  /** Used to detect hot functions by number of calls within a span of milliseconds. */\n  var HOT_COUNT = 800,\n      HOT_SPAN = 16;\n\n  /** Used to indicate the type of lazy iteratees. */\n  var LAZY_FILTER_FLAG = 1,\n      LAZY_MAP_FLAG = 2,\n      LAZY_WHILE_FLAG = 3;\n\n  /** Used as references for various `Number` constants. */\n  var INFINITY = 1 / 0,\n      MAX_SAFE_INTEGER = 9007199254740991,\n      MAX_INTEGER = 1.7976931348623157e+308,\n      NAN = 0 / 0;\n\n  /** Used as references for the maximum length and index of an array. */\n  var MAX_ARRAY_LENGTH = 4294967295,\n      MAX_ARRAY_INDEX = MAX_ARRAY_LENGTH - 1,\n      HALF_MAX_ARRAY_LENGTH = MAX_ARRAY_LENGTH >>> 1;\n\n  /** Used to associate wrap methods with their bit flags. */\n  var wrapFlags = [\n    ['ary', WRAP_ARY_FLAG],\n    ['bind', WRAP_BIND_FLAG],\n    ['bindKey', WRAP_BIND_KEY_FLAG],\n    ['curry', WRAP_CURRY_FLAG],\n    ['curryRight', WRAP_CURRY_RIGHT_FLAG],\n    ['flip', WRAP_FLIP_FLAG],\n    ['partial', WRAP_PARTIAL_FLAG],\n    ['partialRight', WRAP_PARTIAL_RIGHT_FLAG],\n    ['rearg', WRAP_REARG_FLAG]\n  ];\n\n  /** `Object#toString` result references. */\n  var argsTag = '[object Arguments]',\n      arrayTag = '[object Array]',\n      asyncTag = '[object AsyncFunction]',\n      boolTag = '[object Boolean]',\n      dateTag = '[object Date]',\n      domExcTag = '[object DOMException]',\n      errorTag = '[object Error]',\n      funcTag = '[object Function]',\n      genTag = '[object GeneratorFunction]',\n      mapTag = '[object Map]',\n      numberTag = '[object Number]',\n      nullTag = '[object Null]',\n      objectTag = '[object Object]',\n      promiseTag = '[object Promise]',\n      proxyTag = '[object Proxy]',\n      regexpTag = '[object RegExp]',\n      setTag = '[object Set]',\n      stringTag = '[object String]',\n      symbolTag = '[object Symbol]',\n      undefinedTag = '[object Undefined]',\n      weakMapTag = '[object WeakMap]',\n      weakSetTag = '[object WeakSet]';\n\n  var arrayBufferTag = '[object ArrayBuffer]',\n      dataViewTag = '[object DataView]',\n      float32Tag = '[object Float32Array]',\n      float64Tag = '[object Float64Array]',\n      int8Tag = '[object Int8Array]',\n      int16Tag = '[object Int16Array]',\n      int32Tag = '[object Int32Array]',\n      uint8Tag = '[object Uint8Array]',\n      uint8ClampedTag = '[object Uint8ClampedArray]',\n      uint16Tag = '[object Uint16Array]',\n      uint32Tag = '[object Uint32Array]';\n\n  /** Used to match empty string literals in compiled template source. */\n  var reEmptyStringLeading = /\\b__p \\+= '';/g,\n      reEmptyStringMiddle = /\\b(__p \\+=) '' \\+/g,\n      reEmptyStringTrailing = /(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g;\n\n  /** Used to match HTML entities and HTML characters. */\n  var reEscapedHtml = /&(?:amp|lt|gt|quot|#39);/g,\n      reUnescapedHtml = /[&<>\"']/g,\n      reHasEscapedHtml = RegExp(reEscapedHtml.source),\n      reHasUnescapedHtml = RegExp(reUnescapedHtml.source);\n\n  /** Used to match template delimiters. */\n  var reEscape = /<%-([\\s\\S]+?)%>/g,\n      reEvaluate = /<%([\\s\\S]+?)%>/g,\n      reInterpolate = /<%=([\\s\\S]+?)%>/g;\n\n  /** Used to match property names within property paths. */\n  var reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n      reIsPlainProp = /^\\w*$/,\n      rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n  /**\n   * Used to match `RegExp`\n   * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n   */\n  var reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g,\n      reHasRegExpChar = RegExp(reRegExpChar.source);\n\n  /** Used to match leading whitespace. */\n  var reTrimStart = /^\\s+/;\n\n  /** Used to match a single whitespace character. */\n  var reWhitespace = /\\s/;\n\n  /** Used to match wrap detail comments. */\n  var reWrapComment = /\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/,\n      reWrapDetails = /\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,\n      reSplitDetails = /,? & /;\n\n  /** Used to match words composed of alphanumeric characters. */\n  var reAsciiWord = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\n\n  /**\n   * Used to validate the `validate` option in `_.template` variable.\n   *\n   * Forbids characters which could potentially change the meaning of the function argument definition:\n   * - \"(),\" (modification of function parameters)\n   * - \"=\" (default value)\n   * - \"[]{}\" (destructuring of function parameters)\n   * - \"/\" (beginning of a comment)\n   * - whitespace\n   */\n  var reForbiddenIdentifierChars = /[()=,{}\\[\\]\\/\\s]/;\n\n  /** Used to match backslashes in property paths. */\n  var reEscapeChar = /\\\\(\\\\)?/g;\n\n  /**\n   * Used to match\n   * [ES template delimiters](http://ecma-international.org/ecma-262/7.0/#sec-template-literal-lexical-components).\n   */\n  var reEsTemplate = /\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g;\n\n  /** Used to match `RegExp` flags from their coerced string values. */\n  var reFlags = /\\w*$/;\n\n  /** Used to detect bad signed hexadecimal string values. */\n  var reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n  /** Used to detect binary string values. */\n  var reIsBinary = /^0b[01]+$/i;\n\n  /** Used to detect host constructors (Safari). */\n  var reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n  /** Used to detect octal string values. */\n  var reIsOctal = /^0o[0-7]+$/i;\n\n  /** Used to detect unsigned integer values. */\n  var reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n  /** Used to match Latin Unicode letters (excluding mathematical operators). */\n  var reLatin = /[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g;\n\n  /** Used to ensure capturing order of template delimiters. */\n  var reNoMatch = /($^)/;\n\n  /** Used to match unescaped characters in compiled string literals. */\n  var reUnescapedString = /['\\n\\r\\u2028\\u2029\\\\]/g;\n\n  /** Used to compose unicode character classes. */\n  var rsAstralRange = '\\\\ud800-\\\\udfff',\n      rsComboMarksRange = '\\\\u0300-\\\\u036f',\n      reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n      rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n      rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n      rsDingbatRange = '\\\\u2700-\\\\u27bf',\n      rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff',\n      rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7',\n      rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf',\n      rsPunctuationRange = '\\\\u2000-\\\\u206f',\n      rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000',\n      rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde',\n      rsVarRange = '\\\\ufe0e\\\\ufe0f',\n      rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n  /** Used to compose unicode capture groups. */\n  var rsApos = \"['\\u2019]\",\n      rsAstral = '[' + rsAstralRange + ']',\n      rsBreak = '[' + rsBreakRange + ']',\n      rsCombo = '[' + rsComboRange + ']',\n      rsDigits = '\\\\d+',\n      rsDingbat = '[' + rsDingbatRange + ']',\n      rsLower = '[' + rsLowerRange + ']',\n      rsMisc = '[^' + rsAstralRange + rsBreakRange + rsDigits + rsDingbatRange + rsLowerRange + rsUpperRange + ']',\n      rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n      rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n      rsNonAstral = '[^' + rsAstralRange + ']',\n      rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n      rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n      rsUpper = '[' + rsUpperRange + ']',\n      rsZWJ = '\\\\u200d';\n\n  /** Used to compose unicode regexes. */\n  var rsMiscLower = '(?:' + rsLower + '|' + rsMisc + ')',\n      rsMiscUpper = '(?:' + rsUpper + '|' + rsMisc + ')',\n      rsOptContrLower = '(?:' + rsApos + '(?:d|ll|m|re|s|t|ve))?',\n      rsOptContrUpper = '(?:' + rsApos + '(?:D|LL|M|RE|S|T|VE))?',\n      reOptMod = rsModifier + '?',\n      rsOptVar = '[' + rsVarRange + ']?',\n      rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n      rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])',\n      rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])',\n      rsSeq = rsOptVar + reOptMod + rsOptJoin,\n      rsEmoji = '(?:' + [rsDingbat, rsRegional, rsSurrPair].join('|') + ')' + rsSeq,\n      rsSymbol = '(?:' + [rsNonAstral + rsCombo + '?', rsCombo, rsRegional, rsSurrPair, rsAstral].join('|') + ')';\n\n  /** Used to match apostrophes. */\n  var reApos = RegExp(rsApos, 'g');\n\n  /**\n   * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks) and\n   * [combining diacritical marks for symbols](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks_for_Symbols).\n   */\n  var reComboMark = RegExp(rsCombo, 'g');\n\n  /** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */\n  var reUnicode = RegExp(rsFitz + '(?=' + rsFitz + ')|' + rsSymbol + rsSeq, 'g');\n\n  /** Used to match complex or compound words. */\n  var reUnicodeWord = RegExp([\n    rsUpper + '?' + rsLower + '+' + rsOptContrLower + '(?=' + [rsBreak, rsUpper, '$'].join('|') + ')',\n    rsMiscUpper + '+' + rsOptContrUpper + '(?=' + [rsBreak, rsUpper + rsMiscLower, '$'].join('|') + ')',\n    rsUpper + '?' + rsMiscLower + '+' + rsOptContrLower,\n    rsUpper + '+' + rsOptContrUpper,\n    rsOrdUpper,\n    rsOrdLower,\n    rsDigits,\n    rsEmoji\n  ].join('|'), 'g');\n\n  /** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */\n  var reHasUnicode = RegExp('[' + rsZWJ + rsAstralRange  + rsComboRange + rsVarRange + ']');\n\n  /** Used to detect strings that need a more robust regexp to match words. */\n  var reHasUnicodeWord = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\n\n  /** Used to assign default `context` object properties. */\n  var contextProps = [\n    'Array', 'Buffer', 'DataView', 'Date', 'Error', 'Float32Array', 'Float64Array',\n    'Function', 'Int8Array', 'Int16Array', 'Int32Array', 'Map', 'Math', 'Object',\n    'Promise', 'RegExp', 'Set', 'String', 'Symbol', 'TypeError', 'Uint8Array',\n    'Uint8ClampedArray', 'Uint16Array', 'Uint32Array', 'WeakMap',\n    '_', 'clearTimeout', 'isFinite', 'parseInt', 'setTimeout'\n  ];\n\n  /** Used to make template sourceURLs easier to identify. */\n  var templateCounter = -1;\n\n  /** Used to identify `toStringTag` values of typed arrays. */\n  var typedArrayTags = {};\n  typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\n  typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\n  typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\n  typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\n  typedArrayTags[uint32Tag] = true;\n  typedArrayTags[argsTag] = typedArrayTags[arrayTag] =\n  typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\n  typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\n  typedArrayTags[errorTag] = typedArrayTags[funcTag] =\n  typedArrayTags[mapTag] = typedArrayTags[numberTag] =\n  typedArrayTags[objectTag] = typedArrayTags[regexpTag] =\n  typedArrayTags[setTag] = typedArrayTags[stringTag] =\n  typedArrayTags[weakMapTag] = false;\n\n  /** Used to identify `toStringTag` values supported by `_.clone`. */\n  var cloneableTags = {};\n  cloneableTags[argsTag] = cloneableTags[arrayTag] =\n  cloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\n  cloneableTags[boolTag] = cloneableTags[dateTag] =\n  cloneableTags[float32Tag] = cloneableTags[float64Tag] =\n  cloneableTags[int8Tag] = cloneableTags[int16Tag] =\n  cloneableTags[int32Tag] = cloneableTags[mapTag] =\n  cloneableTags[numberTag] = cloneableTags[objectTag] =\n  cloneableTags[regexpTag] = cloneableTags[setTag] =\n  cloneableTags[stringTag] = cloneableTags[symbolTag] =\n  cloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\n  cloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\n  cloneableTags[errorTag] = cloneableTags[funcTag] =\n  cloneableTags[weakMapTag] = false;\n\n  /** Used to map Latin Unicode letters to basic Latin letters. */\n  var deburredLetters = {\n    // Latin-1 Supplement block.\n    '\\xc0': 'A',  '\\xc1': 'A', '\\xc2': 'A', '\\xc3': 'A', '\\xc4': 'A', '\\xc5': 'A',\n    '\\xe0': 'a',  '\\xe1': 'a', '\\xe2': 'a', '\\xe3': 'a', '\\xe4': 'a', '\\xe5': 'a',\n    '\\xc7': 'C',  '\\xe7': 'c',\n    '\\xd0': 'D',  '\\xf0': 'd',\n    '\\xc8': 'E',  '\\xc9': 'E', '\\xca': 'E', '\\xcb': 'E',\n    '\\xe8': 'e',  '\\xe9': 'e', '\\xea': 'e', '\\xeb': 'e',\n    '\\xcc': 'I',  '\\xcd': 'I', '\\xce': 'I', '\\xcf': 'I',\n    '\\xec': 'i',  '\\xed': 'i', '\\xee': 'i', '\\xef': 'i',\n    '\\xd1': 'N',  '\\xf1': 'n',\n    '\\xd2': 'O',  '\\xd3': 'O', '\\xd4': 'O', '\\xd5': 'O', '\\xd6': 'O', '\\xd8': 'O',\n    '\\xf2': 'o',  '\\xf3': 'o', '\\xf4': 'o', '\\xf5': 'o', '\\xf6': 'o', '\\xf8': 'o',\n    '\\xd9': 'U',  '\\xda': 'U', '\\xdb': 'U', '\\xdc': 'U',\n    '\\xf9': 'u',  '\\xfa': 'u', '\\xfb': 'u', '\\xfc': 'u',\n    '\\xdd': 'Y',  '\\xfd': 'y', '\\xff': 'y',\n    '\\xc6': 'Ae', '\\xe6': 'ae',\n    '\\xde': 'Th', '\\xfe': 'th',\n    '\\xdf': 'ss',\n    // Latin Extended-A block.\n    '\\u0100': 'A',  '\\u0102': 'A', '\\u0104': 'A',\n    '\\u0101': 'a',  '\\u0103': 'a', '\\u0105': 'a',\n    '\\u0106': 'C',  '\\u0108': 'C', '\\u010a': 'C', '\\u010c': 'C',\n    '\\u0107': 'c',  '\\u0109': 'c', '\\u010b': 'c', '\\u010d': 'c',\n    '\\u010e': 'D',  '\\u0110': 'D', '\\u010f': 'd', '\\u0111': 'd',\n    '\\u0112': 'E',  '\\u0114': 'E', '\\u0116': 'E', '\\u0118': 'E', '\\u011a': 'E',\n    '\\u0113': 'e',  '\\u0115': 'e', '\\u0117': 'e', '\\u0119': 'e', '\\u011b': 'e',\n    '\\u011c': 'G',  '\\u011e': 'G', '\\u0120': 'G', '\\u0122': 'G',\n    '\\u011d': 'g',  '\\u011f': 'g', '\\u0121': 'g', '\\u0123': 'g',\n    '\\u0124': 'H',  '\\u0126': 'H', '\\u0125': 'h', '\\u0127': 'h',\n    '\\u0128': 'I',  '\\u012a': 'I', '\\u012c': 'I', '\\u012e': 'I', '\\u0130': 'I',\n    '\\u0129': 'i',  '\\u012b': 'i', '\\u012d': 'i', '\\u012f': 'i', '\\u0131': 'i',\n    '\\u0134': 'J',  '\\u0135': 'j',\n    '\\u0136': 'K',  '\\u0137': 'k', '\\u0138': 'k',\n    '\\u0139': 'L',  '\\u013b': 'L', '\\u013d': 'L', '\\u013f': 'L', '\\u0141': 'L',\n    '\\u013a': 'l',  '\\u013c': 'l', '\\u013e': 'l', '\\u0140': 'l', '\\u0142': 'l',\n    '\\u0143': 'N',  '\\u0145': 'N', '\\u0147': 'N', '\\u014a': 'N',\n    '\\u0144': 'n',  '\\u0146': 'n', '\\u0148': 'n', '\\u014b': 'n',\n    '\\u014c': 'O',  '\\u014e': 'O', '\\u0150': 'O',\n    '\\u014d': 'o',  '\\u014f': 'o', '\\u0151': 'o',\n    '\\u0154': 'R',  '\\u0156': 'R', '\\u0158': 'R',\n    '\\u0155': 'r',  '\\u0157': 'r', '\\u0159': 'r',\n    '\\u015a': 'S',  '\\u015c': 'S', '\\u015e': 'S', '\\u0160': 'S',\n    '\\u015b': 's',  '\\u015d': 's', '\\u015f': 's', '\\u0161': 's',\n    '\\u0162': 'T',  '\\u0164': 'T', '\\u0166': 'T',\n    '\\u0163': 't',  '\\u0165': 't', '\\u0167': 't',\n    '\\u0168': 'U',  '\\u016a': 'U', '\\u016c': 'U', '\\u016e': 'U', '\\u0170': 'U', '\\u0172': 'U',\n    '\\u0169': 'u',  '\\u016b': 'u', '\\u016d': 'u', '\\u016f': 'u', '\\u0171': 'u', '\\u0173': 'u',\n    '\\u0174': 'W',  '\\u0175': 'w',\n    '\\u0176': 'Y',  '\\u0177': 'y', '\\u0178': 'Y',\n    '\\u0179': 'Z',  '\\u017b': 'Z', '\\u017d': 'Z',\n    '\\u017a': 'z',  '\\u017c': 'z', '\\u017e': 'z',\n    '\\u0132': 'IJ', '\\u0133': 'ij',\n    '\\u0152': 'Oe', '\\u0153': 'oe',\n    '\\u0149': \"'n\", '\\u017f': 's'\n  };\n\n  /** Used to map characters to HTML entities. */\n  var htmlEscapes = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n  };\n\n  /** Used to map HTML entities to characters. */\n  var htmlUnescapes = {\n    '&amp;': '&',\n    '&lt;': '<',\n    '&gt;': '>',\n    '&quot;': '\"',\n    '&#39;': \"'\"\n  };\n\n  /** Used to escape characters for inclusion in compiled string literals. */\n  var stringEscapes = {\n    '\\\\': '\\\\',\n    \"'\": \"'\",\n    '\\n': 'n',\n    '\\r': 'r',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  /** Built-in method references without a dependency on `root`. */\n  var freeParseFloat = parseFloat,\n      freeParseInt = parseInt;\n\n  /** Detect free variable `global` from Node.js. */\n  var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n  /** Detect free variable `self`. */\n  var freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n  /** Used as a reference to the global object. */\n  var root = freeGlobal || freeSelf || Function('return this')();\n\n  /** Detect free variable `exports`. */\n  var freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n  /** Detect the popular CommonJS extension `module.exports`. */\n  var moduleExports = freeModule && freeModule.exports === freeExports;\n\n  /** Detect free variable `process` from Node.js. */\n  var freeProcess = moduleExports && freeGlobal.process;\n\n  /** Used to access faster Node.js helpers. */\n  var nodeUtil = (function() {\n    try {\n      // Use `util.types` for Node.js 10+.\n      var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n      if (types) {\n        return types;\n      }\n\n      // Legacy `process.binding('util')` for Node.js < 10.\n      return freeProcess && freeProcess.binding && freeProcess.binding('util');\n    } catch (e) {}\n  }());\n\n  /* Node.js helper references. */\n  var nodeIsArrayBuffer = nodeUtil && nodeUtil.isArrayBuffer,\n      nodeIsDate = nodeUtil && nodeUtil.isDate,\n      nodeIsMap = nodeUtil && nodeUtil.isMap,\n      nodeIsRegExp = nodeUtil && nodeUtil.isRegExp,\n      nodeIsSet = nodeUtil && nodeUtil.isSet,\n      nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * A faster alternative to `Function#apply`, this function invokes `func`\n   * with the `this` binding of `thisArg` and the arguments of `args`.\n   *\n   * @private\n   * @param {Function} func The function to invoke.\n   * @param {*} thisArg The `this` binding of `func`.\n   * @param {Array} args The arguments to invoke `func` with.\n   * @returns {*} Returns the result of `func`.\n   */\n  function apply(func, thisArg, args) {\n    switch (args.length) {\n      case 0: return func.call(thisArg);\n      case 1: return func.call(thisArg, args[0]);\n      case 2: return func.call(thisArg, args[0], args[1]);\n      case 3: return func.call(thisArg, args[0], args[1], args[2]);\n    }\n    return func.apply(thisArg, args);\n  }\n\n  /**\n   * A specialized version of `baseAggregator` for arrays.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} setter The function to set `accumulator` values.\n   * @param {Function} iteratee The iteratee to transform keys.\n   * @param {Object} accumulator The initial aggregated object.\n   * @returns {Function} Returns `accumulator`.\n   */\n  function arrayAggregator(array, setter, iteratee, accumulator) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      var value = array[index];\n      setter(accumulator, value, iteratee(value), array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.forEach` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayEach(array, iteratee) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (iteratee(array[index], index, array) === false) {\n        break;\n      }\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.forEachRight` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayEachRight(array, iteratee) {\n    var length = array == null ? 0 : array.length;\n\n    while (length--) {\n      if (iteratee(array[length], length, array) === false) {\n        break;\n      }\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.every` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {boolean} Returns `true` if all elements pass the predicate check,\n   *  else `false`.\n   */\n  function arrayEvery(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (!predicate(array[index], index, array)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * A specialized version of `_.filter` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {Array} Returns the new filtered array.\n   */\n  function arrayFilter(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length,\n        resIndex = 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (predicate(value, index, array)) {\n        result[resIndex++] = value;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * A specialized version of `_.includes` for arrays without support for\n   * specifying an index to search from.\n   *\n   * @private\n   * @param {Array} [array] The array to inspect.\n   * @param {*} target The value to search for.\n   * @returns {boolean} Returns `true` if `target` is found, else `false`.\n   */\n  function arrayIncludes(array, value) {\n    var length = array == null ? 0 : array.length;\n    return !!length && baseIndexOf(array, value, 0) > -1;\n  }\n\n  /**\n   * This function is like `arrayIncludes` except that it accepts a comparator.\n   *\n   * @private\n   * @param {Array} [array] The array to inspect.\n   * @param {*} target The value to search for.\n   * @param {Function} comparator The comparator invoked per element.\n   * @returns {boolean} Returns `true` if `target` is found, else `false`.\n   */\n  function arrayIncludesWith(array, value, comparator) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (comparator(value, array[index])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * A specialized version of `_.map` for arrays without support for iteratee\n   * shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns the new mapped array.\n   */\n  function arrayMap(array, iteratee) {\n    var index = -1,\n        length = array == null ? 0 : array.length,\n        result = Array(length);\n\n    while (++index < length) {\n      result[index] = iteratee(array[index], index, array);\n    }\n    return result;\n  }\n\n  /**\n   * Appends the elements of `values` to `array`.\n   *\n   * @private\n   * @param {Array} array The array to modify.\n   * @param {Array} values The values to append.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayPush(array, values) {\n    var index = -1,\n        length = values.length,\n        offset = array.length;\n\n    while (++index < length) {\n      array[offset + index] = values[index];\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.reduce` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} [accumulator] The initial value.\n   * @param {boolean} [initAccum] Specify using the first element of `array` as\n   *  the initial value.\n   * @returns {*} Returns the accumulated value.\n   */\n  function arrayReduce(array, iteratee, accumulator, initAccum) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    if (initAccum && length) {\n      accumulator = array[++index];\n    }\n    while (++index < length) {\n      accumulator = iteratee(accumulator, array[index], index, array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.reduceRight` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} [accumulator] The initial value.\n   * @param {boolean} [initAccum] Specify using the last element of `array` as\n   *  the initial value.\n   * @returns {*} Returns the accumulated value.\n   */\n  function arrayReduceRight(array, iteratee, accumulator, initAccum) {\n    var length = array == null ? 0 : array.length;\n    if (initAccum && length) {\n      accumulator = array[--length];\n    }\n    while (length--) {\n      accumulator = iteratee(accumulator, array[length], length, array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.some` for arrays without support for iteratee\n   * shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {boolean} Returns `true` if any element passes the predicate check,\n   *  else `false`.\n   */\n  function arraySome(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (predicate(array[index], index, array)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Gets the size of an ASCII `string`.\n   *\n   * @private\n   * @param {string} string The string inspect.\n   * @returns {number} Returns the string size.\n   */\n  var asciiSize = baseProperty('length');\n\n  /**\n   * Converts an ASCII `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function asciiToArray(string) {\n    return string.split('');\n  }\n\n  /**\n   * Splits an ASCII `string` into an array of its words.\n   *\n   * @private\n   * @param {string} The string to inspect.\n   * @returns {Array} Returns the words of `string`.\n   */\n  function asciiWords(string) {\n    return string.match(reAsciiWord) || [];\n  }\n\n  /**\n   * The base implementation of methods like `_.findKey` and `_.findLastKey`,\n   * without support for iteratee shorthands, which iterates over `collection`\n   * using `eachFunc`.\n   *\n   * @private\n   * @param {Array|Object} collection The collection to inspect.\n   * @param {Function} predicate The function invoked per iteration.\n   * @param {Function} eachFunc The function to iterate over `collection`.\n   * @returns {*} Returns the found element or its key, else `undefined`.\n   */\n  function baseFindKey(collection, predicate, eachFunc) {\n    var result;\n    eachFunc(collection, function(value, key, collection) {\n      if (predicate(value, key, collection)) {\n        result = key;\n        return false;\n      }\n    });\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.findIndex` and `_.findLastIndex` without\n   * support for iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {Function} predicate The function invoked per iteration.\n   * @param {number} fromIndex The index to search from.\n   * @param {boolean} [fromRight] Specify iterating from right to left.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseFindIndex(array, predicate, fromIndex, fromRight) {\n    var length = array.length,\n        index = fromIndex + (fromRight ? 1 : -1);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (predicate(array[index], index, array)) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseIndexOf(array, value, fromIndex) {\n    return value === value\n      ? strictIndexOf(array, value, fromIndex)\n      : baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n\n  /**\n   * This function is like `baseIndexOf` except that it accepts a comparator.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @param {Function} comparator The comparator invoked per element.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseIndexOfWith(array, value, fromIndex, comparator) {\n    var index = fromIndex - 1,\n        length = array.length;\n\n    while (++index < length) {\n      if (comparator(array[index], value)) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * The base implementation of `_.isNaN` without support for number objects.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n   */\n  function baseIsNaN(value) {\n    return value !== value;\n  }\n\n  /**\n   * The base implementation of `_.mean` and `_.meanBy` without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {number} Returns the mean.\n   */\n  function baseMean(array, iteratee) {\n    var length = array == null ? 0 : array.length;\n    return length ? (baseSum(array, iteratee) / length) : NAN;\n  }\n\n  /**\n   * The base implementation of `_.property` without support for deep paths.\n   *\n   * @private\n   * @param {string} key The key of the property to get.\n   * @returns {Function} Returns the new accessor function.\n   */\n  function baseProperty(key) {\n    return function(object) {\n      return object == null ? undefined : object[key];\n    };\n  }\n\n  /**\n   * The base implementation of `_.propertyOf` without support for deep paths.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @returns {Function} Returns the new accessor function.\n   */\n  function basePropertyOf(object) {\n    return function(key) {\n      return object == null ? undefined : object[key];\n    };\n  }\n\n  /**\n   * The base implementation of `_.reduce` and `_.reduceRight`, without support\n   * for iteratee shorthands, which iterates over `collection` using `eachFunc`.\n   *\n   * @private\n   * @param {Array|Object} collection The collection to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} accumulator The initial value.\n   * @param {boolean} initAccum Specify using the first or last element of\n   *  `collection` as the initial value.\n   * @param {Function} eachFunc The function to iterate over `collection`.\n   * @returns {*} Returns the accumulated value.\n   */\n  function baseReduce(collection, iteratee, accumulator, initAccum, eachFunc) {\n    eachFunc(collection, function(value, index, collection) {\n      accumulator = initAccum\n        ? (initAccum = false, value)\n        : iteratee(accumulator, value, index, collection);\n    });\n    return accumulator;\n  }\n\n  /**\n   * The base implementation of `_.sortBy` which uses `comparer` to define the\n   * sort order of `array` and replaces criteria objects with their corresponding\n   * values.\n   *\n   * @private\n   * @param {Array} array The array to sort.\n   * @param {Function} comparer The function to define sort order.\n   * @returns {Array} Returns `array`.\n   */\n  function baseSortBy(array, comparer) {\n    var length = array.length;\n\n    array.sort(comparer);\n    while (length--) {\n      array[length] = array[length].value;\n    }\n    return array;\n  }\n\n  /**\n   * The base implementation of `_.sum` and `_.sumBy` without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {number} Returns the sum.\n   */\n  function baseSum(array, iteratee) {\n    var result,\n        index = -1,\n        length = array.length;\n\n    while (++index < length) {\n      var current = iteratee(array[index]);\n      if (current !== undefined) {\n        result = result === undefined ? current : (result + current);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.times` without support for iteratee shorthands\n   * or max array length checks.\n   *\n   * @private\n   * @param {number} n The number of times to invoke `iteratee`.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns the array of results.\n   */\n  function baseTimes(n, iteratee) {\n    var index = -1,\n        result = Array(n);\n\n    while (++index < n) {\n      result[index] = iteratee(index);\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.toPairs` and `_.toPairsIn` which creates an array\n   * of key-value pairs for `object` corresponding to the property names of `props`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {Array} props The property names to get values for.\n   * @returns {Object} Returns the key-value pairs.\n   */\n  function baseToPairs(object, props) {\n    return arrayMap(props, function(key) {\n      return [key, object[key]];\n    });\n  }\n\n  /**\n   * The base implementation of `_.trim`.\n   *\n   * @private\n   * @param {string} string The string to trim.\n   * @returns {string} Returns the trimmed string.\n   */\n  function baseTrim(string) {\n    return string\n      ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n      : string;\n  }\n\n  /**\n   * The base implementation of `_.unary` without support for storing metadata.\n   *\n   * @private\n   * @param {Function} func The function to cap arguments for.\n   * @returns {Function} Returns the new capped function.\n   */\n  function baseUnary(func) {\n    return function(value) {\n      return func(value);\n    };\n  }\n\n  /**\n   * The base implementation of `_.values` and `_.valuesIn` which creates an\n   * array of `object` property values corresponding to the property names\n   * of `props`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {Array} props The property names to get values for.\n   * @returns {Object} Returns the array of property values.\n   */\n  function baseValues(object, props) {\n    return arrayMap(props, function(key) {\n      return object[key];\n    });\n  }\n\n  /**\n   * Checks if a `cache` value for `key` exists.\n   *\n   * @private\n   * @param {Object} cache The cache to query.\n   * @param {string} key The key of the entry to check.\n   * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n   */\n  function cacheHas(cache, key) {\n    return cache.has(key);\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimStart` to get the index of the first string symbol\n   * that is not found in the character symbols.\n   *\n   * @private\n   * @param {Array} strSymbols The string symbols to inspect.\n   * @param {Array} chrSymbols The character symbols to find.\n   * @returns {number} Returns the index of the first unmatched string symbol.\n   */\n  function charsStartIndex(strSymbols, chrSymbols) {\n    var index = -1,\n        length = strSymbols.length;\n\n    while (++index < length && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n    return index;\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimEnd` to get the index of the last string symbol\n   * that is not found in the character symbols.\n   *\n   * @private\n   * @param {Array} strSymbols The string symbols to inspect.\n   * @param {Array} chrSymbols The character symbols to find.\n   * @returns {number} Returns the index of the last unmatched string symbol.\n   */\n  function charsEndIndex(strSymbols, chrSymbols) {\n    var index = strSymbols.length;\n\n    while (index-- && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n    return index;\n  }\n\n  /**\n   * Gets the number of `placeholder` occurrences in `array`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} placeholder The placeholder to search for.\n   * @returns {number} Returns the placeholder count.\n   */\n  function countHolders(array, placeholder) {\n    var length = array.length,\n        result = 0;\n\n    while (length--) {\n      if (array[length] === placeholder) {\n        ++result;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Used by `_.deburr` to convert Latin-1 Supplement and Latin Extended-A\n   * letters to basic Latin letters.\n   *\n   * @private\n   * @param {string} letter The matched letter to deburr.\n   * @returns {string} Returns the deburred letter.\n   */\n  var deburrLetter = basePropertyOf(deburredLetters);\n\n  /**\n   * Used by `_.escape` to convert characters to HTML entities.\n   *\n   * @private\n   * @param {string} chr The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  var escapeHtmlChar = basePropertyOf(htmlEscapes);\n\n  /**\n   * Used by `_.template` to escape characters for inclusion in compiled string literals.\n   *\n   * @private\n   * @param {string} chr The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  function escapeStringChar(chr) {\n    return '\\\\' + stringEscapes[chr];\n  }\n\n  /**\n   * Gets the value at `key` of `object`.\n   *\n   * @private\n   * @param {Object} [object] The object to query.\n   * @param {string} key The key of the property to get.\n   * @returns {*} Returns the property value.\n   */\n  function getValue(object, key) {\n    return object == null ? undefined : object[key];\n  }\n\n  /**\n   * Checks if `string` contains Unicode symbols.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {boolean} Returns `true` if a symbol is found, else `false`.\n   */\n  function hasUnicode(string) {\n    return reHasUnicode.test(string);\n  }\n\n  /**\n   * Checks if `string` contains a word composed of Unicode symbols.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {boolean} Returns `true` if a word is found, else `false`.\n   */\n  function hasUnicodeWord(string) {\n    return reHasUnicodeWord.test(string);\n  }\n\n  /**\n   * Converts `iterator` to an array.\n   *\n   * @private\n   * @param {Object} iterator The iterator to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function iteratorToArray(iterator) {\n    var data,\n        result = [];\n\n    while (!(data = iterator.next()).done) {\n      result.push(data.value);\n    }\n    return result;\n  }\n\n  /**\n   * Converts `map` to its key-value pairs.\n   *\n   * @private\n   * @param {Object} map The map to convert.\n   * @returns {Array} Returns the key-value pairs.\n   */\n  function mapToArray(map) {\n    var index = -1,\n        result = Array(map.size);\n\n    map.forEach(function(value, key) {\n      result[++index] = [key, value];\n    });\n    return result;\n  }\n\n  /**\n   * Creates a unary function that invokes `func` with its argument transformed.\n   *\n   * @private\n   * @param {Function} func The function to wrap.\n   * @param {Function} transform The argument transform.\n   * @returns {Function} Returns the new function.\n   */\n  function overArg(func, transform) {\n    return function(arg) {\n      return func(transform(arg));\n    };\n  }\n\n  /**\n   * Replaces all `placeholder` elements in `array` with an internal placeholder\n   * and returns an array of their indexes.\n   *\n   * @private\n   * @param {Array} array The array to modify.\n   * @param {*} placeholder The placeholder to replace.\n   * @returns {Array} Returns the new array of placeholder indexes.\n   */\n  function replaceHolders(array, placeholder) {\n    var index = -1,\n        length = array.length,\n        resIndex = 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (value === placeholder || value === PLACEHOLDER) {\n        array[index] = PLACEHOLDER;\n        result[resIndex++] = index;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Converts `set` to an array of its values.\n   *\n   * @private\n   * @param {Object} set The set to convert.\n   * @returns {Array} Returns the values.\n   */\n  function setToArray(set) {\n    var index = -1,\n        result = Array(set.size);\n\n    set.forEach(function(value) {\n      result[++index] = value;\n    });\n    return result;\n  }\n\n  /**\n   * Converts `set` to its value-value pairs.\n   *\n   * @private\n   * @param {Object} set The set to convert.\n   * @returns {Array} Returns the value-value pairs.\n   */\n  function setToPairs(set) {\n    var index = -1,\n        result = Array(set.size);\n\n    set.forEach(function(value) {\n      result[++index] = [value, value];\n    });\n    return result;\n  }\n\n  /**\n   * A specialized version of `_.indexOf` which performs strict equality\n   * comparisons of values, i.e. `===`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function strictIndexOf(array, value, fromIndex) {\n    var index = fromIndex - 1,\n        length = array.length;\n\n    while (++index < length) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * A specialized version of `_.lastIndexOf` which performs strict equality\n   * comparisons of values, i.e. `===`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function strictLastIndexOf(array, value, fromIndex) {\n    var index = fromIndex + 1;\n    while (index--) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return index;\n  }\n\n  /**\n   * Gets the number of symbols in `string`.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {number} Returns the string size.\n   */\n  function stringSize(string) {\n    return hasUnicode(string)\n      ? unicodeSize(string)\n      : asciiSize(string);\n  }\n\n  /**\n   * Converts `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function stringToArray(string) {\n    return hasUnicode(string)\n      ? unicodeToArray(string)\n      : asciiToArray(string);\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n   * character of `string`.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {number} Returns the index of the last non-whitespace character.\n   */\n  function trimmedEndIndex(string) {\n    var index = string.length;\n\n    while (index-- && reWhitespace.test(string.charAt(index))) {}\n    return index;\n  }\n\n  /**\n   * Used by `_.unescape` to convert HTML entities to characters.\n   *\n   * @private\n   * @param {string} chr The matched character to unescape.\n   * @returns {string} Returns the unescaped character.\n   */\n  var unescapeHtmlChar = basePropertyOf(htmlUnescapes);\n\n  /**\n   * Gets the size of a Unicode `string`.\n   *\n   * @private\n   * @param {string} string The string inspect.\n   * @returns {number} Returns the string size.\n   */\n  function unicodeSize(string) {\n    var result = reUnicode.lastIndex = 0;\n    while (reUnicode.test(string)) {\n      ++result;\n    }\n    return result;\n  }\n\n  /**\n   * Converts a Unicode `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function unicodeToArray(string) {\n    return string.match(reUnicode) || [];\n  }\n\n  /**\n   * Splits a Unicode `string` into an array of its words.\n   *\n   * @private\n   * @param {string} The string to inspect.\n   * @returns {Array} Returns the words of `string`.\n   */\n  function unicodeWords(string) {\n    return string.match(reUnicodeWord) || [];\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Create a new pristine `lodash` function using the `context` object.\n   *\n   * @static\n   * @memberOf _\n   * @since 1.1.0\n   * @category Util\n   * @param {Object} [context=root] The context object.\n   * @returns {Function} Returns a new `lodash` function.\n   * @example\n   *\n   * _.mixin({ 'foo': _.constant('foo') });\n   *\n   * var lodash = _.runInContext();\n   * lodash.mixin({ 'bar': lodash.constant('bar') });\n   *\n   * _.isFunction(_.foo);\n   * // => true\n   * _.isFunction(_.bar);\n   * // => false\n   *\n   * lodash.isFunction(lodash.foo);\n   * // => false\n   * lodash.isFunction(lodash.bar);\n   * // => true\n   *\n   * // Create a suped-up `defer` in Node.js.\n   * var defer = _.runInContext({ 'setTimeout': setImmediate }).defer;\n   */\n  var runInContext = (function runInContext(context) {\n    context = context == null ? root : _.defaults(root.Object(), context, _.pick(root, contextProps));\n\n    /** Built-in constructor references. */\n    var Array = context.Array,\n        Date = context.Date,\n        Error = context.Error,\n        Function = context.Function,\n        Math = context.Math,\n        Object = context.Object,\n        RegExp = context.RegExp,\n        String = context.String,\n        TypeError = context.TypeError;\n\n    /** Used for built-in method references. */\n    var arrayProto = Array.prototype,\n        funcProto = Function.prototype,\n        objectProto = Object.prototype;\n\n    /** Used to detect overreaching core-js shims. */\n    var coreJsData = context['__core-js_shared__'];\n\n    /** Used to resolve the decompiled source of functions. */\n    var funcToString = funcProto.toString;\n\n    /** Used to check objects for own properties. */\n    var hasOwnProperty = objectProto.hasOwnProperty;\n\n    /** Used to generate unique IDs. */\n    var idCounter = 0;\n\n    /** Used to detect methods masquerading as native. */\n    var maskSrcKey = (function() {\n      var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n      return uid ? ('Symbol(src)_1.' + uid) : '';\n    }());\n\n    /**\n     * Used to resolve the\n     * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n     * of values.\n     */\n    var nativeObjectToString = objectProto.toString;\n\n    /** Used to infer the `Object` constructor. */\n    var objectCtorString = funcToString.call(Object);\n\n    /** Used to restore the original `_` reference in `_.noConflict`. */\n    var oldDash = root._;\n\n    /** Used to detect if a method is native. */\n    var reIsNative = RegExp('^' +\n      funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n      .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n    );\n\n    /** Built-in value references. */\n    var Buffer = moduleExports ? context.Buffer : undefined,\n        Symbol = context.Symbol,\n        Uint8Array = context.Uint8Array,\n        allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined,\n        getPrototype = overArg(Object.getPrototypeOf, Object),\n        objectCreate = Object.create,\n        propertyIsEnumerable = objectProto.propertyIsEnumerable,\n        splice = arrayProto.splice,\n        spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined,\n        symIterator = Symbol ? Symbol.iterator : undefined,\n        symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n    var defineProperty = (function() {\n      try {\n        var func = getNative(Object, 'defineProperty');\n        func({}, '', {});\n        return func;\n      } catch (e) {}\n    }());\n\n    /** Mocked built-ins. */\n    var ctxClearTimeout = context.clearTimeout !== root.clearTimeout && context.clearTimeout,\n        ctxNow = Date && Date.now !== root.Date.now && Date.now,\n        ctxSetTimeout = context.setTimeout !== root.setTimeout && context.setTimeout;\n\n    /* Built-in method references for those with the same name as other `lodash` methods. */\n    var nativeCeil = Math.ceil,\n        nativeFloor = Math.floor,\n        nativeGetSymbols = Object.getOwnPropertySymbols,\n        nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,\n        nativeIsFinite = context.isFinite,\n        nativeJoin = arrayProto.join,\n        nativeKeys = overArg(Object.keys, Object),\n        nativeMax = Math.max,\n        nativeMin = Math.min,\n        nativeNow = Date.now,\n        nativeParseInt = context.parseInt,\n        nativeRandom = Math.random,\n        nativeReverse = arrayProto.reverse;\n\n    /* Built-in method references that are verified to be native. */\n    var DataView = getNative(context, 'DataView'),\n        Map = getNative(context, 'Map'),\n        Promise = getNative(context, 'Promise'),\n        Set = getNative(context, 'Set'),\n        WeakMap = getNative(context, 'WeakMap'),\n        nativeCreate = getNative(Object, 'create');\n\n    /** Used to store function metadata. */\n    var metaMap = WeakMap && new WeakMap;\n\n    /** Used to lookup unminified function names. */\n    var realNames = {};\n\n    /** Used to detect maps, sets, and weakmaps. */\n    var dataViewCtorString = toSource(DataView),\n        mapCtorString = toSource(Map),\n        promiseCtorString = toSource(Promise),\n        setCtorString = toSource(Set),\n        weakMapCtorString = toSource(WeakMap);\n\n    /** Used to convert symbols to primitives and strings. */\n    var symbolProto = Symbol ? Symbol.prototype : undefined,\n        symbolValueOf = symbolProto ? symbolProto.valueOf : undefined,\n        symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` object which wraps `value` to enable implicit method\n     * chain sequences. Methods that operate on and return arrays, collections,\n     * and functions can be chained together. Methods that retrieve a single value\n     * or may return a primitive value will automatically end the chain sequence\n     * and return the unwrapped value. Otherwise, the value must be unwrapped\n     * with `_#value`.\n     *\n     * Explicit chain sequences, which must be unwrapped with `_#value`, may be\n     * enabled using `_.chain`.\n     *\n     * The execution of chained methods is lazy, that is, it's deferred until\n     * `_#value` is implicitly or explicitly called.\n     *\n     * Lazy evaluation allows several methods to support shortcut fusion.\n     * Shortcut fusion is an optimization to merge iteratee calls; this avoids\n     * the creation of intermediate arrays and can greatly reduce the number of\n     * iteratee executions. Sections of a chain sequence qualify for shortcut\n     * fusion if the section is applied to an array and iteratees accept only\n     * one argument. The heuristic for whether a section qualifies for shortcut\n     * fusion is subject to change.\n     *\n     * Chaining is supported in custom builds as long as the `_#value` method is\n     * directly or indirectly included in the build.\n     *\n     * In addition to lodash methods, wrappers have `Array` and `String` methods.\n     *\n     * The wrapper `Array` methods are:\n     * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`\n     *\n     * The wrapper `String` methods are:\n     * `replace` and `split`\n     *\n     * The wrapper methods that support shortcut fusion are:\n     * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,\n     * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,\n     * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`\n     *\n     * The chainable wrapper methods are:\n     * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,\n     * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,\n     * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,\n     * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,\n     * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,\n     * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,\n     * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,\n     * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,\n     * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,\n     * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,\n     * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,\n     * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,\n     * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,\n     * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,\n     * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,\n     * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,\n     * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,\n     * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,\n     * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,\n     * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,\n     * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,\n     * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,\n     * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,\n     * `zipObject`, `zipObjectDeep`, and `zipWith`\n     *\n     * The wrapper methods that are **not** chainable by default are:\n     * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,\n     * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,\n     * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,\n     * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,\n     * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,\n     * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,\n     * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,\n     * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,\n     * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,\n     * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,\n     * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,\n     * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,\n     * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,\n     * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,\n     * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,\n     * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,\n     * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,\n     * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,\n     * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,\n     * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,\n     * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,\n     * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,\n     * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,\n     * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,\n     * `upperFirst`, `value`, and `words`\n     *\n     * @name _\n     * @constructor\n     * @category Seq\n     * @param {*} value The value to wrap in a `lodash` instance.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var wrapped = _([1, 2, 3]);\n     *\n     * // Returns an unwrapped value.\n     * wrapped.reduce(_.add);\n     * // => 6\n     *\n     * // Returns a wrapped value.\n     * var squares = wrapped.map(square);\n     *\n     * _.isArray(squares);\n     * // => false\n     *\n     * _.isArray(squares.value());\n     * // => true\n     */\n    function lodash(value) {\n      if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {\n        if (value instanceof LodashWrapper) {\n          return value;\n        }\n        if (hasOwnProperty.call(value, '__wrapped__')) {\n          return wrapperClone(value);\n        }\n      }\n      return new LodashWrapper(value);\n    }\n\n    /**\n     * The base implementation of `_.create` without support for assigning\n     * properties to the created object.\n     *\n     * @private\n     * @param {Object} proto The object to inherit from.\n     * @returns {Object} Returns the new object.\n     */\n    var baseCreate = (function() {\n      function object() {}\n      return function(proto) {\n        if (!isObject(proto)) {\n          return {};\n        }\n        if (objectCreate) {\n          return objectCreate(proto);\n        }\n        object.prototype = proto;\n        var result = new object;\n        object.prototype = undefined;\n        return result;\n      };\n    }());\n\n    /**\n     * The function whose prototype chain sequence wrappers inherit from.\n     *\n     * @private\n     */\n    function baseLodash() {\n      // No operation performed.\n    }\n\n    /**\n     * The base constructor for creating `lodash` wrapper objects.\n     *\n     * @private\n     * @param {*} value The value to wrap.\n     * @param {boolean} [chainAll] Enable explicit method chain sequences.\n     */\n    function LodashWrapper(value, chainAll) {\n      this.__wrapped__ = value;\n      this.__actions__ = [];\n      this.__chain__ = !!chainAll;\n      this.__index__ = 0;\n      this.__values__ = undefined;\n    }\n\n    /**\n     * By default, the template delimiters used by lodash are like those in\n     * embedded Ruby (ERB) as well as ES2015 template strings. Change the\n     * following template settings to use alternative delimiters.\n     *\n     * @static\n     * @memberOf _\n     * @type {Object}\n     */\n    lodash.templateSettings = {\n\n      /**\n       * Used to detect `data` property values to be HTML-escaped.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'escape': reEscape,\n\n      /**\n       * Used to detect code to be evaluated.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'evaluate': reEvaluate,\n\n      /**\n       * Used to detect `data` property values to inject.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'interpolate': reInterpolate,\n\n      /**\n       * Used to reference the data object in the template text.\n       *\n       * @memberOf _.templateSettings\n       * @type {string}\n       */\n      'variable': '',\n\n      /**\n       * Used to import variables into the compiled template.\n       *\n       * @memberOf _.templateSettings\n       * @type {Object}\n       */\n      'imports': {\n\n        /**\n         * A reference to the `lodash` function.\n         *\n         * @memberOf _.templateSettings.imports\n         * @type {Function}\n         */\n        '_': lodash\n      }\n    };\n\n    // Ensure wrappers are instances of `baseLodash`.\n    lodash.prototype = baseLodash.prototype;\n    lodash.prototype.constructor = lodash;\n\n    LodashWrapper.prototype = baseCreate(baseLodash.prototype);\n    LodashWrapper.prototype.constructor = LodashWrapper;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.\n     *\n     * @private\n     * @constructor\n     * @param {*} value The value to wrap.\n     */\n    function LazyWrapper(value) {\n      this.__wrapped__ = value;\n      this.__actions__ = [];\n      this.__dir__ = 1;\n      this.__filtered__ = false;\n      this.__iteratees__ = [];\n      this.__takeCount__ = MAX_ARRAY_LENGTH;\n      this.__views__ = [];\n    }\n\n    /**\n     * Creates a clone of the lazy wrapper object.\n     *\n     * @private\n     * @name clone\n     * @memberOf LazyWrapper\n     * @returns {Object} Returns the cloned `LazyWrapper` object.\n     */\n    function lazyClone() {\n      var result = new LazyWrapper(this.__wrapped__);\n      result.__actions__ = copyArray(this.__actions__);\n      result.__dir__ = this.__dir__;\n      result.__filtered__ = this.__filtered__;\n      result.__iteratees__ = copyArray(this.__iteratees__);\n      result.__takeCount__ = this.__takeCount__;\n      result.__views__ = copyArray(this.__views__);\n      return result;\n    }\n\n    /**\n     * Reverses the direction of lazy iteration.\n     *\n     * @private\n     * @name reverse\n     * @memberOf LazyWrapper\n     * @returns {Object} Returns the new reversed `LazyWrapper` object.\n     */\n    function lazyReverse() {\n      if (this.__filtered__) {\n        var result = new LazyWrapper(this);\n        result.__dir__ = -1;\n        result.__filtered__ = true;\n      } else {\n        result = this.clone();\n        result.__dir__ *= -1;\n      }\n      return result;\n    }\n\n    /**\n     * Extracts the unwrapped value from its lazy wrapper.\n     *\n     * @private\n     * @name value\n     * @memberOf LazyWrapper\n     * @returns {*} Returns the unwrapped value.\n     */\n    function lazyValue() {\n      var array = this.__wrapped__.value(),\n          dir = this.__dir__,\n          isArr = isArray(array),\n          isRight = dir < 0,\n          arrLength = isArr ? array.length : 0,\n          view = getView(0, arrLength, this.__views__),\n          start = view.start,\n          end = view.end,\n          length = end - start,\n          index = isRight ? end : (start - 1),\n          iteratees = this.__iteratees__,\n          iterLength = iteratees.length,\n          resIndex = 0,\n          takeCount = nativeMin(length, this.__takeCount__);\n\n      if (!isArr || (!isRight && arrLength == length && takeCount == length)) {\n        return baseWrapperValue(array, this.__actions__);\n      }\n      var result = [];\n\n      outer:\n      while (length-- && resIndex < takeCount) {\n        index += dir;\n\n        var iterIndex = -1,\n            value = array[index];\n\n        while (++iterIndex < iterLength) {\n          var data = iteratees[iterIndex],\n              iteratee = data.iteratee,\n              type = data.type,\n              computed = iteratee(value);\n\n          if (type == LAZY_MAP_FLAG) {\n            value = computed;\n          } else if (!computed) {\n            if (type == LAZY_FILTER_FLAG) {\n              continue outer;\n            } else {\n              break outer;\n            }\n          }\n        }\n        result[resIndex++] = value;\n      }\n      return result;\n    }\n\n    // Ensure `LazyWrapper` is an instance of `baseLodash`.\n    LazyWrapper.prototype = baseCreate(baseLodash.prototype);\n    LazyWrapper.prototype.constructor = LazyWrapper;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a hash object.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function Hash(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the hash.\n     *\n     * @private\n     * @name clear\n     * @memberOf Hash\n     */\n    function hashClear() {\n      this.__data__ = nativeCreate ? nativeCreate(null) : {};\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the hash.\n     *\n     * @private\n     * @name delete\n     * @memberOf Hash\n     * @param {Object} hash The hash to modify.\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function hashDelete(key) {\n      var result = this.has(key) && delete this.__data__[key];\n      this.size -= result ? 1 : 0;\n      return result;\n    }\n\n    /**\n     * Gets the hash value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf Hash\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function hashGet(key) {\n      var data = this.__data__;\n      if (nativeCreate) {\n        var result = data[key];\n        return result === HASH_UNDEFINED ? undefined : result;\n      }\n      return hasOwnProperty.call(data, key) ? data[key] : undefined;\n    }\n\n    /**\n     * Checks if a hash value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf Hash\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function hashHas(key) {\n      var data = this.__data__;\n      return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n    }\n\n    /**\n     * Sets the hash `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf Hash\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the hash instance.\n     */\n    function hashSet(key, value) {\n      var data = this.__data__;\n      this.size += this.has(key) ? 0 : 1;\n      data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n      return this;\n    }\n\n    // Add methods to `Hash`.\n    Hash.prototype.clear = hashClear;\n    Hash.prototype['delete'] = hashDelete;\n    Hash.prototype.get = hashGet;\n    Hash.prototype.has = hashHas;\n    Hash.prototype.set = hashSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an list cache object.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function ListCache(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the list cache.\n     *\n     * @private\n     * @name clear\n     * @memberOf ListCache\n     */\n    function listCacheClear() {\n      this.__data__ = [];\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the list cache.\n     *\n     * @private\n     * @name delete\n     * @memberOf ListCache\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function listCacheDelete(key) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      if (index < 0) {\n        return false;\n      }\n      var lastIndex = data.length - 1;\n      if (index == lastIndex) {\n        data.pop();\n      } else {\n        splice.call(data, index, 1);\n      }\n      --this.size;\n      return true;\n    }\n\n    /**\n     * Gets the list cache value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf ListCache\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function listCacheGet(key) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      return index < 0 ? undefined : data[index][1];\n    }\n\n    /**\n     * Checks if a list cache value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf ListCache\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function listCacheHas(key) {\n      return assocIndexOf(this.__data__, key) > -1;\n    }\n\n    /**\n     * Sets the list cache `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf ListCache\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the list cache instance.\n     */\n    function listCacheSet(key, value) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      if (index < 0) {\n        ++this.size;\n        data.push([key, value]);\n      } else {\n        data[index][1] = value;\n      }\n      return this;\n    }\n\n    // Add methods to `ListCache`.\n    ListCache.prototype.clear = listCacheClear;\n    ListCache.prototype['delete'] = listCacheDelete;\n    ListCache.prototype.get = listCacheGet;\n    ListCache.prototype.has = listCacheHas;\n    ListCache.prototype.set = listCacheSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a map cache object to store key-value pairs.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function MapCache(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the map.\n     *\n     * @private\n     * @name clear\n     * @memberOf MapCache\n     */\n    function mapCacheClear() {\n      this.size = 0;\n      this.__data__ = {\n        'hash': new Hash,\n        'map': new (Map || ListCache),\n        'string': new Hash\n      };\n    }\n\n    /**\n     * Removes `key` and its value from the map.\n     *\n     * @private\n     * @name delete\n     * @memberOf MapCache\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function mapCacheDelete(key) {\n      var result = getMapData(this, key)['delete'](key);\n      this.size -= result ? 1 : 0;\n      return result;\n    }\n\n    /**\n     * Gets the map value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf MapCache\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function mapCacheGet(key) {\n      return getMapData(this, key).get(key);\n    }\n\n    /**\n     * Checks if a map value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf MapCache\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function mapCacheHas(key) {\n      return getMapData(this, key).has(key);\n    }\n\n    /**\n     * Sets the map `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf MapCache\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the map cache instance.\n     */\n    function mapCacheSet(key, value) {\n      var data = getMapData(this, key),\n          size = data.size;\n\n      data.set(key, value);\n      this.size += data.size == size ? 0 : 1;\n      return this;\n    }\n\n    // Add methods to `MapCache`.\n    MapCache.prototype.clear = mapCacheClear;\n    MapCache.prototype['delete'] = mapCacheDelete;\n    MapCache.prototype.get = mapCacheGet;\n    MapCache.prototype.has = mapCacheHas;\n    MapCache.prototype.set = mapCacheSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     *\n     * Creates an array cache object to store unique values.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [values] The values to cache.\n     */\n    function SetCache(values) {\n      var index = -1,\n          length = values == null ? 0 : values.length;\n\n      this.__data__ = new MapCache;\n      while (++index < length) {\n        this.add(values[index]);\n      }\n    }\n\n    /**\n     * Adds `value` to the array cache.\n     *\n     * @private\n     * @name add\n     * @memberOf SetCache\n     * @alias push\n     * @param {*} value The value to cache.\n     * @returns {Object} Returns the cache instance.\n     */\n    function setCacheAdd(value) {\n      this.__data__.set(value, HASH_UNDEFINED);\n      return this;\n    }\n\n    /**\n     * Checks if `value` is in the array cache.\n     *\n     * @private\n     * @name has\n     * @memberOf SetCache\n     * @param {*} value The value to search for.\n     * @returns {number} Returns `true` if `value` is found, else `false`.\n     */\n    function setCacheHas(value) {\n      return this.__data__.has(value);\n    }\n\n    // Add methods to `SetCache`.\n    SetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\n    SetCache.prototype.has = setCacheHas;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a stack cache object to store key-value pairs.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function Stack(entries) {\n      var data = this.__data__ = new ListCache(entries);\n      this.size = data.size;\n    }\n\n    /**\n     * Removes all key-value entries from the stack.\n     *\n     * @private\n     * @name clear\n     * @memberOf Stack\n     */\n    function stackClear() {\n      this.__data__ = new ListCache;\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the stack.\n     *\n     * @private\n     * @name delete\n     * @memberOf Stack\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function stackDelete(key) {\n      var data = this.__data__,\n          result = data['delete'](key);\n\n      this.size = data.size;\n      return result;\n    }\n\n    /**\n     * Gets the stack value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf Stack\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function stackGet(key) {\n      return this.__data__.get(key);\n    }\n\n    /**\n     * Checks if a stack value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf Stack\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function stackHas(key) {\n      return this.__data__.has(key);\n    }\n\n    /**\n     * Sets the stack `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf Stack\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the stack cache instance.\n     */\n    function stackSet(key, value) {\n      var data = this.__data__;\n      if (data instanceof ListCache) {\n        var pairs = data.__data__;\n        if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n          pairs.push([key, value]);\n          this.size = ++data.size;\n          return this;\n        }\n        data = this.__data__ = new MapCache(pairs);\n      }\n      data.set(key, value);\n      this.size = data.size;\n      return this;\n    }\n\n    // Add methods to `Stack`.\n    Stack.prototype.clear = stackClear;\n    Stack.prototype['delete'] = stackDelete;\n    Stack.prototype.get = stackGet;\n    Stack.prototype.has = stackHas;\n    Stack.prototype.set = stackSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of the enumerable property names of the array-like `value`.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @param {boolean} inherited Specify returning inherited property names.\n     * @returns {Array} Returns the array of property names.\n     */\n    function arrayLikeKeys(value, inherited) {\n      var isArr = isArray(value),\n          isArg = !isArr && isArguments(value),\n          isBuff = !isArr && !isArg && isBuffer(value),\n          isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n          skipIndexes = isArr || isArg || isBuff || isType,\n          result = skipIndexes ? baseTimes(value.length, String) : [],\n          length = result.length;\n\n      for (var key in value) {\n        if ((inherited || hasOwnProperty.call(value, key)) &&\n            !(skipIndexes && (\n               // Safari 9 has enumerable `arguments.length` in strict mode.\n               key == 'length' ||\n               // Node.js 0.10 has enumerable non-index properties on buffers.\n               (isBuff && (key == 'offset' || key == 'parent')) ||\n               // PhantomJS 2 has enumerable non-index properties on typed arrays.\n               (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n               // Skip index properties.\n               isIndex(key, length)\n            ))) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * A specialized version of `_.sample` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to sample.\n     * @returns {*} Returns the random element.\n     */\n    function arraySample(array) {\n      var length = array.length;\n      return length ? array[baseRandom(0, length - 1)] : undefined;\n    }\n\n    /**\n     * A specialized version of `_.sampleSize` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to sample.\n     * @param {number} n The number of elements to sample.\n     * @returns {Array} Returns the random elements.\n     */\n    function arraySampleSize(array, n) {\n      return shuffleSelf(copyArray(array), baseClamp(n, 0, array.length));\n    }\n\n    /**\n     * A specialized version of `_.shuffle` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     */\n    function arrayShuffle(array) {\n      return shuffleSelf(copyArray(array));\n    }\n\n    /**\n     * This function is like `assignValue` except that it doesn't assign\n     * `undefined` values.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function assignMergeValue(object, key, value) {\n      if ((value !== undefined && !eq(object[key], value)) ||\n          (value === undefined && !(key in object))) {\n        baseAssignValue(object, key, value);\n      }\n    }\n\n    /**\n     * Assigns `value` to `key` of `object` if the existing value is not equivalent\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function assignValue(object, key, value) {\n      var objValue = object[key];\n      if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n          (value === undefined && !(key in object))) {\n        baseAssignValue(object, key, value);\n      }\n    }\n\n    /**\n     * Gets the index at which the `key` is found in `array` of key-value pairs.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {*} key The key to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     */\n    function assocIndexOf(array, key) {\n      var length = array.length;\n      while (length--) {\n        if (eq(array[length][0], key)) {\n          return length;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * Aggregates elements of `collection` on `accumulator` with keys transformed\n     * by `iteratee` and values set by `setter`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} setter The function to set `accumulator` values.\n     * @param {Function} iteratee The iteratee to transform keys.\n     * @param {Object} accumulator The initial aggregated object.\n     * @returns {Function} Returns `accumulator`.\n     */\n    function baseAggregator(collection, setter, iteratee, accumulator) {\n      baseEach(collection, function(value, key, collection) {\n        setter(accumulator, value, iteratee(value), collection);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The base implementation of `_.assign` without support for multiple sources\n     * or `customizer` functions.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @returns {Object} Returns `object`.\n     */\n    function baseAssign(object, source) {\n      return object && copyObject(source, keys(source), object);\n    }\n\n    /**\n     * The base implementation of `_.assignIn` without support for multiple sources\n     * or `customizer` functions.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @returns {Object} Returns `object`.\n     */\n    function baseAssignIn(object, source) {\n      return object && copyObject(source, keysIn(source), object);\n    }\n\n    /**\n     * The base implementation of `assignValue` and `assignMergeValue` without\n     * value checks.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function baseAssignValue(object, key, value) {\n      if (key == '__proto__' && defineProperty) {\n        defineProperty(object, key, {\n          'configurable': true,\n          'enumerable': true,\n          'value': value,\n          'writable': true\n        });\n      } else {\n        object[key] = value;\n      }\n    }\n\n    /**\n     * The base implementation of `_.at` without support for individual paths.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {string[]} paths The property paths to pick.\n     * @returns {Array} Returns the picked elements.\n     */\n    function baseAt(object, paths) {\n      var index = -1,\n          length = paths.length,\n          result = Array(length),\n          skip = object == null;\n\n      while (++index < length) {\n        result[index] = skip ? undefined : get(object, paths[index]);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.clamp` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {number} number The number to clamp.\n     * @param {number} [lower] The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the clamped number.\n     */\n    function baseClamp(number, lower, upper) {\n      if (number === number) {\n        if (upper !== undefined) {\n          number = number <= upper ? number : upper;\n        }\n        if (lower !== undefined) {\n          number = number >= lower ? number : lower;\n        }\n      }\n      return number;\n    }\n\n    /**\n     * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n     * traversed objects.\n     *\n     * @private\n     * @param {*} value The value to clone.\n     * @param {boolean} bitmask The bitmask flags.\n     *  1 - Deep clone\n     *  2 - Flatten inherited properties\n     *  4 - Clone symbols\n     * @param {Function} [customizer] The function to customize cloning.\n     * @param {string} [key] The key of `value`.\n     * @param {Object} [object] The parent object of `value`.\n     * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n     * @returns {*} Returns the cloned value.\n     */\n    function baseClone(value, bitmask, customizer, key, object, stack) {\n      var result,\n          isDeep = bitmask & CLONE_DEEP_FLAG,\n          isFlat = bitmask & CLONE_FLAT_FLAG,\n          isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n      if (customizer) {\n        result = object ? customizer(value, key, object, stack) : customizer(value);\n      }\n      if (result !== undefined) {\n        return result;\n      }\n      if (!isObject(value)) {\n        return value;\n      }\n      var isArr = isArray(value);\n      if (isArr) {\n        result = initCloneArray(value);\n        if (!isDeep) {\n          return copyArray(value, result);\n        }\n      } else {\n        var tag = getTag(value),\n            isFunc = tag == funcTag || tag == genTag;\n\n        if (isBuffer(value)) {\n          return cloneBuffer(value, isDeep);\n        }\n        if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n          result = (isFlat || isFunc) ? {} : initCloneObject(value);\n          if (!isDeep) {\n            return isFlat\n              ? copySymbolsIn(value, baseAssignIn(result, value))\n              : copySymbols(value, baseAssign(result, value));\n          }\n        } else {\n          if (!cloneableTags[tag]) {\n            return object ? value : {};\n          }\n          result = initCloneByTag(value, tag, isDeep);\n        }\n      }\n      // Check for circular references and return its corresponding clone.\n      stack || (stack = new Stack);\n      var stacked = stack.get(value);\n      if (stacked) {\n        return stacked;\n      }\n      stack.set(value, result);\n\n      if (isSet(value)) {\n        value.forEach(function(subValue) {\n          result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n        });\n      } else if (isMap(value)) {\n        value.forEach(function(subValue, key) {\n          result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n        });\n      }\n\n      var keysFunc = isFull\n        ? (isFlat ? getAllKeysIn : getAllKeys)\n        : (isFlat ? keysIn : keys);\n\n      var props = isArr ? undefined : keysFunc(value);\n      arrayEach(props || value, function(subValue, key) {\n        if (props) {\n          key = subValue;\n          subValue = value[key];\n        }\n        // Recursively populate clone (susceptible to call stack limits).\n        assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.conforms` which doesn't clone `source`.\n     *\n     * @private\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseConforms(source) {\n      var props = keys(source);\n      return function(object) {\n        return baseConformsTo(object, source, props);\n      };\n    }\n\n    /**\n     * The base implementation of `_.conformsTo` which accepts `props` to check.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {boolean} Returns `true` if `object` conforms, else `false`.\n     */\n    function baseConformsTo(object, source, props) {\n      var length = props.length;\n      if (object == null) {\n        return !length;\n      }\n      object = Object(object);\n      while (length--) {\n        var key = props[length],\n            predicate = source[key],\n            value = object[key];\n\n        if ((value === undefined && !(key in object)) || !predicate(value)) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    /**\n     * The base implementation of `_.delay` and `_.defer` which accepts `args`\n     * to provide to `func`.\n     *\n     * @private\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @param {Array} args The arguments to provide to `func`.\n     * @returns {number|Object} Returns the timer id or timeout object.\n     */\n    function baseDelay(func, wait, args) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      return setTimeout(function() { func.apply(undefined, args); }, wait);\n    }\n\n    /**\n     * The base implementation of methods like `_.difference` without support\n     * for excluding multiple arrays or iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Array} values The values to exclude.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     */\n    function baseDifference(array, values, iteratee, comparator) {\n      var index = -1,\n          includes = arrayIncludes,\n          isCommon = true,\n          length = array.length,\n          result = [],\n          valuesLength = values.length;\n\n      if (!length) {\n        return result;\n      }\n      if (iteratee) {\n        values = arrayMap(values, baseUnary(iteratee));\n      }\n      if (comparator) {\n        includes = arrayIncludesWith;\n        isCommon = false;\n      }\n      else if (values.length >= LARGE_ARRAY_SIZE) {\n        includes = cacheHas;\n        isCommon = false;\n        values = new SetCache(values);\n      }\n      outer:\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee == null ? value : iteratee(value);\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (isCommon && computed === computed) {\n          var valuesIndex = valuesLength;\n          while (valuesIndex--) {\n            if (values[valuesIndex] === computed) {\n              continue outer;\n            }\n          }\n          result.push(value);\n        }\n        else if (!includes(values, computed, comparator)) {\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.forEach` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     */\n    var baseEach = createBaseEach(baseForOwn);\n\n    /**\n     * The base implementation of `_.forEachRight` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     */\n    var baseEachRight = createBaseEach(baseForOwnRight, true);\n\n    /**\n     * The base implementation of `_.every` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {boolean} Returns `true` if all elements pass the predicate check,\n     *  else `false`\n     */\n    function baseEvery(collection, predicate) {\n      var result = true;\n      baseEach(collection, function(value, index, collection) {\n        result = !!predicate(value, index, collection);\n        return result;\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of methods like `_.max` and `_.min` which accepts a\n     * `comparator` to determine the extremum value.\n     *\n     * @private\n     * @param {Array} array The array to iterate over.\n     * @param {Function} iteratee The iteratee invoked per iteration.\n     * @param {Function} comparator The comparator used to compare values.\n     * @returns {*} Returns the extremum value.\n     */\n    function baseExtremum(array, iteratee, comparator) {\n      var index = -1,\n          length = array.length;\n\n      while (++index < length) {\n        var value = array[index],\n            current = iteratee(value);\n\n        if (current != null && (computed === undefined\n              ? (current === current && !isSymbol(current))\n              : comparator(current, computed)\n            )) {\n          var computed = current,\n              result = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.fill` without an iteratee call guard.\n     *\n     * @private\n     * @param {Array} array The array to fill.\n     * @param {*} value The value to fill `array` with.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns `array`.\n     */\n    function baseFill(array, value, start, end) {\n      var length = array.length;\n\n      start = toInteger(start);\n      if (start < 0) {\n        start = -start > length ? 0 : (length + start);\n      }\n      end = (end === undefined || end > length) ? length : toInteger(end);\n      if (end < 0) {\n        end += length;\n      }\n      end = start > end ? 0 : toLength(end);\n      while (start < end) {\n        array[start++] = value;\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.filter` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     */\n    function baseFilter(collection, predicate) {\n      var result = [];\n      baseEach(collection, function(value, index, collection) {\n        if (predicate(value, index, collection)) {\n          result.push(value);\n        }\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.flatten` with support for restricting flattening.\n     *\n     * @private\n     * @param {Array} array The array to flatten.\n     * @param {number} depth The maximum recursion depth.\n     * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n     * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n     * @param {Array} [result=[]] The initial result value.\n     * @returns {Array} Returns the new flattened array.\n     */\n    function baseFlatten(array, depth, predicate, isStrict, result) {\n      var index = -1,\n          length = array.length;\n\n      predicate || (predicate = isFlattenable);\n      result || (result = []);\n\n      while (++index < length) {\n        var value = array[index];\n        if (depth > 0 && predicate(value)) {\n          if (depth > 1) {\n            // Recursively flatten arrays (susceptible to call stack limits).\n            baseFlatten(value, depth - 1, predicate, isStrict, result);\n          } else {\n            arrayPush(result, value);\n          }\n        } else if (!isStrict) {\n          result[result.length] = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `baseForOwn` which iterates over `object`\n     * properties returned by `keysFunc` and invokes `iteratee` for each property.\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @returns {Object} Returns `object`.\n     */\n    var baseFor = createBaseFor();\n\n    /**\n     * This function is like `baseFor` except that it iterates over properties\n     * in the opposite order.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @returns {Object} Returns `object`.\n     */\n    var baseForRight = createBaseFor(true);\n\n    /**\n     * The base implementation of `_.forOwn` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     */\n    function baseForOwn(object, iteratee) {\n      return object && baseFor(object, iteratee, keys);\n    }\n\n    /**\n     * The base implementation of `_.forOwnRight` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     */\n    function baseForOwnRight(object, iteratee) {\n      return object && baseForRight(object, iteratee, keys);\n    }\n\n    /**\n     * The base implementation of `_.functions` which creates an array of\n     * `object` function property names filtered from `props`.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Array} props The property names to filter.\n     * @returns {Array} Returns the function names.\n     */\n    function baseFunctions(object, props) {\n      return arrayFilter(props, function(key) {\n        return isFunction(object[key]);\n      });\n    }\n\n    /**\n     * The base implementation of `_.get` without support for default values.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to get.\n     * @returns {*} Returns the resolved value.\n     */\n    function baseGet(object, path) {\n      path = castPath(path, object);\n\n      var index = 0,\n          length = path.length;\n\n      while (object != null && index < length) {\n        object = object[toKey(path[index++])];\n      }\n      return (index && index == length) ? object : undefined;\n    }\n\n    /**\n     * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n     * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n     * symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @param {Function} symbolsFunc The function to get the symbols of `object`.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function baseGetAllKeys(object, keysFunc, symbolsFunc) {\n      var result = keysFunc(object);\n      return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n    }\n\n    /**\n     * The base implementation of `getTag` without fallbacks for buggy environments.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the `toStringTag`.\n     */\n    function baseGetTag(value) {\n      if (value == null) {\n        return value === undefined ? undefinedTag : nullTag;\n      }\n      return (symToStringTag && symToStringTag in Object(value))\n        ? getRawTag(value)\n        : objectToString(value);\n    }\n\n    /**\n     * The base implementation of `_.gt` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than `other`,\n     *  else `false`.\n     */\n    function baseGt(value, other) {\n      return value > other;\n    }\n\n    /**\n     * The base implementation of `_.has` without support for deep paths.\n     *\n     * @private\n     * @param {Object} [object] The object to query.\n     * @param {Array|string} key The key to check.\n     * @returns {boolean} Returns `true` if `key` exists, else `false`.\n     */\n    function baseHas(object, key) {\n      return object != null && hasOwnProperty.call(object, key);\n    }\n\n    /**\n     * The base implementation of `_.hasIn` without support for deep paths.\n     *\n     * @private\n     * @param {Object} [object] The object to query.\n     * @param {Array|string} key The key to check.\n     * @returns {boolean} Returns `true` if `key` exists, else `false`.\n     */\n    function baseHasIn(object, key) {\n      return object != null && key in Object(object);\n    }\n\n    /**\n     * The base implementation of `_.inRange` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {number} number The number to check.\n     * @param {number} start The start of the range.\n     * @param {number} end The end of the range.\n     * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n     */\n    function baseInRange(number, start, end) {\n      return number >= nativeMin(start, end) && number < nativeMax(start, end);\n    }\n\n    /**\n     * The base implementation of methods like `_.intersection`, without support\n     * for iteratee shorthands, that accepts an array of arrays to inspect.\n     *\n     * @private\n     * @param {Array} arrays The arrays to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of shared values.\n     */\n    function baseIntersection(arrays, iteratee, comparator) {\n      var includes = comparator ? arrayIncludesWith : arrayIncludes,\n          length = arrays[0].length,\n          othLength = arrays.length,\n          othIndex = othLength,\n          caches = Array(othLength),\n          maxLength = Infinity,\n          result = [];\n\n      while (othIndex--) {\n        var array = arrays[othIndex];\n        if (othIndex && iteratee) {\n          array = arrayMap(array, baseUnary(iteratee));\n        }\n        maxLength = nativeMin(array.length, maxLength);\n        caches[othIndex] = !comparator && (iteratee || (length >= 120 && array.length >= 120))\n          ? new SetCache(othIndex && array)\n          : undefined;\n      }\n      array = arrays[0];\n\n      var index = -1,\n          seen = caches[0];\n\n      outer:\n      while (++index < length && result.length < maxLength) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (!(seen\n              ? cacheHas(seen, computed)\n              : includes(result, computed, comparator)\n            )) {\n          othIndex = othLength;\n          while (--othIndex) {\n            var cache = caches[othIndex];\n            if (!(cache\n                  ? cacheHas(cache, computed)\n                  : includes(arrays[othIndex], computed, comparator))\n                ) {\n              continue outer;\n            }\n          }\n          if (seen) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.invert` and `_.invertBy` which inverts\n     * `object` with values transformed by `iteratee` and set by `setter`.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} setter The function to set `accumulator` values.\n     * @param {Function} iteratee The iteratee to transform values.\n     * @param {Object} accumulator The initial inverted object.\n     * @returns {Function} Returns `accumulator`.\n     */\n    function baseInverter(object, setter, iteratee, accumulator) {\n      baseForOwn(object, function(value, key, object) {\n        setter(accumulator, iteratee(value), key, object);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The base implementation of `_.invoke` without support for individual\n     * method arguments.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {Array} args The arguments to invoke the method with.\n     * @returns {*} Returns the result of the invoked method.\n     */\n    function baseInvoke(object, path, args) {\n      path = castPath(path, object);\n      object = parent(object, path);\n      var func = object == null ? object : object[toKey(last(path))];\n      return func == null ? undefined : apply(func, object, args);\n    }\n\n    /**\n     * The base implementation of `_.isArguments`.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n     */\n    function baseIsArguments(value) {\n      return isObjectLike(value) && baseGetTag(value) == argsTag;\n    }\n\n    /**\n     * The base implementation of `_.isArrayBuffer` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.\n     */\n    function baseIsArrayBuffer(value) {\n      return isObjectLike(value) && baseGetTag(value) == arrayBufferTag;\n    }\n\n    /**\n     * The base implementation of `_.isDate` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a date object, else `false`.\n     */\n    function baseIsDate(value) {\n      return isObjectLike(value) && baseGetTag(value) == dateTag;\n    }\n\n    /**\n     * The base implementation of `_.isEqual` which supports partial comparisons\n     * and tracks traversed objects.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @param {boolean} bitmask The bitmask flags.\n     *  1 - Unordered comparison\n     *  2 - Partial comparison\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     */\n    function baseIsEqual(value, other, bitmask, customizer, stack) {\n      if (value === other) {\n        return true;\n      }\n      if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n        return value !== value && other !== other;\n      }\n      return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n    }\n\n    /**\n     * A specialized version of `baseIsEqual` for arrays and objects which performs\n     * deep comparisons and tracks traversed objects enabling objects with circular\n     * references to be compared.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n      var objIsArr = isArray(object),\n          othIsArr = isArray(other),\n          objTag = objIsArr ? arrayTag : getTag(object),\n          othTag = othIsArr ? arrayTag : getTag(other);\n\n      objTag = objTag == argsTag ? objectTag : objTag;\n      othTag = othTag == argsTag ? objectTag : othTag;\n\n      var objIsObj = objTag == objectTag,\n          othIsObj = othTag == objectTag,\n          isSameTag = objTag == othTag;\n\n      if (isSameTag && isBuffer(object)) {\n        if (!isBuffer(other)) {\n          return false;\n        }\n        objIsArr = true;\n        objIsObj = false;\n      }\n      if (isSameTag && !objIsObj) {\n        stack || (stack = new Stack);\n        return (objIsArr || isTypedArray(object))\n          ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n          : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n      }\n      if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n        var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n            othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n        if (objIsWrapped || othIsWrapped) {\n          var objUnwrapped = objIsWrapped ? object.value() : object,\n              othUnwrapped = othIsWrapped ? other.value() : other;\n\n          stack || (stack = new Stack);\n          return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n        }\n      }\n      if (!isSameTag) {\n        return false;\n      }\n      stack || (stack = new Stack);\n      return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n    }\n\n    /**\n     * The base implementation of `_.isMap` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n     */\n    function baseIsMap(value) {\n      return isObjectLike(value) && getTag(value) == mapTag;\n    }\n\n    /**\n     * The base implementation of `_.isMatch` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @param {Array} matchData The property names, values, and compare flags to match.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     */\n    function baseIsMatch(object, source, matchData, customizer) {\n      var index = matchData.length,\n          length = index,\n          noCustomizer = !customizer;\n\n      if (object == null) {\n        return !length;\n      }\n      object = Object(object);\n      while (index--) {\n        var data = matchData[index];\n        if ((noCustomizer && data[2])\n              ? data[1] !== object[data[0]]\n              : !(data[0] in object)\n            ) {\n          return false;\n        }\n      }\n      while (++index < length) {\n        data = matchData[index];\n        var key = data[0],\n            objValue = object[key],\n            srcValue = data[1];\n\n        if (noCustomizer && data[2]) {\n          if (objValue === undefined && !(key in object)) {\n            return false;\n          }\n        } else {\n          var stack = new Stack;\n          if (customizer) {\n            var result = customizer(objValue, srcValue, key, object, source, stack);\n          }\n          if (!(result === undefined\n                ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n                : result\n              )) {\n            return false;\n          }\n        }\n      }\n      return true;\n    }\n\n    /**\n     * The base implementation of `_.isNative` without bad shim checks.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a native function,\n     *  else `false`.\n     */\n    function baseIsNative(value) {\n      if (!isObject(value) || isMasked(value)) {\n        return false;\n      }\n      var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n      return pattern.test(toSource(value));\n    }\n\n    /**\n     * The base implementation of `_.isRegExp` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.\n     */\n    function baseIsRegExp(value) {\n      return isObjectLike(value) && baseGetTag(value) == regexpTag;\n    }\n\n    /**\n     * The base implementation of `_.isSet` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n     */\n    function baseIsSet(value) {\n      return isObjectLike(value) && getTag(value) == setTag;\n    }\n\n    /**\n     * The base implementation of `_.isTypedArray` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n     */\n    function baseIsTypedArray(value) {\n      return isObjectLike(value) &&\n        isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n    }\n\n    /**\n     * The base implementation of `_.iteratee`.\n     *\n     * @private\n     * @param {*} [value=_.identity] The value to convert to an iteratee.\n     * @returns {Function} Returns the iteratee.\n     */\n    function baseIteratee(value) {\n      // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n      // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n      if (typeof value == 'function') {\n        return value;\n      }\n      if (value == null) {\n        return identity;\n      }\n      if (typeof value == 'object') {\n        return isArray(value)\n          ? baseMatchesProperty(value[0], value[1])\n          : baseMatches(value);\n      }\n      return property(value);\n    }\n\n    /**\n     * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function baseKeys(object) {\n      if (!isPrototype(object)) {\n        return nativeKeys(object);\n      }\n      var result = [];\n      for (var key in Object(object)) {\n        if (hasOwnProperty.call(object, key) && key != 'constructor') {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function baseKeysIn(object) {\n      if (!isObject(object)) {\n        return nativeKeysIn(object);\n      }\n      var isProto = isPrototype(object),\n          result = [];\n\n      for (var key in object) {\n        if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.lt` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than `other`,\n     *  else `false`.\n     */\n    function baseLt(value, other) {\n      return value < other;\n    }\n\n    /**\n     * The base implementation of `_.map` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array} Returns the new mapped array.\n     */\n    function baseMap(collection, iteratee) {\n      var index = -1,\n          result = isArrayLike(collection) ? Array(collection.length) : [];\n\n      baseEach(collection, function(value, key, collection) {\n        result[++index] = iteratee(value, key, collection);\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.matches` which doesn't clone `source`.\n     *\n     * @private\n     * @param {Object} source The object of property values to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseMatches(source) {\n      var matchData = getMatchData(source);\n      if (matchData.length == 1 && matchData[0][2]) {\n        return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n      }\n      return function(object) {\n        return object === source || baseIsMatch(object, source, matchData);\n      };\n    }\n\n    /**\n     * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n     *\n     * @private\n     * @param {string} path The path of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseMatchesProperty(path, srcValue) {\n      if (isKey(path) && isStrictComparable(srcValue)) {\n        return matchesStrictComparable(toKey(path), srcValue);\n      }\n      return function(object) {\n        var objValue = get(object, path);\n        return (objValue === undefined && objValue === srcValue)\n          ? hasIn(object, path)\n          : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n      };\n    }\n\n    /**\n     * The base implementation of `_.merge` without support for multiple sources.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {number} srcIndex The index of `source`.\n     * @param {Function} [customizer] The function to customize merged values.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     */\n    function baseMerge(object, source, srcIndex, customizer, stack) {\n      if (object === source) {\n        return;\n      }\n      baseFor(source, function(srcValue, key) {\n        stack || (stack = new Stack);\n        if (isObject(srcValue)) {\n          baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n        }\n        else {\n          var newValue = customizer\n            ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n            : undefined;\n\n          if (newValue === undefined) {\n            newValue = srcValue;\n          }\n          assignMergeValue(object, key, newValue);\n        }\n      }, keysIn);\n    }\n\n    /**\n     * A specialized version of `baseMerge` for arrays and objects which performs\n     * deep merges and tracks traversed objects enabling objects with circular\n     * references to be merged.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {string} key The key of the value to merge.\n     * @param {number} srcIndex The index of `source`.\n     * @param {Function} mergeFunc The function to merge values.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     */\n    function baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n      var objValue = safeGet(object, key),\n          srcValue = safeGet(source, key),\n          stacked = stack.get(srcValue);\n\n      if (stacked) {\n        assignMergeValue(object, key, stacked);\n        return;\n      }\n      var newValue = customizer\n        ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      var isCommon = newValue === undefined;\n\n      if (isCommon) {\n        var isArr = isArray(srcValue),\n            isBuff = !isArr && isBuffer(srcValue),\n            isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n        newValue = srcValue;\n        if (isArr || isBuff || isTyped) {\n          if (isArray(objValue)) {\n            newValue = objValue;\n          }\n          else if (isArrayLikeObject(objValue)) {\n            newValue = copyArray(objValue);\n          }\n          else if (isBuff) {\n            isCommon = false;\n            newValue = cloneBuffer(srcValue, true);\n          }\n          else if (isTyped) {\n            isCommon = false;\n            newValue = cloneTypedArray(srcValue, true);\n          }\n          else {\n            newValue = [];\n          }\n        }\n        else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n          newValue = objValue;\n          if (isArguments(objValue)) {\n            newValue = toPlainObject(objValue);\n          }\n          else if (!isObject(objValue) || isFunction(objValue)) {\n            newValue = initCloneObject(srcValue);\n          }\n        }\n        else {\n          isCommon = false;\n        }\n      }\n      if (isCommon) {\n        // Recursively merge objects and arrays (susceptible to call stack limits).\n        stack.set(srcValue, newValue);\n        mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n        stack['delete'](srcValue);\n      }\n      assignMergeValue(object, key, newValue);\n    }\n\n    /**\n     * The base implementation of `_.nth` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {Array} array The array to query.\n     * @param {number} n The index of the element to return.\n     * @returns {*} Returns the nth element of `array`.\n     */\n    function baseNth(array, n) {\n      var length = array.length;\n      if (!length) {\n        return;\n      }\n      n += n < 0 ? length : 0;\n      return isIndex(n, length) ? array[n] : undefined;\n    }\n\n    /**\n     * The base implementation of `_.orderBy` without param guards.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.\n     * @param {string[]} orders The sort orders of `iteratees`.\n     * @returns {Array} Returns the new sorted array.\n     */\n    function baseOrderBy(collection, iteratees, orders) {\n      if (iteratees.length) {\n        iteratees = arrayMap(iteratees, function(iteratee) {\n          if (isArray(iteratee)) {\n            return function(value) {\n              return baseGet(value, iteratee.length === 1 ? iteratee[0] : iteratee);\n            }\n          }\n          return iteratee;\n        });\n      } else {\n        iteratees = [identity];\n      }\n\n      var index = -1;\n      iteratees = arrayMap(iteratees, baseUnary(getIteratee()));\n\n      var result = baseMap(collection, function(value, key, collection) {\n        var criteria = arrayMap(iteratees, function(iteratee) {\n          return iteratee(value);\n        });\n        return { 'criteria': criteria, 'index': ++index, 'value': value };\n      });\n\n      return baseSortBy(result, function(object, other) {\n        return compareMultiple(object, other, orders);\n      });\n    }\n\n    /**\n     * The base implementation of `_.pick` without support for individual\n     * property identifiers.\n     *\n     * @private\n     * @param {Object} object The source object.\n     * @param {string[]} paths The property paths to pick.\n     * @returns {Object} Returns the new object.\n     */\n    function basePick(object, paths) {\n      return basePickBy(object, paths, function(value, path) {\n        return hasIn(object, path);\n      });\n    }\n\n    /**\n     * The base implementation of  `_.pickBy` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The source object.\n     * @param {string[]} paths The property paths to pick.\n     * @param {Function} predicate The function invoked per property.\n     * @returns {Object} Returns the new object.\n     */\n    function basePickBy(object, paths, predicate) {\n      var index = -1,\n          length = paths.length,\n          result = {};\n\n      while (++index < length) {\n        var path = paths[index],\n            value = baseGet(object, path);\n\n        if (predicate(value, path)) {\n          baseSet(result, castPath(path, object), value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseProperty` which supports deep paths.\n     *\n     * @private\n     * @param {Array|string} path The path of the property to get.\n     * @returns {Function} Returns the new accessor function.\n     */\n    function basePropertyDeep(path) {\n      return function(object) {\n        return baseGet(object, path);\n      };\n    }\n\n    /**\n     * The base implementation of `_.pullAllBy` without support for iteratee\n     * shorthands.\n     *\n     * @private\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns `array`.\n     */\n    function basePullAll(array, values, iteratee, comparator) {\n      var indexOf = comparator ? baseIndexOfWith : baseIndexOf,\n          index = -1,\n          length = values.length,\n          seen = array;\n\n      if (array === values) {\n        values = copyArray(values);\n      }\n      if (iteratee) {\n        seen = arrayMap(array, baseUnary(iteratee));\n      }\n      while (++index < length) {\n        var fromIndex = 0,\n            value = values[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        while ((fromIndex = indexOf(seen, computed, fromIndex, comparator)) > -1) {\n          if (seen !== array) {\n            splice.call(seen, fromIndex, 1);\n          }\n          splice.call(array, fromIndex, 1);\n        }\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.pullAt` without support for individual\n     * indexes or capturing the removed elements.\n     *\n     * @private\n     * @param {Array} array The array to modify.\n     * @param {number[]} indexes The indexes of elements to remove.\n     * @returns {Array} Returns `array`.\n     */\n    function basePullAt(array, indexes) {\n      var length = array ? indexes.length : 0,\n          lastIndex = length - 1;\n\n      while (length--) {\n        var index = indexes[length];\n        if (length == lastIndex || index !== previous) {\n          var previous = index;\n          if (isIndex(index)) {\n            splice.call(array, index, 1);\n          } else {\n            baseUnset(array, index);\n          }\n        }\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.random` without support for returning\n     * floating-point numbers.\n     *\n     * @private\n     * @param {number} lower The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the random number.\n     */\n    function baseRandom(lower, upper) {\n      return lower + nativeFloor(nativeRandom() * (upper - lower + 1));\n    }\n\n    /**\n     * The base implementation of `_.range` and `_.rangeRight` which doesn't\n     * coerce arguments.\n     *\n     * @private\n     * @param {number} start The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} step The value to increment or decrement by.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Array} Returns the range of numbers.\n     */\n    function baseRange(start, end, step, fromRight) {\n      var index = -1,\n          length = nativeMax(nativeCeil((end - start) / (step || 1)), 0),\n          result = Array(length);\n\n      while (length--) {\n        result[fromRight ? length : ++index] = start;\n        start += step;\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.repeat` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {string} string The string to repeat.\n     * @param {number} n The number of times to repeat the string.\n     * @returns {string} Returns the repeated string.\n     */\n    function baseRepeat(string, n) {\n      var result = '';\n      if (!string || n < 1 || n > MAX_SAFE_INTEGER) {\n        return result;\n      }\n      // Leverage the exponentiation by squaring algorithm for a faster repeat.\n      // See https://en.wikipedia.org/wiki/Exponentiation_by_squaring for more details.\n      do {\n        if (n % 2) {\n          result += string;\n        }\n        n = nativeFloor(n / 2);\n        if (n) {\n          string += string;\n        }\n      } while (n);\n\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @returns {Function} Returns the new function.\n     */\n    function baseRest(func, start) {\n      return setToString(overRest(func, start, identity), func + '');\n    }\n\n    /**\n     * The base implementation of `_.sample`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to sample.\n     * @returns {*} Returns the random element.\n     */\n    function baseSample(collection) {\n      return arraySample(values(collection));\n    }\n\n    /**\n     * The base implementation of `_.sampleSize` without param guards.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to sample.\n     * @param {number} n The number of elements to sample.\n     * @returns {Array} Returns the random elements.\n     */\n    function baseSampleSize(collection, n) {\n      var array = values(collection);\n      return shuffleSelf(array, baseClamp(n, 0, array.length));\n    }\n\n    /**\n     * The base implementation of `_.set`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @param {Function} [customizer] The function to customize path creation.\n     * @returns {Object} Returns `object`.\n     */\n    function baseSet(object, path, value, customizer) {\n      if (!isObject(object)) {\n        return object;\n      }\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length,\n          lastIndex = length - 1,\n          nested = object;\n\n      while (nested != null && ++index < length) {\n        var key = toKey(path[index]),\n            newValue = value;\n\n        if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n          return object;\n        }\n\n        if (index != lastIndex) {\n          var objValue = nested[key];\n          newValue = customizer ? customizer(objValue, key, nested) : undefined;\n          if (newValue === undefined) {\n            newValue = isObject(objValue)\n              ? objValue\n              : (isIndex(path[index + 1]) ? [] : {});\n          }\n        }\n        assignValue(nested, key, newValue);\n        nested = nested[key];\n      }\n      return object;\n    }\n\n    /**\n     * The base implementation of `setData` without support for hot loop shorting.\n     *\n     * @private\n     * @param {Function} func The function to associate metadata with.\n     * @param {*} data The metadata.\n     * @returns {Function} Returns `func`.\n     */\n    var baseSetData = !metaMap ? identity : function(func, data) {\n      metaMap.set(func, data);\n      return func;\n    };\n\n    /**\n     * The base implementation of `setToString` without support for hot loop shorting.\n     *\n     * @private\n     * @param {Function} func The function to modify.\n     * @param {Function} string The `toString` result.\n     * @returns {Function} Returns `func`.\n     */\n    var baseSetToString = !defineProperty ? identity : function(func, string) {\n      return defineProperty(func, 'toString', {\n        'configurable': true,\n        'enumerable': false,\n        'value': constant(string),\n        'writable': true\n      });\n    };\n\n    /**\n     * The base implementation of `_.shuffle`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     */\n    function baseShuffle(collection) {\n      return shuffleSelf(values(collection));\n    }\n\n    /**\n     * The base implementation of `_.slice` without an iteratee call guard.\n     *\n     * @private\n     * @param {Array} array The array to slice.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function baseSlice(array, start, end) {\n      var index = -1,\n          length = array.length;\n\n      if (start < 0) {\n        start = -start > length ? 0 : (length + start);\n      }\n      end = end > length ? length : end;\n      if (end < 0) {\n        end += length;\n      }\n      length = start > end ? 0 : ((end - start) >>> 0);\n      start >>>= 0;\n\n      var result = Array(length);\n      while (++index < length) {\n        result[index] = array[index + start];\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.some` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {boolean} Returns `true` if any element passes the predicate check,\n     *  else `false`.\n     */\n    function baseSome(collection, predicate) {\n      var result;\n\n      baseEach(collection, function(value, index, collection) {\n        result = predicate(value, index, collection);\n        return !result;\n      });\n      return !!result;\n    }\n\n    /**\n     * The base implementation of `_.sortedIndex` and `_.sortedLastIndex` which\n     * performs a binary search of `array` to determine the index at which `value`\n     * should be inserted into `array` in order to maintain its sort order.\n     *\n     * @private\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {boolean} [retHighest] Specify returning the highest qualified index.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     */\n    function baseSortedIndex(array, value, retHighest) {\n      var low = 0,\n          high = array == null ? low : array.length;\n\n      if (typeof value == 'number' && value === value && high <= HALF_MAX_ARRAY_LENGTH) {\n        while (low < high) {\n          var mid = (low + high) >>> 1,\n              computed = array[mid];\n\n          if (computed !== null && !isSymbol(computed) &&\n              (retHighest ? (computed <= value) : (computed < value))) {\n            low = mid + 1;\n          } else {\n            high = mid;\n          }\n        }\n        return high;\n      }\n      return baseSortedIndexBy(array, value, identity, retHighest);\n    }\n\n    /**\n     * The base implementation of `_.sortedIndexBy` and `_.sortedLastIndexBy`\n     * which invokes `iteratee` for `value` and each element of `array` to compute\n     * their sort ranking. The iteratee is invoked with one argument; (value).\n     *\n     * @private\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} iteratee The iteratee invoked per element.\n     * @param {boolean} [retHighest] Specify returning the highest qualified index.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     */\n    function baseSortedIndexBy(array, value, iteratee, retHighest) {\n      var low = 0,\n          high = array == null ? 0 : array.length;\n      if (high === 0) {\n        return 0;\n      }\n\n      value = iteratee(value);\n      var valIsNaN = value !== value,\n          valIsNull = value === null,\n          valIsSymbol = isSymbol(value),\n          valIsUndefined = value === undefined;\n\n      while (low < high) {\n        var mid = nativeFloor((low + high) / 2),\n            computed = iteratee(array[mid]),\n            othIsDefined = computed !== undefined,\n            othIsNull = computed === null,\n            othIsReflexive = computed === computed,\n            othIsSymbol = isSymbol(computed);\n\n        if (valIsNaN) {\n          var setLow = retHighest || othIsReflexive;\n        } else if (valIsUndefined) {\n          setLow = othIsReflexive && (retHighest || othIsDefined);\n        } else if (valIsNull) {\n          setLow = othIsReflexive && othIsDefined && (retHighest || !othIsNull);\n        } else if (valIsSymbol) {\n          setLow = othIsReflexive && othIsDefined && !othIsNull && (retHighest || !othIsSymbol);\n        } else if (othIsNull || othIsSymbol) {\n          setLow = false;\n        } else {\n          setLow = retHighest ? (computed <= value) : (computed < value);\n        }\n        if (setLow) {\n          low = mid + 1;\n        } else {\n          high = mid;\n        }\n      }\n      return nativeMin(high, MAX_ARRAY_INDEX);\n    }\n\n    /**\n     * The base implementation of `_.sortedUniq` and `_.sortedUniqBy` without\n     * support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     */\n    function baseSortedUniq(array, iteratee) {\n      var index = -1,\n          length = array.length,\n          resIndex = 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        if (!index || !eq(computed, seen)) {\n          var seen = computed;\n          result[resIndex++] = value === 0 ? 0 : value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.toNumber` which doesn't ensure correct\n     * conversions of binary, hexadecimal, or octal string values.\n     *\n     * @private\n     * @param {*} value The value to process.\n     * @returns {number} Returns the number.\n     */\n    function baseToNumber(value) {\n      if (typeof value == 'number') {\n        return value;\n      }\n      if (isSymbol(value)) {\n        return NAN;\n      }\n      return +value;\n    }\n\n    /**\n     * The base implementation of `_.toString` which doesn't convert nullish\n     * values to empty strings.\n     *\n     * @private\n     * @param {*} value The value to process.\n     * @returns {string} Returns the string.\n     */\n    function baseToString(value) {\n      // Exit early for strings to avoid a performance hit in some environments.\n      if (typeof value == 'string') {\n        return value;\n      }\n      if (isArray(value)) {\n        // Recursively convert values (susceptible to call stack limits).\n        return arrayMap(value, baseToString) + '';\n      }\n      if (isSymbol(value)) {\n        return symbolToString ? symbolToString.call(value) : '';\n      }\n      var result = (value + '');\n      return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n    }\n\n    /**\n     * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     */\n    function baseUniq(array, iteratee, comparator) {\n      var index = -1,\n          includes = arrayIncludes,\n          length = array.length,\n          isCommon = true,\n          result = [],\n          seen = result;\n\n      if (comparator) {\n        isCommon = false;\n        includes = arrayIncludesWith;\n      }\n      else if (length >= LARGE_ARRAY_SIZE) {\n        var set = iteratee ? null : createSet(array);\n        if (set) {\n          return setToArray(set);\n        }\n        isCommon = false;\n        includes = cacheHas;\n        seen = new SetCache;\n      }\n      else {\n        seen = iteratee ? [] : result;\n      }\n      outer:\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (isCommon && computed === computed) {\n          var seenIndex = seen.length;\n          while (seenIndex--) {\n            if (seen[seenIndex] === computed) {\n              continue outer;\n            }\n          }\n          if (iteratee) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n        else if (!includes(seen, computed, comparator)) {\n          if (seen !== result) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.unset`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The property path to unset.\n     * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n     */\n    function baseUnset(object, path) {\n      path = castPath(path, object);\n      object = parent(object, path);\n      return object == null || delete object[toKey(last(path))];\n    }\n\n    /**\n     * The base implementation of `_.update`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to update.\n     * @param {Function} updater The function to produce the updated value.\n     * @param {Function} [customizer] The function to customize path creation.\n     * @returns {Object} Returns `object`.\n     */\n    function baseUpdate(object, path, updater, customizer) {\n      return baseSet(object, path, updater(baseGet(object, path)), customizer);\n    }\n\n    /**\n     * The base implementation of methods like `_.dropWhile` and `_.takeWhile`\n     * without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to query.\n     * @param {Function} predicate The function invoked per iteration.\n     * @param {boolean} [isDrop] Specify dropping elements instead of taking them.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function baseWhile(array, predicate, isDrop, fromRight) {\n      var length = array.length,\n          index = fromRight ? length : -1;\n\n      while ((fromRight ? index-- : ++index < length) &&\n        predicate(array[index], index, array)) {}\n\n      return isDrop\n        ? baseSlice(array, (fromRight ? 0 : index), (fromRight ? index + 1 : length))\n        : baseSlice(array, (fromRight ? index + 1 : 0), (fromRight ? length : index));\n    }\n\n    /**\n     * The base implementation of `wrapperValue` which returns the result of\n     * performing a sequence of actions on the unwrapped `value`, where each\n     * successive action is supplied the return value of the previous.\n     *\n     * @private\n     * @param {*} value The unwrapped value.\n     * @param {Array} actions Actions to perform to resolve the unwrapped value.\n     * @returns {*} Returns the resolved value.\n     */\n    function baseWrapperValue(value, actions) {\n      var result = value;\n      if (result instanceof LazyWrapper) {\n        result = result.value();\n      }\n      return arrayReduce(actions, function(result, action) {\n        return action.func.apply(action.thisArg, arrayPush([result], action.args));\n      }, result);\n    }\n\n    /**\n     * The base implementation of methods like `_.xor`, without support for\n     * iteratee shorthands, that accepts an array of arrays to inspect.\n     *\n     * @private\n     * @param {Array} arrays The arrays to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of values.\n     */\n    function baseXor(arrays, iteratee, comparator) {\n      var length = arrays.length;\n      if (length < 2) {\n        return length ? baseUniq(arrays[0]) : [];\n      }\n      var index = -1,\n          result = Array(length);\n\n      while (++index < length) {\n        var array = arrays[index],\n            othIndex = -1;\n\n        while (++othIndex < length) {\n          if (othIndex != index) {\n            result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n          }\n        }\n      }\n      return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n    }\n\n    /**\n     * This base implementation of `_.zipObject` which assigns values using `assignFunc`.\n     *\n     * @private\n     * @param {Array} props The property identifiers.\n     * @param {Array} values The property values.\n     * @param {Function} assignFunc The function to assign values.\n     * @returns {Object} Returns the new object.\n     */\n    function baseZipObject(props, values, assignFunc) {\n      var index = -1,\n          length = props.length,\n          valsLength = values.length,\n          result = {};\n\n      while (++index < length) {\n        var value = index < valsLength ? values[index] : undefined;\n        assignFunc(result, props[index], value);\n      }\n      return result;\n    }\n\n    /**\n     * Casts `value` to an empty array if it's not an array like object.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {Array|Object} Returns the cast array-like object.\n     */\n    function castArrayLikeObject(value) {\n      return isArrayLikeObject(value) ? value : [];\n    }\n\n    /**\n     * Casts `value` to `identity` if it's not a function.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {Function} Returns cast function.\n     */\n    function castFunction(value) {\n      return typeof value == 'function' ? value : identity;\n    }\n\n    /**\n     * Casts `value` to a path array if it's not one.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @param {Object} [object] The object to query keys on.\n     * @returns {Array} Returns the cast property path array.\n     */\n    function castPath(value, object) {\n      if (isArray(value)) {\n        return value;\n      }\n      return isKey(value, object) ? [value] : stringToPath(toString(value));\n    }\n\n    /**\n     * A `baseRest` alias which can be replaced with `identity` by module\n     * replacement plugins.\n     *\n     * @private\n     * @type {Function}\n     * @param {Function} func The function to apply a rest parameter to.\n     * @returns {Function} Returns the new function.\n     */\n    var castRest = baseRest;\n\n    /**\n     * Casts `array` to a slice if it's needed.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {number} start The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the cast slice.\n     */\n    function castSlice(array, start, end) {\n      var length = array.length;\n      end = end === undefined ? length : end;\n      return (!start && end >= length) ? array : baseSlice(array, start, end);\n    }\n\n    /**\n     * A simple wrapper around the global [`clearTimeout`](https://mdn.io/clearTimeout).\n     *\n     * @private\n     * @param {number|Object} id The timer id or timeout object of the timer to clear.\n     */\n    var clearTimeout = ctxClearTimeout || function(id) {\n      return root.clearTimeout(id);\n    };\n\n    /**\n     * Creates a clone of  `buffer`.\n     *\n     * @private\n     * @param {Buffer} buffer The buffer to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Buffer} Returns the cloned buffer.\n     */\n    function cloneBuffer(buffer, isDeep) {\n      if (isDeep) {\n        return buffer.slice();\n      }\n      var length = buffer.length,\n          result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n      buffer.copy(result);\n      return result;\n    }\n\n    /**\n     * Creates a clone of `arrayBuffer`.\n     *\n     * @private\n     * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n     * @returns {ArrayBuffer} Returns the cloned array buffer.\n     */\n    function cloneArrayBuffer(arrayBuffer) {\n      var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n      new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n      return result;\n    }\n\n    /**\n     * Creates a clone of `dataView`.\n     *\n     * @private\n     * @param {Object} dataView The data view to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the cloned data view.\n     */\n    function cloneDataView(dataView, isDeep) {\n      var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n      return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n    }\n\n    /**\n     * Creates a clone of `regexp`.\n     *\n     * @private\n     * @param {Object} regexp The regexp to clone.\n     * @returns {Object} Returns the cloned regexp.\n     */\n    function cloneRegExp(regexp) {\n      var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n      result.lastIndex = regexp.lastIndex;\n      return result;\n    }\n\n    /**\n     * Creates a clone of the `symbol` object.\n     *\n     * @private\n     * @param {Object} symbol The symbol object to clone.\n     * @returns {Object} Returns the cloned symbol object.\n     */\n    function cloneSymbol(symbol) {\n      return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n    }\n\n    /**\n     * Creates a clone of `typedArray`.\n     *\n     * @private\n     * @param {Object} typedArray The typed array to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the cloned typed array.\n     */\n    function cloneTypedArray(typedArray, isDeep) {\n      var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n      return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n    }\n\n    /**\n     * Compares values to sort them in ascending order.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {number} Returns the sort order indicator for `value`.\n     */\n    function compareAscending(value, other) {\n      if (value !== other) {\n        var valIsDefined = value !== undefined,\n            valIsNull = value === null,\n            valIsReflexive = value === value,\n            valIsSymbol = isSymbol(value);\n\n        var othIsDefined = other !== undefined,\n            othIsNull = other === null,\n            othIsReflexive = other === other,\n            othIsSymbol = isSymbol(other);\n\n        if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||\n            (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||\n            (valIsNull && othIsDefined && othIsReflexive) ||\n            (!valIsDefined && othIsReflexive) ||\n            !valIsReflexive) {\n          return 1;\n        }\n        if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||\n            (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||\n            (othIsNull && valIsDefined && valIsReflexive) ||\n            (!othIsDefined && valIsReflexive) ||\n            !othIsReflexive) {\n          return -1;\n        }\n      }\n      return 0;\n    }\n\n    /**\n     * Used by `_.orderBy` to compare multiple properties of a value to another\n     * and stable sort them.\n     *\n     * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,\n     * specify an order of \"desc\" for descending or \"asc\" for ascending sort order\n     * of corresponding values.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {boolean[]|string[]} orders The order to sort by for each property.\n     * @returns {number} Returns the sort order indicator for `object`.\n     */\n    function compareMultiple(object, other, orders) {\n      var index = -1,\n          objCriteria = object.criteria,\n          othCriteria = other.criteria,\n          length = objCriteria.length,\n          ordersLength = orders.length;\n\n      while (++index < length) {\n        var result = compareAscending(objCriteria[index], othCriteria[index]);\n        if (result) {\n          if (index >= ordersLength) {\n            return result;\n          }\n          var order = orders[index];\n          return result * (order == 'desc' ? -1 : 1);\n        }\n      }\n      // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n      // that causes it, under certain circumstances, to provide the same value for\n      // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247\n      // for more details.\n      //\n      // This also ensures a stable sort in V8 and other engines.\n      // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n      return object.index - other.index;\n    }\n\n    /**\n     * Creates an array that is the composition of partially applied arguments,\n     * placeholders, and provided arguments into a single array of arguments.\n     *\n     * @private\n     * @param {Array} args The provided arguments.\n     * @param {Array} partials The arguments to prepend to those provided.\n     * @param {Array} holders The `partials` placeholder indexes.\n     * @params {boolean} [isCurried] Specify composing for a curried function.\n     * @returns {Array} Returns the new array of composed arguments.\n     */\n    function composeArgs(args, partials, holders, isCurried) {\n      var argsIndex = -1,\n          argsLength = args.length,\n          holdersLength = holders.length,\n          leftIndex = -1,\n          leftLength = partials.length,\n          rangeLength = nativeMax(argsLength - holdersLength, 0),\n          result = Array(leftLength + rangeLength),\n          isUncurried = !isCurried;\n\n      while (++leftIndex < leftLength) {\n        result[leftIndex] = partials[leftIndex];\n      }\n      while (++argsIndex < holdersLength) {\n        if (isUncurried || argsIndex < argsLength) {\n          result[holders[argsIndex]] = args[argsIndex];\n        }\n      }\n      while (rangeLength--) {\n        result[leftIndex++] = args[argsIndex++];\n      }\n      return result;\n    }\n\n    /**\n     * This function is like `composeArgs` except that the arguments composition\n     * is tailored for `_.partialRight`.\n     *\n     * @private\n     * @param {Array} args The provided arguments.\n     * @param {Array} partials The arguments to append to those provided.\n     * @param {Array} holders The `partials` placeholder indexes.\n     * @params {boolean} [isCurried] Specify composing for a curried function.\n     * @returns {Array} Returns the new array of composed arguments.\n     */\n    function composeArgsRight(args, partials, holders, isCurried) {\n      var argsIndex = -1,\n          argsLength = args.length,\n          holdersIndex = -1,\n          holdersLength = holders.length,\n          rightIndex = -1,\n          rightLength = partials.length,\n          rangeLength = nativeMax(argsLength - holdersLength, 0),\n          result = Array(rangeLength + rightLength),\n          isUncurried = !isCurried;\n\n      while (++argsIndex < rangeLength) {\n        result[argsIndex] = args[argsIndex];\n      }\n      var offset = argsIndex;\n      while (++rightIndex < rightLength) {\n        result[offset + rightIndex] = partials[rightIndex];\n      }\n      while (++holdersIndex < holdersLength) {\n        if (isUncurried || argsIndex < argsLength) {\n          result[offset + holders[holdersIndex]] = args[argsIndex++];\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Copies the values of `source` to `array`.\n     *\n     * @private\n     * @param {Array} source The array to copy values from.\n     * @param {Array} [array=[]] The array to copy values to.\n     * @returns {Array} Returns `array`.\n     */\n    function copyArray(source, array) {\n      var index = -1,\n          length = source.length;\n\n      array || (array = Array(length));\n      while (++index < length) {\n        array[index] = source[index];\n      }\n      return array;\n    }\n\n    /**\n     * Copies properties of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy properties from.\n     * @param {Array} props The property identifiers to copy.\n     * @param {Object} [object={}] The object to copy properties to.\n     * @param {Function} [customizer] The function to customize copied values.\n     * @returns {Object} Returns `object`.\n     */\n    function copyObject(source, props, object, customizer) {\n      var isNew = !object;\n      object || (object = {});\n\n      var index = -1,\n          length = props.length;\n\n      while (++index < length) {\n        var key = props[index];\n\n        var newValue = customizer\n          ? customizer(object[key], source[key], key, object, source)\n          : undefined;\n\n        if (newValue === undefined) {\n          newValue = source[key];\n        }\n        if (isNew) {\n          baseAssignValue(object, key, newValue);\n        } else {\n          assignValue(object, key, newValue);\n        }\n      }\n      return object;\n    }\n\n    /**\n     * Copies own symbols of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy symbols from.\n     * @param {Object} [object={}] The object to copy symbols to.\n     * @returns {Object} Returns `object`.\n     */\n    function copySymbols(source, object) {\n      return copyObject(source, getSymbols(source), object);\n    }\n\n    /**\n     * Copies own and inherited symbols of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy symbols from.\n     * @param {Object} [object={}] The object to copy symbols to.\n     * @returns {Object} Returns `object`.\n     */\n    function copySymbolsIn(source, object) {\n      return copyObject(source, getSymbolsIn(source), object);\n    }\n\n    /**\n     * Creates a function like `_.groupBy`.\n     *\n     * @private\n     * @param {Function} setter The function to set accumulator values.\n     * @param {Function} [initializer] The accumulator object initializer.\n     * @returns {Function} Returns the new aggregator function.\n     */\n    function createAggregator(setter, initializer) {\n      return function(collection, iteratee) {\n        var func = isArray(collection) ? arrayAggregator : baseAggregator,\n            accumulator = initializer ? initializer() : {};\n\n        return func(collection, setter, getIteratee(iteratee, 2), accumulator);\n      };\n    }\n\n    /**\n     * Creates a function like `_.assign`.\n     *\n     * @private\n     * @param {Function} assigner The function to assign values.\n     * @returns {Function} Returns the new assigner function.\n     */\n    function createAssigner(assigner) {\n      return baseRest(function(object, sources) {\n        var index = -1,\n            length = sources.length,\n            customizer = length > 1 ? sources[length - 1] : undefined,\n            guard = length > 2 ? sources[2] : undefined;\n\n        customizer = (assigner.length > 3 && typeof customizer == 'function')\n          ? (length--, customizer)\n          : undefined;\n\n        if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n          customizer = length < 3 ? undefined : customizer;\n          length = 1;\n        }\n        object = Object(object);\n        while (++index < length) {\n          var source = sources[index];\n          if (source) {\n            assigner(object, source, index, customizer);\n          }\n        }\n        return object;\n      });\n    }\n\n    /**\n     * Creates a `baseEach` or `baseEachRight` function.\n     *\n     * @private\n     * @param {Function} eachFunc The function to iterate over a collection.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new base function.\n     */\n    function createBaseEach(eachFunc, fromRight) {\n      return function(collection, iteratee) {\n        if (collection == null) {\n          return collection;\n        }\n        if (!isArrayLike(collection)) {\n          return eachFunc(collection, iteratee);\n        }\n        var length = collection.length,\n            index = fromRight ? length : -1,\n            iterable = Object(collection);\n\n        while ((fromRight ? index-- : ++index < length)) {\n          if (iteratee(iterable[index], index, iterable) === false) {\n            break;\n          }\n        }\n        return collection;\n      };\n    }\n\n    /**\n     * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new base function.\n     */\n    function createBaseFor(fromRight) {\n      return function(object, iteratee, keysFunc) {\n        var index = -1,\n            iterable = Object(object),\n            props = keysFunc(object),\n            length = props.length;\n\n        while (length--) {\n          var key = props[fromRight ? length : ++index];\n          if (iteratee(iterable[key], key, iterable) === false) {\n            break;\n          }\n        }\n        return object;\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with the optional `this`\n     * binding of `thisArg`.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createBind(func, bitmask, thisArg) {\n      var isBind = bitmask & WRAP_BIND_FLAG,\n          Ctor = createCtor(func);\n\n      function wrapper() {\n        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n        return fn.apply(isBind ? thisArg : this, arguments);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a function like `_.lowerFirst`.\n     *\n     * @private\n     * @param {string} methodName The name of the `String` case method to use.\n     * @returns {Function} Returns the new case function.\n     */\n    function createCaseFirst(methodName) {\n      return function(string) {\n        string = toString(string);\n\n        var strSymbols = hasUnicode(string)\n          ? stringToArray(string)\n          : undefined;\n\n        var chr = strSymbols\n          ? strSymbols[0]\n          : string.charAt(0);\n\n        var trailing = strSymbols\n          ? castSlice(strSymbols, 1).join('')\n          : string.slice(1);\n\n        return chr[methodName]() + trailing;\n      };\n    }\n\n    /**\n     * Creates a function like `_.camelCase`.\n     *\n     * @private\n     * @param {Function} callback The function to combine each word.\n     * @returns {Function} Returns the new compounder function.\n     */\n    function createCompounder(callback) {\n      return function(string) {\n        return arrayReduce(words(deburr(string).replace(reApos, '')), callback, '');\n      };\n    }\n\n    /**\n     * Creates a function that produces an instance of `Ctor` regardless of\n     * whether it was invoked as part of a `new` expression or by `call` or `apply`.\n     *\n     * @private\n     * @param {Function} Ctor The constructor to wrap.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createCtor(Ctor) {\n      return function() {\n        // Use a `switch` statement to work with class constructors. See\n        // http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist\n        // for more details.\n        var args = arguments;\n        switch (args.length) {\n          case 0: return new Ctor;\n          case 1: return new Ctor(args[0]);\n          case 2: return new Ctor(args[0], args[1]);\n          case 3: return new Ctor(args[0], args[1], args[2]);\n          case 4: return new Ctor(args[0], args[1], args[2], args[3]);\n          case 5: return new Ctor(args[0], args[1], args[2], args[3], args[4]);\n          case 6: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5]);\n          case 7: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5], args[6]);\n        }\n        var thisBinding = baseCreate(Ctor.prototype),\n            result = Ctor.apply(thisBinding, args);\n\n        // Mimic the constructor's `return` behavior.\n        // See https://es5.github.io/#x13.2.2 for more details.\n        return isObject(result) ? result : thisBinding;\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to enable currying.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {number} arity The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createCurry(func, bitmask, arity) {\n      var Ctor = createCtor(func);\n\n      function wrapper() {\n        var length = arguments.length,\n            args = Array(length),\n            index = length,\n            placeholder = getHolder(wrapper);\n\n        while (index--) {\n          args[index] = arguments[index];\n        }\n        var holders = (length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder)\n          ? []\n          : replaceHolders(args, placeholder);\n\n        length -= holders.length;\n        if (length < arity) {\n          return createRecurry(\n            func, bitmask, createHybrid, wrapper.placeholder, undefined,\n            args, holders, undefined, undefined, arity - length);\n        }\n        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n        return apply(fn, this, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a `_.find` or `_.findLast` function.\n     *\n     * @private\n     * @param {Function} findIndexFunc The function to find the collection index.\n     * @returns {Function} Returns the new find function.\n     */\n    function createFind(findIndexFunc) {\n      return function(collection, predicate, fromIndex) {\n        var iterable = Object(collection);\n        if (!isArrayLike(collection)) {\n          var iteratee = getIteratee(predicate, 3);\n          collection = keys(collection);\n          predicate = function(key) { return iteratee(iterable[key], key, iterable); };\n        }\n        var index = findIndexFunc(collection, predicate, fromIndex);\n        return index > -1 ? iterable[iteratee ? collection[index] : index] : undefined;\n      };\n    }\n\n    /**\n     * Creates a `_.flow` or `_.flowRight` function.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new flow function.\n     */\n    function createFlow(fromRight) {\n      return flatRest(function(funcs) {\n        var length = funcs.length,\n            index = length,\n            prereq = LodashWrapper.prototype.thru;\n\n        if (fromRight) {\n          funcs.reverse();\n        }\n        while (index--) {\n          var func = funcs[index];\n          if (typeof func != 'function') {\n            throw new TypeError(FUNC_ERROR_TEXT);\n          }\n          if (prereq && !wrapper && getFuncName(func) == 'wrapper') {\n            var wrapper = new LodashWrapper([], true);\n          }\n        }\n        index = wrapper ? index : length;\n        while (++index < length) {\n          func = funcs[index];\n\n          var funcName = getFuncName(func),\n              data = funcName == 'wrapper' ? getData(func) : undefined;\n\n          if (data && isLaziable(data[0]) &&\n                data[1] == (WRAP_ARY_FLAG | WRAP_CURRY_FLAG | WRAP_PARTIAL_FLAG | WRAP_REARG_FLAG) &&\n                !data[4].length && data[9] == 1\n              ) {\n            wrapper = wrapper[getFuncName(data[0])].apply(wrapper, data[3]);\n          } else {\n            wrapper = (func.length == 1 && isLaziable(func))\n              ? wrapper[funcName]()\n              : wrapper.thru(func);\n          }\n        }\n        return function() {\n          var args = arguments,\n              value = args[0];\n\n          if (wrapper && args.length == 1 && isArray(value)) {\n            return wrapper.plant(value).value();\n          }\n          var index = 0,\n              result = length ? funcs[index].apply(this, args) : value;\n\n          while (++index < length) {\n            result = funcs[index].call(this, result);\n          }\n          return result;\n        };\n      });\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with optional `this`\n     * binding of `thisArg`, partial application, and currying.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to prepend to those provided to\n     *  the new function.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [partialsRight] The arguments to append to those provided\n     *  to the new function.\n     * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {\n      var isAry = bitmask & WRAP_ARY_FLAG,\n          isBind = bitmask & WRAP_BIND_FLAG,\n          isBindKey = bitmask & WRAP_BIND_KEY_FLAG,\n          isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),\n          isFlip = bitmask & WRAP_FLIP_FLAG,\n          Ctor = isBindKey ? undefined : createCtor(func);\n\n      function wrapper() {\n        var length = arguments.length,\n            args = Array(length),\n            index = length;\n\n        while (index--) {\n          args[index] = arguments[index];\n        }\n        if (isCurried) {\n          var placeholder = getHolder(wrapper),\n              holdersCount = countHolders(args, placeholder);\n        }\n        if (partials) {\n          args = composeArgs(args, partials, holders, isCurried);\n        }\n        if (partialsRight) {\n          args = composeArgsRight(args, partialsRight, holdersRight, isCurried);\n        }\n        length -= holdersCount;\n        if (isCurried && length < arity) {\n          var newHolders = replaceHolders(args, placeholder);\n          return createRecurry(\n            func, bitmask, createHybrid, wrapper.placeholder, thisArg,\n            args, newHolders, argPos, ary, arity - length\n          );\n        }\n        var thisBinding = isBind ? thisArg : this,\n            fn = isBindKey ? thisBinding[func] : func;\n\n        length = args.length;\n        if (argPos) {\n          args = reorder(args, argPos);\n        } else if (isFlip && length > 1) {\n          args.reverse();\n        }\n        if (isAry && ary < length) {\n          args.length = ary;\n        }\n        if (this && this !== root && this instanceof wrapper) {\n          fn = Ctor || createCtor(fn);\n        }\n        return fn.apply(thisBinding, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a function like `_.invertBy`.\n     *\n     * @private\n     * @param {Function} setter The function to set accumulator values.\n     * @param {Function} toIteratee The function to resolve iteratees.\n     * @returns {Function} Returns the new inverter function.\n     */\n    function createInverter(setter, toIteratee) {\n      return function(object, iteratee) {\n        return baseInverter(object, setter, toIteratee(iteratee), {});\n      };\n    }\n\n    /**\n     * Creates a function that performs a mathematical operation on two values.\n     *\n     * @private\n     * @param {Function} operator The function to perform the operation.\n     * @param {number} [defaultValue] The value used for `undefined` arguments.\n     * @returns {Function} Returns the new mathematical operation function.\n     */\n    function createMathOperation(operator, defaultValue) {\n      return function(value, other) {\n        var result;\n        if (value === undefined && other === undefined) {\n          return defaultValue;\n        }\n        if (value !== undefined) {\n          result = value;\n        }\n        if (other !== undefined) {\n          if (result === undefined) {\n            return other;\n          }\n          if (typeof value == 'string' || typeof other == 'string') {\n            value = baseToString(value);\n            other = baseToString(other);\n          } else {\n            value = baseToNumber(value);\n            other = baseToNumber(other);\n          }\n          result = operator(value, other);\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function like `_.over`.\n     *\n     * @private\n     * @param {Function} arrayFunc The function to iterate over iteratees.\n     * @returns {Function} Returns the new over function.\n     */\n    function createOver(arrayFunc) {\n      return flatRest(function(iteratees) {\n        iteratees = arrayMap(iteratees, baseUnary(getIteratee()));\n        return baseRest(function(args) {\n          var thisArg = this;\n          return arrayFunc(iteratees, function(iteratee) {\n            return apply(iteratee, thisArg, args);\n          });\n        });\n      });\n    }\n\n    /**\n     * Creates the padding for `string` based on `length`. The `chars` string\n     * is truncated if the number of characters exceeds `length`.\n     *\n     * @private\n     * @param {number} length The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padding for `string`.\n     */\n    function createPadding(length, chars) {\n      chars = chars === undefined ? ' ' : baseToString(chars);\n\n      var charsLength = chars.length;\n      if (charsLength < 2) {\n        return charsLength ? baseRepeat(chars, length) : chars;\n      }\n      var result = baseRepeat(chars, nativeCeil(length / stringSize(chars)));\n      return hasUnicode(chars)\n        ? castSlice(stringToArray(result), 0, length).join('')\n        : result.slice(0, length);\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with the `this` binding\n     * of `thisArg` and `partials` prepended to the arguments it receives.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} thisArg The `this` binding of `func`.\n     * @param {Array} partials The arguments to prepend to those provided to\n     *  the new function.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createPartial(func, bitmask, thisArg, partials) {\n      var isBind = bitmask & WRAP_BIND_FLAG,\n          Ctor = createCtor(func);\n\n      function wrapper() {\n        var argsIndex = -1,\n            argsLength = arguments.length,\n            leftIndex = -1,\n            leftLength = partials.length,\n            args = Array(leftLength + argsLength),\n            fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n\n        while (++leftIndex < leftLength) {\n          args[leftIndex] = partials[leftIndex];\n        }\n        while (argsLength--) {\n          args[leftIndex++] = arguments[++argsIndex];\n        }\n        return apply(fn, isBind ? thisArg : this, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a `_.range` or `_.rangeRight` function.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new range function.\n     */\n    function createRange(fromRight) {\n      return function(start, end, step) {\n        if (step && typeof step != 'number' && isIterateeCall(start, end, step)) {\n          end = step = undefined;\n        }\n        // Ensure the sign of `-0` is preserved.\n        start = toFinite(start);\n        if (end === undefined) {\n          end = start;\n          start = 0;\n        } else {\n          end = toFinite(end);\n        }\n        step = step === undefined ? (start < end ? 1 : -1) : toFinite(step);\n        return baseRange(start, end, step, fromRight);\n      };\n    }\n\n    /**\n     * Creates a function that performs a relational operation on two values.\n     *\n     * @private\n     * @param {Function} operator The function to perform the operation.\n     * @returns {Function} Returns the new relational operation function.\n     */\n    function createRelationalOperation(operator) {\n      return function(value, other) {\n        if (!(typeof value == 'string' && typeof other == 'string')) {\n          value = toNumber(value);\n          other = toNumber(other);\n        }\n        return operator(value, other);\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to continue currying.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {Function} wrapFunc The function to create the `func` wrapper.\n     * @param {*} placeholder The placeholder value.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to prepend to those provided to\n     *  the new function.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createRecurry(func, bitmask, wrapFunc, placeholder, thisArg, partials, holders, argPos, ary, arity) {\n      var isCurry = bitmask & WRAP_CURRY_FLAG,\n          newHolders = isCurry ? holders : undefined,\n          newHoldersRight = isCurry ? undefined : holders,\n          newPartials = isCurry ? partials : undefined,\n          newPartialsRight = isCurry ? undefined : partials;\n\n      bitmask |= (isCurry ? WRAP_PARTIAL_FLAG : WRAP_PARTIAL_RIGHT_FLAG);\n      bitmask &= ~(isCurry ? WRAP_PARTIAL_RIGHT_FLAG : WRAP_PARTIAL_FLAG);\n\n      if (!(bitmask & WRAP_CURRY_BOUND_FLAG)) {\n        bitmask &= ~(WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG);\n      }\n      var newData = [\n        func, bitmask, thisArg, newPartials, newHolders, newPartialsRight,\n        newHoldersRight, argPos, ary, arity\n      ];\n\n      var result = wrapFunc.apply(undefined, newData);\n      if (isLaziable(func)) {\n        setData(result, newData);\n      }\n      result.placeholder = placeholder;\n      return setWrapToString(result, func, bitmask);\n    }\n\n    /**\n     * Creates a function like `_.round`.\n     *\n     * @private\n     * @param {string} methodName The name of the `Math` method to use when rounding.\n     * @returns {Function} Returns the new round function.\n     */\n    function createRound(methodName) {\n      var func = Math[methodName];\n      return function(number, precision) {\n        number = toNumber(number);\n        precision = precision == null ? 0 : nativeMin(toInteger(precision), 292);\n        if (precision && nativeIsFinite(number)) {\n          // Shift with exponential notation to avoid floating-point issues.\n          // See [MDN](https://mdn.io/round#Examples) for more details.\n          var pair = (toString(number) + 'e').split('e'),\n              value = func(pair[0] + 'e' + (+pair[1] + precision));\n\n          pair = (toString(value) + 'e').split('e');\n          return +(pair[0] + 'e' + (+pair[1] - precision));\n        }\n        return func(number);\n      };\n    }\n\n    /**\n     * Creates a set object of `values`.\n     *\n     * @private\n     * @param {Array} values The values to add to the set.\n     * @returns {Object} Returns the new set.\n     */\n    var createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n      return new Set(values);\n    };\n\n    /**\n     * Creates a `_.toPairs` or `_.toPairsIn` function.\n     *\n     * @private\n     * @param {Function} keysFunc The function to get the keys of a given object.\n     * @returns {Function} Returns the new pairs function.\n     */\n    function createToPairs(keysFunc) {\n      return function(object) {\n        var tag = getTag(object);\n        if (tag == mapTag) {\n          return mapToArray(object);\n        }\n        if (tag == setTag) {\n          return setToPairs(object);\n        }\n        return baseToPairs(object, keysFunc(object));\n      };\n    }\n\n    /**\n     * Creates a function that either curries or invokes `func` with optional\n     * `this` binding and partially applied arguments.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to wrap.\n     * @param {number} bitmask The bitmask flags.\n     *    1 - `_.bind`\n     *    2 - `_.bindKey`\n     *    4 - `_.curry` or `_.curryRight` of a bound function\n     *    8 - `_.curry`\n     *   16 - `_.curryRight`\n     *   32 - `_.partial`\n     *   64 - `_.partialRight`\n     *  128 - `_.rearg`\n     *  256 - `_.ary`\n     *  512 - `_.flip`\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to be partially applied.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createWrap(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {\n      var isBindKey = bitmask & WRAP_BIND_KEY_FLAG;\n      if (!isBindKey && typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      var length = partials ? partials.length : 0;\n      if (!length) {\n        bitmask &= ~(WRAP_PARTIAL_FLAG | WRAP_PARTIAL_RIGHT_FLAG);\n        partials = holders = undefined;\n      }\n      ary = ary === undefined ? ary : nativeMax(toInteger(ary), 0);\n      arity = arity === undefined ? arity : toInteger(arity);\n      length -= holders ? holders.length : 0;\n\n      if (bitmask & WRAP_PARTIAL_RIGHT_FLAG) {\n        var partialsRight = partials,\n            holdersRight = holders;\n\n        partials = holders = undefined;\n      }\n      var data = isBindKey ? undefined : getData(func);\n\n      var newData = [\n        func, bitmask, thisArg, partials, holders, partialsRight, holdersRight,\n        argPos, ary, arity\n      ];\n\n      if (data) {\n        mergeData(newData, data);\n      }\n      func = newData[0];\n      bitmask = newData[1];\n      thisArg = newData[2];\n      partials = newData[3];\n      holders = newData[4];\n      arity = newData[9] = newData[9] === undefined\n        ? (isBindKey ? 0 : func.length)\n        : nativeMax(newData[9] - length, 0);\n\n      if (!arity && bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG)) {\n        bitmask &= ~(WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG);\n      }\n      if (!bitmask || bitmask == WRAP_BIND_FLAG) {\n        var result = createBind(func, bitmask, thisArg);\n      } else if (bitmask == WRAP_CURRY_FLAG || bitmask == WRAP_CURRY_RIGHT_FLAG) {\n        result = createCurry(func, bitmask, arity);\n      } else if ((bitmask == WRAP_PARTIAL_FLAG || bitmask == (WRAP_BIND_FLAG | WRAP_PARTIAL_FLAG)) && !holders.length) {\n        result = createPartial(func, bitmask, thisArg, partials);\n      } else {\n        result = createHybrid.apply(undefined, newData);\n      }\n      var setter = data ? baseSetData : setData;\n      return setWrapToString(setter(result, newData), func, bitmask);\n    }\n\n    /**\n     * Used by `_.defaults` to customize its `_.assignIn` use to assign properties\n     * of source objects to the destination object for all destination properties\n     * that resolve to `undefined`.\n     *\n     * @private\n     * @param {*} objValue The destination value.\n     * @param {*} srcValue The source value.\n     * @param {string} key The key of the property to assign.\n     * @param {Object} object The parent object of `objValue`.\n     * @returns {*} Returns the value to assign.\n     */\n    function customDefaultsAssignIn(objValue, srcValue, key, object) {\n      if (objValue === undefined ||\n          (eq(objValue, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n        return srcValue;\n      }\n      return objValue;\n    }\n\n    /**\n     * Used by `_.defaultsDeep` to customize its `_.merge` use to merge source\n     * objects into destination objects that are passed thru.\n     *\n     * @private\n     * @param {*} objValue The destination value.\n     * @param {*} srcValue The source value.\n     * @param {string} key The key of the property to merge.\n     * @param {Object} object The parent object of `objValue`.\n     * @param {Object} source The parent object of `srcValue`.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     * @returns {*} Returns the value to assign.\n     */\n    function customDefaultsMerge(objValue, srcValue, key, object, source, stack) {\n      if (isObject(objValue) && isObject(srcValue)) {\n        // Recursively merge objects and arrays (susceptible to call stack limits).\n        stack.set(srcValue, objValue);\n        baseMerge(objValue, srcValue, undefined, customDefaultsMerge, stack);\n        stack['delete'](srcValue);\n      }\n      return objValue;\n    }\n\n    /**\n     * Used by `_.omit` to customize its `_.cloneDeep` use to only clone plain\n     * objects.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @param {string} key The key of the property to inspect.\n     * @returns {*} Returns the uncloned value or `undefined` to defer cloning to `_.cloneDeep`.\n     */\n    function customOmitClone(value) {\n      return isPlainObject(value) ? undefined : value;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for arrays with support for\n     * partial deep comparisons.\n     *\n     * @private\n     * @param {Array} array The array to compare.\n     * @param {Array} other The other array to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `array` and `other` objects.\n     * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n     */\n    function equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n          arrLength = array.length,\n          othLength = other.length;\n\n      if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n        return false;\n      }\n      // Check that cyclic values are equal.\n      var arrStacked = stack.get(array);\n      var othStacked = stack.get(other);\n      if (arrStacked && othStacked) {\n        return arrStacked == other && othStacked == array;\n      }\n      var index = -1,\n          result = true,\n          seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n      stack.set(array, other);\n      stack.set(other, array);\n\n      // Ignore non-index properties.\n      while (++index < arrLength) {\n        var arrValue = array[index],\n            othValue = other[index];\n\n        if (customizer) {\n          var compared = isPartial\n            ? customizer(othValue, arrValue, index, other, array, stack)\n            : customizer(arrValue, othValue, index, array, other, stack);\n        }\n        if (compared !== undefined) {\n          if (compared) {\n            continue;\n          }\n          result = false;\n          break;\n        }\n        // Recursively compare arrays (susceptible to call stack limits).\n        if (seen) {\n          if (!arraySome(other, function(othValue, othIndex) {\n                if (!cacheHas(seen, othIndex) &&\n                    (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n                  return seen.push(othIndex);\n                }\n              })) {\n            result = false;\n            break;\n          }\n        } else if (!(\n              arrValue === othValue ||\n                equalFunc(arrValue, othValue, bitmask, customizer, stack)\n            )) {\n          result = false;\n          break;\n        }\n      }\n      stack['delete'](array);\n      stack['delete'](other);\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for comparing objects of\n     * the same `toStringTag`.\n     *\n     * **Note:** This function only supports comparing values with tags of\n     * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {string} tag The `toStringTag` of the objects to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n      switch (tag) {\n        case dataViewTag:\n          if ((object.byteLength != other.byteLength) ||\n              (object.byteOffset != other.byteOffset)) {\n            return false;\n          }\n          object = object.buffer;\n          other = other.buffer;\n\n        case arrayBufferTag:\n          if ((object.byteLength != other.byteLength) ||\n              !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n            return false;\n          }\n          return true;\n\n        case boolTag:\n        case dateTag:\n        case numberTag:\n          // Coerce booleans to `1` or `0` and dates to milliseconds.\n          // Invalid dates are coerced to `NaN`.\n          return eq(+object, +other);\n\n        case errorTag:\n          return object.name == other.name && object.message == other.message;\n\n        case regexpTag:\n        case stringTag:\n          // Coerce regexes to strings and treat strings, primitives and objects,\n          // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n          // for more details.\n          return object == (other + '');\n\n        case mapTag:\n          var convert = mapToArray;\n\n        case setTag:\n          var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n          convert || (convert = setToArray);\n\n          if (object.size != other.size && !isPartial) {\n            return false;\n          }\n          // Assume cyclic values are equal.\n          var stacked = stack.get(object);\n          if (stacked) {\n            return stacked == other;\n          }\n          bitmask |= COMPARE_UNORDERED_FLAG;\n\n          // Recursively compare objects (susceptible to call stack limits).\n          stack.set(object, other);\n          var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n          stack['delete'](object);\n          return result;\n\n        case symbolTag:\n          if (symbolValueOf) {\n            return symbolValueOf.call(object) == symbolValueOf.call(other);\n          }\n      }\n      return false;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for objects with support for\n     * partial deep comparisons.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n          objProps = getAllKeys(object),\n          objLength = objProps.length,\n          othProps = getAllKeys(other),\n          othLength = othProps.length;\n\n      if (objLength != othLength && !isPartial) {\n        return false;\n      }\n      var index = objLength;\n      while (index--) {\n        var key = objProps[index];\n        if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n          return false;\n        }\n      }\n      // Check that cyclic values are equal.\n      var objStacked = stack.get(object);\n      var othStacked = stack.get(other);\n      if (objStacked && othStacked) {\n        return objStacked == other && othStacked == object;\n      }\n      var result = true;\n      stack.set(object, other);\n      stack.set(other, object);\n\n      var skipCtor = isPartial;\n      while (++index < objLength) {\n        key = objProps[index];\n        var objValue = object[key],\n            othValue = other[key];\n\n        if (customizer) {\n          var compared = isPartial\n            ? customizer(othValue, objValue, key, other, object, stack)\n            : customizer(objValue, othValue, key, object, other, stack);\n        }\n        // Recursively compare objects (susceptible to call stack limits).\n        if (!(compared === undefined\n              ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n              : compared\n            )) {\n          result = false;\n          break;\n        }\n        skipCtor || (skipCtor = key == 'constructor');\n      }\n      if (result && !skipCtor) {\n        var objCtor = object.constructor,\n            othCtor = other.constructor;\n\n        // Non `Object` object instances with different constructors are not equal.\n        if (objCtor != othCtor &&\n            ('constructor' in object && 'constructor' in other) &&\n            !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n              typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n          result = false;\n        }\n      }\n      stack['delete'](object);\n      stack['delete'](other);\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseRest` which flattens the rest array.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @returns {Function} Returns the new function.\n     */\n    function flatRest(func) {\n      return setToString(overRest(func, undefined, flatten), func + '');\n    }\n\n    /**\n     * Creates an array of own enumerable property names and symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function getAllKeys(object) {\n      return baseGetAllKeys(object, keys, getSymbols);\n    }\n\n    /**\n     * Creates an array of own and inherited enumerable property names and\n     * symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function getAllKeysIn(object) {\n      return baseGetAllKeys(object, keysIn, getSymbolsIn);\n    }\n\n    /**\n     * Gets metadata for `func`.\n     *\n     * @private\n     * @param {Function} func The function to query.\n     * @returns {*} Returns the metadata for `func`.\n     */\n    var getData = !metaMap ? noop : function(func) {\n      return metaMap.get(func);\n    };\n\n    /**\n     * Gets the name of `func`.\n     *\n     * @private\n     * @param {Function} func The function to query.\n     * @returns {string} Returns the function name.\n     */\n    function getFuncName(func) {\n      var result = (func.name + ''),\n          array = realNames[result],\n          length = hasOwnProperty.call(realNames, result) ? array.length : 0;\n\n      while (length--) {\n        var data = array[length],\n            otherFunc = data.func;\n        if (otherFunc == null || otherFunc == func) {\n          return data.name;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Gets the argument placeholder value for `func`.\n     *\n     * @private\n     * @param {Function} func The function to inspect.\n     * @returns {*} Returns the placeholder value.\n     */\n    function getHolder(func) {\n      var object = hasOwnProperty.call(lodash, 'placeholder') ? lodash : func;\n      return object.placeholder;\n    }\n\n    /**\n     * Gets the appropriate \"iteratee\" function. If `_.iteratee` is customized,\n     * this function returns the custom method, otherwise it returns `baseIteratee`.\n     * If arguments are provided, the chosen function is invoked with them and\n     * its result is returned.\n     *\n     * @private\n     * @param {*} [value] The value to convert to an iteratee.\n     * @param {number} [arity] The arity of the created iteratee.\n     * @returns {Function} Returns the chosen function or its result.\n     */\n    function getIteratee() {\n      var result = lodash.iteratee || iteratee;\n      result = result === iteratee ? baseIteratee : result;\n      return arguments.length ? result(arguments[0], arguments[1]) : result;\n    }\n\n    /**\n     * Gets the data for `map`.\n     *\n     * @private\n     * @param {Object} map The map to query.\n     * @param {string} key The reference key.\n     * @returns {*} Returns the map data.\n     */\n    function getMapData(map, key) {\n      var data = map.__data__;\n      return isKeyable(key)\n        ? data[typeof key == 'string' ? 'string' : 'hash']\n        : data.map;\n    }\n\n    /**\n     * Gets the property names, values, and compare flags of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the match data of `object`.\n     */\n    function getMatchData(object) {\n      var result = keys(object),\n          length = result.length;\n\n      while (length--) {\n        var key = result[length],\n            value = object[key];\n\n        result[length] = [key, value, isStrictComparable(value)];\n      }\n      return result;\n    }\n\n    /**\n     * Gets the native function at `key` of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {string} key The key of the method to get.\n     * @returns {*} Returns the function if it's native, else `undefined`.\n     */\n    function getNative(object, key) {\n      var value = getValue(object, key);\n      return baseIsNative(value) ? value : undefined;\n    }\n\n    /**\n     * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the raw `toStringTag`.\n     */\n    function getRawTag(value) {\n      var isOwn = hasOwnProperty.call(value, symToStringTag),\n          tag = value[symToStringTag];\n\n      try {\n        value[symToStringTag] = undefined;\n        var unmasked = true;\n      } catch (e) {}\n\n      var result = nativeObjectToString.call(value);\n      if (unmasked) {\n        if (isOwn) {\n          value[symToStringTag] = tag;\n        } else {\n          delete value[symToStringTag];\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array of the own enumerable symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of symbols.\n     */\n    var getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n      if (object == null) {\n        return [];\n      }\n      object = Object(object);\n      return arrayFilter(nativeGetSymbols(object), function(symbol) {\n        return propertyIsEnumerable.call(object, symbol);\n      });\n    };\n\n    /**\n     * Creates an array of the own and inherited enumerable symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of symbols.\n     */\n    var getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n      var result = [];\n      while (object) {\n        arrayPush(result, getSymbols(object));\n        object = getPrototype(object);\n      }\n      return result;\n    };\n\n    /**\n     * Gets the `toStringTag` of `value`.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the `toStringTag`.\n     */\n    var getTag = baseGetTag;\n\n    // Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\n    if ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n        (Map && getTag(new Map) != mapTag) ||\n        (Promise && getTag(Promise.resolve()) != promiseTag) ||\n        (Set && getTag(new Set) != setTag) ||\n        (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n      getTag = function(value) {\n        var result = baseGetTag(value),\n            Ctor = result == objectTag ? value.constructor : undefined,\n            ctorString = Ctor ? toSource(Ctor) : '';\n\n        if (ctorString) {\n          switch (ctorString) {\n            case dataViewCtorString: return dataViewTag;\n            case mapCtorString: return mapTag;\n            case promiseCtorString: return promiseTag;\n            case setCtorString: return setTag;\n            case weakMapCtorString: return weakMapTag;\n          }\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Gets the view, applying any `transforms` to the `start` and `end` positions.\n     *\n     * @private\n     * @param {number} start The start of the view.\n     * @param {number} end The end of the view.\n     * @param {Array} transforms The transformations to apply to the view.\n     * @returns {Object} Returns an object containing the `start` and `end`\n     *  positions of the view.\n     */\n    function getView(start, end, transforms) {\n      var index = -1,\n          length = transforms.length;\n\n      while (++index < length) {\n        var data = transforms[index],\n            size = data.size;\n\n        switch (data.type) {\n          case 'drop':      start += size; break;\n          case 'dropRight': end -= size; break;\n          case 'take':      end = nativeMin(end, start + size); break;\n          case 'takeRight': start = nativeMax(start, end - size); break;\n        }\n      }\n      return { 'start': start, 'end': end };\n    }\n\n    /**\n     * Extracts wrapper details from the `source` body comment.\n     *\n     * @private\n     * @param {string} source The source to inspect.\n     * @returns {Array} Returns the wrapper details.\n     */\n    function getWrapDetails(source) {\n      var match = source.match(reWrapDetails);\n      return match ? match[1].split(reSplitDetails) : [];\n    }\n\n    /**\n     * Checks if `path` exists on `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @param {Function} hasFunc The function to check properties.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     */\n    function hasPath(object, path, hasFunc) {\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length,\n          result = false;\n\n      while (++index < length) {\n        var key = toKey(path[index]);\n        if (!(result = object != null && hasFunc(object, key))) {\n          break;\n        }\n        object = object[key];\n      }\n      if (result || ++index != length) {\n        return result;\n      }\n      length = object == null ? 0 : object.length;\n      return !!length && isLength(length) && isIndex(key, length) &&\n        (isArray(object) || isArguments(object));\n    }\n\n    /**\n     * Initializes an array clone.\n     *\n     * @private\n     * @param {Array} array The array to clone.\n     * @returns {Array} Returns the initialized clone.\n     */\n    function initCloneArray(array) {\n      var length = array.length,\n          result = new array.constructor(length);\n\n      // Add properties assigned by `RegExp#exec`.\n      if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n        result.index = array.index;\n        result.input = array.input;\n      }\n      return result;\n    }\n\n    /**\n     * Initializes an object clone.\n     *\n     * @private\n     * @param {Object} object The object to clone.\n     * @returns {Object} Returns the initialized clone.\n     */\n    function initCloneObject(object) {\n      return (typeof object.constructor == 'function' && !isPrototype(object))\n        ? baseCreate(getPrototype(object))\n        : {};\n    }\n\n    /**\n     * Initializes an object clone based on its `toStringTag`.\n     *\n     * **Note:** This function only supports cloning values with tags of\n     * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n     *\n     * @private\n     * @param {Object} object The object to clone.\n     * @param {string} tag The `toStringTag` of the object to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the initialized clone.\n     */\n    function initCloneByTag(object, tag, isDeep) {\n      var Ctor = object.constructor;\n      switch (tag) {\n        case arrayBufferTag:\n          return cloneArrayBuffer(object);\n\n        case boolTag:\n        case dateTag:\n          return new Ctor(+object);\n\n        case dataViewTag:\n          return cloneDataView(object, isDeep);\n\n        case float32Tag: case float64Tag:\n        case int8Tag: case int16Tag: case int32Tag:\n        case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n          return cloneTypedArray(object, isDeep);\n\n        case mapTag:\n          return new Ctor;\n\n        case numberTag:\n        case stringTag:\n          return new Ctor(object);\n\n        case regexpTag:\n          return cloneRegExp(object);\n\n        case setTag:\n          return new Ctor;\n\n        case symbolTag:\n          return cloneSymbol(object);\n      }\n    }\n\n    /**\n     * Inserts wrapper `details` in a comment at the top of the `source` body.\n     *\n     * @private\n     * @param {string} source The source to modify.\n     * @returns {Array} details The details to insert.\n     * @returns {string} Returns the modified source.\n     */\n    function insertWrapDetails(source, details) {\n      var length = details.length;\n      if (!length) {\n        return source;\n      }\n      var lastIndex = length - 1;\n      details[lastIndex] = (length > 1 ? '& ' : '') + details[lastIndex];\n      details = details.join(length > 2 ? ', ' : ' ');\n      return source.replace(reWrapComment, '{\\n/* [wrapped with ' + details + '] */\\n');\n    }\n\n    /**\n     * Checks if `value` is a flattenable `arguments` object or array.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n     */\n    function isFlattenable(value) {\n      return isArray(value) || isArguments(value) ||\n        !!(spreadableSymbol && value && value[spreadableSymbol]);\n    }\n\n    /**\n     * Checks if `value` is a valid array-like index.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n     * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n     */\n    function isIndex(value, length) {\n      var type = typeof value;\n      length = length == null ? MAX_SAFE_INTEGER : length;\n\n      return !!length &&\n        (type == 'number' ||\n          (type != 'symbol' && reIsUint.test(value))) &&\n            (value > -1 && value % 1 == 0 && value < length);\n    }\n\n    /**\n     * Checks if the given arguments are from an iteratee call.\n     *\n     * @private\n     * @param {*} value The potential iteratee value argument.\n     * @param {*} index The potential iteratee index or key argument.\n     * @param {*} object The potential iteratee object argument.\n     * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n     *  else `false`.\n     */\n    function isIterateeCall(value, index, object) {\n      if (!isObject(object)) {\n        return false;\n      }\n      var type = typeof index;\n      if (type == 'number'\n            ? (isArrayLike(object) && isIndex(index, object.length))\n            : (type == 'string' && index in object)\n          ) {\n        return eq(object[index], value);\n      }\n      return false;\n    }\n\n    /**\n     * Checks if `value` is a property name and not a property path.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @param {Object} [object] The object to query keys on.\n     * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n     */\n    function isKey(value, object) {\n      if (isArray(value)) {\n        return false;\n      }\n      var type = typeof value;\n      if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n          value == null || isSymbol(value)) {\n        return true;\n      }\n      return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n        (object != null && value in Object(object));\n    }\n\n    /**\n     * Checks if `value` is suitable for use as unique object key.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n     */\n    function isKeyable(value) {\n      var type = typeof value;\n      return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n        ? (value !== '__proto__')\n        : (value === null);\n    }\n\n    /**\n     * Checks if `func` has a lazy counterpart.\n     *\n     * @private\n     * @param {Function} func The function to check.\n     * @returns {boolean} Returns `true` if `func` has a lazy counterpart,\n     *  else `false`.\n     */\n    function isLaziable(func) {\n      var funcName = getFuncName(func),\n          other = lodash[funcName];\n\n      if (typeof other != 'function' || !(funcName in LazyWrapper.prototype)) {\n        return false;\n      }\n      if (func === other) {\n        return true;\n      }\n      var data = getData(other);\n      return !!data && func === data[0];\n    }\n\n    /**\n     * Checks if `func` has its source masked.\n     *\n     * @private\n     * @param {Function} func The function to check.\n     * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n     */\n    function isMasked(func) {\n      return !!maskSrcKey && (maskSrcKey in func);\n    }\n\n    /**\n     * Checks if `func` is capable of being masked.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `func` is maskable, else `false`.\n     */\n    var isMaskable = coreJsData ? isFunction : stubFalse;\n\n    /**\n     * Checks if `value` is likely a prototype object.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n     */\n    function isPrototype(value) {\n      var Ctor = value && value.constructor,\n          proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n      return value === proto;\n    }\n\n    /**\n     * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` if suitable for strict\n     *  equality comparisons, else `false`.\n     */\n    function isStrictComparable(value) {\n      return value === value && !isObject(value);\n    }\n\n    /**\n     * A specialized version of `matchesProperty` for source values suitable\n     * for strict equality comparisons, i.e. `===`.\n     *\n     * @private\n     * @param {string} key The key of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function matchesStrictComparable(key, srcValue) {\n      return function(object) {\n        if (object == null) {\n          return false;\n        }\n        return object[key] === srcValue &&\n          (srcValue !== undefined || (key in Object(object)));\n      };\n    }\n\n    /**\n     * A specialized version of `_.memoize` which clears the memoized function's\n     * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n     *\n     * @private\n     * @param {Function} func The function to have its output memoized.\n     * @returns {Function} Returns the new memoized function.\n     */\n    function memoizeCapped(func) {\n      var result = memoize(func, function(key) {\n        if (cache.size === MAX_MEMOIZE_SIZE) {\n          cache.clear();\n        }\n        return key;\n      });\n\n      var cache = result.cache;\n      return result;\n    }\n\n    /**\n     * Merges the function metadata of `source` into `data`.\n     *\n     * Merging metadata reduces the number of wrappers used to invoke a function.\n     * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`\n     * may be applied regardless of execution order. Methods like `_.ary` and\n     * `_.rearg` modify function arguments, making the order in which they are\n     * executed important, preventing the merging of metadata. However, we make\n     * an exception for a safe combined case where curried functions have `_.ary`\n     * and or `_.rearg` applied.\n     *\n     * @private\n     * @param {Array} data The destination metadata.\n     * @param {Array} source The source metadata.\n     * @returns {Array} Returns `data`.\n     */\n    function mergeData(data, source) {\n      var bitmask = data[1],\n          srcBitmask = source[1],\n          newBitmask = bitmask | srcBitmask,\n          isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);\n\n      var isCombo =\n        ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_CURRY_FLAG)) ||\n        ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_REARG_FLAG) && (data[7].length <= source[8])) ||\n        ((srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG)) && (source[7].length <= source[8]) && (bitmask == WRAP_CURRY_FLAG));\n\n      // Exit early if metadata can't be merged.\n      if (!(isCommon || isCombo)) {\n        return data;\n      }\n      // Use source `thisArg` if available.\n      if (srcBitmask & WRAP_BIND_FLAG) {\n        data[2] = source[2];\n        // Set when currying a bound function.\n        newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;\n      }\n      // Compose partial arguments.\n      var value = source[3];\n      if (value) {\n        var partials = data[3];\n        data[3] = partials ? composeArgs(partials, value, source[4]) : value;\n        data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];\n      }\n      // Compose partial right arguments.\n      value = source[5];\n      if (value) {\n        partials = data[5];\n        data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;\n        data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];\n      }\n      // Use source `argPos` if available.\n      value = source[7];\n      if (value) {\n        data[7] = value;\n      }\n      // Use source `ary` if it's smaller.\n      if (srcBitmask & WRAP_ARY_FLAG) {\n        data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);\n      }\n      // Use source `arity` if one is not provided.\n      if (data[9] == null) {\n        data[9] = source[9];\n      }\n      // Use source `func` and merge bitmasks.\n      data[0] = source[0];\n      data[1] = newBitmask;\n\n      return data;\n    }\n\n    /**\n     * This function is like\n     * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n     * except that it includes inherited enumerable properties.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function nativeKeysIn(object) {\n      var result = [];\n      if (object != null) {\n        for (var key in Object(object)) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Converts `value` to a string using `Object.prototype.toString`.\n     *\n     * @private\n     * @param {*} value The value to convert.\n     * @returns {string} Returns the converted string.\n     */\n    function objectToString(value) {\n      return nativeObjectToString.call(value);\n    }\n\n    /**\n     * A specialized version of `baseRest` which transforms the rest array.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @param {Function} transform The rest array transform.\n     * @returns {Function} Returns the new function.\n     */\n    function overRest(func, start, transform) {\n      start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n      return function() {\n        var args = arguments,\n            index = -1,\n            length = nativeMax(args.length - start, 0),\n            array = Array(length);\n\n        while (++index < length) {\n          array[index] = args[start + index];\n        }\n        index = -1;\n        var otherArgs = Array(start + 1);\n        while (++index < start) {\n          otherArgs[index] = args[index];\n        }\n        otherArgs[start] = transform(array);\n        return apply(func, this, otherArgs);\n      };\n    }\n\n    /**\n     * Gets the parent value at `path` of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array} path The path to get the parent value of.\n     * @returns {*} Returns the parent value.\n     */\n    function parent(object, path) {\n      return path.length < 2 ? object : baseGet(object, baseSlice(path, 0, -1));\n    }\n\n    /**\n     * Reorder `array` according to the specified indexes where the element at\n     * the first index is assigned as the first element, the element at\n     * the second index is assigned as the second element, and so on.\n     *\n     * @private\n     * @param {Array} array The array to reorder.\n     * @param {Array} indexes The arranged array indexes.\n     * @returns {Array} Returns `array`.\n     */\n    function reorder(array, indexes) {\n      var arrLength = array.length,\n          length = nativeMin(indexes.length, arrLength),\n          oldArray = copyArray(array);\n\n      while (length--) {\n        var index = indexes[length];\n        array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined;\n      }\n      return array;\n    }\n\n    /**\n     * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {string} key The key of the property to get.\n     * @returns {*} Returns the property value.\n     */\n    function safeGet(object, key) {\n      if (key === 'constructor' && typeof object[key] === 'function') {\n        return;\n      }\n\n      if (key == '__proto__') {\n        return;\n      }\n\n      return object[key];\n    }\n\n    /**\n     * Sets metadata for `func`.\n     *\n     * **Note:** If this function becomes hot, i.e. is invoked a lot in a short\n     * period of time, it will trip its breaker and transition to an identity\n     * function to avoid garbage collection pauses in V8. See\n     * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)\n     * for more details.\n     *\n     * @private\n     * @param {Function} func The function to associate metadata with.\n     * @param {*} data The metadata.\n     * @returns {Function} Returns `func`.\n     */\n    var setData = shortOut(baseSetData);\n\n    /**\n     * A simple wrapper around the global [`setTimeout`](https://mdn.io/setTimeout).\n     *\n     * @private\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @returns {number|Object} Returns the timer id or timeout object.\n     */\n    var setTimeout = ctxSetTimeout || function(func, wait) {\n      return root.setTimeout(func, wait);\n    };\n\n    /**\n     * Sets the `toString` method of `func` to return `string`.\n     *\n     * @private\n     * @param {Function} func The function to modify.\n     * @param {Function} string The `toString` result.\n     * @returns {Function} Returns `func`.\n     */\n    var setToString = shortOut(baseSetToString);\n\n    /**\n     * Sets the `toString` method of `wrapper` to mimic the source of `reference`\n     * with wrapper details in a comment at the top of the source body.\n     *\n     * @private\n     * @param {Function} wrapper The function to modify.\n     * @param {Function} reference The reference function.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @returns {Function} Returns `wrapper`.\n     */\n    function setWrapToString(wrapper, reference, bitmask) {\n      var source = (reference + '');\n      return setToString(wrapper, insertWrapDetails(source, updateWrapDetails(getWrapDetails(source), bitmask)));\n    }\n\n    /**\n     * Creates a function that'll short out and invoke `identity` instead\n     * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n     * milliseconds.\n     *\n     * @private\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new shortable function.\n     */\n    function shortOut(func) {\n      var count = 0,\n          lastCalled = 0;\n\n      return function() {\n        var stamp = nativeNow(),\n            remaining = HOT_SPAN - (stamp - lastCalled);\n\n        lastCalled = stamp;\n        if (remaining > 0) {\n          if (++count >= HOT_COUNT) {\n            return arguments[0];\n          }\n        } else {\n          count = 0;\n        }\n        return func.apply(undefined, arguments);\n      };\n    }\n\n    /**\n     * A specialized version of `_.shuffle` which mutates and sets the size of `array`.\n     *\n     * @private\n     * @param {Array} array The array to shuffle.\n     * @param {number} [size=array.length] The size of `array`.\n     * @returns {Array} Returns `array`.\n     */\n    function shuffleSelf(array, size) {\n      var index = -1,\n          length = array.length,\n          lastIndex = length - 1;\n\n      size = size === undefined ? length : size;\n      while (++index < size) {\n        var rand = baseRandom(index, lastIndex),\n            value = array[rand];\n\n        array[rand] = array[index];\n        array[index] = value;\n      }\n      array.length = size;\n      return array;\n    }\n\n    /**\n     * Converts `string` to a property path array.\n     *\n     * @private\n     * @param {string} string The string to convert.\n     * @returns {Array} Returns the property path array.\n     */\n    var stringToPath = memoizeCapped(function(string) {\n      var result = [];\n      if (string.charCodeAt(0) === 46 /* . */) {\n        result.push('');\n      }\n      string.replace(rePropName, function(match, number, quote, subString) {\n        result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n      });\n      return result;\n    });\n\n    /**\n     * Converts `value` to a string key if it's not a string or symbol.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {string|symbol} Returns the key.\n     */\n    function toKey(value) {\n      if (typeof value == 'string' || isSymbol(value)) {\n        return value;\n      }\n      var result = (value + '');\n      return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n    }\n\n    /**\n     * Converts `func` to its source code.\n     *\n     * @private\n     * @param {Function} func The function to convert.\n     * @returns {string} Returns the source code.\n     */\n    function toSource(func) {\n      if (func != null) {\n        try {\n          return funcToString.call(func);\n        } catch (e) {}\n        try {\n          return (func + '');\n        } catch (e) {}\n      }\n      return '';\n    }\n\n    /**\n     * Updates wrapper `details` based on `bitmask` flags.\n     *\n     * @private\n     * @returns {Array} details The details to modify.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @returns {Array} Returns `details`.\n     */\n    function updateWrapDetails(details, bitmask) {\n      arrayEach(wrapFlags, function(pair) {\n        var value = '_.' + pair[0];\n        if ((bitmask & pair[1]) && !arrayIncludes(details, value)) {\n          details.push(value);\n        }\n      });\n      return details.sort();\n    }\n\n    /**\n     * Creates a clone of `wrapper`.\n     *\n     * @private\n     * @param {Object} wrapper The wrapper to clone.\n     * @returns {Object} Returns the cloned wrapper.\n     */\n    function wrapperClone(wrapper) {\n      if (wrapper instanceof LazyWrapper) {\n        return wrapper.clone();\n      }\n      var result = new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__);\n      result.__actions__ = copyArray(wrapper.__actions__);\n      result.__index__  = wrapper.__index__;\n      result.__values__ = wrapper.__values__;\n      return result;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of elements split into groups the length of `size`.\n     * If `array` can't be split evenly, the final chunk will be the remaining\n     * elements.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to process.\n     * @param {number} [size=1] The length of each chunk\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the new array of chunks.\n     * @example\n     *\n     * _.chunk(['a', 'b', 'c', 'd'], 2);\n     * // => [['a', 'b'], ['c', 'd']]\n     *\n     * _.chunk(['a', 'b', 'c', 'd'], 3);\n     * // => [['a', 'b', 'c'], ['d']]\n     */\n    function chunk(array, size, guard) {\n      if ((guard ? isIterateeCall(array, size, guard) : size === undefined)) {\n        size = 1;\n      } else {\n        size = nativeMax(toInteger(size), 0);\n      }\n      var length = array == null ? 0 : array.length;\n      if (!length || size < 1) {\n        return [];\n      }\n      var index = 0,\n          resIndex = 0,\n          result = Array(nativeCeil(length / size));\n\n      while (index < length) {\n        result[resIndex++] = baseSlice(array, index, (index += size));\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array with all falsey values removed. The values `false`, `null`,\n     * `0`, `\"\"`, `undefined`, and `NaN` are falsey.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to compact.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.compact([0, 1, false, 2, '', 3]);\n     * // => [1, 2, 3]\n     */\n    function compact(array) {\n      var index = -1,\n          length = array == null ? 0 : array.length,\n          resIndex = 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index];\n        if (value) {\n          result[resIndex++] = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates a new array concatenating `array` with any additional arrays\n     * and/or values.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to concatenate.\n     * @param {...*} [values] The values to concatenate.\n     * @returns {Array} Returns the new concatenated array.\n     * @example\n     *\n     * var array = [1];\n     * var other = _.concat(array, 2, [3], [[4]]);\n     *\n     * console.log(other);\n     * // => [1, 2, 3, [4]]\n     *\n     * console.log(array);\n     * // => [1]\n     */\n    function concat() {\n      var length = arguments.length;\n      if (!length) {\n        return [];\n      }\n      var args = Array(length - 1),\n          array = arguments[0],\n          index = length;\n\n      while (index--) {\n        args[index - 1] = arguments[index];\n      }\n      return arrayPush(isArray(array) ? copyArray(array) : [array], baseFlatten(args, 1));\n    }\n\n    /**\n     * Creates an array of `array` values not included in the other given arrays\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. The order and references of result values are\n     * determined by the first array.\n     *\n     * **Note:** Unlike `_.pullAll`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.without, _.xor\n     * @example\n     *\n     * _.difference([2, 1], [2, 3]);\n     * // => [1]\n     */\n    var difference = baseRest(function(array, values) {\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))\n        : [];\n    });\n\n    /**\n     * This method is like `_.difference` except that it accepts `iteratee` which\n     * is invoked for each element of `array` and `values` to generate the criterion\n     * by which they're compared. The order and references of result values are\n     * determined by the first array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * **Note:** Unlike `_.pullAllBy`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.differenceBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.differenceBy([{ 'x': 2 }, { 'x': 1 }], [{ 'x': 1 }], 'x');\n     * // => [{ 'x': 2 }]\n     */\n    var differenceBy = baseRest(function(array, values) {\n      var iteratee = last(values);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), getIteratee(iteratee, 2))\n        : [];\n    });\n\n    /**\n     * This method is like `_.difference` except that it accepts `comparator`\n     * which is invoked to compare elements of `array` to `values`. The order and\n     * references of result values are determined by the first array. The comparator\n     * is invoked with two arguments: (arrVal, othVal).\n     *\n     * **Note:** Unlike `_.pullAllWith`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     *\n     * _.differenceWith(objects, [{ 'x': 1, 'y': 2 }], _.isEqual);\n     * // => [{ 'x': 2, 'y': 1 }]\n     */\n    var differenceWith = baseRest(function(array, values) {\n      var comparator = last(values);\n      if (isArrayLikeObject(comparator)) {\n        comparator = undefined;\n      }\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), undefined, comparator)\n        : [];\n    });\n\n    /**\n     * Creates a slice of `array` with `n` elements dropped from the beginning.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to drop.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.drop([1, 2, 3]);\n     * // => [2, 3]\n     *\n     * _.drop([1, 2, 3], 2);\n     * // => [3]\n     *\n     * _.drop([1, 2, 3], 5);\n     * // => []\n     *\n     * _.drop([1, 2, 3], 0);\n     * // => [1, 2, 3]\n     */\n    function drop(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      return baseSlice(array, n < 0 ? 0 : n, length);\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements dropped from the end.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to drop.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.dropRight([1, 2, 3]);\n     * // => [1, 2]\n     *\n     * _.dropRight([1, 2, 3], 2);\n     * // => [1]\n     *\n     * _.dropRight([1, 2, 3], 5);\n     * // => []\n     *\n     * _.dropRight([1, 2, 3], 0);\n     * // => [1, 2, 3]\n     */\n    function dropRight(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      n = length - n;\n      return baseSlice(array, 0, n < 0 ? 0 : n);\n    }\n\n    /**\n     * Creates a slice of `array` excluding elements dropped from the end.\n     * Elements are dropped until `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.dropRightWhile(users, function(o) { return !o.active; });\n     * // => objects for ['barney']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.dropRightWhile(users, { 'user': 'pebbles', 'active': false });\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.dropRightWhile(users, ['active', false]);\n     * // => objects for ['barney']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.dropRightWhile(users, 'active');\n     * // => objects for ['barney', 'fred', 'pebbles']\n     */\n    function dropRightWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), true, true)\n        : [];\n    }\n\n    /**\n     * Creates a slice of `array` excluding elements dropped from the beginning.\n     * Elements are dropped until `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.dropWhile(users, function(o) { return !o.active; });\n     * // => objects for ['pebbles']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.dropWhile(users, { 'user': 'barney', 'active': false });\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.dropWhile(users, ['active', false]);\n     * // => objects for ['pebbles']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.dropWhile(users, 'active');\n     * // => objects for ['barney', 'fred', 'pebbles']\n     */\n    function dropWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), true)\n        : [];\n    }\n\n    /**\n     * Fills elements of `array` with `value` from `start` up to, but not\n     * including, `end`.\n     *\n     * **Note:** This method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Array\n     * @param {Array} array The array to fill.\n     * @param {*} value The value to fill `array` with.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _.fill(array, 'a');\n     * console.log(array);\n     * // => ['a', 'a', 'a']\n     *\n     * _.fill(Array(3), 2);\n     * // => [2, 2, 2]\n     *\n     * _.fill([4, 6, 8, 10], '*', 1, 3);\n     * // => [4, '*', '*', 10]\n     */\n    function fill(array, value, start, end) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      if (start && typeof start != 'number' && isIterateeCall(array, value, start)) {\n        start = 0;\n        end = length;\n      }\n      return baseFill(array, value, start, end);\n    }\n\n    /**\n     * This method is like `_.find` except that it returns the index of the first\n     * element `predicate` returns truthy for instead of the element itself.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.findIndex(users, function(o) { return o.user == 'barney'; });\n     * // => 0\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findIndex(users, { 'user': 'fred', 'active': false });\n     * // => 1\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findIndex(users, ['active', false]);\n     * // => 0\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findIndex(users, 'active');\n     * // => 2\n     */\n    function findIndex(array, predicate, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = fromIndex == null ? 0 : toInteger(fromIndex);\n      if (index < 0) {\n        index = nativeMax(length + index, 0);\n      }\n      return baseFindIndex(array, getIteratee(predicate, 3), index);\n    }\n\n    /**\n     * This method is like `_.findIndex` except that it iterates over elements\n     * of `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.findLastIndex(users, function(o) { return o.user == 'pebbles'; });\n     * // => 2\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findLastIndex(users, { 'user': 'barney', 'active': true });\n     * // => 0\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findLastIndex(users, ['active', false]);\n     * // => 2\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findLastIndex(users, 'active');\n     * // => 0\n     */\n    function findLastIndex(array, predicate, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = length - 1;\n      if (fromIndex !== undefined) {\n        index = toInteger(fromIndex);\n        index = fromIndex < 0\n          ? nativeMax(length + index, 0)\n          : nativeMin(index, length - 1);\n      }\n      return baseFindIndex(array, getIteratee(predicate, 3), index, true);\n    }\n\n    /**\n     * Flattens `array` a single level deep.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * _.flatten([1, [2, [3, [4]], 5]]);\n     * // => [1, 2, [3, [4]], 5]\n     */\n    function flatten(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseFlatten(array, 1) : [];\n    }\n\n    /**\n     * Recursively flattens `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * _.flattenDeep([1, [2, [3, [4]], 5]]);\n     * // => [1, 2, 3, 4, 5]\n     */\n    function flattenDeep(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseFlatten(array, INFINITY) : [];\n    }\n\n    /**\n     * Recursively flatten `array` up to `depth` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.4.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @param {number} [depth=1] The maximum recursion depth.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * var array = [1, [2, [3, [4]], 5]];\n     *\n     * _.flattenDepth(array, 1);\n     * // => [1, 2, [3, [4]], 5]\n     *\n     * _.flattenDepth(array, 2);\n     * // => [1, 2, 3, [4], 5]\n     */\n    function flattenDepth(array, depth) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      depth = depth === undefined ? 1 : toInteger(depth);\n      return baseFlatten(array, depth);\n    }\n\n    /**\n     * The inverse of `_.toPairs`; this method returns an object composed\n     * from key-value `pairs`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} pairs The key-value pairs.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.fromPairs([['a', 1], ['b', 2]]);\n     * // => { 'a': 1, 'b': 2 }\n     */\n    function fromPairs(pairs) {\n      var index = -1,\n          length = pairs == null ? 0 : pairs.length,\n          result = {};\n\n      while (++index < length) {\n        var pair = pairs[index];\n        result[pair[0]] = pair[1];\n      }\n      return result;\n    }\n\n    /**\n     * Gets the first element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @alias first\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {*} Returns the first element of `array`.\n     * @example\n     *\n     * _.head([1, 2, 3]);\n     * // => 1\n     *\n     * _.head([]);\n     * // => undefined\n     */\n    function head(array) {\n      return (array && array.length) ? array[0] : undefined;\n    }\n\n    /**\n     * Gets the index at which the first occurrence of `value` is found in `array`\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. If `fromIndex` is negative, it's used as the\n     * offset from the end of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.indexOf([1, 2, 1, 2], 2);\n     * // => 1\n     *\n     * // Search from the `fromIndex`.\n     * _.indexOf([1, 2, 1, 2], 2, 2);\n     * // => 3\n     */\n    function indexOf(array, value, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = fromIndex == null ? 0 : toInteger(fromIndex);\n      if (index < 0) {\n        index = nativeMax(length + index, 0);\n      }\n      return baseIndexOf(array, value, index);\n    }\n\n    /**\n     * Gets all but the last element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.initial([1, 2, 3]);\n     * // => [1, 2]\n     */\n    function initial(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseSlice(array, 0, -1) : [];\n    }\n\n    /**\n     * Creates an array of unique values that are included in all given arrays\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. The order and references of result values are\n     * determined by the first array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * _.intersection([2, 1], [2, 3]);\n     * // => [2]\n     */\n    var intersection = baseRest(function(arrays) {\n      var mapped = arrayMap(arrays, castArrayLikeObject);\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped)\n        : [];\n    });\n\n    /**\n     * This method is like `_.intersection` except that it accepts `iteratee`\n     * which is invoked for each element of each `arrays` to generate the criterion\n     * by which they're compared. The order and references of result values are\n     * determined by the first array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * _.intersectionBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [2.1]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.intersectionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }]\n     */\n    var intersectionBy = baseRest(function(arrays) {\n      var iteratee = last(arrays),\n          mapped = arrayMap(arrays, castArrayLikeObject);\n\n      if (iteratee === last(mapped)) {\n        iteratee = undefined;\n      } else {\n        mapped.pop();\n      }\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped, getIteratee(iteratee, 2))\n        : [];\n    });\n\n    /**\n     * This method is like `_.intersection` except that it accepts `comparator`\n     * which is invoked to compare elements of `arrays`. The order and references\n     * of result values are determined by the first array. The comparator is\n     * invoked with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.intersectionWith(objects, others, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }]\n     */\n    var intersectionWith = baseRest(function(arrays) {\n      var comparator = last(arrays),\n          mapped = arrayMap(arrays, castArrayLikeObject);\n\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      if (comparator) {\n        mapped.pop();\n      }\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped, undefined, comparator)\n        : [];\n    });\n\n    /**\n     * Converts all elements in `array` into a string separated by `separator`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to convert.\n     * @param {string} [separator=','] The element separator.\n     * @returns {string} Returns the joined string.\n     * @example\n     *\n     * _.join(['a', 'b', 'c'], '~');\n     * // => 'a~b~c'\n     */\n    function join(array, separator) {\n      return array == null ? '' : nativeJoin.call(array, separator);\n    }\n\n    /**\n     * Gets the last element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {*} Returns the last element of `array`.\n     * @example\n     *\n     * _.last([1, 2, 3]);\n     * // => 3\n     */\n    function last(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? array[length - 1] : undefined;\n    }\n\n    /**\n     * This method is like `_.indexOf` except that it iterates over elements of\n     * `array` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.lastIndexOf([1, 2, 1, 2], 2);\n     * // => 3\n     *\n     * // Search from the `fromIndex`.\n     * _.lastIndexOf([1, 2, 1, 2], 2, 2);\n     * // => 1\n     */\n    function lastIndexOf(array, value, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = length;\n      if (fromIndex !== undefined) {\n        index = toInteger(fromIndex);\n        index = index < 0 ? nativeMax(length + index, 0) : nativeMin(index, length - 1);\n      }\n      return value === value\n        ? strictLastIndexOf(array, value, index)\n        : baseFindIndex(array, baseIsNaN, index, true);\n    }\n\n    /**\n     * Gets the element at index `n` of `array`. If `n` is negative, the nth\n     * element from the end is returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.11.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=0] The index of the element to return.\n     * @returns {*} Returns the nth element of `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'd'];\n     *\n     * _.nth(array, 1);\n     * // => 'b'\n     *\n     * _.nth(array, -2);\n     * // => 'c';\n     */\n    function nth(array, n) {\n      return (array && array.length) ? baseNth(array, toInteger(n)) : undefined;\n    }\n\n    /**\n     * Removes all given values from `array` using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * **Note:** Unlike `_.without`, this method mutates `array`. Use `_.remove`\n     * to remove elements from an array by predicate.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {...*} [values] The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'a', 'b', 'c'];\n     *\n     * _.pull(array, 'a', 'c');\n     * console.log(array);\n     * // => ['b', 'b']\n     */\n    var pull = baseRest(pullAll);\n\n    /**\n     * This method is like `_.pull` except that it accepts an array of values to remove.\n     *\n     * **Note:** Unlike `_.difference`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'a', 'b', 'c'];\n     *\n     * _.pullAll(array, ['a', 'c']);\n     * console.log(array);\n     * // => ['b', 'b']\n     */\n    function pullAll(array, values) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values)\n        : array;\n    }\n\n    /**\n     * This method is like `_.pullAll` except that it accepts `iteratee` which is\n     * invoked for each element of `array` and `values` to generate the criterion\n     * by which they're compared. The iteratee is invoked with one argument: (value).\n     *\n     * **Note:** Unlike `_.differenceBy`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [{ 'x': 1 }, { 'x': 2 }, { 'x': 3 }, { 'x': 1 }];\n     *\n     * _.pullAllBy(array, [{ 'x': 1 }, { 'x': 3 }], 'x');\n     * console.log(array);\n     * // => [{ 'x': 2 }]\n     */\n    function pullAllBy(array, values, iteratee) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values, getIteratee(iteratee, 2))\n        : array;\n    }\n\n    /**\n     * This method is like `_.pullAll` except that it accepts `comparator` which\n     * is invoked to compare elements of `array` to `values`. The comparator is\n     * invoked with two arguments: (arrVal, othVal).\n     *\n     * **Note:** Unlike `_.differenceWith`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [{ 'x': 1, 'y': 2 }, { 'x': 3, 'y': 4 }, { 'x': 5, 'y': 6 }];\n     *\n     * _.pullAllWith(array, [{ 'x': 3, 'y': 4 }], _.isEqual);\n     * console.log(array);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 5, 'y': 6 }]\n     */\n    function pullAllWith(array, values, comparator) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values, undefined, comparator)\n        : array;\n    }\n\n    /**\n     * Removes elements from `array` corresponding to `indexes` and returns an\n     * array of removed elements.\n     *\n     * **Note:** Unlike `_.at`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {...(number|number[])} [indexes] The indexes of elements to remove.\n     * @returns {Array} Returns the new array of removed elements.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'd'];\n     * var pulled = _.pullAt(array, [1, 3]);\n     *\n     * console.log(array);\n     * // => ['a', 'c']\n     *\n     * console.log(pulled);\n     * // => ['b', 'd']\n     */\n    var pullAt = flatRest(function(array, indexes) {\n      var length = array == null ? 0 : array.length,\n          result = baseAt(array, indexes);\n\n      basePullAt(array, arrayMap(indexes, function(index) {\n        return isIndex(index, length) ? +index : index;\n      }).sort(compareAscending));\n\n      return result;\n    });\n\n    /**\n     * Removes all elements from `array` that `predicate` returns truthy for\n     * and returns an array of the removed elements. The predicate is invoked\n     * with three arguments: (value, index, array).\n     *\n     * **Note:** Unlike `_.filter`, this method mutates `array`. Use `_.pull`\n     * to pull elements from an array by value.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new array of removed elements.\n     * @example\n     *\n     * var array = [1, 2, 3, 4];\n     * var evens = _.remove(array, function(n) {\n     *   return n % 2 == 0;\n     * });\n     *\n     * console.log(array);\n     * // => [1, 3]\n     *\n     * console.log(evens);\n     * // => [2, 4]\n     */\n    function remove(array, predicate) {\n      var result = [];\n      if (!(array && array.length)) {\n        return result;\n      }\n      var index = -1,\n          indexes = [],\n          length = array.length;\n\n      predicate = getIteratee(predicate, 3);\n      while (++index < length) {\n        var value = array[index];\n        if (predicate(value, index, array)) {\n          result.push(value);\n          indexes.push(index);\n        }\n      }\n      basePullAt(array, indexes);\n      return result;\n    }\n\n    /**\n     * Reverses `array` so that the first element becomes the last, the second\n     * element becomes the second to last, and so on.\n     *\n     * **Note:** This method mutates `array` and is based on\n     * [`Array#reverse`](https://mdn.io/Array/reverse).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _.reverse(array);\n     * // => [3, 2, 1]\n     *\n     * console.log(array);\n     * // => [3, 2, 1]\n     */\n    function reverse(array) {\n      return array == null ? array : nativeReverse.call(array);\n    }\n\n    /**\n     * Creates a slice of `array` from `start` up to, but not including, `end`.\n     *\n     * **Note:** This method is used instead of\n     * [`Array#slice`](https://mdn.io/Array/slice) to ensure dense arrays are\n     * returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to slice.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function slice(array, start, end) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      if (end && typeof end != 'number' && isIterateeCall(array, start, end)) {\n        start = 0;\n        end = length;\n      }\n      else {\n        start = start == null ? 0 : toInteger(start);\n        end = end === undefined ? length : toInteger(end);\n      }\n      return baseSlice(array, start, end);\n    }\n\n    /**\n     * Uses a binary search to determine the lowest index at which `value`\n     * should be inserted into `array` in order to maintain its sort order.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedIndex([30, 50], 40);\n     * // => 1\n     */\n    function sortedIndex(array, value) {\n      return baseSortedIndex(array, value);\n    }\n\n    /**\n     * This method is like `_.sortedIndex` except that it accepts `iteratee`\n     * which is invoked for `value` and each element of `array` to compute their\n     * sort ranking. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * var objects = [{ 'x': 4 }, { 'x': 5 }];\n     *\n     * _.sortedIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });\n     * // => 0\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sortedIndexBy(objects, { 'x': 4 }, 'x');\n     * // => 0\n     */\n    function sortedIndexBy(array, value, iteratee) {\n      return baseSortedIndexBy(array, value, getIteratee(iteratee, 2));\n    }\n\n    /**\n     * This method is like `_.indexOf` except that it performs a binary\n     * search on a sorted `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.sortedIndexOf([4, 5, 5, 5, 6], 5);\n     * // => 1\n     */\n    function sortedIndexOf(array, value) {\n      var length = array == null ? 0 : array.length;\n      if (length) {\n        var index = baseSortedIndex(array, value);\n        if (index < length && eq(array[index], value)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.sortedIndex` except that it returns the highest\n     * index at which `value` should be inserted into `array` in order to\n     * maintain its sort order.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedLastIndex([4, 5, 5, 5, 6], 5);\n     * // => 4\n     */\n    function sortedLastIndex(array, value) {\n      return baseSortedIndex(array, value, true);\n    }\n\n    /**\n     * This method is like `_.sortedLastIndex` except that it accepts `iteratee`\n     * which is invoked for `value` and each element of `array` to compute their\n     * sort ranking. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * var objects = [{ 'x': 4 }, { 'x': 5 }];\n     *\n     * _.sortedLastIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });\n     * // => 1\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sortedLastIndexBy(objects, { 'x': 4 }, 'x');\n     * // => 1\n     */\n    function sortedLastIndexBy(array, value, iteratee) {\n      return baseSortedIndexBy(array, value, getIteratee(iteratee, 2), true);\n    }\n\n    /**\n     * This method is like `_.lastIndexOf` except that it performs a binary\n     * search on a sorted `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.sortedLastIndexOf([4, 5, 5, 5, 6], 5);\n     * // => 3\n     */\n    function sortedLastIndexOf(array, value) {\n      var length = array == null ? 0 : array.length;\n      if (length) {\n        var index = baseSortedIndex(array, value, true) - 1;\n        if (eq(array[index], value)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.uniq` except that it's designed and optimized\n     * for sorted arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.sortedUniq([1, 1, 2]);\n     * // => [1, 2]\n     */\n    function sortedUniq(array) {\n      return (array && array.length)\n        ? baseSortedUniq(array)\n        : [];\n    }\n\n    /**\n     * This method is like `_.uniqBy` except that it's designed and optimized\n     * for sorted arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.sortedUniqBy([1.1, 1.2, 2.3, 2.4], Math.floor);\n     * // => [1.1, 2.3]\n     */\n    function sortedUniqBy(array, iteratee) {\n      return (array && array.length)\n        ? baseSortedUniq(array, getIteratee(iteratee, 2))\n        : [];\n    }\n\n    /**\n     * Gets all but the first element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.tail([1, 2, 3]);\n     * // => [2, 3]\n     */\n    function tail(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseSlice(array, 1, length) : [];\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements taken from the beginning.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to take.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.take([1, 2, 3]);\n     * // => [1]\n     *\n     * _.take([1, 2, 3], 2);\n     * // => [1, 2]\n     *\n     * _.take([1, 2, 3], 5);\n     * // => [1, 2, 3]\n     *\n     * _.take([1, 2, 3], 0);\n     * // => []\n     */\n    function take(array, n, guard) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      return baseSlice(array, 0, n < 0 ? 0 : n);\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements taken from the end.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to take.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.takeRight([1, 2, 3]);\n     * // => [3]\n     *\n     * _.takeRight([1, 2, 3], 2);\n     * // => [2, 3]\n     *\n     * _.takeRight([1, 2, 3], 5);\n     * // => [1, 2, 3]\n     *\n     * _.takeRight([1, 2, 3], 0);\n     * // => []\n     */\n    function takeRight(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      n = length - n;\n      return baseSlice(array, n < 0 ? 0 : n, length);\n    }\n\n    /**\n     * Creates a slice of `array` with elements taken from the end. Elements are\n     * taken until `predicate` returns falsey. The predicate is invoked with\n     * three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.takeRightWhile(users, function(o) { return !o.active; });\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.takeRightWhile(users, { 'user': 'pebbles', 'active': false });\n     * // => objects for ['pebbles']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.takeRightWhile(users, ['active', false]);\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.takeRightWhile(users, 'active');\n     * // => []\n     */\n    function takeRightWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), false, true)\n        : [];\n    }\n\n    /**\n     * Creates a slice of `array` with elements taken from the beginning. Elements\n     * are taken until `predicate` returns falsey. The predicate is invoked with\n     * three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.takeWhile(users, function(o) { return !o.active; });\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.takeWhile(users, { 'user': 'barney', 'active': false });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.takeWhile(users, ['active', false]);\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.takeWhile(users, 'active');\n     * // => []\n     */\n    function takeWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3))\n        : [];\n    }\n\n    /**\n     * Creates an array of unique values, in order, from all given arrays using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * _.union([2], [1, 2]);\n     * // => [2, 1]\n     */\n    var union = baseRest(function(arrays) {\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true));\n    });\n\n    /**\n     * This method is like `_.union` except that it accepts `iteratee` which is\n     * invoked for each element of each `arrays` to generate the criterion by\n     * which uniqueness is computed. Result values are chosen from the first\n     * array in which the value occurs. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * _.unionBy([2.1], [1.2, 2.3], Math.floor);\n     * // => [2.1, 1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.unionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    var unionBy = baseRest(function(arrays) {\n      var iteratee = last(arrays);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), getIteratee(iteratee, 2));\n    });\n\n    /**\n     * This method is like `_.union` except that it accepts `comparator` which\n     * is invoked to compare elements of `arrays`. Result values are chosen from\n     * the first array in which the value occurs. The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.unionWith(objects, others, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n     */\n    var unionWith = baseRest(function(arrays) {\n      var comparator = last(arrays);\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), undefined, comparator);\n    });\n\n    /**\n     * Creates a duplicate-free version of an array, using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons, in which only the first occurrence of each element\n     * is kept. The order of result values is determined by the order they occur\n     * in the array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.uniq([2, 1, 2]);\n     * // => [2, 1]\n     */\n    function uniq(array) {\n      return (array && array.length) ? baseUniq(array) : [];\n    }\n\n    /**\n     * This method is like `_.uniq` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * uniqueness is computed. The order of result values is determined by the\n     * order they occur in the array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.uniqBy([2.1, 1.2, 2.3], Math.floor);\n     * // => [2.1, 1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.uniqBy([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    function uniqBy(array, iteratee) {\n      return (array && array.length) ? baseUniq(array, getIteratee(iteratee, 2)) : [];\n    }\n\n    /**\n     * This method is like `_.uniq` except that it accepts `comparator` which\n     * is invoked to compare elements of `array`. The order of result values is\n     * determined by the order they occur in the array.The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.uniqWith(objects, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }]\n     */\n    function uniqWith(array, comparator) {\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return (array && array.length) ? baseUniq(array, undefined, comparator) : [];\n    }\n\n    /**\n     * This method is like `_.zip` except that it accepts an array of grouped\n     * elements and creates an array regrouping the elements to their pre-zip\n     * configuration.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.2.0\n     * @category Array\n     * @param {Array} array The array of grouped elements to process.\n     * @returns {Array} Returns the new array of regrouped elements.\n     * @example\n     *\n     * var zipped = _.zip(['a', 'b'], [1, 2], [true, false]);\n     * // => [['a', 1, true], ['b', 2, false]]\n     *\n     * _.unzip(zipped);\n     * // => [['a', 'b'], [1, 2], [true, false]]\n     */\n    function unzip(array) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      var length = 0;\n      array = arrayFilter(array, function(group) {\n        if (isArrayLikeObject(group)) {\n          length = nativeMax(group.length, length);\n          return true;\n        }\n      });\n      return baseTimes(length, function(index) {\n        return arrayMap(array, baseProperty(index));\n      });\n    }\n\n    /**\n     * This method is like `_.unzip` except that it accepts `iteratee` to specify\n     * how regrouped values should be combined. The iteratee is invoked with the\n     * elements of each group: (...group).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Array\n     * @param {Array} array The array of grouped elements to process.\n     * @param {Function} [iteratee=_.identity] The function to combine\n     *  regrouped values.\n     * @returns {Array} Returns the new array of regrouped elements.\n     * @example\n     *\n     * var zipped = _.zip([1, 2], [10, 20], [100, 200]);\n     * // => [[1, 10, 100], [2, 20, 200]]\n     *\n     * _.unzipWith(zipped, _.add);\n     * // => [3, 30, 300]\n     */\n    function unzipWith(array, iteratee) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      var result = unzip(array);\n      if (iteratee == null) {\n        return result;\n      }\n      return arrayMap(result, function(group) {\n        return apply(iteratee, undefined, group);\n      });\n    }\n\n    /**\n     * Creates an array excluding all given values using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * **Note:** Unlike `_.pull`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...*} [values] The values to exclude.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.difference, _.xor\n     * @example\n     *\n     * _.without([2, 1, 2, 3], 1, 2);\n     * // => [3]\n     */\n    var without = baseRest(function(array, values) {\n      return isArrayLikeObject(array)\n        ? baseDifference(array, values)\n        : [];\n    });\n\n    /**\n     * Creates an array of unique values that is the\n     * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n     * of the given arrays. The order of result values is determined by the order\n     * they occur in the arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.difference, _.without\n     * @example\n     *\n     * _.xor([2, 1], [2, 3]);\n     * // => [1, 3]\n     */\n    var xor = baseRest(function(arrays) {\n      return baseXor(arrayFilter(arrays, isArrayLikeObject));\n    });\n\n    /**\n     * This method is like `_.xor` except that it accepts `iteratee` which is\n     * invoked for each element of each `arrays` to generate the criterion by\n     * which by which they're compared. The order of result values is determined\n     * by the order they occur in the arrays. The iteratee is invoked with one\n     * argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.xorBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [1.2, 3.4]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.xorBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 2 }]\n     */\n    var xorBy = baseRest(function(arrays) {\n      var iteratee = last(arrays);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return baseXor(arrayFilter(arrays, isArrayLikeObject), getIteratee(iteratee, 2));\n    });\n\n    /**\n     * This method is like `_.xor` except that it accepts `comparator` which is\n     * invoked to compare elements of `arrays`. The order of result values is\n     * determined by the order they occur in the arrays. The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.xorWith(objects, others, _.isEqual);\n     * // => [{ 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n     */\n    var xorWith = baseRest(function(arrays) {\n      var comparator = last(arrays);\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return baseXor(arrayFilter(arrays, isArrayLikeObject), undefined, comparator);\n    });\n\n    /**\n     * Creates an array of grouped elements, the first of which contains the\n     * first elements of the given arrays, the second of which contains the\n     * second elements of the given arrays, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to process.\n     * @returns {Array} Returns the new array of grouped elements.\n     * @example\n     *\n     * _.zip(['a', 'b'], [1, 2], [true, false]);\n     * // => [['a', 1, true], ['b', 2, false]]\n     */\n    var zip = baseRest(unzip);\n\n    /**\n     * This method is like `_.fromPairs` except that it accepts two arrays,\n     * one of property identifiers and one of corresponding values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.4.0\n     * @category Array\n     * @param {Array} [props=[]] The property identifiers.\n     * @param {Array} [values=[]] The property values.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.zipObject(['a', 'b'], [1, 2]);\n     * // => { 'a': 1, 'b': 2 }\n     */\n    function zipObject(props, values) {\n      return baseZipObject(props || [], values || [], assignValue);\n    }\n\n    /**\n     * This method is like `_.zipObject` except that it supports property paths.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.1.0\n     * @category Array\n     * @param {Array} [props=[]] The property identifiers.\n     * @param {Array} [values=[]] The property values.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.zipObjectDeep(['a.b[0].c', 'a.b[1].d'], [1, 2]);\n     * // => { 'a': { 'b': [{ 'c': 1 }, { 'd': 2 }] } }\n     */\n    function zipObjectDeep(props, values) {\n      return baseZipObject(props || [], values || [], baseSet);\n    }\n\n    /**\n     * This method is like `_.zip` except that it accepts `iteratee` to specify\n     * how grouped values should be combined. The iteratee is invoked with the\n     * elements of each group: (...group).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to process.\n     * @param {Function} [iteratee=_.identity] The function to combine\n     *  grouped values.\n     * @returns {Array} Returns the new array of grouped elements.\n     * @example\n     *\n     * _.zipWith([1, 2], [10, 20], [100, 200], function(a, b, c) {\n     *   return a + b + c;\n     * });\n     * // => [111, 222]\n     */\n    var zipWith = baseRest(function(arrays) {\n      var length = arrays.length,\n          iteratee = length > 1 ? arrays[length - 1] : undefined;\n\n      iteratee = typeof iteratee == 'function' ? (arrays.pop(), iteratee) : undefined;\n      return unzipWith(arrays, iteratee);\n    });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` wrapper instance that wraps `value` with explicit method\n     * chain sequences enabled. The result of such sequences must be unwrapped\n     * with `_#value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.3.0\n     * @category Seq\n     * @param {*} value The value to wrap.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36 },\n     *   { 'user': 'fred',    'age': 40 },\n     *   { 'user': 'pebbles', 'age': 1 }\n     * ];\n     *\n     * var youngest = _\n     *   .chain(users)\n     *   .sortBy('age')\n     *   .map(function(o) {\n     *     return o.user + ' is ' + o.age;\n     *   })\n     *   .head()\n     *   .value();\n     * // => 'pebbles is 1'\n     */\n    function chain(value) {\n      var result = lodash(value);\n      result.__chain__ = true;\n      return result;\n    }\n\n    /**\n     * This method invokes `interceptor` and returns `value`. The interceptor\n     * is invoked with one argument; (value). The purpose of this method is to\n     * \"tap into\" a method chain sequence in order to modify intermediate results.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * _([1, 2, 3])\n     *  .tap(function(array) {\n     *    // Mutate input array.\n     *    array.pop();\n     *  })\n     *  .reverse()\n     *  .value();\n     * // => [2, 1]\n     */\n    function tap(value, interceptor) {\n      interceptor(value);\n      return value;\n    }\n\n    /**\n     * This method is like `_.tap` except that it returns the result of `interceptor`.\n     * The purpose of this method is to \"pass thru\" values replacing intermediate\n     * results in a method chain sequence.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Seq\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns the result of `interceptor`.\n     * @example\n     *\n     * _('  abc  ')\n     *  .chain()\n     *  .trim()\n     *  .thru(function(value) {\n     *    return [value];\n     *  })\n     *  .value();\n     * // => ['abc']\n     */\n    function thru(value, interceptor) {\n      return interceptor(value);\n    }\n\n    /**\n     * This method is the wrapper version of `_.at`.\n     *\n     * @name at\n     * @memberOf _\n     * @since 1.0.0\n     * @category Seq\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };\n     *\n     * _(object).at(['a[0].b.c', 'a[1]']).value();\n     * // => [3, 4]\n     */\n    var wrapperAt = flatRest(function(paths) {\n      var length = paths.length,\n          start = length ? paths[0] : 0,\n          value = this.__wrapped__,\n          interceptor = function(object) { return baseAt(object, paths); };\n\n      if (length > 1 || this.__actions__.length ||\n          !(value instanceof LazyWrapper) || !isIndex(start)) {\n        return this.thru(interceptor);\n      }\n      value = value.slice(start, +start + (length ? 1 : 0));\n      value.__actions__.push({\n        'func': thru,\n        'args': [interceptor],\n        'thisArg': undefined\n      });\n      return new LodashWrapper(value, this.__chain__).thru(function(array) {\n        if (length && !array.length) {\n          array.push(undefined);\n        }\n        return array;\n      });\n    });\n\n    /**\n     * Creates a `lodash` wrapper instance with explicit method chain sequences enabled.\n     *\n     * @name chain\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36 },\n     *   { 'user': 'fred',   'age': 40 }\n     * ];\n     *\n     * // A sequence without explicit chaining.\n     * _(users).head();\n     * // => { 'user': 'barney', 'age': 36 }\n     *\n     * // A sequence with explicit chaining.\n     * _(users)\n     *   .chain()\n     *   .head()\n     *   .pick('user')\n     *   .value();\n     * // => { 'user': 'barney' }\n     */\n    function wrapperChain() {\n      return chain(this);\n    }\n\n    /**\n     * Executes the chain sequence and returns the wrapped result.\n     *\n     * @name commit\n     * @memberOf _\n     * @since 3.2.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var array = [1, 2];\n     * var wrapped = _(array).push(3);\n     *\n     * console.log(array);\n     * // => [1, 2]\n     *\n     * wrapped = wrapped.commit();\n     * console.log(array);\n     * // => [1, 2, 3]\n     *\n     * wrapped.last();\n     * // => 3\n     *\n     * console.log(array);\n     * // => [1, 2, 3]\n     */\n    function wrapperCommit() {\n      return new LodashWrapper(this.value(), this.__chain__);\n    }\n\n    /**\n     * Gets the next value on a wrapped object following the\n     * [iterator protocol](https://mdn.io/iteration_protocols#iterator).\n     *\n     * @name next\n     * @memberOf _\n     * @since 4.0.0\n     * @category Seq\n     * @returns {Object} Returns the next iterator value.\n     * @example\n     *\n     * var wrapped = _([1, 2]);\n     *\n     * wrapped.next();\n     * // => { 'done': false, 'value': 1 }\n     *\n     * wrapped.next();\n     * // => { 'done': false, 'value': 2 }\n     *\n     * wrapped.next();\n     * // => { 'done': true, 'value': undefined }\n     */\n    function wrapperNext() {\n      if (this.__values__ === undefined) {\n        this.__values__ = toArray(this.value());\n      }\n      var done = this.__index__ >= this.__values__.length,\n          value = done ? undefined : this.__values__[this.__index__++];\n\n      return { 'done': done, 'value': value };\n    }\n\n    /**\n     * Enables the wrapper to be iterable.\n     *\n     * @name Symbol.iterator\n     * @memberOf _\n     * @since 4.0.0\n     * @category Seq\n     * @returns {Object} Returns the wrapper object.\n     * @example\n     *\n     * var wrapped = _([1, 2]);\n     *\n     * wrapped[Symbol.iterator]() === wrapped;\n     * // => true\n     *\n     * Array.from(wrapped);\n     * // => [1, 2]\n     */\n    function wrapperToIterator() {\n      return this;\n    }\n\n    /**\n     * Creates a clone of the chain sequence planting `value` as the wrapped value.\n     *\n     * @name plant\n     * @memberOf _\n     * @since 3.2.0\n     * @category Seq\n     * @param {*} value The value to plant.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var wrapped = _([1, 2]).map(square);\n     * var other = wrapped.plant([3, 4]);\n     *\n     * other.value();\n     * // => [9, 16]\n     *\n     * wrapped.value();\n     * // => [1, 4]\n     */\n    function wrapperPlant(value) {\n      var result,\n          parent = this;\n\n      while (parent instanceof baseLodash) {\n        var clone = wrapperClone(parent);\n        clone.__index__ = 0;\n        clone.__values__ = undefined;\n        if (result) {\n          previous.__wrapped__ = clone;\n        } else {\n          result = clone;\n        }\n        var previous = clone;\n        parent = parent.__wrapped__;\n      }\n      previous.__wrapped__ = value;\n      return result;\n    }\n\n    /**\n     * This method is the wrapper version of `_.reverse`.\n     *\n     * **Note:** This method mutates the wrapped array.\n     *\n     * @name reverse\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _(array).reverse().value()\n     * // => [3, 2, 1]\n     *\n     * console.log(array);\n     * // => [3, 2, 1]\n     */\n    function wrapperReverse() {\n      var value = this.__wrapped__;\n      if (value instanceof LazyWrapper) {\n        var wrapped = value;\n        if (this.__actions__.length) {\n          wrapped = new LazyWrapper(this);\n        }\n        wrapped = wrapped.reverse();\n        wrapped.__actions__.push({\n          'func': thru,\n          'args': [reverse],\n          'thisArg': undefined\n        });\n        return new LodashWrapper(wrapped, this.__chain__);\n      }\n      return this.thru(reverse);\n    }\n\n    /**\n     * Executes the chain sequence to resolve the unwrapped value.\n     *\n     * @name value\n     * @memberOf _\n     * @since 0.1.0\n     * @alias toJSON, valueOf\n     * @category Seq\n     * @returns {*} Returns the resolved unwrapped value.\n     * @example\n     *\n     * _([1, 2, 3]).value();\n     * // => [1, 2, 3]\n     */\n    function wrapperValue() {\n      return baseWrapperValue(this.__wrapped__, this.__actions__);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The corresponding value of\n     * each key is the number of times the key was returned by `iteratee`. The\n     * iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.countBy([6.1, 4.2, 6.3], Math.floor);\n     * // => { '4': 1, '6': 2 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.countBy(['one', 'two', 'three'], 'length');\n     * // => { '3': 2, '5': 1 }\n     */\n    var countBy = createAggregator(function(result, value, key) {\n      if (hasOwnProperty.call(result, key)) {\n        ++result[key];\n      } else {\n        baseAssignValue(result, key, 1);\n      }\n    });\n\n    /**\n     * Checks if `predicate` returns truthy for **all** elements of `collection`.\n     * Iteration is stopped once `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index|key, collection).\n     *\n     * **Note:** This method returns `true` for\n     * [empty collections](https://en.wikipedia.org/wiki/Empty_set) because\n     * [everything is true](https://en.wikipedia.org/wiki/Vacuous_truth) of\n     * elements of empty collections.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {boolean} Returns `true` if all elements pass the predicate check,\n     *  else `false`.\n     * @example\n     *\n     * _.every([true, 1, null, 'yes'], Boolean);\n     * // => false\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': false },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.every(users, { 'user': 'barney', 'active': false });\n     * // => false\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.every(users, ['active', false]);\n     * // => true\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.every(users, 'active');\n     * // => false\n     */\n    function every(collection, predicate, guard) {\n      var func = isArray(collection) ? arrayEvery : baseEvery;\n      if (guard && isIterateeCall(collection, predicate, guard)) {\n        predicate = undefined;\n      }\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Iterates over elements of `collection`, returning an array of all elements\n     * `predicate` returns truthy for. The predicate is invoked with three\n     * arguments: (value, index|key, collection).\n     *\n     * **Note:** Unlike `_.remove`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     * @see _.reject\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': true },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * _.filter(users, function(o) { return !o.active; });\n     * // => objects for ['fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.filter(users, { 'age': 36, 'active': true });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.filter(users, ['active', false]);\n     * // => objects for ['fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.filter(users, 'active');\n     * // => objects for ['barney']\n     *\n     * // Combining several predicates using `_.overEvery` or `_.overSome`.\n     * _.filter(users, _.overSome([{ 'age': 36 }, ['age', 40]]));\n     * // => objects for ['fred', 'barney']\n     */\n    function filter(collection, predicate) {\n      var func = isArray(collection) ? arrayFilter : baseFilter;\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Iterates over elements of `collection`, returning the first element\n     * `predicate` returns truthy for. The predicate is invoked with three\n     * arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {*} Returns the matched element, else `undefined`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36, 'active': true },\n     *   { 'user': 'fred',    'age': 40, 'active': false },\n     *   { 'user': 'pebbles', 'age': 1,  'active': true }\n     * ];\n     *\n     * _.find(users, function(o) { return o.age < 40; });\n     * // => object for 'barney'\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.find(users, { 'age': 1, 'active': true });\n     * // => object for 'pebbles'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.find(users, ['active', false]);\n     * // => object for 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.find(users, 'active');\n     * // => object for 'barney'\n     */\n    var find = createFind(findIndex);\n\n    /**\n     * This method is like `_.find` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=collection.length-1] The index to search from.\n     * @returns {*} Returns the matched element, else `undefined`.\n     * @example\n     *\n     * _.findLast([1, 2, 3, 4], function(n) {\n     *   return n % 2 == 1;\n     * });\n     * // => 3\n     */\n    var findLast = createFind(findLastIndex);\n\n    /**\n     * Creates a flattened array of values by running each element in `collection`\n     * thru `iteratee` and flattening the mapped results. The iteratee is invoked\n     * with three arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [n, n];\n     * }\n     *\n     * _.flatMap([1, 2], duplicate);\n     * // => [1, 1, 2, 2]\n     */\n    function flatMap(collection, iteratee) {\n      return baseFlatten(map(collection, iteratee), 1);\n    }\n\n    /**\n     * This method is like `_.flatMap` except that it recursively flattens the\n     * mapped results.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [[[n, n]]];\n     * }\n     *\n     * _.flatMapDeep([1, 2], duplicate);\n     * // => [1, 1, 2, 2]\n     */\n    function flatMapDeep(collection, iteratee) {\n      return baseFlatten(map(collection, iteratee), INFINITY);\n    }\n\n    /**\n     * This method is like `_.flatMap` except that it recursively flattens the\n     * mapped results up to `depth` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {number} [depth=1] The maximum recursion depth.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [[[n, n]]];\n     * }\n     *\n     * _.flatMapDepth([1, 2], duplicate, 2);\n     * // => [[1, 1], [2, 2]]\n     */\n    function flatMapDepth(collection, iteratee, depth) {\n      depth = depth === undefined ? 1 : toInteger(depth);\n      return baseFlatten(map(collection, iteratee), depth);\n    }\n\n    /**\n     * Iterates over elements of `collection` and invokes `iteratee` for each element.\n     * The iteratee is invoked with three arguments: (value, index|key, collection).\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n     * property are iterated like arrays. To avoid this behavior use `_.forIn`\n     * or `_.forOwn` for object iteration.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @alias each\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     * @see _.forEachRight\n     * @example\n     *\n     * _.forEach([1, 2], function(value) {\n     *   console.log(value);\n     * });\n     * // => Logs `1` then `2`.\n     *\n     * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n     */\n    function forEach(collection, iteratee) {\n      var func = isArray(collection) ? arrayEach : baseEach;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.forEach` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @alias eachRight\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     * @see _.forEach\n     * @example\n     *\n     * _.forEachRight([1, 2], function(value) {\n     *   console.log(value);\n     * });\n     * // => Logs `2` then `1`.\n     */\n    function forEachRight(collection, iteratee) {\n      var func = isArray(collection) ? arrayEachRight : baseEachRight;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The order of grouped values\n     * is determined by the order they occur in `collection`. The corresponding\n     * value of each key is an array of elements responsible for generating the\n     * key. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.groupBy([6.1, 4.2, 6.3], Math.floor);\n     * // => { '4': [4.2], '6': [6.1, 6.3] }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.groupBy(['one', 'two', 'three'], 'length');\n     * // => { '3': ['one', 'two'], '5': ['three'] }\n     */\n    var groupBy = createAggregator(function(result, value, key) {\n      if (hasOwnProperty.call(result, key)) {\n        result[key].push(value);\n      } else {\n        baseAssignValue(result, key, [value]);\n      }\n    });\n\n    /**\n     * Checks if `value` is in `collection`. If `collection` is a string, it's\n     * checked for a substring of `value`, otherwise\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * is used for equality comparisons. If `fromIndex` is negative, it's used as\n     * the offset from the end of `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n     * @returns {boolean} Returns `true` if `value` is found, else `false`.\n     * @example\n     *\n     * _.includes([1, 2, 3], 1);\n     * // => true\n     *\n     * _.includes([1, 2, 3], 1, 2);\n     * // => false\n     *\n     * _.includes({ 'a': 1, 'b': 2 }, 1);\n     * // => true\n     *\n     * _.includes('abcd', 'bc');\n     * // => true\n     */\n    function includes(collection, value, fromIndex, guard) {\n      collection = isArrayLike(collection) ? collection : values(collection);\n      fromIndex = (fromIndex && !guard) ? toInteger(fromIndex) : 0;\n\n      var length = collection.length;\n      if (fromIndex < 0) {\n        fromIndex = nativeMax(length + fromIndex, 0);\n      }\n      return isString(collection)\n        ? (fromIndex <= length && collection.indexOf(value, fromIndex) > -1)\n        : (!!length && baseIndexOf(collection, value, fromIndex) > -1);\n    }\n\n    /**\n     * Invokes the method at `path` of each element in `collection`, returning\n     * an array of the results of each invoked method. Any additional arguments\n     * are provided to each invoked method. If `path` is a function, it's invoked\n     * for, and `this` bound to, each element in `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Array|Function|string} path The path of the method to invoke or\n     *  the function invoked per iteration.\n     * @param {...*} [args] The arguments to invoke each method with.\n     * @returns {Array} Returns the array of results.\n     * @example\n     *\n     * _.invokeMap([[5, 1, 7], [3, 2, 1]], 'sort');\n     * // => [[1, 5, 7], [1, 2, 3]]\n     *\n     * _.invokeMap([123, 456], String.prototype.split, '');\n     * // => [['1', '2', '3'], ['4', '5', '6']]\n     */\n    var invokeMap = baseRest(function(collection, path, args) {\n      var index = -1,\n          isFunc = typeof path == 'function',\n          result = isArrayLike(collection) ? Array(collection.length) : [];\n\n      baseEach(collection, function(value) {\n        result[++index] = isFunc ? apply(path, value, args) : baseInvoke(value, path, args);\n      });\n      return result;\n    });\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The corresponding value of\n     * each key is the last element responsible for generating the key. The\n     * iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * var array = [\n     *   { 'dir': 'left', 'code': 97 },\n     *   { 'dir': 'right', 'code': 100 }\n     * ];\n     *\n     * _.keyBy(array, function(o) {\n     *   return String.fromCharCode(o.code);\n     * });\n     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n     *\n     * _.keyBy(array, 'dir');\n     * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n     */\n    var keyBy = createAggregator(function(result, value, key) {\n      baseAssignValue(result, key, value);\n    });\n\n    /**\n     * Creates an array of values by running each element in `collection` thru\n     * `iteratee`. The iteratee is invoked with three arguments:\n     * (value, index|key, collection).\n     *\n     * Many lodash methods are guarded to work as iteratees for methods like\n     * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n     *\n     * The guarded methods are:\n     * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n     * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n     * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n     * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new mapped array.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * _.map([4, 8], square);\n     * // => [16, 64]\n     *\n     * _.map({ 'a': 4, 'b': 8 }, square);\n     * // => [16, 64] (iteration order is not guaranteed)\n     *\n     * var users = [\n     *   { 'user': 'barney' },\n     *   { 'user': 'fred' }\n     * ];\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.map(users, 'user');\n     * // => ['barney', 'fred']\n     */\n    function map(collection, iteratee) {\n      var func = isArray(collection) ? arrayMap : baseMap;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.sortBy` except that it allows specifying the sort\n     * orders of the iteratees to sort by. If `orders` is unspecified, all values\n     * are sorted in ascending order. Otherwise, specify an order of \"desc\" for\n     * descending or \"asc\" for ascending sort order of corresponding values.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]\n     *  The iteratees to sort by.\n     * @param {string[]} [orders] The sort orders of `iteratees`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n     * @returns {Array} Returns the new sorted array.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'fred',   'age': 48 },\n     *   { 'user': 'barney', 'age': 34 },\n     *   { 'user': 'fred',   'age': 40 },\n     *   { 'user': 'barney', 'age': 36 }\n     * ];\n     *\n     * // Sort by `user` in ascending order and by `age` in descending order.\n     * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);\n     * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n     */\n    function orderBy(collection, iteratees, orders, guard) {\n      if (collection == null) {\n        return [];\n      }\n      if (!isArray(iteratees)) {\n        iteratees = iteratees == null ? [] : [iteratees];\n      }\n      orders = guard ? undefined : orders;\n      if (!isArray(orders)) {\n        orders = orders == null ? [] : [orders];\n      }\n      return baseOrderBy(collection, iteratees, orders);\n    }\n\n    /**\n     * Creates an array of elements split into two groups, the first of which\n     * contains elements `predicate` returns truthy for, the second of which\n     * contains elements `predicate` returns falsey for. The predicate is\n     * invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the array of grouped elements.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36, 'active': false },\n     *   { 'user': 'fred',    'age': 40, 'active': true },\n     *   { 'user': 'pebbles', 'age': 1,  'active': false }\n     * ];\n     *\n     * _.partition(users, function(o) { return o.active; });\n     * // => objects for [['fred'], ['barney', 'pebbles']]\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.partition(users, { 'age': 1, 'active': false });\n     * // => objects for [['pebbles'], ['barney', 'fred']]\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.partition(users, ['active', false]);\n     * // => objects for [['barney', 'pebbles'], ['fred']]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.partition(users, 'active');\n     * // => objects for [['fred'], ['barney', 'pebbles']]\n     */\n    var partition = createAggregator(function(result, value, key) {\n      result[key ? 0 : 1].push(value);\n    }, function() { return [[], []]; });\n\n    /**\n     * Reduces `collection` to a value which is the accumulated result of running\n     * each element in `collection` thru `iteratee`, where each successive\n     * invocation is supplied the return value of the previous. If `accumulator`\n     * is not given, the first element of `collection` is used as the initial\n     * value. The iteratee is invoked with four arguments:\n     * (accumulator, value, index|key, collection).\n     *\n     * Many lodash methods are guarded to work as iteratees for methods like\n     * `_.reduce`, `_.reduceRight`, and `_.transform`.\n     *\n     * The guarded methods are:\n     * `assign`, `defaults`, `defaultsDeep`, `includes`, `merge`, `orderBy`,\n     * and `sortBy`\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The initial value.\n     * @returns {*} Returns the accumulated value.\n     * @see _.reduceRight\n     * @example\n     *\n     * _.reduce([1, 2], function(sum, n) {\n     *   return sum + n;\n     * }, 0);\n     * // => 3\n     *\n     * _.reduce({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n     *   (result[value] || (result[value] = [])).push(key);\n     *   return result;\n     * }, {});\n     * // => { '1': ['a', 'c'], '2': ['b'] } (iteration order is not guaranteed)\n     */\n    function reduce(collection, iteratee, accumulator) {\n      var func = isArray(collection) ? arrayReduce : baseReduce,\n          initAccum = arguments.length < 3;\n\n      return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEach);\n    }\n\n    /**\n     * This method is like `_.reduce` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The initial value.\n     * @returns {*} Returns the accumulated value.\n     * @see _.reduce\n     * @example\n     *\n     * var array = [[0, 1], [2, 3], [4, 5]];\n     *\n     * _.reduceRight(array, function(flattened, other) {\n     *   return flattened.concat(other);\n     * }, []);\n     * // => [4, 5, 2, 3, 0, 1]\n     */\n    function reduceRight(collection, iteratee, accumulator) {\n      var func = isArray(collection) ? arrayReduceRight : baseReduce,\n          initAccum = arguments.length < 3;\n\n      return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEachRight);\n    }\n\n    /**\n     * The opposite of `_.filter`; this method returns the elements of `collection`\n     * that `predicate` does **not** return truthy for.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     * @see _.filter\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': false },\n     *   { 'user': 'fred',   'age': 40, 'active': true }\n     * ];\n     *\n     * _.reject(users, function(o) { return !o.active; });\n     * // => objects for ['fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.reject(users, { 'age': 40, 'active': true });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.reject(users, ['active', false]);\n     * // => objects for ['fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.reject(users, 'active');\n     * // => objects for ['barney']\n     */\n    function reject(collection, predicate) {\n      var func = isArray(collection) ? arrayFilter : baseFilter;\n      return func(collection, negate(getIteratee(predicate, 3)));\n    }\n\n    /**\n     * Gets a random element from `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to sample.\n     * @returns {*} Returns the random element.\n     * @example\n     *\n     * _.sample([1, 2, 3, 4]);\n     * // => 2\n     */\n    function sample(collection) {\n      var func = isArray(collection) ? arraySample : baseSample;\n      return func(collection);\n    }\n\n    /**\n     * Gets `n` random elements at unique keys from `collection` up to the\n     * size of `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to sample.\n     * @param {number} [n=1] The number of elements to sample.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the random elements.\n     * @example\n     *\n     * _.sampleSize([1, 2, 3], 2);\n     * // => [3, 1]\n     *\n     * _.sampleSize([1, 2, 3], 4);\n     * // => [2, 3, 1]\n     */\n    function sampleSize(collection, n, guard) {\n      if ((guard ? isIterateeCall(collection, n, guard) : n === undefined)) {\n        n = 1;\n      } else {\n        n = toInteger(n);\n      }\n      var func = isArray(collection) ? arraySampleSize : baseSampleSize;\n      return func(collection, n);\n    }\n\n    /**\n     * Creates an array of shuffled values, using a version of the\n     * [Fisher-Yates shuffle](https://en.wikipedia.org/wiki/Fisher-Yates_shuffle).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     * @example\n     *\n     * _.shuffle([1, 2, 3, 4]);\n     * // => [4, 1, 3, 2]\n     */\n    function shuffle(collection) {\n      var func = isArray(collection) ? arrayShuffle : baseShuffle;\n      return func(collection);\n    }\n\n    /**\n     * Gets the size of `collection` by returning its length for array-like\n     * values or the number of own enumerable string keyed properties for objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @returns {number} Returns the collection size.\n     * @example\n     *\n     * _.size([1, 2, 3]);\n     * // => 3\n     *\n     * _.size({ 'a': 1, 'b': 2 });\n     * // => 2\n     *\n     * _.size('pebbles');\n     * // => 7\n     */\n    function size(collection) {\n      if (collection == null) {\n        return 0;\n      }\n      if (isArrayLike(collection)) {\n        return isString(collection) ? stringSize(collection) : collection.length;\n      }\n      var tag = getTag(collection);\n      if (tag == mapTag || tag == setTag) {\n        return collection.size;\n      }\n      return baseKeys(collection).length;\n    }\n\n    /**\n     * Checks if `predicate` returns truthy for **any** element of `collection`.\n     * Iteration is stopped once `predicate` returns truthy. The predicate is\n     * invoked with three arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {boolean} Returns `true` if any element passes the predicate check,\n     *  else `false`.\n     * @example\n     *\n     * _.some([null, 0, 'yes', false], Boolean);\n     * // => true\n     *\n     * var users = [\n     *   { 'user': 'barney', 'active': true },\n     *   { 'user': 'fred',   'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.some(users, { 'user': 'barney', 'active': false });\n     * // => false\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.some(users, ['active', false]);\n     * // => true\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.some(users, 'active');\n     * // => true\n     */\n    function some(collection, predicate, guard) {\n      var func = isArray(collection) ? arraySome : baseSome;\n      if (guard && isIterateeCall(collection, predicate, guard)) {\n        predicate = undefined;\n      }\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Creates an array of elements, sorted in ascending order by the results of\n     * running each element in a collection thru each iteratee. This method\n     * performs a stable sort, that is, it preserves the original sort order of\n     * equal elements. The iteratees are invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {...(Function|Function[])} [iteratees=[_.identity]]\n     *  The iteratees to sort by.\n     * @returns {Array} Returns the new sorted array.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'fred',   'age': 48 },\n     *   { 'user': 'barney', 'age': 36 },\n     *   { 'user': 'fred',   'age': 30 },\n     *   { 'user': 'barney', 'age': 34 }\n     * ];\n     *\n     * _.sortBy(users, [function(o) { return o.user; }]);\n     * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 30]]\n     *\n     * _.sortBy(users, ['user', 'age']);\n     * // => objects for [['barney', 34], ['barney', 36], ['fred', 30], ['fred', 48]]\n     */\n    var sortBy = baseRest(function(collection, iteratees) {\n      if (collection == null) {\n        return [];\n      }\n      var length = iteratees.length;\n      if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {\n        iteratees = [];\n      } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {\n        iteratees = [iteratees[0]];\n      }\n      return baseOrderBy(collection, baseFlatten(iteratees, 1), []);\n    });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Gets the timestamp of the number of milliseconds that have elapsed since\n     * the Unix epoch (1 January 1970 00:00:00 UTC).\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Date\n     * @returns {number} Returns the timestamp.\n     * @example\n     *\n     * _.defer(function(stamp) {\n     *   console.log(_.now() - stamp);\n     * }, _.now());\n     * // => Logs the number of milliseconds it took for the deferred invocation.\n     */\n    var now = ctxNow || function() {\n      return root.Date.now();\n    };\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The opposite of `_.before`; this method creates a function that invokes\n     * `func` once it's called `n` or more times.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {number} n The number of calls before `func` is invoked.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var saves = ['profile', 'settings'];\n     *\n     * var done = _.after(saves.length, function() {\n     *   console.log('done saving!');\n     * });\n     *\n     * _.forEach(saves, function(type) {\n     *   asyncSave({ 'type': type, 'complete': done });\n     * });\n     * // => Logs 'done saving!' after the two async saves have completed.\n     */\n    function after(n, func) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      n = toInteger(n);\n      return function() {\n        if (--n < 1) {\n          return func.apply(this, arguments);\n        }\n      };\n    }\n\n    /**\n     * Creates a function that invokes `func`, with up to `n` arguments,\n     * ignoring any additional arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to cap arguments for.\n     * @param {number} [n=func.length] The arity cap.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new capped function.\n     * @example\n     *\n     * _.map(['6', '8', '10'], _.ary(parseInt, 1));\n     * // => [6, 8, 10]\n     */\n    function ary(func, n, guard) {\n      n = guard ? undefined : n;\n      n = (func && n == null) ? func.length : n;\n      return createWrap(func, WRAP_ARY_FLAG, undefined, undefined, undefined, undefined, n);\n    }\n\n    /**\n     * Creates a function that invokes `func`, with the `this` binding and arguments\n     * of the created function, while it's called less than `n` times. Subsequent\n     * calls to the created function return the result of the last `func` invocation.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {number} n The number of calls at which `func` is no longer invoked.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * jQuery(element).on('click', _.before(5, addContactToList));\n     * // => Allows adding up to 4 contacts to the list.\n     */\n    function before(n, func) {\n      var result;\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      n = toInteger(n);\n      return function() {\n        if (--n > 0) {\n          result = func.apply(this, arguments);\n        }\n        if (n <= 1) {\n          func = undefined;\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of `thisArg`\n     * and `partials` prepended to the arguments it receives.\n     *\n     * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,\n     * may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** Unlike native `Function#bind`, this method doesn't set the \"length\"\n     * property of bound functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to bind.\n     * @param {*} thisArg The `this` binding of `func`.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * function greet(greeting, punctuation) {\n     *   return greeting + ' ' + this.user + punctuation;\n     * }\n     *\n     * var object = { 'user': 'fred' };\n     *\n     * var bound = _.bind(greet, object, 'hi');\n     * bound('!');\n     * // => 'hi fred!'\n     *\n     * // Bound with placeholders.\n     * var bound = _.bind(greet, object, _, '!');\n     * bound('hi');\n     * // => 'hi fred!'\n     */\n    var bind = baseRest(function(func, thisArg, partials) {\n      var bitmask = WRAP_BIND_FLAG;\n      if (partials.length) {\n        var holders = replaceHolders(partials, getHolder(bind));\n        bitmask |= WRAP_PARTIAL_FLAG;\n      }\n      return createWrap(func, bitmask, thisArg, partials, holders);\n    });\n\n    /**\n     * Creates a function that invokes the method at `object[key]` with `partials`\n     * prepended to the arguments it receives.\n     *\n     * This method differs from `_.bind` by allowing bound functions to reference\n     * methods that may be redefined or don't yet exist. See\n     * [Peter Michaux's article](http://peter.michaux.ca/articles/lazy-function-definition-pattern)\n     * for more details.\n     *\n     * The `_.bindKey.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.10.0\n     * @category Function\n     * @param {Object} object The object to invoke the method on.\n     * @param {string} key The key of the method.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * var object = {\n     *   'user': 'fred',\n     *   'greet': function(greeting, punctuation) {\n     *     return greeting + ' ' + this.user + punctuation;\n     *   }\n     * };\n     *\n     * var bound = _.bindKey(object, 'greet', 'hi');\n     * bound('!');\n     * // => 'hi fred!'\n     *\n     * object.greet = function(greeting, punctuation) {\n     *   return greeting + 'ya ' + this.user + punctuation;\n     * };\n     *\n     * bound('!');\n     * // => 'hiya fred!'\n     *\n     * // Bound with placeholders.\n     * var bound = _.bindKey(object, 'greet', _, '!');\n     * bound('hi');\n     * // => 'hiya fred!'\n     */\n    var bindKey = baseRest(function(object, key, partials) {\n      var bitmask = WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG;\n      if (partials.length) {\n        var holders = replaceHolders(partials, getHolder(bindKey));\n        bitmask |= WRAP_PARTIAL_FLAG;\n      }\n      return createWrap(key, bitmask, object, partials, holders);\n    });\n\n    /**\n     * Creates a function that accepts arguments of `func` and either invokes\n     * `func` returning its result, if at least `arity` number of arguments have\n     * been provided, or returns a function that accepts the remaining `func`\n     * arguments, and so on. The arity of `func` may be specified if `func.length`\n     * is not sufficient.\n     *\n     * The `_.curry.placeholder` value, which defaults to `_` in monolithic builds,\n     * may be used as a placeholder for provided arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of curried functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Function\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var abc = function(a, b, c) {\n     *   return [a, b, c];\n     * };\n     *\n     * var curried = _.curry(abc);\n     *\n     * curried(1)(2)(3);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2)(3);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2, 3);\n     * // => [1, 2, 3]\n     *\n     * // Curried with placeholders.\n     * curried(1)(_, 3)(2);\n     * // => [1, 2, 3]\n     */\n    function curry(func, arity, guard) {\n      arity = guard ? undefined : arity;\n      var result = createWrap(func, WRAP_CURRY_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n      result.placeholder = curry.placeholder;\n      return result;\n    }\n\n    /**\n     * This method is like `_.curry` except that arguments are applied to `func`\n     * in the manner of `_.partialRight` instead of `_.partial`.\n     *\n     * The `_.curryRight.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for provided arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of curried functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var abc = function(a, b, c) {\n     *   return [a, b, c];\n     * };\n     *\n     * var curried = _.curryRight(abc);\n     *\n     * curried(3)(2)(1);\n     * // => [1, 2, 3]\n     *\n     * curried(2, 3)(1);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2, 3);\n     * // => [1, 2, 3]\n     *\n     * // Curried with placeholders.\n     * curried(3)(1, _)(2);\n     * // => [1, 2, 3]\n     */\n    function curryRight(func, arity, guard) {\n      arity = guard ? undefined : arity;\n      var result = createWrap(func, WRAP_CURRY_RIGHT_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n      result.placeholder = curryRight.placeholder;\n      return result;\n    }\n\n    /**\n     * Creates a debounced function that delays invoking `func` until after `wait`\n     * milliseconds have elapsed since the last time the debounced function was\n     * invoked. The debounced function comes with a `cancel` method to cancel\n     * delayed `func` invocations and a `flush` method to immediately invoke them.\n     * Provide `options` to indicate whether `func` should be invoked on the\n     * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n     * with the last arguments provided to the debounced function. Subsequent\n     * calls to the debounced function return the result of the last `func`\n     * invocation.\n     *\n     * **Note:** If `leading` and `trailing` options are `true`, `func` is\n     * invoked on the trailing edge of the timeout only if the debounced function\n     * is invoked more than once during the `wait` timeout.\n     *\n     * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n     * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n     *\n     * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n     * for details over the differences between `_.debounce` and `_.throttle`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to debounce.\n     * @param {number} [wait=0] The number of milliseconds to delay.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.leading=false]\n     *  Specify invoking on the leading edge of the timeout.\n     * @param {number} [options.maxWait]\n     *  The maximum time `func` is allowed to be delayed before it's invoked.\n     * @param {boolean} [options.trailing=true]\n     *  Specify invoking on the trailing edge of the timeout.\n     * @returns {Function} Returns the new debounced function.\n     * @example\n     *\n     * // Avoid costly calculations while the window size is in flux.\n     * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n     *\n     * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n     * jQuery(element).on('click', _.debounce(sendMail, 300, {\n     *   'leading': true,\n     *   'trailing': false\n     * }));\n     *\n     * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n     * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n     * var source = new EventSource('/stream');\n     * jQuery(source).on('message', debounced);\n     *\n     * // Cancel the trailing debounced invocation.\n     * jQuery(window).on('popstate', debounced.cancel);\n     */\n    function debounce(func, wait, options) {\n      var lastArgs,\n          lastThis,\n          maxWait,\n          result,\n          timerId,\n          lastCallTime,\n          lastInvokeTime = 0,\n          leading = false,\n          maxing = false,\n          trailing = true;\n\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      wait = toNumber(wait) || 0;\n      if (isObject(options)) {\n        leading = !!options.leading;\n        maxing = 'maxWait' in options;\n        maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n        trailing = 'trailing' in options ? !!options.trailing : trailing;\n      }\n\n      function invokeFunc(time) {\n        var args = lastArgs,\n            thisArg = lastThis;\n\n        lastArgs = lastThis = undefined;\n        lastInvokeTime = time;\n        result = func.apply(thisArg, args);\n        return result;\n      }\n\n      function leadingEdge(time) {\n        // Reset any `maxWait` timer.\n        lastInvokeTime = time;\n        // Start the timer for the trailing edge.\n        timerId = setTimeout(timerExpired, wait);\n        // Invoke the leading edge.\n        return leading ? invokeFunc(time) : result;\n      }\n\n      function remainingWait(time) {\n        var timeSinceLastCall = time - lastCallTime,\n            timeSinceLastInvoke = time - lastInvokeTime,\n            timeWaiting = wait - timeSinceLastCall;\n\n        return maxing\n          ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n          : timeWaiting;\n      }\n\n      function shouldInvoke(time) {\n        var timeSinceLastCall = time - lastCallTime,\n            timeSinceLastInvoke = time - lastInvokeTime;\n\n        // Either this is the first call, activity has stopped and we're at the\n        // trailing edge, the system time has gone backwards and we're treating\n        // it as the trailing edge, or we've hit the `maxWait` limit.\n        return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n          (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n      }\n\n      function timerExpired() {\n        var time = now();\n        if (shouldInvoke(time)) {\n          return trailingEdge(time);\n        }\n        // Restart the timer.\n        timerId = setTimeout(timerExpired, remainingWait(time));\n      }\n\n      function trailingEdge(time) {\n        timerId = undefined;\n\n        // Only invoke if we have `lastArgs` which means `func` has been\n        // debounced at least once.\n        if (trailing && lastArgs) {\n          return invokeFunc(time);\n        }\n        lastArgs = lastThis = undefined;\n        return result;\n      }\n\n      function cancel() {\n        if (timerId !== undefined) {\n          clearTimeout(timerId);\n        }\n        lastInvokeTime = 0;\n        lastArgs = lastCallTime = lastThis = timerId = undefined;\n      }\n\n      function flush() {\n        return timerId === undefined ? result : trailingEdge(now());\n      }\n\n      function debounced() {\n        var time = now(),\n            isInvoking = shouldInvoke(time);\n\n        lastArgs = arguments;\n        lastThis = this;\n        lastCallTime = time;\n\n        if (isInvoking) {\n          if (timerId === undefined) {\n            return leadingEdge(lastCallTime);\n          }\n          if (maxing) {\n            // Handle invocations in a tight loop.\n            clearTimeout(timerId);\n            timerId = setTimeout(timerExpired, wait);\n            return invokeFunc(lastCallTime);\n          }\n        }\n        if (timerId === undefined) {\n          timerId = setTimeout(timerExpired, wait);\n        }\n        return result;\n      }\n      debounced.cancel = cancel;\n      debounced.flush = flush;\n      return debounced;\n    }\n\n    /**\n     * Defers invoking the `func` until the current call stack has cleared. Any\n     * additional arguments are provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to defer.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.defer(function(text) {\n     *   console.log(text);\n     * }, 'deferred');\n     * // => Logs 'deferred' after one millisecond.\n     */\n    var defer = baseRest(function(func, args) {\n      return baseDelay(func, 1, args);\n    });\n\n    /**\n     * Invokes `func` after `wait` milliseconds. Any additional arguments are\n     * provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.delay(function(text) {\n     *   console.log(text);\n     * }, 1000, 'later');\n     * // => Logs 'later' after one second.\n     */\n    var delay = baseRest(function(func, wait, args) {\n      return baseDelay(func, toNumber(wait) || 0, args);\n    });\n\n    /**\n     * Creates a function that invokes `func` with arguments reversed.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to flip arguments for.\n     * @returns {Function} Returns the new flipped function.\n     * @example\n     *\n     * var flipped = _.flip(function() {\n     *   return _.toArray(arguments);\n     * });\n     *\n     * flipped('a', 'b', 'c', 'd');\n     * // => ['d', 'c', 'b', 'a']\n     */\n    function flip(func) {\n      return createWrap(func, WRAP_FLIP_FLAG);\n    }\n\n    /**\n     * Creates a function that memoizes the result of `func`. If `resolver` is\n     * provided, it determines the cache key for storing the result based on the\n     * arguments provided to the memoized function. By default, the first argument\n     * provided to the memoized function is used as the map cache key. The `func`\n     * is invoked with the `this` binding of the memoized function.\n     *\n     * **Note:** The cache is exposed as the `cache` property on the memoized\n     * function. Its creation may be customized by replacing the `_.memoize.Cache`\n     * constructor with one whose instances implement the\n     * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n     * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to have its output memoized.\n     * @param {Function} [resolver] The function to resolve the cache key.\n     * @returns {Function} Returns the new memoized function.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     * var other = { 'c': 3, 'd': 4 };\n     *\n     * var values = _.memoize(_.values);\n     * values(object);\n     * // => [1, 2]\n     *\n     * values(other);\n     * // => [3, 4]\n     *\n     * object.a = 2;\n     * values(object);\n     * // => [1, 2]\n     *\n     * // Modify the result cache.\n     * values.cache.set(object, ['a', 'b']);\n     * values(object);\n     * // => ['a', 'b']\n     *\n     * // Replace `_.memoize.Cache`.\n     * _.memoize.Cache = WeakMap;\n     */\n    function memoize(func, resolver) {\n      if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      var memoized = function() {\n        var args = arguments,\n            key = resolver ? resolver.apply(this, args) : args[0],\n            cache = memoized.cache;\n\n        if (cache.has(key)) {\n          return cache.get(key);\n        }\n        var result = func.apply(this, args);\n        memoized.cache = cache.set(key, result) || cache;\n        return result;\n      };\n      memoized.cache = new (memoize.Cache || MapCache);\n      return memoized;\n    }\n\n    // Expose `MapCache`.\n    memoize.Cache = MapCache;\n\n    /**\n     * Creates a function that negates the result of the predicate `func`. The\n     * `func` predicate is invoked with the `this` binding and arguments of the\n     * created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} predicate The predicate to negate.\n     * @returns {Function} Returns the new negated function.\n     * @example\n     *\n     * function isEven(n) {\n     *   return n % 2 == 0;\n     * }\n     *\n     * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));\n     * // => [1, 3, 5]\n     */\n    function negate(predicate) {\n      if (typeof predicate != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      return function() {\n        var args = arguments;\n        switch (args.length) {\n          case 0: return !predicate.call(this);\n          case 1: return !predicate.call(this, args[0]);\n          case 2: return !predicate.call(this, args[0], args[1]);\n          case 3: return !predicate.call(this, args[0], args[1], args[2]);\n        }\n        return !predicate.apply(this, args);\n      };\n    }\n\n    /**\n     * Creates a function that is restricted to invoking `func` once. Repeat calls\n     * to the function return the value of the first invocation. The `func` is\n     * invoked with the `this` binding and arguments of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var initialize = _.once(createApplication);\n     * initialize();\n     * initialize();\n     * // => `createApplication` is invoked once\n     */\n    function once(func) {\n      return before(2, func);\n    }\n\n    /**\n     * Creates a function that invokes `func` with its arguments transformed.\n     *\n     * @static\n     * @since 4.0.0\n     * @memberOf _\n     * @category Function\n     * @param {Function} func The function to wrap.\n     * @param {...(Function|Function[])} [transforms=[_.identity]]\n     *  The argument transforms.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * function doubled(n) {\n     *   return n * 2;\n     * }\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var func = _.overArgs(function(x, y) {\n     *   return [x, y];\n     * }, [square, doubled]);\n     *\n     * func(9, 3);\n     * // => [81, 6]\n     *\n     * func(10, 5);\n     * // => [100, 10]\n     */\n    var overArgs = castRest(function(func, transforms) {\n      transforms = (transforms.length == 1 && isArray(transforms[0]))\n        ? arrayMap(transforms[0], baseUnary(getIteratee()))\n        : arrayMap(baseFlatten(transforms, 1), baseUnary(getIteratee()));\n\n      var funcsLength = transforms.length;\n      return baseRest(function(args) {\n        var index = -1,\n            length = nativeMin(args.length, funcsLength);\n\n        while (++index < length) {\n          args[index] = transforms[index].call(this, args[index]);\n        }\n        return apply(func, this, args);\n      });\n    });\n\n    /**\n     * Creates a function that invokes `func` with `partials` prepended to the\n     * arguments it receives. This method is like `_.bind` except it does **not**\n     * alter the `this` binding.\n     *\n     * The `_.partial.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of partially\n     * applied functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.2.0\n     * @category Function\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * function greet(greeting, name) {\n     *   return greeting + ' ' + name;\n     * }\n     *\n     * var sayHelloTo = _.partial(greet, 'hello');\n     * sayHelloTo('fred');\n     * // => 'hello fred'\n     *\n     * // Partially applied with placeholders.\n     * var greetFred = _.partial(greet, _, 'fred');\n     * greetFred('hi');\n     * // => 'hi fred'\n     */\n    var partial = baseRest(function(func, partials) {\n      var holders = replaceHolders(partials, getHolder(partial));\n      return createWrap(func, WRAP_PARTIAL_FLAG, undefined, partials, holders);\n    });\n\n    /**\n     * This method is like `_.partial` except that partially applied arguments\n     * are appended to the arguments it receives.\n     *\n     * The `_.partialRight.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of partially\n     * applied functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Function\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * function greet(greeting, name) {\n     *   return greeting + ' ' + name;\n     * }\n     *\n     * var greetFred = _.partialRight(greet, 'fred');\n     * greetFred('hi');\n     * // => 'hi fred'\n     *\n     * // Partially applied with placeholders.\n     * var sayHelloTo = _.partialRight(greet, 'hello', _);\n     * sayHelloTo('fred');\n     * // => 'hello fred'\n     */\n    var partialRight = baseRest(function(func, partials) {\n      var holders = replaceHolders(partials, getHolder(partialRight));\n      return createWrap(func, WRAP_PARTIAL_RIGHT_FLAG, undefined, partials, holders);\n    });\n\n    /**\n     * Creates a function that invokes `func` with arguments arranged according\n     * to the specified `indexes` where the argument value at the first index is\n     * provided as the first argument, the argument value at the second index is\n     * provided as the second argument, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to rearrange arguments for.\n     * @param {...(number|number[])} indexes The arranged argument indexes.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var rearged = _.rearg(function(a, b, c) {\n     *   return [a, b, c];\n     * }, [2, 0, 1]);\n     *\n     * rearged('b', 'c', 'a')\n     * // => ['a', 'b', 'c']\n     */\n    var rearg = flatRest(function(func, indexes) {\n      return createWrap(func, WRAP_REARG_FLAG, undefined, undefined, undefined, indexes);\n    });\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of the\n     * created function and arguments from `start` and beyond provided as\n     * an array.\n     *\n     * **Note:** This method is based on the\n     * [rest parameter](https://mdn.io/rest_parameters).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var say = _.rest(function(what, names) {\n     *   return what + ' ' + _.initial(names).join(', ') +\n     *     (_.size(names) > 1 ? ', & ' : '') + _.last(names);\n     * });\n     *\n     * say('hello', 'fred', 'barney', 'pebbles');\n     * // => 'hello fred, barney, & pebbles'\n     */\n    function rest(func, start) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      start = start === undefined ? start : toInteger(start);\n      return baseRest(func, start);\n    }\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of the\n     * create function and an array of arguments much like\n     * [`Function#apply`](http://www.ecma-international.org/ecma-262/7.0/#sec-function.prototype.apply).\n     *\n     * **Note:** This method is based on the\n     * [spread operator](https://mdn.io/spread_operator).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Function\n     * @param {Function} func The function to spread arguments over.\n     * @param {number} [start=0] The start position of the spread.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var say = _.spread(function(who, what) {\n     *   return who + ' says ' + what;\n     * });\n     *\n     * say(['fred', 'hello']);\n     * // => 'fred says hello'\n     *\n     * var numbers = Promise.all([\n     *   Promise.resolve(40),\n     *   Promise.resolve(36)\n     * ]);\n     *\n     * numbers.then(_.spread(function(x, y) {\n     *   return x + y;\n     * }));\n     * // => a Promise of 76\n     */\n    function spread(func, start) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      start = start == null ? 0 : nativeMax(toInteger(start), 0);\n      return baseRest(function(args) {\n        var array = args[start],\n            otherArgs = castSlice(args, 0, start);\n\n        if (array) {\n          arrayPush(otherArgs, array);\n        }\n        return apply(func, this, otherArgs);\n      });\n    }\n\n    /**\n     * Creates a throttled function that only invokes `func` at most once per\n     * every `wait` milliseconds. The throttled function comes with a `cancel`\n     * method to cancel delayed `func` invocations and a `flush` method to\n     * immediately invoke them. Provide `options` to indicate whether `func`\n     * should be invoked on the leading and/or trailing edge of the `wait`\n     * timeout. The `func` is invoked with the last arguments provided to the\n     * throttled function. Subsequent calls to the throttled function return the\n     * result of the last `func` invocation.\n     *\n     * **Note:** If `leading` and `trailing` options are `true`, `func` is\n     * invoked on the trailing edge of the timeout only if the throttled function\n     * is invoked more than once during the `wait` timeout.\n     *\n     * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n     * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n     *\n     * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n     * for details over the differences between `_.throttle` and `_.debounce`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to throttle.\n     * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.leading=true]\n     *  Specify invoking on the leading edge of the timeout.\n     * @param {boolean} [options.trailing=true]\n     *  Specify invoking on the trailing edge of the timeout.\n     * @returns {Function} Returns the new throttled function.\n     * @example\n     *\n     * // Avoid excessively updating the position while scrolling.\n     * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n     *\n     * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n     * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n     * jQuery(element).on('click', throttled);\n     *\n     * // Cancel the trailing throttled invocation.\n     * jQuery(window).on('popstate', throttled.cancel);\n     */\n    function throttle(func, wait, options) {\n      var leading = true,\n          trailing = true;\n\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      if (isObject(options)) {\n        leading = 'leading' in options ? !!options.leading : leading;\n        trailing = 'trailing' in options ? !!options.trailing : trailing;\n      }\n      return debounce(func, wait, {\n        'leading': leading,\n        'maxWait': wait,\n        'trailing': trailing\n      });\n    }\n\n    /**\n     * Creates a function that accepts up to one argument, ignoring any\n     * additional arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to cap arguments for.\n     * @returns {Function} Returns the new capped function.\n     * @example\n     *\n     * _.map(['6', '8', '10'], _.unary(parseInt));\n     * // => [6, 8, 10]\n     */\n    function unary(func) {\n      return ary(func, 1);\n    }\n\n    /**\n     * Creates a function that provides `value` to `wrapper` as its first\n     * argument. Any additional arguments provided to the function are appended\n     * to those provided to the `wrapper`. The wrapper is invoked with the `this`\n     * binding of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {*} value The value to wrap.\n     * @param {Function} [wrapper=identity] The wrapper function.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var p = _.wrap(_.escape, function(func, text) {\n     *   return '<p>' + func(text) + '</p>';\n     * });\n     *\n     * p('fred, barney, & pebbles');\n     * // => '<p>fred, barney, &amp; pebbles</p>'\n     */\n    function wrap(value, wrapper) {\n      return partial(castFunction(wrapper), value);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Casts `value` as an array if it's not one.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.4.0\n     * @category Lang\n     * @param {*} value The value to inspect.\n     * @returns {Array} Returns the cast array.\n     * @example\n     *\n     * _.castArray(1);\n     * // => [1]\n     *\n     * _.castArray({ 'a': 1 });\n     * // => [{ 'a': 1 }]\n     *\n     * _.castArray('abc');\n     * // => ['abc']\n     *\n     * _.castArray(null);\n     * // => [null]\n     *\n     * _.castArray(undefined);\n     * // => [undefined]\n     *\n     * _.castArray();\n     * // => []\n     *\n     * var array = [1, 2, 3];\n     * console.log(_.castArray(array) === array);\n     * // => true\n     */\n    function castArray() {\n      if (!arguments.length) {\n        return [];\n      }\n      var value = arguments[0];\n      return isArray(value) ? value : [value];\n    }\n\n    /**\n     * Creates a shallow clone of `value`.\n     *\n     * **Note:** This method is loosely based on the\n     * [structured clone algorithm](https://mdn.io/Structured_clone_algorithm)\n     * and supports cloning arrays, array buffers, booleans, date objects, maps,\n     * numbers, `Object` objects, regexes, sets, strings, symbols, and typed\n     * arrays. The own enumerable properties of `arguments` objects are cloned\n     * as plain objects. An empty object is returned for uncloneable values such\n     * as error objects, functions, DOM nodes, and WeakMaps.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to clone.\n     * @returns {*} Returns the cloned value.\n     * @see _.cloneDeep\n     * @example\n     *\n     * var objects = [{ 'a': 1 }, { 'b': 2 }];\n     *\n     * var shallow = _.clone(objects);\n     * console.log(shallow[0] === objects[0]);\n     * // => true\n     */\n    function clone(value) {\n      return baseClone(value, CLONE_SYMBOLS_FLAG);\n    }\n\n    /**\n     * This method is like `_.clone` except that it accepts `customizer` which\n     * is invoked to produce the cloned value. If `customizer` returns `undefined`,\n     * cloning is handled by the method instead. The `customizer` is invoked with\n     * up to four arguments; (value [, index|key, object, stack]).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to clone.\n     * @param {Function} [customizer] The function to customize cloning.\n     * @returns {*} Returns the cloned value.\n     * @see _.cloneDeepWith\n     * @example\n     *\n     * function customizer(value) {\n     *   if (_.isElement(value)) {\n     *     return value.cloneNode(false);\n     *   }\n     * }\n     *\n     * var el = _.cloneWith(document.body, customizer);\n     *\n     * console.log(el === document.body);\n     * // => false\n     * console.log(el.nodeName);\n     * // => 'BODY'\n     * console.log(el.childNodes.length);\n     * // => 0\n     */\n    function cloneWith(value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseClone(value, CLONE_SYMBOLS_FLAG, customizer);\n    }\n\n    /**\n     * This method is like `_.clone` except that it recursively clones `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Lang\n     * @param {*} value The value to recursively clone.\n     * @returns {*} Returns the deep cloned value.\n     * @see _.clone\n     * @example\n     *\n     * var objects = [{ 'a': 1 }, { 'b': 2 }];\n     *\n     * var deep = _.cloneDeep(objects);\n     * console.log(deep[0] === objects[0]);\n     * // => false\n     */\n    function cloneDeep(value) {\n      return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n    }\n\n    /**\n     * This method is like `_.cloneWith` except that it recursively clones `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to recursively clone.\n     * @param {Function} [customizer] The function to customize cloning.\n     * @returns {*} Returns the deep cloned value.\n     * @see _.cloneWith\n     * @example\n     *\n     * function customizer(value) {\n     *   if (_.isElement(value)) {\n     *     return value.cloneNode(true);\n     *   }\n     * }\n     *\n     * var el = _.cloneDeepWith(document.body, customizer);\n     *\n     * console.log(el === document.body);\n     * // => false\n     * console.log(el.nodeName);\n     * // => 'BODY'\n     * console.log(el.childNodes.length);\n     * // => 20\n     */\n    function cloneDeepWith(value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG, customizer);\n    }\n\n    /**\n     * Checks if `object` conforms to `source` by invoking the predicate\n     * properties of `source` with the corresponding property values of `object`.\n     *\n     * **Note:** This method is equivalent to `_.conforms` when `source` is\n     * partially applied.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.14.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {boolean} Returns `true` if `object` conforms, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     *\n     * _.conformsTo(object, { 'b': function(n) { return n > 1; } });\n     * // => true\n     *\n     * _.conformsTo(object, { 'b': function(n) { return n > 2; } });\n     * // => false\n     */\n    function conformsTo(object, source) {\n      return source == null || baseConformsTo(object, source, keys(source));\n    }\n\n    /**\n     * Performs a\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * comparison between two values to determine if they are equivalent.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     * var other = { 'a': 1 };\n     *\n     * _.eq(object, object);\n     * // => true\n     *\n     * _.eq(object, other);\n     * // => false\n     *\n     * _.eq('a', 'a');\n     * // => true\n     *\n     * _.eq('a', Object('a'));\n     * // => false\n     *\n     * _.eq(NaN, NaN);\n     * // => true\n     */\n    function eq(value, other) {\n      return value === other || (value !== value && other !== other);\n    }\n\n    /**\n     * Checks if `value` is greater than `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than `other`,\n     *  else `false`.\n     * @see _.lt\n     * @example\n     *\n     * _.gt(3, 1);\n     * // => true\n     *\n     * _.gt(3, 3);\n     * // => false\n     *\n     * _.gt(1, 3);\n     * // => false\n     */\n    var gt = createRelationalOperation(baseGt);\n\n    /**\n     * Checks if `value` is greater than or equal to `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than or equal to\n     *  `other`, else `false`.\n     * @see _.lte\n     * @example\n     *\n     * _.gte(3, 1);\n     * // => true\n     *\n     * _.gte(3, 3);\n     * // => true\n     *\n     * _.gte(1, 3);\n     * // => false\n     */\n    var gte = createRelationalOperation(function(value, other) {\n      return value >= other;\n    });\n\n    /**\n     * Checks if `value` is likely an `arguments` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n     *  else `false`.\n     * @example\n     *\n     * _.isArguments(function() { return arguments; }());\n     * // => true\n     *\n     * _.isArguments([1, 2, 3]);\n     * // => false\n     */\n    var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n      return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n        !propertyIsEnumerable.call(value, 'callee');\n    };\n\n    /**\n     * Checks if `value` is classified as an `Array` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n     * @example\n     *\n     * _.isArray([1, 2, 3]);\n     * // => true\n     *\n     * _.isArray(document.body.children);\n     * // => false\n     *\n     * _.isArray('abc');\n     * // => false\n     *\n     * _.isArray(_.noop);\n     * // => false\n     */\n    var isArray = Array.isArray;\n\n    /**\n     * Checks if `value` is classified as an `ArrayBuffer` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.\n     * @example\n     *\n     * _.isArrayBuffer(new ArrayBuffer(2));\n     * // => true\n     *\n     * _.isArrayBuffer(new Array(2));\n     * // => false\n     */\n    var isArrayBuffer = nodeIsArrayBuffer ? baseUnary(nodeIsArrayBuffer) : baseIsArrayBuffer;\n\n    /**\n     * Checks if `value` is array-like. A value is considered array-like if it's\n     * not a function and has a `value.length` that's an integer greater than or\n     * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n     * @example\n     *\n     * _.isArrayLike([1, 2, 3]);\n     * // => true\n     *\n     * _.isArrayLike(document.body.children);\n     * // => true\n     *\n     * _.isArrayLike('abc');\n     * // => true\n     *\n     * _.isArrayLike(_.noop);\n     * // => false\n     */\n    function isArrayLike(value) {\n      return value != null && isLength(value.length) && !isFunction(value);\n    }\n\n    /**\n     * This method is like `_.isArrayLike` except that it also checks if `value`\n     * is an object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array-like object,\n     *  else `false`.\n     * @example\n     *\n     * _.isArrayLikeObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isArrayLikeObject(document.body.children);\n     * // => true\n     *\n     * _.isArrayLikeObject('abc');\n     * // => false\n     *\n     * _.isArrayLikeObject(_.noop);\n     * // => false\n     */\n    function isArrayLikeObject(value) {\n      return isObjectLike(value) && isArrayLike(value);\n    }\n\n    /**\n     * Checks if `value` is classified as a boolean primitive or object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a boolean, else `false`.\n     * @example\n     *\n     * _.isBoolean(false);\n     * // => true\n     *\n     * _.isBoolean(null);\n     * // => false\n     */\n    function isBoolean(value) {\n      return value === true || value === false ||\n        (isObjectLike(value) && baseGetTag(value) == boolTag);\n    }\n\n    /**\n     * Checks if `value` is a buffer.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n     * @example\n     *\n     * _.isBuffer(new Buffer(2));\n     * // => true\n     *\n     * _.isBuffer(new Uint8Array(2));\n     * // => false\n     */\n    var isBuffer = nativeIsBuffer || stubFalse;\n\n    /**\n     * Checks if `value` is classified as a `Date` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a date object, else `false`.\n     * @example\n     *\n     * _.isDate(new Date);\n     * // => true\n     *\n     * _.isDate('Mon April 23 2012');\n     * // => false\n     */\n    var isDate = nodeIsDate ? baseUnary(nodeIsDate) : baseIsDate;\n\n    /**\n     * Checks if `value` is likely a DOM element.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a DOM element, else `false`.\n     * @example\n     *\n     * _.isElement(document.body);\n     * // => true\n     *\n     * _.isElement('<body>');\n     * // => false\n     */\n    function isElement(value) {\n      return isObjectLike(value) && value.nodeType === 1 && !isPlainObject(value);\n    }\n\n    /**\n     * Checks if `value` is an empty object, collection, map, or set.\n     *\n     * Objects are considered empty if they have no own enumerable string keyed\n     * properties.\n     *\n     * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n     * jQuery-like collections are considered empty if they have a `length` of `0`.\n     * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n     * @example\n     *\n     * _.isEmpty(null);\n     * // => true\n     *\n     * _.isEmpty(true);\n     * // => true\n     *\n     * _.isEmpty(1);\n     * // => true\n     *\n     * _.isEmpty([1, 2, 3]);\n     * // => false\n     *\n     * _.isEmpty({ 'a': 1 });\n     * // => false\n     */\n    function isEmpty(value) {\n      if (value == null) {\n        return true;\n      }\n      if (isArrayLike(value) &&\n          (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n            isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n        return !value.length;\n      }\n      var tag = getTag(value);\n      if (tag == mapTag || tag == setTag) {\n        return !value.size;\n      }\n      if (isPrototype(value)) {\n        return !baseKeys(value).length;\n      }\n      for (var key in value) {\n        if (hasOwnProperty.call(value, key)) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    /**\n     * Performs a deep comparison between two values to determine if they are\n     * equivalent.\n     *\n     * **Note:** This method supports comparing arrays, array buffers, booleans,\n     * date objects, error objects, maps, numbers, `Object` objects, regexes,\n     * sets, strings, symbols, and typed arrays. `Object` objects are compared\n     * by their own, not inherited, enumerable properties. Functions and DOM\n     * nodes are compared by strict equality, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     * var other = { 'a': 1 };\n     *\n     * _.isEqual(object, other);\n     * // => true\n     *\n     * object === other;\n     * // => false\n     */\n    function isEqual(value, other) {\n      return baseIsEqual(value, other);\n    }\n\n    /**\n     * This method is like `_.isEqual` except that it accepts `customizer` which\n     * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n     * are handled by the method instead. The `customizer` is invoked with up to\n     * six arguments: (objValue, othValue [, index|key, object, other, stack]).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * function isGreeting(value) {\n     *   return /^h(?:i|ello)$/.test(value);\n     * }\n     *\n     * function customizer(objValue, othValue) {\n     *   if (isGreeting(objValue) && isGreeting(othValue)) {\n     *     return true;\n     *   }\n     * }\n     *\n     * var array = ['hello', 'goodbye'];\n     * var other = ['hi', 'goodbye'];\n     *\n     * _.isEqualWith(array, other, customizer);\n     * // => true\n     */\n    function isEqualWith(value, other, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      var result = customizer ? customizer(value, other) : undefined;\n      return result === undefined ? baseIsEqual(value, other, undefined, customizer) : !!result;\n    }\n\n    /**\n     * Checks if `value` is an `Error`, `EvalError`, `RangeError`, `ReferenceError`,\n     * `SyntaxError`, `TypeError`, or `URIError` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an error object, else `false`.\n     * @example\n     *\n     * _.isError(new Error);\n     * // => true\n     *\n     * _.isError(Error);\n     * // => false\n     */\n    function isError(value) {\n      if (!isObjectLike(value)) {\n        return false;\n      }\n      var tag = baseGetTag(value);\n      return tag == errorTag || tag == domExcTag ||\n        (typeof value.message == 'string' && typeof value.name == 'string' && !isPlainObject(value));\n    }\n\n    /**\n     * Checks if `value` is a finite primitive number.\n     *\n     * **Note:** This method is based on\n     * [`Number.isFinite`](https://mdn.io/Number/isFinite).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n     * @example\n     *\n     * _.isFinite(3);\n     * // => true\n     *\n     * _.isFinite(Number.MIN_VALUE);\n     * // => true\n     *\n     * _.isFinite(Infinity);\n     * // => false\n     *\n     * _.isFinite('3');\n     * // => false\n     */\n    function isFinite(value) {\n      return typeof value == 'number' && nativeIsFinite(value);\n    }\n\n    /**\n     * Checks if `value` is classified as a `Function` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n     * @example\n     *\n     * _.isFunction(_);\n     * // => true\n     *\n     * _.isFunction(/abc/);\n     * // => false\n     */\n    function isFunction(value) {\n      if (!isObject(value)) {\n        return false;\n      }\n      // The use of `Object#toString` avoids issues with the `typeof` operator\n      // in Safari 9 which returns 'object' for typed arrays and other constructors.\n      var tag = baseGetTag(value);\n      return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n    }\n\n    /**\n     * Checks if `value` is an integer.\n     *\n     * **Note:** This method is based on\n     * [`Number.isInteger`](https://mdn.io/Number/isInteger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an integer, else `false`.\n     * @example\n     *\n     * _.isInteger(3);\n     * // => true\n     *\n     * _.isInteger(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isInteger(Infinity);\n     * // => false\n     *\n     * _.isInteger('3');\n     * // => false\n     */\n    function isInteger(value) {\n      return typeof value == 'number' && value == toInteger(value);\n    }\n\n    /**\n     * Checks if `value` is a valid array-like length.\n     *\n     * **Note:** This method is loosely based on\n     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n     * @example\n     *\n     * _.isLength(3);\n     * // => true\n     *\n     * _.isLength(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isLength(Infinity);\n     * // => false\n     *\n     * _.isLength('3');\n     * // => false\n     */\n    function isLength(value) {\n      return typeof value == 'number' &&\n        value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n    }\n\n    /**\n     * Checks if `value` is the\n     * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n     * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n     * @example\n     *\n     * _.isObject({});\n     * // => true\n     *\n     * _.isObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isObject(_.noop);\n     * // => true\n     *\n     * _.isObject(null);\n     * // => false\n     */\n    function isObject(value) {\n      var type = typeof value;\n      return value != null && (type == 'object' || type == 'function');\n    }\n\n    /**\n     * Checks if `value` is object-like. A value is object-like if it's not `null`\n     * and has a `typeof` result of \"object\".\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n     * @example\n     *\n     * _.isObjectLike({});\n     * // => true\n     *\n     * _.isObjectLike([1, 2, 3]);\n     * // => true\n     *\n     * _.isObjectLike(_.noop);\n     * // => false\n     *\n     * _.isObjectLike(null);\n     * // => false\n     */\n    function isObjectLike(value) {\n      return value != null && typeof value == 'object';\n    }\n\n    /**\n     * Checks if `value` is classified as a `Map` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n     * @example\n     *\n     * _.isMap(new Map);\n     * // => true\n     *\n     * _.isMap(new WeakMap);\n     * // => false\n     */\n    var isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\n    /**\n     * Performs a partial deep comparison between `object` and `source` to\n     * determine if `object` contains equivalent property values.\n     *\n     * **Note:** This method is equivalent to `_.matches` when `source` is\n     * partially applied.\n     *\n     * Partial comparisons will match empty array and empty object `source`\n     * values against any array or object value, respectively. See `_.isEqual`\n     * for a list of supported value comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     *\n     * _.isMatch(object, { 'b': 2 });\n     * // => true\n     *\n     * _.isMatch(object, { 'b': 1 });\n     * // => false\n     */\n    function isMatch(object, source) {\n      return object === source || baseIsMatch(object, source, getMatchData(source));\n    }\n\n    /**\n     * This method is like `_.isMatch` except that it accepts `customizer` which\n     * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n     * are handled by the method instead. The `customizer` is invoked with five\n     * arguments: (objValue, srcValue, index|key, object, source).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     * @example\n     *\n     * function isGreeting(value) {\n     *   return /^h(?:i|ello)$/.test(value);\n     * }\n     *\n     * function customizer(objValue, srcValue) {\n     *   if (isGreeting(objValue) && isGreeting(srcValue)) {\n     *     return true;\n     *   }\n     * }\n     *\n     * var object = { 'greeting': 'hello' };\n     * var source = { 'greeting': 'hi' };\n     *\n     * _.isMatchWith(object, source, customizer);\n     * // => true\n     */\n    function isMatchWith(object, source, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseIsMatch(object, source, getMatchData(source), customizer);\n    }\n\n    /**\n     * Checks if `value` is `NaN`.\n     *\n     * **Note:** This method is based on\n     * [`Number.isNaN`](https://mdn.io/Number/isNaN) and is not the same as\n     * global [`isNaN`](https://mdn.io/isNaN) which returns `true` for\n     * `undefined` and other non-number values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n     * @example\n     *\n     * _.isNaN(NaN);\n     * // => true\n     *\n     * _.isNaN(new Number(NaN));\n     * // => true\n     *\n     * isNaN(undefined);\n     * // => true\n     *\n     * _.isNaN(undefined);\n     * // => false\n     */\n    function isNaN(value) {\n      // An `NaN` primitive is the only value that is not equal to itself.\n      // Perform the `toStringTag` check first to avoid errors with some\n      // ActiveX objects in IE.\n      return isNumber(value) && value != +value;\n    }\n\n    /**\n     * Checks if `value` is a pristine native function.\n     *\n     * **Note:** This method can't reliably detect native functions in the presence\n     * of the core-js package because core-js circumvents this kind of detection.\n     * Despite multiple requests, the core-js maintainer has made it clear: any\n     * attempt to fix the detection will be obstructed. As a result, we're left\n     * with little choice but to throw an error. Unfortunately, this also affects\n     * packages, like [babel-polyfill](https://www.npmjs.com/package/babel-polyfill),\n     * which rely on core-js.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a native function,\n     *  else `false`.\n     * @example\n     *\n     * _.isNative(Array.prototype.push);\n     * // => true\n     *\n     * _.isNative(_);\n     * // => false\n     */\n    function isNative(value) {\n      if (isMaskable(value)) {\n        throw new Error(CORE_ERROR_TEXT);\n      }\n      return baseIsNative(value);\n    }\n\n    /**\n     * Checks if `value` is `null`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `null`, else `false`.\n     * @example\n     *\n     * _.isNull(null);\n     * // => true\n     *\n     * _.isNull(void 0);\n     * // => false\n     */\n    function isNull(value) {\n      return value === null;\n    }\n\n    /**\n     * Checks if `value` is `null` or `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is nullish, else `false`.\n     * @example\n     *\n     * _.isNil(null);\n     * // => true\n     *\n     * _.isNil(void 0);\n     * // => true\n     *\n     * _.isNil(NaN);\n     * // => false\n     */\n    function isNil(value) {\n      return value == null;\n    }\n\n    /**\n     * Checks if `value` is classified as a `Number` primitive or object.\n     *\n     * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n     * classified as numbers, use the `_.isFinite` method.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n     * @example\n     *\n     * _.isNumber(3);\n     * // => true\n     *\n     * _.isNumber(Number.MIN_VALUE);\n     * // => true\n     *\n     * _.isNumber(Infinity);\n     * // => true\n     *\n     * _.isNumber('3');\n     * // => false\n     */\n    function isNumber(value) {\n      return typeof value == 'number' ||\n        (isObjectLike(value) && baseGetTag(value) == numberTag);\n    }\n\n    /**\n     * Checks if `value` is a plain object, that is, an object created by the\n     * `Object` constructor or one with a `[[Prototype]]` of `null`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.8.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * _.isPlainObject(new Foo);\n     * // => false\n     *\n     * _.isPlainObject([1, 2, 3]);\n     * // => false\n     *\n     * _.isPlainObject({ 'x': 0, 'y': 0 });\n     * // => true\n     *\n     * _.isPlainObject(Object.create(null));\n     * // => true\n     */\n    function isPlainObject(value) {\n      if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n        return false;\n      }\n      var proto = getPrototype(value);\n      if (proto === null) {\n        return true;\n      }\n      var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n      return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n        funcToString.call(Ctor) == objectCtorString;\n    }\n\n    /**\n     * Checks if `value` is classified as a `RegExp` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.\n     * @example\n     *\n     * _.isRegExp(/abc/);\n     * // => true\n     *\n     * _.isRegExp('/abc/');\n     * // => false\n     */\n    var isRegExp = nodeIsRegExp ? baseUnary(nodeIsRegExp) : baseIsRegExp;\n\n    /**\n     * Checks if `value` is a safe integer. An integer is safe if it's an IEEE-754\n     * double precision number which isn't the result of a rounded unsafe integer.\n     *\n     * **Note:** This method is based on\n     * [`Number.isSafeInteger`](https://mdn.io/Number/isSafeInteger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a safe integer, else `false`.\n     * @example\n     *\n     * _.isSafeInteger(3);\n     * // => true\n     *\n     * _.isSafeInteger(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isSafeInteger(Infinity);\n     * // => false\n     *\n     * _.isSafeInteger('3');\n     * // => false\n     */\n    function isSafeInteger(value) {\n      return isInteger(value) && value >= -MAX_SAFE_INTEGER && value <= MAX_SAFE_INTEGER;\n    }\n\n    /**\n     * Checks if `value` is classified as a `Set` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n     * @example\n     *\n     * _.isSet(new Set);\n     * // => true\n     *\n     * _.isSet(new WeakSet);\n     * // => false\n     */\n    var isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\n    /**\n     * Checks if `value` is classified as a `String` primitive or object.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n     * @example\n     *\n     * _.isString('abc');\n     * // => true\n     *\n     * _.isString(1);\n     * // => false\n     */\n    function isString(value) {\n      return typeof value == 'string' ||\n        (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n    }\n\n    /**\n     * Checks if `value` is classified as a `Symbol` primitive or object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n     * @example\n     *\n     * _.isSymbol(Symbol.iterator);\n     * // => true\n     *\n     * _.isSymbol('abc');\n     * // => false\n     */\n    function isSymbol(value) {\n      return typeof value == 'symbol' ||\n        (isObjectLike(value) && baseGetTag(value) == symbolTag);\n    }\n\n    /**\n     * Checks if `value` is classified as a typed array.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n     * @example\n     *\n     * _.isTypedArray(new Uint8Array);\n     * // => true\n     *\n     * _.isTypedArray([]);\n     * // => false\n     */\n    var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n    /**\n     * Checks if `value` is `undefined`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n     * @example\n     *\n     * _.isUndefined(void 0);\n     * // => true\n     *\n     * _.isUndefined(null);\n     * // => false\n     */\n    function isUndefined(value) {\n      return value === undefined;\n    }\n\n    /**\n     * Checks if `value` is classified as a `WeakMap` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a weak map, else `false`.\n     * @example\n     *\n     * _.isWeakMap(new WeakMap);\n     * // => true\n     *\n     * _.isWeakMap(new Map);\n     * // => false\n     */\n    function isWeakMap(value) {\n      return isObjectLike(value) && getTag(value) == weakMapTag;\n    }\n\n    /**\n     * Checks if `value` is classified as a `WeakSet` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a weak set, else `false`.\n     * @example\n     *\n     * _.isWeakSet(new WeakSet);\n     * // => true\n     *\n     * _.isWeakSet(new Set);\n     * // => false\n     */\n    function isWeakSet(value) {\n      return isObjectLike(value) && baseGetTag(value) == weakSetTag;\n    }\n\n    /**\n     * Checks if `value` is less than `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than `other`,\n     *  else `false`.\n     * @see _.gt\n     * @example\n     *\n     * _.lt(1, 3);\n     * // => true\n     *\n     * _.lt(3, 3);\n     * // => false\n     *\n     * _.lt(3, 1);\n     * // => false\n     */\n    var lt = createRelationalOperation(baseLt);\n\n    /**\n     * Checks if `value` is less than or equal to `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than or equal to\n     *  `other`, else `false`.\n     * @see _.gte\n     * @example\n     *\n     * _.lte(1, 3);\n     * // => true\n     *\n     * _.lte(3, 3);\n     * // => true\n     *\n     * _.lte(3, 1);\n     * // => false\n     */\n    var lte = createRelationalOperation(function(value, other) {\n      return value <= other;\n    });\n\n    /**\n     * Converts `value` to an array.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {Array} Returns the converted array.\n     * @example\n     *\n     * _.toArray({ 'a': 1, 'b': 2 });\n     * // => [1, 2]\n     *\n     * _.toArray('abc');\n     * // => ['a', 'b', 'c']\n     *\n     * _.toArray(1);\n     * // => []\n     *\n     * _.toArray(null);\n     * // => []\n     */\n    function toArray(value) {\n      if (!value) {\n        return [];\n      }\n      if (isArrayLike(value)) {\n        return isString(value) ? stringToArray(value) : copyArray(value);\n      }\n      if (symIterator && value[symIterator]) {\n        return iteratorToArray(value[symIterator]());\n      }\n      var tag = getTag(value),\n          func = tag == mapTag ? mapToArray : (tag == setTag ? setToArray : values);\n\n      return func(value);\n    }\n\n    /**\n     * Converts `value` to a finite number.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.12.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted number.\n     * @example\n     *\n     * _.toFinite(3.2);\n     * // => 3.2\n     *\n     * _.toFinite(Number.MIN_VALUE);\n     * // => 5e-324\n     *\n     * _.toFinite(Infinity);\n     * // => 1.7976931348623157e+308\n     *\n     * _.toFinite('3.2');\n     * // => 3.2\n     */\n    function toFinite(value) {\n      if (!value) {\n        return value === 0 ? value : 0;\n      }\n      value = toNumber(value);\n      if (value === INFINITY || value === -INFINITY) {\n        var sign = (value < 0 ? -1 : 1);\n        return sign * MAX_INTEGER;\n      }\n      return value === value ? value : 0;\n    }\n\n    /**\n     * Converts `value` to an integer.\n     *\n     * **Note:** This method is loosely based on\n     * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toInteger(3.2);\n     * // => 3\n     *\n     * _.toInteger(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toInteger(Infinity);\n     * // => 1.7976931348623157e+308\n     *\n     * _.toInteger('3.2');\n     * // => 3\n     */\n    function toInteger(value) {\n      var result = toFinite(value),\n          remainder = result % 1;\n\n      return result === result ? (remainder ? result - remainder : result) : 0;\n    }\n\n    /**\n     * Converts `value` to an integer suitable for use as the length of an\n     * array-like object.\n     *\n     * **Note:** This method is based on\n     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toLength(3.2);\n     * // => 3\n     *\n     * _.toLength(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toLength(Infinity);\n     * // => 4294967295\n     *\n     * _.toLength('3.2');\n     * // => 3\n     */\n    function toLength(value) {\n      return value ? baseClamp(toInteger(value), 0, MAX_ARRAY_LENGTH) : 0;\n    }\n\n    /**\n     * Converts `value` to a number.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to process.\n     * @returns {number} Returns the number.\n     * @example\n     *\n     * _.toNumber(3.2);\n     * // => 3.2\n     *\n     * _.toNumber(Number.MIN_VALUE);\n     * // => 5e-324\n     *\n     * _.toNumber(Infinity);\n     * // => Infinity\n     *\n     * _.toNumber('3.2');\n     * // => 3.2\n     */\n    function toNumber(value) {\n      if (typeof value == 'number') {\n        return value;\n      }\n      if (isSymbol(value)) {\n        return NAN;\n      }\n      if (isObject(value)) {\n        var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n        value = isObject(other) ? (other + '') : other;\n      }\n      if (typeof value != 'string') {\n        return value === 0 ? value : +value;\n      }\n      value = baseTrim(value);\n      var isBinary = reIsBinary.test(value);\n      return (isBinary || reIsOctal.test(value))\n        ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n        : (reIsBadHex.test(value) ? NAN : +value);\n    }\n\n    /**\n     * Converts `value` to a plain object flattening inherited enumerable string\n     * keyed properties of `value` to own properties of the plain object.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {Object} Returns the converted plain object.\n     * @example\n     *\n     * function Foo() {\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.assign({ 'a': 1 }, new Foo);\n     * // => { 'a': 1, 'b': 2 }\n     *\n     * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n     * // => { 'a': 1, 'b': 2, 'c': 3 }\n     */\n    function toPlainObject(value) {\n      return copyObject(value, keysIn(value));\n    }\n\n    /**\n     * Converts `value` to a safe integer. A safe integer can be compared and\n     * represented correctly.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toSafeInteger(3.2);\n     * // => 3\n     *\n     * _.toSafeInteger(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toSafeInteger(Infinity);\n     * // => 9007199254740991\n     *\n     * _.toSafeInteger('3.2');\n     * // => 3\n     */\n    function toSafeInteger(value) {\n      return value\n        ? baseClamp(toInteger(value), -MAX_SAFE_INTEGER, MAX_SAFE_INTEGER)\n        : (value === 0 ? value : 0);\n    }\n\n    /**\n     * Converts `value` to a string. An empty string is returned for `null`\n     * and `undefined` values. The sign of `-0` is preserved.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.toString(null);\n     * // => ''\n     *\n     * _.toString(-0);\n     * // => '-0'\n     *\n     * _.toString([1, 2, 3]);\n     * // => '1,2,3'\n     */\n    function toString(value) {\n      return value == null ? '' : baseToString(value);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Assigns own enumerable string keyed properties of source objects to the\n     * destination object. Source objects are applied from left to right.\n     * Subsequent sources overwrite property assignments of previous sources.\n     *\n     * **Note:** This method mutates `object` and is loosely based on\n     * [`Object.assign`](https://mdn.io/Object/assign).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.10.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.assignIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * function Bar() {\n     *   this.c = 3;\n     * }\n     *\n     * Foo.prototype.b = 2;\n     * Bar.prototype.d = 4;\n     *\n     * _.assign({ 'a': 0 }, new Foo, new Bar);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    var assign = createAssigner(function(object, source) {\n      if (isPrototype(source) || isArrayLike(source)) {\n        copyObject(source, keys(source), object);\n        return;\n      }\n      for (var key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          assignValue(object, key, source[key]);\n        }\n      }\n    });\n\n    /**\n     * This method is like `_.assign` except that it iterates over own and\n     * inherited source properties.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias extend\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.assign\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * function Bar() {\n     *   this.c = 3;\n     * }\n     *\n     * Foo.prototype.b = 2;\n     * Bar.prototype.d = 4;\n     *\n     * _.assignIn({ 'a': 0 }, new Foo, new Bar);\n     * // => { 'a': 1, 'b': 2, 'c': 3, 'd': 4 }\n     */\n    var assignIn = createAssigner(function(object, source) {\n      copyObject(source, keysIn(source), object);\n    });\n\n    /**\n     * This method is like `_.assignIn` except that it accepts `customizer`\n     * which is invoked to produce the assigned values. If `customizer` returns\n     * `undefined`, assignment is handled by the method instead. The `customizer`\n     * is invoked with five arguments: (objValue, srcValue, key, object, source).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias extendWith\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @see _.assignWith\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   return _.isUndefined(objValue) ? srcValue : objValue;\n     * }\n     *\n     * var defaults = _.partialRight(_.assignInWith, customizer);\n     *\n     * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var assignInWith = createAssigner(function(object, source, srcIndex, customizer) {\n      copyObject(source, keysIn(source), object, customizer);\n    });\n\n    /**\n     * This method is like `_.assign` except that it accepts `customizer`\n     * which is invoked to produce the assigned values. If `customizer` returns\n     * `undefined`, assignment is handled by the method instead. The `customizer`\n     * is invoked with five arguments: (objValue, srcValue, key, object, source).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @see _.assignInWith\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   return _.isUndefined(objValue) ? srcValue : objValue;\n     * }\n     *\n     * var defaults = _.partialRight(_.assignWith, customizer);\n     *\n     * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var assignWith = createAssigner(function(object, source, srcIndex, customizer) {\n      copyObject(source, keys(source), object, customizer);\n    });\n\n    /**\n     * Creates an array of values corresponding to `paths` of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Array} Returns the picked values.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };\n     *\n     * _.at(object, ['a[0].b.c', 'a[1]']);\n     * // => [3, 4]\n     */\n    var at = flatRest(baseAt);\n\n    /**\n     * Creates an object that inherits from the `prototype` object. If a\n     * `properties` object is given, its own enumerable string keyed properties\n     * are assigned to the created object.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.3.0\n     * @category Object\n     * @param {Object} prototype The object to inherit from.\n     * @param {Object} [properties] The properties to assign to the object.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * function Circle() {\n     *   Shape.call(this);\n     * }\n     *\n     * Circle.prototype = _.create(Shape.prototype, {\n     *   'constructor': Circle\n     * });\n     *\n     * var circle = new Circle;\n     * circle instanceof Circle;\n     * // => true\n     *\n     * circle instanceof Shape;\n     * // => true\n     */\n    function create(prototype, properties) {\n      var result = baseCreate(prototype);\n      return properties == null ? result : baseAssign(result, properties);\n    }\n\n    /**\n     * Assigns own and inherited enumerable string keyed properties of source\n     * objects to the destination object for all destination properties that\n     * resolve to `undefined`. Source objects are applied from left to right.\n     * Once a property is set, additional values of the same property are ignored.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.defaultsDeep\n     * @example\n     *\n     * _.defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var defaults = baseRest(function(object, sources) {\n      object = Object(object);\n\n      var index = -1;\n      var length = sources.length;\n      var guard = length > 2 ? sources[2] : undefined;\n\n      if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n        length = 1;\n      }\n\n      while (++index < length) {\n        var source = sources[index];\n        var props = keysIn(source);\n        var propsIndex = -1;\n        var propsLength = props.length;\n\n        while (++propsIndex < propsLength) {\n          var key = props[propsIndex];\n          var value = object[key];\n\n          if (value === undefined ||\n              (eq(value, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n            object[key] = source[key];\n          }\n        }\n      }\n\n      return object;\n    });\n\n    /**\n     * This method is like `_.defaults` except that it recursively assigns\n     * default properties.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.defaults\n     * @example\n     *\n     * _.defaultsDeep({ 'a': { 'b': 2 } }, { 'a': { 'b': 1, 'c': 3 } });\n     * // => { 'a': { 'b': 2, 'c': 3 } }\n     */\n    var defaultsDeep = baseRest(function(args) {\n      args.push(undefined, customDefaultsMerge);\n      return apply(mergeWith, undefined, args);\n    });\n\n    /**\n     * This method is like `_.find` except that it returns the key of the first\n     * element `predicate` returns truthy for instead of the element itself.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {string|undefined} Returns the key of the matched element,\n     *  else `undefined`.\n     * @example\n     *\n     * var users = {\n     *   'barney':  { 'age': 36, 'active': true },\n     *   'fred':    { 'age': 40, 'active': false },\n     *   'pebbles': { 'age': 1,  'active': true }\n     * };\n     *\n     * _.findKey(users, function(o) { return o.age < 40; });\n     * // => 'barney' (iteration order is not guaranteed)\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findKey(users, { 'age': 1, 'active': true });\n     * // => 'pebbles'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findKey(users, ['active', false]);\n     * // => 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findKey(users, 'active');\n     * // => 'barney'\n     */\n    function findKey(object, predicate) {\n      return baseFindKey(object, getIteratee(predicate, 3), baseForOwn);\n    }\n\n    /**\n     * This method is like `_.findKey` except that it iterates over elements of\n     * a collection in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {string|undefined} Returns the key of the matched element,\n     *  else `undefined`.\n     * @example\n     *\n     * var users = {\n     *   'barney':  { 'age': 36, 'active': true },\n     *   'fred':    { 'age': 40, 'active': false },\n     *   'pebbles': { 'age': 1,  'active': true }\n     * };\n     *\n     * _.findLastKey(users, function(o) { return o.age < 40; });\n     * // => returns 'pebbles' assuming `_.findKey` returns 'barney'\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findLastKey(users, { 'age': 36, 'active': true });\n     * // => 'barney'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findLastKey(users, ['active', false]);\n     * // => 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findLastKey(users, 'active');\n     * // => 'pebbles'\n     */\n    function findLastKey(object, predicate) {\n      return baseFindKey(object, getIteratee(predicate, 3), baseForOwnRight);\n    }\n\n    /**\n     * Iterates over own and inherited enumerable string keyed properties of an\n     * object and invokes `iteratee` for each property. The iteratee is invoked\n     * with three arguments: (value, key, object). Iteratee functions may exit\n     * iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forInRight\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forIn(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a', 'b', then 'c' (iteration order is not guaranteed).\n     */\n    function forIn(object, iteratee) {\n      return object == null\n        ? object\n        : baseFor(object, getIteratee(iteratee, 3), keysIn);\n    }\n\n    /**\n     * This method is like `_.forIn` except that it iterates over properties of\n     * `object` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forInRight(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'c', 'b', then 'a' assuming `_.forIn` logs 'a', 'b', then 'c'.\n     */\n    function forInRight(object, iteratee) {\n      return object == null\n        ? object\n        : baseForRight(object, getIteratee(iteratee, 3), keysIn);\n    }\n\n    /**\n     * Iterates over own enumerable string keyed properties of an object and\n     * invokes `iteratee` for each property. The iteratee is invoked with three\n     * arguments: (value, key, object). Iteratee functions may exit iteration\n     * early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forOwnRight\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forOwn(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n     */\n    function forOwn(object, iteratee) {\n      return object && baseForOwn(object, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.forOwn` except that it iterates over properties of\n     * `object` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forOwn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forOwnRight(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'b' then 'a' assuming `_.forOwn` logs 'a' then 'b'.\n     */\n    function forOwnRight(object, iteratee) {\n      return object && baseForOwnRight(object, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * Creates an array of function property names from own enumerable properties\n     * of `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns the function names.\n     * @see _.functionsIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = _.constant('a');\n     *   this.b = _.constant('b');\n     * }\n     *\n     * Foo.prototype.c = _.constant('c');\n     *\n     * _.functions(new Foo);\n     * // => ['a', 'b']\n     */\n    function functions(object) {\n      return object == null ? [] : baseFunctions(object, keys(object));\n    }\n\n    /**\n     * Creates an array of function property names from own and inherited\n     * enumerable properties of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns the function names.\n     * @see _.functions\n     * @example\n     *\n     * function Foo() {\n     *   this.a = _.constant('a');\n     *   this.b = _.constant('b');\n     * }\n     *\n     * Foo.prototype.c = _.constant('c');\n     *\n     * _.functionsIn(new Foo);\n     * // => ['a', 'b', 'c']\n     */\n    function functionsIn(object) {\n      return object == null ? [] : baseFunctions(object, keysIn(object));\n    }\n\n    /**\n     * Gets the value at `path` of `object`. If the resolved value is\n     * `undefined`, the `defaultValue` is returned in its place.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to get.\n     * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.get(object, 'a[0].b.c');\n     * // => 3\n     *\n     * _.get(object, ['a', '0', 'b', 'c']);\n     * // => 3\n     *\n     * _.get(object, 'a.b.c', 'default');\n     * // => 'default'\n     */\n    function get(object, path, defaultValue) {\n      var result = object == null ? undefined : baseGet(object, path);\n      return result === undefined ? defaultValue : result;\n    }\n\n    /**\n     * Checks if `path` is a direct property of `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     * @example\n     *\n     * var object = { 'a': { 'b': 2 } };\n     * var other = _.create({ 'a': _.create({ 'b': 2 }) });\n     *\n     * _.has(object, 'a');\n     * // => true\n     *\n     * _.has(object, 'a.b');\n     * // => true\n     *\n     * _.has(object, ['a', 'b']);\n     * // => true\n     *\n     * _.has(other, 'a');\n     * // => false\n     */\n    function has(object, path) {\n      return object != null && hasPath(object, path, baseHas);\n    }\n\n    /**\n     * Checks if `path` is a direct or inherited property of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     * @example\n     *\n     * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n     *\n     * _.hasIn(object, 'a');\n     * // => true\n     *\n     * _.hasIn(object, 'a.b');\n     * // => true\n     *\n     * _.hasIn(object, ['a', 'b']);\n     * // => true\n     *\n     * _.hasIn(object, 'b');\n     * // => false\n     */\n    function hasIn(object, path) {\n      return object != null && hasPath(object, path, baseHasIn);\n    }\n\n    /**\n     * Creates an object composed of the inverted keys and values of `object`.\n     * If `object` contains duplicate values, subsequent values overwrite\n     * property assignments of previous values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.7.0\n     * @category Object\n     * @param {Object} object The object to invert.\n     * @returns {Object} Returns the new inverted object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2, 'c': 1 };\n     *\n     * _.invert(object);\n     * // => { '1': 'c', '2': 'b' }\n     */\n    var invert = createInverter(function(result, value, key) {\n      if (value != null &&\n          typeof value.toString != 'function') {\n        value = nativeObjectToString.call(value);\n      }\n\n      result[value] = key;\n    }, constant(identity));\n\n    /**\n     * This method is like `_.invert` except that the inverted object is generated\n     * from the results of running each element of `object` thru `iteratee`. The\n     * corresponding inverted value of each inverted key is an array of keys\n     * responsible for generating the inverted value. The iteratee is invoked\n     * with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.1.0\n     * @category Object\n     * @param {Object} object The object to invert.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Object} Returns the new inverted object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2, 'c': 1 };\n     *\n     * _.invertBy(object);\n     * // => { '1': ['a', 'c'], '2': ['b'] }\n     *\n     * _.invertBy(object, function(value) {\n     *   return 'group' + value;\n     * });\n     * // => { 'group1': ['a', 'c'], 'group2': ['b'] }\n     */\n    var invertBy = createInverter(function(result, value, key) {\n      if (value != null &&\n          typeof value.toString != 'function') {\n        value = nativeObjectToString.call(value);\n      }\n\n      if (hasOwnProperty.call(result, value)) {\n        result[value].push(key);\n      } else {\n        result[value] = [key];\n      }\n    }, getIteratee);\n\n    /**\n     * Invokes the method at `path` of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {*} Returns the result of the invoked method.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': [1, 2, 3, 4] } }] };\n     *\n     * _.invoke(object, 'a[0].b.c.slice', 1, 3);\n     * // => [2, 3]\n     */\n    var invoke = baseRest(baseInvoke);\n\n    /**\n     * Creates an array of the own enumerable property names of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects. See the\n     * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n     * for more details.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.keys(new Foo);\n     * // => ['a', 'b'] (iteration order is not guaranteed)\n     *\n     * _.keys('hi');\n     * // => ['0', '1']\n     */\n    function keys(object) {\n      return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n    }\n\n    /**\n     * Creates an array of the own and inherited enumerable property names of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.keysIn(new Foo);\n     * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n     */\n    function keysIn(object) {\n      return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n    }\n\n    /**\n     * The opposite of `_.mapValues`; this method creates an object with the\n     * same values as `object` and keys generated by running each own enumerable\n     * string keyed property of `object` thru `iteratee`. The iteratee is invoked\n     * with three arguments: (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns the new mapped object.\n     * @see _.mapValues\n     * @example\n     *\n     * _.mapKeys({ 'a': 1, 'b': 2 }, function(value, key) {\n     *   return key + value;\n     * });\n     * // => { 'a1': 1, 'b2': 2 }\n     */\n    function mapKeys(object, iteratee) {\n      var result = {};\n      iteratee = getIteratee(iteratee, 3);\n\n      baseForOwn(object, function(value, key, object) {\n        baseAssignValue(result, iteratee(value, key, object), value);\n      });\n      return result;\n    }\n\n    /**\n     * Creates an object with the same keys as `object` and values generated\n     * by running each own enumerable string keyed property of `object` thru\n     * `iteratee`. The iteratee is invoked with three arguments:\n     * (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns the new mapped object.\n     * @see _.mapKeys\n     * @example\n     *\n     * var users = {\n     *   'fred':    { 'user': 'fred',    'age': 40 },\n     *   'pebbles': { 'user': 'pebbles', 'age': 1 }\n     * };\n     *\n     * _.mapValues(users, function(o) { return o.age; });\n     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.mapValues(users, 'age');\n     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n     */\n    function mapValues(object, iteratee) {\n      var result = {};\n      iteratee = getIteratee(iteratee, 3);\n\n      baseForOwn(object, function(value, key, object) {\n        baseAssignValue(result, key, iteratee(value, key, object));\n      });\n      return result;\n    }\n\n    /**\n     * This method is like `_.assign` except that it recursively merges own and\n     * inherited enumerable string keyed properties of source objects into the\n     * destination object. Source properties that resolve to `undefined` are\n     * skipped if a destination value exists. Array and plain object properties\n     * are merged recursively. Other objects and value types are overridden by\n     * assignment. Source objects are applied from left to right. Subsequent\n     * sources overwrite property assignments of previous sources.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {\n     *   'a': [{ 'b': 2 }, { 'd': 4 }]\n     * };\n     *\n     * var other = {\n     *   'a': [{ 'c': 3 }, { 'e': 5 }]\n     * };\n     *\n     * _.merge(object, other);\n     * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n     */\n    var merge = createAssigner(function(object, source, srcIndex) {\n      baseMerge(object, source, srcIndex);\n    });\n\n    /**\n     * This method is like `_.merge` except that it accepts `customizer` which\n     * is invoked to produce the merged values of the destination and source\n     * properties. If `customizer` returns `undefined`, merging is handled by the\n     * method instead. The `customizer` is invoked with six arguments:\n     * (objValue, srcValue, key, object, source, stack).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} customizer The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   if (_.isArray(objValue)) {\n     *     return objValue.concat(srcValue);\n     *   }\n     * }\n     *\n     * var object = { 'a': [1], 'b': [2] };\n     * var other = { 'a': [3], 'b': [4] };\n     *\n     * _.mergeWith(object, other, customizer);\n     * // => { 'a': [1, 3], 'b': [2, 4] }\n     */\n    var mergeWith = createAssigner(function(object, source, srcIndex, customizer) {\n      baseMerge(object, source, srcIndex, customizer);\n    });\n\n    /**\n     * The opposite of `_.pick`; this method creates an object composed of the\n     * own and inherited enumerable property paths of `object` that are not omitted.\n     *\n     * **Note:** This method is considerably slower than `_.pick`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {...(string|string[])} [paths] The property paths to omit.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.omit(object, ['a', 'c']);\n     * // => { 'b': '2' }\n     */\n    var omit = flatRest(function(object, paths) {\n      var result = {};\n      if (object == null) {\n        return result;\n      }\n      var isDeep = false;\n      paths = arrayMap(paths, function(path) {\n        path = castPath(path, object);\n        isDeep || (isDeep = path.length > 1);\n        return path;\n      });\n      copyObject(object, getAllKeysIn(object), result);\n      if (isDeep) {\n        result = baseClone(result, CLONE_DEEP_FLAG | CLONE_FLAT_FLAG | CLONE_SYMBOLS_FLAG, customOmitClone);\n      }\n      var length = paths.length;\n      while (length--) {\n        baseUnset(result, paths[length]);\n      }\n      return result;\n    });\n\n    /**\n     * The opposite of `_.pickBy`; this method creates an object composed of\n     * the own and inherited enumerable string keyed properties of `object` that\n     * `predicate` doesn't return truthy for. The predicate is invoked with two\n     * arguments: (value, key).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {Function} [predicate=_.identity] The function invoked per property.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.omitBy(object, _.isNumber);\n     * // => { 'b': '2' }\n     */\n    function omitBy(object, predicate) {\n      return pickBy(object, negate(getIteratee(predicate)));\n    }\n\n    /**\n     * Creates an object composed of the picked `object` properties.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.pick(object, ['a', 'c']);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    var pick = flatRest(function(object, paths) {\n      return object == null ? {} : basePick(object, paths);\n    });\n\n    /**\n     * Creates an object composed of the `object` properties `predicate` returns\n     * truthy for. The predicate is invoked with two arguments: (value, key).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {Function} [predicate=_.identity] The function invoked per property.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.pickBy(object, _.isNumber);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    function pickBy(object, predicate) {\n      if (object == null) {\n        return {};\n      }\n      var props = arrayMap(getAllKeysIn(object), function(prop) {\n        return [prop];\n      });\n      predicate = getIteratee(predicate);\n      return basePickBy(object, props, function(value, path) {\n        return predicate(value, path[0]);\n      });\n    }\n\n    /**\n     * This method is like `_.get` except that if the resolved value is a\n     * function it's invoked with the `this` binding of its parent object and\n     * its result is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to resolve.\n     * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c1': 3, 'c2': _.constant(4) } }] };\n     *\n     * _.result(object, 'a[0].b.c1');\n     * // => 3\n     *\n     * _.result(object, 'a[0].b.c2');\n     * // => 4\n     *\n     * _.result(object, 'a[0].b.c3', 'default');\n     * // => 'default'\n     *\n     * _.result(object, 'a[0].b.c3', _.constant('default'));\n     * // => 'default'\n     */\n    function result(object, path, defaultValue) {\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length;\n\n      // Ensure the loop is entered when path is empty.\n      if (!length) {\n        length = 1;\n        object = undefined;\n      }\n      while (++index < length) {\n        var value = object == null ? undefined : object[toKey(path[index])];\n        if (value === undefined) {\n          index = length;\n          value = defaultValue;\n        }\n        object = isFunction(value) ? value.call(object) : value;\n      }\n      return object;\n    }\n\n    /**\n     * Sets the value at `path` of `object`. If a portion of `path` doesn't exist,\n     * it's created. Arrays are created for missing index properties while objects\n     * are created for all other missing properties. Use `_.setWith` to customize\n     * `path` creation.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.set(object, 'a[0].b.c', 4);\n     * console.log(object.a[0].b.c);\n     * // => 4\n     *\n     * _.set(object, ['x', '0', 'y', 'z'], 5);\n     * console.log(object.x[0].y.z);\n     * // => 5\n     */\n    function set(object, path, value) {\n      return object == null ? object : baseSet(object, path, value);\n    }\n\n    /**\n     * This method is like `_.set` except that it accepts `customizer` which is\n     * invoked to produce the objects of `path`.  If `customizer` returns `undefined`\n     * path creation is handled by the method instead. The `customizer` is invoked\n     * with three arguments: (nsValue, key, nsObject).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {};\n     *\n     * _.setWith(object, '[0][1]', 'a', Object);\n     * // => { '0': { '1': 'a' } }\n     */\n    function setWith(object, path, value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return object == null ? object : baseSet(object, path, value, customizer);\n    }\n\n    /**\n     * Creates an array of own enumerable string keyed-value pairs for `object`\n     * which can be consumed by `_.fromPairs`. If `object` is a map or set, its\n     * entries are returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias entries\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the key-value pairs.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.toPairs(new Foo);\n     * // => [['a', 1], ['b', 2]] (iteration order is not guaranteed)\n     */\n    var toPairs = createToPairs(keys);\n\n    /**\n     * Creates an array of own and inherited enumerable string keyed-value pairs\n     * for `object` which can be consumed by `_.fromPairs`. If `object` is a map\n     * or set, its entries are returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias entriesIn\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the key-value pairs.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.toPairsIn(new Foo);\n     * // => [['a', 1], ['b', 2], ['c', 3]] (iteration order is not guaranteed)\n     */\n    var toPairsIn = createToPairs(keysIn);\n\n    /**\n     * An alternative to `_.reduce`; this method transforms `object` to a new\n     * `accumulator` object which is the result of running each of its own\n     * enumerable string keyed properties thru `iteratee`, with each invocation\n     * potentially mutating the `accumulator` object. If `accumulator` is not\n     * provided, a new object with the same `[[Prototype]]` will be used. The\n     * iteratee is invoked with four arguments: (accumulator, value, key, object).\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The custom accumulator value.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * _.transform([2, 3, 4], function(result, n) {\n     *   result.push(n *= n);\n     *   return n % 2 == 0;\n     * }, []);\n     * // => [4, 9]\n     *\n     * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n     *   (result[value] || (result[value] = [])).push(key);\n     * }, {});\n     * // => { '1': ['a', 'c'], '2': ['b'] }\n     */\n    function transform(object, iteratee, accumulator) {\n      var isArr = isArray(object),\n          isArrLike = isArr || isBuffer(object) || isTypedArray(object);\n\n      iteratee = getIteratee(iteratee, 4);\n      if (accumulator == null) {\n        var Ctor = object && object.constructor;\n        if (isArrLike) {\n          accumulator = isArr ? new Ctor : [];\n        }\n        else if (isObject(object)) {\n          accumulator = isFunction(Ctor) ? baseCreate(getPrototype(object)) : {};\n        }\n        else {\n          accumulator = {};\n        }\n      }\n      (isArrLike ? arrayEach : baseForOwn)(object, function(value, index, object) {\n        return iteratee(accumulator, value, index, object);\n      });\n      return accumulator;\n    }\n\n    /**\n     * Removes the property at `path` of `object`.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to unset.\n     * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 7 } }] };\n     * _.unset(object, 'a[0].b.c');\n     * // => true\n     *\n     * console.log(object);\n     * // => { 'a': [{ 'b': {} }] };\n     *\n     * _.unset(object, ['a', '0', 'b', 'c']);\n     * // => true\n     *\n     * console.log(object);\n     * // => { 'a': [{ 'b': {} }] };\n     */\n    function unset(object, path) {\n      return object == null ? true : baseUnset(object, path);\n    }\n\n    /**\n     * This method is like `_.set` except that accepts `updater` to produce the\n     * value to set. Use `_.updateWith` to customize `path` creation. The `updater`\n     * is invoked with one argument: (value).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {Function} updater The function to produce the updated value.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.update(object, 'a[0].b.c', function(n) { return n * n; });\n     * console.log(object.a[0].b.c);\n     * // => 9\n     *\n     * _.update(object, 'x[0].y.z', function(n) { return n ? n + 1 : 0; });\n     * console.log(object.x[0].y.z);\n     * // => 0\n     */\n    function update(object, path, updater) {\n      return object == null ? object : baseUpdate(object, path, castFunction(updater));\n    }\n\n    /**\n     * This method is like `_.update` except that it accepts `customizer` which is\n     * invoked to produce the objects of `path`.  If `customizer` returns `undefined`\n     * path creation is handled by the method instead. The `customizer` is invoked\n     * with three arguments: (nsValue, key, nsObject).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {Function} updater The function to produce the updated value.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {};\n     *\n     * _.updateWith(object, '[0][1]', _.constant('a'), Object);\n     * // => { '0': { '1': 'a' } }\n     */\n    function updateWith(object, path, updater, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return object == null ? object : baseUpdate(object, path, castFunction(updater), customizer);\n    }\n\n    /**\n     * Creates an array of the own enumerable string keyed property values of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property values.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.values(new Foo);\n     * // => [1, 2] (iteration order is not guaranteed)\n     *\n     * _.values('hi');\n     * // => ['h', 'i']\n     */\n    function values(object) {\n      return object == null ? [] : baseValues(object, keys(object));\n    }\n\n    /**\n     * Creates an array of the own and inherited enumerable string keyed property\n     * values of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property values.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.valuesIn(new Foo);\n     * // => [1, 2, 3] (iteration order is not guaranteed)\n     */\n    function valuesIn(object) {\n      return object == null ? [] : baseValues(object, keysIn(object));\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Clamps `number` within the inclusive `lower` and `upper` bounds.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Number\n     * @param {number} number The number to clamp.\n     * @param {number} [lower] The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the clamped number.\n     * @example\n     *\n     * _.clamp(-10, -5, 5);\n     * // => -5\n     *\n     * _.clamp(10, -5, 5);\n     * // => 5\n     */\n    function clamp(number, lower, upper) {\n      if (upper === undefined) {\n        upper = lower;\n        lower = undefined;\n      }\n      if (upper !== undefined) {\n        upper = toNumber(upper);\n        upper = upper === upper ? upper : 0;\n      }\n      if (lower !== undefined) {\n        lower = toNumber(lower);\n        lower = lower === lower ? lower : 0;\n      }\n      return baseClamp(toNumber(number), lower, upper);\n    }\n\n    /**\n     * Checks if `n` is between `start` and up to, but not including, `end`. If\n     * `end` is not specified, it's set to `start` with `start` then set to `0`.\n     * If `start` is greater than `end` the params are swapped to support\n     * negative ranges.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.3.0\n     * @category Number\n     * @param {number} number The number to check.\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n     * @see _.range, _.rangeRight\n     * @example\n     *\n     * _.inRange(3, 2, 4);\n     * // => true\n     *\n     * _.inRange(4, 8);\n     * // => true\n     *\n     * _.inRange(4, 2);\n     * // => false\n     *\n     * _.inRange(2, 2);\n     * // => false\n     *\n     * _.inRange(1.2, 2);\n     * // => true\n     *\n     * _.inRange(5.2, 4);\n     * // => false\n     *\n     * _.inRange(-3, -2, -6);\n     * // => true\n     */\n    function inRange(number, start, end) {\n      start = toFinite(start);\n      if (end === undefined) {\n        end = start;\n        start = 0;\n      } else {\n        end = toFinite(end);\n      }\n      number = toNumber(number);\n      return baseInRange(number, start, end);\n    }\n\n    /**\n     * Produces a random number between the inclusive `lower` and `upper` bounds.\n     * If only one argument is provided a number between `0` and the given number\n     * is returned. If `floating` is `true`, or either `lower` or `upper` are\n     * floats, a floating-point number is returned instead of an integer.\n     *\n     * **Note:** JavaScript follows the IEEE-754 standard for resolving\n     * floating-point values which can produce unexpected results.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.7.0\n     * @category Number\n     * @param {number} [lower=0] The lower bound.\n     * @param {number} [upper=1] The upper bound.\n     * @param {boolean} [floating] Specify returning a floating-point number.\n     * @returns {number} Returns the random number.\n     * @example\n     *\n     * _.random(0, 5);\n     * // => an integer between 0 and 5\n     *\n     * _.random(5);\n     * // => also an integer between 0 and 5\n     *\n     * _.random(5, true);\n     * // => a floating-point number between 0 and 5\n     *\n     * _.random(1.2, 5.2);\n     * // => a floating-point number between 1.2 and 5.2\n     */\n    function random(lower, upper, floating) {\n      if (floating && typeof floating != 'boolean' && isIterateeCall(lower, upper, floating)) {\n        upper = floating = undefined;\n      }\n      if (floating === undefined) {\n        if (typeof upper == 'boolean') {\n          floating = upper;\n          upper = undefined;\n        }\n        else if (typeof lower == 'boolean') {\n          floating = lower;\n          lower = undefined;\n        }\n      }\n      if (lower === undefined && upper === undefined) {\n        lower = 0;\n        upper = 1;\n      }\n      else {\n        lower = toFinite(lower);\n        if (upper === undefined) {\n          upper = lower;\n          lower = 0;\n        } else {\n          upper = toFinite(upper);\n        }\n      }\n      if (lower > upper) {\n        var temp = lower;\n        lower = upper;\n        upper = temp;\n      }\n      if (floating || lower % 1 || upper % 1) {\n        var rand = nativeRandom();\n        return nativeMin(lower + (rand * (upper - lower + freeParseFloat('1e-' + ((rand + '').length - 1)))), upper);\n      }\n      return baseRandom(lower, upper);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Converts `string` to [camel case](https://en.wikipedia.org/wiki/CamelCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the camel cased string.\n     * @example\n     *\n     * _.camelCase('Foo Bar');\n     * // => 'fooBar'\n     *\n     * _.camelCase('--foo-bar--');\n     * // => 'fooBar'\n     *\n     * _.camelCase('__FOO_BAR__');\n     * // => 'fooBar'\n     */\n    var camelCase = createCompounder(function(result, word, index) {\n      word = word.toLowerCase();\n      return result + (index ? capitalize(word) : word);\n    });\n\n    /**\n     * Converts the first character of `string` to upper case and the remaining\n     * to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to capitalize.\n     * @returns {string} Returns the capitalized string.\n     * @example\n     *\n     * _.capitalize('FRED');\n     * // => 'Fred'\n     */\n    function capitalize(string) {\n      return upperFirst(toString(string).toLowerCase());\n    }\n\n    /**\n     * Deburrs `string` by converting\n     * [Latin-1 Supplement](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)\n     * and [Latin Extended-A](https://en.wikipedia.org/wiki/Latin_Extended-A)\n     * letters to basic Latin letters and removing\n     * [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to deburr.\n     * @returns {string} Returns the deburred string.\n     * @example\n     *\n     * _.deburr('d\u00E9j\u00E0 vu');\n     * // => 'deja vu'\n     */\n    function deburr(string) {\n      string = toString(string);\n      return string && string.replace(reLatin, deburrLetter).replace(reComboMark, '');\n    }\n\n    /**\n     * Checks if `string` ends with the given target string.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {string} [target] The string to search for.\n     * @param {number} [position=string.length] The position to search up to.\n     * @returns {boolean} Returns `true` if `string` ends with `target`,\n     *  else `false`.\n     * @example\n     *\n     * _.endsWith('abc', 'c');\n     * // => true\n     *\n     * _.endsWith('abc', 'b');\n     * // => false\n     *\n     * _.endsWith('abc', 'b', 2);\n     * // => true\n     */\n    function endsWith(string, target, position) {\n      string = toString(string);\n      target = baseToString(target);\n\n      var length = string.length;\n      position = position === undefined\n        ? length\n        : baseClamp(toInteger(position), 0, length);\n\n      var end = position;\n      position -= target.length;\n      return position >= 0 && string.slice(position, end) == target;\n    }\n\n    /**\n     * Converts the characters \"&\", \"<\", \">\", '\"', and \"'\" in `string` to their\n     * corresponding HTML entities.\n     *\n     * **Note:** No other characters are escaped. To escape additional\n     * characters use a third-party library like [_he_](https://mths.be/he).\n     *\n     * Though the \">\" character is escaped for symmetry, characters like\n     * \">\" and \"/\" don't need escaping in HTML and have no special meaning\n     * unless they're part of a tag or unquoted attribute value. See\n     * [Mathias Bynens's article](https://mathiasbynens.be/notes/ambiguous-ampersands)\n     * (under \"semi-related fun fact\") for more details.\n     *\n     * When working with HTML you should always\n     * [quote attribute values](http://wonko.com/post/html-escaping) to reduce\n     * XSS vectors.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category String\n     * @param {string} [string=''] The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escape('fred, barney, & pebbles');\n     * // => 'fred, barney, &amp; pebbles'\n     */\n    function escape(string) {\n      string = toString(string);\n      return (string && reHasUnescapedHtml.test(string))\n        ? string.replace(reUnescapedHtml, escapeHtmlChar)\n        : string;\n    }\n\n    /**\n     * Escapes the `RegExp` special characters \"^\", \"$\", \"\\\", \".\", \"*\", \"+\",\n     * \"?\", \"(\", \")\", \"[\", \"]\", \"{\", \"}\", and \"|\" in `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escapeRegExp('[lodash](https://lodash.com/)');\n     * // => '\\[lodash\\]\\(https://lodash\\.com/\\)'\n     */\n    function escapeRegExp(string) {\n      string = toString(string);\n      return (string && reHasRegExpChar.test(string))\n        ? string.replace(reRegExpChar, '\\\\$&')\n        : string;\n    }\n\n    /**\n     * Converts `string` to\n     * [kebab case](https://en.wikipedia.org/wiki/Letter_case#Special_case_styles).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the kebab cased string.\n     * @example\n     *\n     * _.kebabCase('Foo Bar');\n     * // => 'foo-bar'\n     *\n     * _.kebabCase('fooBar');\n     * // => 'foo-bar'\n     *\n     * _.kebabCase('__FOO_BAR__');\n     * // => 'foo-bar'\n     */\n    var kebabCase = createCompounder(function(result, word, index) {\n      return result + (index ? '-' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Converts `string`, as space separated words, to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the lower cased string.\n     * @example\n     *\n     * _.lowerCase('--Foo-Bar--');\n     * // => 'foo bar'\n     *\n     * _.lowerCase('fooBar');\n     * // => 'foo bar'\n     *\n     * _.lowerCase('__FOO_BAR__');\n     * // => 'foo bar'\n     */\n    var lowerCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Converts the first character of `string` to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.lowerFirst('Fred');\n     * // => 'fred'\n     *\n     * _.lowerFirst('FRED');\n     * // => 'fRED'\n     */\n    var lowerFirst = createCaseFirst('toLowerCase');\n\n    /**\n     * Pads `string` on the left and right sides if it's shorter than `length`.\n     * Padding characters are truncated if they can't be evenly divided by `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.pad('abc', 8);\n     * // => '  abc   '\n     *\n     * _.pad('abc', 8, '_-');\n     * // => '_-abc_-_'\n     *\n     * _.pad('abc', 3);\n     * // => 'abc'\n     */\n    function pad(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      if (!length || strLength >= length) {\n        return string;\n      }\n      var mid = (length - strLength) / 2;\n      return (\n        createPadding(nativeFloor(mid), chars) +\n        string +\n        createPadding(nativeCeil(mid), chars)\n      );\n    }\n\n    /**\n     * Pads `string` on the right side if it's shorter than `length`. Padding\n     * characters are truncated if they exceed `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.padEnd('abc', 6);\n     * // => 'abc   '\n     *\n     * _.padEnd('abc', 6, '_-');\n     * // => 'abc_-_'\n     *\n     * _.padEnd('abc', 3);\n     * // => 'abc'\n     */\n    function padEnd(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      return (length && strLength < length)\n        ? (string + createPadding(length - strLength, chars))\n        : string;\n    }\n\n    /**\n     * Pads `string` on the left side if it's shorter than `length`. Padding\n     * characters are truncated if they exceed `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.padStart('abc', 6);\n     * // => '   abc'\n     *\n     * _.padStart('abc', 6, '_-');\n     * // => '_-_abc'\n     *\n     * _.padStart('abc', 3);\n     * // => 'abc'\n     */\n    function padStart(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      return (length && strLength < length)\n        ? (createPadding(length - strLength, chars) + string)\n        : string;\n    }\n\n    /**\n     * Converts `string` to an integer of the specified radix. If `radix` is\n     * `undefined` or `0`, a `radix` of `10` is used unless `value` is a\n     * hexadecimal, in which case a `radix` of `16` is used.\n     *\n     * **Note:** This method aligns with the\n     * [ES5 implementation](https://es5.github.io/#x15.1.2.2) of `parseInt`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category String\n     * @param {string} string The string to convert.\n     * @param {number} [radix=10] The radix to interpret `value` by.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.parseInt('08');\n     * // => 8\n     *\n     * _.map(['6', '08', '10'], _.parseInt);\n     * // => [6, 8, 10]\n     */\n    function parseInt(string, radix, guard) {\n      if (guard || radix == null) {\n        radix = 0;\n      } else if (radix) {\n        radix = +radix;\n      }\n      return nativeParseInt(toString(string).replace(reTrimStart, ''), radix || 0);\n    }\n\n    /**\n     * Repeats the given string `n` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to repeat.\n     * @param {number} [n=1] The number of times to repeat the string.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the repeated string.\n     * @example\n     *\n     * _.repeat('*', 3);\n     * // => '***'\n     *\n     * _.repeat('abc', 2);\n     * // => 'abcabc'\n     *\n     * _.repeat('abc', 0);\n     * // => ''\n     */\n    function repeat(string, n, guard) {\n      if ((guard ? isIterateeCall(string, n, guard) : n === undefined)) {\n        n = 1;\n      } else {\n        n = toInteger(n);\n      }\n      return baseRepeat(toString(string), n);\n    }\n\n    /**\n     * Replaces matches for `pattern` in `string` with `replacement`.\n     *\n     * **Note:** This method is based on\n     * [`String#replace`](https://mdn.io/String/replace).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to modify.\n     * @param {RegExp|string} pattern The pattern to replace.\n     * @param {Function|string} replacement The match replacement.\n     * @returns {string} Returns the modified string.\n     * @example\n     *\n     * _.replace('Hi Fred', 'Fred', 'Barney');\n     * // => 'Hi Barney'\n     */\n    function replace() {\n      var args = arguments,\n          string = toString(args[0]);\n\n      return args.length < 3 ? string : string.replace(args[1], args[2]);\n    }\n\n    /**\n     * Converts `string` to\n     * [snake case](https://en.wikipedia.org/wiki/Snake_case).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the snake cased string.\n     * @example\n     *\n     * _.snakeCase('Foo Bar');\n     * // => 'foo_bar'\n     *\n     * _.snakeCase('fooBar');\n     * // => 'foo_bar'\n     *\n     * _.snakeCase('--FOO-BAR--');\n     * // => 'foo_bar'\n     */\n    var snakeCase = createCompounder(function(result, word, index) {\n      return result + (index ? '_' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Splits `string` by `separator`.\n     *\n     * **Note:** This method is based on\n     * [`String#split`](https://mdn.io/String/split).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to split.\n     * @param {RegExp|string} separator The separator pattern to split by.\n     * @param {number} [limit] The length to truncate results to.\n     * @returns {Array} Returns the string segments.\n     * @example\n     *\n     * _.split('a-b-c', '-', 2);\n     * // => ['a', 'b']\n     */\n    function split(string, separator, limit) {\n      if (limit && typeof limit != 'number' && isIterateeCall(string, separator, limit)) {\n        separator = limit = undefined;\n      }\n      limit = limit === undefined ? MAX_ARRAY_LENGTH : limit >>> 0;\n      if (!limit) {\n        return [];\n      }\n      string = toString(string);\n      if (string && (\n            typeof separator == 'string' ||\n            (separator != null && !isRegExp(separator))\n          )) {\n        separator = baseToString(separator);\n        if (!separator && hasUnicode(string)) {\n          return castSlice(stringToArray(string), 0, limit);\n        }\n      }\n      return string.split(separator, limit);\n    }\n\n    /**\n     * Converts `string` to\n     * [start case](https://en.wikipedia.org/wiki/Letter_case#Stylistic_or_specialised_usage).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.1.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the start cased string.\n     * @example\n     *\n     * _.startCase('--foo-bar--');\n     * // => 'Foo Bar'\n     *\n     * _.startCase('fooBar');\n     * // => 'Foo Bar'\n     *\n     * _.startCase('__FOO_BAR__');\n     * // => 'FOO BAR'\n     */\n    var startCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + upperFirst(word);\n    });\n\n    /**\n     * Checks if `string` starts with the given target string.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {string} [target] The string to search for.\n     * @param {number} [position=0] The position to search from.\n     * @returns {boolean} Returns `true` if `string` starts with `target`,\n     *  else `false`.\n     * @example\n     *\n     * _.startsWith('abc', 'a');\n     * // => true\n     *\n     * _.startsWith('abc', 'b');\n     * // => false\n     *\n     * _.startsWith('abc', 'b', 1);\n     * // => true\n     */\n    function startsWith(string, target, position) {\n      string = toString(string);\n      position = position == null\n        ? 0\n        : baseClamp(toInteger(position), 0, string.length);\n\n      target = baseToString(target);\n      return string.slice(position, position + target.length) == target;\n    }\n\n    /**\n     * Creates a compiled template function that can interpolate data properties\n     * in \"interpolate\" delimiters, HTML-escape interpolated data properties in\n     * \"escape\" delimiters, and execute JavaScript in \"evaluate\" delimiters. Data\n     * properties may be accessed as free variables in the template. If a setting\n     * object is given, it takes precedence over `_.templateSettings` values.\n     *\n     * **Note:** In the development build `_.template` utilizes\n     * [sourceURLs](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl)\n     * for easier debugging.\n     *\n     * For more information on precompiling templates see\n     * [lodash's custom builds documentation](https://lodash.com/custom-builds).\n     *\n     * For more information on Chrome extension sandboxes see\n     * [Chrome's extensions documentation](https://developer.chrome.com/extensions/sandboxingEval).\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category String\n     * @param {string} [string=''] The template string.\n     * @param {Object} [options={}] The options object.\n     * @param {RegExp} [options.escape=_.templateSettings.escape]\n     *  The HTML \"escape\" delimiter.\n     * @param {RegExp} [options.evaluate=_.templateSettings.evaluate]\n     *  The \"evaluate\" delimiter.\n     * @param {Object} [options.imports=_.templateSettings.imports]\n     *  An object to import into the template as free variables.\n     * @param {RegExp} [options.interpolate=_.templateSettings.interpolate]\n     *  The \"interpolate\" delimiter.\n     * @param {string} [options.sourceURL='lodash.templateSources[n]']\n     *  The sourceURL of the compiled template.\n     * @param {string} [options.variable='obj']\n     *  The data object variable name.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the compiled template function.\n     * @example\n     *\n     * // Use the \"interpolate\" delimiter to create a compiled template.\n     * var compiled = _.template('hello <%= user %>!');\n     * compiled({ 'user': 'fred' });\n     * // => 'hello fred!'\n     *\n     * // Use the HTML \"escape\" delimiter to escape data property values.\n     * var compiled = _.template('<b><%- value %></b>');\n     * compiled({ 'value': '<script>' });\n     * // => '<b>&lt;script&gt;</b>'\n     *\n     * // Use the \"evaluate\" delimiter to execute JavaScript and generate HTML.\n     * var compiled = _.template('<% _.forEach(users, function(user) { %><li><%- user %></li><% }); %>');\n     * compiled({ 'users': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // Use the internal `print` function in \"evaluate\" delimiters.\n     * var compiled = _.template('<% print(\"hello \" + user); %>!');\n     * compiled({ 'user': 'barney' });\n     * // => 'hello barney!'\n     *\n     * // Use the ES template literal delimiter as an \"interpolate\" delimiter.\n     * // Disable support by replacing the \"interpolate\" delimiter.\n     * var compiled = _.template('hello ${ user }!');\n     * compiled({ 'user': 'pebbles' });\n     * // => 'hello pebbles!'\n     *\n     * // Use backslashes to treat delimiters as plain text.\n     * var compiled = _.template('<%= \"\\\\<%- value %\\\\>\" %>');\n     * compiled({ 'value': 'ignored' });\n     * // => '<%- value %>'\n     *\n     * // Use the `imports` option to import `jQuery` as `jq`.\n     * var text = '<% jq.each(users, function(user) { %><li><%- user %></li><% }); %>';\n     * var compiled = _.template(text, { 'imports': { 'jq': jQuery } });\n     * compiled({ 'users': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // Use the `sourceURL` option to specify a custom sourceURL for the template.\n     * var compiled = _.template('hello <%= user %>!', { 'sourceURL': '/basic/greeting.jst' });\n     * compiled(data);\n     * // => Find the source of \"greeting.jst\" under the Sources tab or Resources panel of the web inspector.\n     *\n     * // Use the `variable` option to ensure a with-statement isn't used in the compiled template.\n     * var compiled = _.template('hi <%= data.user %>!', { 'variable': 'data' });\n     * compiled.source;\n     * // => function(data) {\n     * //   var __t, __p = '';\n     * //   __p += 'hi ' + ((__t = ( data.user )) == null ? '' : __t) + '!';\n     * //   return __p;\n     * // }\n     *\n     * // Use custom template delimiters.\n     * _.templateSettings.interpolate = /{{([\\s\\S]+?)}}/g;\n     * var compiled = _.template('hello {{ user }}!');\n     * compiled({ 'user': 'mustache' });\n     * // => 'hello mustache!'\n     *\n     * // Use the `source` property to inline compiled templates for meaningful\n     * // line numbers in error messages and stack traces.\n     * fs.writeFileSync(path.join(process.cwd(), 'jst.js'), '\\\n     *   var JST = {\\\n     *     \"main\": ' + _.template(mainText).source + '\\\n     *   };\\\n     * ');\n     */\n    function template(string, options, guard) {\n      // Based on John Resig's `tmpl` implementation\n      // (http://ejohn.org/blog/javascript-micro-templating/)\n      // and Laura Doktorova's doT.js (https://github.com/olado/doT).\n      var settings = lodash.templateSettings;\n\n      if (guard && isIterateeCall(string, options, guard)) {\n        options = undefined;\n      }\n      string = toString(string);\n      options = assignInWith({}, options, settings, customDefaultsAssignIn);\n\n      var imports = assignInWith({}, options.imports, settings.imports, customDefaultsAssignIn),\n          importsKeys = keys(imports),\n          importsValues = baseValues(imports, importsKeys);\n\n      var isEscaping,\n          isEvaluating,\n          index = 0,\n          interpolate = options.interpolate || reNoMatch,\n          source = \"__p += '\";\n\n      // Compile the regexp to match each delimiter.\n      var reDelimiters = RegExp(\n        (options.escape || reNoMatch).source + '|' +\n        interpolate.source + '|' +\n        (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +\n        (options.evaluate || reNoMatch).source + '|$'\n      , 'g');\n\n      // Use a sourceURL for easier debugging.\n      // The sourceURL gets injected into the source that's eval-ed, so be careful\n      // to normalize all kinds of whitespace, so e.g. newlines (and unicode versions of it) can't sneak in\n      // and escape the comment, thus injecting code that gets evaled.\n      var sourceURL = '//# sourceURL=' +\n        (hasOwnProperty.call(options, 'sourceURL')\n          ? (options.sourceURL + '').replace(/\\s/g, ' ')\n          : ('lodash.templateSources[' + (++templateCounter) + ']')\n        ) + '\\n';\n\n      string.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {\n        interpolateValue || (interpolateValue = esTemplateValue);\n\n        // Escape characters that can't be included in string literals.\n        source += string.slice(index, offset).replace(reUnescapedString, escapeStringChar);\n\n        // Replace delimiters with snippets.\n        if (escapeValue) {\n          isEscaping = true;\n          source += \"' +\\n__e(\" + escapeValue + \") +\\n'\";\n        }\n        if (evaluateValue) {\n          isEvaluating = true;\n          source += \"';\\n\" + evaluateValue + \";\\n__p += '\";\n        }\n        if (interpolateValue) {\n          source += \"' +\\n((__t = (\" + interpolateValue + \")) == null ? '' : __t) +\\n'\";\n        }\n        index = offset + match.length;\n\n        // The JS engine embedded in Adobe products needs `match` returned in\n        // order to produce the correct `offset` value.\n        return match;\n      });\n\n      source += \"';\\n\";\n\n      // If `variable` is not specified wrap a with-statement around the generated\n      // code to add the data object to the top of the scope chain.\n      var variable = hasOwnProperty.call(options, 'variable') && options.variable;\n      if (!variable) {\n        source = 'with (obj) {\\n' + source + '\\n}\\n';\n      }\n      // Throw an error if a forbidden character was found in `variable`, to prevent\n      // potential command injection attacks.\n      else if (reForbiddenIdentifierChars.test(variable)) {\n        throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT);\n      }\n\n      // Cleanup code by stripping empty strings.\n      source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)\n        .replace(reEmptyStringMiddle, '$1')\n        .replace(reEmptyStringTrailing, '$1;');\n\n      // Frame code as the function body.\n      source = 'function(' + (variable || 'obj') + ') {\\n' +\n        (variable\n          ? ''\n          : 'obj || (obj = {});\\n'\n        ) +\n        \"var __t, __p = ''\" +\n        (isEscaping\n           ? ', __e = _.escape'\n           : ''\n        ) +\n        (isEvaluating\n          ? ', __j = Array.prototype.join;\\n' +\n            \"function print() { __p += __j.call(arguments, '') }\\n\"\n          : ';\\n'\n        ) +\n        source +\n        'return __p\\n}';\n\n      var result = attempt(function() {\n        return Function(importsKeys, sourceURL + 'return ' + source)\n          .apply(undefined, importsValues);\n      });\n\n      // Provide the compiled function's source by its `toString` method or\n      // the `source` property as a convenience for inlining compiled templates.\n      result.source = source;\n      if (isError(result)) {\n        throw result;\n      }\n      return result;\n    }\n\n    /**\n     * Converts `string`, as a whole, to lower case just like\n     * [String#toLowerCase](https://mdn.io/toLowerCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the lower cased string.\n     * @example\n     *\n     * _.toLower('--Foo-Bar--');\n     * // => '--foo-bar--'\n     *\n     * _.toLower('fooBar');\n     * // => 'foobar'\n     *\n     * _.toLower('__FOO_BAR__');\n     * // => '__foo_bar__'\n     */\n    function toLower(value) {\n      return toString(value).toLowerCase();\n    }\n\n    /**\n     * Converts `string`, as a whole, to upper case just like\n     * [String#toUpperCase](https://mdn.io/toUpperCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the upper cased string.\n     * @example\n     *\n     * _.toUpper('--foo-bar--');\n     * // => '--FOO-BAR--'\n     *\n     * _.toUpper('fooBar');\n     * // => 'FOOBAR'\n     *\n     * _.toUpper('__foo_bar__');\n     * // => '__FOO_BAR__'\n     */\n    function toUpper(value) {\n      return toString(value).toUpperCase();\n    }\n\n    /**\n     * Removes leading and trailing whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trim('  abc  ');\n     * // => 'abc'\n     *\n     * _.trim('-_-abc-_-', '_-');\n     * // => 'abc'\n     *\n     * _.map(['  foo  ', '  bar  '], _.trim);\n     * // => ['foo', 'bar']\n     */\n    function trim(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return baseTrim(string);\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          chrSymbols = stringToArray(chars),\n          start = charsStartIndex(strSymbols, chrSymbols),\n          end = charsEndIndex(strSymbols, chrSymbols) + 1;\n\n      return castSlice(strSymbols, start, end).join('');\n    }\n\n    /**\n     * Removes trailing whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trimEnd('  abc  ');\n     * // => '  abc'\n     *\n     * _.trimEnd('-_-abc-_-', '_-');\n     * // => '-_-abc'\n     */\n    function trimEnd(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.slice(0, trimmedEndIndex(string) + 1);\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          end = charsEndIndex(strSymbols, stringToArray(chars)) + 1;\n\n      return castSlice(strSymbols, 0, end).join('');\n    }\n\n    /**\n     * Removes leading whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trimStart('  abc  ');\n     * // => 'abc  '\n     *\n     * _.trimStart('-_-abc-_-', '_-');\n     * // => 'abc-_-'\n     */\n    function trimStart(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.replace(reTrimStart, '');\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          start = charsStartIndex(strSymbols, stringToArray(chars));\n\n      return castSlice(strSymbols, start).join('');\n    }\n\n    /**\n     * Truncates `string` if it's longer than the given maximum string length.\n     * The last characters of the truncated string are replaced with the omission\n     * string which defaults to \"...\".\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to truncate.\n     * @param {Object} [options={}] The options object.\n     * @param {number} [options.length=30] The maximum string length.\n     * @param {string} [options.omission='...'] The string to indicate text is omitted.\n     * @param {RegExp|string} [options.separator] The separator pattern to truncate to.\n     * @returns {string} Returns the truncated string.\n     * @example\n     *\n     * _.truncate('hi-diddly-ho there, neighborino');\n     * // => 'hi-diddly-ho there, neighbo...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'length': 24,\n     *   'separator': ' '\n     * });\n     * // => 'hi-diddly-ho there,...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'length': 24,\n     *   'separator': /,? +/\n     * });\n     * // => 'hi-diddly-ho there...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'omission': ' [...]'\n     * });\n     * // => 'hi-diddly-ho there, neig [...]'\n     */\n    function truncate(string, options) {\n      var length = DEFAULT_TRUNC_LENGTH,\n          omission = DEFAULT_TRUNC_OMISSION;\n\n      if (isObject(options)) {\n        var separator = 'separator' in options ? options.separator : separator;\n        length = 'length' in options ? toInteger(options.length) : length;\n        omission = 'omission' in options ? baseToString(options.omission) : omission;\n      }\n      string = toString(string);\n\n      var strLength = string.length;\n      if (hasUnicode(string)) {\n        var strSymbols = stringToArray(string);\n        strLength = strSymbols.length;\n      }\n      if (length >= strLength) {\n        return string;\n      }\n      var end = length - stringSize(omission);\n      if (end < 1) {\n        return omission;\n      }\n      var result = strSymbols\n        ? castSlice(strSymbols, 0, end).join('')\n        : string.slice(0, end);\n\n      if (separator === undefined) {\n        return result + omission;\n      }\n      if (strSymbols) {\n        end += (result.length - end);\n      }\n      if (isRegExp(separator)) {\n        if (string.slice(end).search(separator)) {\n          var match,\n              substring = result;\n\n          if (!separator.global) {\n            separator = RegExp(separator.source, toString(reFlags.exec(separator)) + 'g');\n          }\n          separator.lastIndex = 0;\n          while ((match = separator.exec(substring))) {\n            var newEnd = match.index;\n          }\n          result = result.slice(0, newEnd === undefined ? end : newEnd);\n        }\n      } else if (string.indexOf(baseToString(separator), end) != end) {\n        var index = result.lastIndexOf(separator);\n        if (index > -1) {\n          result = result.slice(0, index);\n        }\n      }\n      return result + omission;\n    }\n\n    /**\n     * The inverse of `_.escape`; this method converts the HTML entities\n     * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to\n     * their corresponding characters.\n     *\n     * **Note:** No other HTML entities are unescaped. To unescape additional\n     * HTML entities use a third-party library like [_he_](https://mths.be/he).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.6.0\n     * @category String\n     * @param {string} [string=''] The string to unescape.\n     * @returns {string} Returns the unescaped string.\n     * @example\n     *\n     * _.unescape('fred, barney, &amp; pebbles');\n     * // => 'fred, barney, & pebbles'\n     */\n    function unescape(string) {\n      string = toString(string);\n      return (string && reHasEscapedHtml.test(string))\n        ? string.replace(reEscapedHtml, unescapeHtmlChar)\n        : string;\n    }\n\n    /**\n     * Converts `string`, as space separated words, to upper case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the upper cased string.\n     * @example\n     *\n     * _.upperCase('--foo-bar');\n     * // => 'FOO BAR'\n     *\n     * _.upperCase('fooBar');\n     * // => 'FOO BAR'\n     *\n     * _.upperCase('__foo_bar__');\n     * // => 'FOO BAR'\n     */\n    var upperCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + word.toUpperCase();\n    });\n\n    /**\n     * Converts the first character of `string` to upper case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.upperFirst('fred');\n     * // => 'Fred'\n     *\n     * _.upperFirst('FRED');\n     * // => 'FRED'\n     */\n    var upperFirst = createCaseFirst('toUpperCase');\n\n    /**\n     * Splits `string` into an array of its words.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {RegExp|string} [pattern] The pattern to match words.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the words of `string`.\n     * @example\n     *\n     * _.words('fred, barney, & pebbles');\n     * // => ['fred', 'barney', 'pebbles']\n     *\n     * _.words('fred, barney, & pebbles', /[^, ]+/g);\n     * // => ['fred', 'barney', '&', 'pebbles']\n     */\n    function words(string, pattern, guard) {\n      string = toString(string);\n      pattern = guard ? undefined : pattern;\n\n      if (pattern === undefined) {\n        return hasUnicodeWord(string) ? unicodeWords(string) : asciiWords(string);\n      }\n      return string.match(pattern) || [];\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Attempts to invoke `func`, returning either the result or the caught error\n     * object. Any additional arguments are provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Function} func The function to attempt.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {*} Returns the `func` result or error object.\n     * @example\n     *\n     * // Avoid throwing errors for invalid selectors.\n     * var elements = _.attempt(function(selector) {\n     *   return document.querySelectorAll(selector);\n     * }, '>_>');\n     *\n     * if (_.isError(elements)) {\n     *   elements = [];\n     * }\n     */\n    var attempt = baseRest(function(func, args) {\n      try {\n        return apply(func, undefined, args);\n      } catch (e) {\n        return isError(e) ? e : new Error(e);\n      }\n    });\n\n    /**\n     * Binds methods of an object to the object itself, overwriting the existing\n     * method.\n     *\n     * **Note:** This method doesn't set the \"length\" property of bound functions.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {Object} object The object to bind and assign the bound methods to.\n     * @param {...(string|string[])} methodNames The object method names to bind.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var view = {\n     *   'label': 'docs',\n     *   'click': function() {\n     *     console.log('clicked ' + this.label);\n     *   }\n     * };\n     *\n     * _.bindAll(view, ['click']);\n     * jQuery(element).on('click', view.click);\n     * // => Logs 'clicked docs' when clicked.\n     */\n    var bindAll = flatRest(function(object, methodNames) {\n      arrayEach(methodNames, function(key) {\n        key = toKey(key);\n        baseAssignValue(object, key, bind(object[key], object));\n      });\n      return object;\n    });\n\n    /**\n     * Creates a function that iterates over `pairs` and invokes the corresponding\n     * function of the first predicate to return truthy. The predicate-function\n     * pairs are invoked with the `this` binding and arguments of the created\n     * function.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {Array} pairs The predicate-function pairs.\n     * @returns {Function} Returns the new composite function.\n     * @example\n     *\n     * var func = _.cond([\n     *   [_.matches({ 'a': 1 }),           _.constant('matches A')],\n     *   [_.conforms({ 'b': _.isNumber }), _.constant('matches B')],\n     *   [_.stubTrue,                      _.constant('no match')]\n     * ]);\n     *\n     * func({ 'a': 1, 'b': 2 });\n     * // => 'matches A'\n     *\n     * func({ 'a': 0, 'b': 1 });\n     * // => 'matches B'\n     *\n     * func({ 'a': '1', 'b': '2' });\n     * // => 'no match'\n     */\n    function cond(pairs) {\n      var length = pairs == null ? 0 : pairs.length,\n          toIteratee = getIteratee();\n\n      pairs = !length ? [] : arrayMap(pairs, function(pair) {\n        if (typeof pair[1] != 'function') {\n          throw new TypeError(FUNC_ERROR_TEXT);\n        }\n        return [toIteratee(pair[0]), pair[1]];\n      });\n\n      return baseRest(function(args) {\n        var index = -1;\n        while (++index < length) {\n          var pair = pairs[index];\n          if (apply(pair[0], this, args)) {\n            return apply(pair[1], this, args);\n          }\n        }\n      });\n    }\n\n    /**\n     * Creates a function that invokes the predicate properties of `source` with\n     * the corresponding property values of a given object, returning `true` if\n     * all predicates return truthy, else `false`.\n     *\n     * **Note:** The created function is equivalent to `_.conformsTo` with\n     * `source` partially applied.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 2, 'b': 1 },\n     *   { 'a': 1, 'b': 2 }\n     * ];\n     *\n     * _.filter(objects, _.conforms({ 'b': function(n) { return n > 1; } }));\n     * // => [{ 'a': 1, 'b': 2 }]\n     */\n    function conforms(source) {\n      return baseConforms(baseClone(source, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that returns `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Util\n     * @param {*} value The value to return from the new function.\n     * @returns {Function} Returns the new constant function.\n     * @example\n     *\n     * var objects = _.times(2, _.constant({ 'a': 1 }));\n     *\n     * console.log(objects);\n     * // => [{ 'a': 1 }, { 'a': 1 }]\n     *\n     * console.log(objects[0] === objects[1]);\n     * // => true\n     */\n    function constant(value) {\n      return function() {\n        return value;\n      };\n    }\n\n    /**\n     * Checks `value` to determine whether a default value should be returned in\n     * its place. The `defaultValue` is returned if `value` is `NaN`, `null`,\n     * or `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.14.0\n     * @category Util\n     * @param {*} value The value to check.\n     * @param {*} defaultValue The default value.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * _.defaultTo(1, 10);\n     * // => 1\n     *\n     * _.defaultTo(undefined, 10);\n     * // => 10\n     */\n    function defaultTo(value, defaultValue) {\n      return (value == null || value !== value) ? defaultValue : value;\n    }\n\n    /**\n     * Creates a function that returns the result of invoking the given functions\n     * with the `this` binding of the created function, where each successive\n     * invocation is supplied the return value of the previous.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [funcs] The functions to invoke.\n     * @returns {Function} Returns the new composite function.\n     * @see _.flowRight\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var addSquare = _.flow([_.add, square]);\n     * addSquare(1, 2);\n     * // => 9\n     */\n    var flow = createFlow();\n\n    /**\n     * This method is like `_.flow` except that it creates a function that\n     * invokes the given functions from right to left.\n     *\n     * @static\n     * @since 3.0.0\n     * @memberOf _\n     * @category Util\n     * @param {...(Function|Function[])} [funcs] The functions to invoke.\n     * @returns {Function} Returns the new composite function.\n     * @see _.flow\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var addSquare = _.flowRight([square, _.add]);\n     * addSquare(1, 2);\n     * // => 9\n     */\n    var flowRight = createFlow(true);\n\n    /**\n     * This method returns the first argument it receives.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {*} value Any value.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     *\n     * console.log(_.identity(object) === object);\n     * // => true\n     */\n    function identity(value) {\n      return value;\n    }\n\n    /**\n     * Creates a function that invokes `func` with the arguments of the created\n     * function. If `func` is a property name, the created function returns the\n     * property value for a given element. If `func` is an array or object, the\n     * created function returns `true` for elements that contain the equivalent\n     * source properties, otherwise it returns `false`.\n     *\n     * @static\n     * @since 4.0.0\n     * @memberOf _\n     * @category Util\n     * @param {*} [func=_.identity] The value to convert to a callback.\n     * @returns {Function} Returns the callback.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': true },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.filter(users, _.iteratee({ 'user': 'barney', 'active': true }));\n     * // => [{ 'user': 'barney', 'age': 36, 'active': true }]\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.filter(users, _.iteratee(['user', 'fred']));\n     * // => [{ 'user': 'fred', 'age': 40 }]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.map(users, _.iteratee('user'));\n     * // => ['barney', 'fred']\n     *\n     * // Create custom iteratee shorthands.\n     * _.iteratee = _.wrap(_.iteratee, function(iteratee, func) {\n     *   return !_.isRegExp(func) ? iteratee(func) : function(string) {\n     *     return func.test(string);\n     *   };\n     * });\n     *\n     * _.filter(['abc', 'def'], /ef/);\n     * // => ['def']\n     */\n    function iteratee(func) {\n      return baseIteratee(typeof func == 'function' ? func : baseClone(func, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that performs a partial deep comparison between a given\n     * object and `source`, returning `true` if the given object has equivalent\n     * property values, else `false`.\n     *\n     * **Note:** The created function is equivalent to `_.isMatch` with `source`\n     * partially applied.\n     *\n     * Partial comparisons will match empty array and empty object `source`\n     * values against any array or object value, respectively. See `_.isEqual`\n     * for a list of supported value comparisons.\n     *\n     * **Note:** Multiple values can be checked by combining several matchers\n     * using `_.overSome`\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Object} source The object of property values to match.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 1, 'b': 2, 'c': 3 },\n     *   { 'a': 4, 'b': 5, 'c': 6 }\n     * ];\n     *\n     * _.filter(objects, _.matches({ 'a': 4, 'c': 6 }));\n     * // => [{ 'a': 4, 'b': 5, 'c': 6 }]\n     *\n     * // Checking for several possible values\n     * _.filter(objects, _.overSome([_.matches({ 'a': 1 }), _.matches({ 'a': 4 })]));\n     * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]\n     */\n    function matches(source) {\n      return baseMatches(baseClone(source, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that performs a partial deep comparison between the\n     * value at `path` of a given object to `srcValue`, returning `true` if the\n     * object value is equivalent, else `false`.\n     *\n     * **Note:** Partial comparisons will match empty array and empty object\n     * `srcValue` values against any array or object value, respectively. See\n     * `_.isEqual` for a list of supported value comparisons.\n     *\n     * **Note:** Multiple values can be checked by combining several matchers\n     * using `_.overSome`\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Util\n     * @param {Array|string} path The path of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 1, 'b': 2, 'c': 3 },\n     *   { 'a': 4, 'b': 5, 'c': 6 }\n     * ];\n     *\n     * _.find(objects, _.matchesProperty('a', 4));\n     * // => { 'a': 4, 'b': 5, 'c': 6 }\n     *\n     * // Checking for several possible values\n     * _.filter(objects, _.overSome([_.matchesProperty('a', 1), _.matchesProperty('a', 4)]));\n     * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]\n     */\n    function matchesProperty(path, srcValue) {\n      return baseMatchesProperty(path, baseClone(srcValue, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that invokes the method at `path` of a given object.\n     * Any additional arguments are provided to the invoked method.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Util\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {Function} Returns the new invoker function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': { 'b': _.constant(2) } },\n     *   { 'a': { 'b': _.constant(1) } }\n     * ];\n     *\n     * _.map(objects, _.method('a.b'));\n     * // => [2, 1]\n     *\n     * _.map(objects, _.method(['a', 'b']));\n     * // => [2, 1]\n     */\n    var method = baseRest(function(path, args) {\n      return function(object) {\n        return baseInvoke(object, path, args);\n      };\n    });\n\n    /**\n     * The opposite of `_.method`; this method creates a function that invokes\n     * the method at a given path of `object`. Any additional arguments are\n     * provided to the invoked method.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Util\n     * @param {Object} object The object to query.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {Function} Returns the new invoker function.\n     * @example\n     *\n     * var array = _.times(3, _.constant),\n     *     object = { 'a': array, 'b': array, 'c': array };\n     *\n     * _.map(['a[2]', 'c[0]'], _.methodOf(object));\n     * // => [2, 0]\n     *\n     * _.map([['a', '2'], ['c', '0']], _.methodOf(object));\n     * // => [2, 0]\n     */\n    var methodOf = baseRest(function(object, args) {\n      return function(path) {\n        return baseInvoke(object, path, args);\n      };\n    });\n\n    /**\n     * Adds all own enumerable string keyed function properties of a source\n     * object to the destination object. If `object` is a function, then methods\n     * are added to its prototype as well.\n     *\n     * **Note:** Use `_.runInContext` to create a pristine `lodash` function to\n     * avoid conflicts caused by modifying the original.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {Function|Object} [object=lodash] The destination object.\n     * @param {Object} source The object of functions to add.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.chain=true] Specify whether mixins are chainable.\n     * @returns {Function|Object} Returns `object`.\n     * @example\n     *\n     * function vowels(string) {\n     *   return _.filter(string, function(v) {\n     *     return /[aeiou]/i.test(v);\n     *   });\n     * }\n     *\n     * _.mixin({ 'vowels': vowels });\n     * _.vowels('fred');\n     * // => ['e']\n     *\n     * _('fred').vowels().value();\n     * // => ['e']\n     *\n     * _.mixin({ 'vowels': vowels }, { 'chain': false });\n     * _('fred').vowels();\n     * // => ['e']\n     */\n    function mixin(object, source, options) {\n      var props = keys(source),\n          methodNames = baseFunctions(source, props);\n\n      if (options == null &&\n          !(isObject(source) && (methodNames.length || !props.length))) {\n        options = source;\n        source = object;\n        object = this;\n        methodNames = baseFunctions(source, keys(source));\n      }\n      var chain = !(isObject(options) && 'chain' in options) || !!options.chain,\n          isFunc = isFunction(object);\n\n      arrayEach(methodNames, function(methodName) {\n        var func = source[methodName];\n        object[methodName] = func;\n        if (isFunc) {\n          object.prototype[methodName] = function() {\n            var chainAll = this.__chain__;\n            if (chain || chainAll) {\n              var result = object(this.__wrapped__),\n                  actions = result.__actions__ = copyArray(this.__actions__);\n\n              actions.push({ 'func': func, 'args': arguments, 'thisArg': object });\n              result.__chain__ = chainAll;\n              return result;\n            }\n            return func.apply(object, arrayPush([this.value()], arguments));\n          };\n        }\n      });\n\n      return object;\n    }\n\n    /**\n     * Reverts the `_` variable to its previous value and returns a reference to\n     * the `lodash` function.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @returns {Function} Returns the `lodash` function.\n     * @example\n     *\n     * var lodash = _.noConflict();\n     */\n    function noConflict() {\n      if (root._ === this) {\n        root._ = oldDash;\n      }\n      return this;\n    }\n\n    /**\n     * This method returns `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.3.0\n     * @category Util\n     * @example\n     *\n     * _.times(2, _.noop);\n     * // => [undefined, undefined]\n     */\n    function noop() {\n      // No operation performed.\n    }\n\n    /**\n     * Creates a function that gets the argument at index `n`. If `n` is negative,\n     * the nth argument from the end is returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {number} [n=0] The index of the argument to return.\n     * @returns {Function} Returns the new pass-thru function.\n     * @example\n     *\n     * var func = _.nthArg(1);\n     * func('a', 'b', 'c', 'd');\n     * // => 'b'\n     *\n     * var func = _.nthArg(-2);\n     * func('a', 'b', 'c', 'd');\n     * // => 'c'\n     */\n    function nthArg(n) {\n      n = toInteger(n);\n      return baseRest(function(args) {\n        return baseNth(args, n);\n      });\n    }\n\n    /**\n     * Creates a function that invokes `iteratees` with the arguments it receives\n     * and returns their results.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [iteratees=[_.identity]]\n     *  The iteratees to invoke.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.over([Math.max, Math.min]);\n     *\n     * func(1, 2, 3, 4);\n     * // => [4, 1]\n     */\n    var over = createOver(arrayMap);\n\n    /**\n     * Creates a function that checks if **all** of the `predicates` return\n     * truthy when invoked with the arguments it receives.\n     *\n     * Following shorthands are possible for providing predicates.\n     * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.\n     * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [predicates=[_.identity]]\n     *  The predicates to check.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.overEvery([Boolean, isFinite]);\n     *\n     * func('1');\n     * // => true\n     *\n     * func(null);\n     * // => false\n     *\n     * func(NaN);\n     * // => false\n     */\n    var overEvery = createOver(arrayEvery);\n\n    /**\n     * Creates a function that checks if **any** of the `predicates` return\n     * truthy when invoked with the arguments it receives.\n     *\n     * Following shorthands are possible for providing predicates.\n     * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.\n     * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [predicates=[_.identity]]\n     *  The predicates to check.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.overSome([Boolean, isFinite]);\n     *\n     * func('1');\n     * // => true\n     *\n     * func(null);\n     * // => true\n     *\n     * func(NaN);\n     * // => false\n     *\n     * var matchesFunc = _.overSome([{ 'a': 1 }, { 'a': 2 }])\n     * var matchesPropertyFunc = _.overSome([['a', 1], ['a', 2]])\n     */\n    var overSome = createOver(arraySome);\n\n    /**\n     * Creates a function that returns the value at `path` of a given object.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Util\n     * @param {Array|string} path The path of the property to get.\n     * @returns {Function} Returns the new accessor function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': { 'b': 2 } },\n     *   { 'a': { 'b': 1 } }\n     * ];\n     *\n     * _.map(objects, _.property('a.b'));\n     * // => [2, 1]\n     *\n     * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n     * // => [1, 2]\n     */\n    function property(path) {\n      return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n    }\n\n    /**\n     * The opposite of `_.property`; this method creates a function that returns\n     * the value at a given path of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Object} object The object to query.\n     * @returns {Function} Returns the new accessor function.\n     * @example\n     *\n     * var array = [0, 1, 2],\n     *     object = { 'a': array, 'b': array, 'c': array };\n     *\n     * _.map(['a[2]', 'c[0]'], _.propertyOf(object));\n     * // => [2, 0]\n     *\n     * _.map([['a', '2'], ['c', '0']], _.propertyOf(object));\n     * // => [2, 0]\n     */\n    function propertyOf(object) {\n      return function(path) {\n        return object == null ? undefined : baseGet(object, path);\n      };\n    }\n\n    /**\n     * Creates an array of numbers (positive and/or negative) progressing from\n     * `start` up to, but not including, `end`. A step of `-1` is used if a negative\n     * `start` is specified without an `end` or `step`. If `end` is not specified,\n     * it's set to `start` with `start` then set to `0`.\n     *\n     * **Note:** JavaScript follows the IEEE-754 standard for resolving\n     * floating-point values which can produce unexpected results.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns the range of numbers.\n     * @see _.inRange, _.rangeRight\n     * @example\n     *\n     * _.range(4);\n     * // => [0, 1, 2, 3]\n     *\n     * _.range(-4);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 5);\n     * // => [1, 2, 3, 4]\n     *\n     * _.range(0, 20, 5);\n     * // => [0, 5, 10, 15]\n     *\n     * _.range(0, -4, -1);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.range(0);\n     * // => []\n     */\n    var range = createRange();\n\n    /**\n     * This method is like `_.range` except that it populates values in\n     * descending order.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns the range of numbers.\n     * @see _.inRange, _.range\n     * @example\n     *\n     * _.rangeRight(4);\n     * // => [3, 2, 1, 0]\n     *\n     * _.rangeRight(-4);\n     * // => [-3, -2, -1, 0]\n     *\n     * _.rangeRight(1, 5);\n     * // => [4, 3, 2, 1]\n     *\n     * _.rangeRight(0, 20, 5);\n     * // => [15, 10, 5, 0]\n     *\n     * _.rangeRight(0, -4, -1);\n     * // => [-3, -2, -1, 0]\n     *\n     * _.rangeRight(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.rangeRight(0);\n     * // => []\n     */\n    var rangeRight = createRange(true);\n\n    /**\n     * This method returns a new empty array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {Array} Returns the new empty array.\n     * @example\n     *\n     * var arrays = _.times(2, _.stubArray);\n     *\n     * console.log(arrays);\n     * // => [[], []]\n     *\n     * console.log(arrays[0] === arrays[1]);\n     * // => false\n     */\n    function stubArray() {\n      return [];\n    }\n\n    /**\n     * This method returns `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {boolean} Returns `false`.\n     * @example\n     *\n     * _.times(2, _.stubFalse);\n     * // => [false, false]\n     */\n    function stubFalse() {\n      return false;\n    }\n\n    /**\n     * This method returns a new empty object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {Object} Returns the new empty object.\n     * @example\n     *\n     * var objects = _.times(2, _.stubObject);\n     *\n     * console.log(objects);\n     * // => [{}, {}]\n     *\n     * console.log(objects[0] === objects[1]);\n     * // => false\n     */\n    function stubObject() {\n      return {};\n    }\n\n    /**\n     * This method returns an empty string.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {string} Returns the empty string.\n     * @example\n     *\n     * _.times(2, _.stubString);\n     * // => ['', '']\n     */\n    function stubString() {\n      return '';\n    }\n\n    /**\n     * This method returns `true`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {boolean} Returns `true`.\n     * @example\n     *\n     * _.times(2, _.stubTrue);\n     * // => [true, true]\n     */\n    function stubTrue() {\n      return true;\n    }\n\n    /**\n     * Invokes the iteratee `n` times, returning an array of the results of\n     * each invocation. The iteratee is invoked with one argument; (index).\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {number} n The number of times to invoke `iteratee`.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the array of results.\n     * @example\n     *\n     * _.times(3, String);\n     * // => ['0', '1', '2']\n     *\n     *  _.times(4, _.constant(0));\n     * // => [0, 0, 0, 0]\n     */\n    function times(n, iteratee) {\n      n = toInteger(n);\n      if (n < 1 || n > MAX_SAFE_INTEGER) {\n        return [];\n      }\n      var index = MAX_ARRAY_LENGTH,\n          length = nativeMin(n, MAX_ARRAY_LENGTH);\n\n      iteratee = getIteratee(iteratee);\n      n -= MAX_ARRAY_LENGTH;\n\n      var result = baseTimes(length, iteratee);\n      while (++index < n) {\n        iteratee(index);\n      }\n      return result;\n    }\n\n    /**\n     * Converts `value` to a property path array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {*} value The value to convert.\n     * @returns {Array} Returns the new property path array.\n     * @example\n     *\n     * _.toPath('a.b.c');\n     * // => ['a', 'b', 'c']\n     *\n     * _.toPath('a[0].b.c');\n     * // => ['a', '0', 'b', 'c']\n     */\n    function toPath(value) {\n      if (isArray(value)) {\n        return arrayMap(value, toKey);\n      }\n      return isSymbol(value) ? [value] : copyArray(stringToPath(toString(value)));\n    }\n\n    /**\n     * Generates a unique ID. If `prefix` is given, the ID is appended to it.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {string} [prefix=''] The value to prefix the ID with.\n     * @returns {string} Returns the unique ID.\n     * @example\n     *\n     * _.uniqueId('contact_');\n     * // => 'contact_104'\n     *\n     * _.uniqueId();\n     * // => '105'\n     */\n    function uniqueId(prefix) {\n      var id = ++idCounter;\n      return toString(prefix) + id;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Adds two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.4.0\n     * @category Math\n     * @param {number} augend The first number in an addition.\n     * @param {number} addend The second number in an addition.\n     * @returns {number} Returns the total.\n     * @example\n     *\n     * _.add(6, 4);\n     * // => 10\n     */\n    var add = createMathOperation(function(augend, addend) {\n      return augend + addend;\n    }, 0);\n\n    /**\n     * Computes `number` rounded up to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round up.\n     * @param {number} [precision=0] The precision to round up to.\n     * @returns {number} Returns the rounded up number.\n     * @example\n     *\n     * _.ceil(4.006);\n     * // => 5\n     *\n     * _.ceil(6.004, 2);\n     * // => 6.01\n     *\n     * _.ceil(6040, -2);\n     * // => 6100\n     */\n    var ceil = createRound('ceil');\n\n    /**\n     * Divide two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {number} dividend The first number in a division.\n     * @param {number} divisor The second number in a division.\n     * @returns {number} Returns the quotient.\n     * @example\n     *\n     * _.divide(6, 4);\n     * // => 1.5\n     */\n    var divide = createMathOperation(function(dividend, divisor) {\n      return dividend / divisor;\n    }, 1);\n\n    /**\n     * Computes `number` rounded down to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round down.\n     * @param {number} [precision=0] The precision to round down to.\n     * @returns {number} Returns the rounded down number.\n     * @example\n     *\n     * _.floor(4.006);\n     * // => 4\n     *\n     * _.floor(0.046, 2);\n     * // => 0.04\n     *\n     * _.floor(4060, -2);\n     * // => 4000\n     */\n    var floor = createRound('floor');\n\n    /**\n     * Computes the maximum value of `array`. If `array` is empty or falsey,\n     * `undefined` is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * _.max([4, 2, 8, 6]);\n     * // => 8\n     *\n     * _.max([]);\n     * // => undefined\n     */\n    function max(array) {\n      return (array && array.length)\n        ? baseExtremum(array, identity, baseGt)\n        : undefined;\n    }\n\n    /**\n     * This method is like `_.max` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * the value is ranked. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * _.maxBy(objects, function(o) { return o.n; });\n     * // => { 'n': 2 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.maxBy(objects, 'n');\n     * // => { 'n': 2 }\n     */\n    function maxBy(array, iteratee) {\n      return (array && array.length)\n        ? baseExtremum(array, getIteratee(iteratee, 2), baseGt)\n        : undefined;\n    }\n\n    /**\n     * Computes the mean of the values in `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {number} Returns the mean.\n     * @example\n     *\n     * _.mean([4, 2, 8, 6]);\n     * // => 5\n     */\n    function mean(array) {\n      return baseMean(array, identity);\n    }\n\n    /**\n     * This method is like `_.mean` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the value to be averaged.\n     * The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the mean.\n     * @example\n     *\n     * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n     *\n     * _.meanBy(objects, function(o) { return o.n; });\n     * // => 5\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.meanBy(objects, 'n');\n     * // => 5\n     */\n    function meanBy(array, iteratee) {\n      return baseMean(array, getIteratee(iteratee, 2));\n    }\n\n    /**\n     * Computes the minimum value of `array`. If `array` is empty or falsey,\n     * `undefined` is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * _.min([4, 2, 8, 6]);\n     * // => 2\n     *\n     * _.min([]);\n     * // => undefined\n     */\n    function min(array) {\n      return (array && array.length)\n        ? baseExtremum(array, identity, baseLt)\n        : undefined;\n    }\n\n    /**\n     * This method is like `_.min` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * the value is ranked. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * _.minBy(objects, function(o) { return o.n; });\n     * // => { 'n': 1 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.minBy(objects, 'n');\n     * // => { 'n': 1 }\n     */\n    function minBy(array, iteratee) {\n      return (array && array.length)\n        ? baseExtremum(array, getIteratee(iteratee, 2), baseLt)\n        : undefined;\n    }\n\n    /**\n     * Multiply two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {number} multiplier The first number in a multiplication.\n     * @param {number} multiplicand The second number in a multiplication.\n     * @returns {number} Returns the product.\n     * @example\n     *\n     * _.multiply(6, 4);\n     * // => 24\n     */\n    var multiply = createMathOperation(function(multiplier, multiplicand) {\n      return multiplier * multiplicand;\n    }, 1);\n\n    /**\n     * Computes `number` rounded to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round.\n     * @param {number} [precision=0] The precision to round to.\n     * @returns {number} Returns the rounded number.\n     * @example\n     *\n     * _.round(4.006);\n     * // => 4\n     *\n     * _.round(4.006, 2);\n     * // => 4.01\n     *\n     * _.round(4060, -2);\n     * // => 4100\n     */\n    var round = createRound('round');\n\n    /**\n     * Subtract two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {number} minuend The first number in a subtraction.\n     * @param {number} subtrahend The second number in a subtraction.\n     * @returns {number} Returns the difference.\n     * @example\n     *\n     * _.subtract(6, 4);\n     * // => 2\n     */\n    var subtract = createMathOperation(function(minuend, subtrahend) {\n      return minuend - subtrahend;\n    }, 0);\n\n    /**\n     * Computes the sum of the values in `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.4.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {number} Returns the sum.\n     * @example\n     *\n     * _.sum([4, 2, 8, 6]);\n     * // => 20\n     */\n    function sum(array) {\n      return (array && array.length)\n        ? baseSum(array, identity)\n        : 0;\n    }\n\n    /**\n     * This method is like `_.sum` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the value to be summed.\n     * The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the sum.\n     * @example\n     *\n     * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n     *\n     * _.sumBy(objects, function(o) { return o.n; });\n     * // => 20\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sumBy(objects, 'n');\n     * // => 20\n     */\n    function sumBy(array, iteratee) {\n      return (array && array.length)\n        ? baseSum(array, getIteratee(iteratee, 2))\n        : 0;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    // Add methods that return wrapped values in chain sequences.\n    lodash.after = after;\n    lodash.ary = ary;\n    lodash.assign = assign;\n    lodash.assignIn = assignIn;\n    lodash.assignInWith = assignInWith;\n    lodash.assignWith = assignWith;\n    lodash.at = at;\n    lodash.before = before;\n    lodash.bind = bind;\n    lodash.bindAll = bindAll;\n    lodash.bindKey = bindKey;\n    lodash.castArray = castArray;\n    lodash.chain = chain;\n    lodash.chunk = chunk;\n    lodash.compact = compact;\n    lodash.concat = concat;\n    lodash.cond = cond;\n    lodash.conforms = conforms;\n    lodash.constant = constant;\n    lodash.countBy = countBy;\n    lodash.create = create;\n    lodash.curry = curry;\n    lodash.curryRight = curryRight;\n    lodash.debounce = debounce;\n    lodash.defaults = defaults;\n    lodash.defaultsDeep = defaultsDeep;\n    lodash.defer = defer;\n    lodash.delay = delay;\n    lodash.difference = difference;\n    lodash.differenceBy = differenceBy;\n    lodash.differenceWith = differenceWith;\n    lodash.drop = drop;\n    lodash.dropRight = dropRight;\n    lodash.dropRightWhile = dropRightWhile;\n    lodash.dropWhile = dropWhile;\n    lodash.fill = fill;\n    lodash.filter = filter;\n    lodash.flatMap = flatMap;\n    lodash.flatMapDeep = flatMapDeep;\n    lodash.flatMapDepth = flatMapDepth;\n    lodash.flatten = flatten;\n    lodash.flattenDeep = flattenDeep;\n    lodash.flattenDepth = flattenDepth;\n    lodash.flip = flip;\n    lodash.flow = flow;\n    lodash.flowRight = flowRight;\n    lodash.fromPairs = fromPairs;\n    lodash.functions = functions;\n    lodash.functionsIn = functionsIn;\n    lodash.groupBy = groupBy;\n    lodash.initial = initial;\n    lodash.intersection = intersection;\n    lodash.intersectionBy = intersectionBy;\n    lodash.intersectionWith = intersectionWith;\n    lodash.invert = invert;\n    lodash.invertBy = invertBy;\n    lodash.invokeMap = invokeMap;\n    lodash.iteratee = iteratee;\n    lodash.keyBy = keyBy;\n    lodash.keys = keys;\n    lodash.keysIn = keysIn;\n    lodash.map = map;\n    lodash.mapKeys = mapKeys;\n    lodash.mapValues = mapValues;\n    lodash.matches = matches;\n    lodash.matchesProperty = matchesProperty;\n    lodash.memoize = memoize;\n    lodash.merge = merge;\n    lodash.mergeWith = mergeWith;\n    lodash.method = method;\n    lodash.methodOf = methodOf;\n    lodash.mixin = mixin;\n    lodash.negate = negate;\n    lodash.nthArg = nthArg;\n    lodash.omit = omit;\n    lodash.omitBy = omitBy;\n    lodash.once = once;\n    lodash.orderBy = orderBy;\n    lodash.over = over;\n    lodash.overArgs = overArgs;\n    lodash.overEvery = overEvery;\n    lodash.overSome = overSome;\n    lodash.partial = partial;\n    lodash.partialRight = partialRight;\n    lodash.partition = partition;\n    lodash.pick = pick;\n    lodash.pickBy = pickBy;\n    lodash.property = property;\n    lodash.propertyOf = propertyOf;\n    lodash.pull = pull;\n    lodash.pullAll = pullAll;\n    lodash.pullAllBy = pullAllBy;\n    lodash.pullAllWith = pullAllWith;\n    lodash.pullAt = pullAt;\n    lodash.range = range;\n    lodash.rangeRight = rangeRight;\n    lodash.rearg = rearg;\n    lodash.reject = reject;\n    lodash.remove = remove;\n    lodash.rest = rest;\n    lodash.reverse = reverse;\n    lodash.sampleSize = sampleSize;\n    lodash.set = set;\n    lodash.setWith = setWith;\n    lodash.shuffle = shuffle;\n    lodash.slice = slice;\n    lodash.sortBy = sortBy;\n    lodash.sortedUniq = sortedUniq;\n    lodash.sortedUniqBy = sortedUniqBy;\n    lodash.split = split;\n    lodash.spread = spread;\n    lodash.tail = tail;\n    lodash.take = take;\n    lodash.takeRight = takeRight;\n    lodash.takeRightWhile = takeRightWhile;\n    lodash.takeWhile = takeWhile;\n    lodash.tap = tap;\n    lodash.throttle = throttle;\n    lodash.thru = thru;\n    lodash.toArray = toArray;\n    lodash.toPairs = toPairs;\n    lodash.toPairsIn = toPairsIn;\n    lodash.toPath = toPath;\n    lodash.toPlainObject = toPlainObject;\n    lodash.transform = transform;\n    lodash.unary = unary;\n    lodash.union = union;\n    lodash.unionBy = unionBy;\n    lodash.unionWith = unionWith;\n    lodash.uniq = uniq;\n    lodash.uniqBy = uniqBy;\n    lodash.uniqWith = uniqWith;\n    lodash.unset = unset;\n    lodash.unzip = unzip;\n    lodash.unzipWith = unzipWith;\n    lodash.update = update;\n    lodash.updateWith = updateWith;\n    lodash.values = values;\n    lodash.valuesIn = valuesIn;\n    lodash.without = without;\n    lodash.words = words;\n    lodash.wrap = wrap;\n    lodash.xor = xor;\n    lodash.xorBy = xorBy;\n    lodash.xorWith = xorWith;\n    lodash.zip = zip;\n    lodash.zipObject = zipObject;\n    lodash.zipObjectDeep = zipObjectDeep;\n    lodash.zipWith = zipWith;\n\n    // Add aliases.\n    lodash.entries = toPairs;\n    lodash.entriesIn = toPairsIn;\n    lodash.extend = assignIn;\n    lodash.extendWith = assignInWith;\n\n    // Add methods to `lodash.prototype`.\n    mixin(lodash, lodash);\n\n    /*------------------------------------------------------------------------*/\n\n    // Add methods that return unwrapped values in chain sequences.\n    lodash.add = add;\n    lodash.attempt = attempt;\n    lodash.camelCase = camelCase;\n    lodash.capitalize = capitalize;\n    lodash.ceil = ceil;\n    lodash.clamp = clamp;\n    lodash.clone = clone;\n    lodash.cloneDeep = cloneDeep;\n    lodash.cloneDeepWith = cloneDeepWith;\n    lodash.cloneWith = cloneWith;\n    lodash.conformsTo = conformsTo;\n    lodash.deburr = deburr;\n    lodash.defaultTo = defaultTo;\n    lodash.divide = divide;\n    lodash.endsWith = endsWith;\n    lodash.eq = eq;\n    lodash.escape = escape;\n    lodash.escapeRegExp = escapeRegExp;\n    lodash.every = every;\n    lodash.find = find;\n    lodash.findIndex = findIndex;\n    lodash.findKey = findKey;\n    lodash.findLast = findLast;\n    lodash.findLastIndex = findLastIndex;\n    lodash.findLastKey = findLastKey;\n    lodash.floor = floor;\n    lodash.forEach = forEach;\n    lodash.forEachRight = forEachRight;\n    lodash.forIn = forIn;\n    lodash.forInRight = forInRight;\n    lodash.forOwn = forOwn;\n    lodash.forOwnRight = forOwnRight;\n    lodash.get = get;\n    lodash.gt = gt;\n    lodash.gte = gte;\n    lodash.has = has;\n    lodash.hasIn = hasIn;\n    lodash.head = head;\n    lodash.identity = identity;\n    lodash.includes = includes;\n    lodash.indexOf = indexOf;\n    lodash.inRange = inRange;\n    lodash.invoke = invoke;\n    lodash.isArguments = isArguments;\n    lodash.isArray = isArray;\n    lodash.isArrayBuffer = isArrayBuffer;\n    lodash.isArrayLike = isArrayLike;\n    lodash.isArrayLikeObject = isArrayLikeObject;\n    lodash.isBoolean = isBoolean;\n    lodash.isBuffer = isBuffer;\n    lodash.isDate = isDate;\n    lodash.isElement = isElement;\n    lodash.isEmpty = isEmpty;\n    lodash.isEqual = isEqual;\n    lodash.isEqualWith = isEqualWith;\n    lodash.isError = isError;\n    lodash.isFinite = isFinite;\n    lodash.isFunction = isFunction;\n    lodash.isInteger = isInteger;\n    lodash.isLength = isLength;\n    lodash.isMap = isMap;\n    lodash.isMatch = isMatch;\n    lodash.isMatchWith = isMatchWith;\n    lodash.isNaN = isNaN;\n    lodash.isNative = isNative;\n    lodash.isNil = isNil;\n    lodash.isNull = isNull;\n    lodash.isNumber = isNumber;\n    lodash.isObject = isObject;\n    lodash.isObjectLike = isObjectLike;\n    lodash.isPlainObject = isPlainObject;\n    lodash.isRegExp = isRegExp;\n    lodash.isSafeInteger = isSafeInteger;\n    lodash.isSet = isSet;\n    lodash.isString = isString;\n    lodash.isSymbol = isSymbol;\n    lodash.isTypedArray = isTypedArray;\n    lodash.isUndefined = isUndefined;\n    lodash.isWeakMap = isWeakMap;\n    lodash.isWeakSet = isWeakSet;\n    lodash.join = join;\n    lodash.kebabCase = kebabCase;\n    lodash.last = last;\n    lodash.lastIndexOf = lastIndexOf;\n    lodash.lowerCase = lowerCase;\n    lodash.lowerFirst = lowerFirst;\n    lodash.lt = lt;\n    lodash.lte = lte;\n    lodash.max = max;\n    lodash.maxBy = maxBy;\n    lodash.mean = mean;\n    lodash.meanBy = meanBy;\n    lodash.min = min;\n    lodash.minBy = minBy;\n    lodash.stubArray = stubArray;\n    lodash.stubFalse = stubFalse;\n    lodash.stubObject = stubObject;\n    lodash.stubString = stubString;\n    lodash.stubTrue = stubTrue;\n    lodash.multiply = multiply;\n    lodash.nth = nth;\n    lodash.noConflict = noConflict;\n    lodash.noop = noop;\n    lodash.now = now;\n    lodash.pad = pad;\n    lodash.padEnd = padEnd;\n    lodash.padStart = padStart;\n    lodash.parseInt = parseInt;\n    lodash.random = random;\n    lodash.reduce = reduce;\n    lodash.reduceRight = reduceRight;\n    lodash.repeat = repeat;\n    lodash.replace = replace;\n    lodash.result = result;\n    lodash.round = round;\n    lodash.runInContext = runInContext;\n    lodash.sample = sample;\n    lodash.size = size;\n    lodash.snakeCase = snakeCase;\n    lodash.some = some;\n    lodash.sortedIndex = sortedIndex;\n    lodash.sortedIndexBy = sortedIndexBy;\n    lodash.sortedIndexOf = sortedIndexOf;\n    lodash.sortedLastIndex = sortedLastIndex;\n    lodash.sortedLastIndexBy = sortedLastIndexBy;\n    lodash.sortedLastIndexOf = sortedLastIndexOf;\n    lodash.startCase = startCase;\n    lodash.startsWith = startsWith;\n    lodash.subtract = subtract;\n    lodash.sum = sum;\n    lodash.sumBy = sumBy;\n    lodash.template = template;\n    lodash.times = times;\n    lodash.toFinite = toFinite;\n    lodash.toInteger = toInteger;\n    lodash.toLength = toLength;\n    lodash.toLower = toLower;\n    lodash.toNumber = toNumber;\n    lodash.toSafeInteger = toSafeInteger;\n    lodash.toString = toString;\n    lodash.toUpper = toUpper;\n    lodash.trim = trim;\n    lodash.trimEnd = trimEnd;\n    lodash.trimStart = trimStart;\n    lodash.truncate = truncate;\n    lodash.unescape = unescape;\n    lodash.uniqueId = uniqueId;\n    lodash.upperCase = upperCase;\n    lodash.upperFirst = upperFirst;\n\n    // Add aliases.\n    lodash.each = forEach;\n    lodash.eachRight = forEachRight;\n    lodash.first = head;\n\n    mixin(lodash, (function() {\n      var source = {};\n      baseForOwn(lodash, function(func, methodName) {\n        if (!hasOwnProperty.call(lodash.prototype, methodName)) {\n          source[methodName] = func;\n        }\n      });\n      return source;\n    }()), { 'chain': false });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The semantic version number.\n     *\n     * @static\n     * @memberOf _\n     * @type {string}\n     */\n    lodash.VERSION = VERSION;\n\n    // Assign default placeholders.\n    arrayEach(['bind', 'bindKey', 'curry', 'curryRight', 'partial', 'partialRight'], function(methodName) {\n      lodash[methodName].placeholder = lodash;\n    });\n\n    // Add `LazyWrapper` methods for `_.drop` and `_.take` variants.\n    arrayEach(['drop', 'take'], function(methodName, index) {\n      LazyWrapper.prototype[methodName] = function(n) {\n        n = n === undefined ? 1 : nativeMax(toInteger(n), 0);\n\n        var result = (this.__filtered__ && !index)\n          ? new LazyWrapper(this)\n          : this.clone();\n\n        if (result.__filtered__) {\n          result.__takeCount__ = nativeMin(n, result.__takeCount__);\n        } else {\n          result.__views__.push({\n            'size': nativeMin(n, MAX_ARRAY_LENGTH),\n            'type': methodName + (result.__dir__ < 0 ? 'Right' : '')\n          });\n        }\n        return result;\n      };\n\n      LazyWrapper.prototype[methodName + 'Right'] = function(n) {\n        return this.reverse()[methodName](n).reverse();\n      };\n    });\n\n    // Add `LazyWrapper` methods that accept an `iteratee` value.\n    arrayEach(['filter', 'map', 'takeWhile'], function(methodName, index) {\n      var type = index + 1,\n          isFilter = type == LAZY_FILTER_FLAG || type == LAZY_WHILE_FLAG;\n\n      LazyWrapper.prototype[methodName] = function(iteratee) {\n        var result = this.clone();\n        result.__iteratees__.push({\n          'iteratee': getIteratee(iteratee, 3),\n          'type': type\n        });\n        result.__filtered__ = result.__filtered__ || isFilter;\n        return result;\n      };\n    });\n\n    // Add `LazyWrapper` methods for `_.head` and `_.last`.\n    arrayEach(['head', 'last'], function(methodName, index) {\n      var takeName = 'take' + (index ? 'Right' : '');\n\n      LazyWrapper.prototype[methodName] = function() {\n        return this[takeName](1).value()[0];\n      };\n    });\n\n    // Add `LazyWrapper` methods for `_.initial` and `_.tail`.\n    arrayEach(['initial', 'tail'], function(methodName, index) {\n      var dropName = 'drop' + (index ? '' : 'Right');\n\n      LazyWrapper.prototype[methodName] = function() {\n        return this.__filtered__ ? new LazyWrapper(this) : this[dropName](1);\n      };\n    });\n\n    LazyWrapper.prototype.compact = function() {\n      return this.filter(identity);\n    };\n\n    LazyWrapper.prototype.find = function(predicate) {\n      return this.filter(predicate).head();\n    };\n\n    LazyWrapper.prototype.findLast = function(predicate) {\n      return this.reverse().find(predicate);\n    };\n\n    LazyWrapper.prototype.invokeMap = baseRest(function(path, args) {\n      if (typeof path == 'function') {\n        return new LazyWrapper(this);\n      }\n      return this.map(function(value) {\n        return baseInvoke(value, path, args);\n      });\n    });\n\n    LazyWrapper.prototype.reject = function(predicate) {\n      return this.filter(negate(getIteratee(predicate)));\n    };\n\n    LazyWrapper.prototype.slice = function(start, end) {\n      start = toInteger(start);\n\n      var result = this;\n      if (result.__filtered__ && (start > 0 || end < 0)) {\n        return new LazyWrapper(result);\n      }\n      if (start < 0) {\n        result = result.takeRight(-start);\n      } else if (start) {\n        result = result.drop(start);\n      }\n      if (end !== undefined) {\n        end = toInteger(end);\n        result = end < 0 ? result.dropRight(-end) : result.take(end - start);\n      }\n      return result;\n    };\n\n    LazyWrapper.prototype.takeRightWhile = function(predicate) {\n      return this.reverse().takeWhile(predicate).reverse();\n    };\n\n    LazyWrapper.prototype.toArray = function() {\n      return this.take(MAX_ARRAY_LENGTH);\n    };\n\n    // Add `LazyWrapper` methods to `lodash.prototype`.\n    baseForOwn(LazyWrapper.prototype, function(func, methodName) {\n      var checkIteratee = /^(?:filter|find|map|reject)|While$/.test(methodName),\n          isTaker = /^(?:head|last)$/.test(methodName),\n          lodashFunc = lodash[isTaker ? ('take' + (methodName == 'last' ? 'Right' : '')) : methodName],\n          retUnwrapped = isTaker || /^find/.test(methodName);\n\n      if (!lodashFunc) {\n        return;\n      }\n      lodash.prototype[methodName] = function() {\n        var value = this.__wrapped__,\n            args = isTaker ? [1] : arguments,\n            isLazy = value instanceof LazyWrapper,\n            iteratee = args[0],\n            useLazy = isLazy || isArray(value);\n\n        var interceptor = function(value) {\n          var result = lodashFunc.apply(lodash, arrayPush([value], args));\n          return (isTaker && chainAll) ? result[0] : result;\n        };\n\n        if (useLazy && checkIteratee && typeof iteratee == 'function' && iteratee.length != 1) {\n          // Avoid lazy use if the iteratee has a \"length\" value other than `1`.\n          isLazy = useLazy = false;\n        }\n        var chainAll = this.__chain__,\n            isHybrid = !!this.__actions__.length,\n            isUnwrapped = retUnwrapped && !chainAll,\n            onlyLazy = isLazy && !isHybrid;\n\n        if (!retUnwrapped && useLazy) {\n          value = onlyLazy ? value : new LazyWrapper(this);\n          var result = func.apply(value, args);\n          result.__actions__.push({ 'func': thru, 'args': [interceptor], 'thisArg': undefined });\n          return new LodashWrapper(result, chainAll);\n        }\n        if (isUnwrapped && onlyLazy) {\n          return func.apply(this, args);\n        }\n        result = this.thru(interceptor);\n        return isUnwrapped ? (isTaker ? result.value()[0] : result.value()) : result;\n      };\n    });\n\n    // Add `Array` methods to `lodash.prototype`.\n    arrayEach(['pop', 'push', 'shift', 'sort', 'splice', 'unshift'], function(methodName) {\n      var func = arrayProto[methodName],\n          chainName = /^(?:push|sort|unshift)$/.test(methodName) ? 'tap' : 'thru',\n          retUnwrapped = /^(?:pop|shift)$/.test(methodName);\n\n      lodash.prototype[methodName] = function() {\n        var args = arguments;\n        if (retUnwrapped && !this.__chain__) {\n          var value = this.value();\n          return func.apply(isArray(value) ? value : [], args);\n        }\n        return this[chainName](function(value) {\n          return func.apply(isArray(value) ? value : [], args);\n        });\n      };\n    });\n\n    // Map minified method names to their real names.\n    baseForOwn(LazyWrapper.prototype, function(func, methodName) {\n      var lodashFunc = lodash[methodName];\n      if (lodashFunc) {\n        var key = lodashFunc.name + '';\n        if (!hasOwnProperty.call(realNames, key)) {\n          realNames[key] = [];\n        }\n        realNames[key].push({ 'name': methodName, 'func': lodashFunc });\n      }\n    });\n\n    realNames[createHybrid(undefined, WRAP_BIND_KEY_FLAG).name] = [{\n      'name': 'wrapper',\n      'func': undefined\n    }];\n\n    // Add methods to `LazyWrapper`.\n    LazyWrapper.prototype.clone = lazyClone;\n    LazyWrapper.prototype.reverse = lazyReverse;\n    LazyWrapper.prototype.value = lazyValue;\n\n    // Add chain sequence methods to the `lodash` wrapper.\n    lodash.prototype.at = wrapperAt;\n    lodash.prototype.chain = wrapperChain;\n    lodash.prototype.commit = wrapperCommit;\n    lodash.prototype.next = wrapperNext;\n    lodash.prototype.plant = wrapperPlant;\n    lodash.prototype.reverse = wrapperReverse;\n    lodash.prototype.toJSON = lodash.prototype.valueOf = lodash.prototype.value = wrapperValue;\n\n    // Add lazy aliases.\n    lodash.prototype.first = lodash.prototype.head;\n\n    if (symIterator) {\n      lodash.prototype[symIterator] = wrapperToIterator;\n    }\n    return lodash;\n  });\n\n  /*--------------------------------------------------------------------------*/\n\n  // Export lodash.\n  var _ = runInContext();\n\n  // Some AMD build optimizers, like r.js, check for condition patterns like:\n  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\n    // Expose Lodash on the global object to prevent errors when Lodash is\n    // loaded by a script tag in the presence of an AMD loader.\n    // See http://requirejs.org/docs/errors.html#mismatch for more details.\n    // Use `_.noConflict` to remove Lodash from the global object.\n    root._ = _;\n\n    // Define as an anonymous module so, through path mapping, it can be\n    // referenced as the \"underscore\" module.\n    define(function() {\n      return _;\n    });\n  }\n  // Check for `exports` after `define` in case a build optimizer adds it.\n  else if (freeModule) {\n    // Export for Node.js.\n    (freeModule.exports = _)._ = _;\n    // Export for CommonJS support.\n    freeExports._ = _;\n  }\n  else {\n    // Export to the global object.\n    root._ = _;\n  }\n}.call(this));\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { groupBy } from 'lodash';\nimport { AbstractUIExtension, Action, IActionHandler, ICommand, matchesKeystroke, GModelRoot } from '@eclipse-glsp/sprotty';\n\nexport interface AccessibleKeyShortcutProvider {\n    registerShortcutKey(): void;\n}\n\nexport interface AccessibleKeyShortcut {\n    shortcuts: string[];\n    description: string;\n    group: string;\n    position: number;\n}\n\nexport interface SetAccessibleKeyShortcutAction extends Action {\n    kind: typeof SetAccessibleKeyShortcutAction.KIND;\n    token: string;\n    keys: AccessibleKeyShortcut[];\n}\n\nexport namespace SetAccessibleKeyShortcutAction {\n    export const KIND = 'setAccessibleKeyShortcut';\n\n    export function is(object: any): object is SetAccessibleKeyShortcutAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(options: { token: string; keys: AccessibleKeyShortcut[] }): SetAccessibleKeyShortcutAction {\n        return { kind: KIND, token: options.token, keys: options.keys };\n    }\n}\n\n@injectable()\nexport class KeyShortcutUIExtension extends AbstractUIExtension implements IActionHandler {\n    static readonly ID = 'key-shortcut';\n    protected container: HTMLDivElement;\n    protected shortcutsContainer: HTMLDivElement;\n    protected registrations: Record<string, AccessibleKeyShortcut[]> = {};\n\n    handle(action: Action): ICommand | Action | void {\n        if (SetAccessibleKeyShortcutAction.is(action)) {\n            this.registrations[action.token] = action.keys;\n            if (this.containerElement) {\n                this.refreshUI();\n            }\n        }\n    }\n    id(): string {\n        return KeyShortcutUIExtension.ID;\n    }\n\n    containerClass(): string {\n        return KeyShortcutUIExtension.ID;\n    }\n\n    override show(root: Readonly<GModelRoot>, ...contextElementIds: string[]): void {\n        super.show(root, ...contextElementIds);\n        this.shortcutsContainer.focus();\n    }\n\n    protected refreshUI(): void {\n        this.shortcutsContainer.innerHTML = '';\n\n        const registrations = Object.values(this.registrations).flatMap(r => r);\n        registrations.sort((a, b) => {\n            if (a.group < b.group) {\n                return -1;\n            }\n            if (a.group > b.group) {\n                return 1;\n            }\n\n            return a.position - b.position;\n        });\n\n        const grouped = groupBy(registrations, k => k.group);\n\n        const groupTable = document.createElement('table');\n        groupTable.classList.add('shortcut-table');\n        const tableHead = document.createElement('thead');\n        const tableBody = document.createElement('tbody');\n\n        const headerRow = document.createElement('tr');\n        const commandCell = document.createElement('th');\n        const keybindingCell = document.createElement('th');\n\n        commandCell.classList.add('column-title');\n\n        commandCell.innerText = 'Command';\n        keybindingCell.innerText = 'Keybinding';\n\n        headerRow.appendChild(commandCell);\n        headerRow.appendChild(keybindingCell);\n        tableHead.appendChild(headerRow);\n\n        for (const [group, shortcuts] of Object.entries(grouped)) {\n            tableBody.appendChild(this.createGroupHeader(group));\n            shortcuts.forEach(s => {\n                tableBody.appendChild(this.createEntry(s));\n            });\n        }\n\n        groupTable.appendChild(tableHead);\n        groupTable.appendChild(tableBody);\n\n        this.shortcutsContainer.append(groupTable);\n    }\n\n    protected createGroupHeader(group: string): HTMLElement {\n        const entryRow = document.createElement('tr');\n        const groupElement = document.createElement('td');\n        const text = document.createElement('strong');\n        const emptyElement = document.createElement('td');\n\n        text.innerText = group;\n        groupElement.appendChild(text);\n        entryRow.appendChild(groupElement);\n        entryRow.appendChild(emptyElement);\n\n        return entryRow;\n    }\n\n    protected getShortcutHTML(shortcuts: string[]): HTMLElement {\n        const shortcutKeys = document.createElement('span');\n        shortcutKeys.innerHTML = shortcuts.map(key => `<kbd>${key}</kbd>`).join(' + ');\n\n        return shortcutKeys;\n    }\n\n    protected createEntry(registration: AccessibleKeyShortcut): HTMLDivElement {\n        const entryRow = document.createElement('tr');\n        const shortcutElement = document.createElement('td');\n        const descElement = document.createElement('td');\n\n        const shortcut = this.getShortcutHTML(registration.shortcuts);\n        descElement.innerText = registration.description;\n\n        shortcutElement.appendChild(shortcut);\n        entryRow.appendChild(descElement);\n        entryRow.appendChild(shortcutElement);\n\n        return entryRow;\n    }\n\n    protected initializeContents(containerElement: HTMLElement): void {\n        this.container = document.createElement('div');\n        this.container.classList.add('keyboard-shortcuts-menu');\n\n        // create title\n        const menuTitle = document.createElement('h3');\n        menuTitle.classList.add('menu-header');\n        menuTitle.innerText = 'Keyboard Shortcuts';\n        this.container.appendChild(menuTitle);\n\n        const closeBtn = document.createElement('button');\n        closeBtn.id = 'key-shortcut-close-btn';\n        closeBtn.textContent = 'x';\n        closeBtn.addEventListener('click', () => {\n            this.hide();\n        });\n\n        this.container.appendChild(closeBtn);\n\n        // create shortcuts container\n        this.shortcutsContainer = document.createElement('div');\n        this.shortcutsContainer.classList.add('keyboard-shortcuts-container');\n        this.shortcutsContainer.tabIndex = 30;\n        this.shortcutsContainer.addEventListener('keydown', (event: KeyboardEvent) => {\n            if (event.key === 'Escape' || matchesKeystroke(event, 'KeyH', 'alt')) {\n                this.hide();\n            }\n        });\n\n        this.container.appendChild(this.shortcutsContainer);\n        containerElement.appendChild(this.container);\n        containerElement.ariaLabel = 'Shortcut-Menu';\n\n        this.refreshUI();\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { Disposable, KeyListener, KeyTool } from '@eclipse-glsp/sprotty';\n\n@injectable()\nexport class GLSPKeyTool extends KeyTool {\n    registerListener(keyListener: KeyListener): Disposable {\n        super.register(keyListener);\n        return Disposable.create(() => this.deregister(keyListener));\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { Action, Disposable, DisposableCollection, IActionHandler, TYPES } from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\nimport { EditorContextService } from '../../base/editor-context-service';\nimport { IFeedbackActionDispatcher, IFeedbackEmitter } from '../../base/feedback/feedback-action-dispatcher';\nimport { EnableToolsAction, Tool } from '../../base/tool-manager/tool';\nimport { GLSPKeyTool } from '../../base/view/key-tool';\nimport { GLSPMouseTool } from '../../base/view/mouse-tool';\n\n/**\n *  A reusable base implementation for edit {@link Tool}s.\n */\n@injectable()\nexport abstract class BaseEditTool implements Tool {\n    @inject(TYPES.IFeedbackActionDispatcher) protected feedbackDispatcher: IFeedbackActionDispatcher;\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: GLSPActionDispatcher;\n    @inject(GLSPMouseTool) protected mouseTool: GLSPMouseTool;\n    @inject(GLSPKeyTool) protected keyTool: GLSPKeyTool;\n    @inject(EditorContextService) protected readonly editorContext: EditorContextService;\n\n    protected readonly toDisposeOnDisable = new DisposableCollection();\n\n    abstract enable(): void;\n\n    disable(): void {\n        this.toDisposeOnDisable.dispose();\n    }\n\n    abstract id: string;\n\n    get isEditTool(): boolean {\n        return true;\n    }\n\n    dispatchActions(actions: Action[]): void {\n        this.actionDispatcher.dispatchAll(actions);\n    }\n\n    /**\n     * Registers `actions` to be sent out as feedback, i.e., changes that are re-established whenever the `GModelRoot`\n     * has been set or updated.\n     *\n     * @param feedbackActions the actions to be sent out.\n     * @param feedbackEmitter the emitter sending out feedback actions (this tool by default).\n     * @param cleanupActions the actions to be sent out when the feedback is de-registered through the returned Disposable.\n     * @returns A 'Disposable' that de-registers the feedback and cleans up any pending feedback with the given `cleanupActions`.\n     */\n    registerFeedback(feedbackActions: Action[], feedbackEmitter?: IFeedbackEmitter, cleanupActions?: Action[]): Disposable {\n        return this.feedbackDispatcher.registerFeedback(feedbackEmitter ?? this, feedbackActions, cleanupActions);\n    }\n\n    /**\n     * De-registers all feedback from the given `feedbackEmitter` (this tool by default) and cleans up any pending feedback with the\n     * given `cleanupActions`.\n     *\n     * @param feedbackEmitter the emitter to be deregistered (this tool by default).\n     * @param cleanupActions the actions to be dispatched right after the deregistration to clean up any pending feedback.\n     */\n    deregisterFeedback(feedbackEmitter?: IFeedbackEmitter, cleanupActions?: Action[]): void {\n        this.feedbackDispatcher.deregisterFeedback(feedbackEmitter ?? this, cleanupActions);\n    }\n}\n\n@injectable()\nexport abstract class BaseCreationTool<T extends Action> extends BaseEditTool implements IActionHandler {\n    protected abstract isTriggerAction: (obj: any) => obj is T;\n    protected triggerAction: T;\n\n    handle(action: Action): Action | void {\n        if (this.isTriggerAction(action)) {\n            this.triggerAction = action;\n            return EnableToolsAction.create([this.id]);\n        }\n    }\n\n    override enable(): void {\n        if (this.triggerAction === undefined) {\n            throw new TypeError(`Could not enable tool ${this.id}. The triggerAction cannot be undefined.`);\n        }\n        this.doEnable();\n    }\n\n    protected abstract doEnable(): void;\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { Action, KeyListener, KeyTool, GModelElement, SetUIExtensionVisibilityAction, matchesKeystroke } from '@eclipse-glsp/sprotty';\nimport { BaseEditTool } from '../../tools/base-tools';\nimport { KeyShortcutUIExtension } from './accessible-key-shortcut';\n\n@injectable()\nexport class AccessibleKeyShortcutTool extends BaseEditTool {\n    static ID = 'accessible-key-shortcut-tool';\n\n    @inject(KeyTool) protected readonly keytool: KeyTool;\n\n    protected shortcutKeyListener = new AccessibleShortcutKeyListener();\n\n    get id(): string {\n        return AccessibleKeyShortcutTool.ID;\n    }\n\n    enable(): void {\n        this.keytool.register(this.shortcutKeyListener);\n    }\n\n    override disable(): void {\n        this.keytool.deregister(this.shortcutKeyListener);\n    }\n}\n\nexport class AccessibleShortcutKeyListener extends KeyListener {\n    protected readonly token = Symbol(AccessibleShortcutKeyListener.name);\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        if (this.matchesActivateShortcutHelpKeystroke(event)) {\n            return [SetUIExtensionVisibilityAction.create({ extensionId: KeyShortcutUIExtension.ID, visible: true })];\n        }\n        return [];\n    }\n\n    protected matchesActivateShortcutHelpKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'KeyH', 'alt');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject } from 'inversify';\nimport { AbstractUIExtension, Action, LabeledAction, GModelRoot, TYPES } from '@eclipse-glsp/sprotty';\nimport '../../../css/autocomplete-palette.css';\nimport { GLSPActionDispatcher } from '../action-dispatcher';\nimport { AutoCompleteWidget, CloseReason, toActionArray } from './auto-complete-widget';\n\n/**\n * A reusable base implementation for `UIExtensions` that want to provide autocomplete functionality\n * using the {@link AutoCompleteWidget}.\n *\n */\nexport abstract class BaseAutocompletePalette extends AbstractUIExtension {\n    protected readonly autoSuggestionSettings = {\n        noSuggestionsMessage: 'No suggestions available',\n        suggestionsClass: 'command-palette-suggestions',\n        debounceWaitMs: 50,\n        showOnFocus: true\n    };\n\n    protected root?: Readonly<GModelRoot>;\n    protected autocompleteWidget: AutoCompleteWidget;\n\n    @inject(TYPES.IActionDispatcher)\n    protected actionDispatcher: GLSPActionDispatcher;\n\n    containerClass(): string {\n        return 'autocomplete-palette';\n    }\n\n    override show(root: Readonly<GModelRoot>, ...contextElementIds: string[]): void {\n        super.show(root, ...contextElementIds);\n        this.root = root;\n        this.autocompleteWidget.open(root);\n    }\n\n    override hide(): void {\n        this.autocompleteWidget?.dispose();\n        this.root = undefined;\n        super.hide();\n    }\n\n    protected initializeContents(containerElement: HTMLElement): void {\n        containerElement.classList.add('command-palette');\n\n        this.autocompleteWidget = new AutoCompleteWidget(\n            this.autoSuggestionSettings,\n            { provideSuggestions: input => this.retrieveSuggestions(this.root!, input) },\n            { executeFromSuggestion: input => this.executeSuggestion(input) },\n            reason => this.autocompleteHide(reason),\n            this.logger,\n            {\n                visibleSuggestionsChanged: suggestions => this.visibleSuggestionsChanged(this.root!, suggestions),\n                selectedSuggestionChanged: suggestion => this.selectedSuggestionChanged(this.root!, suggestion)\n            }\n        );\n        this.autocompleteWidget.initialize(containerElement);\n    }\n\n    protected abstract retrieveSuggestions(root: Readonly<GModelRoot>, input: string): Promise<LabeledAction[]>;\n\n    protected async visibleSuggestionsChanged(root: Readonly<GModelRoot>, labeledActions: LabeledAction[]): Promise<void> {\n        return;\n    }\n\n    protected async selectedSuggestionChanged(root: Readonly<GModelRoot>, labeledAction?: LabeledAction): Promise<void> {\n        return;\n    }\n\n    protected autocompleteHide(reason: CloseReason): void {\n        this.hide();\n    }\n\n    protected executeSuggestion(input: LabeledAction | Action[] | Action): void {\n        this.actionDispatcher.dispatchAll(toActionArray(input));\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport { isEqual } from 'lodash';\nimport { toArray } from 'sprotty/lib/utils/iterable';\nimport {\n    Action,\n    CenterAction,\n    LabeledAction,\n    GModelElement,\n    GModelRoot,\n    GNode,\n    SelectAction,\n    SelectAllAction,\n    codiconCSSString,\n    isNameable,\n    name\n} from '@eclipse-glsp/sprotty';\nimport { BaseAutocompletePalette } from '../../../base/auto-complete/base-autocomplete-palette';\n\nimport { applyCssClasses, deleteCssClasses } from '../../../base/feedback/css-feedback';\nimport { RepositionAction } from '../../../features/viewport/reposition';\nimport { AutocompleteSuggestion, IAutocompleteSuggestionProvider } from '../../../base/auto-complete/autocomplete-suggestion-providers';\nimport { GEdge } from '../../../model';\n\nconst CSS_SEARCH_HIDDEN = 'search-hidden';\nconst CSS_SEARCH_HIGHLIGHTED = 'search-highlighted';\n\nexport class RevealNamedElementAutocompleteSuggestionProvider implements IAutocompleteSuggestionProvider {\n    async retrieveSuggestions(root: Readonly<GModelRoot>, text: string): Promise<AutocompleteSuggestion[]> {\n        const nameables = toArray(root.index.all().filter(element => isNameable(element)));\n        return nameables.map(nameable => ({\n            element: nameable,\n            action: {\n                label: `[${nameable.type}] ${name(nameable) ?? '<no-name>'}`,\n                actions: this.getActions(nameable),\n                icon: codiconCSSString('eye')\n            }\n        }));\n    }\n\n    protected getActions(nameable: GModelElement): Action[] {\n        return [SelectAction.create({ selectedElementsIDs: [nameable.id] }), CenterAction.create([nameable.id], { retainZoom: true })];\n    }\n}\nexport class RevealNodesWithoutNameAutocompleteSuggestionProvider implements IAutocompleteSuggestionProvider {\n    async retrieveSuggestions(root: Readonly<GModelRoot>, text: string): Promise<AutocompleteSuggestion[]> {\n        const nodes = toArray(root.index.all().filter(element => !isNameable(element) && element instanceof GNode));\n        return nodes.map(node => ({\n            element: node,\n            action: {\n                label: `[${node.type}]`,\n                actions: this.getActions(node),\n                icon: codiconCSSString('symbol-namespace')\n            }\n        }));\n    }\n\n    protected getActions(nameable: GModelElement): Action[] {\n        return [SelectAction.create({ selectedElementsIDs: [nameable.id] }), CenterAction.create([nameable.id], { retainZoom: true })];\n    }\n}\n\nexport class RevealEdgeElementAutocompleteSuggestionProvider implements IAutocompleteSuggestionProvider {\n    async retrieveSuggestions(root: Readonly<GModelRoot>, text: string): Promise<AutocompleteSuggestion[]> {\n        const edges = toArray(root.index.all().filter(element => element instanceof GEdge)) as GEdge[];\n        return edges.map(edge => ({\n            element: edge,\n            action: {\n                label: `[${edge.type}]  ${this.getEdgeLabel(root, edge)}`,\n                actions: this.getActions(edge),\n                icon: codiconCSSString('arrow-both')\n            }\n        }));\n    }\n\n    protected getActions(edge: GEdge): Action[] {\n        return [SelectAction.create({ selectedElementsIDs: [edge.id] }), CenterAction.create([edge.sourceId, edge.targetId])];\n    }\n    protected getEdgeLabel(root: Readonly<GModelRoot>, edge: GEdge): string {\n        let sourceName = '';\n        let targetName = '';\n\n        const sourceNode = root.index.getById(edge.sourceId);\n        const targetNode = root.index.getById(edge.targetId);\n\n        if (sourceNode !== undefined) {\n            sourceName = name(sourceNode) ?? sourceNode.type;\n        }\n        if (targetNode !== undefined) {\n            targetName = name(targetNode) ?? targetNode.type;\n        }\n\n        return sourceName + ' -> ' + targetName;\n    }\n}\n@injectable()\nexport class SearchAutocompletePalette extends BaseAutocompletePalette {\n    static readonly ID = 'search-autocomplete-palette';\n\n    protected cachedSuggestions: AutocompleteSuggestion[] = [];\n\n    id(): string {\n        return SearchAutocompletePalette.ID;\n    }\n\n    protected override initializeContents(containerElement: HTMLElement): void {\n        super.initializeContents(containerElement);\n\n        this.autocompleteWidget.inputField.placeholder = 'Search for elements';\n        containerElement.setAttribute('aria-label', 'Search Field');\n    }\n    protected getSuggestionProviders(root: Readonly<GModelRoot>, input: string): IAutocompleteSuggestionProvider[] {\n        return [\n            new RevealNamedElementAutocompleteSuggestionProvider(),\n            new RevealEdgeElementAutocompleteSuggestionProvider(),\n            new RevealNodesWithoutNameAutocompleteSuggestionProvider()\n        ];\n    }\n    protected async retrieveSuggestions(root: Readonly<GModelRoot>, input: string): Promise<LabeledAction[]> {\n        const providers = this.getSuggestionProviders(root, input);\n        const suggestions = (await Promise.all(providers.map(provider => provider.retrieveSuggestions(root, input)))).flat(1);\n\n        this.cachedSuggestions = suggestions;\n\n        return suggestions.map(s => s.action);\n    }\n\n    protected override async visibleSuggestionsChanged(root: Readonly<GModelRoot>, labeledActions: LabeledAction[]): Promise<void> {\n        await this.applyCSS(this.getHiddenElements(root, this.getSuggestionsFromLabeledActions(labeledActions)), CSS_SEARCH_HIDDEN);\n        await this.deleteCSS(\n            this.getSuggestionsFromLabeledActions(labeledActions).map(s => s.element),\n            CSS_SEARCH_HIDDEN\n        );\n    }\n\n    protected override async selectedSuggestionChanged(\n        root: Readonly<GModelRoot>,\n        labeledAction?: LabeledAction | undefined\n    ): Promise<void> {\n        await this.deleteAllCSS(root, CSS_SEARCH_HIGHLIGHTED);\n        if (labeledAction !== undefined) {\n            const suggestions = this.getSuggestionsFromLabeledActions([labeledAction]);\n\n            const actions: RepositionAction[] = [];\n            suggestions.map(currElem => actions.push(RepositionAction.create([currElem.element.id])));\n\n            this.actionDispatcher.dispatchAll(actions);\n            await this.applyCSS(\n                suggestions.map(s => s.element),\n                CSS_SEARCH_HIGHLIGHTED\n            );\n        }\n    }\n\n    public override show(root: Readonly<GModelRoot>, ...contextElementIds: string[]): void {\n        this.actionDispatcher.dispatch(SelectAllAction.create(false));\n\n        super.show(root, ...contextElementIds);\n    }\n\n    public override hide(): void {\n        if (this.root !== undefined) {\n            this.deleteAllCSS(this.root, CSS_SEARCH_HIDDEN);\n            this.deleteAllCSS(this.root, CSS_SEARCH_HIGHLIGHTED);\n            this.autocompleteWidget.inputField.value = '';\n        }\n\n        super.hide();\n    }\n\n    protected applyCSS(elements: GModelElement[], cssClass: string): Promise<void> {\n        const actions = elements.map(element => applyCssClasses(element, cssClass));\n        return this.actionDispatcher.dispatchAll(actions);\n    }\n\n    protected deleteCSS(elements: GModelElement[], cssClass: string): Promise<void> {\n        const actions = elements.map(element => deleteCssClasses(element, cssClass));\n        return this.actionDispatcher.dispatchAll(actions);\n    }\n\n    protected deleteAllCSS(root: Readonly<GModelRoot>, cssClass: string): Promise<void> {\n        const actions = toArray(root.index.all().map(element => deleteCssClasses(element, cssClass)));\n        return this.actionDispatcher.dispatchAll(actions);\n    }\n\n    protected getSuggestionsFromLabeledActions(labeledActions: LabeledAction[]): AutocompleteSuggestion[] {\n        return this.cachedSuggestions.filter(c => labeledActions.find(s => isEqual(s, c.action)));\n    }\n\n    protected getHiddenSuggestionsFromLabeledActions(labeledActions: LabeledAction[]): AutocompleteSuggestion[] {\n        return this.cachedSuggestions.filter(c => !labeledActions.find(s => isEqual(s, c.action)));\n    }\n\n    protected getHiddenElements(root: Readonly<GModelRoot>, suggestions: AutocompleteSuggestion[]): GModelElement[] {\n        return toArray(\n            root.index\n                .all()\n                .filter(element => element instanceof GNode || element instanceof GEdge)\n                .filter(element => suggestions.find(suggestion => suggestion.element.id === element.id) === undefined)\n        );\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport { Action, KeyListener, KeyTool, GModelElement, SetUIExtensionVisibilityAction, TYPES } from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../../base/action-dispatcher';\nimport { Tool } from '../../../base/tool-manager/tool';\nimport { AccessibleKeyShortcutProvider, SetAccessibleKeyShortcutAction } from '../key-shortcut/accessible-key-shortcut';\nimport { SearchAutocompletePalette } from './search-palette';\n@injectable()\nexport class SearchAutocompletePaletteTool implements Tool {\n    static readonly ID = 'glsp.search-autocomplete-palette-tool';\n\n    protected readonly keyListener = new SearchAutocompletePaletteKeyListener(this);\n    @inject(TYPES.IActionDispatcher) readonly actionDispatcher: GLSPActionDispatcher;\n    @inject(KeyTool) protected keyTool: KeyTool;\n\n    get id(): string {\n        return SearchAutocompletePaletteTool.ID;\n    }\n\n    enable(): void {\n        this.keyTool.register(this.keyListener);\n        this.keyListener.registerShortcutKey();\n    }\n\n    disable(): void {\n        this.keyTool.deregister(this.keyListener);\n    }\n}\n\nexport class SearchAutocompletePaletteKeyListener extends KeyListener implements AccessibleKeyShortcutProvider {\n    protected readonly token = SearchAutocompletePalette.name;\n\n    constructor(protected tool: SearchAutocompletePaletteTool) {\n        super();\n    }\n\n    registerShortcutKey(): void {\n        this.tool.actionDispatcher.dispatchOnceModelInitialized(\n            SetAccessibleKeyShortcutAction.create({\n                token: this.token,\n                keys: [{ shortcuts: ['CTRL', 'F'], description: 'Activate search for elements', group: 'Search', position: 0 }]\n            })\n        );\n    }\n\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        if (this.matchesSearchActivateKeystroke(event)) {\n            return [\n                SetUIExtensionVisibilityAction.create({\n                    extensionId: SearchAutocompletePalette.ID,\n                    visible: true\n                })\n            ];\n        }\n        return [];\n    }\n\n    protected matchesSearchActivateKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'KeyF', 'ctrl');\n    }\n}\n", "{\n    \"navigation\": {\n        \"default_navigation_mode_activated\": \"Navigation On: Use arrow keys to select preceding (\u2190) or succeding (\u2192) elements. Use the up (\u2191) and down (\u2193) arrows to navigate paths. Press 'N' to exit.\",\n        \"default_navigation_mode_deactivated\": \"Navigation Off: Press 'N' for default navigation, 'ALT+N' for position based navigation.\",\n        \"local_navigation_mode_activated\": \"Position based Nav On: Navigate nearest elements using arrow keys: (\u2191) for above, (\u2193) for below, (\u2190) for previous, (\u2192) for next element. Press 'ALT+N' to exit.\",\n        \"local_navigation_mode_deactivated\": \"Position based Nav Off: Press 'N' for default navigation, 'ALT+N' for position based navigation.\"\n    },\n    \"focus\": {\n        \"focus_on\": \"Currently focused: \",\n        \"focus_off\": \"Currently no element is focused.\"\n    },\n    \"resize\": {\n        \"resize_mode_activated\": \"Resize On: Use plus(+) and minus(-) to resize, 'CTRL'+'0' for default size. Press 'ESC' to exit.\",\n        \"resize_mode_deactivated\": \"Resize Off: Press 'ALT'+'A' for resize mode.\"\n    },\n    \"grid\": { \"zoom_in_grid\": \"Select a digit from 1-9 to zoom in on the respective box.\" },\n    \"tool_palette\": { \"marqueeTool\": \"Currently marquee tool is only usable with mouse.\" }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Action } from '@eclipse-glsp/sprotty';\n\nexport interface HideToastAction extends Action {\n    kind: typeof HideToastAction.KIND;\n    options: HideToastAction.Options;\n}\n\nexport namespace HideToastAction {\n    export const KIND = 'hideToastMessageAction';\n\n    export type Options = Pick<ToastOptions, 'id' | 'timeout'>;\n\n    export function is(object: any): object is HideToastAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(options: Options): HideToastAction {\n        return { kind: KIND, options };\n    }\n}\n\nexport interface ShowToastMessageAction extends Action {\n    kind: typeof ShowToastMessageAction.KIND;\n    options: ToastOptions;\n}\n\nexport namespace ShowToastMessageAction {\n    export const KIND = 'showToastMessageAction';\n    export const TIMEOUT = 2000;\n\n    export type CreateOptions = Partial<ToastOptions> & Required<Pick<ToastOptions, 'message'>>;\n\n    export function is(object: any): object is ShowToastMessageAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(options: CreateOptions): ShowToastMessageAction {\n        return { kind: KIND, options: { ...options, position: options.position ?? 'center', id: options.id ?? Symbol('toast id') } };\n    }\n    export function createWithTimeout(options: CreateOptions): ShowToastMessageAction {\n        return {\n            kind: KIND,\n            options: { timeout: TIMEOUT, ...options, position: options.position ?? 'center', id: options.id ?? Symbol('toast id') }\n        };\n    }\n}\n\nexport interface ToastOptions {\n    id: symbol;\n    timeout?: number;\n    position: 'left' | 'center' | 'right';\n    message: string;\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport {\n    Action,\n    GModelElement,\n    GModelRoot,\n    KeyListener,\n    KeyTool,\n    SelectAction,\n    Selectable,\n    TYPES,\n    findParentByFeature,\n    isBoundsAware,\n    isSelectable,\n    isSelected\n} from '@eclipse-glsp/sprotty';\nimport { inject, injectable } from 'inversify';\nimport { toArray } from 'sprotty/lib/utils/iterable';\nimport { matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport { GLSPActionDispatcher } from '../../../base/action-dispatcher';\nimport { EnableDefaultToolsAction, EnableToolsAction, Tool } from '../../../base/tool-manager/tool';\nimport { SelectableBoundsAware } from '../../../utils/gmodel-util';\nimport { RepositionAction } from '../../viewport/reposition';\nimport { SetAccessibleKeyShortcutAction } from '../key-shortcut/accessible-key-shortcut';\nimport { AccessibleKeyShortcutTool } from '../key-shortcut/accessible-key-shortcut-tool';\nimport { SearchAutocompletePaletteTool } from '../search/search-tool';\nimport * as messages from '../toast/messages.json';\nimport { ShowToastMessageAction } from '../toast/toast-handler';\nimport { ElementNavigator } from './element-navigator';\nimport { GEdge } from '../../../model';\n\n@injectable()\nexport class ElementNavigatorTool implements Tool {\n    static ID = 'glsp.diagram-navigation';\n\n    isEditTool = false;\n\n    protected elementNavigatorKeyListener: ElementNavigatorKeyListener = new ElementNavigatorKeyListener(this);\n    @inject(KeyTool) protected readonly keytool: KeyTool;\n    @inject(TYPES.IElementNavigator) readonly elementNavigator: ElementNavigator;\n    @inject(TYPES.ILocalElementNavigator) readonly localElementNavigator: ElementNavigator;\n    @inject(TYPES.IActionDispatcher) readonly actionDispatcher: GLSPActionDispatcher;\n\n    get id(): string {\n        return ElementNavigatorTool.ID;\n    }\n\n    enable(): void {\n        this.keytool.register(this.elementNavigatorKeyListener);\n        this.elementNavigatorKeyListener.registerShortcutKey();\n    }\n\n    disable(): void {\n        this.keytool.deregister(this.elementNavigatorKeyListener);\n    }\n}\n\nenum NavigationMode {\n    POSITION = 'position',\n    DEFAULT = 'default',\n    NONE = 'none'\n}\n\nexport class ElementNavigatorKeyListener extends KeyListener {\n    protected mode = NavigationMode.NONE;\n    protected previousNode?: SelectableBoundsAware;\n    protected navigator?: ElementNavigator;\n    protected readonly token = ElementNavigatorKeyListener.name;\n\n    constructor(protected readonly tool: ElementNavigatorTool) {\n        super();\n    }\n\n    registerShortcutKey(): void {\n        this.tool.actionDispatcher.dispatchOnceModelInitialized(\n            SetAccessibleKeyShortcutAction.create({\n                token: this.token,\n                keys: [\n                    { shortcuts: ['N'], description: 'Activate default navigation', group: 'Navigation', position: 0 },\n                    {\n                        shortcuts: ['ALT', 'N'],\n                        description: 'Activate position based navigation',\n                        group: 'Navigation',\n                        position: 1\n                    },\n                    {\n                        shortcuts: ['\u2B05  \u2B06  \u27A1  \u2B07'],\n                        description: 'Navigate by relation or neighbors according to navigation mode',\n                        group: 'Navigation',\n                        position: 2\n                    }\n                ]\n            })\n        );\n    }\n\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        this.resetOnEscape(event, element);\n\n        if (this.getSelectedElements(element.root).length > 0) {\n            if (!this.triggerPositionNavigationOnEvent(event, element)) {\n                this.triggerDefaultNavigationOnEvent(event, element);\n            }\n\n            return this.navigate(element, event);\n        }\n\n        this.resetPositionNavigationOnEvent(event, element);\n        this.resetDefaultNavigationOnEvent(event, element);\n\n        return [];\n    }\n    protected resetOnEscape(event: KeyboardEvent, element: GModelElement): void {\n        if (this.mode !== NavigationMode.NONE && this.matchesDeactivateNavigationMode(event)) {\n            this.navigator?.clean?.(element.root);\n            this.clean();\n\n            if (this.mode === NavigationMode.POSITION) {\n                this.tool.actionDispatcher.dispatchAll([\n                    EnableDefaultToolsAction.create(),\n                    ShowToastMessageAction.createWithTimeout({\n                        id: Symbol.for(ElementNavigatorKeyListener.name),\n                        message: messages.navigation.local_navigation_mode_deactivated\n                    })\n                ]);\n            } else if (this.mode === NavigationMode.DEFAULT) {\n                this.tool.actionDispatcher.dispatchAll([\n                    EnableDefaultToolsAction.create(),\n                    ShowToastMessageAction.createWithTimeout({\n                        id: Symbol.for(ElementNavigatorKeyListener.name),\n                        message: messages.navigation.default_navigation_mode_deactivated\n                    })\n                ]);\n            }\n\n            this.mode = NavigationMode.NONE;\n        }\n    }\n\n    protected triggerPositionNavigationOnEvent(event: KeyboardEvent, element: GModelElement): boolean {\n        if (this.matchesActivatePositionNavigation(event)) {\n            if (this.mode !== NavigationMode.POSITION) {\n                this.clean();\n                this.tool.actionDispatcher.dispatchAll([\n                    EnableToolsAction.create([ElementNavigatorTool.ID, SearchAutocompletePaletteTool.ID, AccessibleKeyShortcutTool.ID]),\n                    ShowToastMessageAction.create({\n                        id: Symbol.for(ElementNavigatorKeyListener.name),\n                        message: messages.navigation.local_navigation_mode_activated\n                    })\n                ]);\n                this.navigator = this.tool.elementNavigator;\n                this.mode = NavigationMode.POSITION;\n            } else {\n                this.resetPositionNavigationOnEvent(event, element);\n            }\n\n            return true;\n        }\n\n        return false;\n    }\n\n    protected resetPositionNavigationOnEvent(event: KeyboardEvent, element: GModelElement): void {\n        if (this.mode === NavigationMode.POSITION && this.matchesActivatePositionNavigation(event)) {\n            this.navigator?.clean?.(element.root);\n            this.clean();\n            this.mode = NavigationMode.NONE;\n            this.tool.actionDispatcher.dispatchAll([\n                EnableDefaultToolsAction.create(),\n                ShowToastMessageAction.createWithTimeout({\n                    id: Symbol.for(ElementNavigatorKeyListener.name),\n                    message: messages.navigation.local_navigation_mode_deactivated\n                })\n            ]);\n        }\n    }\n    protected triggerDefaultNavigationOnEvent(event: KeyboardEvent, element: GModelElement): boolean {\n        if (this.matchesActivateDefaultNavigation(event)) {\n            if (this.mode !== NavigationMode.DEFAULT) {\n                this.clean();\n\n                this.tool.actionDispatcher.dispatchAll([\n                    EnableToolsAction.create([ElementNavigatorTool.ID, SearchAutocompletePaletteTool.ID, AccessibleKeyShortcutTool.ID]),\n                    ShowToastMessageAction.create({\n                        id: Symbol.for(ElementNavigatorKeyListener.name),\n                        message: messages.navigation.default_navigation_mode_activated\n                    })\n                ]);\n                this.navigator = this.tool.localElementNavigator;\n                this.mode = NavigationMode.DEFAULT;\n            } else {\n                this.resetDefaultNavigationOnEvent(event, element);\n            }\n\n            return true;\n        }\n        return false;\n    }\n\n    protected resetDefaultNavigationOnEvent(event: KeyboardEvent, element: GModelElement): void {\n        if (this.mode === NavigationMode.DEFAULT && this.matchesActivateDefaultNavigation(event)) {\n            this.navigator?.clean?.(element.root);\n            this.clean();\n            this.mode = NavigationMode.NONE;\n            this.tool.actionDispatcher.dispatchAll([\n                EnableDefaultToolsAction.create(),\n                ShowToastMessageAction.createWithTimeout({\n                    id: Symbol.for(ElementNavigatorKeyListener.name),\n                    message: messages.navigation.default_navigation_mode_deactivated\n                })\n            ]);\n        }\n    }\n\n    protected navigate(element: GModelElement, event: KeyboardEvent): Action[] {\n        const selected = this.getSelectedElements(element.root);\n        const current = selected.length > 0 ? selected[0] : undefined;\n\n        if (this.mode !== NavigationMode.NONE && this.navigator !== undefined && current !== undefined && isBoundsAware(current)) {\n            this.navigator.clean?.(current.root, current, this.previousNode);\n\n            const target = this.navigateOnEvent(event, this.navigator, current);\n\n            if (target !== undefined) {\n                this.navigator.process?.(current.root, current, target as SelectableBoundsAware, this.previousNode);\n            }\n            const selectableTarget = target ? findParentByFeature(target, isSelectable) : undefined;\n\n            if (selectableTarget) {\n                if (!(current instanceof GEdge)) {\n                    this.previousNode = current;\n                }\n                const deselectedElementsIDs = selected.map(e => e.id).filter(id => id !== selectableTarget.id);\n\n                return [\n                    SelectAction.create({ selectedElementsIDs: [selectableTarget.id], deselectedElementsIDs }),\n                    RepositionAction.create([selectableTarget.id])\n                ];\n            }\n        }\n\n        return [];\n    }\n\n    protected navigateOnEvent(\n        event: KeyboardEvent,\n        navigator: ElementNavigator,\n        current: SelectableBoundsAware\n    ): GModelElement | undefined {\n        if (this.matchesNavigatePrevious(event)) {\n            return navigator.previous(current.root, current);\n        } else if (this.matchesNavigateNext(event)) {\n            return navigator.next(current.root, current);\n        } else if (this.matchesNavigateUp(event)) {\n            return navigator.up?.(current.root, current, this.previousNode);\n        } else if (this.matchesNavigateDown(event)) {\n            return navigator.down?.(current.root, current, this.previousNode);\n        }\n\n        return undefined;\n    }\n\n    protected clean(): void {\n        this.previousNode = undefined;\n        this.navigator = undefined;\n    }\n\n    protected getSelectedElements(root: GModelRoot): (GModelElement & Selectable)[] {\n        return toArray(root.index.all().filter(e => isSelected(e))) as (GModelElement & Selectable)[];\n    }\n\n    protected matchesDeactivateNavigationMode(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Escape');\n    }\n    protected matchesActivateDefaultNavigation(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'KeyN');\n    }\n    protected matchesActivatePositionNavigation(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'KeyN', 'alt');\n    }\n    protected matchesNavigatePrevious(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowLeft');\n    }\n    protected matchesNavigateNext(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowRight');\n    }\n    protected matchesNavigateUp(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowUp');\n    }\n    protected matchesNavigateDown(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowDown');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { TYPES, ViewerOptions } from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../../base/action-dispatcher';\nimport { Tool } from '../../../base/tool-manager/tool';\nimport * as messages from '../toast/messages.json';\nimport { ShowToastMessageAction } from '../toast/toast-handler';\n\n@injectable()\nexport class FocusTrackerTool implements Tool {\n    static ID = 'glsp.focus-tracker';\n\n    isEditTool = false;\n    @inject(TYPES.IActionDispatcher)\n    protected actionDispatcher: GLSPActionDispatcher;\n    @inject(TYPES.ViewerOptions)\n    protected readonly viewerOptions: ViewerOptions;\n\n    protected readonly focusInFunction = (event: FocusEvent): Promise<void> => this.focusIn(event);\n    protected readonly focusOutFunction = (event: FocusEvent): Promise<void> => this.focusOut(event);\n    protected registered = false;\n\n    get id(): string {\n        return FocusTrackerTool.ID;\n    }\n\n    enable(): void {\n        if (!this.registered) {\n            document.addEventListener('focusin', this.focusInFunction);\n            document.addEventListener('focusout', this.focusOutFunction);\n        }\n        this.registered = true;\n    }\n\n    disable(): void {\n        // the focus tracker cannot be disabled after enabling it\n    }\n\n    protected async focusOut(event: FocusEvent): Promise<void> {\n        await this.showToast('Focus not set');\n    }\n\n    protected async focusIn(event: FocusEvent): Promise<void> {\n        let message: string | undefined;\n        const target = event.target;\n\n        if (target instanceof HTMLElement) {\n            const parent = this.parentWithAriaLabel(target);\n            const textMessage = this.handleTextNode(target);\n            // eslint-disable-next-line no-null/no-null\n            if (target.ariaLabel !== null) {\n                message = this.handleAriaLabel(target);\n            } else {\n                if (parent === undefined && textMessage !== undefined) {\n                    message = textMessage;\n                } else if (parent !== undefined && textMessage === undefined) {\n                    message = `Focus is in ${parent.ariaLabel}`;\n                } else if (parent !== undefined && textMessage !== undefined) {\n                    message = `${parent.ariaLabel} -> ${textMessage}`;\n                }\n            }\n        }\n\n        await this.showToast(message);\n    }\n\n    protected handleTextNode(target: HTMLElement): string | undefined {\n        const textNode = Array.prototype.filter\n            .call(target.childNodes, element => element.nodeType === Node.TEXT_NODE)\n            .map(element => element.textContent)\n            .join('');\n\n        if (textNode.trim().length !== 0) {\n            return textNode;\n        }\n\n        return undefined;\n    }\n\n    protected handleAriaLabel(target: HTMLElement): string | undefined {\n        // eslint-disable-next-line no-null/no-null\n        return target.ariaLabel === null ? undefined : target.ariaLabel;\n    }\n\n    protected showToast(message?: string): Promise<void> {\n        return this.actionDispatcher.dispatchAll([\n            ShowToastMessageAction.create({\n                id: Symbol.for(FocusTrackerTool.ID),\n                message: `${messages.focus.focus_on} ${message ?? 'unknown'}`,\n                position: 'left'\n            })\n        ]);\n    }\n    protected parentWithAriaLabel(target: HTMLElement): HTMLElement | undefined {\n        let current = target.parentElement;\n\n        while (\n            // eslint-disable-next-line no-null/no-null\n            current !== null &&\n            current !== document.body &&\n            current !== document.getElementById(this.viewerOptions.baseDiv) &&\n            // eslint-disable-next-line no-null/no-null\n            current.ariaLabel === null\n        ) {\n            current = current.parentElement;\n        }\n\n        if (current === document.getElementById(this.viewerOptions.baseDiv) || current === document.body) {\n            return undefined;\n        }\n\n        return current ?? undefined;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    BoundsAware,\n    Dimension,\n    ElementAndBounds,\n    ElementMove,\n    ModelLayoutOptions,\n    Point,\n    GModelElement,\n    Writable\n} from '@eclipse-glsp/sprotty';\nimport { IMovementRestrictor } from '../features/change-bounds/movement-restrictor';\n\nexport function minWidth(element: GModelElement & BoundsAware): number {\n    const layoutOptions = getLayoutOptions(element);\n    if (layoutOptions !== undefined && typeof layoutOptions.minWidth === 'number') {\n        return layoutOptions.minWidth;\n    }\n    return 1;\n}\n\nexport function minHeight(element: GModelElement & BoundsAware): number {\n    const layoutOptions = getLayoutOptions(element);\n    if (layoutOptions !== undefined && typeof layoutOptions.minHeight === 'number') {\n        return layoutOptions.minHeight;\n    }\n    return 1;\n}\n\nexport function getLayoutOptions(element: GModelElement): ModelLayoutOptions | undefined {\n    const layoutOptions = (element as any).layoutOptions;\n    if (layoutOptions !== undefined) {\n        return layoutOptions as ModelLayoutOptions;\n    }\n    return undefined;\n}\n\nexport function isValidSize(element: GModelElement & BoundsAware, size: Dimension): boolean {\n    return size.width >= minWidth(element) && size.height >= minHeight(element);\n}\n\nexport function isValidMove(element: GModelElement & BoundsAware, newPosition?: Point, movementRestrictor?: IMovementRestrictor): boolean {\n    if (movementRestrictor) {\n        return movementRestrictor.validate(element, newPosition);\n    }\n    return true;\n}\n\nexport function toValidElementMove(\n    element: GModelElement & BoundsAware,\n    move: ElementMove,\n    movementRestrictor?: IMovementRestrictor\n): ElementMove | undefined {\n    if (!isValidMove(element, move.toPosition, movementRestrictor)) {\n        return;\n    }\n    return move;\n}\n\nexport function toValidElementAndBounds(\n    element: GModelElement & BoundsAware,\n    bounds: Writable<ElementAndBounds>,\n    movementRestrictor?: IMovementRestrictor\n): ElementAndBounds | undefined {\n    if (!isValidMove(element, bounds.newPosition, movementRestrictor)) {\n        return;\n    }\n    const elementMinWidth = minWidth(element);\n    if (bounds.newSize.width < elementMinWidth) {\n        bounds.newSize.width = elementMinWidth;\n    }\n    const elementMinHeight = minHeight(element);\n    if (bounds.newSize.height < elementMinHeight) {\n        bounds.newSize.height = elementMinHeight;\n    }\n    return bounds;\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { ISnapper, Point, GModelElement, Writable, findParentByFeature, isViewport } from '@eclipse-glsp/sprotty';\n\n/**\n * A {@link ISnapper} implementation that snaps all elements onto a fixed gride size.\n * The default grid size is 10x10 pixel.\n * To configure a custom grid size  bind the `TYPES.ISnapper` service identifier\n * to constant value, e.g:\n *\n * ```ts\n * bind(TYPES.ISnapper).toConstantValue(new GridSnapper({x:25 ,y:25 }));\n * ```\n */\n@injectable()\nexport class GridSnapper implements ISnapper {\n    constructor(public grid: { x: number; y: number } = { x: 10, y: 10 }) {}\n\n    snap(position: Point, element: GModelElement): Point {\n        return {\n            x: Math.round(position.x / this.grid.x) * this.grid.x,\n            y: Math.round(position.y / this.grid.y) * this.grid.y\n        };\n    }\n}\n\n/**\n * This class can be used to calculate the current position, when an element is\n * moved. This includes node movements, node resizing (resize handle movement)\n * or edge routing-point movements.\n *\n * You can initialize a this class with a optional {@link ISnapper}. If a\n * snapper is present, the positions will be snapped to the defined grid.\n */\nexport class PointPositionUpdater {\n    protected lastDragPosition?: Point;\n    protected positionDelta: Writable<Point> = { x: 0, y: 0 };\n\n    constructor(protected snapper?: ISnapper) {}\n\n    /**\n     * Init the position with the {@link Point} of your mouse cursor.\n     * This method is normally called in the `mouseDown` event.\n     * @param mousePosition current mouse position e.g `{x: event.pageX, y: event.pageY }`\n     */\n    public updateLastDragPosition(mousePosition: Point): void {\n        this.lastDragPosition = mousePosition;\n    }\n\n    /**\n     * Check if the mouse is currently not in a drag mode.\n     * @returns true if the last drag position is undefined\n     */\n    public isLastDragPositionUndefined(): boolean {\n        return this.lastDragPosition === undefined;\n    }\n\n    /**\n     * Reset the updater for new movements.\n     * This method is normally called in the `mouseUp` event.\n     */\n    public resetPosition(): void {\n        this.lastDragPosition = undefined;\n        this.positionDelta = { x: 0, y: 0 };\n    }\n\n    /**\n     * Calculate the current position of your movement.\n     * This method is normally called in the `mouseMove` event.\n     * @param target node which is moved around\n     * @param mousePosition current mouse position e.g `{x: event.pageX, y: event.pageY }`\n     * @param isSnapEnabled if a snapper is defined you can disable it, e.g when a specific key is pressed `!event.altKey`\n     * @returns current position or undefined if updater has no last drag position initialized\n     */\n    public updatePosition(target: GModelElement, mousePosition: Point, isSnapEnabled: boolean): Point | undefined {\n        if (this.lastDragPosition) {\n            const newDragPosition = mousePosition;\n\n            const viewport = findParentByFeature(target, isViewport);\n            const zoom = viewport?.zoom ?? 1;\n            const dx = (mousePosition.x - this.lastDragPosition.x) / zoom;\n            const dy = (mousePosition.y - this.lastDragPosition.y) / zoom;\n            const deltaToLastPosition = { x: dx, y: dy };\n            this.lastDragPosition = newDragPosition;\n\n            // update position delta with latest delta\n            this.positionDelta.x += deltaToLastPosition.x;\n            this.positionDelta.y += deltaToLastPosition.y;\n\n            // snap our delta and only send update if the position actually changes\n            // otherwise accumulate delta until we do snap to an update\n            const positionUpdate = this.snap(this.positionDelta, target, isSnapEnabled);\n            if (positionUpdate.x === 0 && positionUpdate.y === 0) {\n                return undefined;\n            }\n\n            // we update our position so we update our delta by the snapped position\n            this.positionDelta.x -= positionUpdate.x;\n            this.positionDelta.y -= positionUpdate.y;\n            return positionUpdate;\n        }\n        return undefined;\n    }\n\n    protected snap(position: Point, element: GModelElement, isSnap: boolean): Point {\n        return isSnap && this.snapper ? this.snapper.snap(position, element) : { x: position.x, y: position.y };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, optional } from 'inversify';\nimport {\n    Action,\n    ChangeBoundsOperation,\n    Dimension,\n    IActionDispatcher,\n    IActionHandler,\n    ICommand,\n    ISnapper,\n    Point,\n    GModelElement,\n    GParentElement,\n    TYPES\n} from '@eclipse-glsp/sprotty';\nimport { EditorContextService } from '../../../base/editor-context-service';\nimport { isValidMove, isValidSize, minHeight, minWidth } from '../../../utils/layout-utils';\nimport { SelectableBoundsAware, getElements, isSelectableAndBoundsAware, toElementAndBounds } from '../../../utils/gmodel-util';\nimport { Resizable } from '../../change-bounds/model';\nimport { GridSnapper } from '../../change-bounds/snap';\n\nexport enum ResizeType {\n    Increase,\n    Decrease,\n    MinSize\n}\n\n/**\n * Action for triggering resizing of elements.\n */\nexport interface ResizeElementAction extends Action {\n    kind: typeof ResizeElementAction.KIND;\n    elementIds: string[];\n    resizeType: ResizeType;\n}\nexport namespace ResizeElementAction {\n    export const KIND = 'resizeElementAction';\n\n    export function is(object: any): object is ResizeElementAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(elementIds: string[], resizeType: ResizeType): ResizeElementAction {\n        return { kind: KIND, elementIds, resizeType };\n    }\n}\n\n/* The ResizeElementHandler class is an implementation of the IActionHandler interface that handles\nresizing of elements. */\n@injectable()\nexport class ResizeElementHandler implements IActionHandler {\n    @inject(EditorContextService)\n    protected editorContextService: EditorContextService;\n\n    @inject(TYPES.IActionDispatcher) protected dispatcher: IActionDispatcher;\n\n    // Default x resize used if GridSnapper is not provided\n    static readonly defaultResizeX = 20;\n\n    // Default y resize used if GridSnapper is not provided\n    static readonly defaultResizeY = 20;\n    protected grid = { x: ResizeElementHandler.defaultResizeX, y: ResizeElementHandler.defaultResizeY };\n\n    protected isEditMode = false;\n\n    constructor(@inject(TYPES.ISnapper) @optional() protected readonly snapper?: ISnapper) {\n        if (snapper instanceof GridSnapper) {\n            this.grid = snapper.grid;\n        }\n    }\n\n    handle(action: Action): void | Action | ICommand {\n        if (ResizeElementAction.is(action)) {\n            this.handleResizeElement(action);\n        }\n    }\n\n    handleResizeElement(action: ResizeElementAction): void {\n        const elements = getElements(this.editorContextService.modelRoot.index, action.elementIds, isSelectableAndBoundsAware);\n        this.dispatcher.dispatchAll(this.resize(elements, action));\n    }\n\n    protected resize(elements: SelectableBoundsAware[], action: ResizeElementAction): Action[] {\n        const actions: Action[] = [];\n\n        elements.forEach(element => {\n            const { x, y, width: oldWidth, height: oldHeight } = element.bounds;\n            let width = 0;\n            let height = 0;\n\n            if (action.resizeType === ResizeType.Decrease) {\n                width = oldWidth - this.grid.x;\n                height = oldHeight - this.grid.y;\n            } else if (action.resizeType === ResizeType.Increase) {\n                width = oldWidth + this.grid.x;\n                height = oldHeight + this.grid.y;\n            } else if (action.resizeType === ResizeType.MinSize) {\n                width = minWidth(element);\n                height = minHeight(element);\n            }\n\n            if (this.isValidBoundChange(element, { x, y }, { width, height })) {\n                const resizeElement = { id: element.id, bounds: { x, y, width, height } } as GModelElement & GParentElement & Resizable;\n                actions.push(ChangeBoundsOperation.create([toElementAndBounds(resizeElement)]));\n            }\n        });\n\n        return actions;\n    }\n\n    protected isValidBoundChange(element: SelectableBoundsAware, newPosition: Point, newSize: Dimension): boolean {\n        return isValidSize(element, newSize) && isValidMove(element, newPosition);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, optional } from 'inversify';\nimport { matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport { Action, ISnapper, KeyListener, KeyTool, GModelElement, TYPES } from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../../base/action-dispatcher';\nimport { SelectionService } from '../../../base/selection-service';\nimport { EnableDefaultToolsAction, EnableToolsAction, Tool } from '../../../base/tool-manager/tool';\nimport { IMovementRestrictor } from '../../change-bounds/movement-restrictor';\nimport { AccessibleKeyShortcutProvider, SetAccessibleKeyShortcutAction } from '../key-shortcut/accessible-key-shortcut';\nimport * as messages from '../toast/messages.json';\nimport { ShowToastMessageAction } from '../toast/toast-handler';\nimport { ResizeElementAction, ResizeType } from './resize-key-handler';\n\n@injectable()\nexport class ResizeKeyTool implements Tool {\n    static ID = 'glsp.resize-key-tool';\n\n    isEditTool = true;\n\n    @inject(KeyTool) protected readonly keytool: KeyTool;\n    @inject(TYPES.IMovementRestrictor) @optional() readonly movementRestrictor?: IMovementRestrictor;\n    @inject(TYPES.ISnapper) @optional() readonly snapper?: ISnapper;\n    @inject(TYPES.IActionDispatcher) readonly actionDispatcher: GLSPActionDispatcher;\n    @inject(SelectionService) readonly selectionService: SelectionService;\n\n    protected resizeKeyListener: ResizeKeyListener = new ResizeKeyListener(this);\n\n    get id(): string {\n        return ResizeKeyTool.ID;\n    }\n\n    enable(): void {\n        this.keytool.register(this.resizeKeyListener);\n        this.resizeKeyListener.registerShortcutKey();\n    }\n\n    disable(): void {\n        this.keytool.deregister(this.resizeKeyListener);\n    }\n}\n@injectable()\nexport class ResizeKeyListener extends KeyListener implements AccessibleKeyShortcutProvider {\n    protected isEditMode = false;\n    protected readonly token = ResizeKeyListener.name;\n\n    constructor(protected readonly tool: ResizeKeyTool) {\n        super();\n    }\n\n    registerShortcutKey(): void {\n        this.tool.actionDispatcher.dispatchOnceModelInitialized(\n            SetAccessibleKeyShortcutAction.create({\n                token: this.token,\n                keys: [\n                    { shortcuts: ['ALT', 'A'], description: 'Activate resize mode for selected element', group: 'Resize', position: 0 },\n                    { shortcuts: ['+'], description: 'Increase size of element', group: 'Resize', position: 1 },\n                    { shortcuts: ['-'], description: 'Increase size of element', group: 'Resize', position: 2 },\n                    { shortcuts: ['CTRL', '0'], description: 'Set element size to default', group: 'Resize', position: 3 }\n                ]\n            })\n        );\n    }\n\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        const actions = [];\n        const selectedElementsIds = this.tool.selectionService.getSelectedElementIDs();\n\n        if (this.isEditMode && this.matchesDeactivateResizeModeKeystroke(event)) {\n            this.isEditMode = false;\n\n            this.tool.actionDispatcher.dispatch(\n                ShowToastMessageAction.createWithTimeout({\n                    id: Symbol.for(ResizeKeyListener.name),\n                    message: messages.resize.resize_mode_deactivated\n                })\n            );\n\n            actions.push(EnableDefaultToolsAction.create());\n        }\n\n        if (selectedElementsIds.length > 0) {\n            if (!this.isEditMode && this.matchesActivateResizeModeKeystroke(event)) {\n                this.isEditMode = true;\n                this.tool.actionDispatcher.dispatch(\n                    ShowToastMessageAction.create({\n                        id: Symbol.for(ResizeKeyListener.name),\n                        message: messages.resize.resize_mode_activated\n                    })\n                );\n                actions.push(EnableToolsAction.create([ResizeKeyTool.ID]));\n            }\n\n            if (this.isEditMode) {\n                if (this.matchesIncreaseSizeKeystroke(event)) {\n                    actions.push(ResizeElementAction.create(selectedElementsIds, ResizeType.Increase));\n                } else if (this.matchesDecreaseSizeKeystroke(event)) {\n                    actions.push(ResizeElementAction.create(selectedElementsIds, ResizeType.Decrease));\n                } else if (this.matchesMinSizeKeystroke(event)) {\n                    actions.push(ResizeElementAction.create(selectedElementsIds, ResizeType.MinSize));\n                }\n            }\n        }\n        return actions;\n    }\n\n    protected matchesIncreaseSizeKeystroke(event: KeyboardEvent): boolean {\n        /** here event.key is used for '+', as keycode 187 is already declared for 'Equals' in {@link matchesKeystroke}.*/\n        return event.key === '+' || matchesKeystroke(event, 'NumpadAdd');\n    }\n\n    protected matchesActivateResizeModeKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'KeyA', 'alt');\n    }\n\n    protected matchesDeactivateResizeModeKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Escape');\n    }\n\n    protected matchesMinSizeKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Digit0', 'ctrl') || matchesKeystroke(event, 'Numpad0', 'ctrl');\n    }\n\n    protected matchesDecreaseSizeKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Minus') || matchesKeystroke(event, 'NumpadSubtract');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from 'inversify';\nimport { Action, AbstractUIExtension, IActionHandler, ICommand, TYPES } from '@eclipse-glsp/sprotty';\nimport { IDiagramStartup } from '../../../base/model/diagram-loader';\nimport { GLSPActionDispatcher } from '../../../base/action-dispatcher';\nimport { EditorContextService } from '../../../base/editor-context-service';\nimport { HideToastAction, ShowToastMessageAction, ToastOptions } from './toast-handler';\n\n/**\n * This extension is used to create customized user notifications as toast messages.\n */\n@injectable()\nexport class Toast extends AbstractUIExtension implements IActionHandler, IDiagramStartup {\n    static readonly ID = 'toast';\n    protected messages: { [key: symbol]: ToastOptions } = {};\n\n    @inject(TYPES.IActionDispatcher) protected readonly actionDispatcher: GLSPActionDispatcher;\n    @inject(EditorContextService)\n    protected editorContext: EditorContextService;\n\n    id(): string {\n        return Toast.ID;\n    }\n    containerClass(): string {\n        return Toast.ID;\n    }\n\n    protected initializeContents(_containerElement: HTMLElement): void {\n        this.render();\n    }\n\n    handle(action: Action): ICommand | Action | void {\n        if (ShowToastMessageAction.is(action)) {\n            this.messages[action.options.id] = action.options;\n            this.render();\n\n            if (action.options.timeout) {\n                setTimeout(() => {\n                    this.delete(action.options.id);\n                }, action.options.timeout);\n            }\n        } else if (HideToastAction.is(action)) {\n            if (action.options.timeout) {\n                setTimeout(() => {\n                    this.delete(action.options.id);\n                }, action.options.timeout);\n            } else {\n                this.delete(action.options.id);\n            }\n        }\n    }\n\n    protected render(): void {\n        if (this.containerElement === undefined) {\n            return;\n        }\n\n        this.containerElement.innerHTML = '';\n\n        this.values(this.messages).forEach(message => {\n            this.containerElement.appendChild(this.createToastMessage(message));\n        });\n    }\n\n    protected delete(id: symbol): void {\n        delete this.messages[id];\n        this.render();\n    }\n\n    protected createToastMessage(option: ToastOptions): HTMLDivElement {\n        const cell = document.createElement('div');\n        cell.classList.add('toast-cell', `toast-column-${option.position}`);\n\n        const container = document.createElement('div');\n        container.classList.add('toast-container');\n\n        const text = document.createElement('span');\n        text.textContent = option.message;\n\n        container.appendChild(text);\n        cell.appendChild(container);\n\n        return cell;\n    }\n\n    preInitialize(): void {\n        this.show(this.editorContext.modelRoot);\n    }\n\n    values(obj: { [key: symbol]: ToastOptions }): ToastOptions[] {\n        return Object.getOwnPropertySymbols(obj).map(s => obj[s]);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    BoundsAware,\n    GChildElement,\n    Hoverable,\n    Locateable,\n    GModelElement,\n    GParentElement,\n    Selectable,\n    hoverFeedbackFeature,\n    isBoundsAware,\n    isMoveable,\n    isSelectable\n} from '@eclipse-glsp/sprotty';\n\nexport const resizeFeature = Symbol('resizeFeature');\n\nexport interface Resizable extends BoundsAware, Selectable {}\n\nexport function isResizable(element: GModelElement): element is GParentElement & Resizable {\n    return isBoundsAware(element) && isSelectable(element) && element instanceof GParentElement && element.hasFeature(resizeFeature);\n}\n\n// eslint-disable-next-line no-shadow\nexport enum ResizeHandleLocation {\n    TopLeft = 'top-left',\n    TopRight = 'top-right',\n    BottomLeft = 'bottom-left',\n    BottomRight = 'bottom-right'\n}\n\nexport function isBoundsAwareMoveable(element: GModelElement): element is GModelElement & Locateable & BoundsAware {\n    return isMoveable(element) && isBoundsAware(element);\n}\n\nexport class SResizeHandle extends GChildElement implements Hoverable {\n    static readonly TYPE = 'resize-handle';\n\n    constructor(\n        readonly location?: ResizeHandleLocation,\n        override readonly type: string = SResizeHandle.TYPE,\n        readonly hoverFeedback: boolean = false\n    ) {\n        super();\n    }\n\n    override hasFeature(feature: symbol): boolean {\n        return feature === hoverFeedbackFeature;\n    }\n\n    isNwSeResize(): boolean {\n        return this.location === ResizeHandleLocation.TopLeft || this.location === ResizeHandleLocation.BottomRight;\n    }\n\n    isNeSwResize(): boolean {\n        return this.location === ResizeHandleLocation.TopRight || this.location === ResizeHandleLocation.BottomLeft;\n    }\n}\n\nexport function addResizeHandles(element: GParentElement): void {\n    removeResizeHandles(element);\n    element.add(new SResizeHandle(ResizeHandleLocation.TopLeft));\n    element.add(new SResizeHandle(ResizeHandleLocation.TopRight));\n    element.add(new SResizeHandle(ResizeHandleLocation.BottomLeft));\n    element.add(new SResizeHandle(ResizeHandleLocation.BottomRight));\n}\n\nexport function removeResizeHandles(element: GParentElement): void {\n    element.removeAll(child => child instanceof SResizeHandle);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { toArray } from 'sprotty/lib/utils/iterable';\nimport { matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport {\n    Action,\n    KeyListener,\n    KeyTool,\n    GModelElement,\n    GRoutableElement,\n    SelectAction,\n    SwitchEditModeAction,\n    isSelectable\n} from '@eclipse-glsp/sprotty';\nimport { Tool } from '../../../base/tool-manager/tool';\nimport { SResizeHandle } from '../../change-bounds/model';\n\n/**\n * Deselects the element if there is no interaction possible with element.\n */\n@injectable()\nexport class DeselectKeyTool implements Tool {\n    static ID = 'glsp.deselect-key-tool';\n\n    isEditTool = true;\n\n    protected readonly deselectKeyListener = new DeselectKeyListener();\n\n    @inject(KeyTool) protected readonly keytool: KeyTool;\n\n    get id(): string {\n        return DeselectKeyTool.ID;\n    }\n\n    enable(): void {\n        this.keytool.register(this.deselectKeyListener);\n    }\n\n    disable(): void {\n        this.keytool.deregister(this.deselectKeyListener);\n    }\n}\n\nexport class DeselectKeyListener extends KeyListener {\n    override keyDown(target: GModelElement, event: KeyboardEvent): Action[] {\n        if (this.matchesDeselectKeystroke(event)) {\n            const isResizeHandleActive = toArray(target.root.index.all().filter(el => el instanceof SResizeHandle)).length > 0;\n\n            if (isResizeHandleActive) {\n                return [];\n            }\n\n            const deselect = toArray(target.root.index.all().filter(element => isSelectable(element) && element.selected));\n            const actions: Action[] = [];\n\n            if (deselect.length > 0) {\n                actions.push(SelectAction.create({ deselectedElementsIDs: deselect.map(e => e.id) }));\n            }\n\n            const routableDeselect = deselect.filter(e => e instanceof GRoutableElement).map(e => e.id);\n            if (routableDeselect.length > 0) {\n                actions.push(SwitchEditModeAction.create({ elementsToDeactivate: routableDeselect }));\n            }\n\n            return actions;\n        }\n        return [];\n    }\n\n    protected matchesDeselectKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Escape');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { throttle } from 'lodash';\nimport {\n    Action,\n    ChangeBoundsOperation,\n    IActionDispatcher,\n    IActionHandler,\n    ICommand,\n    Point,\n    GModelRoot,\n    SetViewportAction,\n    TYPES,\n    Viewport,\n    findParentByFeature,\n    isViewport\n} from '@eclipse-glsp/sprotty';\nimport { EditorContextService } from '../../../base/editor-context-service';\nimport { SelectableBoundsAware, getElements, isSelectableAndBoundsAware } from '../../../utils/gmodel-util';\n\n/**\n * Action for triggering moving of the viewport.\n */\nexport interface MoveViewportAction extends Action {\n    kind: typeof MoveViewportAction.KIND;\n    /**\n     * used to specify the amount to be moved in the x-axis\n     */\n    moveX: number;\n    /**\n     * used to specify the amount to be moved in the y-axis\n     */\n    moveY: number;\n}\n\nexport namespace MoveViewportAction {\n    export const KIND = 'moveViewportAction';\n\n    export function is(object: any): object is MoveViewportAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(moveX: number, moveY: number): MoveViewportAction {\n        return { kind: KIND, moveX, moveY };\n    }\n}\n\n/**\n * Action for triggering moving of elements.\n */\nexport interface MoveElementAction extends Action {\n    kind: typeof MoveElementAction.KIND;\n    /**\n     * used to specify the elements to be zoomed in/out\n     */\n    elementIds: string[];\n    /**\n     * used to specify the amount to be moved in the x-axis\n     */\n    moveX: number;\n    /**\n     * used to specify the amount to be moved in the y-axis\n     */\n    moveY: number;\n}\n\nexport namespace MoveElementAction {\n    export const KIND = 'moveElementAction';\n\n    export function is(object: any): object is MoveElementAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(elementIds: string[], moveX: number, moveY: number): MoveElementAction {\n        return { kind: KIND, elementIds, moveX, moveY };\n    }\n}\n\n/* The MoveViewportHandler class is an implementation of the IActionHandler interface that handles\nmoving of the viewport. */\n@injectable()\nexport class MoveViewportHandler implements IActionHandler {\n    @inject(EditorContextService)\n    protected editorContextService: EditorContextService;\n\n    @inject(TYPES.IActionDispatcher) protected dispatcher: IActionDispatcher;\n    protected readonly throttledHandleViewportMove = throttle((action: MoveViewportAction) => this.handleMoveViewport(action), 150);\n\n    handle(action: Action): void | Action | ICommand {\n        if (MoveViewportAction.is(action)) {\n            this.throttledHandleViewportMove(action);\n        }\n    }\n\n    handleMoveViewport(action: MoveViewportAction): void {\n        const viewport = findParentByFeature(this.editorContextService.modelRoot, isViewport);\n        if (!viewport) {\n            return;\n        }\n        this.dispatcher.dispatch(this.moveViewport(viewport, action.moveX, action.moveY));\n    }\n\n    protected moveViewport(viewport: GModelRoot & Viewport, offsetX: number, offSetY: number): SetViewportAction {\n        const newViewport: Viewport = {\n            scroll: {\n                x: viewport.scroll.x + offsetX,\n                y: viewport.scroll.y + offSetY\n            },\n            zoom: viewport.zoom\n        };\n\n        return SetViewportAction.create(viewport.id, newViewport, { animate: true });\n    }\n}\n\n/* The MoveElementHandler class is an implementation of the IActionHandler interface that handles\nmoving elements. */\n@injectable()\nexport class MoveElementHandler implements IActionHandler {\n    @inject(EditorContextService)\n    protected editorContextService: EditorContextService;\n    @inject(TYPES.IActionDispatcher) protected dispatcher: IActionDispatcher;\n    protected readonly throttledHandleElementMove = throttle((action: MoveElementAction) => this.handleMoveElement(action), 150);\n\n    handle(action: Action): void | Action | ICommand {\n        if (MoveElementAction.is(action)) {\n            this.throttledHandleElementMove(action);\n        }\n    }\n\n    handleMoveElement(action: MoveElementAction): void {\n        const viewport = findParentByFeature(this.editorContextService.modelRoot, isViewport);\n        if (!viewport) {\n            return;\n        }\n\n        const elements = getElements(this.editorContextService.modelRoot.index, action.elementIds, isSelectableAndBoundsAware);\n\n        this.dispatcher.dispatchAll(this.move(viewport, elements, action.moveX, action.moveY));\n    }\n\n    protected getBounds(element: SelectableBoundsAware, offSetX: number, offSetY: number): Point {\n        return { x: element.bounds.x + offSetX, y: element.bounds.y + offSetY };\n    }\n\n    protected adaptViewport(\n        viewport: GModelRoot & Viewport,\n        newPoint: Point,\n        moveX: number,\n        moveY: number\n    ): MoveViewportAction | undefined {\n        if (\n            newPoint.x < viewport.scroll.x ||\n            newPoint.x > viewport.scroll.x + viewport.canvasBounds.width ||\n            newPoint.y < viewport.scroll.y ||\n            newPoint.y > viewport.scroll.y + viewport.canvasBounds.height\n        ) {\n            return MoveViewportAction.create(moveX, moveY);\n        }\n        return;\n    }\n\n    protected moveElement(element: SelectableBoundsAware, offSetX: number, offSetY: number): ChangeBoundsOperation {\n        return ChangeBoundsOperation.create([\n            {\n                elementId: element.id,\n                newSize: {\n                    width: element.bounds.width,\n                    height: element.bounds.height\n                },\n                newPosition: {\n                    x: element.bounds.x + offSetX,\n                    y: element.bounds.y + offSetY\n                }\n            }\n        ]);\n    }\n\n    protected move(viewport: GModelRoot & Viewport, selectedElements: SelectableBoundsAware[], deltaX: number, deltaY: number): Action[] {\n        const results: Action[] = [];\n\n        if (selectedElements.length !== 0) {\n            selectedElements.forEach(currentElement => {\n                results.push(this.moveElement(currentElement, deltaX, deltaY));\n                const newPosition = this.getBounds(currentElement, deltaX, deltaY);\n                const viewportAction = this.adaptViewport(viewport, newPosition, deltaX, deltaY);\n                if (viewportAction) {\n                    results.push(viewportAction);\n                }\n            });\n        }\n        return results;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, optional } from 'inversify';\nimport { matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport { Action, ISnapper, KeyListener, KeyTool, GModelElement, TYPES } from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../../base/action-dispatcher';\nimport { SelectionService } from '../../../base/selection-service';\nimport { Tool } from '../../../base/tool-manager/tool';\nimport { GridSnapper } from '../../change-bounds/snap';\nimport { AccessibleKeyShortcutProvider, SetAccessibleKeyShortcutAction } from '../key-shortcut/accessible-key-shortcut';\nimport { MoveElementAction, MoveViewportAction } from '../move-zoom/move-handler';\n\n/**\n * Moves viewport and elements when its focused and arrow keys are hit.\n */\n@injectable()\nexport class MovementKeyTool implements Tool {\n    static ID = 'glsp.movement-key-tool';\n\n    isEditTool = true;\n\n    protected readonly movementKeyListener = new MoveKeyListener(this);\n\n    @inject(KeyTool) protected readonly keytool: KeyTool;\n    @inject(SelectionService) selectionService: SelectionService;\n    @inject(TYPES.ISnapper) @optional() readonly snapper?: ISnapper;\n    @inject(TYPES.IActionDispatcher) readonly actionDispatcher: GLSPActionDispatcher;\n\n    get id(): string {\n        return MovementKeyTool.ID;\n    }\n\n    enable(): void {\n        this.keytool.register(this.movementKeyListener);\n        this.movementKeyListener.registerShortcutKey();\n    }\n\n    disable(): void {\n        this.keytool.deregister(this.movementKeyListener);\n    }\n}\n\nexport class MoveKeyListener extends KeyListener implements AccessibleKeyShortcutProvider {\n    // Default x distance used if GridSnapper is not provided\n    static readonly defaultMoveX = 20;\n\n    // Default y distance used if GridSnapper is not provided\n    static readonly defaultMoveY = 20;\n\n    protected readonly token = MoveKeyListener.name;\n\n    protected grid = { x: MoveKeyListener.defaultMoveX, y: MoveKeyListener.defaultMoveY };\n\n    constructor(protected readonly tool: MovementKeyTool) {\n        super();\n\n        if (this.tool.snapper instanceof GridSnapper) {\n            this.grid = this.tool.snapper.grid;\n        }\n    }\n\n    registerShortcutKey(): void {\n        this.tool.actionDispatcher.dispatchOnceModelInitialized(\n            SetAccessibleKeyShortcutAction.create({\n                token: this.token,\n                keys: [{ shortcuts: ['\u2B05  \u2B06  \u27A1  \u2B07'], description: 'Move element or viewport', group: 'Move', position: 0 }]\n            })\n        );\n    }\n\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        const selectedElementIds = this.tool.selectionService.getSelectedElementIDs();\n\n        if (selectedElementIds.length > 0) {\n            if (this.matchesMoveUpKeystroke(event)) {\n                return [MoveElementAction.create(selectedElementIds, 0, -this.grid.x)];\n            } else if (this.matchesMoveDownKeystroke(event)) {\n                return [MoveElementAction.create(selectedElementIds, 0, this.grid.x)];\n            } else if (this.matchesMoveRightKeystroke(event)) {\n                return [MoveElementAction.create(selectedElementIds, this.grid.x, 0)];\n            } else if (this.matchesMoveLeftKeystroke(event)) {\n                return [MoveElementAction.create(selectedElementIds, -this.grid.x, 0)];\n            }\n        } else {\n            if (this.matchesMoveUpKeystroke(event)) {\n                return [MoveViewportAction.create(0, -this.grid.x)];\n            } else if (this.matchesMoveDownKeystroke(event)) {\n                return [MoveViewportAction.create(0, this.grid.x)];\n            } else if (this.matchesMoveRightKeystroke(event)) {\n                return [MoveViewportAction.create(this.grid.x, 0)];\n            } else if (this.matchesMoveLeftKeystroke(event)) {\n                return [MoveViewportAction.create(-this.grid.x, 0)];\n            }\n        }\n        return [];\n    }\n\n    protected matchesMoveUpKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowUp');\n    }\n\n    protected matchesMoveDownKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowDown');\n    }\n\n    protected matchesMoveRightKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowRight');\n    }\n\n    protected matchesMoveLeftKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowLeft');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { throttle } from 'lodash';\nimport {\n    Action,\n    Bounds,\n    GChildElement,\n    IActionDispatcher,\n    IActionHandler,\n    ICommand,\n    Point,\n    GModelElement,\n    GModelRoot,\n    SetViewportAction,\n    TYPES,\n    Viewport,\n    findParentByFeature,\n    isViewport\n} from '@eclipse-glsp/sprotty';\nimport { EditorContextService } from '../../../base/editor-context-service';\nimport { SelectableBoundsAware, getElements, isSelectableAndBoundsAware } from '../../../utils/gmodel-util';\n\n/**\n * Action for triggering zooming of the viewport.\n */\nexport interface ZoomViewportAction extends Action {\n    kind: typeof ZoomViewportAction.KIND;\n    /**\n     * used to specify the amount by which the viewport should be zoomed\n     */\n    zoomFactor: number;\n}\n\nexport namespace ZoomViewportAction {\n    export const KIND = 'zoomViewportAction';\n\n    export function is(object: any): object is ZoomViewportAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(zoomFactor: number): ZoomViewportAction {\n        return { kind: KIND, zoomFactor };\n    }\n}\n\n/**\n * Action for triggering zooming of the elements..\n */\nexport interface ZoomElementAction extends Action {\n    kind: typeof ZoomElementAction.KIND;\n    /**\n     * used to specify the elements to be zoomed in/out\n     */\n    elementIds: string[];\n    /**\n     * used to specify the amount by which the viewport should be zoomed\n     */\n    zoomFactor: number;\n}\n\nexport namespace ZoomElementAction {\n    export const KIND = 'zoomElementAction';\n\n    export function is(object: any): object is ZoomElementAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(elementIds: string[], zoomFactor: number): ZoomElementAction {\n        return { kind: KIND, elementIds, zoomFactor };\n    }\n}\n\n/* The ZoomViewportHandler class is an implementation of the IActionHandler interface that handles\nzooming in and out of a viewport. */\n@injectable()\nexport class ZoomViewportHandler implements IActionHandler {\n    @inject(EditorContextService)\n    protected editorContextService: EditorContextService;\n\n    static readonly defaultZoomInFactor = 1.1;\n    static readonly defaultZoomOutFactor = 0.9;\n\n    @inject(TYPES.IActionDispatcher) protected dispatcher: IActionDispatcher;\n    protected readonly throttledHandleViewportZoom = throttle((action: ZoomViewportAction) => this.handleZoomViewport(action), 150);\n\n    handle(action: Action): void {\n        if (ZoomViewportAction.is(action)) {\n            this.throttledHandleViewportZoom(action);\n        }\n    }\n\n    handleZoomViewport(action: ZoomViewportAction): void {\n        const viewport = findParentByFeature(this.editorContextService.modelRoot, isViewport);\n        if (!viewport) {\n            return;\n        }\n        this.dispatcher.dispatch(this.setNewZoomFactor(viewport, action.zoomFactor));\n    }\n\n    protected setNewZoomFactor(viewport: GModelRoot & Viewport, zoomFactor: number): SetViewportAction {\n        const newZoom = viewport.zoom * zoomFactor;\n\n        const newViewport = {\n            scroll: viewport.scroll,\n            zoom: newZoom\n        };\n\n        return SetViewportAction.create(viewport.id, newViewport, { animate: true });\n    }\n}\n\n/* The ZoomElementHandler class is an implementation of the IActionHandler interface that handles\nzooming in and out of elements. */\n@injectable()\nexport class ZoomElementHandler implements IActionHandler {\n    @inject(EditorContextService)\n    protected editorContextService: EditorContextService;\n    @inject(TYPES.IActionDispatcher) protected dispatcher: IActionDispatcher;\n    protected readonly throttledHandleElementZoom = throttle((action: ZoomElementAction) => this.handleZoomElement(action), 150);\n\n    handle(action: Action): void | Action | ICommand {\n        if (ZoomElementAction.is(action)) {\n            this.throttledHandleElementZoom(action);\n        }\n    }\n\n    handleZoomElement(action: ZoomElementAction): void {\n        const viewport = findParentByFeature(this.editorContextService.modelRoot, isViewport);\n        if (!viewport) {\n            return;\n        }\n\n        const elements = getElements(this.editorContextService.modelRoot.index, action.elementIds, isSelectableAndBoundsAware);\n        const center = this.getCenter(viewport, elements);\n        this.dispatcher.dispatch(this.setNewZoomFactor(viewport, action.zoomFactor, center));\n    }\n\n    protected getCenter(viewport: GModelRoot & Viewport, selectedElements: SelectableBoundsAware[]): Point {\n        // Get bounds of elements based on the viewport\n        const allBounds = selectedElements.map(e => this.boundsInViewport(viewport, e, e.bounds));\n        const mergedBounds = allBounds.reduce((b0, b1) => Bounds.combine(b0, b1));\n        return Bounds.center(mergedBounds);\n    }\n\n    // copy from center-fit.ts, translates the children bounds to the viewport bounds\n    protected boundsInViewport(viewport: GModelRoot & Viewport, element: GModelElement, bounds: Bounds): Bounds {\n        if (element instanceof GChildElement && element.parent !== viewport) {\n            return this.boundsInViewport(viewport, element.parent, element.parent.localToParent(bounds) as Bounds);\n        } else {\n            return bounds;\n        }\n    }\n\n    protected setNewZoomFactor(viewport: GModelRoot & Viewport, zoomFactor: number, point: Point): SetViewportAction {\n        const newZoom = viewport.zoom * zoomFactor;\n\n        const newViewport = {\n            scroll: {\n                x: point.x - (0.5 * viewport.canvasBounds.width) / newZoom,\n                y: point.y - (0.5 * viewport.canvasBounds.height) / newZoom\n            },\n            zoom: newZoom\n        };\n\n        return SetViewportAction.create(viewport.id, newViewport, { animate: true });\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Action, hasObjectProp, Point } from '@eclipse-glsp/sprotty';\n\nexport interface EnableKeyboardGridAction extends Action {\n    kind: typeof EnableKeyboardGridAction.KIND;\n    options: EnableKeyboardGridAction.Options;\n}\n\nexport namespace EnableKeyboardGridAction {\n    export const KIND = 'enableKeyboardGrid';\n\n    export interface Options {\n        originId: string;\n        triggerActions: Action[];\n    }\n\n    export function is(object: any): object is EnableKeyboardGridAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'options');\n    }\n\n    export function create(options: Options): EnableKeyboardGridAction {\n        return {\n            kind: KIND,\n            options\n        };\n    }\n}\n\nexport interface KeyboardGridCellSelectedAction extends Action {\n    kind: typeof KeyboardGridCellSelectedAction.KIND;\n    options: KeyboardGridCellSelectedAction.Options;\n}\n\nexport namespace KeyboardGridCellSelectedAction {\n    export const KIND = 'keyboardGridCellSelectedAction';\n\n    export interface Options {\n        originId: string;\n        cellId: string;\n        centerCellPosition: Point;\n    }\n\n    export function is(object: any): object is KeyboardGridCellSelectedAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'options');\n    }\n\n    export function create(options: Options): KeyboardGridCellSelectedAction {\n        return {\n            kind: KIND,\n            options\n        };\n    }\n}\n\nexport interface KeyboardGridKeyboardEventAction extends Action {\n    kind: typeof KeyboardGridKeyboardEventAction.KIND;\n    options: KeyboardGridKeyboardEventAction.Options;\n}\n\nexport namespace KeyboardGridKeyboardEventAction {\n    export const KIND = 'keyboardGridKeyboardEvent';\n\n    export interface Options {\n        originId: string;\n        event: KeyboardEvent;\n    }\n\n    export function is(object: any): object is KeyboardGridKeyboardEventAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'options');\n    }\n\n    export function create(options: Options): KeyboardGridKeyboardEventAction {\n        return {\n            kind: KIND,\n            options\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport {\n    Bounds,\n    BoundsAware,\n    Dimension,\n    GChildElement,\n    Point,\n    GModelElement,\n    Viewport,\n    findParentByFeature,\n    isAlignable,\n    isBoundsAware,\n    isViewport,\n    translateBounds\n} from '@eclipse-glsp/sprotty';\nimport { BoundsAwareModelElement } from './gmodel-util';\n\n/**\n * Return the position corresponding to this mouse event (Browser coordinates)\n * in the diagram coordinates system (i.e. relative to the Diagram's 0;0 point)\n *\n * This functions takes into account the following transformations:\n * - Location of the Diagram Canvas inside of the browser's page\n * - Current viewport Scroll and Zoom\n *\n * @param target\n *  An element from the diagram\n * @param mouseEvent\n *  A mouseEvent\n */\nexport function getAbsolutePosition(target: GModelElement, mouseEvent: MouseEvent): Point {\n    return getAbsolutePositionByPoint(target, { x: mouseEvent.pageX, y: mouseEvent.pageY });\n}\nexport function getAbsolutePositionByPoint(target: GModelElement, point: Point): Point {\n    let xPos = point.x;\n    let yPos = point.y;\n    const canvasBounds = target.root.canvasBounds;\n    xPos -= canvasBounds.x;\n    yPos -= canvasBounds.y;\n\n    const viewport: Viewport | undefined = findParentByFeature(target, isViewport);\n    const zoom = viewport ? viewport.zoom : 1;\n    if (viewport) {\n        const scroll: Point = { x: viewport.scroll.x, y: viewport.scroll.y };\n        xPos += scroll.x * zoom;\n        yPos += scroll.y * zoom;\n\n        xPos /= zoom;\n        yPos /= zoom;\n    }\n\n    return {\n        x: xPos,\n        y: yPos\n    };\n}\n\n/**\n * Translates the bounds of the diagram element (local coordinates) into the diagram coordinates system\n * (i.e. relative to the Diagram's 0;0 point)\n *\n * @param target  A bounds-aware element from the diagram\n */\nexport function toAbsoluteBounds(element: GModelElement & BoundsAware): Bounds {\n    const location = isAlignable(element) ? element.alignment : Point.ORIGIN;\n    const x = location.x;\n    const y = location.y;\n    const width = element.bounds.width;\n    const height = element.bounds.height;\n    return translateBounds({ x, y, width, height }, element, element.root);\n}\n\n/**\n * Translates the position of the diagram element (local coordinates) into the diagram coordinates system\n * (i.e. relative to the Diagram's 0;0 point)\n *\n * @param target  A bounds-aware element from the diagram\n */\nexport function toAbsolutePosition(target: GModelElement & BoundsAware): Point {\n    return toAbsoluteBounds(target);\n}\n\n/**\n * Translates the size of the diagram element (local coordinates) into the diagram coordinates system\n * (i.e. relative to the Diagram's 0;0 point)\n *\n * @param target  A bounds-aware element from the diagram\n */\nexport function toAbsoluteSize(target: GModelElement & BoundsAware): Dimension {\n    return toAbsoluteBounds(target);\n}\n\n/**\n * Convert a point, specified in absolute coordinates, to a point relative\n * to the parent of the specified child element.\n *\n * @param element the child element\n * @param absolutePoint a point in absolute coordinates\n * @returns the equivalent point, relative to the element's parent coordinates\n */\nexport function absoluteToParent(element: BoundsAwareModelElement & GChildElement, absolutePoint: Point): Point {\n    if (isBoundsAware(element.parent)) {\n        return absoluteToLocal(element.parent, absolutePoint);\n    }\n    // If the parent is not bounds-aware, assume it's at 0; 0 and proceed\n    return absoluteToLocal(element, absolutePoint);\n}\n\n/**\n * Convert a point, specified in absolute coordinates, to a point relative\n * to the specified element.\n *\n * @param element the element\n * @param absolutePoint a point in absolute coordinates\n * @returns the equivalent point, relative to the element's coordinates\n */\nexport function absoluteToLocal(element: BoundsAwareModelElement, absolutePoint: Point): Point {\n    const absoluteElementBounds = toAbsoluteBounds(element);\n    return { x: absolutePoint.x - absoluteElementBounds.x, y: absolutePoint.y - absoluteElementBounds.y };\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport {\n    Action,\n    CenterAction,\n    KeyListener,\n    KeyTool,\n    Point,\n    GModelElement,\n    GModelRoot,\n    SetViewportAction,\n    TYPES,\n    Viewport,\n    isViewport\n} from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../../base/action-dispatcher';\nimport { SelectionService } from '../../../base/selection-service';\nimport { Tool } from '../../../base/tool-manager/tool';\nimport { SetAccessibleKeyShortcutAction } from '../key-shortcut/accessible-key-shortcut';\nimport { ZoomElementAction, ZoomViewportAction } from '../move-zoom/zoom-handler';\nimport { EnableKeyboardGridAction, KeyboardGridCellSelectedAction, KeyboardGridKeyboardEventAction } from '../keyboard-grid/action';\nimport { getAbsolutePositionByPoint } from '../../../utils/viewpoint-util';\nimport { EditorContextService } from '../../../base/editor-context-service';\nimport { HideToastAction, ShowToastMessageAction } from '../toast/toast-handler';\nimport { ElementNavigatorKeyListener } from '../element-navigation/diagram-navigation-tool';\nimport * as messages from '../toast/messages.json';\n\n/**\n * Zoom viewport and elements when its focused and arrow keys are hit.\n */\n@injectable()\nexport class ZoomKeyTool implements Tool {\n    static ID = 'glsp.zoom-key-tool';\n\n    isEditTool = false;\n\n    protected readonly zoomKeyListener = new ZoomKeyListener(this);\n\n    @inject(KeyTool) protected readonly keytool: KeyTool;\n    @inject(TYPES.IActionDispatcher) readonly actionDispatcher: GLSPActionDispatcher;\n    @inject(SelectionService) selectionService: SelectionService;\n    @inject(EditorContextService)\n    protected editorContextService: EditorContextService;\n\n    get id(): string {\n        return ZoomKeyTool.ID;\n    }\n\n    enable(): void {\n        this.keytool.register(this.zoomKeyListener);\n        this.zoomKeyListener.registerShortcutKey();\n    }\n\n    disable(): void {\n        this.keytool.deregister(this.zoomKeyListener);\n    }\n\n    handle(action: Action): Action | void {\n        if (isViewport(this.editorContextService.modelRoot)) {\n            let viewportAction: Action | undefined = undefined;\n\n            if (KeyboardGridCellSelectedAction.is(action) && action.options.originId === ZoomKeyTool.ID) {\n                viewportAction = this.zoomKeyListener.setNewZoomFactor(\n                    this.editorContextService.modelRoot,\n                    ZoomKeyListener.defaultZoomInFactor,\n                    getAbsolutePositionByPoint(this.editorContextService.modelRoot, action.options.centerCellPosition)\n                );\n            } else if (KeyboardGridKeyboardEventAction.is(action) && action.options.originId === ZoomKeyTool.ID) {\n                if (matchesKeystroke(action.options.event, 'Minus')) {\n                    viewportAction = this.zoomKeyListener.setNewZoomFactor(\n                        this.editorContextService.modelRoot,\n                        ZoomKeyListener.defaultZoomOutFactor\n                    );\n                } else if (matchesKeystroke(action.options.event, 'Digit0', 'ctrl')) {\n                    viewportAction = CenterAction.create([]);\n                }\n            }\n\n            if (viewportAction) {\n                this.actionDispatcher.dispatchAll([\n                    viewportAction,\n                    HideToastAction.create({ id: Symbol.for(ElementNavigatorKeyListener.name) })\n                ]);\n            }\n        }\n    }\n}\n\nexport class ZoomKeyListener extends KeyListener {\n    static readonly defaultZoomInFactor = 1.1;\n    static readonly defaultZoomOutFactor = 0.9;\n    protected readonly token = ZoomKeyListener.name;\n\n    constructor(protected tool: ZoomKeyTool) {\n        super();\n    }\n\n    registerShortcutKey(): void {\n        this.tool.actionDispatcher.dispatchOnceModelInitialized(\n            SetAccessibleKeyShortcutAction.create({\n                token: this.token,\n                keys: [\n                    { shortcuts: ['+'], description: 'Zoom in to element or viewport', group: 'Zoom', position: 0 },\n                    { shortcuts: ['-'], description: 'Zoom out to element or viewport', group: 'Zoom', position: 1 },\n                    { shortcuts: ['CTRL', '0'], description: 'Reset zoom to default', group: 'Zoom', position: 2 },\n                    { shortcuts: ['CTRL', '+'], description: 'Zoom in via Grid', group: 'Zoom', position: 3 }\n                ]\n            })\n        );\n    }\n\n    setNewZoomFactor(viewport: GModelElement & GModelRoot & Viewport, zoomFactor: number, point?: Point): SetViewportAction {\n        let newViewport: Viewport;\n        const newZoom = viewport.zoom * zoomFactor;\n\n        if (point) {\n            newViewport = {\n                scroll: {\n                    x: point.x - (0.5 * viewport.canvasBounds.width) / newZoom,\n                    y: point.y - (0.5 * viewport.canvasBounds.height) / newZoom\n                },\n                zoom: newZoom\n            };\n        } else {\n            newViewport = {\n                scroll: viewport.scroll,\n                zoom: newZoom\n            };\n        }\n        return SetViewportAction.create(viewport.id, newViewport, { animate: true });\n    }\n\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        const selectedElementIds = this.tool.selectionService.getSelectedElementIDs();\n\n        if (this.matchesZoomViaGrid(event)) {\n            return [\n                EnableKeyboardGridAction.create({\n                    originId: ZoomKeyTool.ID,\n                    triggerActions: []\n                }),\n\n                ShowToastMessageAction.createWithTimeout({\n                    id: Symbol.for(ElementNavigatorKeyListener.name),\n                    message: messages.grid.zoom_in_grid\n                })\n            ];\n        } else if (this.matchesZoomOutKeystroke(event)) {\n            if (selectedElementIds.length > 0) {\n                return [ZoomElementAction.create(selectedElementIds, ZoomKeyListener.defaultZoomOutFactor)];\n            } else {\n                return [ZoomViewportAction.create(ZoomKeyListener.defaultZoomOutFactor)];\n            }\n        } else if (this.matchesZoomInKeystroke(event)) {\n            if (selectedElementIds.length > 0) {\n                return [ZoomElementAction.create(selectedElementIds, ZoomKeyListener.defaultZoomInFactor)];\n            } else {\n                return [ZoomViewportAction.create(ZoomKeyListener.defaultZoomInFactor)];\n            }\n        } else if (this.matchesMinZoomLevelKeystroke(event)) {\n            return [CenterAction.create(selectedElementIds)];\n        }\n        return [];\n    }\n\n    protected matchesZoomInKeystroke(event: KeyboardEvent): boolean {\n        /** here event.key is used for '+', as keycode 187 is already declared for 'Equals' in {@link matchesKeystroke}.*/\n        return event.key === '+' || matchesKeystroke(event, 'NumpadAdd');\n    }\n\n    protected matchesZoomViaGrid(event: KeyboardEvent): boolean {\n        return event.key === '+' && event.ctrlKey;\n    }\n    protected matchesMinZoomLevelKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Digit0', 'ctrl') || matchesKeystroke(event, 'Numpad0', 'ctrl');\n    }\n\n    protected matchesZoomOutKeystroke(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Minus') || matchesKeystroke(event, 'NumpadSubtract');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport {\n    AbstractLayout,\n    AbstractLayoutOptions,\n    Bounds,\n    BoundsData,\n    Dimension,\n    GChildElement,\n    LayoutContainer,\n    Point,\n    GParentElement,\n    StatefulLayouter\n} from '@eclipse-glsp/sprotty';\n\n/**\n * Layouts children of a container with explicit X/Y positions\n */\n@injectable()\nexport class FreeFormLayouter extends AbstractLayout<AbstractLayoutOptions> {\n    static KIND = 'freeform';\n\n    override layout(container: GParentElement & LayoutContainer, layouter: StatefulLayouter): void {\n        const boundsData = layouter.getBoundsData(container);\n        const options = this.getLayoutOptions(container);\n        const childrenSize = this.getChildrenSize(container, options, layouter);\n\n        // The real size of the compartment will be determined by the parent node layout;\n        // we only need to compute the bounds required to layout the children.\n\n        const maxWidth = childrenSize.width > 0 ? childrenSize.width + options.paddingLeft + options.paddingRight : 0;\n        const maxHeight = childrenSize.height > 0 ? childrenSize.height + options.paddingTop + options.paddingBottom : 0;\n        if (maxWidth > 0 && maxHeight > 0) {\n            const offset = this.layoutChildren(container, layouter, options, maxWidth, maxHeight);\n            boundsData.bounds = this.getFinalContainerBounds(container, offset, options, maxWidth, maxHeight);\n            boundsData.boundsChanged = true;\n        } else {\n            boundsData.bounds = { x: boundsData.bounds!.x, y: boundsData.bounds!.y, width: 0, height: 0 };\n            boundsData.boundsChanged = true;\n        }\n    }\n\n    protected getChildrenSize(\n        container: GParentElement & LayoutContainer,\n        containerOptions: AbstractLayoutOptions,\n        layouter: StatefulLayouter\n    ): Dimension {\n        let maxX = 0;\n        let maxY = 0;\n        container.children.forEach(child => {\n            const bounds = layouter.getBoundsData(child).bounds;\n            if (bounds !== undefined && Dimension.isValid(bounds)) {\n                const childMaxX = bounds.x + bounds.width;\n                const childMaxY = bounds.y + bounds.height;\n                maxX = Math.max(maxX, childMaxX);\n                maxY = Math.max(maxY, childMaxY);\n            }\n        });\n        return {\n            width: maxX,\n            height: maxY\n        };\n    }\n\n    protected layoutChild(\n        child: GChildElement,\n        boundsData: BoundsData,\n        bounds: Bounds,\n        childOptions: AbstractLayoutOptions,\n        containerOptions: AbstractLayoutOptions,\n        currentOffset: Point,\n        maxWidth: number,\n        maxHeight: number\n    ): Point {\n        boundsData.bounds = {\n            x: (child as any).bounds.x,\n            y: (child as any).bounds.y,\n            width: bounds.width,\n            height: bounds.height\n        };\n        boundsData.boundsChanged = true;\n        return currentOffset;\n    }\n\n    protected override getFinalContainerBounds(\n        container: GParentElement & LayoutContainer,\n        lastOffset: Point,\n        options: AbstractLayoutOptions,\n        maxWidth: number,\n        maxHeight: number\n    ): Bounds {\n        const result = {\n            x: container.bounds.x,\n            y: container.bounds.y,\n            width: Math.max(options.minWidth, maxWidth + options.paddingLeft + options.paddingRight),\n            height: Math.max(options.minHeight, maxHeight + options.paddingTop + options.paddingBottom)\n        };\n\n        return result;\n    }\n\n    protected getDefaultLayoutOptions(): AbstractLayoutOptions {\n        return {\n            resizeContainer: true,\n            paddingTop: 0,\n            paddingBottom: 0,\n            paddingLeft: 0,\n            paddingRight: 0,\n            paddingFactor: 1,\n            minWidth: 0,\n            minHeight: 0\n        };\n    }\n\n    protected spread(a: AbstractLayoutOptions, b: AbstractLayoutOptions): AbstractLayoutOptions {\n        return { ...a, ...b };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2022-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, optional } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport {\n    Action,\n    ComputedBoundsAction,\n    Deferred,\n    EdgeRouterRegistry,\n    ElementAndRoutingPoints,\n    HiddenBoundsUpdater,\n    IActionDispatcher,\n    RequestAction,\n    ResponseAction,\n    GModelElement,\n    GRoutableElement\n} from '@eclipse-glsp/sprotty';\nimport { calcElementAndRoute, isRoutable } from '../../utils/gmodel-util';\n\n/**\n * Grabs the bounds from hidden SVG DOM elements, applies layouts, collects routes and fires {@link ComputedBoundsAction}s.\n *\n * The actions will contain the bound, alignment, and routing points of elements.\n */\n@injectable()\nexport class GLSPHiddenBoundsUpdater extends HiddenBoundsUpdater {\n    @inject(EdgeRouterRegistry) @optional() protected readonly edgeRouterRegistry?: EdgeRouterRegistry;\n\n    protected element2route: ElementAndRoutingPoints[] = [];\n    protected edges: GRoutableElement[] = [];\n    protected nodes: VNode[] = [];\n\n    override decorate(vnode: VNode, element: GModelElement): VNode {\n        super.decorate(vnode, element);\n        if (isRoutable(element)) {\n            this.element2route.push(calcElementAndRoute(element, this.edgeRouterRegistry));\n        }\n        return vnode;\n    }\n\n    override postUpdate(cause?: Action): void {\n        const actions = this.captureActions(() => super.postUpdate(cause));\n        actions\n            .filter(action => ComputedBoundsAction.is(action))\n            .forEach(action => this.actionDispatcher.dispatch(this.enhanceAction(action as ComputedBoundsAction)));\n        this.element2route = [];\n    }\n\n    protected captureActions(call: () => void): Action[] {\n        const capturingActionDispatcher = new CapturingActionDispatcher();\n        const actualActionDispatcher = this.actionDispatcher;\n        this.actionDispatcher = capturingActionDispatcher;\n        try {\n            call();\n            return capturingActionDispatcher.actions;\n        } finally {\n            this.actionDispatcher = actualActionDispatcher;\n        }\n    }\n\n    protected enhanceAction(action: ComputedBoundsAction): ComputedBoundsAction {\n        action.routes = this.element2route.length === 0 ? undefined : this.element2route;\n        return action;\n    }\n}\n\nclass CapturingActionDispatcher implements IActionDispatcher {\n    readonly actions: Action[] = [];\n\n    async dispatch(action: Action): Promise<void> {\n        this.actions.push(action);\n    }\n\n    async dispatchAll(actions: Action[]): Promise<void> {\n        this.actions.push(...actions);\n    }\n\n    async request<Res extends ResponseAction>(action: RequestAction<Res>): Promise<Res> {\n        // ignore, not needed for our purposes\n        return new Deferred<Res>().promise;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport {\n    Bounds,\n    BoundsData,\n    Dimension,\n    GChildElement,\n    HBoxLayoutOptions,\n    HBoxLayouter,\n    LayoutContainer,\n    Point,\n    GModelElement,\n    GParentElement,\n    StatefulLayouter,\n    isBoundsAware,\n    isLayoutableChild\n} from '@eclipse-glsp/sprotty';\n\nexport interface HBoxLayoutOptionsExt extends HBoxLayoutOptions {\n    hGrab: boolean;\n    vGrab: boolean;\n    prefWidth: number | null;\n    prefHeight: number | null;\n}\n\n/**\n * Extends HBoxLayouter to support additional layout options\n */\n@injectable()\nexport class HBoxLayouterExt extends HBoxLayouter {\n    static override KIND = HBoxLayouter.KIND;\n\n    override layout(container: GParentElement & LayoutContainer, layouter: StatefulLayouter): void {\n        const boundsData = layouter.getBoundsData(container);\n        const options = this.getLayoutOptions(container);\n        const childrenSize = this.getChildrenSize(container, options, layouter);\n\n        const fixedSize = this.getFixedContainerBounds(container, options, layouter);\n\n        const currentWidth = boundsData.bounds ? boundsData.bounds?.width - options.paddingLeft - options.paddingRight : 0;\n        const currentHeight = boundsData.bounds ? boundsData.bounds?.height - options.paddingTop - options.paddingBottom : 0;\n\n        const maxWidth =\n            options.paddingFactor *\n            (options.resizeContainer\n                ? Math.max(fixedSize.width - options.paddingLeft - options.paddingRight, childrenSize.width)\n                : Math.max(0, fixedSize.width - options.paddingLeft - options.paddingRight));\n        const maxHeight =\n            options.paddingFactor *\n            (options.resizeContainer\n                ? Math.max(fixedSize.height - options.paddingTop - options.paddingBottom, childrenSize.height)\n                : Math.max(0, fixedSize.height - options.paddingTop - options.paddingBottom));\n\n        const width = Math.max(currentWidth, maxWidth);\n        const height = Math.max(currentHeight, maxHeight);\n\n        // Remaining size that can be grabbed by children with the hGrab option\n        const grabWidth = width - childrenSize.width;\n        // Number of children that request hGrab\n        // FIXME: This approach works fine when only 1 child uses HGrab, but may cause rounding issues\n        // when the grabHeight can't be equally shared by all children.\n        const grabbingChildren = container.children\n            .map(child => this.getChildLayoutOptions(child, options))\n            .filter(opt => opt.hGrab).length;\n\n        if (width > 0 && height > 0) {\n            const offset = this.layoutChildren(container, layouter, options, width, height, grabWidth, grabbingChildren);\n            boundsData.bounds = this.getFinalContainerBounds(container, offset, options, childrenSize.width, childrenSize.height);\n            boundsData.boundsChanged = true;\n        }\n    }\n\n    protected override getChildrenSize(\n        container: GParentElement & LayoutContainer,\n        containerOptions: HBoxLayoutOptionsExt,\n        layouter: StatefulLayouter\n    ): Dimension {\n        let maxWidth = 0;\n        let maxHeight = -1;\n        let isFirst = true;\n        container.children.forEach(child => {\n            if (isLayoutableChild(child)) {\n                const bounds = layouter.getBoundsData(child).bounds;\n                if (bounds !== undefined && Dimension.isValid(bounds)) {\n                    maxWidth += bounds.width;\n                    if (isFirst) {\n                        isFirst = false;\n                    } else {\n                        maxWidth += containerOptions.hGap;\n                    }\n                    maxHeight = Math.max(maxHeight, bounds.height);\n                }\n            }\n        });\n        const result = {\n            width: maxWidth,\n            height: maxHeight\n        };\n        return result;\n    }\n\n    protected override layoutChildren(\n        container: GParentElement & LayoutContainer,\n        layouter: StatefulLayouter,\n        containerOptions: HBoxLayoutOptionsExt,\n        maxWidth: number,\n        maxHeight: number,\n        grabWidth?: number,\n        grabbingChildren?: number\n    ): Point {\n        let currentOffset: Point = {\n            x: containerOptions.paddingLeft + 0.5 * (maxWidth - maxWidth / containerOptions.paddingFactor),\n            y: containerOptions.paddingTop + 0.5 * (maxHeight - maxHeight / containerOptions.paddingFactor)\n        };\n\n        container.children.forEach(child => {\n            if (isLayoutableChild(child)) {\n                const boundsData = layouter.getBoundsData(child);\n                const bounds = boundsData.bounds;\n                const childOptions = this.getChildLayoutOptions(child, containerOptions);\n                if (bounds !== undefined && Dimension.isValid(bounds)) {\n                    currentOffset = this.layoutChild(\n                        child,\n                        boundsData,\n                        bounds,\n                        childOptions,\n                        containerOptions,\n                        currentOffset,\n                        maxWidth,\n                        maxHeight,\n                        grabWidth,\n                        grabbingChildren\n                    );\n                }\n            }\n        });\n        return currentOffset;\n    }\n\n    protected override layoutChild(\n        child: GChildElement,\n        boundsData: BoundsData,\n        bounds: Bounds,\n        childOptions: HBoxLayoutOptionsExt,\n        containerOptions: HBoxLayoutOptionsExt,\n        currentOffset: Point,\n        maxWidth: number,\n        maxHeight: number,\n        grabWidth?: number,\n        grabbingChildren?: number\n    ): Point {\n        const vAlign = childOptions.vGrab ? 'top' : childOptions.vAlign;\n        const dy = this.getDy(vAlign, bounds, maxHeight);\n        let offset = super.layoutChild(child, boundsData, bounds, childOptions, containerOptions, currentOffset, maxWidth, maxHeight);\n        boundsData.bounds = {\n            ...boundsData.bounds!,\n            x: currentOffset.x,\n            y: currentOffset.y + dy\n        };\n        if (childOptions.vGrab) {\n            boundsData.bounds = {\n                x: boundsData.bounds!.x,\n                y: boundsData.bounds!.y,\n                width: boundsData.bounds!.width,\n                height: maxHeight\n            };\n            boundsData.boundsChanged = true;\n        }\n        if (childOptions.hGrab && grabWidth && grabbingChildren) {\n            const width = boundsData.bounds!.width + grabWidth / grabbingChildren;\n            boundsData.bounds = {\n                x: boundsData.bounds!.x,\n                y: boundsData.bounds!.y,\n                width: width,\n                height: boundsData.bounds!.height\n            };\n            boundsData.boundsChanged = true;\n            offset = { x: currentOffset.x + width, y: currentOffset.y };\n        }\n        return offset;\n    }\n\n    protected override getFixedContainerBounds(\n        container: GModelElement,\n        layoutOptions: HBoxLayoutOptionsExt,\n        layouter: StatefulLayouter\n    ): Bounds {\n        const currentContainer = container;\n        // eslint-disable-next-line no-constant-condition\n        if (isBoundsAware(currentContainer)) {\n            const bounds = currentContainer.bounds;\n            const elementOptions = this.getElementLayoutOptions(currentContainer);\n            const width = elementOptions?.prefWidth ?? 0;\n            const height = elementOptions?.prefHeight ?? 0;\n            return { ...bounds, width, height };\n        }\n        return Bounds.EMPTY;\n    }\n\n    protected override getChildLayoutOptions(child: GChildElement, containerOptions: HBoxLayoutOptionsExt): HBoxLayoutOptionsExt {\n        return super.getChildLayoutOptions(child, this.filterContainerOptions(containerOptions)) as HBoxLayoutOptionsExt;\n    }\n\n    protected override getLayoutOptions(element: GModelElement): HBoxLayoutOptionsExt {\n        return super.getLayoutOptions(element) as HBoxLayoutOptionsExt;\n    }\n\n    protected getElementLayoutOptions(element: GModelElement): HBoxLayoutOptionsExt | undefined {\n        return (element as any).layoutOptions;\n    }\n\n    protected override getFinalContainerBounds(\n        container: GParentElement & LayoutContainer,\n        lastOffset: Point,\n        options: HBoxLayoutOptionsExt,\n        maxWidth: number,\n        maxHeight: number\n    ): Bounds {\n        const elementOptions = this.getElementLayoutOptions(container);\n        const width = elementOptions?.prefWidth ?? options.minWidth;\n        const height = elementOptions?.prefHeight ?? options.minHeight;\n\n        const result = {\n            x: container.bounds.x,\n            y: container.bounds.y,\n            width: Math.max(width, maxWidth + options.paddingLeft + options.paddingRight),\n            height: Math.max(height, maxHeight + options.paddingTop + options.paddingBottom)\n        };\n\n        return result;\n    }\n\n    protected override getDefaultLayoutOptions(): HBoxLayoutOptionsExt {\n        return {\n            resizeContainer: true,\n            paddingTop: 5,\n            paddingBottom: 5,\n            paddingLeft: 5,\n            paddingRight: 5,\n            paddingFactor: 1,\n            hGap: 1,\n            vAlign: 'center',\n            minWidth: 0,\n            minHeight: 0,\n            hGrab: false,\n            vGrab: false,\n            // eslint-disable-next-line no-null/no-null\n            prefHeight: null,\n            // eslint-disable-next-line no-null/no-null\n            prefWidth: null\n        };\n    }\n\n    protected filterContainerOptions(containerOptions: HBoxLayoutOptionsExt): HBoxLayoutOptionsExt {\n        // Reset object-specific layout options to default before merging,\n        // to make sure they won't be inherited (grab, prefSize)\n        // eslint-disable-next-line no-null/no-null\n        const localOptions = { vGrab: false, hGrab: false, prefHeight: null, prefWidth: null };\n        return { ...containerOptions, ...localOptions };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2022-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport {\n    Bounds,\n    BoundsData,\n    ILogger,\n    LayoutContainer,\n    LayoutRegistry,\n    Layouter,\n    GModelElement,\n    GParentElement,\n    StatefulLayouter,\n    isLayoutContainer\n} from '@eclipse-glsp/sprotty';\n\n@injectable()\nexport class LayouterExt extends Layouter {\n    override layout(element2boundsData: Map<GModelElement, BoundsData>): void {\n        new StatefulLayouterExt(element2boundsData, this.layoutRegistry, this.logger).layout();\n    }\n}\n\n// 2-pass layout:\n// Step 1: Find \"rendered size\" of each element (may take resizeContainer into account)\n// Child-to-parent layout\n// Step 2: Extend parents as necessary, then use the adjusted parent size to properly\n// align children (center/end alignments, hGrab/vGrab)\n// Parent-to-children layout\n\nexport class StatefulLayouterExt extends StatefulLayouter {\n    protected toBeLayouted2: (GParentElement & LayoutContainer)[];\n\n    /**\n     *\n     * @param elementToBoundsData The map of element to bounds data. Bounds Data are computed from the hidden\n     * SVG rendering pass.\n     * @param layoutRegistry2 The registry of available layouts.\n     * @param log The log.\n     */\n    constructor(\n        protected readonly elementToBoundsData: Map<GModelElement, BoundsData>,\n        protected readonly layoutRegistry2: LayoutRegistry,\n        log: ILogger\n    ) {\n        super(elementToBoundsData, layoutRegistry2, log);\n        this.toBeLayouted2 = [];\n        elementToBoundsData.forEach((data, element) => {\n            if (isLayoutContainer(element)) {\n                this.toBeLayouted2.push(element);\n            }\n        });\n        for (const element of this.toBeLayouted2) {\n            // Clear previous layout information for dynamic-layout objects\n            elementToBoundsData.delete(element);\n        }\n    }\n\n    override getBoundsData(element: GModelElement): BoundsData {\n        let boundsData = this.elementToBoundsData.get(element);\n        let bounds = (element as any).bounds;\n        if (isLayoutContainer(element) && this.toBeLayouted2.indexOf(element) >= 0) {\n            bounds = this.doLayout(element);\n        } else if (isLayoutContainer(element)) {\n            bounds = {\n                x: 0,\n                y: 0,\n                width: -1,\n                height: -1\n            };\n        }\n        if (!boundsData) {\n            boundsData = {\n                bounds: bounds,\n                boundsChanged: false,\n                alignmentChanged: false\n            };\n            this.elementToBoundsData.set(element, boundsData);\n        }\n        return boundsData;\n    }\n\n    override layout(): void {\n        // First pass: apply layout with cleared container data. Will get\n        // preferred size for all elements (Children first, then parents)\n        while (this.toBeLayouted2.length > 0) {\n            const element = this.toBeLayouted2[0];\n            this.doLayout(element);\n        }\n\n        this.toBeLayouted2 = [];\n        this.elementToBoundsData.forEach((data, element) => {\n            if (isLayoutContainer(element)) {\n                this.toBeLayouted2.push(element);\n            }\n        });\n\n        // Second pass: apply layout with initial size data for all\n        // nodes. Update the position/size of all elements, taking\n        // vGrab/hGrab into account (parent -> children).\n        while (this.toBeLayouted2.length > 0) {\n            const element = this.toBeLayouted2[0];\n            this.doLayout(element);\n        }\n    }\n\n    protected override doLayout(element: GParentElement & LayoutContainer): Bounds {\n        const index = this.toBeLayouted2.indexOf(element);\n        if (index >= 0) {\n            this.toBeLayouted2.splice(index, 1);\n        }\n        const layout = this.layoutRegistry2.get(element.layout);\n        if (layout) {\n            layout.layout(element, this);\n        }\n        const boundsData = this.elementToBoundsData.get(element);\n        if (boundsData !== undefined && boundsData.bounds !== undefined) {\n            return boundsData.bounds;\n        } else {\n            this.log.error(element, 'Layout failed');\n            return Bounds.EMPTY;\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport {\n    Bounds,\n    BoundsData,\n    Dimension,\n    GChildElement,\n    LayoutContainer,\n    Point,\n    GModelElement,\n    GParentElement,\n    StatefulLayouter,\n    VBoxLayoutOptions,\n    VBoxLayouter,\n    isBoundsAware,\n    isLayoutableChild\n} from '@eclipse-glsp/sprotty';\n\nexport interface VBoxLayoutOptionsExt extends VBoxLayoutOptions {\n    hGrab: boolean;\n    vGrab: boolean;\n    prefWidth: number | null;\n    prefHeight: number | null;\n}\n\n/**\n * Extends VBoxLayouter to support additional layout options\n */\n@injectable()\nexport class VBoxLayouterExt extends VBoxLayouter {\n    static override KIND = VBoxLayouter.KIND;\n\n    override layout(container: GParentElement & LayoutContainer, layouter: StatefulLayouter): void {\n        const boundsData = layouter.getBoundsData(container);\n        const options = this.getLayoutOptions(container);\n        const childrenSize = this.getChildrenSize(container, options, layouter);\n\n        const fixedSize = this.getFixedContainerBounds(container, options, layouter);\n\n        const currentWidth = (boundsData.bounds?.width || 0) - options.paddingLeft - options.paddingRight;\n        const currentHeight = (boundsData.bounds?.height || 0) - options.paddingTop - options.paddingBottom;\n\n        const maxWidth =\n            options.paddingFactor *\n            (options.resizeContainer\n                ? Math.max(fixedSize.width - options.paddingLeft - options.paddingRight, childrenSize.width)\n                : Math.max(0, fixedSize.width - options.paddingLeft - options.paddingRight));\n        const maxHeight =\n            options.paddingFactor *\n            (options.resizeContainer\n                ? Math.max(fixedSize.height - options.paddingTop - options.paddingBottom, childrenSize.height)\n                : Math.max(0, fixedSize.height - options.paddingTop - options.paddingBottom));\n\n        const width = Math.max(currentWidth, maxWidth);\n        const height = Math.max(currentHeight, maxHeight);\n\n        // Remaining size that can be grabbed by children with the vGrab option\n        const grabHeight: number = height - childrenSize.height;\n        // Number of children that request vGrab\n        // FIXME: This approach works fine when only 1 child uses VGrab, but may cause rounding issues\n        // when the grabHeight can't be equally shared by all children.\n        const grabbingChildren = container.children\n            .map(child => this.getChildLayoutOptions(child, options))\n            .filter(opt => opt.vGrab).length;\n\n        if (maxWidth > 0 && maxHeight > 0) {\n            const offset = this.layoutChildren(container, layouter, options, width, height, grabHeight, grabbingChildren);\n            boundsData.bounds = this.getFinalContainerBounds(container, offset, options, childrenSize.width, childrenSize.height);\n            boundsData.boundsChanged = true;\n        }\n    }\n\n    protected override getChildrenSize(\n        container: GParentElement & LayoutContainer,\n        containerOptions: VBoxLayoutOptionsExt,\n        layouter: StatefulLayouter\n    ): Dimension {\n        let maxWidth = -1;\n        let maxHeight = 0;\n        let isFirst = true;\n        container.children.forEach(child => {\n            if (isLayoutableChild(child)) {\n                const bounds = layouter.getBoundsData(child).bounds;\n                if (bounds !== undefined && Dimension.isValid(bounds)) {\n                    maxHeight += bounds.height;\n                    if (isFirst) {\n                        isFirst = false;\n                    } else {\n                        maxHeight += containerOptions.vGap;\n                    }\n                    maxWidth = Math.max(maxWidth, bounds.width);\n                }\n            }\n        });\n        const result = {\n            width: maxWidth,\n            height: maxHeight\n        };\n        return result;\n    }\n\n    protected override layoutChildren(\n        container: GParentElement & LayoutContainer,\n        layouter: StatefulLayouter,\n        containerOptions: VBoxLayoutOptionsExt,\n        maxWidth: number,\n        maxHeight: number,\n        grabHeight?: number,\n        grabbingChildren?: number\n    ): Point {\n        let currentOffset: Point = {\n            x: containerOptions.paddingLeft + 0.5 * (maxWidth - maxWidth / containerOptions.paddingFactor),\n            y: containerOptions.paddingTop + 0.5 * (maxHeight - maxHeight / containerOptions.paddingFactor)\n        };\n\n        container.children.forEach(child => {\n            if (isLayoutableChild(child)) {\n                const boundsData = layouter.getBoundsData(child);\n                const bounds = boundsData.bounds;\n                const childOptions = this.getChildLayoutOptions(child, containerOptions);\n                if (bounds !== undefined && Dimension.isValid(bounds)) {\n                    currentOffset = this.layoutChild(\n                        child,\n                        boundsData,\n                        bounds,\n                        childOptions,\n                        containerOptions,\n                        currentOffset,\n                        maxWidth,\n                        maxHeight,\n                        grabHeight,\n                        grabbingChildren\n                    );\n                }\n            }\n        });\n        return currentOffset;\n    }\n\n    protected override layoutChild(\n        child: GChildElement,\n        boundsData: BoundsData,\n        bounds: Bounds,\n        childOptions: VBoxLayoutOptionsExt,\n        containerOptions: VBoxLayoutOptionsExt,\n        currentOffset: Point,\n        maxWidth: number,\n        maxHeight: number,\n        grabHeight?: number,\n        grabbingChildren?: number\n    ): Point {\n        const hAlign = childOptions.hGrab ? 'left' : childOptions.hAlign;\n        const dx = this.getDx(hAlign, bounds, maxWidth);\n        let offset = super.layoutChild(child, boundsData, bounds, childOptions, containerOptions, currentOffset, maxWidth, maxHeight);\n        boundsData.bounds = {\n            ...boundsData.bounds!,\n            x: currentOffset.x + dx,\n            y: currentOffset.y\n        };\n        if (childOptions.hGrab) {\n            boundsData.bounds = {\n                x: boundsData.bounds!.x,\n                y: boundsData.bounds!.y,\n                width: maxWidth,\n                height: boundsData.bounds!.height\n            };\n            boundsData.boundsChanged = true;\n        }\n        if (childOptions.vGrab && grabHeight && grabbingChildren) {\n            const height = boundsData.bounds!.height + grabHeight / grabbingChildren;\n            boundsData.bounds = {\n                x: boundsData.bounds!.x,\n                y: boundsData.bounds!.y,\n                width: boundsData.bounds!.width,\n                height: height\n            };\n            boundsData.boundsChanged = true;\n            offset = { x: currentOffset.x, y: currentOffset.y + height };\n        }\n        return offset;\n    }\n\n    protected override getFixedContainerBounds(\n        container: GModelElement,\n        layoutOptions: VBoxLayoutOptionsExt,\n        layouter: StatefulLayouter\n    ): Bounds {\n        const currentContainer = container;\n        // eslint-disable-next-line no-constant-condition\n        if (isBoundsAware(currentContainer)) {\n            const bounds = currentContainer.bounds;\n            const elementOptions = this.getElementLayoutOptions(currentContainer);\n            const width = elementOptions?.prefWidth ?? 0;\n            const height = elementOptions?.prefHeight ?? 0;\n            return { ...bounds, width, height };\n        }\n        return Bounds.EMPTY;\n    }\n\n    protected override getChildLayoutOptions(child: GChildElement, containerOptions: VBoxLayoutOptionsExt): VBoxLayoutOptionsExt {\n        return super.getChildLayoutOptions(child, this.filterContainerOptions(containerOptions)) as VBoxLayoutOptionsExt;\n    }\n\n    protected override getLayoutOptions(element: GModelElement): VBoxLayoutOptionsExt {\n        return super.getLayoutOptions(element) as VBoxLayoutOptionsExt;\n    }\n\n    protected getElementLayoutOptions(element: GModelElement): VBoxLayoutOptionsExt | undefined {\n        return (element as any).layoutOptions;\n    }\n\n    protected override getFinalContainerBounds(\n        container: GParentElement & LayoutContainer,\n        lastOffset: Point,\n        options: VBoxLayoutOptionsExt,\n        maxWidth: number,\n        maxHeight: number\n    ): Bounds {\n        const elementOptions = this.getElementLayoutOptions(container);\n        const width = elementOptions?.prefWidth ?? options.minWidth;\n        const height = elementOptions?.prefHeight ?? options.minHeight;\n\n        const result = {\n            x: container.bounds.x,\n            y: container.bounds.y,\n            width: Math.max(width, maxWidth + options.paddingLeft + options.paddingRight),\n            height: Math.max(height, maxHeight + options.paddingTop + options.paddingBottom)\n        };\n\n        return result;\n    }\n\n    protected override getDefaultLayoutOptions(): VBoxLayoutOptionsExt {\n        return {\n            resizeContainer: true,\n            paddingTop: 5,\n            paddingBottom: 5,\n            paddingLeft: 5,\n            paddingRight: 5,\n            paddingFactor: 1,\n            vGap: 1,\n            hAlign: 'center',\n            minWidth: 0,\n            minHeight: 0,\n            hGrab: false,\n            vGrab: false,\n            // eslint-disable-next-line no-null/no-null\n            prefHeight: null,\n            // eslint-disable-next-line no-null/no-null\n            prefWidth: null\n        };\n    }\n\n    protected filterContainerOptions(containerOptions: VBoxLayoutOptionsExt): VBoxLayoutOptionsExt {\n        // Reset object-specific layout options to default before merging,\n        // to make sure they won't be inherited (grab, prefSize)\n        // eslint-disable-next-line no-null/no-null\n        const localOptions = { vGrab: false, hGrab: false, prefHeight: null, prefWidth: null };\n        return { ...containerOptions, ...localOptions };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { BoundsAware, Point, GModelElement, GNode, GParentElement } from '@eclipse-glsp/sprotty';\nimport { ModifyCSSFeedbackAction } from '../../base/feedback/css-feedback';\nimport { toAbsoluteBounds } from '../../utils/viewpoint-util';\nimport { SResizeHandle, isBoundsAwareMoveable } from './model';\n\n/**\n * A `MovementRestrictor` is an optional service that can be used by tools to validate\n * whether a certain move operation (e.g. `ChangeBoundsOperation`) in the diagram is valid.\n */\nexport interface IMovementRestrictor {\n    /**\n     * Validate whether moving the given element to a new given location is allowed.\n     * @param element The element that should be moved.\n     * @param newLocation The new location of the element.\n     * @returns `true` if the the element is movable and moving to the given location is allowed, `false` otherwise.\n     *          Should also return `false` if the newLocation is `undefined`:\n     */\n    validate(element: GModelElement, newLocation?: Point): boolean;\n    /**\n     * Feedback css-classes. Can be applied to elements that did fail the validation.\n     */\n    cssClasses?: string[];\n}\n\n/**\n *  A `IMovementRestrictor` that checks for overlapping elements. Move operations\n *  are only valid if the element does not collide with another element after moving.\n */\n@injectable()\nexport class NoOverlapMovementRestrictor implements IMovementRestrictor {\n    cssClasses = ['movement-not-allowed'];\n\n    validate(element: GModelElement, newLocation?: Point): boolean {\n        if (!isBoundsAwareMoveable(element) || !newLocation) {\n            return false;\n        }\n        // Create ghost element at the newLocation\n        const ghostElement = Object.create(element) as GModelElement & BoundsAware;\n        ghostElement.bounds = {\n            x: newLocation.x,\n            y: newLocation.y,\n            width: element.bounds.width,\n            height: element.bounds.height\n        };\n        ghostElement.type = 'Ghost';\n        ghostElement.id = element.id;\n        return !Array.from(\n            element.root.index\n                .all()\n                .filter(e => e.id !== ghostElement.id && e !== ghostElement.root && e instanceof GNode)\n                .map(e => e as GModelElement & BoundsAware)\n        ).some(e => this.areOverlapping(e, ghostElement));\n    }\n\n    protected areOverlapping(element1: GModelElement & BoundsAware, element2: GModelElement & BoundsAware): boolean {\n        const b1 = toAbsoluteBounds(element1);\n        const b2 = toAbsoluteBounds(element2);\n        const r1TopLeft: Point = b1;\n        const r1BottomRight = { x: b1.x + b1.width, y: b1.y + b1.height };\n        const r2TopLeft: Point = b2;\n        const r2BottomRight = { x: b2.x + b2.width, y: b2.y + b2.height };\n\n        // If one rectangle is on left side of other\n        if (r1TopLeft.x > r2BottomRight.x || r2TopLeft.x > r1BottomRight.x) {\n            return false;\n        }\n\n        // If one rectangle is above other\n        if (r1BottomRight.y < r2TopLeft.y || r2BottomRight.y < r1TopLeft.y) {\n            return false;\n        }\n\n        return true;\n    }\n}\n\n/**\n * Utility function to create an action that applies the given {@link IMovementRestrictor.cssClasses} to the given element.\n * @param element The element on which the css classes should be applied.\n * @param movementRestrictor The movement restrictor whose cssClasses should be applied.\n * @returns The corresponding {@link ModifyCSSFeedbackAction}\n */\nexport function createMovementRestrictionFeedback(\n    element: GModelElement,\n    movementRestrictor: IMovementRestrictor\n): ModifyCSSFeedbackAction {\n    const elements: GModelElement[] = [element];\n    if (element instanceof GParentElement) {\n        element.children.filter(child => child instanceof SResizeHandle).forEach(e => elements.push(e));\n    }\n    return ModifyCSSFeedbackAction.create({ elements, add: movementRestrictor.cssClasses });\n}\n\n/**\n * Utility function to create an action that removes the given {@link IMovementRestrictor.cssClasses} from the given element.\n * @param element The element from which the css classes should be removed.\n * @param movementRestrictor The movement restrictor whose cssClasses should be removed.\n * @returns The corresponding {@link ModifyCSSFeedbackAction}\n */\nexport function removeMovementRestrictionFeedback(\n    element: GModelElement,\n    movementRestrictor: IMovementRestrictor\n): ModifyCSSFeedbackAction {\n    const elements: GModelElement[] = [element];\n    if (element instanceof GParentElement) {\n        element.children.filter(child => child instanceof SResizeHandle).forEach(e => elements.push(e));\n    }\n\n    return ModifyCSSFeedbackAction.create({ elements, remove: movementRestrictor.cssClasses });\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, postConstruct } from 'inversify';\nimport { CommandPaletteKeyListener, KeyListener, KeyTool } from '@eclipse-glsp/sprotty';\nimport { Tool } from '../../base/tool-manager/tool';\n\n@injectable()\nexport class CommandPaletteTool implements Tool {\n    static ID = 'glsp.command-palette-tool';\n\n    protected commandPaletteKeyListener: KeyListener;\n    @inject(KeyTool) protected keyTool: KeyTool;\n\n    @postConstruct()\n    protected postConstruct(): void {\n        this.commandPaletteKeyListener = this.createCommandPaletteKeyListener();\n    }\n\n    get id(): string {\n        return CommandPaletteTool.ID;\n    }\n\n    enable(): void {\n        this.keyTool.register(this.commandPaletteKeyListener);\n    }\n\n    disable(): void {\n        this.keyTool.deregister(this.commandPaletteKeyListener);\n    }\n\n    protected createCommandPaletteKeyListener(): KeyListener {\n        return new CommandPaletteKeyListener();\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    ICommandPaletteActionProvider,\n    LabeledAction,\n    Point,\n    RequestContextActions,\n    GModelElement,\n    SetContextActions,\n    TYPES\n} from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\nimport { EditorContextService } from '../../base/editor-context-service';\n\nexport namespace ServerCommandPalette {\n    export const CONTEXT_ID = 'command-palette';\n    export const TEXT = 'text';\n    export const INDEX = 'index';\n}\n\n@injectable()\nexport class ServerCommandPaletteActionProvider implements ICommandPaletteActionProvider {\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: GLSPActionDispatcher;\n    @inject(EditorContextService) protected editorContext: EditorContextService;\n\n    async getActions(_root: Readonly<GModelElement>, text: string, _lastMousePosition?: Point, index?: number): Promise<LabeledAction[]> {\n        const requestAction = RequestContextActions.create({\n            contextId: ServerCommandPalette.CONTEXT_ID,\n            editorContext: this.editorContext.get({\n                [ServerCommandPalette.TEXT]: text,\n                [ServerCommandPalette.INDEX]: index ? index : 0\n            })\n        });\n        const response = await this.actionDispatcher.requestUntil(requestAction);\n        return response ? this.getPaletteActionsFromResponse(response) : [];\n    }\n\n    getPaletteActionsFromResponse(action: Action): LabeledAction[] {\n        if (SetContextActions.is(action)) {\n            return action.actions;\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { DeleteElementOperation, IContextMenuItemProvider, MenuItem, Point, GModelRoot, TYPES } from '@eclipse-glsp/sprotty';\nimport { EditorContextService, EditorContextServiceProvider } from '../../base/editor-context-service';\n\n@injectable()\nexport class DeleteElementContextMenuItemProvider implements IContextMenuItemProvider {\n    @inject(TYPES.IEditorContextServiceProvider) editorContextServiceProvider: EditorContextServiceProvider;\n\n    async getItems(_root: Readonly<GModelRoot>, _lastMousePosition?: Point): Promise<MenuItem[]> {\n        const editorContextService = await this.editorContextServiceProvider();\n        return [this.createDeleteMenuItem(editorContextService)];\n    }\n\n    protected createDeleteMenuItem(editorContextService: EditorContextService): MenuItem {\n        return {\n            id: 'delete',\n            label: 'Delete',\n            sortString: 'd',\n            group: 'edit',\n            actions: [DeleteElementOperation.create(editorContextService.selectedElements.map(e => e.id))],\n            isEnabled: () => !editorContextService.isReadonly && editorContextService.selectedElements.length > 0\n        };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    Action,\n    ContextMenuProviderRegistry,\n    GModelElement,\n    IContextMenuService,\n    IContextMenuServiceProvider,\n    MouseListener,\n    SelectAction,\n    TYPES,\n    findParentByFeature,\n    isSelectable\n} from '@eclipse-glsp/sprotty';\nimport { inject, injectable, optional, postConstruct } from 'inversify';\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\nimport { FocusStateChangedAction } from '../../base/focus/focus-state-change-action';\n\n@injectable()\nexport class GLSPContextMenuMouseListener extends MouseListener {\n    @inject(TYPES.IContextMenuServiceProvider)\n    @optional()\n    protected contextMenuServiceProvider?: IContextMenuServiceProvider;\n\n    @inject(TYPES.IContextMenuProviderRegistry)\n    @optional()\n    protected menuProvider?: ContextMenuProviderRegistry;\n\n    @inject(GLSPActionDispatcher)\n    protected actionDispatcher: GLSPActionDispatcher;\n\n    protected menuService?: IContextMenuService;\n\n    @postConstruct()\n    protected initialize(): void {\n        this.contextMenuServiceProvider?.().then(menuService => (this.menuService = menuService));\n    }\n\n    /**\n     * Opens the context menu.\n     */\n    override contextMenu(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        return this.openContextMenu(target, event);\n    }\n\n    /**\n     * Opens the context menu.\n     *\n     *   - update selection state (if context menu target is selectable)\n     *   - query the context menu service and the context menu elements\n     *   - show the context menu\n     *   - send a focus state change to indicate that the diagram becomes inactive, once the context menu is shown\n     *\n     * When the context menu is closed, we focus the diagram element again.\n     */\n    protected openContextMenu(target: GModelElement, event: MouseEvent): Promise<Action>[] {\n        if (!this.menuService || !this.menuProvider) {\n            return [];\n        }\n\n        return [this.showContextMenuItems(target, event)];\n    }\n\n    protected async showContextMenuItems(target: GModelElement, event: MouseEvent): Promise<Action> {\n        await this.handleContextElementSelection(target, event);\n        const mousePosition = { x: event.x, y: event.y };\n\n        const menuItems = await this.menuProvider!.getItems(target.root, mousePosition);\n        this.menuService!.show(menuItems, mousePosition, () => this.focusEventTarget(event));\n        return FocusStateChangedAction.create(false);\n    }\n\n    // Clear selection the context menu target is not selectable\n    // Otherwise either maintain current selection if target is already selected or single select the current target.\n    protected async handleContextElementSelection(target: GModelElement, event: MouseEvent): Promise<void> {\n        const selectableTarget = findParentByFeature(target, isSelectable);\n        if (!selectableTarget) {\n            return this.actionDispatcher.dispatch(SelectAction.setSelection([]));\n        }\n        if (!selectableTarget.selected) {\n            return this.actionDispatcher.dispatch(SelectAction.setSelection([selectableTarget.id]));\n        }\n        return;\n    }\n\n    protected focusEventTarget(event: MouseEvent): void {\n        const targetElement = event.target instanceof SVGElement ? event.target : undefined;\n        const svgParentElement = targetElement?.closest('svg');\n        if (svgParentElement) {\n            svgParentElement.focus();\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    IContextMenuItemProvider,\n    LabeledAction,\n    Point,\n    RequestContextActions,\n    GModelElement,\n    SetContextActions,\n    TYPES,\n    isSelected\n} from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\nimport { EditorContextService } from '../../base/editor-context-service';\n\nexport namespace ServerContextMenu {\n    export const CONTEXT_ID = 'context-menu';\n}\n\n@injectable()\nexport class ServerContextMenuItemProvider implements IContextMenuItemProvider {\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: GLSPActionDispatcher;\n    @inject(EditorContextService) protected editorContext: EditorContextService;\n\n    async getItems(root: Readonly<GModelElement>, _lastMousePosition?: Point): Promise<LabeledAction[]> {\n        const selectedElementIds = Array.from(\n            root.index\n                .all()\n                .filter(isSelected)\n                .map(e => e.id)\n        );\n        const editorContext = this.editorContext.getWithSelection(selectedElementIds);\n        const requestAction = RequestContextActions.create({ contextId: ServerContextMenu.CONTEXT_ID, editorContext });\n        const response = await this.actionDispatcher.requestUntil(requestAction);\n        return response ? this.getContextActionsFromResponse(response) : [];\n    }\n\n    getContextActionsFromResponse(action: Action): LabeledAction[] {\n        if (SetContextActions.is(action)) {\n            return action.actions;\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n/* eslint-disable deprecation/deprecation */\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    IActionDispatcher,\n    IActionHandler,\n    IContextMenuItemProvider,\n    MenuItem,\n    Point,\n    GModelRoot,\n    MessageAction,\n    StatusAction,\n    TYPES,\n    hasStringProp,\n    isSelected\n} from '@eclipse-glsp/sprotty';\n\n/**\n * An `InvokeCopyPasteAction` is dispatched by the client to initiate a cut, copy or paste operation.\n */\nexport interface InvokeCopyPasteAction extends Action {\n    kind: typeof InvokeCopyPasteAction.KIND;\n    command: 'copy' | 'cut' | 'paste';\n}\n\nexport namespace InvokeCopyPasteAction {\n    export const KIND = 'invokeCopyPaste';\n\n    export function is(object: any): object is InvokeCopyPasteAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'command');\n    }\n\n    export function create(command: 'copy' | 'cut' | 'paste'): InvokeCopyPasteAction {\n        return { kind: KIND, command };\n    }\n}\n\n@injectable()\nexport class InvokeCopyPasteActionHandler implements IActionHandler {\n    @inject(TYPES.IActionDispatcher) protected dispatcher: IActionDispatcher;\n    handle(action: InvokeCopyPasteAction): void {\n        switch (action.command) {\n            case 'copy':\n                if (supportsCopy()) {\n                    document.execCommand('copy');\n                } else {\n                    this.notifyUserToUseShortcut('copy');\n                }\n                break;\n            case 'paste':\n                if (supportsPaste()) {\n                    document.execCommand('paste');\n                } else {\n                    this.notifyUserToUseShortcut('paste');\n                }\n                break;\n            case 'cut':\n                if (supportsCut()) {\n                    document.execCommand('cut');\n                } else {\n                    this.notifyUserToUseShortcut('cut');\n                }\n                break;\n        }\n    }\n\n    protected notifyUserToUseShortcut(operation: string): void {\n        const message = `Please use the browser's ${operation} command or shortcut.`;\n        const timeout = 10000;\n        const severity = 'WARNING';\n        this.dispatcher.dispatchAll([StatusAction.create(message, { severity, timeout }), MessageAction.create(message, { severity })]);\n    }\n}\n\n@injectable()\nexport class CopyPasteContextMenuItemProvider implements IContextMenuItemProvider {\n    getItems(root: Readonly<GModelRoot>, _lastMousePosition?: Point): Promise<MenuItem[]> {\n        const hasSelectedElements = Array.from(root.index.all().filter(isSelected)).length > 0;\n        return Promise.resolve([\n            this.createCopyMenuItem(hasSelectedElements),\n            this.createCutMenuItem(hasSelectedElements),\n            this.createPasteMenuItem()\n        ]);\n    }\n\n    protected createPasteMenuItem(): MenuItem {\n        return {\n            id: 'paste',\n            label: 'Paste',\n            group: 'copy-paste',\n            actions: [InvokeCopyPasteAction.create('paste')],\n            isEnabled: () => true\n        };\n    }\n\n    protected createCutMenuItem(hasSelectedElements: boolean): MenuItem {\n        return {\n            id: 'cut',\n            label: 'Cut',\n            group: 'copy-paste',\n            actions: [InvokeCopyPasteAction.create('cut')],\n            isEnabled: () => hasSelectedElements\n        };\n    }\n\n    protected createCopyMenuItem(hasSelectedElements: boolean): MenuItem {\n        return {\n            id: 'copy',\n            label: 'Copy',\n            group: 'copy-paste',\n            actions: [InvokeCopyPasteAction.create('copy')],\n            isEnabled: () => hasSelectedElements\n        };\n    }\n}\n\nexport function supportsCopy(): boolean {\n    return isNative() || document.queryCommandSupported('copy');\n}\n\nexport function supportsCut(): boolean {\n    return isNative() || document.queryCommandSupported('cut');\n}\n\nexport function supportsPaste(): boolean {\n    const isChrome = userAgent().indexOf('Chrome') >= 0;\n    return isNative() || (!isChrome && document.queryCommandSupported('paste'));\n}\n\nexport function isNative(): boolean {\n    return typeof (window as any).process !== 'undefined';\n}\n\nfunction userAgent(): string {\n    return typeof navigator !== 'undefined' ? navigator.userAgent : '';\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { v4 as uuid } from 'uuid';\nimport {\n    ClipboardData,\n    CutOperation,\n    PasteOperation,\n    RequestClipboardDataAction,\n    SetClipboardDataAction,\n    TYPES,\n    ViewerOptions\n} from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\nimport { EditorContextService } from '../../base/editor-context-service';\n\nexport interface ICopyPasteHandler {\n    handleCopy(event: ClipboardEvent): void;\n    handleCut(event: ClipboardEvent): void;\n    handlePaste(event: ClipboardEvent): void;\n}\n\nexport interface IAsyncClipboardService {\n    clear(): void;\n    put(data: ClipboardData, id?: string): void;\n    get(id?: string): ClipboardData | undefined;\n}\n\n/**\n * A local implementation of the async clipboard interface.\n *\n * This implementation just stores the clipboard data in memory, but not in the clipboard.\n * This implementation can be used if you don't need to support cross-widget/browser/application\n * data transfer and you would like to avoid to require the permission of the user for accessing the\n * system clipboard asynchronously.\n *\n * In order to detect whether the user copied something else since we recorded the clipboard data\n * we put a uuid into the system clipboard synchronously. If on paste this ID has changed or is not\n * available anymore, we know that the user copied in another application or context, so we shouldn't\n * paste what we have stored locally and just return undefined.\n *\n * Real async clipboard service implementations can just ignore the ID that is passed and rely on the\n * system clipboard's content instead.\n */\n@injectable()\nexport class LocalClipboardService implements IAsyncClipboardService {\n    protected currentId?: string;\n    protected data?: ClipboardData;\n\n    clear(): void {\n        this.currentId = undefined;\n        this.data = undefined;\n    }\n\n    put(data: ClipboardData, id: string): void {\n        this.currentId = id;\n        this.data = data;\n    }\n\n    get(id?: string): ClipboardData | undefined {\n        if (id !== this.currentId) {\n            return undefined;\n        }\n        return this.data;\n    }\n}\n\ninterface ClipboardId {\n    readonly clipboardId: string;\n}\n\nfunction toClipboardId(clipboardId: string): string {\n    return JSON.stringify({ clipboardId });\n}\n\nfunction isClipboardId(jsonData: any): jsonData is ClipboardId {\n    return jsonData !== undefined && 'clipboardId' in jsonData;\n}\n\nfunction getClipboardIdFromDataTransfer(dataTransfer: DataTransfer): string | undefined {\n    const jsonString = dataTransfer.getData(CLIPBOARD_DATA_FORMAT);\n    const jsonObject = jsonString ? JSON.parse(jsonString) : undefined;\n    return isClipboardId(jsonObject) ? jsonObject.clipboardId : undefined;\n}\n\nconst CLIPBOARD_DATA_FORMAT = 'text/plain';\n\n@injectable()\nexport class ServerCopyPasteHandler implements ICopyPasteHandler {\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: GLSPActionDispatcher;\n    @inject(TYPES.ViewerOptions) protected viewerOptions: ViewerOptions;\n    @inject(TYPES.IAsyncClipboardService) protected clipboardService: IAsyncClipboardService;\n    @inject(EditorContextService) protected editorContext: EditorContextService;\n\n    handleCopy(event: ClipboardEvent): void {\n        if (event.clipboardData && this.shouldCopy(event)) {\n            const clipboardId = uuid();\n            event.clipboardData.setData(CLIPBOARD_DATA_FORMAT, toClipboardId(clipboardId));\n            this.actionDispatcher\n                .request<SetClipboardDataAction>(RequestClipboardDataAction.create(this.editorContext.get()))\n                .then(action => this.clipboardService.put(action.clipboardData, clipboardId));\n            event.preventDefault();\n        } else {\n            if (event.clipboardData) {\n                event.clipboardData.clearData();\n            }\n            this.clipboardService.clear();\n        }\n    }\n\n    handleCut(event: ClipboardEvent): void {\n        if (event.clipboardData && this.shouldCopy(event)) {\n            this.handleCopy(event);\n            this.actionDispatcher.dispatch(CutOperation.create(this.editorContext.get()));\n            event.preventDefault();\n        }\n    }\n\n    handlePaste(event: ClipboardEvent): void {\n        if (event.clipboardData && this.shouldPaste(event)) {\n            const clipboardId = getClipboardIdFromDataTransfer(event.clipboardData);\n            const clipboardData = this.clipboardService.get(clipboardId);\n            if (clipboardData) {\n                this.actionDispatcher.dispatch(PasteOperation.create({ clipboardData, editorContext: this.editorContext.get() }));\n            }\n            event.preventDefault();\n        }\n    }\n\n    protected shouldCopy(_event: ClipboardEvent): boolean {\n        return this.editorContext.get().selectedElementIds.length > 0 && this.isDiagramActive();\n    }\n\n    protected shouldPaste(_event: ClipboardEvent): boolean {\n        return this.isDiagramActive();\n    }\n\n    private isDiagramActive(): boolean {\n        return document.activeElement?.parentElement?.id === this.viewerOptions.baseDiv;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { Decoration, DecorationPlacer, GChildElement, Point, GModelElement, GRoutableElement, isSizeable } from '@eclipse-glsp/sprotty';\n\n@injectable()\nexport class GlspDecorationPlacer extends DecorationPlacer {\n    protected static readonly DECORATION_OFFSET: Point = { x: 12, y: 10 };\n\n    protected override getPosition(element: GModelElement & Decoration): Point {\n        if (element instanceof GChildElement && element.parent instanceof GRoutableElement) {\n            return super.getPosition(element);\n        }\n        if (isSizeable(element)) {\n            return {\n                x: GlspDecorationPlacer.DECORATION_OFFSET.x * element.bounds.width,\n                y: GlspDecorationPlacer.DECORATION_OFFSET.y * element.bounds.height\n            };\n        }\n        return Point.ORIGIN;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2022-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { v4 as uuid } from 'uuid';\nimport { ExportSvgAction, RequestAction, GModelRoot, SvgExporter } from '@eclipse-glsp/sprotty';\n\n@injectable()\nexport class GLSPSvgExporter extends SvgExporter {\n    override export(root: GModelRoot, _request?: RequestAction<ExportSvgAction>): void {\n        if (typeof document !== 'undefined') {\n            const svgElement = this.findSvgElement();\n            if (svgElement) {\n                // createSvg requires the svg to have a non-empty id, so we generate one if necessary\n                const originalId = svgElement.id;\n                try {\n                    svgElement.id = originalId || uuid();\n                    // provide generated svg code with respective sizing for proper viewing in browser and remove undesired border\n                    const bounds = this.getBounds(root);\n                    const svg = this.createSvg(svgElement, root).replace(\n                        'style=\"',\n                        `style=\"width: ${bounds.width}px !important;height: ${bounds.height}px !important;border: none !important;`\n                    );\n                    // do not give request/response id here as otherwise the action is treated as an unrequested response\n                    this.actionDispatcher.dispatch(ExportSvgAction.create(svg));\n                } finally {\n                    svgElement.id = originalId;\n                }\n            }\n        }\n    }\n\n    protected findSvgElement(): SVGSVGElement | null {\n        const div = document.getElementById(this.options.hiddenDiv);\n        // search for first svg element as hierarchy within Sprotty might change\n        return div && div.querySelector('svg');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    GModelElement,\n    GRoutableElement,\n    GRoutingHandle,\n    RoutingHandleKind,\n    edgeInProgressID,\n    edgeInProgressTargetHandleID,\n    selectFeature\n} from '@eclipse-glsp/sprotty';\n\nexport const reconnectFeature = Symbol('reconnectFeature');\n\n/**\n * Feature extension interface for {@link reconnectFeature}.\n */\nexport interface Reconnectable {}\n\nexport function isReconnectable(element: GModelElement): element is GRoutableElement & Reconnectable {\n    return element instanceof GRoutableElement && element.hasFeature(reconnectFeature);\n}\n\nconst ROUTING_HANDLE_SOURCE_INDEX = -2;\n\nexport function isReconnectHandle(element: GModelElement | undefined): element is GReconnectHandle {\n    return element !== undefined && element instanceof GReconnectHandle;\n}\n\nexport function addReconnectHandles(element: GRoutableElement): void {\n    removeReconnectHandles(element);\n    createReconnectHandle(element, 'source', ROUTING_HANDLE_SOURCE_INDEX);\n    createReconnectHandle(element, 'target', element.routingPoints.length);\n}\n\nexport function removeReconnectHandles(element: GRoutableElement): void {\n    element.removeAll(child => child instanceof GReconnectHandle);\n}\n\nexport function isSourceRoutingHandle(edge: GRoutableElement, routingHandle: GReconnectHandle): boolean {\n    return routingHandle.pointIndex === ROUTING_HANDLE_SOURCE_INDEX;\n}\n\nexport function isTargetRoutingHandle(edge: GRoutableElement, routingHandle: GReconnectHandle): boolean {\n    return routingHandle.pointIndex === edge.routingPoints.length;\n}\n\nexport function createReconnectHandle(edge: GRoutableElement, kind: RoutingHandleKind, routingPointIndex: number): GReconnectHandle {\n    const handle = new GReconnectHandle();\n    handle.kind = kind;\n    handle.pointIndex = routingPointIndex;\n    handle.type = 'routing-point';\n    if (kind === 'target' && edge.id === edgeInProgressID) {\n        handle.id = edgeInProgressTargetHandleID;\n    }\n    edge.add(handle);\n    return handle;\n}\n\nexport class GReconnectHandle extends GRoutingHandle {\n    override hasFeature(feature: symbol): boolean {\n        return feature !== selectFeature && super.hasFeature(feature);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    CommandExecutionContext,\n    Connectable,\n    EdgeTypeHint,\n    IActionHandler,\n    RequestTypeHintsAction,\n    GModelElement,\n    GModelElementSchema,\n    GModelRoot,\n    GRoutableElement,\n    GShapeElement,\n    SetTypeHintsAction,\n    ShapeTypeHint,\n    TYPES,\n    TypeHint,\n    connectableFeature,\n    deletableFeature,\n    editFeature,\n    isConnectable,\n    moveFeature\n} from '@eclipse-glsp/sprotty';\n\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\nimport { IFeedbackActionDispatcher } from '../../base/feedback/feedback-action-dispatcher';\nimport { FeedbackCommand } from '../../base/feedback/feedback-command';\nimport { IDiagramStartup } from '../../base/model/diagram-loader';\nimport { getElementTypeId } from '../../utils/gmodel-util';\nimport { resizeFeature } from '../change-bounds/model';\nimport { reconnectFeature } from '../reconnect/model';\nimport { containerFeature, isContainable, reparentFeature } from './model';\nimport { GEdge } from '../../model';\n\n/**\n * Is dispatched by the {@link TypeHintProvider} to apply the type hints received from the server\n * onto the graphical model. The action is dispatched as persistent feedback to ensure the applied type hints\n * don't get lost after a server-side model update.\n */\nexport interface ApplyTypeHintsAction extends Action {\n    kind: typeof ApplyTypeHintsAction.KIND;\n}\n\nexport namespace ApplyTypeHintsAction {\n    export const KIND = 'applyTypeHints';\n\n    export function is(object: any): object is ApplyTypeHintsAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(): ApplyTypeHintsAction {\n        return { kind: KIND };\n    }\n}\n\ntype CanConnectFn = Connectable['canConnect'];\n\n/**\n * Command that processes the entire model and for each model element applies its\n * type hints i.e. translates the type hint information into corresponding model features\n * and adds/removes them from the model element.\n */\n@injectable()\nexport class ApplyTypeHintsCommand extends FeedbackCommand {\n    public static KIND = ApplyTypeHintsAction.KIND;\n    public override readonly priority = 10;\n\n    @inject(TYPES.ITypeHintProvider)\n    protected typeHintProvider: ITypeHintProvider;\n\n    constructor(@inject(TYPES.Action) protected action: ApplyTypeHintsAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): GModelRoot {\n        context.root.index.all().forEach(element => {\n            if (element instanceof GShapeElement || element instanceof GModelRoot) {\n                return this.applyShapeTypeHint(element);\n            }\n            if (element instanceof GEdge) {\n                this.applyEdgeTypeHint(element);\n            }\n        });\n        return context.root;\n    }\n\n    protected applyEdgeTypeHint(element: GModelElement): void {\n        const hint = this.typeHintProvider.getEdgeTypeHint(element);\n\n        if (hint && element.features instanceof Set) {\n            addOrRemove(element.features, deletableFeature, hint.deletable);\n            addOrRemove(element.features, editFeature, hint.routable);\n            addOrRemove(element.features, reconnectFeature, hint.repositionable);\n        }\n    }\n\n    protected applyShapeTypeHint(element: GModelElement): void {\n        const hint = this.typeHintProvider.getShapeTypeHint(element);\n        if (hint && element.features instanceof Set) {\n            addOrRemove(element.features, deletableFeature, hint.deletable);\n            addOrRemove(element.features, moveFeature, hint.repositionable);\n            addOrRemove(element.features, resizeFeature, hint.resizable);\n            addOrRemove(element.features, reparentFeature, hint.reparentable);\n\n            addOrRemove(element.features, containerFeature, true);\n            if (isContainable(element)) {\n                element.isContainableElement = input => this.isContainableElement(input, hint);\n            }\n\n            const fallbackCanConnect = isConnectable(element) ? element.canConnect.bind(element) : undefined;\n            addOrRemove(element.features, connectableFeature, true);\n            if (isConnectable(element)) {\n                element.canConnect = (routable, role) => this.canConnect(routable, role, element, fallbackCanConnect);\n            }\n        }\n    }\n\n    /**\n     * Type hints aware wrapper function for  `Connectable.canConnect`. After type hints have been applied\n     * the `canConnect` implementation of `connectable` model elements  (with a matching hint) will forward to this method.\n     */\n    protected canConnect(\n        routable: GRoutableElement,\n        role: 'source' | 'target',\n        element: GModelElement,\n        fallbackCanConnect?: CanConnectFn\n    ): boolean {\n        const edgeHint = this.typeHintProvider.getEdgeTypeHint(routable.type);\n        if (!edgeHint) {\n            return fallbackCanConnect?.(routable, role) ?? false;\n        }\n        const validElementIds = role === 'source' ? edgeHint.sourceElementTypeIds : edgeHint.targetElementTypeIds;\n        // If no source/target element ids are defined in the hint all elements are considered valid\n        if (!validElementIds) {\n            return true;\n        }\n        const elementType = element.type + ':';\n        return validElementIds.some(type => elementType.startsWith(type));\n    }\n\n    /**\n     * Type hints aware wrapper function for  `Containable.isContainableElement`. After type hints have been applied\n     * the `isContainableElement` implementation of `containable` model elements (with a matching hint) will forward to this method.\n     */\n    protected isContainableElement(input: GModelElement | GModelElementSchema | string, hint: ShapeTypeHint): boolean {\n        const elemenType = getElementTypeId(input) + ':';\n        return hint.containableElementTypeIds?.some(type => elemenType.startsWith(type)) ?? false;\n    }\n}\n\nfunction addOrRemove(features: Set<symbol>, feature: symbol, add: boolean): void {\n    if (add && !features.has(feature)) {\n        features.add(feature);\n    } else if (!add && features.has(feature)) {\n        features.delete(feature);\n    }\n}\n\n/**\n * Provides query methods for retrieving the type hint that is applicable for a given model element.\n * If there is no type hint registered for the given element type the hint of the most concrete subtype (if any)\n * is returned instead. Subtypes are declared with a `:` delimiter.\n * For example consider the type `node:task:manual`. Then the provider fist checks wether there is\n * a type hint registered for `node:task:manual`. If not it checks wether there is one registered\n * for `node:task` and finally it checks wether there is a type hint for `node`.\n */\nexport interface ITypeHintProvider {\n    /**\n     * Retrieve the most applicable {@link ShapeTypeHint} for the given model element.\n     *\n     * @param input The model element whose type hint should be retrieved\n     * @returns The most applicable hint of the given element or `undefined` if no matching hint is registered.\n     */\n    getShapeTypeHint(input: GModelElement | GModelElementSchema | string): ShapeTypeHint | undefined;\n    /**\n     * Retrieve the most applicable {@link EdgeTypeHint} for the given model element.\n     *\n     * @param input The model element whose type hint should be retrieved\n     * @returns The most applicable hint of the given element or `undefined` if no matching hint is registered.\n     */\n    getEdgeTypeHint(input: GModelElement | GModelElementSchema | string): EdgeTypeHint | undefined;\n}\n\n@injectable()\nexport class TypeHintProvider implements IActionHandler, ITypeHintProvider, IDiagramStartup {\n    @inject(TYPES.IFeedbackActionDispatcher)\n    protected feedbackActionDispatcher: IFeedbackActionDispatcher;\n\n    @inject(GLSPActionDispatcher)\n    protected actionDispatcher: GLSPActionDispatcher;\n\n    protected shapeHints: Map<string, ShapeTypeHint> = new Map();\n    protected edgeHints: Map<string, EdgeTypeHint> = new Map();\n\n    handle(action: SetTypeHintsAction): void {\n        this.shapeHints.clear();\n        this.edgeHints.clear();\n        action.shapeHints.forEach(hint => this.shapeHints.set(hint.elementTypeId, hint));\n        action.edgeHints.forEach(hint => this.edgeHints.set(hint.elementTypeId, hint));\n        this.feedbackActionDispatcher.registerFeedback(this, [ApplyTypeHintsAction.create()]);\n    }\n\n    getShapeTypeHint(input: GModelElement | GModelElementSchema | string): ShapeTypeHint | undefined {\n        return this.getTypeHint(input, this.shapeHints);\n    }\n\n    getEdgeTypeHint(input: GModelElement | GModelElementSchema | string): EdgeTypeHint | undefined {\n        return this.getTypeHint(input, this.edgeHints);\n    }\n\n    protected getTypeHint<T extends TypeHint>(input: GModelElement | GModelElementSchema | string, hints: Map<string, T>): T | undefined {\n        const type = getElementTypeId(input);\n        let hint = hints.get(type);\n        // Check subtypes\n        if (hint === undefined) {\n            const subtypes = type.split(':');\n            while (hint === undefined && subtypes.length > 0) {\n                subtypes.pop();\n                hint = hints.get(subtypes.join(':'));\n                if (hint) {\n                    // add received subtype hint to map to avoid future recomputation\n                    hints.set(type, hint);\n                    break;\n                }\n            }\n        }\n        return hint;\n    }\n\n    async postRequestModel(): Promise<void> {\n        const setTypeHintsAction = await this.actionDispatcher.request(RequestTypeHintsAction.create());\n        this.handle(setTypeHintsAction);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { IView, Point, RenderingContext, GModelElement, svg } from '@eclipse-glsp/sprotty';\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst JSX = { createElement: svg };\n\n/**\n * This view is used for the invisible end of the feedback edge.\n * A feedback edge is shown as a visual feedback when creating edges.\n */\n@injectable()\nexport class FeedbackEdgeEndView implements IView {\n    render(model: Readonly<GModelElement>, context: RenderingContext): VNode {\n        const position: Point = (model as any).position ?? Point.ORIGIN;\n        return <g x={position.x} y={position.y} />;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    BindingContext,\n    CommandExecutionContext,\n    CommandReturn,\n    GChildElement,\n    GModelRoot,\n    GRoutableElement,\n    TYPES,\n    configureCommand,\n    configureView,\n    findParentByFeature,\n    isBoundsAware,\n    isConnectable,\n    GDanglingAnchor,\n    GEdgeSchema\n} from '@eclipse-glsp/sprotty';\nimport { FeedbackCommand } from '../../../base/feedback/feedback-command';\nimport { isRoutable } from '../../../utils/gmodel-util';\nimport { toAbsolutePosition } from '../../../utils/viewpoint-util';\nimport { FeedbackEdgeEndView } from './view';\n\nexport interface DrawFeedbackEdgeAction extends Action {\n    kind: typeof DrawFeedbackEdgeAction.KIND;\n    elementTypeId: string;\n    sourceId: string;\n    edgeSchema?: Partial<GEdgeSchema>;\n}\n\nexport namespace DrawFeedbackEdgeAction {\n    export const KIND = 'drawFeedbackEdge';\n\n    export function is(object: any): object is DrawFeedbackEdgeAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(options: {\n        elementTypeId: string;\n        sourceId: string;\n        edgeSchema?: Partial<GEdgeSchema>;\n    }): DrawFeedbackEdgeAction {\n        return {\n            kind: KIND,\n            ...options\n        };\n    }\n}\n\n@injectable()\nexport class DrawFeedbackEdgeCommand extends FeedbackCommand {\n    static readonly KIND = DrawFeedbackEdgeAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: DrawFeedbackEdgeAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        drawFeedbackEdge(context, this.action.sourceId, this.action.elementTypeId, this.action.edgeSchema);\n        return context.root;\n    }\n}\n\nexport interface RemoveFeedbackEdgeAction extends Action {\n    kind: typeof RemoveFeedbackEdgeAction.KIND;\n}\n\nexport namespace RemoveFeedbackEdgeAction {\n    export const KIND = 'removeFeedbackEdgeCommand';\n\n    export function is(object: any): object is RemoveFeedbackEdgeAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(): RemoveFeedbackEdgeAction {\n        return { kind: KIND };\n    }\n}\n\n@injectable()\nexport class RemoveFeedbackEdgeCommand extends FeedbackCommand {\n    static readonly KIND = RemoveFeedbackEdgeAction.KIND;\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        removeDanglingFeedbackEdge(context.root);\n        return context.root;\n    }\n}\n\nexport class FeedbackEdgeEnd extends GDanglingAnchor {\n    static readonly TYPE = 'feedback-edge-end';\n    constructor(\n        readonly sourceId: string,\n        readonly elementTypeId: string,\n        public feedbackEdge: GRoutableElement | undefined = undefined,\n        override readonly type: string = FeedbackEdgeEnd.TYPE\n    ) {\n        super();\n    }\n}\n\nexport function feedbackEdgeId(root: GModelRoot): string {\n    return root.id + '_feedback_edge';\n}\n\nexport function feedbackEdgeEndId(root: GModelRoot): string {\n    return root.id + '_feedback_anchor';\n}\n\nexport const defaultFeedbackEdgeSchema: Partial<GEdgeSchema> = {\n    cssClasses: ['feedback-edge'],\n    opacity: 0.3\n};\n\nexport function drawFeedbackEdge(\n    context: CommandExecutionContext,\n    sourceId: string,\n    elementTypeId: string,\n    edgeTemplate?: Partial<GEdgeSchema>\n): void {\n    const root = context.root;\n    const sourceChild = root.index.getById(sourceId);\n    if (!sourceChild) {\n        return;\n    }\n\n    const source = findParentByFeature(sourceChild, isConnectable);\n    if (!source || !isBoundsAware(source)) {\n        return;\n    }\n\n    const edgeEnd = new FeedbackEdgeEnd(source.id, elementTypeId);\n    edgeEnd.id = feedbackEdgeEndId(root);\n    edgeEnd.position = toAbsolutePosition(source);\n\n    const edgeSchema: GEdgeSchema = {\n        id: feedbackEdgeId(root),\n        type: elementTypeId,\n        sourceId: source.id,\n        targetId: edgeEnd.id,\n        ...defaultFeedbackEdgeSchema,\n        ...edgeTemplate\n    };\n\n    const feedbackEdge = context.modelFactory.createElement(edgeSchema);\n    if (isRoutable(feedbackEdge)) {\n        edgeEnd.feedbackEdge = feedbackEdge;\n        root.add(edgeEnd);\n        root.add(feedbackEdge);\n    }\n}\n\nexport function removeDanglingFeedbackEdge(root: GModelRoot): void {\n    const feedbackEdge = root.index.getById(feedbackEdgeId(root));\n    const feedbackEdgeEnd = root.index.getById(feedbackEdgeEndId(root));\n    if (feedbackEdge instanceof GChildElement) {\n        root.remove(feedbackEdge);\n    }\n    if (feedbackEdgeEnd instanceof GChildElement) {\n        root.remove(feedbackEdgeEnd);\n    }\n}\n\nexport function configureDanglingFeedbackEdge(context: BindingContext): void {\n    if (!context.isBound(DrawFeedbackEdgeCommand) && !context.isBound(RemoveFeedbackEdgeCommand) && !context.isBound(FeedbackEdgeEndView)) {\n        configureCommand(context, DrawFeedbackEdgeCommand);\n        configureCommand(context, RemoveFeedbackEdgeCommand);\n        configureView(context, FeedbackEdgeEnd.TYPE, FeedbackEdgeEndView);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    Action,\n    AnchorComputerRegistry,\n    Bounds,\n    Disposable,\n    MouseListener,\n    MoveAction,\n    Point,\n    PolylineEdgeRouter,\n    GConnectableElement,\n    GModelElement,\n    findChildrenAtPosition,\n    findParentByFeature,\n    isBoundsAware,\n    isConnectable\n} from '@eclipse-glsp/sprotty';\nimport { IFeedbackActionDispatcher } from '../../../base/feedback/feedback-action-dispatcher';\nimport { absoluteToParent, getAbsolutePosition, toAbsoluteBounds } from '../../../utils/viewpoint-util';\nimport { FeedbackEdgeEnd, feedbackEdgeEndId } from './dangling-edge-feedback';\n\nexport class FeedbackEdgeEndMovingMouseListener extends MouseListener implements Disposable {\n    constructor(protected anchorRegistry: AnchorComputerRegistry, protected feedbackDispatcher: IFeedbackActionDispatcher) {\n        super();\n    }\n\n    override mouseMove(target: GModelElement, event: MouseEvent): Action[] {\n        const root = target.root;\n        const edgeEnd = root.index.getById(feedbackEdgeEndId(root));\n        if (!(edgeEnd instanceof FeedbackEdgeEnd) || !edgeEnd.feedbackEdge) {\n            return [];\n        }\n\n        const edge = edgeEnd.feedbackEdge;\n        const position = getAbsolutePosition(edgeEnd, event);\n        const endAtMousePosition = findChildrenAtPosition(target.root, position)\n            .reverse()\n            .find(element => isConnectable(element) && element.canConnect(edge, 'target'));\n\n        if (endAtMousePosition instanceof GConnectableElement && edge.source && isBoundsAware(edge.source)) {\n            const anchor = this.computeAbsoluteAnchor(endAtMousePosition, Bounds.center(toAbsoluteBounds(edge.source)));\n            if (Point.euclideanDistance(anchor, edgeEnd.position) > 1) {\n                this.feedbackDispatcher.registerFeedback(this, [\n                    MoveAction.create([{ elementId: edgeEnd.id, toPosition: anchor }], { animate: false })\n                ]);\n            }\n        } else {\n            this.feedbackDispatcher.registerFeedback(this, [\n                MoveAction.create([{ elementId: edgeEnd.id, toPosition: position }], { animate: false })\n            ]);\n        }\n\n        return [];\n    }\n\n    protected computeAbsoluteAnchor(element: GConnectableElement, absoluteReferencePoint: Point, offset?: number): Point {\n        const referencePointInParent = absoluteToParent(element, absoluteReferencePoint);\n        const anchorComputer = this.anchorRegistry.get(PolylineEdgeRouter.KIND, element.anchorKind);\n        let anchor = anchorComputer.getAnchor(element, referencePointInParent, offset);\n        // The anchor is computed in the local coordinate system of the element.\n        // If the element is a nested child element we have to add the absolute position of its parent to the anchor.\n        if (element.parent !== element.root) {\n            const parent = findParentByFeature(element.parent, isBoundsAware);\n            if (parent) {\n                const absoluteParentPosition = toAbsoluteBounds(parent);\n                anchor = Point.add(absoluteParentPosition, anchor);\n            }\n        }\n        return anchor;\n    }\n\n    dispose(): void {\n        this.feedbackDispatcher.deregisterFeedback(this);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    AnchorComputerRegistry,\n    CreateEdgeOperation,\n    RequestCheckEdgeAction,\n    GModelElement,\n    TYPES,\n    TriggerEdgeCreationAction,\n    findParentByFeature,\n    isConnectable,\n    isCtrlOrCmd\n} from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../../base/action-dispatcher';\nimport { DragAwareMouseListener } from '../../../base/drag-aware-mouse-listener';\nimport { CursorCSS, cursorFeedbackAction } from '../../../base/feedback/css-feedback';\nimport { EnableDefaultToolsAction } from '../../../base/tool-manager/tool';\nimport { ITypeHintProvider } from '../../hints/type-hint-provider';\nimport { BaseCreationTool } from '../base-tools';\nimport { DrawFeedbackEdgeAction, RemoveFeedbackEdgeAction } from './dangling-edge-feedback';\nimport { FeedbackEdgeEndMovingMouseListener } from './edge-creation-tool-feedback';\nimport { GEdge } from '../../../model';\n\n/**\n * Tool to create connections in a Diagram, by selecting a source and target node.\n */\n@injectable()\nexport class EdgeCreationTool extends BaseCreationTool<TriggerEdgeCreationAction> {\n    static ID = 'tool_create_edge';\n\n    @inject(AnchorComputerRegistry) protected anchorRegistry: AnchorComputerRegistry;\n\n    @inject(TYPES.ITypeHintProvider) protected typeHintProvider: ITypeHintProvider;\n\n    protected isTriggerAction = TriggerEdgeCreationAction.is;\n\n    get id(): string {\n        return EdgeCreationTool.ID;\n    }\n\n    doEnable(): void {\n        const mouseMovingFeedback = new FeedbackEdgeEndMovingMouseListener(this.anchorRegistry, this.feedbackDispatcher);\n        this.toDisposeOnDisable.push(\n            mouseMovingFeedback,\n            this.mouseTool.registerListener(\n                new EdgeCreationToolMouseListener(this.triggerAction, this.actionDispatcher, this.typeHintProvider, this)\n            ),\n            this.mouseTool.registerListener(mouseMovingFeedback),\n            this.registerFeedback([cursorFeedbackAction(CursorCSS.OPERATION_NOT_ALLOWED)], this, [\n                RemoveFeedbackEdgeAction.create(),\n                cursorFeedbackAction()\n            ])\n        );\n    }\n}\n\n@injectable()\nexport class EdgeCreationToolMouseListener extends DragAwareMouseListener {\n    protected source?: string;\n    protected target?: string;\n    protected currentTarget?: GModelElement;\n    protected allowedTarget = false;\n    protected proxyEdge: GEdge;\n    protected pendingDynamicCheck = false;\n\n    constructor(\n        protected triggerAction: TriggerEdgeCreationAction,\n        protected actionDispatcher: GLSPActionDispatcher,\n        protected typeHintProvider: ITypeHintProvider,\n        protected tool: EdgeCreationTool\n    ) {\n        super();\n        this.proxyEdge = new GEdge();\n        this.proxyEdge.type = triggerAction.elementTypeId;\n    }\n\n    protected reinitialize(): void {\n        this.source = undefined;\n        this.target = undefined;\n        this.currentTarget = undefined;\n        this.allowedTarget = false;\n        this.tool.registerFeedback([RemoveFeedbackEdgeAction.create()]);\n    }\n\n    override nonDraggingMouseUp(_element: GModelElement, event: MouseEvent): Action[] {\n        const result: Action[] = [];\n        if (event.button === 0) {\n            if (!this.isSourceSelected()) {\n                if (this.currentTarget && this.allowedTarget) {\n                    this.source = this.currentTarget.id;\n                    this.tool.registerFeedback([\n                        DrawFeedbackEdgeAction.create({ elementTypeId: this.triggerAction.elementTypeId, sourceId: this.source })\n                    ]);\n                }\n            } else if (this.currentTarget && this.allowedTarget) {\n                this.target = this.currentTarget.id;\n            }\n            if (this.source && this.target) {\n                result.push(\n                    CreateEdgeOperation.create({\n                        elementTypeId: this.triggerAction.elementTypeId,\n                        sourceElementId: this.source,\n                        targetElementId: this.target,\n                        args: this.triggerAction.args\n                    })\n                );\n                if (!isCtrlOrCmd(event)) {\n                    result.push(EnableDefaultToolsAction.create());\n                } else {\n                    this.reinitialize();\n                }\n            }\n        } else if (event.button === 2) {\n            this.reinitialize();\n            result.push(EnableDefaultToolsAction.create());\n        }\n        return result;\n    }\n\n    protected isSourceSelected(): boolean {\n        return this.source !== undefined;\n    }\n\n    protected isTargetSelected(): boolean {\n        return this.target !== undefined;\n    }\n\n    override mouseOver(target: GModelElement, event: MouseEvent): Action[] {\n        const newCurrentTarget = findParentByFeature(target, isConnectable);\n        if (newCurrentTarget !== this.currentTarget) {\n            this.pendingDynamicCheck = false;\n            this.currentTarget = newCurrentTarget;\n            if (this.currentTarget) {\n                if (!this.isSourceSelected()) {\n                    this.allowedTarget = this.canConnect(newCurrentTarget, 'source');\n                } else if (!this.isTargetSelected()) {\n                    this.allowedTarget = this.canConnect(newCurrentTarget, 'target');\n                }\n                if (this.pendingDynamicCheck) {\n                    return [cursorFeedbackAction(CursorCSS.EDGE_CHECK_PENDING)];\n                }\n            } else {\n                this.allowedTarget = false;\n            }\n            return [this.updateEdgeFeedback()];\n        }\n        return [];\n    }\n\n    protected updateEdgeFeedback(): Action {\n        if (this.allowedTarget) {\n            const action = !this.isSourceSelected()\n                ? cursorFeedbackAction(CursorCSS.EDGE_CREATION_SOURCE)\n                : cursorFeedbackAction(CursorCSS.EDGE_CREATION_TARGET);\n            return action;\n        }\n        return cursorFeedbackAction(CursorCSS.OPERATION_NOT_ALLOWED);\n    }\n\n    protected canConnect(element: GModelElement | undefined, role: 'source' | 'target'): boolean {\n        if (!element || !isConnectable(element) || !element.canConnect(this.proxyEdge, role)) {\n            return false;\n        }\n        if (!this.isDynamic(this.proxyEdge.type)) {\n            return true;\n        }\n        const sourceElement = this.source ?? element;\n        const targetElement = this.source ? element : undefined;\n\n        this.pendingDynamicCheck = true;\n        // Request server edge check\n        this.actionDispatcher\n            .request(RequestCheckEdgeAction.create({ sourceElement, targetElement, edgeType: this.proxyEdge.type }))\n            .then(result => {\n                if (this.pendingDynamicCheck) {\n                    this.allowedTarget = result.isValid;\n                    this.actionDispatcher.dispatch(this.updateEdgeFeedback());\n                    this.pendingDynamicCheck = false;\n                }\n            })\n            .catch(err => console.error('Dynamic edge check failed with: ', err));\n        // Temporarily mark the target as invalid while we wait for the server response,\n        // so a fast-clicking user doesn't get a chance to create the edge in the meantime.\n        return false;\n    }\n\n    protected isDynamic(edgeTypeId: string): boolean {\n        const typeHint = this.typeHintProvider.getEdgeTypeHint(edgeTypeId);\n        return typeHint?.dynamic ?? false;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    Bounds,\n    GDecoration,\n    GIssue,\n    GIssueSeverity,\n    GParentElement,\n    Marker,\n    MarkerKind,\n    Projectable,\n    SIssueMarker,\n    isBoundsAware\n} from '@eclipse-glsp/sprotty';\n\nexport class GIssueMarker extends SIssueMarker implements Projectable {\n    constructor() {\n        super();\n        this.features = new Set<symbol>(GDecoration.DEFAULT_FEATURES);\n    }\n    projectionCssClasses: string[];\n    projectedBounds?: Bounds;\n    override issues: GIssue[] = [];\n    override type = 'marker';\n\n    computeProjectionCssClasses(): void {\n        const severityCss = getSeverity(this);\n        this.projectionCssClasses = ['sprotty-issue', 'sprotty-' + severityCss];\n    }\n}\n\n/**\n * Retrieves the `GIssueMarker` contained by the provided model element as\n * direct child or a newly instantiated `GIssueMarker` if no child\n * `GIssueMarker` exists.\n * @param modelElement for which the `GIssueMarker` should be retrieved or created.\n * @returns the child `GIssueMarker` or a new `GIssueMarker` if no such child exists.\n */\nexport function getOrCreateGIssueMarker(modelElement: GParentElement): GIssueMarker {\n    let issueMarker: GIssueMarker | undefined;\n\n    issueMarker = getGIssueMarker(modelElement);\n\n    if (issueMarker === undefined) {\n        issueMarker = new GIssueMarker();\n        if (isBoundsAware(modelElement)) {\n            issueMarker.projectedBounds = modelElement.parentToLocal(modelElement.bounds);\n        }\n        modelElement.add(issueMarker);\n    }\n\n    return issueMarker;\n}\n\n/**\n * Retrieves the `GIssueMarker` contained by the provided model element as\n * direct child or `undefined` if such an `GIssueMarker` does not exist.\n * @param modelElement for which the `GIssueMarker` should be retrieved.\n * @returns the child `GIssueMarker` or `undefined` if no such child exists.\n */\nexport function getGIssueMarker(modelElement: GParentElement): GIssueMarker | undefined {\n    let issueMarker: GIssueMarker | undefined;\n\n    for (const child of modelElement.children) {\n        if (child instanceof GIssueMarker) {\n            issueMarker = child;\n        }\n    }\n\n    return issueMarker;\n}\n\n/**\n * Creates an `GIssue` with `severity` and `message` set according to\n * the `kind` and `description` of the provided `Marker`.\n * @param marker `Marker` for that an `GIssue` should be created.\n * @returns the created `GIssue`.\n */\nexport function createGIssue(marker: Marker, parent?: GParentElement): GIssue {\n    const issue = new GIssue();\n    issue.message = marker.description;\n\n    switch (marker.kind) {\n        case MarkerKind.ERROR: {\n            issue.severity = 'error';\n            break;\n        }\n        case MarkerKind.INFO: {\n            issue.severity = 'info';\n            break;\n        }\n        case MarkerKind.WARNING: {\n            issue.severity = 'warning';\n            break;\n        }\n    }\n    return issue;\n}\n\nexport function getSeverity(marker: GIssueMarker): GIssueSeverity {\n    let currentSeverity: GIssueSeverity = 'info';\n    for (const severity of marker.issues.map(s => s.severity)) {\n        if (severity === 'error') {\n            return severity;\n        }\n        if (severity === 'warning' && currentSeverity === 'info') {\n            currentSeverity = severity;\n        }\n    }\n    return currentSeverity;\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport {\n    Action,\n    Bounds,\n    EMPTY_ROOT,\n    HoverFeedbackAction,\n    HoverMouseListener,\n    IActionHandler,\n    ICommand,\n    GPreRenderedElementSchema,\n    RequestPopupModelAction,\n    GModelElement,\n    GModelElementSchema,\n    SetPopupModelAction,\n    GModelRootSchema\n} from '@eclipse-glsp/sprotty';\nimport { FocusStateChangedAction } from '../../base/focus/focus-state-change-action';\nimport { EnableDefaultToolsAction, EnableToolsAction } from '../../base/tool-manager/tool';\nimport { EdgeCreationTool } from '../tools/edge-creation/edge-creation-tool';\nimport { GIssueMarker, getSeverity } from '../validation/issue-marker';\n\n@injectable()\nexport class GlspHoverMouseListener extends HoverMouseListener implements IActionHandler {\n    protected enableHover = true;\n    /**\n     * Stops mouse over timer and remove hover feedback, if focus is lost.\n     *\n     * This fixes strange effects that appear if the mouse left the element via e.g. a context menu,\n     * which explicitly removes the focus of the diagram.\n     * @see SelectionServiceAwareContextMenuMouseListener\n     * @param action should be a `FocusStateChangedAction`\n     * @returns a `HoverFeedbackAction` resetting the state, if the specified action indicates lost focus\n     */\n    handle(action: Action): void | Action | ICommand {\n        if (FocusStateChangedAction.is(action) && !action.hasFocus) {\n            this.stopMouseOverTimer();\n            if (this.lastHoverFeedbackElementId) {\n                const previousTargetId = this.lastHoverFeedbackElementId;\n                this.lastHoverFeedbackElementId = undefined;\n                return HoverFeedbackAction.create({ mouseoverElement: previousTargetId, mouseIsOver: false });\n            }\n        } else if (EnableToolsAction.is(action)) {\n            this.enableHover = !(action as EnableToolsAction).toolIds.includes(EdgeCreationTool.ID);\n        } else if (EnableDefaultToolsAction.is(action)) {\n            this.enableHover = true;\n        }\n    }\n\n    override mouseOver(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        if (this.enableHover) {\n            return super.mouseOver(target, event);\n        }\n        return [];\n    }\n\n    protected override startMouseOverTimer(target: GModelElement, event: MouseEvent): Promise<Action> {\n        this.stopMouseOverTimer();\n        return new Promise(resolve => {\n            this.state.mouseOverTimer = window.setTimeout(() => {\n                const popupBounds = this.computePopupBounds(target, { x: event.pageX, y: event.pageY });\n                if (target instanceof GIssueMarker) {\n                    resolve(SetPopupModelAction.create(this.createPopupModel(target, popupBounds)));\n                } else {\n                    resolve(RequestPopupModelAction.create({ elementId: target.id, bounds: popupBounds }));\n                }\n\n                this.state.popupOpen = true;\n                this.state.previousPopupElement = target;\n            }, this.options.popupOpenDelay);\n        });\n    }\n\n    protected createPopupModel(marker: GIssueMarker, bounds: Bounds): GModelRootSchema {\n        if (marker.issues !== undefined && marker.issues.length > 0) {\n            return {\n                type: 'html',\n                id: 'sprotty-popup',\n                children: [this.createMarkerIssuePopup(marker)],\n                canvasBounds: this.modifyBounds(bounds)\n            };\n        }\n        return { type: EMPTY_ROOT.type, id: EMPTY_ROOT.id };\n    }\n\n    protected createMarkerIssuePopup(marker: GIssueMarker): GModelElementSchema {\n        const message = this.createIssueMessage(marker);\n        return <GPreRenderedElementSchema>{\n            type: 'pre-rendered',\n            id: 'popup-title',\n            code: `<div class=\"${getSeverity(marker)}\"><div class=\"sprotty-popup-title\">${message}</div></div>`\n        };\n    }\n\n    protected createIssueMessage(marker: GIssueMarker): string {\n        return '<ul>' + marker.issues.map(i => '<li>' + i.severity.toUpperCase() + ': ' + i.message + '</li>').join('') + '</ul>';\n    }\n\n    protected modifyBounds(bounds: Bounds): Bounds {\n        return bounds;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { EditLabelKeyListener, EditLabelMouseListener, KeyListener, MouseListener } from '@eclipse-glsp/sprotty';\nimport { BaseEditTool } from '../tools/base-tools';\n\n@injectable()\nexport class DirectLabelEditTool extends BaseEditTool {\n    static readonly ID = 'glsp.direct-label-edit-tool';\n\n    get id(): string {\n        return DirectLabelEditTool.ID;\n    }\n\n    protected createEditLabelMouseListener(): MouseListener {\n        return new EditLabelMouseListener();\n    }\n\n    protected createEditLabelKeyListener(): KeyListener {\n        return new EditLabelKeyListener();\n    }\n\n    enable(): void {\n        this.toDisposeOnDisable.push(\n            this.mouseTool.registerListener(this.createEditLabelMouseListener()),\n            this.keyTool.registerListener(this.createEditLabelKeyListener())\n        );\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    EditLabelValidationResult,\n    EditableLabel,\n    IEditLabelValidationDecorator,\n    IEditLabelValidator,\n    RequestEditValidationAction,\n    GModelElement,\n    SetEditValidationResultAction,\n    Severity,\n    TYPES,\n    ValidationStatus\n} from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\n\nexport namespace LabelEditValidation {\n    export const CONTEXT_ID = 'label-edit';\n\n    export function toEditLabelValidationResult(status: ValidationStatus): EditLabelValidationResult {\n        const message = status.message;\n        let severity: Severity = 'ok';\n        if (ValidationStatus.isError(status)) {\n            severity = 'error';\n        } else if (ValidationStatus.isWarning(status)) {\n            severity = 'warning';\n        }\n        return { message, severity };\n    }\n\n    export function createValidationRequestAction(value: string, labelId: string): RequestEditValidationAction {\n        return RequestEditValidationAction.create({ contextId: CONTEXT_ID, modelElementId: labelId, text: value });\n    }\n}\n\n@injectable()\nexport class ServerEditLabelValidator implements IEditLabelValidator {\n    @inject(TYPES.IActionDispatcher) protected actionDispatcher: GLSPActionDispatcher;\n\n    async validate(value: string, label: EditableLabel & GModelElement): Promise<EditLabelValidationResult> {\n        const action = LabelEditValidation.createValidationRequestAction(value, label.id);\n        const response = await this.actionDispatcher.requestUntil(action);\n        return response ? this.getValidationResultFromResponse(response) : { severity: 'ok' };\n    }\n\n    getValidationResultFromResponse(action: Action): EditLabelValidationResult {\n        if (SetEditValidationResultAction.is(action)) {\n            return LabelEditValidation.toEditLabelValidationResult(action.status);\n        }\n        return { severity: 'ok' };\n    }\n}\n\n@injectable()\nexport class BalloonLabelValidationDecorator implements IEditLabelValidationDecorator {\n    decorate(input: HTMLInputElement, result: EditLabelValidationResult): void {\n        const containerElement = input.parentElement;\n        if (!containerElement) {\n            return;\n        }\n        if (result.message) {\n            containerElement.setAttribute('data-balloon', result.message);\n            containerElement.setAttribute('data-balloon-pos', 'up-left');\n            containerElement.setAttribute('data-balloon-visible', 'true');\n        }\n        switch (result.severity) {\n            case 'ok':\n                containerElement.classList.add('validation-ok');\n                break;\n            case 'warning':\n                containerElement.classList.add('validation-warning');\n                break;\n            case 'error':\n                containerElement.classList.add('validation-error');\n                break;\n        }\n    }\n\n    dispose(input: HTMLInputElement): void {\n        const containerElement = input.parentElement;\n        if (containerElement) {\n            containerElement.removeAttribute('data-balloon');\n            containerElement.removeAttribute('data-balloon-pos');\n            containerElement.removeAttribute('data-balloon-visible');\n            containerElement.classList.remove('validation-ok', 'validation-warning', 'validation-error');\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, optional } from 'inversify';\nimport {\n    Action,\n    ChangeBoundsOperation,\n    ElementAndBounds,\n    ElementMove,\n    IActionDispatcher,\n    IActionHandler,\n    ICommand,\n    MoveAction,\n    GModelElement,\n    SetBoundsAction,\n    TYPES,\n    Writable,\n    hasArrayProp,\n    hasNumberProp,\n    hasStringProp\n} from '@eclipse-glsp/sprotty';\nimport { SelectionService } from '../../base/selection-service';\nimport { toValidElementAndBounds, toValidElementMove } from '../../utils/layout-utils';\nimport { BoundsAwareModelElement, getElements } from '../../utils/gmodel-util';\nimport { isBoundsAwareMoveable, isResizable } from '../change-bounds/model';\nimport { IMovementRestrictor } from '../change-bounds/movement-restrictor';\n\n/**\n * Used to specify the desired resize dimension for a {@link ResizeElementsCommand}.\n */\nexport enum ResizeDimension {\n    Width,\n    Height,\n    Width_And_Height\n}\n\n/**\n * A function that computes a single number from a set of given numbers\n * i.e. it reduces the given numbers to one single number.\n * Mainly used by the {@link ResizeElementsCommand} to reduce the given dimensions to a target dimension value.\n */\nexport type ReduceFunction = (...values: number[]) => number;\n\nexport namespace ReduceFunction {\n    /**\n     * Returns the minimal value of the given numbers.\n     * @param values Numbers to be evaluated.\n     * @returns The reduced number.\n     */\n    export function min(...values: number[]): number {\n        return Math.min(...values);\n    }\n\n    /**\n     * Returns the maximal value of the given numbers.\n     * @param values Numbers to be evaluated.\n     * @returns The reduced number.\n     */\n    export function max(...values: number[]): number {\n        return Math.max(...values);\n    }\n\n    /**\n     * Computes the  average of the given numbers.\n     * @param values Numbers to be evaluated.\n     */\n    export function avg(...values: number[]): number {\n        return values.reduce((a, b) => a + b, 0) / values.length;\n    }\n\n    /**\n     *  Returns the last value of the given numbers.\n     *  @param values Numbers to be evaluated.\n     *  @returns The reduced number.\n     */\n    export function first(...values: number[]): number {\n        return values[0];\n    }\n\n    /**\n     *  Returns the minimal value of the given numbers.\n     *  @param values Numbers  to be evaluated.\n     *  @returns The reduced number.\n     */\n    export function last(...values: number[]): number {\n        return values[values.length - 1];\n    }\n\n    /**\n     * Returns the reduce function that corresponds to the given {@link ReduceFunctionType}.\n     * @param type The reduce function kind.\n     * @returns The corresponding reduce function.\n     */\n    export function get(type: ReduceFunctionType): ReduceFunction {\n        return ReduceFunction[type];\n    }\n}\n\n/** Union type of all {@link ReduceFunction} keys. */\nexport type ReduceFunctionType = Exclude<keyof typeof ReduceFunction, 'get'>;\n\nexport interface ResizeElementsAction extends Action {\n    kind: typeof ResizeElementsAction.KIND;\n\n    /**\n     * IDs of the elements that should be resized. If no IDs are given, the selected elements will be resized.\n     */\n    elementIds: string[];\n\n    /**\n     * Resize dimension. The default is {@link ResizeDimension.Width}.\n     */\n    dimension: ResizeDimension;\n\n    /**\n     * Type of the {@link ReduceFunction} that should be used to reduce the dimension to a target dimension value\n     */\n    reduceFunction: ReduceFunctionType;\n}\n\nexport namespace ResizeElementsAction {\n    export const KIND = 'resizeElementAction';\n\n    export function is(object: any): object is ResizeElementsAction {\n        return (\n            Action.hasKind(object, KIND) &&\n            hasArrayProp(object, 'elementIds') &&\n            hasNumberProp(object, 'dimension') &&\n            hasStringProp(object, 'reduceFunction')\n        );\n    }\n\n    export function create(options: {\n        elementIds?: string[];\n        dimension?: ResizeDimension;\n        reduceFunction: ReduceFunctionType;\n    }): ResizeElementsAction {\n        return {\n            kind: KIND,\n            dimension: ResizeDimension.Width,\n            elementIds: [],\n            ...options\n        };\n    }\n}\n\n@injectable()\nexport abstract class LayoutElementsActionHandler implements IActionHandler {\n    @inject(TYPES.IActionDispatcher)\n    protected actionDispatcher: IActionDispatcher;\n\n    @inject(SelectionService)\n    protected selectionService: SelectionService;\n\n    @inject(TYPES.IMovementRestrictor)\n    @optional()\n    protected movementRestrictor?: IMovementRestrictor;\n\n    abstract handle(action: Action): void | Action | ICommand;\n\n    getSelectedElements(selection: { elementIds: string[] }): BoundsAwareModelElement[] {\n        const index = this.selectionService.getModelRoot().index;\n        const selectedElements = selection.elementIds.length > 0 ? selection.elementIds : this.selectionService.getSelectedElementIDs();\n        return getElements(index, selectedElements, this.isActionElement);\n    }\n\n    protected abstract isActionElement(element: GModelElement): element is BoundsAwareModelElement;\n\n    dispatchAction(action: Action): void {\n        this.actionDispatcher.dispatch(action);\n    }\n\n    dispatchActions(actions: Action[]): void {\n        this.actionDispatcher.dispatchAll(actions);\n    }\n}\n\n@injectable()\nexport class ResizeElementsActionHandler extends LayoutElementsActionHandler {\n    handle(action: ResizeElementsAction): void {\n        const elements = this.getSelectedElements(action);\n        if (elements.length > 1) {\n            const reduceFn = ReduceFunction.get(action.reduceFunction);\n            switch (action.dimension) {\n                case ResizeDimension.Width:\n                    return this.resizeWidth(elements, reduceFn);\n                case ResizeDimension.Height:\n                    return this.resizeHeight(elements, reduceFn);\n                case ResizeDimension.Width_And_Height:\n                    return this.resizeWidthAndHeight(elements, reduceFn);\n            }\n        }\n    }\n\n    resizeWidth(elements: BoundsAwareModelElement[], reduceFn: ReduceFunction): void {\n        const targetWidth = reduceFn(...elements.map(element => element.bounds.width));\n        this.dispatchResizeActions(elements, (element, bounds) => {\n            // resize around center (horizontal)\n            const halfDiffWidth = 0.5 * (targetWidth - element.bounds.width);\n            bounds.newPosition!.x = element.bounds.x - halfDiffWidth;\n            bounds.newSize.width = targetWidth;\n        });\n    }\n\n    resizeHeight(elements: BoundsAwareModelElement[], reduceFn: ReduceFunction): void {\n        const targetHeight = reduceFn(...elements.map(element => element.bounds.height));\n        this.dispatchResizeActions(elements, (element, bounds) => {\n            // resize around middle (vertical)\n            const halfDiffHeight = 0.5 * (targetHeight - element.bounds.height);\n            bounds.newPosition!.y = element.bounds.y - halfDiffHeight;\n            bounds.newSize.height = targetHeight;\n        });\n    }\n\n    resizeWidthAndHeight(elements: BoundsAwareModelElement[], reduceFn: ReduceFunction): void {\n        const targetWidth = reduceFn(...elements.map(element => element.bounds.width));\n        const targetHeight = reduceFn(...elements.map(element => element.bounds.height));\n        this.dispatchResizeActions(elements, (element, bounds) => {\n            // resize around center and middle (horizontal & vertical)\n            const halfDiffWidth = 0.5 * (targetWidth - element.bounds.width);\n            const halfDiffHeight = 0.5 * (targetHeight - element.bounds.height);\n            bounds.newPosition = { x: element.bounds.x - halfDiffWidth, y: element.bounds.y - halfDiffHeight };\n            bounds.newSize = { width: targetWidth, height: targetHeight };\n        });\n    }\n\n    dispatchResizeActions(\n        elements: BoundsAwareModelElement[],\n        change: (element: BoundsAwareModelElement, bounds: Writable<ElementAndBounds>) => void\n    ): void {\n        const elementAndBounds: ElementAndBounds[] = []; // client- and server-side resize\n\n        elements.forEach(element => {\n            const elementChange = this.createElementAndBounds(element, change);\n            if (elementChange) {\n                // simply skip invalid changes\n                elementAndBounds.push(elementChange);\n            }\n        });\n        this.dispatchActions([SetBoundsAction.create(elementAndBounds), ChangeBoundsOperation.create(elementAndBounds)]);\n    }\n\n    createElementAndBounds(\n        element: BoundsAwareModelElement,\n        change: (_element: BoundsAwareModelElement, _bounds: Writable<ElementAndBounds>) => void\n    ): Writable<ElementAndBounds> | undefined {\n        const bounds: ElementAndBounds = {\n            elementId: element.id,\n            newPosition: {\n                x: element.bounds.x,\n                y: element.bounds.y\n            },\n            newSize: {\n                width: element.bounds.width,\n                height: element.bounds.height\n            }\n        };\n        change(element, bounds);\n        return toValidElementAndBounds(element, bounds, this.movementRestrictor);\n    }\n    protected isActionElement(element: GModelElement): element is BoundsAwareModelElement {\n        return isResizable(element);\n    }\n}\n\nexport enum Alignment {\n    Left,\n    Center,\n    Right,\n    Top,\n    Middle,\n    Bottom\n}\n\n/**\n * A function that retrieves a specific (sub)-selection of elements from a given set of elements.\n * Mainly used by the {@link AlignElementsActionHandler}.\n */\nexport type SelectFunction = (elements: BoundsAwareModelElement[]) => BoundsAwareModelElement[];\nexport namespace SelectFunction {\n    /**\n     * Select all elements from the given set of elements.\n     * @param elements The set of elements.\n     * @returns All elements.\n     */\n    export function all(elements: BoundsAwareModelElement[]): BoundsAwareModelElement[] {\n        return elements;\n    }\n\n    /**\n     * Select the first element from a given set of elements.\n     * @param elements The elements.\n     * @returns An array containing the first element of the given elements.\n     */\n    export function first(elements: BoundsAwareModelElement[]): BoundsAwareModelElement[] {\n        return [elements[0]];\n    }\n\n    /**\n     * Select the last element from a given set of elements.\n     * @param elements The elements.\n     * @returns An array containing the last element of the given elements.\n     */\n    export function last(elements: BoundsAwareModelElement[]): BoundsAwareModelElement[] {\n        return [elements[elements.length - 1]];\n    }\n\n    /**\n     * Returns the select function that corresponds to the given {@link SelectFunctionType}.\n     * @param type The select function type.\n     * @returns The corresponding select function.\n     */\n    export function get(kind: SelectFunctionType): SelectFunction {\n        return SelectFunction[kind];\n    }\n}\n\n/** Union type of all {@link SelectFunction} keys. */\nexport type SelectFunctionType = Exclude<keyof typeof SelectFunction, 'get'>;\n\nexport interface AlignElementsAction extends Action {\n    kind: typeof AlignElementsAction.KIND;\n\n    /**\n     * IDs of the elements that should be aligned. If no IDs are given, the selected elements will be aligned.\n     */\n    elementIds: string[];\n    /**\n     * Alignment direction. The default is {@link Alignment.Left}\n     */\n    alignment: Alignment;\n    /**\n     * Function to selected elements that are considered during alignment calculation.\n     * The default value is {@link Select.all}.\n     */\n    selectFunction: SelectFunctionType;\n}\n\nexport namespace AlignElementsAction {\n    export const KIND = 'alignElements';\n\n    export function is(object: any): object is AlignElementsAction {\n        return (\n            Action.hasKind(object, KIND) &&\n            hasArrayProp(object, 'elementIds') &&\n            hasNumberProp(object, 'alignment') &&\n            hasStringProp(object, 'selectFunction')\n        );\n    }\n\n    export function create(\n        options: { elementIds?: string[]; alignment?: Alignment; selectionFunction?: SelectFunctionType } = {}\n    ): AlignElementsAction {\n        return {\n            kind: KIND,\n            elementIds: [],\n            alignment: Alignment.Left,\n            selectFunction: 'all',\n            ...options\n        };\n    }\n}\n\n@injectable()\nexport class AlignElementsActionHandler extends LayoutElementsActionHandler {\n    handle(action: AlignElementsAction): void {\n        const elements = this.getSelectedElements(action);\n        const selectFn = SelectFunction.get(action.selectFunction);\n        const calculatedElements = selectFn(elements);\n        if (elements.length > 1) {\n            switch (action.alignment) {\n                case Alignment.Left:\n                    return this.alignLeft(calculatedElements);\n                case Alignment.Center:\n                    return this.alignCenter(calculatedElements);\n                case Alignment.Right:\n                    return this.alignRight(calculatedElements);\n                case Alignment.Top:\n                    return this.alignTop(calculatedElements);\n                case Alignment.Middle:\n                    return this.alignMiddle(calculatedElements);\n                case Alignment.Bottom:\n                    return this.alignBottom(calculatedElements);\n            }\n        }\n    }\n\n    alignLeft(elements: BoundsAwareModelElement[]): void {\n        const minX = elements.map(element => element.bounds.x).reduce((a, b) => Math.min(a, b));\n        this.dispatchAlignActions(elements, (_, move) => (move.toPosition.x = minX));\n    }\n\n    alignCenter(elements: BoundsAwareModelElement[]): void {\n        const minX = elements.map(element => element.bounds.x).reduce((a, b) => Math.min(a, b));\n        const maxX = elements.map(element => element.bounds.x + element.bounds.width).reduce((a, b) => Math.max(a, b));\n        const diffX = maxX - minX;\n        const centerX = minX + 0.5 * diffX;\n        this.dispatchAlignActions(elements, (element, move) => (move.toPosition.x = centerX - 0.5 * element.bounds.width));\n    }\n\n    alignRight(elements: BoundsAwareModelElement[]): void {\n        const maxX = elements.map(element => element.bounds.x + element.bounds.width).reduce((a, b) => Math.max(a, b));\n        this.dispatchAlignActions(elements, (element, move) => (move.toPosition.x = maxX - element.bounds.width));\n    }\n\n    alignTop(elements: BoundsAwareModelElement[]): void {\n        const minY = elements.map(element => element.bounds.y).reduce((a, b) => Math.min(a, b));\n        this.dispatchAlignActions(elements, (_, move) => (move.toPosition.y = minY));\n    }\n\n    alignMiddle(elements: BoundsAwareModelElement[]): void {\n        const minY = elements.map(element => element.bounds.y).reduce((a, b) => Math.min(a, b));\n        const maxY = elements.map(element => element.bounds.y + element.bounds.height).reduce((a, b) => Math.max(a, b));\n        const diffY = maxY - minY;\n        const middleY = minY + 0.5 * diffY;\n        this.dispatchAlignActions(elements, (element, move) => (move.toPosition.y = middleY - 0.5 * element.bounds.height));\n    }\n\n    alignBottom(elements: BoundsAwareModelElement[]): void {\n        const maxY = elements.map(element => element.bounds.y + element.bounds.height).reduce((a, b) => Math.max(a, b));\n        this.dispatchAlignActions(elements, (element, move) => (move.toPosition.y = maxY - element.bounds.height));\n    }\n\n    dispatchAlignActions(\n        elements: BoundsAwareModelElement[],\n        change: (element: BoundsAwareModelElement, move: Writable<ElementMove>) => void\n    ): void {\n        const moves: ElementMove[] = []; // client-side move\n        const elementAndBounds: ElementAndBounds[] = []; // server-side move\n        elements.forEach(element => {\n            const move = this.createElementMove(element, change);\n            if (move) {\n                // simply skip invalid changes\n                moves.push(move);\n                const elementAndBound = this.createElementAndBounds(element, move);\n                elementAndBounds.push(elementAndBound);\n            }\n        });\n        this.dispatchActions([MoveAction.create(moves), ChangeBoundsOperation.create(elementAndBounds)]);\n    }\n\n    createElementMove(\n        element: BoundsAwareModelElement,\n        change: (_element: BoundsAwareModelElement, _move: Writable<ElementMove>) => void\n    ): Writable<ElementMove> | undefined {\n        const move: ElementMove = {\n            elementId: element.id,\n            fromPosition: {\n                x: element.bounds.x,\n                y: element.bounds.y\n            },\n            toPosition: {\n                x: element.bounds.x,\n                y: element.bounds.y\n            }\n        };\n        change(element, move);\n        return toValidElementMove(element, move, this.movementRestrictor);\n    }\n\n    createElementAndBounds(element: BoundsAwareModelElement, move: ElementMove): ElementAndBounds {\n        return {\n            elementId: element.id,\n            newPosition: {\n                x: move.toPosition.x,\n                y: move.toPosition.y\n            },\n            newSize: {\n                width: element.bounds.width,\n                height: element.bounds.height\n            }\n        };\n    }\n    protected isActionElement(element: GModelElement): element is BoundsAwareModelElement {\n        return isBoundsAwareMoveable(element);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    IActionDispatcher,\n    ILogger,\n    NavigationTarget,\n    ResolveNavigationTargetAction,\n    ResponseAction,\n    SetResolvedNavigationTargetAction,\n    TYPES\n} from '@eclipse-glsp/sprotty';\nimport { IDiagramOptions } from '../../base/model/diagram-loader';\n\n/**\n * Resolves `NavigationTargets` to element ids.\n *\n * If the `NavigationTarget` doesn't have element ids itself, this resolver queries the server via a\n * `ResolveNavigationTargetAction` for element ids.\n */\n@injectable()\nexport class NavigationTargetResolver {\n    @inject(TYPES.IActionDispatcher)\n    protected dispatcher: IActionDispatcher;\n\n    @inject(TYPES.ILogger)\n    protected logger: ILogger;\n\n    @inject(TYPES.IDiagramOptions)\n    protected diagramOptions: IDiagramOptions;\n\n    async resolve(navigationTarget: NavigationTarget): Promise<SetResolvedNavigationTargetAction | undefined> {\n        return this.resolveWithSourceUri(this.diagramOptions.sourceUri, navigationTarget);\n    }\n\n    async resolveWithSourceUri(\n        sourceUri: string | undefined,\n        target: NavigationTarget\n    ): Promise<SetResolvedNavigationTargetAction | undefined> {\n        const targetUri = decodeURIComponent(target.uri);\n        if (sourceUri && sourceUri !== targetUri && `file://${sourceUri}` !== targetUri) {\n            // different URI, so we can't resolve it locally\n            this.logger.info(\"Source and Target URI are different. Can't resolve locally.\", sourceUri, targetUri);\n            return undefined;\n        }\n        if (NavigationTarget.getElementIds(target).length > 0) {\n            return SetResolvedNavigationTargetAction.create(NavigationTarget.getElementIds(target));\n        }\n        const response = await this.requestResolution(target);\n        if (SetResolvedNavigationTargetAction.is(response)) {\n            return response;\n        }\n        return undefined;\n    }\n\n    protected requestResolution(target: NavigationTarget): Promise<ResponseAction> {\n        return this.dispatcher.request(ResolveNavigationTargetAction.create(target));\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    ActionHandlerRegistry,\n    Args,\n    CenterAction,\n    IActionDispatcher,\n    IActionHandler,\n    ICommand,\n    ILogger,\n    MessageAction,\n    NavigateToExternalTargetAction,\n    NavigateToTargetAction,\n    NavigationTarget,\n    RequestNavigationTargetsAction,\n    SelectAction,\n    SelectAllAction,\n    SetNavigationTargetsAction,\n    SetResolvedNavigationTargetAction,\n    SeverityLevel,\n    StatusAction,\n    TYPES,\n    hasObjectProp,\n    hasStringProp\n} from '@eclipse-glsp/sprotty';\nimport { EditorContextServiceProvider } from '../../base/editor-context-service';\nimport { NavigationTargetResolver } from './navigation-target-resolver';\n\n/**\n * Action for triggering a navigation of a certain target type.\n *\n * Examples for target types could be `documentation`, `implementation`, etc.\n * but this is up to the domain-specific diagram implementation to decide.\n * Such an action will eventually trigger a `RequestNavigationTargetsAction`\n * (see `NavigationActionHandler`) in order to request the navigation targets\n * from the server.\n *\n * This action is typically triggered by a user action.\n */\n\nexport interface NavigateAction extends Action {\n    kind: typeof NavigateAction.KIND;\n    /**\n     * Navigation target type, such as `documentation`, `implementation`, etc.\n     */\n    targetTypeId: string;\n    /**\n     * Additional arguments for customization.\n     */\n    args?: Args;\n}\n\nexport namespace NavigateAction {\n    export const KIND = 'navigate';\n\n    export function is(object: any): object is NavigateAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'targetTypeId');\n    }\n\n    export function create(targetTypeId: string, options: { args?: Args } = {}): NavigateAction {\n        return {\n            kind: KIND,\n            targetTypeId,\n            ...options\n        };\n    }\n}\n\n/**\n * Action to trigger the processing of additional navigation arguments.\n * The resolution of a `NavigationTarget` may entail additional arguments. In this case, this action is\n * triggered allowing the client to react to those arguments. The default `NavigationActionHandler` will\n * only process the arguments' keys `info`, `warning`, and `error` to present them to the user.\n * Customizations, however, may add domain-specific arguments and register custom handler to also process\n * other arguments and trigger some additional behavior (e.g. update other views, etc.).\n */\n\nexport interface ProcessNavigationArgumentsAction extends Action {\n    kind: typeof ProcessNavigationArgumentsAction.KIND;\n    /**\n     * The navigation arguments.\n     */\n    args: Args;\n}\n\nexport namespace ProcessNavigationArgumentsAction {\n    export const KIND = 'processNavigationArguments';\n\n    export function is(object: any): object is ProcessNavigationArgumentsAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'args');\n    }\n\n    export function create(args: Args): ProcessNavigationArgumentsAction {\n        return {\n            kind: KIND,\n            args\n        };\n    }\n}\n/**\n * Default handler for all actions that are related to the navigation.\n *\n * For a `NavigateAction` this handler triggers a `RequestNavigationTargetAction` to obtain the actual\n * navigation targets for the navigation type that is specified in the `NavigateAction`.\n * Once the navigation targets are available, it will trigger a `NavigateToTargetAction` to actually\n * perform the navigation.\n *\n * In other scenarios, clients may also trigger the `NavigateToTargetAction` directly, e.g. when opening\n * the diagram.\n *\n * Depending on the URI and arguments of the navigation target we may encounter three cases:\n *   *(a)* the navigation target already specifies element IDs, in which case this action handler navigates\n *         to the specified elements directly, by the selecting them and centering them in the viewport.\n *   *(b)* the arguments of the navigation targets don't contain element IDs, but other arguments, the\n *         navigation target needs to be resolved into actual element IDs by the `NavigationTargetResolver`.\n *         This can for instance be useful, if the navigation deals with queries or some other more complex\n *         logic that can't be dealt with on the client.\n *  *(c)* the target isn't resolved by the `NavigationTargetResolver`, e.g. because the `uri` doesn't match\n *        the URI of the current diagram. In this case, the navigation request is forwarded by dispatching\n *        a `NavigateToExternalTargetAction`.\n */\n@injectable()\nexport class NavigationActionHandler implements IActionHandler {\n    readonly notificationTimeout = 5000;\n\n    @inject(TYPES.ILogger) protected logger: ILogger;\n    @inject(TYPES.IActionDispatcher) protected dispatcher: IActionDispatcher;\n    @inject(TYPES.ActionHandlerRegistryProvider) protected actionHandlerRegistryProvider: () => Promise<ActionHandlerRegistry>;\n    @inject(TYPES.IEditorContextServiceProvider) protected editorContextService: EditorContextServiceProvider;\n    @inject(NavigationTargetResolver) protected resolver: NavigationTargetResolver;\n\n    handle(action: Action): ICommand | Action | void {\n        if (NavigateAction.is(action)) {\n            this.handleNavigateAction(action);\n        } else if (NavigateToTargetAction.is(action)) {\n            this.handleNavigateToTarget(action);\n        } else if (ProcessNavigationArgumentsAction.is(action)) {\n            this.processNavigationArguments(action.args);\n        } else if (NavigateToExternalTargetAction.is(action)) {\n            this.handleNavigateToExternalTarget(action);\n        }\n    }\n\n    protected async handleNavigateAction(action: NavigateAction): Promise<void> {\n        try {\n            const editorContextService = await this.editorContextService();\n            const editorContext = editorContextService.get(action.args);\n            const response = await this.dispatcher.request(\n                RequestNavigationTargetsAction.create({ targetTypeId: action.targetTypeId, editorContext })\n            );\n            if (SetNavigationTargetsAction.is(response) && response.targets && response.targets.length === 1) {\n                if (response.targets.length > 1) {\n                    this.logger.warn(\n                        this,\n                        'Processing of multiple targets is not supported yet. ' + 'Only the first is being processed.',\n                        response.targets\n                    );\n                }\n                return this.dispatcher.dispatch(NavigateToTargetAction.create(response.targets[0]));\n            }\n            this.warnAboutFailedNavigation('No valid navigation target found');\n        } catch (reason) {\n            this.logger.error(this, 'Failed to obtain navigation target', reason, action);\n        }\n    }\n\n    protected async handleNavigateToTarget(action: NavigateToTargetAction): Promise<void> {\n        try {\n            const resolvedElements = await this.resolveElements(action);\n            if (this.containsElementIdsOrArguments(resolvedElements)) {\n                this.navigateTo(resolvedElements);\n                this.handleResolutionArguments(resolvedElements);\n                return;\n            } else {\n                this.navigateToExternal(action.target);\n                return;\n            }\n        } catch (reason) {\n            this.logger.error(this, 'Failed to navigate', reason, action);\n        }\n    }\n\n    protected resolveElements(action: NavigateToTargetAction): Promise<SetResolvedNavigationTargetAction | undefined> {\n        return this.resolver.resolve(action.target);\n    }\n\n    protected containsElementIdsOrArguments(\n        target: SetResolvedNavigationTargetAction | undefined\n    ): target is SetResolvedNavigationTargetAction {\n        return target !== undefined && (this.containsElementIds(target.elementIds) || this.containsArguments(target.args));\n    }\n\n    protected containsElementIds(elementIds: string[] | undefined): elementIds is string[] {\n        return elementIds !== undefined && elementIds.length > 0;\n    }\n\n    protected containsArguments(args: Args | undefined): args is Args {\n        return args !== undefined && args !== undefined && Object.keys(args).length > 0;\n    }\n\n    protected navigateTo(target: SetResolvedNavigationTargetAction): void {\n        const elementIds = target.elementIds;\n        if (!this.containsElementIds(elementIds)) {\n            return;\n        }\n        this.dispatcher.dispatchAll([\n            SelectAllAction.create(false),\n            SelectAction.create({ selectedElementsIDs: elementIds }),\n            CenterAction.create(elementIds)\n        ]);\n    }\n\n    protected handleResolutionArguments(target: SetResolvedNavigationTargetAction): void {\n        const args = target.args;\n        if (!this.containsArguments(args)) {\n            return;\n        }\n        this.dispatcher.dispatch(ProcessNavigationArgumentsAction.create(args));\n    }\n\n    protected navigateToExternal(target: NavigationTarget): Promise<void> {\n        return this.dispatcher.dispatch(NavigateToExternalTargetAction.create(target));\n    }\n\n    protected processNavigationArguments(args: Args): void {\n        if (args.info && args.info.toString().length > 0) {\n            this.notify('INFO', args.info.toString());\n        }\n        if (args.warning && args.warning.toString().length > 0) {\n            this.notify('WARNING', args.warning.toString());\n        }\n        if (args.error && args.error.toString().length > 0) {\n            this.notify('ERROR', args.error.toString());\n        }\n    }\n\n    protected async handleNavigateToExternalTarget(action: NavigateToExternalTargetAction): Promise<void> {\n        const registry = await this.actionHandlerRegistryProvider();\n        const handlers = registry.get(NavigateToExternalTargetAction.KIND);\n        if (handlers.length === 1) {\n            // we are the only handler so we know nobody took care of it\n            this.warnAboutFailedNavigation('Could not resolve or navigate to target', action.target);\n        }\n    }\n\n    protected warnAboutFailedNavigation(msg: string, target?: NavigationTarget): void {\n        const message = `${msg}` + (target ? `: '${target.uri}' (arguments: ${JSON.stringify(target.args)})` : '');\n        this.logger.warn(this, msg, target);\n        this.notify('WARNING', message);\n    }\n\n    private notify(severity: SeverityLevel, message: string): void {\n        const timeout = this.notificationTimeout;\n        this.dispatcher.dispatchAll([StatusAction.create(message, { severity, timeout }), MessageAction.create(message, { severity })]);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2022-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ManhattanEdgeRouter, ResolvedHandleMove, GRoutableElement, almostEquals } from '@eclipse-glsp/sprotty';\n\nexport class GLSPManhattanEdgeRouter extends ManhattanEdgeRouter {\n    protected override applyInnerHandleMoves(edge: GRoutableElement, moves: ResolvedHandleMove[]): void {\n        const route = this.route(edge);\n        const routingPoints = edge.routingPoints;\n        const minimalPointDistance = this.getOptions(edge).minimalPointDistance;\n        moves.forEach(move => {\n            const handle = move.handle;\n            const index = handle.pointIndex;\n            const correctedX = this.correctX(routingPoints, index, move.toPosition.x, minimalPointDistance);\n            const correctedY = this.correctY(routingPoints, index, move.toPosition.y, minimalPointDistance);\n            switch (handle.kind) {\n                case 'manhattan-50%':\n                    if (index < 0) {\n                        if (routingPoints.length === 0) {\n                            routingPoints.push({ x: correctedX, y: correctedY });\n                            move.handle.pointIndex = 0;\n                        } else if (almostEquals(route[0].x, route[1].x)) {\n                            this.alignX(routingPoints, 0, correctedX);\n                        } else {\n                            this.alignY(routingPoints, 0, correctedY);\n                        }\n                    } else if (index < routingPoints.length - 1) {\n                        if (almostEquals(routingPoints[index].x, routingPoints[index + 1].x)) {\n                            this.alignX(routingPoints, index, correctedX);\n                            this.alignX(routingPoints, index + 1, correctedX);\n                        } else {\n                            this.alignY(routingPoints, index, correctedY);\n                            this.alignY(routingPoints, index + 1, correctedY);\n                        }\n                    } else {\n                        if (almostEquals(route[route.length - 2].x, route[route.length - 1].x)) {\n                            this.alignX(routingPoints, routingPoints.length - 1, correctedX);\n                        } else {\n                            this.alignY(routingPoints, routingPoints.length - 1, correctedY);\n                        }\n                    }\n                    break;\n            }\n        });\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Action, KeyListener, GModelRoot, SaveModelAction, matchesKeystroke } from '@eclipse-glsp/sprotty';\n\nexport class SaveModelKeyboardListener extends KeyListener {\n    override keyDown(_element: GModelRoot, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'KeyS', 'ctrlCmd')) {\n            return [SaveModelAction.create()];\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { Command, CommandExecutionContext, GModelRoot, SelectAction, SprottySelectCommand, TYPES } from '@eclipse-glsp/sprotty';\nimport { SelectFeedbackAction } from '../../base/selection-service';\n\n@injectable()\nexport class SelectFeedbackCommand extends Command {\n    static readonly KIND = SelectFeedbackAction.KIND;\n    private sprottySelectCommand: SprottySelectCommand;\n\n    constructor(@inject(TYPES.Action) public action: SelectFeedbackAction) {\n        super();\n        this.sprottySelectCommand = new SprottySelectCommand({ ...action, kind: SelectAction.KIND });\n    }\n\n    execute(context: CommandExecutionContext): GModelRoot {\n        return this.sprottySelectCommand.execute(context);\n    }\n\n    undo(context: CommandExecutionContext): GModelRoot {\n        return this.sprottySelectCommand.undo(context);\n    }\n\n    redo(context: CommandExecutionContext): GModelRoot {\n        return this.sprottySelectCommand.redo(context);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Action, BringToFrontAction, GModelElement, SelectAction, SelectMouseListener, Selectable } from '@eclipse-glsp/sprotty';\nimport { Ranked } from '../../base/ranked';\n\n/**\n * Ranked select mouse listener that is executed before default mouse listeners when using the RankedMouseTool.\n * This ensures that default mouse listeners are working on a model that has selection changes already applied.\n */\nexport class RankedSelectMouseListener extends SelectMouseListener implements Ranked {\n    rank: number = Ranked.DEFAULT_RANK - 100; /* we want to be executed before all default mouse listeners */\n\n    protected override handleSelectTarget(\n        selectableTarget: GModelElement & Selectable,\n        deselectedElements: GModelElement[],\n        event: MouseEvent\n    ): (Action | Promise<Action>)[] {\n        const result: Action[] = [];\n        result.push(\n            SelectAction.create({\n                selectedElementsIDs: [selectableTarget.id],\n                deselectedElementsIDs: deselectedElements.map(e => e.id)\n            })\n        );\n        result.push(BringToFrontAction.create([selectableTarget.id]));\n\n        return result;\n    }\n\n    protected override handleDeselectTarget(selectableTarget: GModelElement & Selectable, event: MouseEvent): (Action | Promise<Action>)[] {\n        const result: Action[] = [];\n        result.push(SelectAction.create({ selectedElementsIDs: [], deselectedElementsIDs: [selectableTarget.id] }));\n        return result;\n    }\n\n    protected override handleDeselectAll(deselectedElements: GModelElement[], event: MouseEvent): (Action | Promise<Action>)[] {\n        const result: Action[] = [];\n        result.push(SelectAction.create({ selectedElementsIDs: [], deselectedElementsIDs: deselectedElements.map(e => e.id) }));\n        return result;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, optional } from 'inversify';\nimport {\n    Action,\n    IActionDispatcher,\n    IActionHandler,\n    MessageAction,\n    SourceModelChangedAction,\n    StatusAction,\n    TYPES,\n    ViewerOptions\n} from '@eclipse-glsp/sprotty';\n\n/**\n * An external handler of the source model change event.\n *\n * This allows external applications to react specifically to this event, e.g. by bringing up the diagram,\n * check their dirty state, show a dialog, etc.\n */\n@injectable()\nexport abstract class ExternalSourceModelChangedHandler {\n    /**\n     * Notifies about a change of the source model.\n     * @returns actions to be dispatched after the notification.\n     */\n    abstract notifySourceModelChange(sourceModelName: string, options: ViewerOptions): Promise<Action[]>;\n}\n\n@injectable()\nexport class SourceModelChangedActionHandler implements IActionHandler {\n    @inject(TYPES.IActionDispatcher)\n    protected dispatcher: IActionDispatcher;\n\n    @inject(TYPES.ViewerOptions)\n    protected options: ViewerOptions;\n\n    @inject(ExternalSourceModelChangedHandler)\n    @optional()\n    protected externalModelSourceChangedHandler?: ExternalSourceModelChangedHandler;\n\n    handle(action: Action): void {\n        if (SourceModelChangedAction.is(action)) {\n            if (this.externalModelSourceChangedHandler) {\n                this.externalModelSourceChangedHandler\n                    .notifySourceModelChange(action.sourceModelName, this.options)\n                    .then(actions => this.dispatcher.dispatchAll(actions));\n                return;\n            }\n            this.showSimpleNotification(action);\n        }\n    }\n\n    protected showSimpleNotification(action: SourceModelChangedAction): void {\n        const message = `The source model ${action.sourceModelName} has changed. You might want to consider reloading.`;\n        const timeout = 0;\n        const severity = 'WARNING';\n        this.dispatcher.dispatchAll([StatusAction.create(message, { severity, timeout }), MessageAction.create(message, { severity })]);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { AbstractUIExtension, IActionHandler, StatusAction, codiconCSSClasses } from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\nimport { EditorContextService } from '../../base/editor-context-service';\nimport { IDiagramStartup } from '../../base/model/diagram-loader';\n\n/**\n * A reusable status overlay for rendering (icon + message) and handling of {@link StatusAction}'s.\n */\n@injectable()\nexport class StatusOverlay extends AbstractUIExtension implements IActionHandler, IDiagramStartup {\n    static readonly ID = 'glsp.server.status.overlay';\n\n    @inject(GLSPActionDispatcher)\n    protected actionDispatcher: GLSPActionDispatcher;\n\n    @inject(EditorContextService)\n    protected editorContext: EditorContextService;\n\n    protected statusIconDiv?: HTMLDivElement;\n    protected statusMessageDiv?: HTMLDivElement;\n    protected pendingTimeout?: number;\n\n    override id(): string {\n        return StatusOverlay.ID;\n    }\n\n    override containerClass(): string {\n        return 'sprotty-status';\n    }\n    protected override initializeContents(containerElement: HTMLElement): void {\n        this.statusIconDiv = document.createElement('div');\n        containerElement.appendChild(this.statusIconDiv);\n\n        this.statusMessageDiv = document.createElement('div');\n        this.statusMessageDiv.classList.add('sprotty-status-message');\n        containerElement.appendChild(this.statusMessageDiv);\n    }\n\n    protected setStatus(status: StatusAction): void {\n        if (this.statusMessageDiv) {\n            this.statusMessageDiv.textContent = status.message;\n            this.removeClasses(this.statusMessageDiv, 1);\n            this.statusMessageDiv.classList.add(status.severity.toLowerCase());\n        }\n        if (this.statusIconDiv) {\n            this.removeClasses(this.statusIconDiv, 0);\n            const classes = this.statusIconDiv.classList;\n            classes.add(status.severity.toLowerCase());\n            switch (status.severity) {\n                case 'FATAL':\n                    classes.add(...codiconCSSClasses('error'));\n                    break;\n                case 'ERROR':\n                    classes.add(...codiconCSSClasses('warning'));\n                    break;\n                case 'WARNING':\n                    classes.add(...codiconCSSClasses('warning'));\n                    break;\n                case 'INFO':\n                    classes.add(...codiconCSSClasses('info'));\n                    break;\n            }\n        }\n    }\n\n    protected clearStatus(): void {\n        this.setStatus(StatusAction.create('', { severity: 'NONE' }));\n    }\n\n    protected clearTimeout(): void {\n        if (this.pendingTimeout) {\n            window.clearTimeout(this.pendingTimeout);\n            this.pendingTimeout = undefined;\n        }\n    }\n\n    protected removeClasses(element: Element, keep: number): void {\n        const classes = element.classList;\n        while (classes.length > keep) {\n            const item = classes.item(classes.length - 1);\n            if (item) {\n                classes.remove(item);\n            }\n        }\n    }\n\n    handle(action: StatusAction): void {\n        this.clearTimeout();\n        if (action.severity === 'NONE') {\n            this.clearStatus();\n            return;\n        }\n        this.setStatus(action);\n\n        // Check for timeout\n        const statusTimeout = action.timeout ?? -1;\n        if (statusTimeout > 0) {\n            this.pendingTimeout = window.setTimeout(() => this.clearStatus(), statusTimeout);\n        }\n    }\n\n    preInitialize(): void {\n        this.show(this.editorContext.modelRoot);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { DOMHelper, GChildElement, GModelElement, GModelRoot, IVNodePostprocessor, TYPES, setAttr } from '@eclipse-glsp/sprotty';\nimport { inject, injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { GEdge } from '../../model';\n\n@injectable()\nexport class MetadataPlacer implements IVNodePostprocessor {\n    @inject(TYPES.DOMHelper) protected domHelper: DOMHelper;\n\n    decorate(vnode: VNode, element: GModelElement): VNode {\n        if (element instanceof GModelRoot) {\n            setAttr(vnode, 'data-svg-metadata-api', true);\n        }\n\n        setAttr(vnode, 'data-svg-metadata-type', element.type);\n\n        if (element instanceof GChildElement) {\n            setAttr(vnode, 'data-svg-metadata-parent-id', this.domHelper.createUniqueDOMElementId(element.parent));\n        }\n        if (element instanceof GEdge) {\n            if (element.source !== undefined) {\n                setAttr(vnode, 'data-svg-metadata-edge-source-id', this.domHelper.createUniqueDOMElementId(element.source));\n            }\n            if (element.target !== undefined) {\n                setAttr(vnode, 'data-svg-metadata-edge-target-id', this.domHelper.createUniqueDOMElementId(element.target));\n            }\n        }\n        return vnode;\n    }\n\n    postUpdate(): void {\n        // empty\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    DeleteElementOperation,\n    KeyListener,\n    KeyTool,\n    MouseListener,\n    GModelElement,\n    findParentByFeature,\n    isCtrlOrCmd,\n    isDeletable,\n    isSelectable,\n    matchesKeystroke\n} from '@eclipse-glsp/sprotty';\nimport { CursorCSS, cursorFeedbackAction } from '../../../base/feedback/css-feedback';\nimport { EnableDefaultToolsAction, Tool } from '../../../base/tool-manager/tool';\nimport { BaseEditTool } from '../base-tools';\n\n/**\n * Deletes selected elements when hitting the `Del` key.\n */\n@injectable()\nexport class DelKeyDeleteTool implements Tool {\n    static ID = 'glsp.delete-keyboard';\n\n    isEditTool = true;\n    protected deleteKeyListener: DeleteKeyListener = new DeleteKeyListener();\n\n    @inject(KeyTool) protected readonly keytool: KeyTool;\n\n    get id(): string {\n        return DelKeyDeleteTool.ID;\n    }\n\n    enable(): void {\n        this.keytool.register(this.deleteKeyListener);\n    }\n\n    disable(): void {\n        this.keytool.deregister(this.deleteKeyListener);\n    }\n}\n\n@injectable()\nexport class DeleteKeyListener extends KeyListener {\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'Delete')) {\n            const deleteElementIds = Array.from(\n                element.root.index\n                    .all()\n                    .filter(e => isDeletable(e) && isSelectable(e) && e.selected)\n                    .filter(e => e.id !== e.root.id)\n                    .map(e => e.id)\n            );\n            if (deleteElementIds.length > 0) {\n                return [DeleteElementOperation.create(deleteElementIds)];\n            }\n        }\n        return [];\n    }\n}\n\n/**\n * Deletes selected elements when clicking on them.\n */\n@injectable()\nexport class MouseDeleteTool extends BaseEditTool {\n    static ID = 'glsp.delete-mouse';\n\n    protected deleteToolMouseListener: DeleteToolMouseListener = new DeleteToolMouseListener();\n\n    get id(): string {\n        return MouseDeleteTool.ID;\n    }\n\n    enable(): void {\n        this.toDisposeOnDisable.push(\n            this.mouseTool.registerListener(this.deleteToolMouseListener),\n            this.registerFeedback([cursorFeedbackAction(CursorCSS.ELEMENT_DELETION)], this, [cursorFeedbackAction()])\n        );\n    }\n}\n\n@injectable()\nexport class DeleteToolMouseListener extends MouseListener {\n    override mouseUp(target: GModelElement, event: MouseEvent): Action[] {\n        const deletableParent = findParentByFeature(target, isDeletable);\n        if (deletableParent === undefined) {\n            return [];\n        }\n        const result: Action[] = [];\n        result.push(DeleteElementOperation.create([deletableParent.id]));\n        if (!isCtrlOrCmd(event)) {\n            result.push(EnableDefaultToolsAction.create());\n        }\n        return result;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    Action,\n    AnchorComputerRegistry,\n    CommandExecutionContext,\n    CommandReturn,\n    GChildElement,\n    MouseListener,\n    Point,\n    GModelElement,\n    GModelRoot,\n    TYPES,\n    hasObjectProp\n} from '@eclipse-glsp/sprotty';\nimport { FeedbackCommand } from '../../../base/feedback/feedback-command';\n\nexport interface DrawMarqueeAction extends Action {\n    kind: typeof DrawMarqueeAction.KIND;\n    startPoint: Point;\n    endPoint: Point;\n}\n\nexport namespace DrawMarqueeAction {\n    export const KIND = 'drawMarquee';\n\n    export function is(object: any): object is DrawMarqueeAction {\n        return Action.hasKind(object, KIND) && hasObjectProp(object, 'startPoint') && hasObjectProp(object, 'endPoint');\n    }\n\n    export function create(options: { startPoint: Point; endPoint: Point }): DrawMarqueeAction {\n        return {\n            kind: KIND,\n            ...options\n        };\n    }\n}\n\n@injectable()\nexport class DrawMarqueeCommand extends FeedbackCommand {\n    static readonly KIND = DrawMarqueeAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: DrawMarqueeAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        drawMarquee(context, this.action.startPoint, this.action.endPoint);\n        return context.root;\n    }\n}\n\nexport interface RemoveMarqueeAction extends Action {\n    kind: typeof RemoveMarqueeAction.KIND;\n}\n\nexport namespace RemoveMarqueeAction {\n    export const KIND = 'removeMarquee';\n\n    export function is(object: any): object is RemoveMarqueeAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(): RemoveMarqueeAction {\n        return { kind: KIND };\n    }\n}\n\n@injectable()\nexport class RemoveMarqueeCommand extends FeedbackCommand {\n    static readonly KIND = RemoveMarqueeAction.KIND;\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        removeMarquee(context.root);\n        return context.root;\n    }\n}\n\nexport class MarqueeEndMovingMouseListener extends MouseListener {\n    constructor(protected anchorRegistry: AnchorComputerRegistry) {\n        super();\n    }\n\n    override mouseMove(target: GModelElement, event: MouseEvent): Action[] {\n        return [];\n    }\n}\n\nexport function marqueeId(root: GModelRoot): string {\n    return root.id + '_' + MARQUEE;\n}\n\nexport const MARQUEE = 'marquee';\n\nexport function drawMarquee(context: CommandExecutionContext, startPoint: Point, endPoint: Point): void {\n    const root = context.root;\n\n    removeMarquee(root);\n\n    const marqueeSchema = {\n        type: MARQUEE,\n        id: marqueeId(root),\n        startPoint: startPoint,\n        endPoint: endPoint\n    };\n\n    const marquee = context.modelFactory.createElement(marqueeSchema);\n    root.add(marquee);\n}\n\nexport function removeMarquee(root: GModelRoot): void {\n    const marquee = root.index.getById(marqueeId(root));\n    if (marquee instanceof GChildElement) {\n        root.remove(marquee);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Bounds, Point, PointToPointLine } from '@eclipse-glsp/sprotty';\nimport { DrawMarqueeAction } from './marquee-tool-feedback';\n\nexport interface IMarqueeBehavior {\n    readonly entireElement: boolean;\n    readonly entireEdge: boolean;\n}\n\nexport class MarqueeUtil {\n    protected startPoint: Point;\n    protected currentPoint: Point;\n    protected marqueeBehavior: IMarqueeBehavior;\n\n    constructor(marqueeBehavior?: IMarqueeBehavior) {\n        if (marqueeBehavior) {\n            this.marqueeBehavior = marqueeBehavior;\n        } else {\n            this.marqueeBehavior = { entireElement: false, entireEdge: false };\n        }\n    }\n\n    updateStartPoint(position: Point): void {\n        this.startPoint = position;\n    }\n\n    updateCurrentPoint(position: Point): void {\n        this.currentPoint = position;\n    }\n\n    drawMarqueeAction(): DrawMarqueeAction {\n        return DrawMarqueeAction.create({ startPoint: this.startPoint, endPoint: this.currentPoint });\n    }\n\n    isEdgePathMarked(path: string | null): boolean {\n        if (!path) {\n            return false;\n        }\n        const points = path\n            .split(/M|L/)\n            .filter(p => p)\n            .map(p => {\n                const coord = p.split(',');\n                return { x: parseInt(coord[0], 10), y: parseInt(coord[1], 10) };\n            });\n        return this.isEdgeMarked(points);\n    }\n\n    isEdgeMarked(points: Point[]): boolean {\n        return this.marqueeBehavior.entireEdge ? this.isEntireEdgeMarked(points) : this.isPartOfEdgeMarked(points);\n    }\n\n    isNodeMarked(elementBounds: Bounds): boolean {\n        const horizontallyIn =\n            this.startPoint.x < this.currentPoint.x\n                ? this.isElementBetweenXAxis(elementBounds, this.startPoint.x, this.currentPoint.x)\n                : this.isElementBetweenXAxis(elementBounds, this.currentPoint.x, this.startPoint.x);\n        const verticallyIn =\n            this.startPoint.y < this.currentPoint.y\n                ? this.isElementBetweenYAxis(elementBounds, this.startPoint.y, this.currentPoint.y)\n                : this.isElementBetweenYAxis(elementBounds, this.currentPoint.y, this.startPoint.y);\n        return horizontallyIn && verticallyIn;\n    }\n\n    protected isEntireEdgeMarked(points: Point[]): boolean {\n        for (let i = 0; i < points.length; i++) {\n            if (!this.pointInRect(points[i])) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    protected isPartOfEdgeMarked(points: Point[]): boolean {\n        for (let i = 0; i < points.length - 1; i++) {\n            if (this.isLineMarked(points[i], points[i + 1])) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    protected isLineMarked(point1: Point, point2: Point): boolean {\n        const line = new PointToPointLine(point1, point2);\n        return (\n            this.pointInRect(point1) ||\n            this.pointInRect(point2) ||\n            this.lineIntersect(line, this.startPoint, { x: this.startPoint.x, y: this.currentPoint.y }) ||\n            this.lineIntersect(line, this.startPoint, { x: this.currentPoint.x, y: this.startPoint.y }) ||\n            this.lineIntersect(line, { x: this.currentPoint.x, y: this.startPoint.y }, this.currentPoint) ||\n            this.lineIntersect(line, { x: this.startPoint.x, y: this.currentPoint.y }, this.currentPoint)\n        );\n    }\n\n    protected lineIntersect(line: PointToPointLine, p1: Point, p2: Point): boolean {\n        return line.intersection(new PointToPointLine(p1, p2)) !== undefined;\n    }\n\n    protected pointInRect(point: Point): boolean {\n        const boolX =\n            this.startPoint.x <= this.currentPoint.x\n                ? this.isBetween(point.x, this.startPoint.x, this.currentPoint.x)\n                : this.isBetween(point.x, this.currentPoint.x, this.startPoint.x);\n        const boolY =\n            this.startPoint.y <= this.currentPoint.y\n                ? this.isBetween(point.y, this.startPoint.y, this.currentPoint.y)\n                : this.isBetween(point.y, this.currentPoint.y, this.startPoint.y);\n        return boolX && boolY;\n    }\n\n    protected isElementBetweenXAxis(elementBounds: Bounds, marqueeLeft: number, marqueeRight: number): boolean {\n        const leftEdge = this.isBetween(elementBounds.x, marqueeLeft, marqueeRight);\n        const rightEdge = this.isBetween(elementBounds.x + elementBounds.width, marqueeLeft, marqueeRight);\n        if (this.marqueeBehavior.entireElement) {\n            return leftEdge && rightEdge;\n        }\n        return (\n            leftEdge ||\n            rightEdge ||\n            this.isBetween(marqueeLeft, elementBounds.x, elementBounds.x + elementBounds.width) ||\n            this.isBetween(marqueeRight, elementBounds.x, elementBounds.x + elementBounds.width)\n        );\n    }\n\n    protected isElementBetweenYAxis(elementBounds: Bounds, marqueeTop: number, marqueeBottom: number): boolean {\n        const topEdge = this.isBetween(elementBounds.y, marqueeTop, marqueeBottom);\n        const bottomEdge = this.isBetween(elementBounds.y + elementBounds.height, marqueeTop, marqueeBottom);\n        if (this.marqueeBehavior.entireElement) {\n            return topEdge && bottomEdge;\n        }\n        return (\n            topEdge ||\n            bottomEdge ||\n            this.isBetween(marqueeTop, elementBounds.y, elementBounds.y + elementBounds.height) ||\n            this.isBetween(marqueeBottom, elementBounds.y, elementBounds.y + elementBounds.height)\n        );\n    }\n\n    protected isBetween(x: number, lower: number, upper: number): boolean {\n        return lower <= x && x <= upper;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    Action,\n    BoundsAware,\n    DOMHelper,\n    GModelElement,\n    GModelRoot,\n    GNode,\n    KeyListener,\n    SelectAction,\n    TYPES,\n    isSelectable,\n    isSelected\n} from '@eclipse-glsp/sprotty';\nimport { inject, injectable, optional } from 'inversify';\nimport { DragAwareMouseListener } from '../../../base/drag-aware-mouse-listener';\nimport { CursorCSS, cursorFeedbackAction } from '../../../base/feedback/css-feedback';\nimport { EnableDefaultToolsAction } from '../../../base/tool-manager/tool';\nimport { getAbsolutePosition, toAbsoluteBounds } from '../../../utils/viewpoint-util';\nimport { BaseEditTool } from '../base-tools';\nimport { IMarqueeBehavior, MarqueeUtil } from './marquee-behavior';\nimport { RemoveMarqueeAction } from './marquee-tool-feedback';\nimport { GEdge } from '../../../model';\n\n@injectable()\nexport class MarqueeMouseTool extends BaseEditTool {\n    static ID = 'glsp.marquee-mouse-tool';\n\n    @inject(TYPES.DOMHelper) protected domHelper: DOMHelper;\n    @inject(TYPES.IMarqueeBehavior) @optional() protected marqueeBehavior: IMarqueeBehavior;\n\n    protected shiftKeyListener: ShiftKeyListener = new ShiftKeyListener();\n\n    get id(): string {\n        return MarqueeMouseTool.ID;\n    }\n\n    enable(): void {\n        this.toDisposeOnDisable.push(\n            this.mouseTool.registerListener(new MarqueeMouseListener(this.domHelper, this.editorContext.modelRoot, this.marqueeBehavior)),\n            this.keyTool.registerListener(this.shiftKeyListener),\n            this.registerFeedback([cursorFeedbackAction(CursorCSS.MARQUEE)], this, [cursorFeedbackAction()])\n        );\n    }\n}\n\nexport class MarqueeMouseListener extends DragAwareMouseListener {\n    protected domHelper: DOMHelper;\n    protected marqueeUtil: MarqueeUtil;\n    protected nodes: (GModelElement & BoundsAware)[];\n    protected edges: SVGGElement[];\n    protected previouslySelected: string[];\n    protected isActive = false;\n\n    constructor(domHelper: DOMHelper, root: GModelRoot, marqueeBehavior: IMarqueeBehavior | undefined) {\n        super();\n        this.domHelper = domHelper;\n        this.marqueeUtil = new MarqueeUtil(marqueeBehavior);\n        this.nodes = Array.from(\n            root.index\n                .all()\n                .map(e => e as GModelElement & BoundsAware)\n                .filter(e => isSelectable(e))\n                .filter(e => e instanceof GNode)\n        );\n        const sEdges = Array.from(\n            root.index\n                .all()\n                .filter(e => e instanceof GEdge)\n                .filter(e => isSelectable(e))\n                .map(e => e.id)\n        );\n        this.edges = Array.from(document.querySelectorAll('g')).filter(e => sEdges.includes(this.domHelper.findSModelIdByDOMElement(e)));\n    }\n\n    override mouseDown(target: GModelElement, event: MouseEvent): Action[] {\n        this.isActive = true;\n        this.marqueeUtil.updateStartPoint(getAbsolutePosition(target, event));\n        if (event.ctrlKey) {\n            this.previouslySelected = Array.from(\n                target.root.index\n                    .all()\n                    .map(e => e as GModelElement & BoundsAware)\n                    .filter(e => isSelected(e))\n                    .map(e => e.id)\n            );\n        }\n        return [];\n    }\n\n    override mouseMove(target: GModelElement, event: MouseEvent): Action[] {\n        this.marqueeUtil.updateCurrentPoint(getAbsolutePosition(target, event));\n        if (this.isActive) {\n            const nodeIdsSelected = this.nodes.filter(e => this.marqueeUtil.isNodeMarked(toAbsoluteBounds(e))).map(e => e.id);\n            const edgeIdsSelected = this.edges.filter(e => this.isEdgeMarked(e)).map(e => this.domHelper.findSModelIdByDOMElement(e));\n            const selected = nodeIdsSelected.concat(edgeIdsSelected);\n            return [SelectAction.setSelection(selected.concat(this.previouslySelected)), this.marqueeUtil.drawMarqueeAction()];\n        }\n        return [];\n    }\n\n    override mouseUp(_target: GModelElement, event: MouseEvent): Action[] {\n        this.isActive = false;\n        if (event.shiftKey) {\n            return [RemoveMarqueeAction.create()];\n        }\n        return [RemoveMarqueeAction.create(), EnableDefaultToolsAction.create()];\n    }\n\n    isEdgeMarked(element: SVGElement): boolean {\n        if (!element.getAttribute('transform')) {\n            if (element.children[0]) {\n                const path = element.children[0].getAttribute('d');\n                return this.marqueeUtil.isEdgePathMarked(path);\n            }\n        }\n        return false;\n    }\n}\n\n@injectable()\nexport class ShiftKeyListener extends KeyListener {\n    override keyUp(element: GModelElement, event: KeyboardEvent): Action[] {\n        if (event.shiftKey) {\n            return [];\n        }\n        return [RemoveMarqueeAction.create(), EnableDefaultToolsAction.create()];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, postConstruct } from 'inversify';\nimport {\n    AbstractUIExtension,\n    Action,\n    IActionHandler,\n    ICommand,\n    MarkersReason,\n    PaletteItem,\n    RequestContextActions,\n    RequestMarkersAction,\n    GModelRoot,\n    SetContextActions,\n    SetUIExtensionVisibilityAction,\n    codiconCSSClasses,\n    matchesKeystroke\n} from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\nimport { EditorContextService, IEditModeListener } from '../../base/editor-context-service';\nimport { FocusTracker } from '../../base/focus/focus-tracker';\nimport { IDiagramStartup } from '../../base/model/diagram-loader';\nimport { EnableDefaultToolsAction, EnableToolsAction } from '../../base/tool-manager/tool';\nimport { MouseDeleteTool } from '../tools/deletion/delete-tool';\nimport { MarqueeMouseTool } from '../tools/marquee-selection/marquee-mouse-tool';\n\nconst CLICKED_CSS_CLASS = 'clicked';\nconst SEARCH_ICON_ID = 'search';\nconst PALETTE_ICON_ID = 'symbol-color';\nconst CHEVRON_DOWN_ICON_ID = 'chevron-right';\nconst PALETTE_HEIGHT = '500px';\n\nexport interface EnableToolPaletteAction extends Action {\n    kind: typeof EnableToolPaletteAction.KIND;\n}\n\nexport namespace EnableToolPaletteAction {\n    export const KIND = 'enableToolPalette';\n\n    export function is(object: any): object is EnableToolPaletteAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(): EnableToolPaletteAction {\n        return { kind: KIND };\n    }\n}\n@injectable()\nexport class ToolPalette extends AbstractUIExtension implements IActionHandler, IEditModeListener, IDiagramStartup {\n    static readonly ID = 'tool-palette';\n\n    @inject(GLSPActionDispatcher)\n    protected actionDispatcher: GLSPActionDispatcher;\n\n    @inject(EditorContextService)\n    protected editorContext: EditorContextService;\n\n    @inject(FocusTracker)\n    protected focusTracker: FocusTracker;\n\n    protected paletteItems: PaletteItem[];\n    protected paletteItemsCopy: PaletteItem[] = [];\n    protected bodyDiv?: HTMLElement;\n    protected lastActiveButton?: HTMLElement;\n    protected defaultToolsButton: HTMLElement;\n    protected searchField: HTMLInputElement;\n    modelRootId: string;\n\n    id(): string {\n        return ToolPalette.ID;\n    }\n    containerClass(): string {\n        return ToolPalette.ID;\n    }\n\n    @postConstruct()\n    postConstruct(): void {\n        this.editorContext.onEditModeChanged(change => this.editModeChanged(change.newValue, change.oldValue));\n    }\n\n    override initialize(): boolean {\n        if (!this.paletteItems) {\n            return false;\n        }\n        return super.initialize();\n    }\n\n    protected initializeContents(containerElement: HTMLElement): void {\n        this.createHeader();\n        this.createBody();\n        this.lastActiveButton = this.defaultToolsButton;\n        containerElement.setAttribute('aria-label', 'Tool-Palette');\n    }\n\n    protected override onBeforeShow(_containerElement: HTMLElement, root: Readonly<GModelRoot>): void {\n        this.modelRootId = root.id;\n        this.containerElement.style.maxHeight = PALETTE_HEIGHT;\n    }\n\n    protected addMinimizePaletteButton(): void {\n        const baseDiv = document.getElementById(this.options.baseDiv);\n        const minPaletteDiv = document.createElement('div');\n        minPaletteDiv.classList.add('minimize-palette-button');\n        this.containerElement.classList.add('collapsible-palette');\n        if (baseDiv) {\n            const insertedDiv = baseDiv.insertBefore(minPaletteDiv, baseDiv.firstChild);\n            const minimizeIcon = createIcon(CHEVRON_DOWN_ICON_ID);\n            this.updateMinimizePaletteButtonTooltip(minPaletteDiv);\n            minimizeIcon.onclick = _event => {\n                if (this.isPaletteMaximized()) {\n                    this.containerElement.style.maxHeight = '0px';\n                } else {\n                    this.containerElement.style.maxHeight = PALETTE_HEIGHT;\n                }\n                this.updateMinimizePaletteButtonTooltip(minPaletteDiv);\n                changeCodiconClass(minimizeIcon, PALETTE_ICON_ID);\n                changeCodiconClass(minimizeIcon, CHEVRON_DOWN_ICON_ID);\n            };\n            insertedDiv.appendChild(minimizeIcon);\n        }\n    }\n\n    protected updateMinimizePaletteButtonTooltip(button: HTMLDivElement): void {\n        if (this.isPaletteMaximized()) {\n            button.title = 'Minimize palette';\n        } else {\n            button.title = 'Maximize palette';\n        }\n    }\n\n    protected isPaletteMaximized(): boolean {\n        return this.containerElement && this.containerElement.style.maxHeight !== '0px';\n    }\n\n    protected createBody(): void {\n        const bodyDiv = document.createElement('div');\n        bodyDiv.classList.add('palette-body');\n        let tabIndex = 0;\n        this.paletteItems.sort(compare).forEach(item => {\n            if (item.children) {\n                const group = createToolGroup(item);\n                item.children.sort(compare).forEach(child => group.appendChild(this.createToolButton(child, tabIndex++)));\n                bodyDiv.appendChild(group);\n            } else {\n                bodyDiv.appendChild(this.createToolButton(item, tabIndex++));\n            }\n        });\n        if (this.paletteItems.length === 0) {\n            const noResultsDiv = document.createElement('div');\n            noResultsDiv.innerText = 'No results found.';\n            noResultsDiv.classList.add('tool-button');\n            bodyDiv.appendChild(noResultsDiv);\n        }\n        // Remove existing body to refresh filtered entries\n        if (this.bodyDiv) {\n            this.containerElement.removeChild(this.bodyDiv);\n        }\n        this.containerElement.appendChild(bodyDiv);\n        this.bodyDiv = bodyDiv;\n    }\n\n    protected createHeader(): void {\n        this.addMinimizePaletteButton();\n        const headerCompartment = document.createElement('div');\n        headerCompartment.classList.add('palette-header');\n        headerCompartment.append(this.createHeaderTitle());\n        headerCompartment.appendChild(this.createHeaderTools());\n        headerCompartment.appendChild((this.searchField = this.createHeaderSearchField()));\n        this.containerElement.appendChild(headerCompartment);\n    }\n\n    protected createHeaderTools(): HTMLElement {\n        const headerTools = document.createElement('div');\n        headerTools.classList.add('header-tools');\n\n        this.defaultToolsButton = this.createDefaultToolButton();\n        headerTools.appendChild(this.defaultToolsButton);\n\n        const deleteToolButton = this.createMouseDeleteToolButton();\n        headerTools.appendChild(deleteToolButton);\n\n        const marqueeToolButton = this.createMarqueeToolButton();\n        headerTools.appendChild(marqueeToolButton);\n\n        const validateActionButton = this.createValidateButton();\n        headerTools.appendChild(validateActionButton);\n\n        // Create button for Search\n        const searchIcon = this.createSearchButton();\n        headerTools.appendChild(searchIcon);\n\n        return headerTools;\n    }\n\n    protected createDefaultToolButton(): HTMLElement {\n        const button = createIcon('inspect');\n        button.id = 'btn_default_tools';\n        button.title = 'Enable selection tool';\n        button.onclick = this.onClickStaticToolButton(button);\n        button.ariaLabel = button.title;\n        button.tabIndex = 1;\n        return button;\n    }\n\n    protected createMouseDeleteToolButton(): HTMLElement {\n        const deleteToolButton = createIcon('chrome-close');\n        deleteToolButton.title = 'Enable deletion tool';\n        deleteToolButton.onclick = this.onClickStaticToolButton(deleteToolButton, MouseDeleteTool.ID);\n        deleteToolButton.ariaLabel = deleteToolButton.title;\n        deleteToolButton.tabIndex = 1;\n        return deleteToolButton;\n    }\n\n    protected createMarqueeToolButton(): HTMLElement {\n        const marqueeToolButton = createIcon('screen-full');\n        marqueeToolButton.title = 'Enable marquee tool';\n        marqueeToolButton.onclick = this.onClickStaticToolButton(marqueeToolButton, MarqueeMouseTool.ID);\n        marqueeToolButton.ariaLabel = marqueeToolButton.title;\n        marqueeToolButton.tabIndex = 1;\n        return marqueeToolButton;\n    }\n\n    protected createValidateButton(): HTMLElement {\n        const validateActionButton = createIcon('pass');\n        validateActionButton.title = 'Validate model';\n        validateActionButton.onclick = _event => {\n            const modelIds: string[] = [this.modelRootId];\n            this.actionDispatcher.dispatch(RequestMarkersAction.create(modelIds, { reason: MarkersReason.BATCH }));\n            validateActionButton.focus();\n        };\n        validateActionButton.ariaLabel = validateActionButton.title;\n        validateActionButton.tabIndex = 1;\n        return validateActionButton;\n    }\n\n    protected createSearchButton(): HTMLElement {\n        const searchIcon = createIcon(SEARCH_ICON_ID);\n        searchIcon.onclick = _ev => {\n            const searchField = document.getElementById(this.containerElement.id + '_search_field');\n            if (searchField) {\n                if (searchField.style.display === 'none') {\n                    searchField.style.display = '';\n                    searchField.focus();\n                } else {\n                    searchField.style.display = 'none';\n                }\n            }\n        };\n        searchIcon.classList.add('search-icon');\n        searchIcon.title = 'Filter palette entries';\n        searchIcon.ariaLabel = searchIcon.title;\n        searchIcon.tabIndex = 1;\n        return searchIcon;\n    }\n\n    protected createHeaderSearchField(): HTMLInputElement {\n        const searchField = document.createElement('input');\n        searchField.classList.add('search-input');\n        searchField.id = this.containerElement.id + '_search_field';\n        searchField.type = 'text';\n        searchField.placeholder = ' Search...';\n        searchField.style.display = 'none';\n        searchField.onkeyup = () => this.requestFilterUpdate(this.searchField.value);\n        searchField.onkeydown = ev => this.clearOnEscape(ev);\n        return searchField;\n    }\n\n    protected createHeaderTitle(): HTMLElement {\n        const header = document.createElement('div');\n        header.classList.add('header-icon');\n        header.appendChild(createIcon(PALETTE_ICON_ID));\n        header.insertAdjacentText('beforeend', 'Palette');\n        return header;\n    }\n\n    protected createToolButton(item: PaletteItem, index: number): HTMLElement {\n        const button = document.createElement('div');\n        button.tabIndex = index;\n        button.classList.add('tool-button');\n        if (item.icon) {\n            button.appendChild(createIcon(item.icon));\n        }\n        button.insertAdjacentText('beforeend', item.label);\n        button.onclick = this.onClickCreateToolButton(button, item);\n        button.onkeydown = ev => this.clearToolOnEscape(ev);\n        return button;\n    }\n\n    protected onClickCreateToolButton(button: HTMLElement, item: PaletteItem) {\n        return (_ev: MouseEvent) => {\n            if (!this.editorContext.isReadonly) {\n                this.actionDispatcher.dispatchAll(item.actions);\n                this.changeActiveButton(button);\n                button.focus();\n            }\n        };\n    }\n\n    protected onClickStaticToolButton(button: HTMLElement, toolId?: string) {\n        return (_ev: MouseEvent) => {\n            if (!this.editorContext.isReadonly) {\n                const action = toolId ? EnableToolsAction.create([toolId]) : EnableDefaultToolsAction.create();\n                this.actionDispatcher.dispatch(action);\n                this.changeActiveButton(button);\n                button.focus();\n            }\n        };\n    }\n\n    changeActiveButton(button?: HTMLElement): void {\n        if (this.lastActiveButton) {\n            this.lastActiveButton.classList.remove(CLICKED_CSS_CLASS);\n        }\n        if (button) {\n            button.classList.add(CLICKED_CSS_CLASS);\n            this.lastActiveButton = button;\n        } else if (this.defaultToolsButton) {\n            this.defaultToolsButton.classList.add(CLICKED_CSS_CLASS);\n            this.lastActiveButton = this.defaultToolsButton;\n        }\n    }\n\n    handle(action: EnableDefaultToolsAction): ICommand | Action | void {\n        this.changeActiveButton();\n        if (this.focusTracker.hasFocus) {\n            // if focus was deliberately taken do not restore focus to the palette\n            this.focusTracker.diagramElement?.focus();\n        }\n    }\n\n    editModeChanged(_newValue: string, _oldValue: string): void {\n        this.actionDispatcher.dispatch(\n            SetUIExtensionVisibilityAction.create({ extensionId: ToolPalette.ID, visible: !this.editorContext.isReadonly })\n        );\n    }\n\n    protected clearOnEscape(event: KeyboardEvent): void {\n        if (matchesKeystroke(event, 'Escape')) {\n            this.searchField.value = '';\n            this.requestFilterUpdate('');\n        }\n    }\n\n    protected clearToolOnEscape(event: KeyboardEvent): void {\n        if (matchesKeystroke(event, 'Escape')) {\n            this.actionDispatcher.dispatch(EnableDefaultToolsAction.create());\n        }\n    }\n\n    protected handleSetContextActions(action: SetContextActions): void {\n        this.paletteItems = action.actions.map(e => e as PaletteItem);\n        this.createBody();\n    }\n\n    protected requestFilterUpdate(filter: string): void {\n        // Initialize the copy if it's empty\n        if (this.paletteItemsCopy.length === 0) {\n            // Creating deep copy\n            this.paletteItemsCopy = JSON.parse(JSON.stringify(this.paletteItems));\n        }\n\n        // Reset the paletteItems before searching\n        this.paletteItems = JSON.parse(JSON.stringify(this.paletteItemsCopy));\n        // Filter the entries\n        const filteredPaletteItems: PaletteItem[] = [];\n        for (const itemGroup of this.paletteItems) {\n            if (itemGroup.children) {\n                // Fetch the labels according to the filter\n                const matchingChildren = itemGroup.children.filter(child => child.label.toLowerCase().includes(filter.toLowerCase()));\n                // Add the itemgroup containing the correct entries\n                if (matchingChildren.length > 0) {\n                    // Clear existing children\n                    itemGroup.children.splice(0, itemGroup.children.length);\n                    // Push the matching children\n                    matchingChildren.forEach(child => itemGroup.children!.push(child));\n                    filteredPaletteItems.push(itemGroup);\n                }\n            }\n        }\n        this.paletteItems = filteredPaletteItems;\n        this.createBody();\n    }\n\n    async preRequestModel(): Promise<void> {\n        const requestAction = RequestContextActions.create({\n            contextId: ToolPalette.ID,\n            editorContext: {\n                selectedElementIds: []\n            }\n        });\n        const response = await this.actionDispatcher.request<SetContextActions>(requestAction);\n        this.paletteItems = response.actions.map(e => e as PaletteItem);\n        if (!this.editorContext.isReadonly) {\n            this.show(this.editorContext.modelRoot);\n        }\n    }\n}\n\nexport function compare(a: PaletteItem, b: PaletteItem): number {\n    const sortStringBased = a.sortString.localeCompare(b.sortString);\n    if (sortStringBased !== 0) {\n        return sortStringBased;\n    }\n    return a.label.localeCompare(b.label);\n}\n\nexport function createIcon(codiconId: string): HTMLElement {\n    const icon = document.createElement('i');\n    icon.classList.add(...codiconCSSClasses(codiconId));\n    return icon;\n}\n\nexport function createToolGroup(item: PaletteItem): HTMLElement {\n    const group = document.createElement('div');\n    group.classList.add('tool-group');\n    group.id = item.id;\n    const header = document.createElement('div');\n    header.classList.add('group-header');\n    if (item.icon) {\n        header.appendChild(createIcon(item.icon));\n    }\n    header.insertAdjacentText('beforeend', item.label);\n    header.ondblclick = _ev => {\n        const css = 'collapsed';\n        changeCSSClass(group, css);\n        Array.from(group.children).forEach(child => changeCSSClass(child, css));\n        window!.getSelection()!.removeAllRanges();\n    };\n\n    group.appendChild(header);\n    return group;\n}\n\nexport function changeCSSClass(element: Element, css: string): void {\n    // eslint-disable-next-line chai-friendly/no-unused-expressions\n    element.classList.contains(css) ? element.classList.remove(css) : element.classList.add(css);\n}\n\nexport function changeCodiconClass(element: Element, codiconId: string): void {\n    // eslint-disable-next-line chai-friendly/no-unused-expressions\n    element.classList.contains(codiconCSSClasses(codiconId)[1])\n        ? element.classList.remove(codiconCSSClasses(codiconId)[1])\n        : element.classList.add(codiconCSSClasses(codiconId)[1]);\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport {\n    Action,\n    CommandExecutionContext,\n    CommandReturn,\n    Disposable,\n    ElementMove,\n    GChildElement,\n    MouseListener,\n    MoveAction,\n    Point,\n    GModelElement,\n    GModelRoot,\n    TYPES,\n    findParentByFeature,\n    hasStringProp,\n    isMoveable,\n    isSelectable,\n    isViewport\n} from '@eclipse-glsp/sprotty';\n\nimport { CursorCSS, cursorFeedbackAction } from '../../../base/feedback/css-feedback';\nimport { FeedbackCommand } from '../../../base/feedback/feedback-command';\nimport { forEachElement } from '../../../utils/gmodel-util';\nimport { SResizeHandle, addResizeHandles, isResizable, removeResizeHandles } from '../../change-bounds/model';\nimport { createMovementRestrictionFeedback, removeMovementRestrictionFeedback } from '../../change-bounds/movement-restrictor';\nimport { ChangeBoundsTool } from './change-bounds-tool';\n\nexport interface ShowChangeBoundsToolResizeFeedbackAction extends Action {\n    kind: typeof ShowChangeBoundsToolResizeFeedbackAction.KIND;\n\n    elementId: string;\n}\n\nexport namespace ShowChangeBoundsToolResizeFeedbackAction {\n    export const KIND = 'showChangeBoundsToolResizeFeedback';\n\n    export function is(object: any): object is ShowChangeBoundsToolResizeFeedbackAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'elementId');\n    }\n\n    export function create(elementId: string): ShowChangeBoundsToolResizeFeedbackAction {\n        return {\n            kind: KIND,\n            elementId\n        };\n    }\n}\n\nexport interface HideChangeBoundsToolResizeFeedbackAction extends Action {\n    kind: typeof HideChangeBoundsToolResizeFeedbackAction.KIND;\n}\n\nexport namespace HideChangeBoundsToolResizeFeedbackAction {\n    export const KIND = 'hideChangeBoundsToolResizeFeedback';\n\n    export function is(object: any): object is HideChangeBoundsToolResizeFeedbackAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(): HideChangeBoundsToolResizeFeedbackAction {\n        return { kind: KIND };\n    }\n}\n\n@injectable()\nexport class ShowChangeBoundsToolResizeFeedbackCommand extends FeedbackCommand {\n    static readonly KIND = ShowChangeBoundsToolResizeFeedbackAction.KIND;\n\n    @inject(TYPES.Action) protected action: ShowChangeBoundsToolResizeFeedbackAction;\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const index = context.root.index;\n\n        forEachElement(index, isResizable, removeResizeHandles);\n\n        if (this.action.elementId) {\n            const resizeElement = index.getById(this.action.elementId);\n            if (resizeElement && isResizable(resizeElement)) {\n                addResizeHandles(resizeElement);\n            }\n        }\n        return context.root;\n    }\n}\n\n@injectable()\nexport class HideChangeBoundsToolResizeFeedbackCommand extends FeedbackCommand {\n    static readonly KIND = HideChangeBoundsToolResizeFeedbackAction.KIND;\n\n    @inject(TYPES.Action) protected action: HideChangeBoundsToolResizeFeedbackAction;\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const index = context.root.index;\n        forEachElement(index, isResizable, removeResizeHandles);\n        return context.root;\n    }\n}\n\n/**\n * This mouse listener provides visual feedback for moving by sending client-side\n * `MoveAction`s while elements are selected and dragged. This will also update\n * their bounds, which is important, as it is not only required for rendering\n * the visual feedback but also the basis for sending the change to the server\n * (see also `tools/MoveTool`).\n */\nexport class FeedbackMoveMouseListener extends MouseListener implements Disposable {\n    protected hasDragged = false;\n    protected rootElement?: GModelRoot;\n    protected startDragPosition?: Point;\n    protected elementId2startPos = new Map<string, Point>();\n\n    constructor(protected tool: ChangeBoundsTool) {\n        super();\n    }\n\n    override mouseDown(target: GModelElement, event: MouseEvent): Action[] {\n        if (event.button === 0 && !(target instanceof SResizeHandle)) {\n            const moveable = findParentByFeature(target, isMoveable);\n            if (moveable !== undefined) {\n                this.startDragPosition = { x: event.pageX, y: event.pageY };\n            } else {\n                this.startDragPosition = undefined;\n            }\n            this.hasDragged = false;\n        }\n        return [];\n    }\n\n    override mouseMove(target: GModelElement, event: MouseEvent): Action[] {\n        const result: Action[] = [];\n        if (event.buttons === 0) {\n            this.mouseUp(target, event);\n        } else if (this.startDragPosition) {\n            if (this.elementId2startPos.size === 0) {\n                this.collectStartPositions(target.root);\n            }\n            this.hasDragged = true;\n            const moveAction = this.getElementMoves(target, event, false);\n            if (moveAction) {\n                result.push(moveAction);\n                result.push(cursorFeedbackAction(CursorCSS.MOVE));\n            }\n        }\n        this.tool.registerFeedback(result, this);\n        return [];\n    }\n\n    protected collectStartPositions(root: GModelRoot): void {\n        this.rootElement = root;\n        const selectedElements = root.index.all().filter(element => isSelectable(element) && element.selected);\n        const elementsSet = new Set(selectedElements);\n        selectedElements\n            .filter(element => !this.isChildOfSelected(elementsSet, element))\n            .forEach(element => {\n                if (isMoveable(element)) {\n                    this.elementId2startPos.set(element.id, element.position);\n                }\n            });\n    }\n\n    protected isChildOfSelected(selectedElements: Set<GModelElement>, element: GModelElement): boolean {\n        while (element instanceof GChildElement) {\n            element = element.parent;\n            if (selectedElements.has(element)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    protected getElementMoves(target: GModelElement, event: MouseEvent, finished: boolean): MoveAction | undefined {\n        if (!this.startDragPosition) {\n            return undefined;\n        }\n\n        const viewport = findParentByFeature(target, isViewport);\n        const zoom = viewport ? viewport.zoom : 1;\n        const delta = {\n            x: (event.pageX - this.startDragPosition.x) / zoom,\n            y: (event.pageY - this.startDragPosition.y) / zoom\n        };\n\n        const elementMoves: ElementMove[] = this.getElementMovesForDelta(target, delta, !event.shiftKey, finished);\n        if (elementMoves.length > 0) {\n            return MoveAction.create(elementMoves, { animate: false, finished });\n        } else {\n            return undefined;\n        }\n    }\n\n    protected getElementMovesForDelta(\n        target: GModelElement,\n        delta: { x: number; y: number },\n        isSnap: boolean,\n        finished: boolean\n    ): ElementMove[] {\n        const elementMoves: ElementMove[] = [];\n        this.elementId2startPos.forEach((startPosition, elementId) => {\n            const element = target.root.index.getById(elementId);\n            if (element) {\n                let toPosition = this.snap(\n                    {\n                        x: startPosition.x + delta.x,\n                        y: startPosition.y + delta.y\n                    },\n                    element,\n                    isSnap\n                );\n\n                if (isMoveable(element)) {\n                    toPosition = this.validateMove(startPosition, toPosition, element, finished);\n                    elementMoves.push({\n                        elementId: element.id,\n                        fromPosition: {\n                            x: element.position.x,\n                            y: element.position.y\n                        },\n                        toPosition\n                    });\n                }\n            }\n        });\n        return elementMoves;\n    }\n\n    protected validateMove(startPosition: Point, toPosition: Point, element: GModelElement, isFinished: boolean): Point {\n        let newPosition = toPosition;\n        if (this.tool.movementRestrictor) {\n            const valid = this.tool.movementRestrictor.validate(element, toPosition);\n            let action;\n            if (!valid) {\n                action = createMovementRestrictionFeedback(element, this.tool.movementRestrictor);\n\n                if (isFinished) {\n                    newPosition = startPosition;\n                }\n            } else {\n                action = removeMovementRestrictionFeedback(element, this.tool.movementRestrictor);\n            }\n            this.tool.registerFeedback([action], this);\n        }\n        return newPosition;\n    }\n\n    protected snap(position: Point, element: GModelElement, isSnap: boolean): Point {\n        if (isSnap && this.tool.snapper) {\n            return this.tool.snapper.snap(position, element);\n        } else {\n            return position;\n        }\n    }\n\n    override mouseEnter(target: GModelElement, event: MouseEvent): Action[] {\n        if (target instanceof GModelRoot && event.buttons === 0 && !this.startDragPosition) {\n            this.mouseUp(target, event);\n        }\n        return [];\n    }\n\n    override mouseUp(target: GModelElement, event: MouseEvent): Action[] {\n        const result: Action[] = [];\n        if (this.startDragPosition) {\n            const moveAction = this.getElementMoves(target, event, true);\n            if (moveAction) {\n                result.push(moveAction);\n            }\n            const resetFeedback: Action[] = [];\n            if (this.tool.movementRestrictor) {\n                resetFeedback.push(removeMovementRestrictionFeedback(target, this.tool.movementRestrictor));\n            }\n            resetFeedback.push(cursorFeedbackAction(CursorCSS.DEFAULT));\n            this.tool.deregisterFeedback(this, resetFeedback);\n        }\n        this.reset();\n        return result;\n    }\n\n    protected reset(resetFeedback = false): void {\n        if (this.rootElement && resetFeedback) {\n            const elementMoves: ElementMove[] = this.getElementMovesForDelta(this.rootElement, { x: 0, y: 0 }, true, true);\n            const moveAction = MoveAction.create(elementMoves, { animate: false, finished: true });\n            this.tool.deregisterFeedback(this, [moveAction]);\n        }\n        this.hasDragged = false;\n        this.startDragPosition = undefined;\n        this.rootElement = undefined;\n        this.elementId2startPos.clear();\n    }\n\n    override decorate(vnode: VNode, _element: GModelElement): VNode {\n        return vnode;\n    }\n\n    dispose(): void {\n        this.reset(true);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, optional } from 'inversify';\n\nimport {\n    Action,\n    Bounds,\n    BoundsAware,\n    ChangeBoundsOperation,\n    ChangeRoutingPointsOperation,\n    CompoundOperation,\n    Dimension,\n    Disposable,\n    EdgeRouterRegistry,\n    ElementAndBounds,\n    ElementAndRoutingPoints,\n    GChildElement,\n    ISnapper,\n    MouseListener,\n    Operation,\n    Point,\n    GConnectableElement,\n    GModelElement,\n    GModelRoot,\n    GParentElement,\n    SetBoundsAction,\n    TYPES,\n    findParentByFeature,\n    isSelected\n} from '@eclipse-glsp/sprotty';\nimport { DragAwareMouseListener } from '../../../base/drag-aware-mouse-listener';\nimport { CursorCSS, applyCssClasses, cursorFeedbackAction, deleteCssClasses } from '../../../base/feedback/css-feedback';\nimport { ISelectionListener, SelectionService } from '../../../base/selection-service';\nimport { PointPositionUpdater } from '../../../features/change-bounds/snap';\nimport { isValidMove, isValidSize } from '../../../utils/layout-utils';\nimport {\n    calcElementAndRoutingPoints,\n    forEachElement,\n    isNonRoutableSelectedMovableBoundsAware,\n    toElementAndBounds\n} from '../../../utils/gmodel-util';\nimport { Resizable, ResizeHandleLocation, SResizeHandle, isBoundsAwareMoveable, isResizable } from '../../change-bounds/model';\nimport {\n    IMovementRestrictor,\n    createMovementRestrictionFeedback,\n    removeMovementRestrictionFeedback\n} from '../../change-bounds/movement-restrictor';\nimport { BaseEditTool } from '../base-tools';\nimport {\n    FeedbackMoveMouseListener,\n    HideChangeBoundsToolResizeFeedbackAction,\n    ShowChangeBoundsToolResizeFeedbackAction\n} from './change-bounds-tool-feedback';\n\n/**\n * The change bounds tool has the license to move multiple elements or resize a single element by implementing the ChangeBounds operation.\n * In contrast to Sprotty's implementation this tool only sends a `ChangeBoundsOperationAction` when an operation has finished and does not\n * provide client-side live updates to improve performance.\n *\n * | Operation | Client Update    | Server Update\n * +-----------+------------------+----------------------------\n * | Move      | MoveAction       | ChangeBoundsOperationAction\n * | Resize    | SetBoundsAction  | ChangeBoundsOperationAction\n *\n * To provide a visual client updates during move we install the `FeedbackMoveMouseListener` and to provide visual client updates during\n * resize and send the server updates we install the `ChangeBoundsListener`.\n */\n@injectable()\nexport class ChangeBoundsTool extends BaseEditTool {\n    static ID = 'glsp.change-bounds-tool';\n\n    @inject(SelectionService) protected selectionService: SelectionService;\n    @inject(EdgeRouterRegistry) @optional() readonly edgeRouterRegistry?: EdgeRouterRegistry;\n    @inject(TYPES.ISnapper) @optional() readonly snapper?: ISnapper;\n    @inject(TYPES.IMovementRestrictor) @optional() readonly movementRestrictor?: IMovementRestrictor;\n\n    get id(): string {\n        return ChangeBoundsTool.ID;\n    }\n\n    enable(): void {\n        // install feedback move mouse listener for client-side move updates\n        const feedbackMoveMouseListener = this.createMoveMouseListener();\n        if (Disposable.is(feedbackMoveMouseListener)) {\n            this.toDisposeOnDisable.push(feedbackMoveMouseListener);\n        }\n\n        // install change bounds listener for client-side resize updates and server-side updates\n        const changeBoundsListener = this.createChangeBoundsListener();\n        if (Disposable.is(changeBoundsListener)) {\n            this.toDisposeOnDisable.push(changeBoundsListener);\n        }\n\n        this.toDisposeOnDisable.push(\n            this.mouseTool.registerListener(feedbackMoveMouseListener),\n            this.mouseTool.registerListener(changeBoundsListener),\n            Disposable.create(() => this.deregisterFeedback(feedbackMoveMouseListener)),\n            Disposable.create(() => this.deregisterFeedback(changeBoundsListener, [HideChangeBoundsToolResizeFeedbackAction.create()])),\n            this.selectionService.onSelectionChanged(change => changeBoundsListener.selectionChanged(change.root, change.selectedElements))\n        );\n    }\n\n    protected createMoveMouseListener(): MouseListener {\n        return new FeedbackMoveMouseListener(this);\n    }\n\n    protected createChangeBoundsListener(): MouseListener & ISelectionListener {\n        return new ChangeBoundsListener(this);\n    }\n}\n\nexport class ChangeBoundsListener extends DragAwareMouseListener implements ISelectionListener, Disposable {\n    static readonly CSS_CLASS_ACTIVE = 'active';\n\n    // members for calculating the correct position change\n    protected initialBounds: Bounds | undefined;\n    protected pointPositionUpdater: PointPositionUpdater;\n\n    // members for resize mode\n    protected activeResizeElement?: GModelElement;\n    protected activeResizeHandle?: SResizeHandle;\n\n    constructor(protected tool: ChangeBoundsTool) {\n        super();\n        this.pointPositionUpdater = new PointPositionUpdater(tool.snapper);\n    }\n\n    override mouseDown(target: GModelElement, event: MouseEvent): Action[] {\n        super.mouseDown(target, event);\n        // If another button than the left mouse button was clicked or we are\n        // still on the root element we don't need to execute the tool behavior\n        if (event.button !== 0 || target instanceof GModelRoot) {\n            return [];\n        }\n        // check if we have a resize handle (only single-selection)\n        if (this.activeResizeElement && target instanceof SResizeHandle) {\n            this.activeResizeHandle = target;\n        } else {\n            this.setActiveResizeElement(target);\n        }\n        if (this.activeResizeElement) {\n            this.initPosition(event);\n        } else {\n            this.reset();\n        }\n        return [];\n    }\n\n    override mouseMove(target: GModelElement, event: MouseEvent): Action[] {\n        super.mouseMove(target, event);\n        if (this.isMouseDrag && this.activeResizeHandle) {\n            // rely on the FeedbackMoveMouseListener to update the element bounds of selected elements\n            // consider resize handles ourselves\n            const actions: Action[] = [\n                cursorFeedbackAction(this.activeResizeHandle.isNwSeResize() ? CursorCSS.RESIZE_NWSE : CursorCSS.RESIZE_NESW),\n                applyCssClasses(this.activeResizeHandle, ChangeBoundsListener.CSS_CLASS_ACTIVE)\n            ];\n            const positionUpdate = this.pointPositionUpdater.updatePosition(target, { x: event.pageX, y: event.pageY }, !event.altKey);\n            if (positionUpdate) {\n                const resizeActions = this.handleResizeOnClient(positionUpdate);\n                actions.push(...resizeActions);\n            }\n            this.tool.registerFeedback(actions, this);\n        }\n        return [];\n    }\n\n    override draggingMouseUp(target: GModelElement, _event: MouseEvent): Action[] {\n        if (this.pointPositionUpdater.isLastDragPositionUndefined()) {\n            this.resetPosition();\n            return [];\n        }\n        const actions: Action[] = [];\n\n        if (this.activeResizeHandle) {\n            // Resize\n            actions.push(...this.handleResize(this.activeResizeHandle));\n        } else {\n            // Move\n            actions.push(...this.handleMoveOnServer(target));\n        }\n        this.resetPosition();\n        this.tool.deregisterFeedback(this, [cursorFeedbackAction(CursorCSS.DEFAULT)]);\n        return actions;\n    }\n\n    protected handleMoveOnServer(target: GModelElement): Action[] {\n        const operations: Operation[] = [];\n\n        operations.push(...this.handleMoveElementsOnServer(target));\n        operations.push(...this.handleMoveRoutingPointsOnServer(target));\n        if (operations.length > 0) {\n            return [CompoundOperation.create(operations)];\n        }\n        return operations;\n    }\n\n    protected handleMoveElementsOnServer(target: GModelElement): Operation[] {\n        const result: Operation[] = [];\n        const newBounds: ElementAndBounds[] = [];\n        const selectedElements: (GModelElement & BoundsAware)[] = [];\n        forEachElement(target.index, isNonRoutableSelectedMovableBoundsAware, element => {\n            selectedElements.push(element);\n        });\n\n        const selectionSet: Set<GModelElement & BoundsAware> = new Set(selectedElements);\n        selectedElements\n            .filter(element => !this.isChildOfSelected(selectionSet, element))\n            .map(element => this.createElementAndBounds(element))\n            .forEach(bounds => newBounds.push(...bounds));\n\n        if (newBounds.length > 0) {\n            result.push(ChangeBoundsOperation.create(newBounds));\n        }\n        return result;\n    }\n\n    protected isChildOfSelected(selectedElements: Set<GModelElement>, element: GModelElement): boolean {\n        while (element instanceof GChildElement) {\n            element = element.parent;\n            if (selectedElements.has(element)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    protected handleMoveRoutingPointsOnServer(target: GModelElement): Operation[] {\n        const newRoutingPoints: ElementAndRoutingPoints[] = [];\n        const routerRegistry = this.tool.edgeRouterRegistry;\n        if (routerRegistry) {\n            //  If client routing is enabled -> delegate routingpoints of connected edges to server\n            forEachElement(target.index, isNonRoutableSelectedMovableBoundsAware, element => {\n                if (element instanceof GConnectableElement) {\n                    element.incomingEdges\n                        .map(connectable => calcElementAndRoutingPoints(connectable, routerRegistry))\n                        .forEach(ear => newRoutingPoints.push(ear));\n                    element.outgoingEdges\n                        .map(connectable => calcElementAndRoutingPoints(connectable, routerRegistry))\n                        .forEach(ear => newRoutingPoints.push(ear));\n                }\n            });\n        }\n        return newRoutingPoints.length > 0 ? [ChangeRoutingPointsOperation.create(newRoutingPoints)] : [];\n    }\n\n    protected handleResize(activeResizeHandle: SResizeHandle): Action[] {\n        const actions: Action[] = [];\n        actions.push(cursorFeedbackAction(CursorCSS.DEFAULT));\n        actions.push(deleteCssClasses(activeResizeHandle, ChangeBoundsListener.CSS_CLASS_ACTIVE));\n        const resizeElement = findParentByFeature(activeResizeHandle, isResizable);\n        if (this.isActiveResizeElement(resizeElement)) {\n            this.createChangeBoundsAction(resizeElement).forEach(action => actions.push(action));\n        }\n        return actions;\n    }\n\n    selectionChanged(root: GModelRoot, selectedElements: string[]): void {\n        if (this.activeResizeElement) {\n            if (selectedElements.includes(this.activeResizeElement.id)) {\n                // our active element is still selected, nothing to do\n                return;\n            }\n\n            // try to find some other selected element and mark that active\n            for (const elementId of selectedElements.reverse()) {\n                const element = root.index.getById(elementId);\n                if (element && this.setActiveResizeElement(element)) {\n                    return;\n                }\n            }\n            this.reset();\n        }\n    }\n\n    protected setActiveResizeElement(target: GModelElement): boolean {\n        // check if we have a selected, moveable element (multi-selection allowed)\n        const moveableElement = findParentByFeature(target, isBoundsAwareMoveable);\n        if (isSelected(moveableElement)) {\n            // only allow one element to have the element resize handles\n            this.activeResizeElement = moveableElement;\n            if (isResizable(this.activeResizeElement)) {\n                this.tool.registerFeedback(\n                    [ShowChangeBoundsToolResizeFeedbackAction.create(this.activeResizeElement.id)],\n                    this.activeResizeElement\n                );\n            }\n            return true;\n        }\n        return false;\n    }\n\n    protected isActiveResizeElement(element?: GModelElement): element is GParentElement & BoundsAware {\n        return element !== undefined && this.activeResizeElement !== undefined && element.id === this.activeResizeElement.id;\n    }\n\n    protected initPosition(event: MouseEvent): void {\n        this.pointPositionUpdater.updateLastDragPosition({ x: event.pageX, y: event.pageY });\n        if (this.activeResizeHandle) {\n            const resizeElement = findParentByFeature(this.activeResizeHandle, isResizable);\n            this.initialBounds = {\n                x: resizeElement!.bounds.x,\n                y: resizeElement!.bounds.y,\n                width: resizeElement!.bounds.width,\n                height: resizeElement!.bounds.height\n            };\n        }\n    }\n\n    dispose(): void {\n        this.reset(true);\n    }\n\n    protected reset(resetBounds = false): void {\n        this.resetFeedback(resetBounds);\n        this.resetPosition();\n    }\n\n    protected resetFeedback(resetBounds = false): void {\n        const resetFeedback: Action[] = [];\n        if (this.activeResizeElement && isResizable(this.activeResizeElement)) {\n            if (this.initialBounds && this.activeResizeHandle && resetBounds) {\n                // we only reset the bounds if an active resize operation was cancelled due to the tool being disabled\n                resetFeedback.push(\n                    SetBoundsAction.create([\n                        {\n                            elementId: this.activeResizeElement.id,\n                            newPosition: this.initialBounds,\n                            newSize: this.initialBounds\n                        }\n                    ])\n                );\n            }\n            this.tool.deregisterFeedback(this.activeResizeElement, [HideChangeBoundsToolResizeFeedbackAction.create()]);\n        }\n        resetFeedback.push(cursorFeedbackAction(CursorCSS.DEFAULT));\n        this.tool.deregisterFeedback(this, resetFeedback);\n    }\n\n    protected resetPosition(): void {\n        this.activeResizeHandle = undefined;\n        this.pointPositionUpdater.resetPosition();\n    }\n\n    protected handleResizeOnClient(positionUpdate: Point): Action[] {\n        if (!this.activeResizeHandle) {\n            return [];\n        }\n\n        const resizeElement = findParentByFeature(this.activeResizeHandle, isResizable);\n        if (this.isActiveResizeElement(resizeElement)) {\n            switch (this.activeResizeHandle.location) {\n                case ResizeHandleLocation.TopLeft:\n                    return this.handleTopLeftResize(resizeElement, positionUpdate);\n                case ResizeHandleLocation.TopRight:\n                    return this.handleTopRightResize(resizeElement, positionUpdate);\n                case ResizeHandleLocation.BottomLeft:\n                    return this.handleBottomLeftResize(resizeElement, positionUpdate);\n                case ResizeHandleLocation.BottomRight:\n                    return this.handleBottomRightResize(resizeElement, positionUpdate);\n            }\n        }\n        return [];\n    }\n\n    protected handleTopLeftResize(resizeElement: GParentElement & Resizable, positionUpdate: Point): Action[] {\n        return this.createSetBoundsAction(\n            resizeElement,\n            resizeElement.bounds.x + positionUpdate.x,\n            resizeElement.bounds.y + positionUpdate.y,\n            resizeElement.bounds.width - positionUpdate.x,\n            resizeElement.bounds.height - positionUpdate.y\n        );\n    }\n\n    protected handleTopRightResize(resizeElement: GParentElement & Resizable, positionUpdate: Point): Action[] {\n        return this.createSetBoundsAction(\n            resizeElement,\n            resizeElement.bounds.x,\n            resizeElement.bounds.y + positionUpdate.y,\n            resizeElement.bounds.width + positionUpdate.x,\n            resizeElement.bounds.height - positionUpdate.y\n        );\n    }\n\n    protected handleBottomLeftResize(resizeElement: GParentElement & Resizable, positionUpdate: Point): Action[] {\n        return this.createSetBoundsAction(\n            resizeElement,\n            resizeElement.bounds.x + positionUpdate.x,\n            resizeElement.bounds.y,\n            resizeElement.bounds.width - positionUpdate.x,\n            resizeElement.bounds.height + positionUpdate.y\n        );\n    }\n\n    protected handleBottomRightResize(resizeElement: GParentElement & Resizable, positionUpdate: Point): Action[] {\n        return this.createSetBoundsAction(\n            resizeElement,\n            resizeElement.bounds.x,\n            resizeElement.bounds.y,\n            resizeElement.bounds.width + positionUpdate.x,\n            resizeElement.bounds.height + positionUpdate.y\n        );\n    }\n\n    protected createChangeBoundsAction(element: GModelElement & BoundsAware): Action[] {\n        if (this.isValidBoundChange(element, element.bounds, element.bounds)) {\n            return [ChangeBoundsOperation.create([toElementAndBounds(element)])];\n        } else if (this.initialBounds) {\n            const actions: Action[] = [];\n            if (this.tool.movementRestrictor) {\n                actions.push(removeMovementRestrictionFeedback(element, this.tool.movementRestrictor));\n            }\n            actions.push(SetBoundsAction.create([{ elementId: element.id, newPosition: this.initialBounds, newSize: this.initialBounds }]));\n            return actions;\n        }\n        return [];\n    }\n\n    protected createElementAndBounds(element: GModelElement & BoundsAware): ElementAndBounds[] {\n        if (this.isValidBoundChange(element, element.bounds, element.bounds)) {\n            return [toElementAndBounds(element)];\n        }\n        return [];\n    }\n\n    protected createSetBoundsAction(element: GModelElement & BoundsAware, x: number, y: number, width: number, height: number): Action[] {\n        const newPosition = { x, y };\n        const newSize = { width, height };\n        const result: Action[] = [];\n\n        if (this.isValidBoundChange(element, newPosition, newSize)) {\n            if (this.tool.movementRestrictor) {\n                result.push(removeMovementRestrictionFeedback(element, this.tool.movementRestrictor));\n            }\n            result.push(SetBoundsAction.create([{ elementId: element.id, newPosition, newSize }]));\n        } else if (this.isValidSize(element, newSize)) {\n            if (this.tool.movementRestrictor) {\n                result.push(createMovementRestrictionFeedback(element, this.tool.movementRestrictor));\n            }\n            result.push(SetBoundsAction.create([{ elementId: element.id, newPosition, newSize }]));\n        }\n\n        return result;\n    }\n\n    protected snap(position: Point, element: GModelElement, isSnap: boolean): Point {\n        return isSnap && this.tool.snapper ? this.tool.snapper.snap(position, element) : { x: position.x, y: position.y };\n    }\n\n    protected isValidBoundChange(element: GModelElement & BoundsAware, newPosition: Point, newSize: Dimension): boolean {\n        return this.isValidSize(element, newSize) && this.isValidMove(element, newPosition);\n    }\n\n    protected isValidSize(element: GModelElement & BoundsAware, size: Dimension): boolean {\n        return isValidSize(element, size);\n    }\n\n    protected isValidMove(element: GModelElement & BoundsAware, newPosition: Point): boolean {\n        return isValidMove(element, newPosition, this.tool.movementRestrictor);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { IView, Point, RenderingContext, setAttr, svg } from '@eclipse-glsp/sprotty';\nimport { ResizeHandleLocation, SResizeHandle, isResizable } from '../../change-bounds/model';\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst JSX = { createElement: svg };\n\n@injectable()\nexport class SResizeHandleView implements IView {\n    render(handle: SResizeHandle, context: RenderingContext): VNode {\n        const position = this.getPosition(handle);\n        if (position !== undefined) {\n            const node = (\n                <circle\n                    class-sprotty-resize-handle={true}\n                    class-mouseover={handle.hoverFeedback}\n                    cx={position.x}\n                    cy={position.y}\n                    r={this.getRadius()}\n                />\n            );\n            setAttr(node, 'data-kind', handle.location);\n            return node;\n        }\n        // Fallback: Create an empty group\n        return <g />;\n    }\n\n    protected getPosition(handle: SResizeHandle): Point | undefined {\n        const parent = handle.parent;\n        if (isResizable(parent)) {\n            if (handle.location === ResizeHandleLocation.TopLeft) {\n                return { x: 0, y: 0 };\n            } else if (handle.location === ResizeHandleLocation.TopRight) {\n                return { x: parent.bounds.width, y: 0 };\n            } else if (handle.location === ResizeHandleLocation.BottomLeft) {\n                return { x: 0, y: parent.bounds.height };\n            } else if (handle.location === ResizeHandleLocation.BottomRight) {\n                return { x: parent.bounds.width, y: parent.bounds.height };\n            }\n        }\n        return undefined;\n    }\n\n    getRadius(): number {\n        return 7;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport {\n    Action,\n    AnchorComputerRegistry,\n    Bounds,\n    CommandExecutionContext,\n    CommandReturn,\n    Disposable,\n    EdgeRouterRegistry,\n    ElementMove,\n    ISnapper,\n    MouseListener,\n    MoveAction,\n    Point,\n    PolylineEdgeRouter,\n    GConnectableElement,\n    GModelElement,\n    GRoutingHandle,\n    SwitchEditModeAction,\n    SwitchEditModeCommand,\n    TYPES,\n    findChildrenAtPosition,\n    findParentByFeature,\n    hasStringProp,\n    isBoundsAware,\n    isConnectable,\n    isSelected\n} from '@eclipse-glsp/sprotty';\nimport { IFeedbackActionDispatcher } from '../../../base/feedback/feedback-action-dispatcher';\nimport { FeedbackCommand } from '../../../base/feedback/feedback-command';\nimport { forEachElement, isRoutable, isRoutingHandle } from '../../../utils/gmodel-util';\nimport { getAbsolutePosition, toAbsoluteBounds } from '../../../utils/viewpoint-util';\nimport { PointPositionUpdater } from '../../change-bounds/snap';\nimport { addReconnectHandles, removeReconnectHandles } from '../../reconnect/model';\nimport { FeedbackEdgeEnd, feedbackEdgeEndId, feedbackEdgeId } from '../edge-creation/dangling-edge-feedback';\nimport { FeedbackEdgeEndMovingMouseListener } from '../edge-creation/edge-creation-tool-feedback';\n\n/**\n * RECONNECT HANDLES FEEDBACK\n */\nexport interface ShowEdgeReconnectHandlesFeedbackAction extends Action {\n    kind: typeof ShowEdgeReconnectHandlesFeedbackAction.KIND;\n    readonly elementId: string;\n}\n\nexport namespace ShowEdgeReconnectHandlesFeedbackAction {\n    export const KIND = 'showReconnectHandlesFeedback';\n\n    export function is(object: any): object is ShowEdgeReconnectHandlesFeedbackAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(elementId: string): ShowEdgeReconnectHandlesFeedbackAction {\n        return { kind: KIND, elementId };\n    }\n}\n\nexport interface HideEdgeReconnectHandlesFeedbackAction extends Action {\n    kind: typeof HideEdgeReconnectHandlesFeedbackAction.KIND;\n}\n\nexport namespace HideEdgeReconnectHandlesFeedbackAction {\n    export const KIND = 'hideReconnectHandlesFeedback';\n\n    export function is(object: any): object is HideEdgeReconnectHandlesFeedbackAction {\n        return Action.hasKind(object, KIND);\n    }\n\n    export function create(): HideEdgeReconnectHandlesFeedbackAction {\n        return { kind: KIND };\n    }\n}\n\n@injectable()\nexport class ShowEdgeReconnectHandlesFeedbackCommand extends FeedbackCommand {\n    static readonly KIND = ShowEdgeReconnectHandlesFeedbackAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: ShowEdgeReconnectHandlesFeedbackAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const index = context.root.index;\n        forEachElement(index, isRoutable, removeReconnectHandles);\n\n        const routableElement = index.getById(this.action.elementId);\n        if (routableElement && isRoutable(routableElement)) {\n            addReconnectHandles(routableElement);\n        }\n\n        return context.root;\n    }\n}\n\n@injectable()\nexport class HideEdgeReconnectHandlesFeedbackCommand extends FeedbackCommand {\n    static readonly KIND = HideEdgeReconnectHandlesFeedbackAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: HideEdgeReconnectHandlesFeedbackAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        const index = context.root.index;\n        forEachElement(index, isRoutable, removeReconnectHandles);\n        return context.root;\n    }\n}\n/**\n * ROUTING FEEDBACK\n */\n\nexport interface SwitchRoutingModeAction extends Omit<SwitchEditModeAction, 'kind'> {\n    kind: typeof SwitchRoutingModeAction.KIND;\n}\n\nexport namespace SwitchRoutingModeAction {\n    export const KIND = 'switchRoutingMode';\n    export function create(options: { elementsToActivate?: string[]; elementsToDeactivate?: string[] }): SwitchRoutingModeAction {\n        return {\n            ...SwitchEditModeAction.create(options),\n            kind: KIND\n        };\n    }\n}\n\n@injectable()\nexport class SwitchRoutingModeCommand extends SwitchEditModeCommand {\n    static override KIND = SwitchRoutingModeAction.KIND;\n    constructor(@inject(TYPES.Action) action: SwitchRoutingModeAction) {\n        super({ ...action, kind: SwitchEditModeAction.KIND });\n    }\n}\n\n/**\n * SOURCE AND TARGET EDGE FEEDBACK\n */\n\nexport interface DrawFeedbackEdgeSourceAction extends Action {\n    kind: typeof DrawFeedbackEdgeSourceAction.KIND;\n    elementTypeId: string;\n    targetId: string;\n}\n\nexport namespace DrawFeedbackEdgeSourceAction {\n    export const KIND = 'drawFeedbackEdgeSource';\n\n    export function is(object: any): object is DrawFeedbackEdgeSourceAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'elementTypeId') && hasStringProp(object, 'targetId');\n    }\n\n    export function create(options: { elementTypeId: string; targetId: string }): DrawFeedbackEdgeSourceAction {\n        return {\n            kind: KIND,\n            ...options\n        };\n    }\n}\n\n@injectable()\nexport class DrawFeedbackEdgeSourceCommand extends FeedbackCommand {\n    static readonly KIND = DrawFeedbackEdgeSourceAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: DrawFeedbackEdgeSourceAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        drawFeedbackEdgeSource(context, this.action.targetId, this.action.elementTypeId);\n        return context.root;\n    }\n}\n\n/**\n * SOURCE AND TARGET MOUSE MOVE LISTENER\n */\n\nexport class FeedbackEdgeTargetMovingMouseListener extends FeedbackEdgeEndMovingMouseListener {\n    constructor(anchorRegistry: AnchorComputerRegistry, feedbackDispatcher: IFeedbackActionDispatcher) {\n        super(anchorRegistry, feedbackDispatcher);\n    }\n}\n\nexport class FeedbackEdgeSourceMovingMouseListener extends MouseListener implements Disposable {\n    constructor(protected anchorRegistry: AnchorComputerRegistry, protected feedbackDispatcher: IFeedbackActionDispatcher) {\n        super();\n    }\n\n    override mouseMove(target: GModelElement, event: MouseEvent): Action[] {\n        const root = target.root;\n        const edgeEnd = root.index.getById(feedbackEdgeEndId(root));\n        if (!(edgeEnd instanceof FeedbackEdgeEnd) || !edgeEnd.feedbackEdge) {\n            return [];\n        }\n\n        const edge = edgeEnd.feedbackEdge;\n        const position = getAbsolutePosition(edgeEnd, event);\n        const endAtMousePosition = findChildrenAtPosition(target.root, position).find(\n            element => isConnectable(element) && element.canConnect(edge, 'source')\n        );\n\n        if (endAtMousePosition instanceof GConnectableElement && edge.target && isBoundsAware(edge.target)) {\n            const anchor = this.computeAbsoluteAnchor(endAtMousePosition, Bounds.center(edge.target.bounds));\n            if (Point.euclideanDistance(anchor, edgeEnd.position) > 1) {\n                this.feedbackDispatcher.registerFeedback(this, [\n                    MoveAction.create([{ elementId: edgeEnd.id, toPosition: anchor }], { animate: false })\n                ]);\n            }\n        } else {\n            this.feedbackDispatcher.registerFeedback(this, [\n                MoveAction.create([{ elementId: edgeEnd.id, toPosition: position }], { animate: false })\n            ]);\n        }\n\n        return [];\n    }\n\n    protected computeAbsoluteAnchor(element: GConnectableElement, referencePoint: Point, offset?: number): Point {\n        const anchorComputer = this.anchorRegistry.get(PolylineEdgeRouter.KIND, element.anchorKind);\n        let anchor = anchorComputer.getAnchor(element, referencePoint, offset);\n        // The anchor is computed in the local coordinate system of the element.\n        // If the element is a nested child element we have to add the absolute position of its parent to the anchor.\n        if (element.parent !== element.root) {\n            const parent = findParentByFeature(element.parent, isBoundsAware);\n            if (parent) {\n                const absoluteParentPosition = toAbsoluteBounds(parent);\n                anchor = Point.add(absoluteParentPosition, anchor);\n            }\n        }\n        return anchor;\n    }\n\n    dispose(): void {\n        this.feedbackDispatcher.deregisterFeedback(this);\n    }\n}\n\nexport class FeedbackEdgeRouteMovingMouseListener extends MouseListener {\n    protected pointPositionUpdater: PointPositionUpdater;\n\n    constructor(protected edgeRouterRegistry?: EdgeRouterRegistry, protected snapper?: ISnapper) {\n        super();\n        this.pointPositionUpdater = new PointPositionUpdater(snapper);\n    }\n\n    override mouseDown(target: GModelElement, event: MouseEvent): Action[] {\n        const result: Action[] = [];\n        if (event.button === 0) {\n            const routingHandle = findParentByFeature(target, isRoutingHandle);\n            if (routingHandle !== undefined) {\n                result.push(SwitchRoutingModeAction.create({ elementsToActivate: [target.id] }));\n                this.pointPositionUpdater.updateLastDragPosition({ x: event.pageX, y: event.pageY });\n            } else {\n                this.pointPositionUpdater.resetPosition();\n            }\n        }\n        return result;\n    }\n\n    override mouseMove(target: GModelElement, event: MouseEvent): Action[] {\n        const result: Action[] = [];\n        if (event.buttons === 0) {\n            return this.mouseUp(target, event);\n        }\n        const positionUpdate = this.pointPositionUpdater.updatePosition(target, { x: event.pageX, y: event.pageY }, !event.altKey);\n        if (positionUpdate) {\n            const moveActions = this.handleMoveOnClient(target, positionUpdate, !event.altKey);\n            result.push(...moveActions);\n        }\n        return result;\n    }\n\n    protected handleMoveOnClient(target: GModelElement, positionUpdate: Point, isSnap: boolean): Action[] {\n        const handleMoves: ElementMove[] = [];\n        target.root.index\n            .all()\n            .filter(element => isSelected(element))\n            .forEach(element => {\n                if (isRoutingHandle(element)) {\n                    const elementMove = this.toElementMove(element, positionUpdate, isSnap);\n                    if (elementMove) {\n                        handleMoves.push(elementMove);\n                    }\n                }\n            });\n        if (handleMoves.length > 0) {\n            return [MoveAction.create(handleMoves, { animate: false })];\n        }\n        return [];\n    }\n\n    protected toElementMove(element: GRoutingHandle, positionDelta: Point, isSnap: boolean): ElementMove | undefined {\n        const point = this.getHandlePosition(element);\n        if (point !== undefined) {\n            const snappedPoint = this.getSnappedHandlePosition(element, point, isSnap);\n            return {\n                elementId: element.id,\n                fromPosition: point,\n                toPosition: {\n                    x: snappedPoint.x + positionDelta.x,\n                    y: snappedPoint.y + positionDelta.y\n                }\n            };\n        }\n        return undefined;\n    }\n\n    protected getSnappedHandlePosition(element: GRoutingHandle, point: Point, isSnap: boolean): Point {\n        if (this.snapper && isSnap) {\n            return this.snapper.snap(point, element);\n        }\n        return point;\n    }\n\n    protected getHandlePosition(handle: GRoutingHandle): Point | undefined {\n        if (this.edgeRouterRegistry) {\n            const parent = handle.parent;\n            if (!isRoutable(parent)) {\n                return undefined;\n            }\n            const router = this.edgeRouterRegistry.get(parent.routerKind);\n            const route = router.route(parent);\n            return router.getHandlePosition(parent, route, handle);\n        }\n        return undefined;\n    }\n\n    override mouseUp(_target: GModelElement, _event: MouseEvent): Action[] {\n        this.pointPositionUpdater.resetPosition();\n        return [];\n    }\n\n    override decorate(vnode: VNode, _element: GModelElement): VNode {\n        return vnode;\n    }\n}\n\n/**\n * UTILITY FUNCTIONS\n */\nexport function drawFeedbackEdgeSource(context: CommandExecutionContext, targetId: string, elementTypeId: string): void {\n    const root = context.root;\n    const targetChild = root.index.getById(targetId);\n    if (!targetChild) {\n        return;\n    }\n\n    const target = findParentByFeature(targetChild, isConnectable);\n    if (!target || !isBoundsAware(target)) {\n        return;\n    }\n\n    const edgeEnd = new FeedbackEdgeEnd(target.id, elementTypeId);\n    edgeEnd.id = feedbackEdgeEndId(root);\n    edgeEnd.position = { x: target.bounds.x, y: target.bounds.y };\n\n    const feedbackEdgeSchema = {\n        type: 'edge',\n        id: feedbackEdgeId(root),\n        sourceId: edgeEnd.id,\n        targetId: target.id,\n        opacity: 0.3\n    };\n\n    const feedbackEdge = context.modelFactory.createElement(feedbackEdgeSchema);\n    if (isRoutable(feedbackEdge)) {\n        edgeEnd.feedbackEdge = feedbackEdge;\n        root.add(edgeEnd);\n        root.add(feedbackEdge);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, optional } from 'inversify';\nimport {\n    Action,\n    AnchorComputerRegistry,\n    ChangeRoutingPointsOperation,\n    Connectable,\n    Disposable,\n    EdgeRouterRegistry,\n    ISnapper,\n    ReconnectEdgeOperation,\n    GModelElement,\n    GModelRoot,\n    GRoutableElement,\n    GRoutingHandle,\n    TYPES,\n    canEditRouting,\n    findParentByFeature,\n    isConnectable,\n    isSelected\n} from '@eclipse-glsp/sprotty';\nimport { DragAwareMouseListener } from '../../../base/drag-aware-mouse-listener';\nimport { CursorCSS, cursorFeedbackAction } from '../../../base/feedback/css-feedback';\nimport { ISelectionListener, SelectionService } from '../../../base/selection-service';\nimport { calcElementAndRoutingPoints, isRoutable, isRoutingHandle } from '../../../utils/gmodel-util';\nimport { GReconnectHandle, isReconnectHandle, isReconnectable, isSourceRoutingHandle, isTargetRoutingHandle } from '../../reconnect/model';\nimport { BaseEditTool } from '../base-tools';\nimport { DrawFeedbackEdgeAction, RemoveFeedbackEdgeAction, feedbackEdgeId } from '../edge-creation/dangling-edge-feedback';\nimport {\n    DrawFeedbackEdgeSourceAction,\n    FeedbackEdgeRouteMovingMouseListener,\n    FeedbackEdgeSourceMovingMouseListener,\n    FeedbackEdgeTargetMovingMouseListener,\n    HideEdgeReconnectHandlesFeedbackAction,\n    ShowEdgeReconnectHandlesFeedbackAction,\n    SwitchRoutingModeAction\n} from './edge-edit-tool-feedback';\n\n@injectable()\nexport class EdgeEditTool extends BaseEditTool {\n    static ID = 'glsp.edge-edit-tool';\n\n    @inject(SelectionService) protected selectionService: SelectionService;\n    @inject(AnchorComputerRegistry) protected anchorRegistry: AnchorComputerRegistry;\n    @inject(EdgeRouterRegistry) @optional() readonly edgeRouterRegistry?: EdgeRouterRegistry;\n    @inject(TYPES.ISnapper) @optional() readonly snapper?: ISnapper;\n\n    protected feedbackEdgeSourceMovingListener: FeedbackEdgeSourceMovingMouseListener;\n    protected feedbackEdgeTargetMovingListener: FeedbackEdgeTargetMovingMouseListener;\n    protected feedbackMovingListener: FeedbackEdgeRouteMovingMouseListener;\n    protected edgeEditListener: EdgeEditListener;\n\n    get id(): string {\n        return EdgeEditTool.ID;\n    }\n\n    enable(): void {\n        this.edgeEditListener = new EdgeEditListener(this);\n\n        // install feedback move mouse listener for client-side move updates\n        this.feedbackEdgeSourceMovingListener = new FeedbackEdgeSourceMovingMouseListener(this.anchorRegistry, this.feedbackDispatcher);\n        this.feedbackEdgeTargetMovingListener = new FeedbackEdgeTargetMovingMouseListener(this.anchorRegistry, this.feedbackDispatcher);\n        this.feedbackMovingListener = new FeedbackEdgeRouteMovingMouseListener(this.edgeRouterRegistry, this.snapper);\n\n        this.toDisposeOnDisable.push(\n            Disposable.create(() => this.edgeEditListener.reset()),\n            this.mouseTool.registerListener(this.edgeEditListener),\n            this.feedbackEdgeSourceMovingListener,\n            this.feedbackEdgeTargetMovingListener,\n            this.selectionService.onSelectionChanged(change => this.edgeEditListener.selectionChanged(change.root, change.selectedElements))\n        );\n    }\n\n    registerFeedbackListeners(): void {\n        this.mouseTool.register(this.feedbackMovingListener);\n        this.mouseTool.register(this.feedbackEdgeSourceMovingListener);\n        this.mouseTool.register(this.feedbackEdgeTargetMovingListener);\n    }\n\n    deregisterFeedbackListeners(): void {\n        this.feedbackEdgeSourceMovingListener.dispose();\n        this.feedbackEdgeTargetMovingListener.dispose();\n        this.mouseTool.deregister(this.feedbackEdgeSourceMovingListener);\n        this.mouseTool.deregister(this.feedbackEdgeTargetMovingListener);\n        this.mouseTool.deregister(this.feedbackMovingListener);\n    }\n}\n\nexport class EdgeEditListener extends DragAwareMouseListener implements ISelectionListener {\n    // active selection data\n    protected edge?: GRoutableElement;\n    protected routingHandle?: GRoutingHandle;\n\n    // new connectable (source or target) for edge\n    protected newConnectable?: GModelElement & Connectable;\n\n    // active reconnect handle data\n    protected reconnectMode?: 'NEW_SOURCE' | 'NEW_TARGET';\n\n    constructor(protected tool: EdgeEditTool) {\n        super();\n    }\n\n    protected isValidEdge(edge?: GRoutableElement): edge is GRoutableElement {\n        return edge !== undefined && edge.id !== feedbackEdgeId(edge.root) && isSelected(edge);\n    }\n\n    protected setEdgeSelected(edge: GRoutableElement): void {\n        if (this.edge && this.edge.id !== edge.id) {\n            // reset from a previously selected edge\n            this.reset();\n        }\n\n        this.edge = edge;\n        // note: order is important here as we want the reconnect handles to cover the routing handles\n        const feedbackActions = [];\n        if (canEditRouting(edge)) {\n            feedbackActions.push(SwitchRoutingModeAction.create({ elementsToActivate: [this.edge.id] }));\n        }\n        if (isReconnectable(edge)) {\n            feedbackActions.push(ShowEdgeReconnectHandlesFeedbackAction.create(this.edge.id));\n        }\n        this.tool.registerFeedback(feedbackActions);\n    }\n\n    protected isEdgeSelected(): boolean {\n        return this.edge !== undefined && isSelected(this.edge);\n    }\n\n    protected setReconnectHandleSelected(edge: GRoutableElement, reconnectHandle: GReconnectHandle): void {\n        if (this.edge && this.edge.target && this.edge.source) {\n            if (isSourceRoutingHandle(edge, reconnectHandle)) {\n                this.tool.registerFeedback([\n                    HideEdgeReconnectHandlesFeedbackAction.create(),\n                    cursorFeedbackAction(CursorCSS.EDGE_RECONNECT),\n                    DrawFeedbackEdgeSourceAction.create({ elementTypeId: this.edge.type, targetId: this.edge.targetId })\n                ]);\n                this.reconnectMode = 'NEW_SOURCE';\n            } else if (isTargetRoutingHandle(edge, reconnectHandle)) {\n                this.tool.registerFeedback([\n                    HideEdgeReconnectHandlesFeedbackAction.create(),\n                    cursorFeedbackAction(CursorCSS.EDGE_CREATION_TARGET),\n                    DrawFeedbackEdgeAction.create({ elementTypeId: this.edge.type, sourceId: this.edge.sourceId })\n                ]);\n                this.reconnectMode = 'NEW_TARGET';\n            }\n        }\n    }\n\n    protected isReconnecting(): boolean {\n        return this.reconnectMode !== undefined;\n    }\n\n    protected isReconnectingNewSource(): boolean {\n        return this.reconnectMode === 'NEW_SOURCE';\n    }\n\n    protected setRoutingHandleSelected(edge: GRoutableElement, routingHandle: GRoutingHandle): void {\n        if (this.edge && this.edge.target && this.edge.source) {\n            this.routingHandle = routingHandle;\n        }\n    }\n\n    protected requiresReconnect(sourceId: string, targetId: string): boolean {\n        return this.edge !== undefined && (this.edge.sourceId !== sourceId || this.edge.targetId !== targetId);\n    }\n\n    protected setNewConnectable(connectable?: GModelElement & Connectable): void {\n        this.newConnectable = connectable;\n    }\n\n    protected isReadyToReconnect(): boolean | undefined {\n        return this.edge && this.isReconnecting() && this.newConnectable !== undefined;\n    }\n\n    protected isReadyToReroute(): boolean {\n        return this.routingHandle !== undefined;\n    }\n\n    override mouseDown(target: GModelElement, event: MouseEvent): Action[] {\n        const result: Action[] = super.mouseDown(target, event);\n        if (event.button === 0) {\n            const reconnectHandle = findParentByFeature(target, isReconnectHandle);\n            const routingHandle = !reconnectHandle ? findParentByFeature(target, isRoutingHandle) : undefined;\n            const edge = findParentByFeature(target, isRoutable);\n            if (this.isEdgeSelected() && edge && reconnectHandle) {\n                // PHASE 2 Reconnect: Select reconnect handle on selected edge\n                this.setReconnectHandleSelected(edge, reconnectHandle);\n            } else if (this.isEdgeSelected() && edge && routingHandle) {\n                // PHASE 2 Reroute: Select routing handle on selected edge\n                this.setRoutingHandleSelected(edge, routingHandle);\n            } else if (this.isValidEdge(edge)) {\n                // PHASE 1: Select edge\n                this.tool.registerFeedbackListeners();\n                this.setEdgeSelected(edge);\n            }\n        } else if (event.button === 2) {\n            this.reset();\n        }\n        return result;\n    }\n\n    override mouseMove(target: GModelElement, event: MouseEvent): Action[] {\n        const result = super.mouseMove(target, event);\n        if (this.isMouseDrag) {\n            // reset any selected connectables when we are dragging, maybe the user is just panning\n            this.setNewConnectable(undefined);\n        }\n        return result;\n    }\n\n    override mouseUp(target: GModelElement, event: MouseEvent): Action[] {\n        const result = super.mouseUp(target, event);\n        if (!this.isReadyToReconnect() && !this.isReadyToReroute()) {\n            return result;\n        }\n\n        if (this.edge && this.newConnectable) {\n            const sourceElementId = this.isReconnectingNewSource() ? this.newConnectable.id : this.edge.sourceId;\n            const targetElementId = this.isReconnectingNewSource() ? this.edge.targetId : this.newConnectable.id;\n            if (this.requiresReconnect(sourceElementId, targetElementId)) {\n                result.push(ReconnectEdgeOperation.create({ edgeElementId: this.edge.id, sourceElementId, targetElementId }));\n            }\n            this.reset();\n        } else if (this.edge && this.routingHandle) {\n            // we need to re-retrieve the edge as it might have changed due to a server update since we do not reset the state between\n            // reroute actions\n            const latestEdge = target.index.getById(this.edge.id);\n            if (latestEdge && isRoutable(latestEdge)) {\n                const newRoutingPoints = calcElementAndRoutingPoints(latestEdge, this.tool.edgeRouterRegistry);\n                result.push(ChangeRoutingPointsOperation.create([newRoutingPoints]));\n                this.routingHandle = undefined;\n            }\n        }\n        return result;\n    }\n\n    override mouseOver(target: GModelElement, _event: MouseEvent): Action[] {\n        if (this.edge && this.isReconnecting()) {\n            const currentTarget = findParentByFeature(target, isConnectable);\n            if (!this.newConnectable || currentTarget !== this.newConnectable) {\n                this.setNewConnectable(currentTarget);\n                if (currentTarget) {\n                    if (\n                        (this.reconnectMode === 'NEW_SOURCE' && currentTarget.canConnect(this.edge, 'source')) ||\n                        (this.reconnectMode === 'NEW_TARGET' && currentTarget.canConnect(this.edge, 'target'))\n                    ) {\n                        this.tool.registerFeedback([cursorFeedbackAction(CursorCSS.EDGE_RECONNECT)]);\n                        return [];\n                    }\n                }\n                this.tool.registerFeedback([cursorFeedbackAction(CursorCSS.OPERATION_NOT_ALLOWED)]);\n            }\n        }\n        return [];\n    }\n\n    selectionChanged(root: Readonly<GModelRoot>, selectedElements: string[]): void {\n        if (this.edge) {\n            if (selectedElements.indexOf(this.edge.id) > -1) {\n                // our active edge is still selected, nothing to do\n                return;\n            }\n\n            if (this.isReconnecting()) {\n                // we are reconnecting, so we may have clicked on a potential target\n                return;\n            }\n\n            // try to find some other selected element and mark that active\n            for (const elementId of selectedElements.reverse()) {\n                const element = root.index.getById(elementId);\n                if (element) {\n                    const edge = findParentByFeature(element, isRoutable);\n                    if (this.isValidEdge(edge)) {\n                        // PHASE 1: Select edge\n                        this.setEdgeSelected(edge);\n                        return;\n                    }\n                }\n            }\n\n            this.reset();\n        }\n    }\n\n    public reset(): void {\n        this.resetFeedback();\n        this.resetData();\n    }\n\n    protected resetData(): void {\n        this.edge = undefined;\n        this.reconnectMode = undefined;\n        this.newConnectable = undefined;\n        this.routingHandle = undefined;\n    }\n\n    protected resetFeedback(): void {\n        const result: Action[] = [];\n        if (this.edge) {\n            result.push(SwitchRoutingModeAction.create({ elementsToDeactivate: [this.edge.id] }));\n        }\n        result.push(...[HideEdgeReconnectHandlesFeedbackAction.create(), cursorFeedbackAction(), RemoveFeedbackEdgeAction.create()]);\n        this.tool.deregisterFeedback(undefined, result);\n        this.tool.deregisterFeedbackListeners();\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { Action, KeyListener, GModelElement } from '@eclipse-glsp/sprotty';\nimport { EnableToolsAction } from '../../../base/tool-manager/tool';\nimport { BaseEditTool } from '../base-tools';\nimport { MarqueeMouseTool } from './marquee-mouse-tool';\n\n@injectable()\nexport class MarqueeTool extends BaseEditTool {\n    static ID = 'glsp.marquee-tool';\n\n    protected marqueeKeyListener: MarqueeKeyListener = new MarqueeKeyListener();\n\n    get id(): string {\n        return MarqueeTool.ID;\n    }\n\n    enable(): void {\n        this.toDisposeOnDisable.push(this.keyTool.registerListener(this.marqueeKeyListener));\n    }\n}\n\n@injectable()\nexport class MarqueeKeyListener extends KeyListener {\n    override keyDown(_element: GModelElement, event: KeyboardEvent): Action[] {\n        if (event.shiftKey) {\n            return [EnableToolsAction.create([MarqueeMouseTool.ID])];\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { boundsFeature, Point, RectangularNode } from '@eclipse-glsp/sprotty';\n\nexport class MarqueeNode extends RectangularNode {\n    static override readonly DEFAULT_FEATURES = [boundsFeature];\n    startPoint: Point;\n    endPoint: Point;\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { RectangularNodeView, RenderingContext, svg } from '@eclipse-glsp/sprotty';\nimport { MarqueeNode } from './model';\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst JSX = { createElement: svg };\n\n@injectable()\nexport class MarqueeView extends RectangularNodeView {\n    override render(node: MarqueeNode, context: RenderingContext): VNode {\n        const graph = (\n            <g>\n                <rect\n                    class-sprotty-node={true}\n                    class-marquee={true}\n                    x={node.startPoint.x - node.endPoint.x <= 0 ? node.startPoint.x : node.endPoint.x}\n                    y={node.startPoint.y - node.endPoint.y <= 0 ? node.startPoint.y : node.endPoint.y}\n                    rx={0}\n                    ry={0}\n                    width={Math.abs(node.startPoint.x - node.endPoint.x)}\n                    height={Math.abs(node.startPoint.y - node.endPoint.y)}\n                ></rect>\n            </g>\n        );\n        return graph;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, optional } from 'inversify';\nimport {\n    Action,\n    CreateNodeOperation,\n    ISnapper,\n    GModelElement,\n    GNode,\n    TYPES,\n    TriggerNodeCreationAction,\n    findParentByFeature,\n    isCtrlOrCmd\n} from '@eclipse-glsp/sprotty';\nimport { DragAwareMouseListener } from '../../../base/drag-aware-mouse-listener';\nimport { CursorCSS, cursorFeedbackAction } from '../../../base/feedback/css-feedback';\nimport { EnableDefaultToolsAction } from '../../../base/tool-manager/tool';\nimport { getAbsolutePosition } from '../../../utils/viewpoint-util';\nimport { Containable, isContainable } from '../../hints/model';\nimport { BaseCreationTool } from '../base-tools';\n\n@injectable()\nexport class NodeCreationTool extends BaseCreationTool<TriggerNodeCreationAction> {\n    static ID = 'tool_create_node';\n\n    protected isTriggerAction = TriggerNodeCreationAction.is;\n\n    @inject(TYPES.ISnapper) @optional() readonly snapper?: ISnapper;\n\n    get id(): string {\n        return NodeCreationTool.ID;\n    }\n\n    doEnable(): void {\n        this.toDisposeOnDisable.push(\n            this.mouseTool.registerListener(new NodeCreationToolMouseListener(this.triggerAction, this)),\n            this.registerFeedback([cursorFeedbackAction(CursorCSS.NODE_CREATION)], this, [cursorFeedbackAction()])\n        );\n    }\n}\n\n@injectable()\nexport class NodeCreationToolMouseListener extends DragAwareMouseListener {\n    protected container?: GModelElement & Containable;\n\n    constructor(protected triggerAction: TriggerNodeCreationAction, protected tool: NodeCreationTool) {\n        super();\n    }\n\n    protected creationAllowed(elementTypeId: string): boolean | undefined {\n        return this.container && this.container.isContainableElement(elementTypeId);\n    }\n\n    get elementTypeId(): string {\n        return this.triggerAction.elementTypeId;\n    }\n\n    override nonDraggingMouseUp(target: GModelElement, event: MouseEvent): Action[] {\n        const result: Action[] = [];\n        if (this.container === undefined) {\n            this.mouseOver(target, event);\n        }\n\n        if (this.creationAllowed(this.elementTypeId)) {\n            const containerId = this.container ? this.container.id : undefined;\n            let location = getAbsolutePosition(target, event);\n            if (this.tool.snapper) {\n                // Create a 0-bounds proxy element for snapping\n                const elementProxy = new GNode();\n                elementProxy.size = { width: 0, height: 0 };\n                location = this.tool.snapper.snap(location, elementProxy);\n            }\n            result.push(CreateNodeOperation.create(this.elementTypeId, { location, containerId, args: this.triggerAction.args }));\n            if (!isCtrlOrCmd(event)) {\n                result.push(EnableDefaultToolsAction.create());\n            }\n        }\n        return result;\n    }\n\n    override mouseOver(target: GModelElement, event: MouseEvent): Action[] {\n        const currentContainer = findParentByFeature(target, isContainable);\n        if (!this.container || currentContainer !== this.container) {\n            this.container = currentContainer;\n            const feedback = this.creationAllowed(this.elementTypeId)\n                ? cursorFeedbackAction(CursorCSS.NODE_CREATION)\n                : cursorFeedbackAction(CursorCSS.OPERATION_NOT_ALLOWED);\n            this.tool.registerFeedback([feedback]);\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Action, KeyListener, RedoAction, GModelElement, UndoAction, isMac, matchesKeystroke } from '@eclipse-glsp/sprotty';\n\n/**\n * Key listener that listens to the typical keyboard shortcuts for undo/redo and dispatches the corresponding actions.\n */\nexport class GLSPUndoRedoKeyListener extends KeyListener {\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'KeyZ', 'ctrlCmd')) {\n            return [UndoAction.create()];\n        }\n        if (matchesKeystroke(event, 'KeyZ', 'ctrlCmd', 'shift') || (!isMac() && matchesKeystroke(event, 'KeyY', 'ctrlCmd'))) {\n            return [RedoAction.create()];\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { GParentElement, MarkerKind } from '@eclipse-glsp/sprotty';\nimport { GIssueMarker } from '../features/validation/issue-marker';\n\nexport namespace MarkerPredicates {\n    export const ALL = (): boolean => true;\n    export const ERRORS = (marker: GIssueMarker): boolean => hasIssueWithSeverity(marker, MarkerKind.ERROR);\n    export const WARNINGS = (marker: GIssueMarker): boolean => hasIssueWithSeverity(marker, MarkerKind.WARNING);\n    export const INFOS = (marker: GIssueMarker): boolean => hasIssueWithSeverity(marker, MarkerKind.INFO);\n\n    export function hasIssueWithSeverity(marker: GIssueMarker, severity: 'info' | 'warning' | 'error'): boolean {\n        return marker.issues.find(issue => issue.severity === severity) !== undefined;\n    }\n}\n\nexport function collectIssueMarkers(root: GParentElement): GIssueMarker[] {\n    const markers = [];\n    for (const child of root.children) {\n        if (child instanceof GIssueMarker) {\n            markers.push(child);\n        }\n        markers.push(...collectIssueMarkers(child));\n    }\n    return markers;\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    Action,\n    BoundsAware,\n    CenterAction,\n    GIssueSeverity,\n    GModelElement,\n    GModelRoot,\n    IActionHandler,\n    IContextMenuItemProvider,\n    KeyListener,\n    MenuItem,\n    Point,\n    SelectAction,\n    Selectable,\n    TYPES,\n    findParentByFeature,\n    hasArrayProp,\n    hasStringProp,\n    isBoundsAware,\n    isSelectable,\n    matchesKeystroke\n} from '@eclipse-glsp/sprotty';\nimport { inject, injectable } from 'inversify';\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\nimport { SelectionService } from '../../base/selection-service';\nimport { getElements, isSelectableAndBoundsAware } from '../../utils/gmodel-util';\nimport { MarkerPredicates, collectIssueMarkers } from '../../utils/marker';\nimport { GIssueMarker } from './issue-marker';\n\nexport interface NavigateToMarkerAction extends Action {\n    kind: typeof NavigateToMarkerAction.KIND;\n\n    direction: MarkerNavigationDirection;\n    selectedElementIds?: string[];\n    severities: GIssueSeverity[];\n}\n\nexport type MarkerNavigationDirection = 'next' | 'previous';\n\nexport namespace NavigateToMarkerAction {\n    export const KIND = 'navigateToMarker';\n\n    export function is(object: any): object is NavigateToMarkerAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'direction') && hasArrayProp(object, 'severities');\n    }\n\n    export function create(options: {\n        direction?: MarkerNavigationDirection;\n        selectedElementIds?: string[];\n        severities?: GIssueSeverity[];\n    }): NavigateToMarkerAction {\n        return {\n            kind: KIND,\n            direction: 'next',\n            severities: MarkerNavigator.ALL_SEVERITIES,\n            ...options\n        };\n    }\n}\nexport class GModelElementComparator {\n    compare(_one: GModelElement, _other: GModelElement): number {\n        return 0;\n    }\n}\n\n/** Specifies the order of two selectable and bounds-aware elements left-to-right and top-to-bottom. */\n@injectable()\nexport class LeftToRightTopToBottomComparator {\n    compare(one: GModelElement, other: GModelElement): number {\n        const boundsOne = findParentByFeature(one, isSelectableAndBoundsAware);\n        const boundsOther = findParentByFeature(other, isSelectableAndBoundsAware);\n        if (boundsOne && boundsOther) {\n            if (boundsOne.bounds.y !== boundsOther.bounds.y) {\n                return boundsOne.bounds.y - boundsOther.bounds.y;\n            }\n            if (boundsOne.bounds.x !== boundsOther.bounds.x) {\n                return boundsOne.bounds.x - boundsOther.bounds.x;\n            }\n        }\n        return 0;\n    }\n}\n\n/**\n * Specifies the next/previous marker in a graph model.\n *\n * This navigator uses a `MarkerComparator` to determine the order of markers. It can also return next/previous\n */\n@injectable()\nexport class MarkerNavigator {\n    static readonly ALL_SEVERITIES: GIssueSeverity[] = ['error', 'warning', 'info'];\n\n    @inject(GModelElementComparator)\n    protected markerComparator: GModelElementComparator;\n\n    next(\n        root: Readonly<GModelRoot>,\n        current?: GModelElement & BoundsAware,\n        predicate: (marker: GIssueMarker) => boolean = MarkerPredicates.ALL\n    ): GIssueMarker | undefined {\n        const markers = this.getMarkers(root, predicate);\n        if (current === undefined) {\n            return markers.length > 0 ? markers[0] : undefined;\n        }\n        return markers[this.getNextIndex(current, markers) % markers.length];\n    }\n\n    previous(\n        root: Readonly<GModelRoot>,\n        current?: GModelElement & BoundsAware,\n        predicate: (marker: GIssueMarker) => boolean = MarkerPredicates.ALL\n    ): GIssueMarker | undefined {\n        const markers = this.getMarkers(root, predicate);\n        if (current === undefined) {\n            return markers.length > 0 ? markers[0] : undefined;\n        }\n        return markers[this.getPreviousIndex(current, markers) % markers.length];\n    }\n\n    protected getMarkers(root: Readonly<GModelRoot>, predicate: (marker: GIssueMarker) => boolean): GIssueMarker[] {\n        const markers = collectIssueMarkers(root);\n        return markers.filter(predicate).sort(this.markerComparator.compare);\n    }\n\n    protected getNextIndex(current: GModelElement & BoundsAware, markers: GIssueMarker[]): number {\n        for (let index = 0; index < markers.length; index++) {\n            if (this.markerComparator.compare(markers[index], current) > 0) {\n                return index;\n            }\n        }\n        return 0;\n    }\n\n    protected getPreviousIndex(current: GModelElement & BoundsAware, markers: GIssueMarker[]): number {\n        for (let index = markers.length - 1; index >= 0; index--) {\n            if (this.markerComparator.compare(markers[index], current) < 0) {\n                return index;\n            }\n        }\n        return markers.length - 1;\n    }\n}\n\n@injectable()\nexport class NavigateToMarkerActionHandler implements IActionHandler {\n    @inject(GModelElementComparator)\n    protected markerComparator: GModelElementComparator;\n\n    @inject(MarkerNavigator)\n    protected markerNavigator: MarkerNavigator;\n\n    @inject(SelectionService)\n    protected selectionService: SelectionService;\n\n    @inject(TYPES.IActionDispatcher)\n    protected actionDispatcher: GLSPActionDispatcher;\n\n    handle(action: NavigateToMarkerAction): void {\n        const selected = this.getSelectedElements(action);\n        const target = this.getTarget(action, selected);\n\n        const selectableTarget = target ? findParentByFeature(target, isSelectable) : undefined;\n        if (selectableTarget) {\n            const deselectedElementsIDs = selected.map(e => e.id).filter(id => id !== selectableTarget.id);\n            this.actionDispatcher.dispatch(SelectAction.create({ selectedElementsIDs: [selectableTarget.id], deselectedElementsIDs }));\n            this.actionDispatcher.dispatch(CenterAction.create([selectableTarget.id]));\n        }\n    }\n\n    protected getSelectedElements(action: NavigateToMarkerAction): (GModelElement & Selectable)[] {\n        if (action.selectedElementIds && action.selectedElementIds.length > 0) {\n            return getElements(this.selectionService.getModelRoot().index, action.selectedElementIds, isSelectable);\n        }\n        return this.selectionService.getSelectedElements();\n    }\n\n    protected getTarget(action: NavigateToMarkerAction, selected: GModelElement[]): GIssueMarker | undefined {\n        const root = this.selectionService.getModelRoot();\n        const target = selected.sort(this.markerComparator.compare).find(isBoundsAware);\n        if (action.direction === 'previous') {\n            return this.markerNavigator.previous(root, target, marker => this.matchesSeverities(action, marker));\n        } else {\n            return this.markerNavigator.next(root, target, marker => this.matchesSeverities(action, marker));\n        }\n    }\n\n    protected matchesSeverities(action: NavigateToMarkerAction, marker: GIssueMarker): boolean {\n        return marker.issues.find(issue => action.severities.includes(issue.severity)) !== undefined;\n    }\n}\n\n@injectable()\nexport class MarkerNavigatorContextMenuItemProvider implements IContextMenuItemProvider {\n    @inject(SelectionService) protected selectionService: SelectionService;\n\n    getItems(root: Readonly<GModelRoot>, lastMousePosition?: Point): Promise<MenuItem[]> {\n        const selectedElementIds = Array.from(this.selectionService.getSelectedElementIDs());\n        const hasMarkers = collectIssueMarkers(root).length > 0;\n        return Promise.resolve([\n            {\n                id: 'navigate',\n                label: 'Go to',\n                group: 'navigate',\n                actions: [],\n                children: [\n                    {\n                        id: 'next-marker',\n                        label: 'Next marker',\n                        group: 'marker',\n                        actions: [NavigateToMarkerAction.create({ direction: 'next', selectedElementIds })],\n                        isEnabled: () => hasMarkers\n                    },\n                    {\n                        id: 'previous-marker',\n                        label: 'Previous marker',\n                        group: 'marker',\n                        actions: [NavigateToMarkerAction.create({ direction: 'previous', selectedElementIds })],\n                        isEnabled: () => hasMarkers\n                    }\n                ]\n            }\n        ]);\n    }\n}\n\n@injectable()\nexport class MarkerNavigatorKeyListener extends KeyListener {\n    override keyDown(_element: GModelElement, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'Period', 'ctrl')) {\n            return [NavigateToMarkerAction.create({ direction: 'next' })];\n        } else if (matchesKeystroke(event, 'Comma', 'ctrl')) {\n            return [NavigateToMarkerAction.create({ direction: 'previous' })];\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable, optional } from 'inversify';\nimport {\n    Action,\n    CommandExecutionContext,\n    CommandReturn,\n    DeleteMarkersAction,\n    IActionDispatcher,\n    IActionHandler,\n    ICommand,\n    Marker,\n    GParentElement,\n    SetMarkersAction,\n    TYPES,\n    hasArrayProp\n} from '@eclipse-glsp/sprotty';\nimport { EditorContextService } from '../../base/editor-context-service';\nimport { IFeedbackActionDispatcher, IFeedbackEmitter } from '../../base/feedback/feedback-action-dispatcher';\nimport { FeedbackCommand } from '../../base/feedback/feedback-command';\nimport { removeCssClasses } from '../../utils/gmodel-util';\nimport { GIssueMarker, createGIssue, getOrCreateGIssueMarker, getGIssueMarker, getSeverity } from './issue-marker';\n\n/**\n * Feedback emitter sending actions for visualizing model validation feedback and\n * re-establishing this feedback visualization after the model has been updated.\n */\n@injectable()\nexport class ValidationFeedbackEmitter implements IFeedbackEmitter {\n    @inject(TYPES.IFeedbackActionDispatcher) protected feedbackActionDispatcher: IFeedbackActionDispatcher;\n\n    @inject(TYPES.IActionDispatcherProvider) protected actionDispatcher: () => Promise<IActionDispatcher>;\n\n    protected registeredFeedbackByReason: Map<string, ApplyMarkersAction> = new Map();\n\n    /**\n     * Register the action that should be emitted for visualizing validation feedback.\n     * @param action the action that should be emitted when the model is updated and that will visualize the model validation feedback.\n     * @param reason the reason for this validation feedback.\n     */\n    registerValidationFeedbackAction(action: ApplyMarkersAction, reason = ''): void {\n        // De-register feedback and clear existing markers with the same reason\n        const previousFeedbackWithSameReason = this.registeredFeedbackByReason.get(reason);\n        if (previousFeedbackWithSameReason) {\n            this.feedbackActionDispatcher.deregisterFeedback(this, [previousFeedbackWithSameReason]);\n            const deleteMarkersAction = DeleteMarkersAction.create(previousFeedbackWithSameReason.markers);\n            this.actionDispatcher().then(dispatcher => dispatcher.dispatch(deleteMarkersAction));\n        }\n\n        // Register new action responsible for applying markers and re-applying them when the model is updated\n        this.registeredFeedbackByReason.set(reason, action);\n        this.feedbackActionDispatcher.registerFeedback(this, [...this.registeredFeedbackByReason.values()]);\n    }\n}\n\n/**\n * Manages current markers for the outside of the GLSP.\n *\n * Typically this is rebound by the surrounding tool, e.g. Theia, to be aware of\n * and propagate current markers.\n */\n@injectable()\nexport abstract class ExternalMarkerManager {\n    languageLabel: string;\n\n    protected actionDispatcher?: IActionDispatcher;\n\n    connect(actionDispatcher: IActionDispatcher): void {\n        this.actionDispatcher = actionDispatcher;\n    }\n\n    removeMarkers(markers: Marker[]): void {\n        if (this.actionDispatcher) {\n            this.actionDispatcher.dispatch(DeleteMarkersAction.create(markers));\n        }\n    }\n\n    abstract setMarkers(markers: Marker[], reason?: string, sourceUri?: string): void;\n}\n\n@injectable()\nexport class SetMarkersActionHandler implements IActionHandler {\n    @inject(ValidationFeedbackEmitter)\n    protected validationFeedbackEmitter: ValidationFeedbackEmitter;\n\n    @inject(ExternalMarkerManager)\n    @optional()\n    protected externalMarkerManager?: ExternalMarkerManager;\n\n    @inject(EditorContextService)\n    protected editorContextService: EditorContextService;\n\n    handle(action: SetMarkersAction): void | Action | ICommand {\n        const markers: Marker[] = action.markers;\n        this.setMarkers(markers, action.reason);\n    }\n\n    async setMarkers(markers: Marker[], reason: string | undefined): Promise<void> {\n        const uri = this.editorContextService.sourceUri;\n        this.externalMarkerManager?.setMarkers(markers, reason, uri);\n        const applyMarkersAction = ApplyMarkersAction.create(markers);\n        this.validationFeedbackEmitter.registerValidationFeedbackAction(applyMarkersAction, reason);\n    }\n}\n\n/**\n * Action for applying makers to the graphical model.\n */\nexport interface ApplyMarkersAction extends Action {\n    kind: typeof ApplyMarkersAction.KIND;\n    markers: Marker[];\n}\n\nexport namespace ApplyMarkersAction {\n    export const KIND = 'applyMarkers';\n\n    export function is(object: any): object is ApplyMarkersAction {\n        return Action.hasKind(object, KIND) && hasArrayProp(object, 'markers');\n    }\n\n    export function create(markers: Marker[]): ApplyMarkersAction {\n        return {\n            kind: KIND,\n            markers\n        };\n    }\n}\n\n/**\n * Handles {@link ApplyMarkersAction}s by creating the corresponding {@link GIssueMarker}s and\n * adding them to the graphical model.\n */\n@injectable()\nexport class ApplyMarkersCommand extends FeedbackCommand {\n    static KIND = ApplyMarkersAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: ApplyMarkersAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        this.action.markers.forEach(marker => {\n            const modelElement = context.root.index.getById(marker.elementId);\n            if (modelElement instanceof GParentElement) {\n                const issueMarker = getOrCreateGIssueMarker(modelElement);\n                const issue = createGIssue(marker);\n                issueMarker.issues.push(issue);\n                if (issueMarker instanceof GIssueMarker) {\n                    issueMarker.computeProjectionCssClasses();\n                }\n                addMaxSeverityCSSClassToIssueParent(modelElement, issueMarker);\n            }\n        });\n        return context.root;\n    }\n}\n\nfunction addMaxSeverityCSSClassToIssueParent(modelElement: GParentElement, issueMarker: GIssueMarker): void {\n    const maxSeverityCSSClass = getSeverity(issueMarker);\n    if (!modelElement.cssClasses) {\n        modelElement.cssClasses = [maxSeverityCSSClass];\n    } else {\n        modelElement.cssClasses = modelElement.cssClasses.filter((value: string) => !value.match('info|warning|error'));\n        modelElement.cssClasses.push(maxSeverityCSSClass);\n    }\n}\n\nfunction removeCSSClassFromIssueParent(modelElement: GParentElement, issueMarker: GIssueMarker): void {\n    const severity = getSeverity(issueMarker);\n    removeCssClasses(modelElement, [severity]);\n}\n\n/**\n * Command for handling `DeleteMarkersAction`\n */\n@injectable()\nexport class DeleteMarkersCommand extends FeedbackCommand {\n    static KIND = DeleteMarkersAction.KIND;\n\n    constructor(@inject(TYPES.Action) protected action: DeleteMarkersAction) {\n        super();\n    }\n\n    execute(context: CommandExecutionContext): CommandReturn {\n        this.action.markers.forEach(marker => {\n            const modelElement = context.root.index.getById(marker.elementId);\n            if (modelElement instanceof GParentElement) {\n                const issueMarker = getGIssueMarker(modelElement);\n                if (issueMarker) {\n                    removeCSSClassFromIssueParent(modelElement, issueMarker);\n                    for (let index = 0; index < issueMarker.issues.length; ++index) {\n                        const issue = issueMarker.issues[index];\n                        if (issue.message === marker.description) {\n                            issueMarker.issues.splice(index--, 1);\n                        }\n                    }\n                    if (issueMarker.issues.length === 0) {\n                        modelElement.remove(issueMarker);\n                    } else {\n                        addMaxSeverityCSSClassToIssueParent(modelElement, issueMarker);\n                    }\n                }\n            }\n        });\n\n        return context.root;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { Action, IActionHandler, ICommand, ScrollMouseListener, GModelElement } from '@eclipse-glsp/sprotty';\nimport { EnableDefaultToolsAction, EnableToolsAction } from '../../base/tool-manager/tool';\nimport { MarqueeMouseTool } from '../tools/marquee-selection/marquee-mouse-tool';\n\n@injectable()\nexport class GLSPScrollMouseListener extends ScrollMouseListener implements IActionHandler {\n    preventScrolling = false;\n\n    handle(action: Action): void | Action | ICommand {\n        if (action.kind === EnableToolsAction.KIND) {\n            if ((action as EnableToolsAction).toolIds.includes(MarqueeMouseTool.ID)) {\n                this.preventScrolling = true;\n            }\n        } else if (action.kind === EnableDefaultToolsAction.KIND) {\n            this.preventScrolling = false;\n        }\n    }\n\n    override mouseDown(target: GModelElement, event: MouseEvent): (Action | Promise<Action>)[] {\n        if (this.preventScrolling) {\n            return [];\n        }\n        return super.mouseDown(target, event);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport '@vscode/codicons/dist/codicon.css';\nimport {\n    ActionHandlerRegistry,\n    FeatureModule,\n    KeyTool,\n    LocationPostprocessor,\n    MouseTool,\n    MoveCommand,\n    SetDirtyStateAction,\n    SetEditModeAction,\n    TYPES,\n    bindAsService,\n    bindOrRebind,\n    configureActionHandler,\n    configureCommand,\n    sprottyDefaultModule\n} from '@eclipse-glsp/sprotty';\nimport '../../css/glsp-sprotty.css';\nimport { GLSPActionDispatcher } from './action-dispatcher';\nimport { GLSPActionHandlerRegistry } from './action-handler-registry';\nimport { GLSPCommandStack } from './command-stack';\nimport { EditorContextService } from './editor-context-service';\nimport { ModifyCssFeedbackCommand } from './feedback/css-feedback';\nimport { FeedbackActionDispatcher } from './feedback/feedback-action-dispatcher';\nimport { FeedbackAwareUpdateModelCommand } from './feedback/update-model-command';\nimport { FocusStateChangedAction } from './focus/focus-state-change-action';\nimport { FocusTracker } from './focus/focus-tracker';\nimport { DiagramLoader } from './model/diagram-loader';\nimport { GLSPModelSource } from './model/glsp-model-source';\nimport { DefaultModelInitializationConstraint, ModelInitializationConstraint } from './model/model-initialization-constraint';\nimport { GModelRegistry } from './model/model-registry';\nimport { SelectionClearingMouseListener } from './selection-clearing-mouse-listener';\nimport { SelectionService } from './selection-service';\nimport { EnableDefaultToolsAction, EnableToolsAction } from './tool-manager/tool';\nimport { DefaultToolsEnablingKeyListener, ToolManager, ToolManagerActionHandler } from './tool-manager/tool-manager';\nimport { GLSPKeyTool } from './view/key-tool';\nimport { GLSPMouseTool } from './view/mouse-tool';\nimport { GViewRegistry } from './view/view-registry';\n\n/**\n * The default module provides all of GLSP's base functionality and services.\n * It builds on top of sprotty's default module {@link `sprottyDefaultModule`}.\n */\nexport const defaultModule = new FeatureModule((bind, unbind, isBound, rebind, ...rest) => {\n    // load bindings from sprotty's default module to avoid code duplication\n    sprottyDefaultModule.registry(bind, unbind, isBound, rebind, ...rest);\n    const context = { bind, unbind, isBound, rebind };\n\n    bind(EditorContextService).toSelf().inSingletonScope();\n    bind(TYPES.IEditorContextServiceProvider).toProvider<EditorContextService>(ctx => async () => ctx.container.get(EditorContextService));\n\n    configureActionHandler(context, SetEditModeAction.KIND, EditorContextService);\n    configureActionHandler(context, SetDirtyStateAction.KIND, EditorContextService);\n\n    bind(FocusTracker).toSelf().inSingletonScope();\n    configureActionHandler(context, FocusStateChangedAction.KIND, FocusTracker);\n\n    // Model update initialization ------------------------------------\n    bind(TYPES.IFeedbackActionDispatcher).to(FeedbackActionDispatcher).inSingletonScope();\n    configureCommand(context, FeedbackAwareUpdateModelCommand);\n\n    bind(GLSPMouseTool).toSelf().inSingletonScope();\n    bindOrRebind(context, MouseTool).toService(GLSPMouseTool);\n    bind(GLSPKeyTool).toSelf().inSingletonScope();\n    bindOrRebind(context, KeyTool).toService(GLSPKeyTool);\n\n    bindAsService(context, TYPES.MouseListener, SelectionClearingMouseListener);\n\n    bindOrRebind(context, TYPES.ICommandStack).to(GLSPCommandStack).inSingletonScope();\n    bind(GLSPActionDispatcher).toSelf().inSingletonScope();\n    bindOrRebind(context, TYPES.IActionDispatcher).toService(GLSPActionDispatcher);\n    bind(GLSPActionHandlerRegistry).toSelf().inSingletonScope();\n    bindOrRebind(context, ActionHandlerRegistry).toService(GLSPActionHandlerRegistry);\n\n    bindAsService(context, TYPES.ModelSource, GLSPModelSource);\n    bind(DiagramLoader).toSelf().inSingletonScope();\n    bind(ModelInitializationConstraint).to(DefaultModelInitializationConstraint).inSingletonScope();\n\n    // support re-registration of model elements and views\n    bindOrRebind(context, TYPES.SModelRegistry).to(GModelRegistry).inSingletonScope();\n    bindOrRebind(context, TYPES.ViewRegistry).to(GViewRegistry).inSingletonScope();\n\n    bind(SelectionService).toSelf().inSingletonScope();\n    bind(TYPES.ISModelRootListener).toService(SelectionService);\n\n    // Feedback Support ------------------------------------\n    // Generic re-usable feedback modifying css classes\n    configureCommand(context, ModifyCssFeedbackCommand);\n    // We support using sprotty's MoveCommand as client-side visual feedback\n    configureCommand(context, MoveCommand);\n\n    bindAsService(context, TYPES.IVNodePostprocessor, LocationPostprocessor);\n    bind(TYPES.HiddenVNodePostprocessor).toService(LocationPostprocessor);\n\n    // Tool manager initialization ------------------------------------\n    bind(TYPES.IToolManager).to(ToolManager).inSingletonScope();\n    bind(DefaultToolsEnablingKeyListener).toSelf().inSingletonScope();\n    bind(TYPES.KeyListener).toService(DefaultToolsEnablingKeyListener);\n    bind(ToolManagerActionHandler).toSelf().inSingletonScope();\n    configureActionHandler(context, EnableDefaultToolsAction.KIND, ToolManagerActionHandler);\n    configureActionHandler(context, EnableToolsAction.KIND, ToolManagerActionHandler);\n});\n", "/********************************************************************************\n * Copyright (c) 2022-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    FeatureModule,\n    HBoxLayouter,\n    HiddenBoundsUpdater,\n    LayoutRegistry,\n    RequestBoundsCommand,\n    SetBoundsCommand,\n    TYPES,\n    VBoxLayouter,\n    bindAsService,\n    configureCommand,\n    configureLayout\n} from '@eclipse-glsp/sprotty';\nimport { FreeFormLayouter } from './freeform-layout';\nimport { GLSPHiddenBoundsUpdater } from './glsp-hidden-bounds-updater';\nimport { HBoxLayouterExt } from './hbox-layout';\nimport { LayouterExt } from './layouter';\nimport { VBoxLayouterExt } from './vbox-layout';\n\nexport const boundsModule = new FeatureModule((bind, _unbind, isBound, _rebind) => {\n    const context = { bind, isBound };\n    configureCommand(context, SetBoundsCommand);\n    configureCommand(context, RequestBoundsCommand);\n    bind(HiddenBoundsUpdater).toSelf().inSingletonScope();\n    bindAsService(context, TYPES.HiddenVNodePostprocessor, GLSPHiddenBoundsUpdater);\n    bind(TYPES.Layouter).to(LayouterExt).inSingletonScope();\n    bind(TYPES.LayoutRegistry).to(LayoutRegistry).inSingletonScope();\n\n    configureLayout(context, VBoxLayouter.KIND, VBoxLayouterExt);\n    configureLayout(context, HBoxLayouter.KIND, HBoxLayouterExt);\n    configureLayout(context, FreeFormLayouter.KIND, FreeFormLayouter);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { CommandPalette, CommandPaletteActionProviderRegistry, FeatureModule, TYPES, bindAsService } from '@eclipse-glsp/sprotty';\nimport '../../../css/command-palette.css';\nimport { CommandPaletteTool } from './command-palette-tool';\nimport { ServerCommandPaletteActionProvider } from './server-command-palette-provider';\n\nexport const commandPaletteModule = new FeatureModule(bind => {\n    bindAsService(bind, TYPES.IUIExtension, CommandPalette);\n    bind(TYPES.ICommandPaletteActionProviderRegistry).to(CommandPaletteActionProviderRegistry).inSingletonScope();\n    bindAsService(bind, TYPES.ICommandPaletteActionProvider, ServerCommandPaletteActionProvider);\n    bindAsService(bind, TYPES.IDefaultTool, CommandPaletteTool);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { ContextMenuProviderRegistry, FeatureModule, IContextMenuService, TYPES, bindAsService } from '@eclipse-glsp/sprotty';\nimport { GLSPContextMenuMouseListener } from './glsp-context-menu-mouse-listener';\nimport { ServerContextMenuItemProvider } from './server-context-menu-provider';\n\nexport const contextMenuModule = new FeatureModule(bind => {\n    bind(TYPES.IContextMenuServiceProvider).toProvider<IContextMenuService>(ctx => async () => {\n        if (ctx.container.isBound(TYPES.IContextMenuService)) {\n            return ctx.container.get<IContextMenuService>(TYPES.IContextMenuService);\n        }\n        console.warn(\"'TYPES.IContextMenuService' is not bound. Use no-op implementation instead\");\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        return { show: () => {} };\n    });\n\n    bindAsService(bind, TYPES.MouseListener, GLSPContextMenuMouseListener);\n    bind(TYPES.IContextMenuProviderRegistry).to(ContextMenuProviderRegistry);\n    bindAsService(bind, TYPES.IContextMenuItemProvider, ServerContextMenuItemProvider);\n});\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Disposable, DisposableCollection, TYPES } from '@eclipse-glsp/sprotty';\nimport { inject, injectable, optional, preDestroy } from 'inversify';\nimport { IDiagramStartup } from '../../base/model/diagram-loader';\nimport { ICopyPasteHandler } from './copy-paste-handler';\n/**\n * Startup service to hook up the copy&paste event handler\n */\n@injectable()\nexport class CopyPasteStartup implements IDiagramStartup, Disposable {\n    @inject(TYPES.ICopyPasteHandler)\n    @optional()\n    protected copyPasteHandler?: ICopyPasteHandler;\n\n    protected toDispose = new DisposableCollection();\n\n    postModelInitialization(): void {\n        if (!this.copyPasteHandler) {\n            return;\n        }\n        const copyListener = (e: ClipboardEvent): void => {\n            this.copyPasteHandler?.handleCopy(e);\n            e.preventDefault();\n        };\n        const cutListener = (e: ClipboardEvent): void => {\n            this.copyPasteHandler?.handleCut(e);\n            e.preventDefault();\n        };\n        const pasteListener = (e: ClipboardEvent): void => {\n            this.copyPasteHandler?.handlePaste(e);\n            e.preventDefault();\n        };\n        window.addEventListener('copy', copyListener);\n        window.addEventListener('cut', cutListener);\n        window.addEventListener('paste', pasteListener);\n\n        this.toDispose.push(\n            Disposable.create(() => {\n                window.removeEventListener('copy', copyListener);\n                window.removeEventListener('cut', cutListener);\n                window.removeEventListener('paste', pasteListener);\n            })\n        );\n    }\n\n    @preDestroy()\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { bindAsService, FeatureModule, TYPES } from '@eclipse-glsp/sprotty';\nimport { LocalClipboardService, ServerCopyPasteHandler } from './copy-paste-handler';\nimport { CopyPasteStartup } from './copy-paste-standalone';\n\nexport const copyPasteModule = new FeatureModule((bind, _unbind, isBound) => {\n    bind(TYPES.ICopyPasteHandler).to(ServerCopyPasteHandler);\n    bind(TYPES.IAsyncClipboardService).to(LocalClipboardService).inSingletonScope();\n});\n\n/**\n * Feature module that is intended for the standalone deployment of GLSP (i.e. plain webapp)\n * When integrated into an application frame (e.g Theia/VS Code) this module is typically omitted and/or replaced\n * with an application native module.\n */\nexport const standaloneCopyPasteModule = new FeatureModule(\n    (bind, _unbind, isBound) => {\n        bindAsService(bind, TYPES.IDiagramStartup, CopyPasteStartup);\n    },\n    { requires: copyPasteModule }\n);\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, TYPES, bindAsService } from '@eclipse-glsp/sprotty';\nimport '../../../css/decoration.css';\nimport { GlspDecorationPlacer } from './decoration-placer';\n\nexport const decorationModule = new FeatureModule(bind => {\n    bindAsService(bind, TYPES.IVNodePostprocessor, GlspDecorationPlacer);\n});\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { saveAs } from 'file-saver';\nimport { injectable } from 'inversify';\nimport { ExportSvgAction, IActionHandler } from '@eclipse-glsp/sprotty';\n\n/**\n * The default handler for {@link ExportSvgAction}s. This generic handler can be used in\n * any GLSP project independent of the target platform. However, platform integration modules typically\n *  * this handler is rebound to an application specific handler in platform integration modules\n * (e.g. the Theia integration)\n */\n@injectable()\nexport class ExportSvgActionHandler implements IActionHandler {\n    handle(action: ExportSvgAction): void {\n        const blob = new Blob([action.svg], { type: 'text/plain;charset=utf-8' });\n        saveAs(blob, 'diagram.svg');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    bindAsService,\n    configureActionHandler,\n    configureCommand,\n    ExportSvgAction,\n    ExportSvgCommand,\n    ExportSvgKeyListener,\n    ExportSvgPostprocessor,\n    FeatureModule,\n    TYPES\n} from '@eclipse-glsp/sprotty';\nimport { ExportSvgActionHandler } from './export-svg-action-handler';\nimport { GLSPSvgExporter } from './glsp-svg-exporter';\n\nexport const exportModule = new FeatureModule((bind, _unbind, isBound) => {\n    const context = { bind, isBound };\n    bindAsService(context, TYPES.HiddenVNodePostprocessor, ExportSvgPostprocessor);\n    configureCommand(context, ExportSvgCommand);\n    bind(TYPES.SvgExporter).to(GLSPSvgExporter).inSingletonScope();\n});\n\n/**\n * Feature module that is intended for the standalone deployment of GLSP (i.e. plain webapp)\n * When integrated into an application frame (e.g Theia/VS Code) this module is typically omitted and/or replaced\n * with an application native module.\n */\nexport const standaloneExportModule = new FeatureModule(\n    (bind, _unbind, isBound) => {\n        const context = { bind, isBound };\n        bindAsService(context, TYPES.KeyListener, ExportSvgKeyListener);\n        bind(ExportSvgActionHandler).toSelf().inSingletonScope();\n        configureActionHandler(context, ExportSvgAction.KIND, ExportSvgActionHandler);\n    },\n    { requires: exportModule }\n);\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, SetTypeHintsAction, TYPES, bindAsService, configureActionHandler, configureCommand } from '@eclipse-glsp/sprotty';\nimport { ApplyTypeHintsCommand, TypeHintProvider } from './type-hint-provider';\n\nexport const typeHintsModule = new FeatureModule((bind, unbind, isBound) => {\n    const context = { bind, unbind, isBound };\n    bindAsService(context, TYPES.ITypeHintProvider, TypeHintProvider);\n    bind(TYPES.IDiagramStartup).toService(TypeHintProvider);\n    configureActionHandler(context, SetTypeHintsAction.KIND, TypeHintProvider);\n    configureCommand(context, ApplyTypeHintsCommand);\n});\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    CenterCommand,\n    ClosePopupActionHandler,\n    FeatureModule,\n    FitToScreenCommand,\n    HoverFeedbackCommand,\n    HoverKeyListener,\n    HoverState,\n    MoveCommand,\n    PopupHoverMouseListener,\n    PopupPositionUpdater,\n    SetPopupModelCommand,\n    SetViewportCommand,\n    TYPES,\n    bindAsService,\n    configureActionHandler,\n    configureCommand\n} from '@eclipse-glsp/sprotty';\nimport { FocusStateChangedAction } from '../../base/focus/focus-state-change-action';\nimport { EnableDefaultToolsAction, EnableToolsAction } from '../../base/tool-manager/tool';\nimport { GlspHoverMouseListener } from './hover';\n\nexport const hoverModule = new FeatureModule((bind, _unbind, isBound) => {\n    const context = { bind, isBound };\n    bindAsService(context, TYPES.PopupVNodePostprocessor, PopupPositionUpdater);\n    bindAsService(context, TYPES.MouseListener, GlspHoverMouseListener);\n    bindAsService(context, TYPES.PopupMouseListener, PopupHoverMouseListener);\n    bindAsService(context, TYPES.KeyListener, HoverKeyListener);\n\n    bind<HoverState>(TYPES.HoverState).toConstantValue({\n        mouseOverTimer: undefined,\n        mouseOutTimer: undefined,\n        popupOpen: false,\n        previousPopupElement: undefined\n    });\n    bind(ClosePopupActionHandler).toSelf().inSingletonScope();\n\n    configureCommand(context, HoverFeedbackCommand);\n    configureCommand(context, SetPopupModelCommand);\n    configureActionHandler(context, SetPopupModelCommand.KIND, ClosePopupActionHandler);\n    configureActionHandler(context, FitToScreenCommand.KIND, ClosePopupActionHandler);\n    configureActionHandler(context, CenterCommand.KIND, ClosePopupActionHandler);\n    configureActionHandler(context, SetViewportCommand.KIND, ClosePopupActionHandler);\n    configureActionHandler(context, MoveCommand.KIND, ClosePopupActionHandler);\n    configureActionHandler(context, FocusStateChangedAction.KIND, ClosePopupActionHandler);\n    configureActionHandler(context, EnableToolsAction.KIND, GlspHoverMouseListener);\n    configureActionHandler(context, EnableDefaultToolsAction.KIND, GlspHoverMouseListener);\n    configureActionHandler(context, FocusStateChangedAction.KIND, GlspHoverMouseListener);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { ApplyLabelEditCommand, FeatureModule, TYPES, bindAsService, configureCommand } from '@eclipse-glsp/sprotty';\nimport { DirectLabelEditTool } from './edit-label-tool';\nimport { BalloonLabelValidationDecorator, ServerEditLabelValidator } from './edit-label-validator';\n\nexport const labelEditModule = new FeatureModule((bind, _unbind, isBound, _rebind) => {\n    bind(TYPES.IEditLabelValidator).to(ServerEditLabelValidator);\n    bind(TYPES.IEditLabelValidationDecorator).to(BalloonLabelValidationDecorator);\n    bindAsService(bind, TYPES.IDefaultTool, DirectLabelEditTool);\n    configureCommand({ bind, isBound }, ApplyLabelEditCommand);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, configureActionHandler } from '@eclipse-glsp/sprotty';\nimport {\n    AlignElementsAction,\n    AlignElementsActionHandler,\n    ResizeElementsAction,\n    ResizeElementsActionHandler\n} from './layout-elements-action';\n\nexport const layoutModule = new FeatureModule((bind, _unbind, isBound) => {\n    const context = { bind, isBound };\n    configureActionHandler(context, ResizeElementsAction.KIND, ResizeElementsActionHandler);\n    configureActionHandler(context, AlignElementsAction.KIND, AlignElementsActionHandler);\n});\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, NavigateToExternalTargetAction, NavigateToTargetAction, configureActionHandler } from '@eclipse-glsp/sprotty';\nimport { NavigateAction, NavigationActionHandler, ProcessNavigationArgumentsAction } from './navigation-action-handler';\nimport { NavigationTargetResolver } from './navigation-target-resolver';\n\nexport const navigationModule = new FeatureModule((bind, _unbind, isBound) => {\n    bind(NavigationTargetResolver).toSelf().inSingletonScope();\n    bind(NavigationActionHandler).toSelf().inSingletonScope();\n    configureActionHandler({ bind, isBound }, NavigateAction.KIND, NavigationActionHandler);\n    configureActionHandler({ bind, isBound }, NavigateToTargetAction.KIND, NavigationActionHandler);\n    configureActionHandler({ bind, isBound }, ProcessNavigationArgumentsAction.KIND, NavigationActionHandler);\n    configureActionHandler({ bind, isBound }, NavigateToExternalTargetAction.KIND, NavigationActionHandler);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    AddRemoveBezierSegmentCommand,\n    AnchorComputerRegistry,\n    BezierDiamondAnchor,\n    BezierEdgeRouter,\n    BezierEllipseAnchor,\n    BezierRectangleAnchor,\n    DiamondAnchor,\n    EdgeRouterRegistry,\n    EllipseAnchor,\n    FeatureModule,\n    ManhattanDiamondAnchor,\n    ManhattanEllipticAnchor,\n    ManhattanRectangularAnchor,\n    PolylineEdgeRouter,\n    RectangleAnchor,\n    TYPES,\n    bindAsService,\n    configureCommand\n} from '@eclipse-glsp/sprotty';\nimport { GLSPManhattanEdgeRouter } from './glsp-manhattan-edge-router';\n\nexport const routingModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    bind(EdgeRouterRegistry).toSelf().inSingletonScope();\n    bind(AnchorComputerRegistry).toSelf().inSingletonScope();\n\n    bindAsService(context, TYPES.IEdgeRouter, GLSPManhattanEdgeRouter);\n    bindAsService(context, TYPES.IAnchorComputer, ManhattanEllipticAnchor);\n    bindAsService(context, TYPES.IAnchorComputer, ManhattanRectangularAnchor);\n    bindAsService(context, TYPES.IAnchorComputer, ManhattanDiamondAnchor);\n\n    bindAsService(context, TYPES.IEdgeRouter, PolylineEdgeRouter);\n    bindAsService(context, TYPES.IAnchorComputer, EllipseAnchor);\n    bindAsService(context, TYPES.IAnchorComputer, RectangleAnchor);\n    bindAsService(context, TYPES.IAnchorComputer, DiamondAnchor);\n\n    bindAsService(context, TYPES.IEdgeRouter, BezierEdgeRouter);\n    bindAsService(context, TYPES.IAnchorComputer, BezierEllipseAnchor);\n    bindAsService(context, TYPES.IAnchorComputer, BezierRectangleAnchor);\n    bindAsService(context, TYPES.IAnchorComputer, BezierDiamondAnchor);\n\n    configureCommand({ bind, isBound }, AddRemoveBezierSegmentCommand);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, SelectKeyboardListener, TYPES, bindAsService, configureCommand } from '@eclipse-glsp/sprotty';\nimport { SelectAllCommand, SelectCommand } from '../../base/selection-service';\nimport { SelectFeedbackCommand } from './select-feedback-command';\nimport { RankedSelectMouseListener } from './select-mouse-listener';\n\nexport const selectModule = new FeatureModule((bind, _unbind, isBound) => {\n    const context = { bind, isBound };\n    configureCommand(context, SelectCommand);\n    configureCommand(context, SelectAllCommand);\n    configureCommand(context, SelectFeedbackCommand);\n    bindAsService(context, TYPES.MouseListener, RankedSelectMouseListener);\n});\n\n/**\n * Feature module that is intended for the standalone deployment of GLSP (i.e. plain webapp)\n * When integrated into an application frame (e.g Theia/VS Code) this module is typically omitted and/or replaced\n * with an application native module.\n */\nexport const standaloneSelectModule = new FeatureModule(\n    bind => {\n        bindAsService(bind, TYPES.KeyListener, SelectKeyboardListener);\n    },\n    { requires: selectModule }\n);\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, SourceModelChangedAction, configureActionHandler } from '@eclipse-glsp/sprotty';\nimport { SourceModelChangedActionHandler } from './source-model-changed-action-handler';\n\nexport const sourceModelWatcherModule = new FeatureModule((bind, _unbind, isBound) => {\n    configureActionHandler({ bind, isBound }, SourceModelChangedAction.KIND, SourceModelChangedActionHandler);\n});\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { FeatureModule, StatusAction, TYPES, bindAsService, configureActionHandler } from '@eclipse-glsp/sprotty';\nimport '../../../css/status-overlay.css';\nimport { StatusOverlay } from './status-overlay';\n\nexport const statusModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    bindAsService(context, TYPES.IUIExtension, StatusOverlay);\n    bind(TYPES.IDiagramStartup).toService(StatusOverlay);\n    configureActionHandler(context, StatusAction.KIND, StatusOverlay);\n});\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { FeatureModule, TYPES } from '@eclipse-glsp/sprotty';\nimport { MetadataPlacer } from './metadata-placer';\n\nexport const svgMetadataModule = new FeatureModule(bind => {\n    bind(MetadataPlacer).toSelf().inSingletonScope();\n    bind(TYPES.IVNodePostprocessor).toService(MetadataPlacer);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { bindAsService, configureActionHandler, FeatureModule, TYPES } from '@eclipse-glsp/sprotty';\nimport '../../../css/tool-palette.css';\nimport { EnableDefaultToolsAction } from '../../base/tool-manager/tool';\nimport { ToolPalette } from './tool-palette';\n\nexport const toolPaletteModule = new FeatureModule((bind, _unbind, isBound, _rebind) => {\n    bindAsService(bind, TYPES.IUIExtension, ToolPalette);\n    bind(TYPES.IDiagramStartup).toService(ToolPalette);\n    configureActionHandler({ bind, isBound }, EnableDefaultToolsAction.KIND, ToolPalette);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, TYPES, bindAsService, configureCommand, configureView } from '@eclipse-glsp/sprotty';\nimport { SResizeHandle } from '../../change-bounds/model';\nimport { ChangeBoundsTool } from './change-bounds-tool';\nimport { HideChangeBoundsToolResizeFeedbackCommand, ShowChangeBoundsToolResizeFeedbackCommand } from './change-bounds-tool-feedback';\nimport { SResizeHandleView } from './view';\n\nexport const changeBoundsToolModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    bindAsService(context, TYPES.IDefaultTool, ChangeBoundsTool);\n    configureCommand(context, ShowChangeBoundsToolResizeFeedbackCommand);\n    configureCommand(context, HideChangeBoundsToolResizeFeedbackCommand);\n    configureView(context, SResizeHandle.TYPE, SResizeHandleView);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, TYPES, bindAsService } from '@eclipse-glsp/sprotty';\nimport { DelKeyDeleteTool, MouseDeleteTool } from './delete-tool';\n\nexport const deletionToolModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    bindAsService(context, TYPES.IDefaultTool, DelKeyDeleteTool);\n    bindAsService(context, TYPES.ITool, MouseDeleteTool);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, TYPES, TriggerEdgeCreationAction, bindAsService, configureActionHandler } from '@eclipse-glsp/sprotty';\nimport { configureDanglingFeedbackEdge } from './dangling-edge-feedback';\nimport { EdgeCreationTool } from './edge-creation-tool';\n\nexport const edgeCreationToolModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    bindAsService(context, TYPES.ITool, EdgeCreationTool);\n    configureActionHandler(context, TriggerEdgeCreationAction.KIND, EdgeCreationTool);\n    configureDanglingFeedbackEdge(context);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, TYPES, bindAsService, configureCommand } from '@eclipse-glsp/sprotty';\nimport { configureDanglingFeedbackEdge } from '../edge-creation/dangling-edge-feedback';\nimport { EdgeEditTool } from './edge-edit-tool';\nimport {\n    DrawFeedbackEdgeSourceCommand,\n    HideEdgeReconnectHandlesFeedbackCommand,\n    ShowEdgeReconnectHandlesFeedbackCommand,\n    SwitchRoutingModeCommand\n} from './edge-edit-tool-feedback';\n\nexport const edgeEditToolModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    bindAsService(context, TYPES.IDefaultTool, EdgeEditTool);\n\n    // reconnect edge tool feedback\n    configureCommand(context, ShowEdgeReconnectHandlesFeedbackCommand);\n    configureCommand(context, HideEdgeReconnectHandlesFeedbackCommand);\n    configureCommand(context, DrawFeedbackEdgeSourceCommand);\n    configureCommand(context, SwitchRoutingModeCommand);\n\n    // dangling edge feedback\n    configureDanglingFeedbackEdge(context);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, TYPES, bindAsService, configureCommand, configureModelElement } from '@eclipse-glsp/sprotty';\nimport { MarqueeMouseTool } from './marquee-mouse-tool';\nimport { MarqueeTool } from './marquee-tool';\nimport { DrawMarqueeCommand, MARQUEE, RemoveMarqueeCommand } from './marquee-tool-feedback';\nimport { MarqueeNode } from './model';\nimport { MarqueeView } from './view';\n\nexport const marqueeSelectionToolModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    bindAsService(context, TYPES.IDefaultTool, MarqueeTool);\n    bindAsService(context, TYPES.ITool, MarqueeMouseTool);\n\n    configureCommand(context, DrawMarqueeCommand);\n    configureCommand(context, RemoveMarqueeCommand);\n\n    configureModelElement(context, MARQUEE, MarqueeNode, MarqueeView);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, TYPES, TriggerNodeCreationAction, bindAsService, configureActionHandler } from '@eclipse-glsp/sprotty';\nimport { NodeCreationTool } from './node-creation-tool';\n\nexport const nodeCreationToolModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    bindAsService(context, TYPES.ITool, NodeCreationTool);\n    configureActionHandler(context, TriggerNodeCreationAction.KIND, NodeCreationTool);\n});\n", "/********************************************************************************\n * Copyright (c) 2022-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { Action, FeatureModule, IActionHandler, ICommand, configureActionHandler } from '@eclipse-glsp/sprotty';\nimport { FocusStateChangedAction } from '../../base/focus/focus-state-change-action';\nimport { EnableDefaultToolsAction } from '../../base/tool-manager/tool';\n\n/**\n * Action handler that enables the default tools when the diagram lost focus.\n * @see FocusStateChangedAction\n */\n@injectable()\nexport class EnableDefaultToolsOnFocusLossHandler implements IActionHandler {\n    handle(action: Action): void | Action | ICommand {\n        if (FocusStateChangedAction.is(action) && !action.hasFocus) {\n            return EnableDefaultToolsAction.create();\n        }\n    }\n}\n\n/**\n * Enables the default tools in the tool manager if the diagram looses focus.\n */\nexport const toolFocusLossModule = new FeatureModule((bind, _unbind, isBound) => {\n    configureActionHandler({ bind, isBound }, FocusStateChangedAction.KIND, EnableDefaultToolsOnFocusLossHandler);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, SetMarkersAction, TYPES, bindAsService, configureActionHandler, configureCommand } from '@eclipse-glsp/sprotty';\nimport {\n    GModelElementComparator,\n    LeftToRightTopToBottomComparator,\n    MarkerNavigator,\n    MarkerNavigatorContextMenuItemProvider,\n    MarkerNavigatorKeyListener,\n    NavigateToMarkerAction,\n    NavigateToMarkerActionHandler\n} from './marker-navigator';\nimport { ApplyMarkersCommand, DeleteMarkersCommand, SetMarkersActionHandler, ValidationFeedbackEmitter } from './validate';\n\nexport const validationModule = new FeatureModule((bind, _unbind, isBound) => {\n    const context = { bind, isBound };\n    configureActionHandler(context, SetMarkersAction.KIND, SetMarkersActionHandler);\n    configureCommand(context, ApplyMarkersCommand);\n    configureCommand(context, DeleteMarkersCommand);\n    bind(ValidationFeedbackEmitter).toSelf().inSingletonScope();\n});\n\nexport const markerNavigatorModule = new FeatureModule((bind, _unbind, isBound) => {\n    bind(GModelElementComparator).to(LeftToRightTopToBottomComparator).inSingletonScope();\n    bind(MarkerNavigator).toSelf().inSingletonScope();\n    configureActionHandler({ bind, isBound }, NavigateToMarkerAction.KIND, NavigateToMarkerActionHandler);\n});\n\n/**\n * Feature module that is intended for the standalone deployment of GLSP (i.e. plain webapp)\n * When integrated into an application frame (e.g Theia/VS Code) this module is typically omitted and/or replaced\n * with an application native module.\n */\nexport const standaloneMarkerNavigatorModule = new FeatureModule(\n    bind => {\n        bindAsService(bind, TYPES.IContextMenuProvider, MarkerNavigatorContextMenuItemProvider);\n        bindAsService(bind, TYPES.KeyListener, MarkerNavigatorKeyListener);\n    },\n    { requires: markerNavigatorModule }\n);\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Action, hasStringProp } from '@eclipse-glsp/sprotty';\n\nexport interface FocusDomAction extends Action {\n    kind: typeof FocusDomAction.KIND;\n    id: string;\n}\n\nexport namespace FocusDomAction {\n    export const KIND = 'focusDomAction';\n\n    export function is(object: any): object is FocusDomAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'id');\n    }\n\n    export function create(id: string): FocusDomAction {\n        return { kind: KIND, id };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Action, IActionHandler, TYPES, ViewerOptions } from '@eclipse-glsp/sprotty';\nimport { inject, injectable } from 'inversify';\nimport { FocusTracker } from '../../base/focus/focus-tracker';\nimport { IDiagramStartup } from '../../base/model/diagram-loader';\nimport { EnableDefaultToolsAction } from '../../base/tool-manager/tool';\nimport { FocusDomAction } from '../accessibility/actions';\n\n/**\n * Focuses the graph on different actions.\n */\n@injectable()\nexport class RestoreViewportHandler implements IActionHandler, IDiagramStartup {\n    protected readonly graphSelector = '[data-svg-metadata-type=\"graph\"]';\n\n    @inject(TYPES.ViewerOptions)\n    protected options: ViewerOptions;\n\n    @inject(FocusTracker)\n    protected focusTracker: FocusTracker;\n\n    handle(action: Action): void | Action {\n        if (EnableDefaultToolsAction.is(action) || (FocusDomAction.is(action) && action.id === 'graph')) {\n            this.focusGraph();\n        }\n    }\n\n    async postRequestModel(): Promise<void> {\n        await this.waitForElement(this.graphSelector);\n        this.focusGraph();\n    }\n\n    protected focusGraph(): void {\n        if (this.focusTracker.hasFocus) {\n            const container = this.focusTracker.diagramElement?.querySelector<HTMLElement>(this.graphSelector);\n            container?.focus();\n        }\n    }\n\n    // https://stackoverflow.com/questions/5525071/how-to-wait-until-an-element-exists\n    protected waitForElement(selector: string): Promise<Element | null> {\n        return new Promise(resolve => {\n            if (document.querySelector(selector)) {\n                return resolve(document.querySelector(selector));\n            }\n\n            const observer = new MutationObserver(mutations => {\n                if (document.querySelector(selector)) {\n                    observer.disconnect();\n                    resolve(document.querySelector(selector));\n                }\n            });\n\n            observer.observe(document.body, {\n                childList: true,\n                subtree: true\n            });\n        });\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    bindAsService,\n    CenterCommand,\n    CenterKeyboardListener,\n    configureActionHandler,\n    configureCommand,\n    FeatureModule,\n    FitToScreenCommand,\n    GetViewportCommand,\n    SetViewportCommand,\n    TYPES,\n    ZoomMouseListener\n} from '@eclipse-glsp/sprotty';\nimport { EnableDefaultToolsAction, EnableToolsAction } from '../../base/tool-manager/tool';\nimport { GLSPScrollMouseListener } from './glsp-scroll-mouse-listener';\nimport { RestoreViewportHandler } from './viewport-handler';\nimport { RepositionCommand } from './reposition';\nimport { FocusDomAction } from '../accessibility/actions';\n\nexport const viewportModule = new FeatureModule((bind, _unbind, isBound) => {\n    const context = { bind, isBound };\n    configureCommand(context, CenterCommand);\n    configureCommand(context, FitToScreenCommand);\n    configureCommand(context, GetViewportCommand);\n    configureCommand(context, SetViewportCommand);\n    configureCommand(context, RepositionCommand);\n\n    bindAsService(context, TYPES.MouseListener, ZoomMouseListener);\n    bindAsService(context, TYPES.MouseListener, GLSPScrollMouseListener);\n\n    configureActionHandler(context, EnableToolsAction.KIND, GLSPScrollMouseListener);\n    configureActionHandler(context, EnableDefaultToolsAction.KIND, GLSPScrollMouseListener);\n\n    bindAsService(context, TYPES.IDiagramStartup, RestoreViewportHandler);\n    configureActionHandler(context, EnableDefaultToolsAction.KIND, RestoreViewportHandler);\n    configureActionHandler(context, FocusDomAction.KIND, RestoreViewportHandler);\n});\n\n/**\n * Feature module that is intended for the standalone deployment of GLSP (i.e. plain webapp)\n * When integrated into an application frame (e.g Theia/VS Code) this module is typically omitted and/or replaced\n * with an application native module.\n */\nexport const standaloneViewportModule = new FeatureModule(\n    (bind, _unbind, isBound) => {\n        const context = { bind, isBound };\n        bindAsService(context, TYPES.KeyListener, CenterKeyboardListener);\n    },\n    { requires: viewportModule }\n);\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { Container } from 'inversify';\nimport {\n    BindingContext,\n    ContainerConfiguration,\n    FeatureModule,\n    TYPES,\n    ViewerOptions,\n    buttonModule,\n    configureViewerOptions,\n    edgeIntersectionModule,\n    edgeLayoutModule,\n    expandModule,\n    fadeModule,\n    labelEditUiModule,\n    modelSourceModule,\n    resolveContainerConfiguration,\n    zorderModule\n} from '@eclipse-glsp/sprotty';\nimport { defaultModule } from './base/default.module';\nimport { IDiagramOptions } from './base/model/diagram-loader';\nimport { boundsModule } from './features/bounds/bounds-module';\nimport { commandPaletteModule } from './features/command-palette/command-palette-module';\nimport { contextMenuModule } from './features/context-menu/context-menu-module';\nimport { copyPasteModule } from './features/copy-paste/copy-paste-modules';\nimport { decorationModule } from './features/decoration/decoration-module';\nimport { exportModule } from './features/export/export-modules';\nimport { typeHintsModule } from './features/hints/type-hints-module';\nimport { hoverModule } from './features/hover/hover-module';\nimport { labelEditModule } from './features/label-edit/label-edit-module';\nimport { layoutModule } from './features/layout/layout-module';\nimport { navigationModule } from './features/navigation/navigation-module';\nimport { routingModule } from './features/routing/routing-module';\nimport { selectModule } from './features/select/select-module';\nimport { sourceModelWatcherModule } from './features/source-model-watcher/source-model-wacher-module';\nimport { statusModule } from './features/status/status-module';\nimport { svgMetadataModule } from './features/svg-metadata/svg-metadata-module';\nimport { toolPaletteModule } from './features/tool-palette/tool-palette-module';\nimport { changeBoundsToolModule } from './features/tools/change-bounds/change-boounds-tool-module';\nimport { deletionToolModule } from './features/tools/deletion/deletion-tool-module';\nimport { edgeCreationToolModule } from './features/tools/edge-creation/edege-creation-module';\nimport { edgeEditToolModule } from './features/tools/edge-edit/edge-edit-module';\nimport { marqueeSelectionToolModule } from './features/tools/marquee-selection/marquee-selection-module';\nimport { nodeCreationToolModule } from './features/tools/node-creation/node-creation-module';\nimport { toolFocusLossModule } from './features/tools/tool-focus-loss-module';\nimport { markerNavigatorModule, validationModule } from './features/validation/validation-modules';\nimport { viewportModule } from './features/viewport/viewport-modules';\n\nexport const DEFAULT_MODULES = [\n    defaultModule,\n    buttonModule,\n    edgeIntersectionModule,\n    edgeLayoutModule,\n    expandModule,\n    exportModule,\n    fadeModule,\n    boundsModule,\n    commandPaletteModule,\n    contextMenuModule,\n    decorationModule,\n    labelEditModule,\n    hoverModule,\n    selectModule,\n    copyPasteModule,\n    viewportModule,\n    labelEditUiModule,\n    layoutModule,\n    markerNavigatorModule,\n    typeHintsModule,\n    modelSourceModule,\n    sourceModelWatcherModule,\n    navigationModule,\n    routingModule,\n    toolPaletteModule,\n    edgeCreationToolModule,\n    edgeEditToolModule,\n    deletionToolModule,\n    nodeCreationToolModule,\n    changeBoundsToolModule,\n    marqueeSelectionToolModule,\n    toolFocusLossModule,\n    validationModule,\n    zorderModule,\n    svgMetadataModule,\n    statusModule\n] as const;\n\n/**\n * Wraps the {@link configureDiagramOptions} utility function in a module. Adopters can either include this\n * module into the container {@link ModuleConfiguration} or configure the container after its creation\n * (e.g. using the {@link configureDiagramOptions} utility function).\n * @param options The diagram instance specific configuration options\n * @returns The corresponding {@link FeatureModule}\n */\nexport function createDiagramOptionsModule(options: IDiagramOptions): FeatureModule {\n    return new FeatureModule((bind, unbind, isBound, rebind) => configureDiagramOptions({ bind, unbind, isBound, rebind }, options));\n}\n\n/**\n * Utility function to bind the diagram instance specific configuration options.\n * In addition to binding the {@link IDiagramOptions} this function also overrides the\n * {@link ViewerOptions} to match the given client id.\n * @param context The binding context\n * @param options The {@link IDiagramOptions} that should be bound\n */\nexport function configureDiagramOptions(context: BindingContext, options: IDiagramOptions): void {\n    const viewerOptions: Partial<ViewerOptions> = {\n        baseDiv: options.clientId,\n        hiddenDiv: options.clientId + '_hidden'\n    };\n    configureViewerOptions(context, viewerOptions);\n\n    context.bind(TYPES.IDiagramOptions).toConstantValue(options);\n}\n\n/**\n *  Initializes a GLSP Diagram container with the GLSP default modules and the specified custom `modules`.\n *  Additional modules can be passed as direct arguments or as part of a {@link ModuleConfiguration}.\n *  ```typescript\n *  const container= createDiagramContainer(myModule1, myModule2)\n *  // or\n *  const container= createDiagramContainer({ add: [myModule1, myModule2]})\n *  ```\n *  Default modules can be excluded using {@link ModuleConfiguration}s.\n *  This means, you can still customize the default modules in two ways.\n *\n * First, you can exclude default modules and add a module with your custom code.\n *\n * ```typescript\n * const container = createDiagramContainer({ add:myModelSourceWatcherModule, remove: modelSourceWatcherModule} );\n * ```\n *\n * Second, you can unbind or rebind implementations that are originally bound in one of the default modules.\n *\n * ```typescript\n * rebind(NavigationTargetResolver).to(MyNavigationTargetResolver);\n * ```\n * @param container The container that should be initialized\n * @param containerConfigurations\n *          Custom modules to be loaded in addition to the default modules and/or default modules that should be excluded.\n * @throws An error if the first module to load is not the `defaultModule` (or an equivalent custom replacement module)\n * @returns The initialized container.\n */\nexport function initializeDiagramContainer(container: Container, ...containerConfigurations: ContainerConfiguration): Container {\n    const modules = resolveContainerConfiguration(...DEFAULT_MODULES, ...containerConfigurations);\n    // The `defaultModule` (or a custom replacement module with the same `featureId`) should be the first module that is\n    // loaded into the container\n    const firstModule = modules[0];\n    if (!firstModule || !(firstModule instanceof FeatureModule && firstModule.featureId === defaultModule.featureId)) {\n        throw new Error(\n            'Invalid module configuration. The first module to load should be the `defaultModule` (or an equivalent replacement module)'\n        );\n    }\n    container.load(...modules);\n    return container;\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { FeatureModule, TYPES, bindAsService } from '@eclipse-glsp/sprotty';\nimport { SaveModelKeyboardListener } from './save-keylistener';\n\n/**\n * Feature module that is intended for the standalone deployment of GLSP (i.e. plain webapp)\n * When integrated into an application frame (e.g Theia/VS Code) this module is typically omitted and/or replaced\n * with an application native module.\n */\nexport const saveModule = new FeatureModule(bind => {\n    bindAsService(bind, TYPES.KeyListener, SaveModelKeyboardListener);\n});\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from 'inversify';\nimport { bindAsService, TYPES } from '@eclipse-glsp/sprotty';\nimport { GLSPUndoRedoKeyListener } from './undo-redo-key-listener';\n\n/**\n * Feature module that is intended for the standalone deployment of GLSP (i.e. plain webapp)\n * When integrated into an application frame (e.g Theia/VS Code) this module is typically omitted and/or replaced\n * with an application native module.\n */\nexport const undoRedoModule = new ContainerModule((bind, unbind, isBound, rebind) => {\n    bindAsService(bind, TYPES.KeyListener, GLSPUndoRedoKeyListener);\n});\n", "/********************************************************************************\n * Copyright (c) 2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport {\n    Action,\n    EndProgressAction,\n    FeatureModule,\n    GModelElement,\n    IActionHandler,\n    ICommand,\n    ILogger,\n    KeyListener,\n    LayoutOperation,\n    MessageAction,\n    ModuleConfiguration,\n    StartProgressAction,\n    TYPES,\n    UpdateProgressAction,\n    bindAsService,\n    configureActionHandler,\n    matchesKeystroke\n} from '@eclipse-glsp/sprotty';\nimport { inject, injectable } from 'inversify';\nimport { standaloneCopyPasteModule } from './features/copy-paste/copy-paste-modules';\nimport { standaloneExportModule } from './features/export/export-modules';\nimport { saveModule } from './features/save/save-module';\nimport { standaloneSelectModule } from './features/select/select-module';\nimport { undoRedoModule } from './features/undo-redo/undo-redo-module';\nimport { standaloneMarkerNavigatorModule } from './features/validation/validation-modules';\nimport { standaloneViewportModule } from './features/viewport/viewport-modules';\n\nexport const standaloneDefaultModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    bind(FallbackActionHandler).toSelf().inSingletonScope();\n    configureActionHandler(context, MessageAction.KIND, FallbackActionHandler);\n    configureActionHandler(context, StartProgressAction.KIND, FallbackActionHandler);\n    configureActionHandler(context, UpdateProgressAction.KIND, FallbackActionHandler);\n    configureActionHandler(context, EndProgressAction.KIND, FallbackActionHandler);\n    bindAsService(context, TYPES.KeyListener, LayoutKeyListener);\n});\n\n/**\n * A fallback action handler for actions sent by features that are currently not supported by\n * default in the standalone context. Unhandled actions will be simply forwarded to the {@link ILogger}.\n */\n@injectable()\nexport class FallbackActionHandler implements IActionHandler {\n    @inject(TYPES.ILogger)\n    protected logger: ILogger;\n\n    handle(action: Action): void | Action | ICommand {\n        this.logger.log(this, 'Unhandled action received:', action);\n    }\n}\n\n@injectable()\nexport class LayoutKeyListener extends KeyListener {\n    override keyDown(_element: GModelElement, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'KeyL', 'ctrlCmd', 'shift')) {\n            return [LayoutOperation.create()];\n        }\n        return [];\n    }\n}\n\n/**\n * Configuration of all `standalone` modules.\n *\n * Standalone modules compose additional features/services that are intended for the standalone deployment of GLSP (i.e. plain webapp)\n * When integrated into an application frame (e.g Theia/VS Code) this module is typically omitted and/or replaced\n * with an application native module.\n *\n * Typically standalone modules built on top of (i.e require ) a default module and are therefore conditionally loaded if the\n * required default modules have been loaded beforehand.\n */\n\nexport const STANDALONE_MODULES = [\n    standaloneViewportModule,\n    standaloneCopyPasteModule,\n    standaloneMarkerNavigatorModule,\n    standaloneSelectModule,\n    standaloneExportModule,\n    standaloneDefaultModule,\n    saveModule,\n    undoRedoModule\n] as const;\n\nexport const STANDALONE_MODULE_CONFIG: ModuleConfiguration = {\n    add: [...STANDALONE_MODULES]\n};\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { GModelElement } from '@eclipse-glsp/sprotty';\nimport { hasArgs } from '../base/args-feature';\n\nexport namespace GArgument {\n    export function asNumber(argValue: string | number | boolean): number | undefined {\n        return typeof argValue === 'number' ? argValue : undefined;\n    }\n\n    export function asNumbers(argValues: (string | number | boolean)[]): (number | undefined)[] {\n        return argValues.map(asNumber);\n    }\n\n    export function asString(argValue: string | number | boolean): string | undefined {\n        return typeof argValue === 'string' ? argValue : undefined;\n    }\n\n    export function asStrings(argValues: (string | number | boolean)[]): (string | undefined)[] {\n        return argValues.map(asString);\n    }\n\n    export function asBoolean(argValue: string | number | boolean): boolean | undefined {\n        return typeof argValue === 'boolean' ? argValue : undefined;\n    }\n\n    export function asBooleans(argValues: (string | number | boolean)[]): (boolean | undefined)[] {\n        return argValues.map(asBoolean);\n    }\n\n    export function getArgument(element: GModelElement | undefined, key: string): string | number | boolean | undefined {\n        return hasArgs(element) ? element.args[key] : undefined;\n    }\n\n    export function getNumber(element: GModelElement | undefined, key: string): number | undefined {\n        return hasArgs(element) ? asNumber(element.args[key]) : undefined;\n    }\n\n    export function getString(element: GModelElement | undefined, key: string): string | undefined {\n        return hasArgs(element) ? asString(element.args[key]) : undefined;\n    }\n\n    export function getBoolean(element: GModelElement | undefined, key: string): boolean | undefined {\n        return hasArgs(element) ? asBoolean(element.args[key]) : undefined;\n    }\n\n    export function getArguments(element: GModelElement | undefined, ...keys: string[]): (number | boolean | string)[] | undefined {\n        if (!hasArgs(element)) {\n            return undefined;\n        }\n        const values = [];\n        for (const key of keys) {\n            const value = element.args[key];\n            if (value) {\n                values.push(value);\n            }\n        }\n        return values;\n    }\n\n    export function getNumbers(element: GModelElement | undefined, ...keys: string[]): (number | undefined)[] | undefined {\n        const values = getArguments(element, ...keys);\n        return values ? asNumbers(values) : undefined;\n    }\n\n    export function getStrings(element: GModelElement | undefined, ...keys: string[]): (string | undefined)[] | undefined {\n        const values = getArguments(element, ...keys);\n        return values ? asStrings(values) : undefined;\n    }\n\n    export function getBooleans(element: GModelElement | undefined, ...keys: string[]): (boolean | undefined)[] | undefined {\n        const values = getArguments(element, ...keys);\n        return values ? asBooleans(values) : undefined;\n    }\n\n    export function hasNValues<T>(values: (T | undefined)[], length: number): values is T[] {\n        return values.length === length && values.filter(e => e === undefined).length === 0;\n    }\n}\n\nexport namespace EdgePadding {\n    const KEY = 'edgePadding';\n\n    export function from(element: GModelElement | undefined): number | undefined {\n        return GArgument.getNumber(element, KEY);\n    }\n}\n\nexport class CornerRadius {\n    static NO_RADIUS = new CornerRadius(0);\n\n    static KEY_RADIUS_TOP_LEFT = 'radiusTopLeft';\n    static KEY_RADIUS_TOP_RIGHT = 'radiusTopRight';\n    static KEY_RADIUS_BOTTOM_RIGHT = 'radiusBottomRight';\n    static KEY_RADIUS_BOTTOM_LEFT = 'radiusBottomLeft';\n\n    constructor(\n        public readonly topLeft: number = 0,\n        public readonly topRight: number = topLeft,\n        public readonly bottomRight: number = topLeft,\n        public readonly bottomLeft: number = topRight\n    ) {}\n\n    static from(element: GModelElement | undefined): CornerRadius | undefined {\n        const radius = GArgument.getNumbers(\n            element,\n            this.KEY_RADIUS_TOP_LEFT,\n            this.KEY_RADIUS_TOP_RIGHT,\n            this.KEY_RADIUS_BOTTOM_RIGHT,\n            this.KEY_RADIUS_BOTTOM_LEFT\n        );\n        if (radius === undefined || radius[0] === undefined) {\n            return undefined;\n        }\n        return GArgument.hasNValues(radius, 4) ? new CornerRadius(radius[0], radius[1], radius[2], radius[3]) : new CornerRadius(radius[0]);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2020 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nexport function createElementFromHTML(html: string): HTMLElement | undefined {\n    const template = document.createElement('template');\n    html = html.trim(); // Never return a text node of whitespace as the result\n    template.innerHTML = html;\n    const node = template.content.firstChild;\n    if (node && node instanceof HTMLElement) {\n        return node as HTMLElement;\n    }\n    return undefined;\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Point, PolylineEdgeView, RenderingContext, svg } from '@eclipse-glsp/sprotty';\nimport { injectable } from 'inversify';\nimport { Classes, VNode } from 'snabbdom';\nimport { EdgePadding } from '../utils/argument-utils';\nimport { GEdge } from '../model';\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst JSX = { createElement: svg };\n\n@injectable()\nexport class GEdgeView extends PolylineEdgeView {\n    override render(edge: Readonly<GEdge>, context: RenderingContext): VNode {\n        const router = this.edgeRouterRegistry.get(edge.routerKind);\n        const route = router.route(edge);\n        if (route.length === 0) {\n            return this.renderDanglingEdge('Cannot compute route', edge, context);\n        }\n\n        return (\n            <g class-sprotty-edge={true} class-mouseover={edge.hoverFeedback} {...this.additionalClasses(edge, context)}>\n                {this.renderLine(edge, route, context)}\n                {this.renderAdditionals(edge, route, context)}\n                {context.renderChildren(edge, { route })}\n            </g>\n        );\n    }\n\n    protected additionalClasses(_edge: Readonly<GEdge>, _context: RenderingContext): Classes {\n        return {};\n    }\n\n    protected override renderLine(_edge: GEdge, segments: Point[], _context: RenderingContext): VNode {\n        return <path d={this.createPathForSegments(segments)} />;\n    }\n\n    protected override renderAdditionals(edge: GEdge, segments: Point[], _context: RenderingContext): VNode[] {\n        // for additional padding we draw another transparent path with larger stroke width\n        const edgePadding = EdgePadding.from(edge);\n        return edgePadding ? [this.renderMouseHandle(segments, edgePadding)] : [];\n    }\n\n    protected renderMouseHandle(segments: Point[], padding: number): VNode {\n        return (\n            <path\n                class-mouse-handle\n                d={this.createPathForSegments(segments)}\n                style-stroke-width={padding * 2}\n                style-stroke='transparent'\n                style-stroke-dasharray='none'\n                style-stroke-dashoffset='0'\n            />\n        );\n    }\n\n    protected createPathForSegments(segments: Point[]): string {\n        const firstPoint = segments[0];\n        let path = `M ${firstPoint.x},${firstPoint.y}`;\n        for (let i = 1; i < segments.length; i++) {\n            const p = segments[i];\n            path += ` L ${p.x},${p.y}`;\n        }\n        return path;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2020-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n/* eslint-disable max-len */\nimport { GIssueSeverity, IssueMarkerView, RenderingContext, setClass, svg } from '@eclipse-glsp/sprotty';\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { GIssueMarker } from '../features/validation/issue-marker';\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst JSX = { createElement: svg };\n\n@injectable()\nexport class GIssueMarkerView extends IssueMarkerView {\n    override render(marker: GIssueMarker, _context: RenderingContext): VNode {\n        const maxSeverity = super.getMaxSeverity(marker);\n        const group = (\n            <g class-sprotty-issue={true}>\n                <g>\n                    {this.getGlspIssueMarkerBackground(maxSeverity)}\n                    <path d={this.getGlspIssueMarkerPath(maxSeverity)} />\n                </g>\n            </g>\n        );\n        setClass(group, 'sprotty-' + maxSeverity, true);\n        return group;\n    }\n\n    protected getGlspIssueMarkerBackground(severity: GIssueSeverity): VNode {\n        switch (severity) {\n            case 'warning':\n                return <polygon class-sprotty-issue-background={true} points='8 2, 15.9 14.9, 0.2 14.9' />;\n            case 'error':\n            case 'info':\n                return <circle class-sprotty-issue-background={true} r={this.radius} cx={this.radius} cy={this.radius} />;\n        }\n    }\n\n    protected get radius(): number {\n        return 8; // var(--theia-icon-size)=16px => 16/2=8\n    }\n\n    protected getGlspIssueMarkerPath(severity: GIssueSeverity): string {\n        switch (severity) {\n            // paths used here are svg versions of codicons, resized to var(--theia-icon-size) 16px\n            case 'error': // 'codicon-error'\n                return 'm 8.8527788,0.00699568 c 1.8523692,0.115773 3.5889642,1.04195762 4.8624692,2.31546152 1.505048,1.620823 2.31546,3.5889653 2.31546,5.9044268 0,1.852369 -0.694637,3.588965 -1.852367,5.094015 -1.157733,1.389277 -2.778554,2.431235 -4.6309235,2.778554 C 7.6950478,16.446772 5.8426784,16.215226 4.2218552,15.289042 2.6010319,14.362857 1.3275281,12.97358 0.63288942,11.236984 -0.06174907,9.5003878 -0.17752216,7.5322456 0.4013433,5.7956494 0.98020876,3.9432802 2.0221665,2.4382302 3.6429898,1.3962725 5.14804,0.35431486 7.0004094,-0.10877742 8.8527788,0.00699568 Z M 9.4316445,14.941722 c 1.5050505,-0.347319 2.8943275,-1.15773 3.9362845,-2.431234 0.926185,-1.273504 1.50505,-2.778554 1.389277,-4.3993771 0,-1.8523692 -0.69464,-3.7047384 -1.968142,-4.9782422 C 11.631331,1.9751379 10.242054,1.2804995 8.6212324,1.1647264 7.1161824,1.0489533 5.4953592,1.3962725 4.2218552,2.3224572 2.9483511,3.2486418 2.0221665,4.5221456 1.5590742,6.1429686 c -0.4630923,1.50505 -0.4630923,3.1258731 0.2315462,4.6309234 0.6946384,1.50505 1.7365963,2.66278 3.1258734,3.473192 1.3892769,0.810411 3.0101002,1.041958 4.5151507,0.694638 z M 8.042367,7.5322456 10.82092,4.6379187 11.631331,5.4483302 8.8527788,8.3426571 11.631331,11.236984 10.82092,12.047395 8.042367,9.1530686 5.2638128,12.047395 4.4534013,11.236984 7.2319555,8.3426571 4.4534013,5.4483302 5.2638128,4.6379187 Z';\n            case 'warning': // 'codicon-warning'\n                return 'M 7.5587159,0.61312771 H 8.565869 L 16.050847,14.644601 15.54727,15.491525 H 0.55442396 L 0.05084746,14.644601 Z M 8.0622924,2.0780776 1.5157974,14.347033 H 14.585897 Z M 8.7776,13.202541 V 12.058049 H 7.3469848 v 1.144492 z M 7.3469848,10.913557 V 6.3355883 H 8.7776 v 4.5779687 z';\n            case 'info': // 'codicon-info'\n                return 'M 8.7624795,0.01729008 A 7.8878137,7.8878137 0 0 1 13.625085,2.3592747 8.1894066,8.1894066 0 0 1 14.158672,13.251418 7.9458123,7.9458123 0 0 1 4.2061071,15.26977 8.1198082,8.1198082 0 0 1 0.58699265,11.209866 8.259005,8.259005 0 0 1 0.32019895,5.7463948 8.1198082,8.1198082 0 0 1 3.533323,1.3500986 7.8878137,7.8878137 0 0 1 8.7624795,0.01729008 Z M 9.3099868,14.921778 A 6.8322386,6.8322386 0 0 0 13.265493,12.520635 7.0410337,7.0410337 0 0 0 12.801504,3.1712556 6.7510406,6.7510406 0 0 0 4.1829077,2.3128758 7.029434,7.029434 0 0 0 4.762894,14.248994 6.7394408,6.7394408 0 0 0 9.3099868,14.921778 Z M 7.3786322,5.7811939 H 8.8285979 V 4.6212213 H 7.3786322 Z M 8.8285979,6.9411665 V 11.581057 H 7.3786322 V 6.9411665 Z';\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Dimension, Hoverable, Selectable, GShapeElement } from '@eclipse-glsp/sprotty';\nimport { CornerRadius } from '../utils/argument-utils';\n\nexport interface RoundedCorner {\n    radiusX: number;\n    radiusY: number;\n}\n\nexport class RoundedCornerWrapper {\n    protected _topLeftCorner: RoundedCorner;\n    protected _topRightCorner: RoundedCorner;\n    protected _bottomRightCorner: RoundedCorner;\n    protected _bottomLeftCorner: RoundedCorner;\n\n    constructor(public readonly element: GShapeElement & Hoverable & Selectable, public readonly cornerRadius: CornerRadius) {}\n\n    get size(): Dimension {\n        return this.element.size;\n    }\n\n    get topLeftCorner(): RoundedCorner {\n        if (!this._topLeftCorner) {\n            this._topLeftCorner = {\n                radiusX: scaledRadius(this.cornerRadius.topLeft, this.element.size.width / 2),\n                radiusY: scaledRadius(this.cornerRadius.topLeft, this.element.size.height / 2)\n            };\n        }\n        return this._topLeftCorner;\n    }\n\n    get topRightCorner(): RoundedCorner {\n        if (!this._topRightCorner) {\n            this._topRightCorner = {\n                radiusX: scaledRadius(this.cornerRadius.topRight, this.element.size.width / 2),\n                radiusY: scaledRadius(this.cornerRadius.topRight, this.element.size.height / 2)\n            };\n        }\n        return this._topRightCorner;\n    }\n\n    get bottomRightCorner(): RoundedCorner {\n        if (!this._bottomRightCorner) {\n            this._bottomRightCorner = {\n                radiusX: scaledRadius(this.cornerRadius.bottomRight, this.element.size.width / 2),\n                radiusY: scaledRadius(this.cornerRadius.bottomRight, this.element.size.height / 2)\n            };\n        }\n        return this._bottomRightCorner;\n    }\n\n    get bottomLeftCorner(): RoundedCorner {\n        if (!this._bottomLeftCorner) {\n            this._bottomLeftCorner = {\n                radiusX: scaledRadius(this.cornerRadius.bottomLeft, this.element.size.width / 2),\n                radiusY: scaledRadius(this.cornerRadius.bottomLeft, this.element.size.height / 2)\n            };\n        }\n        return this._bottomLeftCorner;\n    }\n}\n\n/*\n * Scales the radius if necessary. (Percentile down scaling if the radius is bigger then the maximal allowed length)\n */\nexport function scaledRadius(radius: number, maximalLength: number): number {\n    if (radius <= maximalLength) {\n        return radius;\n    } else {\n        return radius * (maximalLength / radius);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { Classes, VNode } from 'snabbdom';\nimport { Hoverable, RectangularNodeView, RenderingContext, GNode, GPort, GShapeElement, Selectable, svg } from '@eclipse-glsp/sprotty';\nimport { CornerRadius } from '../utils/argument-utils';\nimport { RoundedCornerWrapper } from './rounded-corner';\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst JSX = { createElement: svg };\n\n@injectable()\nexport class RoundedCornerNodeView extends RectangularNodeView {\n    override render(node: Readonly<GNode & Hoverable & Selectable>, context: RenderingContext): VNode | undefined {\n        const cornerRadius = CornerRadius.from(node);\n        if (!cornerRadius) {\n            return this.renderWithoutRadius(node, context);\n        }\n\n        const wrapper = new RoundedCornerWrapper(node, cornerRadius);\n        return (\n            <g class-node={true}>\n                <defs>\n                    <clipPath id={toClipPathId(node)}>\n                        <path d={this.renderPath(wrapper, context, this.getClipPathInsets() || 0)}></path>\n                    </clipPath>\n                </defs>\n                {this.renderPathNode(wrapper, context)}\n                {context.renderChildren(node)}\n            </g>\n        );\n    }\n\n    protected renderWithoutRadius(node: Readonly<GShapeElement & Hoverable & Selectable>, context: RenderingContext): VNode | undefined {\n        return super.render(node, context);\n    }\n\n    protected getClipPathInsets(): number | undefined {\n        return 2;\n    }\n\n    protected renderPathNode(wrapper: Readonly<RoundedCornerWrapper>, context: RenderingContext): VNode {\n        return (\n            <path\n                d={this.renderPath(wrapper, context, 0)}\n                class-sprotty-node={wrapper.element instanceof GNode}\n                class-sprotty-port={wrapper.element instanceof GPort}\n                class-mouseover={wrapper.element.hoverFeedback}\n                class-selected={wrapper.element.selected}\n                {...this.additionalClasses(wrapper.element, context)}\n            />\n        );\n    }\n\n    protected additionalClasses(_node: Readonly<GShapeElement & Hoverable & Selectable>, _context: RenderingContext): Classes {\n        return {};\n    }\n\n    protected renderPath(wrapper: Readonly<RoundedCornerWrapper>, _context: RenderingContext, inset: number): string {\n        // Calculate length of straight line segments\n        const topLineLength = Math.max(0, wrapper.size.width - wrapper.cornerRadius.topLeft - wrapper.cornerRadius.topRight);\n        const rightLineLength = Math.max(0, wrapper.size.height - wrapper.cornerRadius.topRight - wrapper.cornerRadius.bottomRight);\n        const bottomLineLength = Math.max(0, wrapper.size.width - wrapper.cornerRadius.bottomLeft - wrapper.cornerRadius.bottomRight);\n\n        const path =\n            `M${0 + inset},${0 + wrapper.topLeftCorner.radiusY}` +\n            `q${0},${-(wrapper.topLeftCorner.radiusY - inset)} ${wrapper.topLeftCorner.radiusX - inset},${-(\n                wrapper.topLeftCorner.radiusY - inset\n            )}` +\n            `h${topLineLength}` +\n            `q${wrapper.topRightCorner.radiusX - inset},0 ${wrapper.topRightCorner.radiusX - inset},${\n                wrapper.topRightCorner.radiusY - inset\n            }` +\n            `v${rightLineLength}` +\n            `q0,${wrapper.bottomRightCorner.radiusY - inset} ${-(wrapper.bottomRightCorner.radiusX - inset)},${\n                wrapper.bottomRightCorner.radiusY - inset\n            }` +\n            `h${-bottomLineLength}` +\n            `q${-(wrapper.bottomLeftCorner.radiusX - inset)},0 ${-(wrapper.bottomLeftCorner.radiusX - inset)},${-(\n                wrapper.bottomLeftCorner.radiusY - inset\n            )}` +\n            'z ';\n        return path;\n    }\n}\n\nexport function toClipPathId(node: Readonly<GShapeElement & Hoverable & Selectable>): string {\n    return `${node.id}_clip_path`;\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    BindingContext,\n    CircularNode,\n    CircularNodeView,\n    DefaultTypes,\n    DiamondNode,\n    DiamondNodeView,\n    ExpandButtonView,\n    FeatureModule,\n    ForeignObjectView,\n    GButton,\n    GCompartment,\n    GCompartmentView,\n    GForeignObjectElement,\n    GGraphView,\n    GHtmlRoot,\n    GLabel,\n    GNode,\n    GPort,\n    GPreRenderedElement,\n    GRoutingHandle,\n    GRoutingHandleView,\n    GShapedPreRenderedElement,\n    GViewportRootElement,\n    HtmlRootView,\n    PreRenderedView,\n    RectangularNode,\n    RectangularNodeView,\n    GLabelView,\n    SvgViewportView,\n    configureModelElement,\n    moveFeature,\n    selectFeature\n} from '@eclipse-glsp/sprotty';\nimport { GIssueMarker } from '../features/validation/issue-marker';\nimport { GEdgeView } from './gedge-view';\nimport { GIssueMarkerView } from './issue-marker-view';\nimport { RoundedCornerNodeView } from './rounded-corner-view';\nimport { GEdge, GGraph } from '../model';\n\nexport const baseViewModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureDefaultModelElements(context);\n});\n\nexport function configureDefaultModelElements(context: Pick<BindingContext, 'bind' | 'isBound'>): void {\n    // HTML elements\n    configureModelElement(context, DefaultTypes.HTML, GHtmlRoot, HtmlRootView);\n\n    // generic elements\n    configureModelElement(context, DefaultTypes.FOREIGN_OBJECT, GForeignObjectElement, ForeignObjectView, {\n        disable: [selectFeature, moveFeature]\n    });\n    configureModelElement(context, DefaultTypes.PRE_RENDERED, GPreRenderedElement, PreRenderedView);\n    configureModelElement(context, DefaultTypes.SHAPE_PRE_RENDERED, GShapedPreRenderedElement, PreRenderedView);\n\n    // SVG elements\n    configureModelElement(context, DefaultTypes.SVG, GViewportRootElement, SvgViewportView);\n\n    // graph elements\n    configureModelElement(context, DefaultTypes.GRAPH, GGraph, GGraphView);\n    configureModelElement(context, DefaultTypes.NODE, GNode, RoundedCornerNodeView);\n    configureModelElement(context, DefaultTypes.COMPARTMENT, GCompartment, GCompartmentView);\n    configureModelElement(context, DefaultTypes.COMPARTMENT_HEADER, GCompartment, GCompartmentView);\n    configureModelElement(context, DefaultTypes.EDGE, GEdge, GEdgeView);\n    configureModelElement(context, DefaultTypes.PORT, GPort, RectangularNodeView);\n    configureModelElement(context, DefaultTypes.ROUTING_POINT, GRoutingHandle, GRoutingHandleView);\n    configureModelElement(context, DefaultTypes.VOLATILE_ROUTING_POINT, GRoutingHandle, GRoutingHandleView);\n    configureModelElement(context, DefaultTypes.LABEL, GLabel, GLabelView);\n\n    // UI elements\n    configureModelElement(context, DefaultTypes.BUTTON_EXPAND, GButton, ExpandButtonView);\n    configureModelElement(context, DefaultTypes.ISSUE_MARKER, GIssueMarker, GIssueMarkerView);\n\n    // shapes\n    configureModelElement(context, DefaultTypes.NODE_CIRCLE, CircularNode, CircularNodeView);\n    configureModelElement(context, DefaultTypes.NODE_DIAMOND, DiamondNode, DiamondNodeView);\n    configureModelElement(context, DefaultTypes.NODE_RECTANGLE, RectangularNode, RectangularNodeView);\n}\n", "/********************************************************************************\n * Copyright (c) 2021-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { GCompartment, RenderingContext, ShapeView, svg } from '@eclipse-glsp/sprotty';\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst JSX = { createElement: svg };\n\n@injectable()\nexport class StructureCompartmentView extends ShapeView {\n    render(model: Readonly<GCompartment>, context: RenderingContext): VNode | undefined {\n        if (!this.isVisible(model, context)) {\n            return undefined;\n        }\n\n        return (\n            <g>\n                <rect class-sprotty-comp={true} x='0' y='0' width={model.size.width} height={model.size.height}></rect>\n                {context.renderChildren(model)}\n            </g>\n        );\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2017-2023 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { VNode, VNodeStyle, h } from 'snabbdom';\nimport {\n    Bounds,\n    EdgeRouterRegistry,\n    GViewportRootElement,\n    IViewArgs,\n    ProjectedViewportView,\n    ProjectionParams,\n    RenderingContext,\n    ViewProjection,\n    html,\n    setAttr,\n    setClass\n} from '@eclipse-glsp/sprotty';\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst JSX = { createElement: html };\n\n/**\n * Special viewport root view that renders horizontal and vertical projection bars for quick navigation.\n */\n@injectable()\nexport class GLSPProjectionView extends ProjectedViewportView {\n    @inject(EdgeRouterRegistry) edgeRouterRegistry: EdgeRouterRegistry;\n\n    override render(model: Readonly<GViewportRootElement>, context: RenderingContext, args?: IViewArgs): VNode {\n        const svgElem = this.renderSvg(model, context, args);\n        if (svgElem.data) {\n            svgElem.data!.class = { 'sprotty-graph': true };\n        }\n        const rootNode: VNode = (\n            <div class-sprotty-graph={false} style={{ width: '100%', height: '100%' }}>\n                {svgElem}\n                {this.renderProjections(model, context, args)}\n            </div>\n        );\n        setAttr(rootNode, 'tabindex', 1);\n        setAttr(rootNode, 'aria-label', 'Diagram');\n\n        return rootNode;\n    }\n\n    protected override renderSvg(model: Readonly<GViewportRootElement>, context: RenderingContext, args?: IViewArgs): VNode {\n        const edgeRouting = this.edgeRouterRegistry.routeAllChildren(model);\n        const transform = `scale(${model.zoom}) translate(${-model.scroll.x},${-model.scroll.y})`;\n        const ns = 'http://www.w3.org/2000/svg';\n        const svg = h(\n            'svg',\n            { ns, style: { height: '100%' } },\n            h('g', { ns, attrs: { transform } }, context.renderChildren(model, { edgeRouting }))\n        );\n        return svg;\n    }\n\n    protected override renderProjectionBar(\n        projections: ViewProjection[],\n        model: Readonly<GViewportRootElement>,\n        modelBounds: Bounds,\n        orientation: 'horizontal' | 'vertical'\n    ): VNode {\n        const params: ProjectionParams = { modelBounds, orientation } as ProjectionParams;\n        // NOTE: Here we assume that the projection bars have the same size as the diagram canvas,\n        // i.e. they are drawn as overlay above the canvas.\n        params.factor =\n            orientation === 'horizontal' ? model.canvasBounds.width / modelBounds.width : model.canvasBounds.height / modelBounds.height;\n        params.zoomedFactor = params.factor / model.zoom;\n        return (\n            <div\n                class-sprotty-projection-bar={true}\n                class-horizontal={orientation === 'horizontal'}\n                class-vertical={orientation === 'vertical'}\n                class-bordered-projection-bar={true}\n            >\n                {this.renderViewport(model, params)}\n                {projections.map(p => this.renderProjection(p, model, params))}\n            </div>\n        );\n    }\n\n    protected override renderViewport(model: Readonly<GViewportRootElement>, params: ProjectionParams): VNode {\n        let canvasSize;\n        let viewportPos: number;\n        if (params.orientation === 'horizontal') {\n            canvasSize = model.canvasBounds.width;\n            viewportPos = (model.scroll.x - params.modelBounds.x) * params.factor;\n        } else {\n            canvasSize = model.canvasBounds.height;\n            viewportPos = (model.scroll.y - params.modelBounds.y) * params.factor;\n        }\n        let viewportSize = canvasSize * params.zoomedFactor;\n        if (viewportPos < 0) {\n            viewportSize += viewportPos;\n            viewportPos = 0;\n        } else if (viewportPos > canvasSize) {\n            viewportPos = canvasSize;\n        }\n        if (viewportSize < 0) {\n            viewportSize = 0;\n        } else if (viewportPos + viewportSize > canvasSize) {\n            viewportSize = canvasSize - viewportPos;\n        }\n        if (Math.abs(viewportSize - canvasSize) < 1) {\n            viewportSize = 0;\n        }\n        const style: VNodeStyle =\n            params.orientation === 'horizontal'\n                ? {\n                      left: `${viewportPos}px`,\n                      width: `${viewportSize}px`,\n                      border: 'none'\n                  }\n                : {\n                      top: `${viewportPos}px`,\n                      height: `${viewportSize}px`,\n                      border: 'none'\n                  };\n        return <div class-sprotty-viewport={viewportSize !== 0} class-projection-scroll-bar={true} style={style} />;\n    }\n\n    protected override renderProjection(\n        projection: ViewProjection,\n        model: Readonly<GViewportRootElement>,\n        params: ProjectionParams\n    ): VNode {\n        let canvasSize;\n        let projPos;\n        let projSize: number;\n        if (params.orientation === 'horizontal') {\n            canvasSize = model.canvasBounds.width;\n            projPos = (projection.projectedBounds.x - params.modelBounds.x) * params.factor;\n            projSize = projection.projectedBounds.width * params.factor;\n        } else {\n            canvasSize = model.canvasBounds.height;\n            projPos = (projection.projectedBounds.y - params.modelBounds.y) * params.factor;\n            projSize = projection.projectedBounds.height * params.factor;\n        }\n        if (projPos < 0) {\n            projSize += projPos;\n            projPos = 0;\n        } else if (projPos > canvasSize) {\n            projPos = canvasSize;\n        }\n        if (projSize < 0) {\n            projSize = 0;\n        } else if (projPos + projSize > canvasSize) {\n            projSize = canvasSize - projPos;\n        }\n        const style: VNodeStyle =\n            params.orientation === 'horizontal'\n                ? {\n                      left: `${projPos}px`,\n                      width: `${projSize}px`,\n                      height: '60%'\n                  }\n                : {\n                      top: `${projPos}px`,\n                      height: `${projSize}px`,\n                      width: '60%'\n                  };\n        const result = (\n            <div\n                id={`${params.orientation}-projection:${projection.elementId}`}\n                class-sprotty-projection={true}\n                class-glsp-projection={true}\n                style={style}\n            />\n        );\n        projection.cssClasses.forEach(cl => setClass(result, cl, true));\n        return result;\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nexport * from './base-view-module';\nexport * from './compartments';\nexport * from './gedge-view';\nexport * from './glsp-projection-view';\nexport * from './issue-marker-view';\nexport * from './rounded-corner';\nexport * from './rounded-corner-view';\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from 'inversify';\nimport { bindAsService, BindingContext, configureActionHandler, TYPES } from '@eclipse-glsp/sprotty';\nimport '../../../../css/key-shortcut.css';\nimport { KeyShortcutUIExtension, SetAccessibleKeyShortcutAction } from './accessible-key-shortcut';\nimport { AccessibleKeyShortcutTool } from './accessible-key-shortcut-tool';\n\n/**\n * Handles actions for displaying help/information about keyboard shortcuts.\n */\nexport const glspShortcutHelpModule = new ContainerModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureShortcutHelpTool(context);\n});\n\nexport function configureShortcutHelpTool(context: BindingContext): void {\n    bindAsService(context, TYPES.IDefaultTool, AccessibleKeyShortcutTool);\n    bindAsService(context, TYPES.IUIExtension, KeyShortcutUIExtension);\n    configureActionHandler(context, SetAccessibleKeyShortcutAction.KIND, KeyShortcutUIExtension);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { BindingContext, FeatureModule, configureActionHandler } from '@eclipse-glsp/sprotty';\nimport { MoveElementAction, MoveElementHandler, MoveViewportAction, MoveViewportHandler } from './move-handler';\nimport { ZoomElementAction, ZoomElementHandler, ZoomViewportAction, ZoomViewportHandler } from './zoom-handler';\n\n/**\n * Handles move and zoom actions.\n */\nexport const moveZoomModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureMoveZoom(context);\n});\n\nexport function configureMoveZoom(context: BindingContext): void {\n    context.bind(MoveViewportHandler).toSelf().inSingletonScope();\n    context.bind(MoveElementHandler).toSelf().inSingletonScope();\n\n    context.bind(ZoomViewportHandler).toSelf().inSingletonScope();\n    context.bind(ZoomElementHandler).toSelf().inSingletonScope();\n\n    configureActionHandler(context, MoveViewportAction.KIND, MoveViewportHandler);\n    configureActionHandler(context, MoveElementAction.KIND, MoveElementHandler);\n\n    configureActionHandler(context, ZoomViewportAction.KIND, ZoomViewportHandler);\n    configureActionHandler(context, ZoomElementAction.KIND, ZoomElementHandler);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { BindingContext, FeatureModule, TYPES, bindAsService, configureActionHandler } from '@eclipse-glsp/sprotty';\nimport { ResizeElementAction, ResizeElementHandler } from './resize-key-handler';\nimport { ResizeKeyTool } from './resize-key-tool';\n\n/**\n * Handles resize actions.\n */\nexport const resizeKeyModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureResizeTools(context);\n});\n\nexport function configureResizeTools(context: BindingContext): void {\n    context.bind(ResizeElementHandler).toSelf().inSingletonScope();\n\n    configureActionHandler(context, ResizeElementAction.KIND, ResizeElementHandler);\n    bindAsService(context, TYPES.IDefaultTool, ResizeKeyTool);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { bindAsService, BindingContext, FeatureModule, TYPES } from '@eclipse-glsp/sprotty';\nimport { SearchAutocompletePalette } from './search-palette';\nimport { SearchAutocompletePaletteTool } from './search-tool';\n\nexport const searchPaletteModule = new FeatureModule((bind, _unbind, isBound, rebind) => {\n    const context = { bind, isBound, rebind };\n    configureSearchPaletteModule(context);\n});\n\nexport function configureSearchPaletteModule(context: Pick<BindingContext, 'bind'>): void {\n    bindAsService(context, TYPES.IUIExtension, SearchAutocompletePalette);\n    bindAsService(context, TYPES.IDefaultTool, SearchAutocompletePaletteTool);\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { bindAsService, BindingContext, configureActionHandler, FeatureModule, TYPES } from '@eclipse-glsp/sprotty';\nimport { DeselectKeyTool } from './deselect-key-tool';\nimport { MovementKeyTool } from './movement-key-tool';\nimport { ZoomKeyTool } from './zoom-key-tool';\nimport { KeyboardGridCellSelectedAction, KeyboardGridKeyboardEventAction } from '../keyboard-grid/action';\n\nexport const viewKeyToolsModule = new FeatureModule((bind, _unbind, isBound, rebind) => {\n    const context = { bind, isBound, rebind };\n    configureViewKeyTools(context);\n});\n\nexport function configureViewKeyTools(context: Pick<BindingContext, 'bind' | 'isBound'>): void {\n    bindAsService(context, TYPES.IDefaultTool, MovementKeyTool);\n    bindAsService(context, TYPES.IDefaultTool, ZoomKeyTool);\n    configureActionHandler(context, KeyboardGridCellSelectedAction.KIND, ZoomKeyTool);\n    configureActionHandler(context, KeyboardGridKeyboardEventAction.KIND, ZoomKeyTool);\n    bindAsService(context, TYPES.IDefaultTool, DeselectKeyTool);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport namespace KeyboardGridMetadata {\n    export const ID = 'keyboard-grid';\n    export const TAB_INDEX = 15;\n}\n\nexport namespace KeyboardNodeGridMetadata {\n    export const ID = 'keyboard-node-grid';\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Action, hasObjectProp, hasStringProp } from '@eclipse-glsp/sprotty';\n\nexport interface SetEdgeTargetSelectionAction extends Action {\n    kind: typeof SetEdgeTargetSelectionAction.KIND;\n    elementId: string;\n    context: string;\n}\n\nexport namespace SetEdgeTargetSelectionAction {\n    export const KIND = 'setEdgeTargetSelectionAction';\n\n    export function is(object: any): object is SetEdgeTargetSelectionAction {\n        return Action.hasKind(object, KIND) && hasStringProp(object, 'elementId') && hasObjectProp(object, 'context');\n    }\n\n    export function create(elementId: string, context: string): SetEdgeTargetSelectionAction {\n        return { kind: KIND, elementId, context };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport {\n    codiconCSSString,\n    isConnectable,\n    GModelElement,\n    GModelRoot,\n    LabeledAction,\n    name,\n    SetUIExtensionVisibilityAction,\n    IActionHandler,\n    Action,\n    CreateEdgeOperation,\n    TriggerEdgeCreationAction\n} from '@eclipse-glsp/sprotty';\nimport { EnableDefaultToolsAction } from '../../../base/tool-manager/tool';\nimport { toArray } from 'sprotty/lib/utils/iterable';\nimport { EdgeAutocompleteContext } from './edge-autocomplete-context';\nimport { SearchAutocompletePalette } from '../search/search-palette';\nimport { SetEdgeTargetSelectionAction } from './action';\nimport { CloseReason, toActionArray } from '../../../base/auto-complete/auto-complete-widget';\nimport { AutocompleteSuggestion, IAutocompleteSuggestionProvider } from '../../../base/auto-complete/autocomplete-suggestion-providers';\nimport { GEdge } from '../../../model';\n\nexport namespace EdgeAutocompletePaletteMetadata {\n    export const ID = 'edge-autocomplete-palette';\n}\n\n@injectable()\nexport class EdgeAutocompletePalette extends SearchAutocompletePalette implements IActionHandler {\n    protected context?: EdgeAutocompleteContext;\n\n    protected readonly targetSuggestionProvider = new PossibleEdgeTargetAutocompleteSuggestionProvider();\n\n    override id(): string {\n        return EdgeAutocompletePaletteMetadata.ID;\n    }\n\n    handle(action: Action): Action | void {\n        if (TriggerEdgeCreationAction.is(action)) {\n            this.context = {\n                trigger: action,\n                role: 'source'\n            };\n            this.targetSuggestionProvider.setContext(action, this.context);\n        }\n    }\n\n    protected override onBeforeShow(containerElement: HTMLElement, root: Readonly<GModelRoot>, ...contextElementIds: string[]): void {\n        super.onBeforeShow(containerElement, root, ...contextElementIds);\n\n        this.autocompleteWidget.inputField.placeholder = `Search for ${this.context?.role} elements`;\n    }\n\n    protected override getSuggestionProviders(root: Readonly<GModelRoot>, input: string): IAutocompleteSuggestionProvider[] {\n        return [this.targetSuggestionProvider];\n    }\n\n    protected reload(): void {\n        const context = this.context;\n        this.hide();\n        this.context = context;\n        this.actionDispatcher.dispatch(\n            SetUIExtensionVisibilityAction.create({\n                extensionId: EdgeAutocompletePaletteMetadata.ID,\n                visible: true\n            })\n        );\n    }\n\n    protected override executeSuggestion(input: LabeledAction | Action[] | Action): void {\n        const action = toActionArray(input)[0] as SetEdgeTargetSelectionAction;\n\n        if (this.context?.role === 'source') {\n            this.context.sourceId = action.elementId;\n            this.context.role = 'target';\n            this.reload();\n        } else if (this.context?.role === 'target') {\n            this.context.targetId = action.elementId;\n        }\n        if (this.context?.sourceId !== undefined && this.context?.targetId !== undefined) {\n            this.actionDispatcher.dispatchAll([\n                CreateEdgeOperation.create({\n                    elementTypeId: this.context.trigger.elementTypeId,\n                    sourceElementId: this.context.sourceId,\n                    targetElementId: this.context.targetId,\n                    args: this.context.trigger.args\n                }),\n                EnableDefaultToolsAction.create()\n            ]);\n            this.hide();\n        }\n    }\n\n    protected override autocompleteHide(reason: CloseReason): void {\n        if (reason !== 'submission') {\n            this.hide();\n        }\n    }\n}\n\n@injectable()\nexport class PossibleEdgeTargetAutocompleteSuggestionProvider implements IAutocompleteSuggestionProvider {\n    protected proxyEdge?: GEdge;\n    protected context?: EdgeAutocompleteContext;\n\n    setContext(triggerAction: TriggerEdgeCreationAction, edgeAutocompleteContext: EdgeAutocompleteContext): void {\n        this.proxyEdge = new GEdge();\n        this.proxyEdge.type = triggerAction.elementTypeId;\n        this.context = edgeAutocompleteContext;\n    }\n\n    isAllowedSource(element: GModelElement | undefined, role: 'source' | 'target'): boolean {\n        return element !== undefined && this.proxyEdge !== undefined && isConnectable(element) && element.canConnect(this.proxyEdge, role);\n    }\n\n    async retrieveSuggestions(root: Readonly<GModelRoot>, text: string): Promise<AutocompleteSuggestion[]> {\n        const context = this.context;\n        if (this.context === undefined) {\n            return [];\n        }\n\n        const nodes = toArray(root.index.all().filter(element => this.isAllowedSource(element, context!.role))) as GEdge[];\n        return nodes.map(node => ({\n            element: node,\n            action: {\n                label: `[${node.type}] ${name(node) ?? '<no-name>'}`,\n                actions: [SetEdgeTargetSelectionAction.create(node.id, context!.role)],\n                icon: codiconCSSString('arrow-both')\n            }\n        }));\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { injectable } from 'inversify';\nimport {\n    ICommand,\n    SetUIExtensionVisibilityAction,\n    Action,\n    PaletteItem,\n    RequestContextActions,\n    RequestMarkersAction,\n    SetContextActions,\n    TriggerNodeCreationAction\n} from '@eclipse-glsp/sprotty';\nimport { KeyCode, matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport { MouseDeleteTool } from '../../tools/deletion/delete-tool';\nimport { MarqueeMouseTool } from '../../tools/marquee-selection/marquee-mouse-tool';\nimport {\n    createIcon,\n    changeCodiconClass,\n    createToolGroup,\n    ToolPalette,\n    compare,\n    EnableToolPaletteAction\n} from '../../tool-palette/tool-palette';\nimport { KeyboardNodeGridMetadata } from '../keyboard-grid/constants';\nimport { FocusDomAction } from '../actions';\nimport { EdgeAutocompletePaletteMetadata } from '../edge-autocomplete/edge-autocomplete-palette';\nimport { EnableDefaultToolsAction, EnableToolsAction } from '../../../base/tool-manager/tool';\nimport { ShowToastMessageAction } from '../toast/toast-handler';\nimport { ElementNavigatorKeyListener } from '../element-navigation/diagram-navigation-tool';\nimport * as messages from '../toast/messages.json';\n\nconst SEARCH_ICON_ID = 'search';\nconst PALETTE_ICON_ID = 'symbol-color';\nconst CHEVRON_DOWN_ICON_ID = 'chevron-right';\nconst PALETTE_HEIGHT = '500px';\nconst SELECTION_TOOL_KEY: KeyCode[] = ['Digit1', 'Numpad1'];\nconst DELETION_TOOL_KEY: KeyCode[] = ['Digit2', 'Numpad2'];\nconst MARQUEE_TOOL_KEY: KeyCode[] = ['Digit3', 'Numpad3'];\nconst VALIDATION_TOOL_KEY: KeyCode[] = ['Digit4', 'Numpad4'];\nconst SEARCH_TOOL_KEY: KeyCode[] = ['Digit5', 'Numpad5'];\nconst SHOW_SHORTCUTS_CLASS = 'accessibility-show-shortcuts';\n\nconst AVAILABLE_KEYS: KeyCode[] = [\n    'KeyA',\n    'KeyB',\n    'KeyC',\n    'KeyD',\n    'KeyE',\n    'KeyF',\n    'KeyG',\n    'KeyH',\n    'KeyI',\n    'KeyJ',\n    'KeyK',\n    'KeyL',\n    'KeyM',\n    'KeyN',\n    'KeyO',\n    'KeyP',\n    'KeyQ',\n    'KeyR',\n    'KeyS',\n    'KeyT',\n    'KeyU',\n    'KeyV',\n    'KeyX',\n    'KeyY',\n    'KeyZ'\n];\n\nconst HEADER_TOOL_KEYS: KeyCode[][] = [SELECTION_TOOL_KEY, DELETION_TOOL_KEY, MARQUEE_TOOL_KEY, VALIDATION_TOOL_KEY, SEARCH_TOOL_KEY];\n\n@injectable()\nexport class KeyboardToolPalette extends ToolPalette {\n    protected deleteToolButton: HTMLElement;\n    protected marqueeToolButton: HTMLElement;\n    protected validateToolButton: HTMLElement;\n    protected searchToolButton: HTMLElement;\n\n    protected keyboardIndexButtonMapping = new Map<number, HTMLElement>();\n    protected headerToolsButtonMapping = new Map<number, HTMLElement>();\n\n    protected get interactablePaletteItems(): PaletteItem[] {\n        return this.paletteItems\n            .sort(compare)\n            .map(item => item.children?.sort(compare) ?? [item])\n            .reduce((acc, val) => acc.concat(val), []);\n    }\n\n    protected override initializeContents(_containerElement: HTMLElement): void {\n        this.containerElement.setAttribute('aria-label', 'Tool Palette');\n        this.containerElement.tabIndex = 20;\n        this.containerElement.classList.add('accessibility-tool-palette');\n        this.createHeader();\n        this.createBody();\n        this.lastActiveButton = this.defaultToolsButton;\n\n        this.containerElement.onkeyup = ev => {\n            this.clearToolOnEscape(ev);\n            if (this.isShortcutsVisible()) {\n                this.selectItemOnCharacter(ev);\n                this.triggerHeaderToolsByKey(ev);\n            }\n        };\n    }\n\n    override handle(action: Action): ICommand | Action | void {\n        if (action.kind === EnableToolPaletteAction.KIND) {\n            const requestAction = RequestContextActions.create({\n                contextId: ToolPalette.ID,\n                editorContext: {\n                    selectedElementIds: []\n                }\n            });\n            this.actionDispatcher.requestUntil(requestAction).then(response => {\n                if (SetContextActions.is(response)) {\n                    this.paletteItems = response.actions.map(e => e as PaletteItem);\n                    this.actionDispatcher.dispatchAll([\n                        SetUIExtensionVisibilityAction.create({ extensionId: ToolPalette.ID, visible: !this.editorContext.isReadonly })\n                    ]);\n                }\n            });\n        } else if (action.kind === EnableDefaultToolsAction.KIND) {\n            this.changeActiveButton();\n            this.restoreFocus();\n        } else if (FocusDomAction.is(action) && action.id === ToolPalette.ID) {\n            if (this.containerElement.contains(document.activeElement)) {\n                this.toggleShortcutVisibility();\n            } else {\n                this.showShortcuts();\n            }\n            this.containerElement.focus();\n        }\n    }\n\n    protected override addMinimizePaletteButton(): void {\n        const baseDiv = document.getElementById(this.options.baseDiv);\n        const minPaletteDiv = document.createElement('div');\n        minPaletteDiv.classList.add('minimize-palette-button');\n        this.containerElement.classList.add('collapsible-palette');\n        if (baseDiv) {\n            const insertedDiv = baseDiv.insertBefore(minPaletteDiv, baseDiv.firstChild);\n            const minimizeIcon = createIcon(CHEVRON_DOWN_ICON_ID);\n            this.updateMinimizePaletteButtonTooltip(minPaletteDiv);\n            minimizeIcon.onclick = _event => {\n                if (this.isPaletteMaximized()) {\n                    this.containerElement.style.overflow = 'hidden';\n                    this.containerElement.style.maxHeight = '0px';\n                } else {\n                    this.containerElement.style.overflow = 'visible';\n                    this.containerElement.style.maxHeight = PALETTE_HEIGHT;\n                }\n                this.updateMinimizePaletteButtonTooltip(minPaletteDiv);\n                changeCodiconClass(minimizeIcon, PALETTE_ICON_ID);\n                changeCodiconClass(minimizeIcon, CHEVRON_DOWN_ICON_ID);\n            };\n            insertedDiv.appendChild(minimizeIcon);\n        }\n    }\n\n    protected override createBody(): void {\n        const bodyDiv = document.createElement('div');\n        bodyDiv.classList.add('palette-body');\n        const tabIndex = 21;\n        let toolButtonCounter = 0;\n\n        this.keyboardIndexButtonMapping.clear();\n        this.paletteItems.sort(compare).forEach(item => {\n            if (item.children) {\n                const group = createToolGroup(item);\n                item.children.sort(compare).forEach(child => {\n                    const button = this.createKeyboardToolButton(child, tabIndex, toolButtonCounter);\n                    group.appendChild(button);\n                    this.keyboardIndexButtonMapping.set(toolButtonCounter, button);\n                    toolButtonCounter++;\n                });\n                bodyDiv.appendChild(group);\n            } else {\n                const button = this.createKeyboardToolButton(item, tabIndex, toolButtonCounter);\n                bodyDiv.appendChild(button);\n                this.keyboardIndexButtonMapping.set(toolButtonCounter, button);\n                toolButtonCounter++;\n            }\n        });\n\n        if (this.paletteItems.length === 0) {\n            const noResultsDiv = document.createElement('div');\n            noResultsDiv.innerText = 'No results found.';\n            noResultsDiv.classList.add('tool-button');\n            bodyDiv.appendChild(noResultsDiv);\n        }\n        // Remove existing body to refresh filtered entries\n        if (this.bodyDiv) {\n            this.containerElement.removeChild(this.bodyDiv);\n        }\n        this.containerElement.appendChild(bodyDiv);\n        this.bodyDiv = bodyDiv;\n    }\n\n    protected override createHeaderTools(): HTMLElement {\n        this.headerToolsButtonMapping.clear();\n\n        const headerTools = document.createElement('div');\n        headerTools.classList.add('header-tools');\n\n        this.defaultToolsButton = this.createDefaultToolButton();\n        this.headerToolsButtonMapping.set(0, this.defaultToolsButton);\n        headerTools.appendChild(this.defaultToolsButton);\n\n        this.deleteToolButton = this.createMouseDeleteToolButton();\n        this.headerToolsButtonMapping.set(1, this.deleteToolButton);\n        headerTools.appendChild(this.deleteToolButton);\n\n        this.marqueeToolButton = this.createMarqueeToolButton();\n        this.headerToolsButtonMapping.set(2, this.marqueeToolButton);\n        headerTools.appendChild(this.marqueeToolButton);\n\n        this.validateToolButton = this.createValidateButton();\n        this.headerToolsButtonMapping.set(3, this.validateToolButton);\n        headerTools.appendChild(this.validateToolButton);\n\n        // Create button for Search\n        this.searchToolButton = this.createSearchButton();\n        this.headerToolsButtonMapping.set(4, this.searchToolButton);\n        headerTools.appendChild(this.searchToolButton);\n\n        return headerTools;\n    }\n\n    protected override createDefaultToolButton(): HTMLElement {\n        const button = createIcon('inspect');\n        button.id = 'btn_default_tools';\n        button.title = 'Enable selection tool';\n        button.onclick = this.onClickStaticToolButton(button);\n        button.appendChild(this.createKeyboardShotcut(SELECTION_TOOL_KEY[0]));\n\n        return button;\n    }\n\n    protected override createMouseDeleteToolButton(): HTMLElement {\n        const deleteToolButton = createIcon('chrome-close');\n        deleteToolButton.title = 'Enable deletion tool';\n        deleteToolButton.onclick = this.onClickStaticToolButton(deleteToolButton, MouseDeleteTool.ID);\n        deleteToolButton.appendChild(this.createKeyboardShotcut(DELETION_TOOL_KEY[0]));\n\n        return deleteToolButton;\n    }\n\n    protected override createMarqueeToolButton(): HTMLElement {\n        const marqueeToolButton = createIcon('screen-full');\n        marqueeToolButton.title = 'Enable marquee tool';\n        const toastMessageAction = ShowToastMessageAction.createWithTimeout({\n            id: Symbol.for(ElementNavigatorKeyListener.name),\n            message: messages.tool_palette.marqueeTool\n        });\n        marqueeToolButton.onclick = this.onClickStaticToolButton(marqueeToolButton, MarqueeMouseTool.ID, toastMessageAction);\n        marqueeToolButton.appendChild(this.createKeyboardShotcut(MARQUEE_TOOL_KEY[0]));\n\n        return marqueeToolButton;\n    }\n\n    protected override createValidateButton(): HTMLElement {\n        const validateToolButton = createIcon('pass');\n        validateToolButton.title = 'Validate model';\n        validateToolButton.onclick = _event => {\n            const modelIds: string[] = [this.modelRootId];\n            this.actionDispatcher.dispatch(RequestMarkersAction.create(modelIds));\n        };\n        validateToolButton.appendChild(this.createKeyboardShotcut(VALIDATION_TOOL_KEY[0]));\n\n        return validateToolButton;\n    }\n\n    protected override onClickStaticToolButton(button: HTMLElement, toolId?: string, action?: Action) {\n        return (_ev: MouseEvent) => {\n            if (!this.editorContext.isReadonly) {\n                const defaultAction = toolId ? EnableToolsAction.create([toolId]) : EnableDefaultToolsAction.create();\n                if (action) {\n                    this.actionDispatcher.dispatchAll([defaultAction, action]);\n                } else {\n                    this.actionDispatcher.dispatchAll([defaultAction]);\n                }\n                this.changeActiveButton(button);\n                button.focus();\n            }\n        };\n    }\n    protected override createSearchButton(): HTMLElement {\n        const searchIcon = createIcon(SEARCH_ICON_ID);\n        searchIcon.onclick = _ev => {\n            const searchField = document.getElementById(this.containerElement.id + '_search_field');\n            if (searchField) {\n                if (searchField.style.display === 'none') {\n                    searchField.style.display = '';\n                    searchField.focus();\n                } else {\n                    searchField.style.display = 'none';\n                }\n            }\n        };\n        searchIcon.classList.add('search-icon');\n        searchIcon.title = 'Filter palette entries';\n        searchIcon.appendChild(this.createKeyboardShotcut(SEARCH_TOOL_KEY[0]));\n\n        return searchIcon;\n    }\n\n    protected override createHeaderSearchField(): HTMLInputElement {\n        const searchField = document.createElement('input');\n        searchField.classList.add('search-input');\n        searchField.tabIndex = 21;\n        searchField.id = this.containerElement.id + '_search_field';\n        searchField.type = 'text';\n        searchField.placeholder = ' Search...';\n        searchField.style.display = 'none';\n        searchField.onkeyup = ev => {\n            this.requestFilterUpdate(this.searchField.value);\n            ev.stopPropagation();\n\n            if (searchField.value === '') {\n                this.focusToolPaletteOnEscape(ev);\n            } else {\n                this.clearOnEscape(ev);\n            }\n        };\n\n        return searchField;\n    }\n\n    protected focusToolPaletteOnEscape(event: KeyboardEvent): void {\n        if (matchesKeystroke(event, 'Escape')) {\n            this.containerElement.focus();\n        }\n    }\n\n    protected createKeyboardShotcut(keyShortcut: KeyCode): HTMLElement {\n        const hint = document.createElement('div');\n        hint.classList.add('key-shortcut');\n        let keyShortcutValue = keyShortcut.toString();\n\n        if (keyShortcut.includes('Key')) {\n            keyShortcutValue = keyShortcut.toString().substring(3);\n        } else if (keyShortcut.includes('Digit')) {\n            keyShortcutValue = keyShortcut.toString().substring(5);\n        }\n        hint.innerHTML = keyShortcutValue;\n        return hint;\n    }\n\n    protected createKeyboardToolButton(item: PaletteItem, tabIndex: number, buttonIndex: number): HTMLElement {\n        const button = document.createElement('div');\n        // add keyboard index\n        if (buttonIndex < AVAILABLE_KEYS.length) {\n            button.appendChild(this.createKeyboardShotcut(AVAILABLE_KEYS[buttonIndex]));\n        }\n        button.tabIndex = tabIndex;\n        button.classList.add('tool-button');\n        if (item.icon) {\n            button.appendChild(createIcon(item.icon));\n        }\n        button.insertAdjacentText('beforeend', item.label);\n        button.onclick = this.onClickCreateToolButton(button, item);\n\n        button.onkeydown = ev => {\n            this.clickToolOnEnter(ev, button, item);\n            this.clearToolOnEscape(ev);\n\n            if (matchesKeystroke(ev, 'ArrowDown')) {\n                if (buttonIndex + 1 > this.keyboardIndexButtonMapping.size - 1) {\n                    this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(0));\n                } else {\n                    this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(buttonIndex + 1));\n                }\n            } else if (matchesKeystroke(ev, 'ArrowUp')) {\n                if (buttonIndex - 1 < 0) {\n                    this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(this.keyboardIndexButtonMapping.size - 1));\n                } else {\n                    this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(buttonIndex - 1));\n                }\n            }\n        };\n\n        return button;\n    }\n\n    protected clickToolOnEnter(event: KeyboardEvent, button: HTMLElement, item: PaletteItem): void {\n        if (matchesKeystroke(event, 'Enter')) {\n            if (!this.editorContext.isReadonly) {\n                this.actionDispatcher.dispatchAll(item.actions);\n                this.changeActiveButton(button);\n                this.selectItemOnCharacter(event);\n            }\n        }\n    }\n\n    protected selectItemOnCharacter(event: KeyboardEvent): void {\n        let index: number | undefined = undefined;\n        const items = this.interactablePaletteItems;\n\n        const itemsCount = items.length < AVAILABLE_KEYS.length ? items.length : AVAILABLE_KEYS.length;\n\n        for (let i = 0; i < itemsCount; i++) {\n            const keycode = AVAILABLE_KEYS[i];\n            if (matchesKeystroke(event, keycode)) {\n                index = i;\n                break;\n            }\n        }\n\n        if (index !== undefined) {\n            if (items[index].actions.some(a => a.kind === TriggerNodeCreationAction.KIND)) {\n                this.actionDispatcher.dispatchAll([\n                    ...items[index].actions,\n                    SetUIExtensionVisibilityAction.create({\n                        extensionId: KeyboardNodeGridMetadata.ID,\n                        visible: true,\n                        contextElementsId: []\n                    })\n                ]);\n            } else {\n                this.actionDispatcher.dispatchAll([\n                    ...items[index].actions,\n                    SetUIExtensionVisibilityAction.create({\n                        extensionId: EdgeAutocompletePaletteMetadata.ID,\n                        visible: true,\n                        contextElementsId: []\n                    })\n                ]);\n            }\n            this.changeActiveButton(this.keyboardIndexButtonMapping.get(index));\n            this.keyboardIndexButtonMapping.get(index)?.focus();\n        }\n    }\n\n    protected triggerHeaderToolsByKey(event: KeyboardEvent): void {\n        let index: number | undefined = undefined;\n\n        for (let i = 0; i < HEADER_TOOL_KEYS.length; i++) {\n            for (let j = 0; j < HEADER_TOOL_KEYS[i].length; j++) {\n                const keycode = HEADER_TOOL_KEYS[i][j];\n\n                if (matchesKeystroke(event, keycode)) {\n                    event.stopPropagation();\n                    event.preventDefault();\n                    index = i;\n                    break;\n                }\n            }\n        }\n\n        if (index !== undefined) {\n            this.headerToolsButtonMapping.get(index)?.click();\n        }\n    }\n\n    protected selectItemViaArrowKey(currentButton: HTMLElement | undefined): void {\n        if (currentButton !== undefined) {\n            this.changeActiveButton(currentButton);\n            currentButton?.focus();\n        }\n    }\n\n    protected override clearToolOnEscape(event: KeyboardEvent): void {\n        if (matchesKeystroke(event, 'Escape')) {\n            if (event.target instanceof HTMLElement) {\n                event.target.blur();\n            }\n            this.actionDispatcher.dispatch(EnableDefaultToolsAction.create());\n        }\n    }\n\n    protected toggleShortcutVisibility(): void {\n        if (this.isShortcutsVisible()) {\n            this.hideShortcuts();\n        } else {\n            this.showShortcuts();\n        }\n    }\n\n    protected isShortcutsVisible(): boolean {\n        return this.containerElement.classList.contains(SHOW_SHORTCUTS_CLASS);\n    }\n\n    protected showShortcuts(): void {\n        this.containerElement.classList.add(SHOW_SHORTCUTS_CLASS);\n    }\n\n    protected hideShortcuts(): void {\n        this.containerElement.classList.remove(SHOW_SHORTCUTS_CLASS);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport '../../../../css/keyboard-tool-palette.css';\n\nimport { configureActionHandler, TYPES, bindAsService, BindingContext, FeatureModule } from '@eclipse-glsp/sprotty';\nimport { EnableToolPaletteAction } from '../../tool-palette/tool-palette';\nimport { KeyboardToolPalette } from './keyboard-tool-palette';\nimport { FocusDomAction } from '../actions';\nimport { EnableDefaultToolsAction } from '../../../base/tool-manager/tool';\n\nexport const keyboardToolPaletteModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureKeyboardToolPaletteTool(context);\n});\n\nexport function configureKeyboardToolPaletteTool(context: BindingContext): void {\n    bindAsService(context, TYPES.IUIExtension, KeyboardToolPalette);\n    context.bind(TYPES.IDiagramStartup).toService(KeyboardToolPalette);\n    configureActionHandler(context, EnableDefaultToolsAction.KIND, KeyboardToolPalette);\n    configureActionHandler(context, FocusDomAction.KIND, KeyboardToolPalette);\n    configureActionHandler(context, EnableToolPaletteAction.KIND, KeyboardToolPalette);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport namespace KeyboardPointerMetadata {\n    export const ID = 'keyboard-pointer';\n    export const CRICLE_HEIGHT = 16;\n    export const CIRCLE_WIDTH = 16;\n    export const TAB_INDEX = 10;\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { SetUIExtensionVisibilityAction, Action } from '@eclipse-glsp/sprotty';\nimport { Tool } from '../../base/tool-manager/tool';\nimport { matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport { ToolPalette } from '../tool-palette/tool-palette';\nimport { FocusDomAction } from './actions';\nimport { KeyboardGridMetadata, KeyboardNodeGridMetadata } from '../accessibility/keyboard-grid/constants';\nimport { KeyboardPointerMetadata } from './keyboard-pointer/constants';\nimport { AccessibleKeyShortcutProvider, SetAccessibleKeyShortcutAction } from './key-shortcut/accessible-key-shortcut';\nimport { GLSPActionDispatcher } from '../../base/action-dispatcher';\nimport { KeyboardToolPalette } from './keyboard-tool-palette/keyboard-tool-palette';\n\n@injectable()\nexport class GlobalKeyListenerTool implements Tool, AccessibleKeyShortcutProvider {\n    static ID = 'glsp.global-key-listener';\n\n    isEditTool = false;\n    protected alreadyRegistered = false;\n\n    @inject(GLSPActionDispatcher)\n    protected actionDispatcher: GLSPActionDispatcher;\n\n    get id(): string {\n        return GlobalKeyListenerTool.ID;\n    }\n\n    enable(): void {\n        if (!this.alreadyRegistered) {\n            this.alreadyRegistered = true;\n            document.addEventListener('keyup', this.trigger.bind(this));\n            this.registerShortcutKey();\n        }\n    }\n\n    disable(): void {\n        // It is not possible to remove the handlers after registration\n        // The handlers need to be available all the time to work correctly\n    }\n\n    registerShortcutKey(): void {\n        this.actionDispatcher.onceModelInitialized().then(() => {\n            this.actionDispatcher.dispatchAll([\n                SetAccessibleKeyShortcutAction.create({\n                    token: KeyboardToolPalette.name,\n                    keys: [{ shortcuts: ['ALT', 'P'], description: 'Focus on tool palette', group: 'Tool-Palette', position: 0 }]\n                }),\n                SetAccessibleKeyShortcutAction.create({\n                    token: 'Graph',\n                    keys: [{ shortcuts: ['ALT', 'G'], description: 'Focus on graph', group: 'Graph', position: 0 }]\n                })\n            ]);\n        });\n    }\n\n    trigger(event: KeyboardEvent): void {\n        this.actionDispatcher.dispatchAll(this.handleKeyEvent(event));\n    }\n\n    protected handleKeyEvent(event: KeyboardEvent): Action[] {\n        if (this.matchesSetFocusOnToolPalette(event)) {\n            return [FocusDomAction.create(ToolPalette.ID)];\n        } else if (this.matchesSetFocusOnDiagram(event)) {\n            return [FocusDomAction.create('graph')];\n        } else if (this.matchesReleaseFocusFromToolPalette(event)) {\n            return [\n                SetUIExtensionVisibilityAction.create({ extensionId: KeyboardPointerMetadata.ID, visible: false, contextElementsId: [] }),\n                SetUIExtensionVisibilityAction.create({ extensionId: KeyboardGridMetadata.ID, visible: false, contextElementsId: [] }),\n                SetUIExtensionVisibilityAction.create({ extensionId: KeyboardNodeGridMetadata.ID, visible: false, contextElementsId: [] })\n            ];\n        }\n        return [];\n    }\n\n    protected matchesSetFocusOnToolPalette(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'KeyP', 'alt');\n    }\n    protected matchesSetFocusOnDiagram(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'KeyG', 'alt');\n    }\n    protected matchesReleaseFocusFromToolPalette(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Escape');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { Action, hasNumberProp } from '@eclipse-glsp/sprotty';\n\nexport interface SetKeyboardPointerRenderPositionAction extends Action {\n    kind: typeof SetKeyboardPointerRenderPositionAction.KIND;\n    x: number;\n    y: number;\n}\n\nexport namespace SetKeyboardPointerRenderPositionAction {\n    export const KIND = 'setKeyboardPointerRenderPositionAction';\n\n    export function is(object: any): object is SetKeyboardPointerRenderPositionAction {\n        return Action.hasKind(object, KIND) && hasNumberProp(object, 'x') && hasNumberProp(object, 'y');\n    }\n\n    export function create(x: number, y: number): SetKeyboardPointerRenderPositionAction {\n        return { kind: KIND, x, y };\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { IActionDispatcher, SetUIExtensionVisibilityAction, CreateNodeOperation } from '@eclipse-glsp/sprotty';\nimport { matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport { KeyboardNodeGridMetadata } from '../keyboard-grid/constants';\nimport { KeyboardPointerMetadata } from './constants';\nimport { KeyboardPointer } from './keyboard-pointer';\nimport { KeyboardPointerPosition } from './keyboard-pointer-position';\nimport { EnableDefaultToolsAction } from '../../../base/tool-manager/tool';\nimport { CursorCSS } from '../../../base/feedback/css-feedback';\n\n/**\n * Keyboard listener for the pointer with the necessary logic to handle keyboard events\n */\nexport class KeyboardPointerKeyboardListener {\n    protected get position(): KeyboardPointerPosition {\n        return this.keyboardPointer.getPosition;\n    }\n\n    constructor(protected readonly keyboardPointer: KeyboardPointer, protected readonly actionDispatcher: IActionDispatcher) {}\n\n    keyDown(event: KeyboardEvent): void {\n        this.moveIfArrows(event);\n        this.createIfEnterEvent(event);\n        this.hideIfEscapeEvent(event);\n    }\n\n    protected moveIfArrows(event: KeyboardEvent): any {\n        if (this.matchesMovePointerDown(event)) {\n            this.position.renderPosition = this.position.calcRelativeRenderPosition(0, 10);\n            this.keyboardPointer.render();\n        } else if (this.matchesMovePointerUp(event)) {\n            this.position.renderPosition = this.position.calcRelativeRenderPosition(0, -10);\n            this.keyboardPointer.render();\n        } else if (this.matchesMovePointerRight(event)) {\n            this.position.renderPosition = this.position.calcRelativeRenderPosition(10, 0);\n            this.keyboardPointer.render();\n        } else if (this.matchesMovePointerLeft(event)) {\n            this.position.renderPosition = this.position.calcRelativeRenderPosition(-10, 0);\n            this.keyboardPointer.render();\n        }\n    }\n\n    protected createIfEnterEvent(event: KeyboardEvent): any {\n        const elementTypeId = this.keyboardPointer.triggerAction.elementTypeId;\n\n        const { container, status } = this.position.containableParentAtDiagramPosition(elementTypeId);\n\n        if (container !== undefined && status === CursorCSS.NODE_CREATION) {\n            if (this.matchesConfirmPointerPosition(event)) {\n                // close everything and return to default\n\n                const containerId = container.id;\n                const location = this.position.diagramPosition;\n\n                this.actionDispatcher.dispatchAll([\n                    SetUIExtensionVisibilityAction.create({\n                        extensionId: KeyboardPointerMetadata.ID,\n                        visible: false,\n                        contextElementsId: []\n                    }),\n                    SetUIExtensionVisibilityAction.create({\n                        extensionId: KeyboardNodeGridMetadata.ID,\n                        visible: false,\n                        contextElementsId: []\n                    }),\n                    CreateNodeOperation.create(elementTypeId, { location, containerId, args: this.keyboardPointer.triggerAction.args }),\n                    EnableDefaultToolsAction.create()\n                ]);\n            } else if (this.matchesConfirmPointerPositionAndStayInMode(event)) {\n                // stay in this mode, selected palette option stays, grid and keyboard mouse are displayed\n\n                const containerId = container.id;\n                const location = this.position.diagramPosition;\n\n                this.actionDispatcher.dispatch(\n                    CreateNodeOperation.create(elementTypeId, { location, containerId, args: this.keyboardPointer.triggerAction.args })\n                );\n            }\n        }\n    }\n\n    protected hideIfEscapeEvent(event: KeyboardEvent): any {\n        if (this.matchesDeactivatePointer(event)) {\n            this.keyboardPointer.hide();\n        }\n    }\n\n    protected matchesDeactivatePointer(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Escape');\n    }\n    protected matchesConfirmPointerPosition(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Enter');\n    }\n    protected matchesConfirmPointerPositionAndStayInMode(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Enter', 'ctrl');\n    }\n\n    protected matchesMovePointerLeft(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowLeft');\n    }\n    protected matchesMovePointerRight(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowRight');\n    }\n    protected matchesMovePointerUp(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowUp');\n    }\n    protected matchesMovePointerDown(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'ArrowDown');\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { findChildrenAtPosition, findParentByFeature, GModelElement, Point } from '@eclipse-glsp/sprotty';\nimport { Containable, isContainable } from '../../hints/model';\nimport { getAbsolutePositionByPoint } from '../../../utils/viewpoint-util';\nimport { KeyboardPointerMetadata } from './constants';\nimport { KeyboardPointer } from './keyboard-pointer';\nimport { CursorCSS } from '../../../base/feedback/css-feedback';\n\nexport class KeyboardPointerPosition {\n    public renderPosition: Point = { x: 20, y: 20 };\n\n    constructor(protected readonly keyboardPointer: KeyboardPointer) {}\n\n    get centerizedRenderPosition(): Point {\n        return {\n            x: this.renderPosition.x + KeyboardPointerMetadata.CIRCLE_WIDTH / 2,\n            y: this.renderPosition.y + KeyboardPointerMetadata.CRICLE_HEIGHT / 2\n        };\n    }\n\n    get diagramPosition(): Point {\n        return getAbsolutePositionByPoint(this.keyboardPointer.editorContextService.modelRoot, this.centerizedRenderPosition);\n    }\n\n    childrenAtDiagramPosition(): GModelElement[] {\n        const position = this.diagramPosition;\n\n        return [\n            this.keyboardPointer.editorContextService.modelRoot,\n            ...findChildrenAtPosition(this.keyboardPointer.editorContextService.modelRoot, position)\n        ];\n    }\n\n    containableParentAtDiagramPosition(elementTypeId: string): {\n        container: (GModelElement & Containable) | undefined;\n        status: CursorCSS;\n    } {\n        const children = this.childrenAtDiagramPosition();\n\n        return this.containableParentOf(children.reverse()[0], elementTypeId);\n    }\n\n    calcRelativeRenderPosition(x: number, y: number): Point {\n        return {\n            x: this.renderPosition.x + x,\n            y: this.renderPosition.y + y\n        };\n    }\n\n    private containableParentOf(\n        target: GModelElement,\n        elementTypeId: string\n    ): { container: (GModelElement & Containable) | undefined; status: CursorCSS } {\n        const container = findParentByFeature(target, isContainable);\n        return {\n            container,\n            status: this.isCreationAllowed(container, elementTypeId) ? CursorCSS.NODE_CREATION : CursorCSS.OPERATION_NOT_ALLOWED\n        };\n    }\n\n    private isCreationAllowed(container: (GModelElement & Containable) | undefined, elementTypeId: string): boolean | undefined {\n        return container && container.isContainableElement(elementTypeId);\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport {\n    AbstractUIExtension,\n    IActionDispatcher,\n    IActionHandler,\n    GModelRoot,\n    TYPES,\n    Action,\n    TriggerNodeCreationAction\n} from '@eclipse-glsp/sprotty';\nimport { SetKeyboardPointerRenderPositionAction } from './actions';\nimport { KeyboardPointerMetadata } from './constants';\nimport { KeyboardPointerKeyboardListener } from './keyboard-pointer-listener';\nimport { KeyboardPointerPosition } from './keyboard-pointer-position';\nimport { KeyboardGridCellSelectedAction } from '../keyboard-grid/action';\nimport { EditorContextService } from '../../../base/editor-context-service';\nimport { CursorCSS } from '../../../base/feedback/css-feedback';\n\n@injectable()\nexport class KeyboardPointer extends AbstractUIExtension implements IActionHandler {\n    protected _triggerAction: TriggerNodeCreationAction = {\n        elementTypeId: 'task:automated',\n        kind: 'triggerNodeCreation'\n    };\n\n    protected position: KeyboardPointerPosition = new KeyboardPointerPosition(this);\n    protected keyListener: KeyboardPointerKeyboardListener;\n    @inject(EditorContextService)\n    public editorContextService: EditorContextService;\n\n    constructor(@inject(TYPES.IActionDispatcher) protected readonly actionDispatcher: IActionDispatcher) {\n        super();\n\n        this.keyListener = new KeyboardPointerKeyboardListener(this, actionDispatcher);\n    }\n\n    get triggerAction(): TriggerNodeCreationAction {\n        return this._triggerAction;\n    }\n\n    get isVisible(): boolean {\n        return this.containerElement?.style.visibility === 'visible';\n    }\n\n    get getPosition(): KeyboardPointerPosition {\n        return this.position;\n    }\n    get getKeyListener(): KeyboardPointerKeyboardListener {\n        return this.keyListener;\n    }\n\n    id(): string {\n        return KeyboardPointerMetadata.ID;\n    }\n\n    containerClass(): string {\n        return KeyboardPointerMetadata.ID;\n    }\n\n    protected initializeContents(containerElement: HTMLElement): void {\n        containerElement.style.position = 'absolute';\n        containerElement.style.height = `${KeyboardPointerMetadata.CRICLE_HEIGHT}px`;\n        containerElement.style.width = `${KeyboardPointerMetadata.CIRCLE_WIDTH}px`;\n        containerElement.style.borderRadius = '100%';\n    }\n\n    protected override onBeforeShow(containerElement: HTMLElement, root: Readonly<GModelRoot>, ...selectedElementIds: string[]): void {\n        this.render();\n    }\n\n    handle(action: Action): Action | void {\n        if (TriggerNodeCreationAction.is(action)) {\n            this._triggerAction = action;\n        } else if (SetKeyboardPointerRenderPositionAction.is(action)) {\n            this.position.renderPosition = { x: action.x, y: action.y };\n            this.render();\n        } else if (KeyboardGridCellSelectedAction.is(action) && action.options.originId === KeyboardPointerMetadata.ID) {\n            this.position.renderPosition = action.options.centerCellPosition;\n            this.render();\n        }\n    }\n\n    render(): void {\n        if (this.containerElement !== undefined) {\n            const { x, y } = this.position.renderPosition;\n            this.containerElement.style.left = `${x}px`;\n            this.containerElement.style.top = `${y}px`;\n\n            const { status } = this.position.containableParentAtDiagramPosition(this._triggerAction.elementTypeId);\n\n            this.containerElement.style.borderStyle = 'solid';\n            this.containerElement.style.borderWidth = 'thick';\n            switch (status) {\n                case CursorCSS.NODE_CREATION: {\n                    this.containerElement.style.borderColor = 'green';\n                    break;\n                }\n                case CursorCSS.OPERATION_NOT_ALLOWED: {\n                    this.containerElement.style.borderColor = 'red';\n                    break;\n                }\n            }\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport '../../../../css/keyboard.css';\n\nimport { inject, injectable } from 'inversify';\nimport {\n    AbstractUIExtension,\n    ActionDispatcher,\n    IActionHandler,\n    SetUIExtensionVisibilityAction,\n    GModelRoot,\n    TYPES,\n    Action,\n    ICommand,\n    Point\n} from '@eclipse-glsp/sprotty';\nimport { KeyCode, matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport { KeyboardGridMetadata } from './constants';\nimport { EnableKeyboardGridAction, KeyboardGridCellSelectedAction, KeyboardGridKeyboardEventAction } from './action';\n\n@injectable()\nexport class KeyboardGrid extends AbstractUIExtension implements IActionHandler {\n    @inject(TYPES.IActionDispatcher) protected readonly actionDispatcher: ActionDispatcher;\n\n    protected triggerActions: Action[] = [];\n    protected originId: string;\n\n    id(): string {\n        return KeyboardGridMetadata.ID;\n    }\n\n    containerClass(): string {\n        return KeyboardGridMetadata.ID;\n    }\n    handle(action: Action): void | Action | ICommand {\n        if (EnableKeyboardGridAction.is(action)) {\n            this.triggerActions = action.options.triggerActions;\n            this.originId = action.options.originId;\n            this.actionDispatcher.dispatch(\n                SetUIExtensionVisibilityAction.create({\n                    extensionId: KeyboardGridMetadata.ID,\n                    visible: true\n                })\n            );\n        }\n    }\n\n    protected initializeContents(containerElement: HTMLElement): void {\n        containerElement.tabIndex = KeyboardGridMetadata.TAB_INDEX;\n        containerElement.classList.add('grid-container');\n\n        for (let i = 1; i <= 9; i++) {\n            const gridNumber = document.createElement('div');\n            const gridItem = document.createElement('div');\n\n            gridItem.classList.add('grid-item');\n            gridItem.id = `keyboard-grid-item-${i}`;\n\n            gridNumber.classList.add('grid-item-number');\n            gridNumber.innerHTML = i.toString();\n\n            gridItem.appendChild(gridNumber);\n            containerElement.appendChild(gridItem);\n        }\n\n        this.containerElement.onkeydown = ev => {\n            this.onKeyDown(ev);\n        };\n    }\n\n    protected onKeyDown(event: KeyboardEvent): void {\n        this.activateCellIfDigitEvent(event);\n        this.hideIfEscapeEvent(event);\n\n        this.actionDispatcher.dispatch(\n            KeyboardGridKeyboardEventAction.create({\n                originId: this.originId,\n                event\n            })\n        );\n    }\n\n    protected override setContainerVisible(visible: boolean): void {\n        if (this.containerElement) {\n            if (visible) {\n                this.containerElement.style.visibility = 'visible';\n                this.containerElement.style.opacity = '0.7';\n            } else {\n                this.containerElement.style.visibility = 'hidden';\n                this.containerElement.style.opacity = '0';\n            }\n        }\n    }\n\n    override show(root: Readonly<GModelRoot>, ...contextElementIds: string[]): void {\n        super.show(root, ...contextElementIds);\n        this.containerElement.focus();\n    }\n\n    protected hideIfEscapeEvent(event: KeyboardEvent): any {\n        if (this.matchesDeactivateGrid(event)) {\n            this.hide();\n        }\n    }\n\n    protected activateCellIfDigitEvent(event: KeyboardEvent): any {\n        let index: number | undefined = undefined;\n\n        for (let i = 1; i <= 9; i++) {\n            if (this.matchesGridBoxAtIndex(event, i)) {\n                index = i;\n                break;\n            }\n        }\n\n        if (index !== undefined) {\n            const position = this.centerPositionOfCell(index);\n\n            this.dispatchActionsForCell(index, position);\n        }\n    }\n\n    protected dispatchActionsForCell(index: number, cellCenter: Point): void {\n        this.actionDispatcher.dispatchAll([\n            ...this.triggerActions,\n            KeyboardGridCellSelectedAction.create({\n                originId: this.originId,\n                cellId: index.toString(),\n                centerCellPosition: cellCenter\n            })\n        ]);\n    }\n    protected centerPositionOfCell(index: number): Point {\n        let x = 0;\n        let y = 0;\n\n        const activeGridCell = document.getElementById(`keyboard-grid-item-${index}`);\n        // eslint-disable-next-line no-null/no-null\n        if (activeGridCell !== null) {\n            const positions = this.getCenterOfCell(activeGridCell);\n            x = positions[0];\n            y = positions[1];\n        }\n\n        return {\n            x,\n            y\n        };\n    }\n    protected matchesDeactivateGrid(event: KeyboardEvent): boolean {\n        return matchesKeystroke(event, 'Escape');\n    }\n    protected matchesGridBoxAtIndex(event: KeyboardEvent, index: number): boolean {\n        return matchesKeystroke(event, ('Digit' + index) as KeyCode) || matchesKeystroke(event, ('Numpad' + index) as KeyCode);\n    }\n    // https://www.delftstack.com/howto/javascript/get-position-of-element-in-javascript/\n    private getOffset(el: any): { top: number; left: number } {\n        let _x = 0;\n        let _y = 0;\n        while (el && !isNaN(el.offsetLeft) && !isNaN(el.offsetTop)) {\n            _x += el.offsetLeft - el.scrollLeft;\n            _y += el.offsetTop - el.scrollTop;\n            el = el.offsetParent;\n        }\n        return { top: _y, left: _x };\n    }\n\n    private getCenterOfCell(cell: HTMLElement): number[] {\n        const cellLeft = this.getOffset(cell).left;\n        const cellTop = this.getOffset(cell).top;\n        const cellWidth = cell.offsetWidth;\n        const cellHeight = cell.offsetHeight;\n\n        const newCellWidth = cellWidth / 2;\n        const newCellHeight = cellHeight / 2;\n\n        return [cellLeft + newCellWidth, cellTop + newCellHeight];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from 'inversify';\nimport { KeyTool, KeyListener, SetUIExtensionVisibilityAction, GModelElement, Action } from '@eclipse-glsp/sprotty';\nimport { Tool } from '../../../base/tool-manager/tool';\nimport { matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport { EdgeAutocompletePaletteMetadata } from './edge-autocomplete-palette';\n\n@injectable()\nexport class EdgeAutocompletePaletteTool implements Tool {\n    static readonly ID = 'glsp.edge-autocomplete-palette-tool';\n\n    protected readonly keyListener = new EdgeAutocompletePaletteKeyListener();\n\n    @inject(KeyTool) protected keyTool: KeyTool;\n\n    get id(): string {\n        return EdgeAutocompletePaletteTool.ID;\n    }\n\n    enable(): void {\n        this.keyTool.register(this.keyListener);\n    }\n\n    disable(): void {\n        this.keyTool.deregister(this.keyListener);\n    }\n}\n\nexport class EdgeAutocompletePaletteKeyListener extends KeyListener {\n    override keyDown(element: GModelElement, event: KeyboardEvent): Action[] {\n        if (matchesKeystroke(event, 'Escape')) {\n            return [\n                SetUIExtensionVisibilityAction.create({\n                    extensionId: EdgeAutocompletePaletteMetadata.ID,\n                    visible: false,\n                    contextElementsId: []\n                })\n            ];\n        }\n        return [];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport '../../../../css/keyboard.css';\n\nimport { Action, GModelElement, GModelRoot, SetUIExtensionVisibilityAction } from '@eclipse-glsp/sprotty';\nimport { injectable } from 'inversify';\nimport { IAutocompleteSuggestionProvider } from '../../../base/auto-complete/autocomplete-suggestion-providers';\nimport {\n    RevealEdgeElementAutocompleteSuggestionProvider,\n    RevealNamedElementAutocompleteSuggestionProvider,\n    SearchAutocompletePalette\n} from '../search/search-palette';\nimport { KeyboardGridMetadata } from './constants';\nimport { GEdge } from '../../../model';\n\nexport namespace GridSearchPaletteMetadata {\n    export const ID = 'grid-search-palette';\n}\n\n@injectable()\nexport class GridSearchPalette extends SearchAutocompletePalette {\n    override id(): string {\n        return GridSearchPaletteMetadata.ID;\n    }\n\n    protected override getSuggestionProviders(root: Readonly<GModelRoot>, input: string): IAutocompleteSuggestionProvider[] {\n        return [new GridRevealNamedElementSuggestionProvider(), new GridRevealEdgeSuggestionProvider()];\n    }\n}\n\nexport class GridRevealEdgeSuggestionProvider extends RevealEdgeElementAutocompleteSuggestionProvider {\n    protected override getActions(edge: GEdge): Action[] {\n        return [\n            ...super.getActions(edge),\n            SetUIExtensionVisibilityAction.create({\n                extensionId: KeyboardGridMetadata.ID,\n                visible: true\n            })\n        ];\n    }\n}\nexport class GridRevealNamedElementSuggestionProvider extends RevealNamedElementAutocompleteSuggestionProvider {\n    protected override getActions(nameable: GModelElement): Action[] {\n        return [\n            ...super.getActions(nameable),\n            SetUIExtensionVisibilityAction.create({\n                extensionId: KeyboardGridMetadata.ID,\n                visible: true\n            })\n        ];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport '../../../../css/keyboard.css';\n\nimport { inject, injectable } from 'inversify';\nimport { ICommand, SetUIExtensionVisibilityAction, Action } from '@eclipse-glsp/sprotty';\nimport { matchesKeystroke } from 'sprotty/lib/utils/keyboard';\nimport { KeyboardPointer } from '../keyboard-pointer/keyboard-pointer';\nimport { KeyboardPointerMetadata } from '../keyboard-pointer/constants';\nimport { GridSearchPaletteMetadata } from './keyboard-grid-search-palette';\nimport { KeyboardGrid } from './keyboard-grid';\nimport { KeyboardNodeGridMetadata } from './constants';\n\n@injectable()\nexport class KeyboardNodeGrid extends KeyboardGrid {\n    @inject(KeyboardPointer) protected readonly keyboardPointer: KeyboardPointer;\n\n    protected override triggerActions = [SetUIExtensionVisibilityAction.create({ extensionId: KeyboardPointerMetadata.ID, visible: true })];\n    protected override originId = KeyboardPointerMetadata.ID;\n\n    override id(): string {\n        return KeyboardNodeGridMetadata.ID;\n    }\n\n    override handle(action: Action): void | Action | ICommand {\n        // Do nothing\n    }\n\n    protected override onKeyDown(event: KeyboardEvent): void {\n        super.onKeyDown(event);\n        this.showSearchOnEvent(event);\n\n        if (this.keyboardPointer.isVisible) {\n            this.keyboardPointer.getKeyListener.keyDown(event);\n        }\n    }\n\n    protected showSearchOnEvent(event: KeyboardEvent): void {\n        if (matchesKeystroke(event, 'KeyF', 'ctrl')) {\n            event.preventDefault();\n            this.actionDispatcher.dispatch(\n                SetUIExtensionVisibilityAction.create({\n                    extensionId: GridSearchPaletteMetadata.ID,\n                    visible: true\n                })\n            );\n            this.hide();\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport {\n    TYPES,\n    bindAsService,\n    configureActionHandler,\n    TriggerNodeCreationAction,\n    FeatureModule,\n    BindingContext,\n    TriggerEdgeCreationAction\n} from '@eclipse-glsp/sprotty';\nimport { GlobalKeyListenerTool } from '../global-keylistener-tool';\nimport { KeyboardPointer } from './keyboard-pointer';\nimport { KeyboardGrid } from '../keyboard-grid/keyboard-grid';\nimport { SetKeyboardPointerRenderPositionAction } from './actions';\nimport { EdgeAutocompletePalette } from '../edge-autocomplete/edge-autocomplete-palette';\nimport { EdgeAutocompletePaletteTool } from '../edge-autocomplete/edge-autocomplete-tool';\nimport { SetEdgeTargetSelectionAction } from '../edge-autocomplete/action';\nimport { GridSearchPalette } from '../keyboard-grid/keyboard-grid-search-palette';\nimport { KeyboardNodeGrid } from '../keyboard-grid/keyboard-node-grid';\nimport { EnableKeyboardGridAction, KeyboardGridCellSelectedAction } from '../keyboard-grid/action';\n\n/**\n * Handles the pointer used via grid to position new elements.\n */\nexport const keyboardControlModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureKeyboardControlTools(context);\n});\n\nexport function configureKeyboardControlTools(context: BindingContext): void {\n    bindAsService(context, TYPES.IDefaultTool, GlobalKeyListenerTool);\n    bindAsService(context, TYPES.IUIExtension, KeyboardPointer);\n    bindAsService(context, TYPES.IUIExtension, KeyboardGrid);\n    bindAsService(context, TYPES.IUIExtension, KeyboardNodeGrid);\n\n    configureActionHandler(context, TriggerNodeCreationAction.KIND, KeyboardPointer);\n    configureActionHandler(context, SetKeyboardPointerRenderPositionAction.KIND, KeyboardPointer);\n\n    bindAsService(context, TYPES.IUIExtension, EdgeAutocompletePalette);\n    bindAsService(context, TYPES.IDefaultTool, EdgeAutocompletePaletteTool);\n\n    configureActionHandler(context, EnableKeyboardGridAction.KIND, KeyboardGrid);\n    configureActionHandler(context, KeyboardGridCellSelectedAction.KIND, KeyboardPointer);\n\n    configureActionHandler(context, TriggerEdgeCreationAction.KIND, EdgeAutocompletePalette);\n    configureActionHandler(context, SetEdgeTargetSelectionAction.KIND, EdgeAutocompletePalette);\n\n    bindAsService(context, TYPES.IUIExtension, GridSearchPalette);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { toArray } from 'sprotty/lib/utils/iterable';\nimport { Bounds, GChildElement, Point, GModelElement, GModelRoot, GNode, TYPES, isBoundsAware, isSelectable } from '@eclipse-glsp/sprotty';\nimport { GLSPActionDispatcher } from '../../../base/action-dispatcher';\nimport { SelectableBoundsAware } from '../../../utils/gmodel-util';\nimport { ElementNavigator } from './element-navigator';\n\n@injectable()\nexport class PositionNavigator implements ElementNavigator {\n    @inject(TYPES.IActionDispatcher) protected readonly actionDispatcher: GLSPActionDispatcher;\n\n    previous(\n        root: Readonly<GModelRoot>,\n        current: SelectableBoundsAware,\n        previousCurrent?: SelectableBoundsAware,\n        predicate?: (element: GModelElement) => boolean\n    ): GModelElement | undefined {\n        return this.getNearestElement(root, current, e => this.bounds(root, e).x < this.bounds(root, current).x);\n    }\n\n    next(\n        root: Readonly<GModelRoot>,\n        current: SelectableBoundsAware,\n        previousCurrent?: SelectableBoundsAware,\n        predicate?: (element: GModelElement) => boolean\n    ): GModelElement | undefined {\n        return this.getNearestElement(root, current, e => this.bounds(root, e).x > this.bounds(root, current).x);\n    }\n\n    up(\n        root: Readonly<GModelRoot>,\n        current: SelectableBoundsAware,\n        previousCurrent?: SelectableBoundsAware,\n        predicate?: (element: GModelElement) => boolean\n    ): GModelElement | undefined {\n        return this.getNearestElement(root, current, e => this.bounds(root, e).y < this.bounds(root, current).y);\n    }\n\n    down(\n        root: Readonly<GModelRoot>,\n        current: SelectableBoundsAware,\n        previousCurrent?: SelectableBoundsAware,\n        predicate?: (element: GModelElement) => boolean\n    ): GModelElement | undefined {\n        return this.getNearestElement(root, current, e => this.bounds(root, e).y > this.bounds(root, current).y);\n    }\n\n    protected getNearestElement(\n        root: Readonly<GModelRoot>,\n        current: SelectableBoundsAware,\n        filter: (e: SelectableBoundsAware) => boolean\n    ): GModelElement | undefined {\n        const elements = this.boundElements(root).filter(filter);\n        return this.sortByDistance(root, current, elements)[0];\n    }\n\n    protected sortByDistance(root: GModelRoot, current: SelectableBoundsAware, elements: SelectableBoundsAware[]): SelectableBoundsAware[] {\n        // https://www.tutorialspoint.com/sort-array-of-points-by-ascending-distance-from-a-given-point-javascript\n        const distance = (coor1: Point, coor2: Point): number => {\n            const x = coor2.x - coor1.x;\n            const y = coor2.y - coor1.y;\n            return Math.sqrt(x * x + y * y);\n        };\n\n        return elements.sort(\n            (a, b) =>\n                distance(this.bounds(root, a), this.bounds(root, current)) - distance(this.bounds(root, b), this.bounds(root, current))\n        );\n    }\n\n    protected boundElements(root: Readonly<GModelRoot>): SelectableBoundsAware[] {\n        return toArray(root.index.all().filter(e => e instanceof GNode && isSelectable(e) && isBoundsAware(e))) as SelectableBoundsAware[];\n    }\n\n    protected bounds(root: Readonly<GModelRoot>, element: SelectableBoundsAware): Bounds {\n        return this.boundsInViewport(element, element.bounds, root);\n    }\n\n    protected boundsInViewport(element: GModelElement, bounds: Bounds, viewport: GModelRoot): Bounds {\n        if (element instanceof GChildElement && element.parent !== viewport) {\n            return this.boundsInViewport(element.parent, element.parent.localToParent(bounds) as Bounds, viewport);\n        } else {\n            return bounds;\n        }\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { BoundsAware, EdgeRouterRegistry, GConnectableElement, GModelElement, GModelRoot, TYPES } from '@eclipse-glsp/sprotty';\nimport { inject, injectable, optional } from 'inversify';\nimport { GLSPActionDispatcher } from '../../../base/action-dispatcher';\nimport { applyCssClasses, deleteCssClasses } from '../../../base/feedback/css-feedback';\nimport { SelectableBoundsAware } from '../../../utils/gmodel-util';\nimport { ElementNavigator } from './element-navigator';\nimport { GEdge } from '../../../model';\n\n@injectable()\nexport class LocalElementNavigator implements ElementNavigator {\n    navigableElementCSS = 'navigable-element';\n    @inject(EdgeRouterRegistry) @optional() readonly edgeRouterRegistry?: EdgeRouterRegistry;\n    @inject(TYPES.IActionDispatcher) protected readonly actionDispatcher: GLSPActionDispatcher;\n\n    previous(\n        root: Readonly<GModelRoot>,\n        current: SelectableBoundsAware,\n        previousCurrent?: SelectableBoundsAware,\n        predicate?: (element: GModelElement) => boolean\n    ): GModelElement | undefined {\n        return this.getPreviousElement(current, predicate);\n    }\n\n    next(\n        root: Readonly<GModelRoot>,\n        current: SelectableBoundsAware,\n        previousCurrent?: SelectableBoundsAware,\n        predicate?: (element: GModelElement) => boolean\n    ): GModelElement | undefined {\n        return this.getNextElement(current, predicate);\n    }\n\n    up(\n        root: Readonly<GModelRoot>,\n        current: SelectableBoundsAware,\n        previousCurrent?: SelectableBoundsAware,\n        predicate?: (element: GModelElement) => boolean\n    ): GModelElement | undefined {\n        return this.getIterable(current, previousCurrent, predicate);\n    }\n\n    down(\n        root: Readonly<GModelRoot>,\n        current: SelectableBoundsAware,\n        previousCurrent?: SelectableBoundsAware,\n        predicate?: (element: GModelElement) => boolean\n    ): GModelElement | undefined {\n        return this.getIterable(current, previousCurrent, predicate);\n    }\n\n    process(\n        root: Readonly<GModelRoot>,\n        current: SelectableBoundsAware,\n        target: SelectableBoundsAware,\n        previousCurrent?: SelectableBoundsAware,\n        predicate?: (element: GModelElement) => boolean\n    ): void {\n        let elements: GModelElement[] = [];\n\n        // Mark only edges\n        if (target instanceof GEdge) {\n            // If current is a edge, we have to check the source and target\n            if (current instanceof GEdge) {\n                elements = this.getIterables(target, current.source === target.source ? current.source : current.target, predicate);\n            } else {\n                // Otherwise take the current as it is\n                elements = this.getIterables(target, current, predicate);\n            }\n        }\n        elements.filter(e => e.id !== target.id).forEach(e => this.actionDispatcher.dispatch(applyCssClasses(e, this.navigableElementCSS)));\n    }\n\n    clean(root: Readonly<GModelRoot>, current?: SelectableBoundsAware, previousCurrent?: SelectableBoundsAware): void {\n        root.index.all().forEach(e => this.actionDispatcher.dispatch(deleteCssClasses(e, this.navigableElementCSS)));\n    }\n\n    protected getIterables(\n        current: SelectableBoundsAware,\n        previousCurrent?: GModelElement & BoundsAware,\n        predicate: (element: GModelElement) => boolean = () => true\n    ): GModelElement[] {\n        const elements: GModelElement[] = [];\n\n        if (current instanceof GEdge) {\n            if (current.target === previousCurrent) {\n                current.target?.incomingEdges.forEach(e => elements.push(e));\n            } else {\n                current.source?.outgoingEdges.forEach(e => elements.push(e));\n            }\n        }\n\n        return elements.filter(predicate);\n    }\n\n    protected getIterable(\n        current: SelectableBoundsAware,\n        previousCurrent?: SelectableBoundsAware,\n        predicate: (element: GModelElement) => boolean = () => true\n    ): GModelElement | undefined {\n        return this.getIterables(current, previousCurrent, predicate).filter(e => e.id !== current.id)[0];\n    }\n    protected getNextElement(\n        current: SelectableBoundsAware,\n        predicate: (element: GModelElement) => boolean = () => true\n    ): GModelElement | undefined {\n        const elements: GModelElement[] = [];\n\n        if (current instanceof GConnectableElement) {\n            current.outgoingEdges.forEach(e => elements.push(e));\n        } else if (current instanceof GEdge) {\n            const target = current.target as GModelElement;\n            elements.push(target);\n        }\n\n        return elements.filter(predicate)[0];\n    }\n\n    protected getPreviousElement(\n        current: SelectableBoundsAware,\n        predicate: (element: GModelElement) => boolean = () => true\n    ): GModelElement | undefined {\n        const elements: GModelElement[] = [];\n\n        if (current instanceof GConnectableElement) {\n            current.incomingEdges.forEach(e => elements.push(e));\n        } else if (current instanceof GEdge) {\n            const source = current.source as GModelElement;\n            elements.push(source);\n        }\n\n        return elements.filter(predicate)[0];\n    }\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { ContainerModule } from 'inversify';\nimport { BindingContext, TYPES, bindAsService } from '@eclipse-glsp/sprotty';\nimport { PositionNavigator } from './position-navigator';\nimport { LocalElementNavigator } from './local-element-navigator';\nimport { ElementNavigatorTool } from './diagram-navigation-tool';\nimport '../../../../css/navigation.css';\n\n/**\n * Handles element navigation actions.\n */\n\nexport const glspElementNavigationModule = new ContainerModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureElementNavigationTool(context);\n});\n\nexport function configureElementNavigationTool(context: BindingContext): void {\n    bindAsService(context, TYPES.IDefaultTool, ElementNavigatorTool);\n    bindAsService(context, TYPES.IElementNavigator, PositionNavigator);\n    bindAsService(context, TYPES.ILocalElementNavigator, LocalElementNavigator);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from 'inversify';\nimport { FocusTrackerTool } from './focus-tracker-tool';\nimport { BindingContext, TYPES, bindAsService } from '@eclipse-glsp/sprotty';\n\n/**\n * Handles actions for tracking the focus of the cursor.\n */\n\nexport const glspFocusTrackerModule = new ContainerModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureFocusTrackerTool(context);\n});\n\nexport function configureFocusTrackerTool(context: BindingContext): void {\n    bindAsService(context, TYPES.IDefaultTool, FocusTrackerTool);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { ContainerModule } from 'inversify';\nimport { bindAsService, BindingContext, configureActionHandler, TYPES } from '@eclipse-glsp/sprotty';\nimport '../../../../css/toast.css';\nimport { HideToastAction, ShowToastMessageAction } from './toast-handler';\nimport { Toast } from './toast-tool';\n\n/**\n * Handles toast/user notification actions.\n */\n\nexport const glspToastModule = new ContainerModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureToastTool(context);\n});\n\nexport function configureToastTool(context: BindingContext): void {\n    bindAsService(context, TYPES.IUIExtension, Toast);\n    context.bind(TYPES.IDiagramStartup).toService(Toast);\n    configureActionHandler(context, ShowToastMessageAction.KIND, Toast);\n    configureActionHandler(context, HideToastAction.KIND, Toast);\n}\n", "/********************************************************************************\n * Copyright (c) 2023 Business Informatics Group (TU Wien) and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { FeatureModule } from '@eclipse-glsp/sprotty';\nimport { configureShortcutHelpTool } from './key-shortcut/di.config';\nimport { configureMoveZoom } from './move-zoom/move-zoom-module';\nimport { configureResizeTools } from './resize-key-tool/resize-key-module';\nimport { configureSearchPaletteModule } from './search/search-palette-module';\nimport { configureViewKeyTools } from './view-key-tools/view-key-tools-module';\nimport { configureKeyboardToolPaletteTool } from './keyboard-tool-palette/keyboard-tool-palette-module';\nimport { configureKeyboardControlTools } from './keyboard-pointer/keyboard-pointer-module';\nimport { configureElementNavigationTool } from './element-navigation/element-navigation-module';\nimport { configureFocusTrackerTool } from './focus-tracker/focus-tracker-module';\nimport { configureToastTool } from './toast/toast-module';\n\n/**\n * Enables the accessibility tools for a keyboard-only-usage\n */\nexport const accessibilityModule = new FeatureModule((bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureResizeTools(context);\n    configureViewKeyTools(context);\n    configureMoveZoom(context);\n    configureSearchPaletteModule(context);\n    configureShortcutHelpTool(context);\n    configureKeyboardToolPaletteTool(context);\n    configureKeyboardControlTools(context);\n    configureElementNavigationTool(context);\n    configureFocusTrackerTool(context);\n    configureToastTool(context);\n});\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport * from '@eclipse-glsp/sprotty';\n\n// ------------------ Base ------------------\nexport * from './base/action-dispatcher';\nexport * from './base/action-handler-registry';\nexport * from './base/args-feature';\nexport * from './base/auto-complete/auto-complete-actions';\nexport * from './base/auto-complete/auto-complete-widget';\nexport * from './base/auto-complete/validation-decorator';\nexport * from './base/command-stack';\nexport * from './base/drag-aware-mouse-listener';\nexport * from './base/editor-context-service';\nexport * from './base/feedback/feedback-action-dispatcher';\nexport * from './base/feedback/feedback-command';\nexport * from './base/feedback/update-model-command';\nexport * from './base/focus/focus-state-change-action';\nexport * from './base/focus/focus-tracker';\nexport * from './base/model/diagram-loader';\nexport * from './base/model/glsp-model-source';\nexport * from './base/model/model-initialization-constraint';\nexport * from './base/model/model-registry';\nexport * from './base/ranked';\nexport * from './base/selection-clearing-mouse-listener';\nexport * from './base/selection-service';\nexport * from './base/tool-manager/tool';\nexport * from './base/tool-manager/tool-manager';\nexport * from './base/view/mouse-tool';\nexport * from './base/view/view-registry';\n\n// ------------------ Features ------------------\nexport * from './base/feedback/css-feedback';\nexport * from './base/view/mouse-tool';\nexport * from './features/accessibility/element-navigation/diagram-navigation-tool';\nexport * from './features/accessibility/focus-tracker/focus-tracker-tool';\nexport * from './features/accessibility/key-shortcut/accessible-key-shortcut-tool';\nexport * from './features/accessibility/resize-key-tool/resize-key-tool';\nexport * from './features/accessibility/toast/toast-tool';\nexport * from './features/accessibility/view-key-tools/deselect-key-tool';\nexport * from './features/accessibility/view-key-tools/movement-key-tool';\nexport * from './features/accessibility/view-key-tools/zoom-key-tool';\nexport * from './features/bounds/freeform-layout';\nexport * from './features/bounds/glsp-hidden-bounds-updater';\nexport * from './features/bounds/hbox-layout';\nexport * from './features/bounds/layouter';\nexport * from './features/bounds/vbox-layout';\nexport * from './features/change-bounds/model';\nexport * from './features/change-bounds/movement-restrictor';\nexport * from './features/change-bounds/snap';\nexport * from './features/command-palette/command-palette-tool';\nexport * from './features/command-palette/server-command-palette-provider';\nexport * from './features/context-menu/delete-element-context-menu';\nexport * from './features/context-menu/glsp-context-menu-mouse-listener';\nexport * from './features/context-menu/server-context-menu-provider';\nexport * from './features/copy-paste/copy-paste-context-menu';\nexport * from './features/copy-paste/copy-paste-handler';\nexport * from './features/decoration/decoration-placer';\nexport * from './features/export/glsp-svg-exporter';\nexport * from './features/hints/model';\nexport * from './features/hints/type-hint-provider';\nexport * from './features/hover/hover';\nexport * from './features/label-edit/edit-label-tool';\nexport * from './features/label-edit/edit-label-validator';\nexport * from './features/layout/layout-elements-action';\nexport * from './features/navigation/navigation-action-handler';\nexport * from './features/navigation/navigation-target-resolver';\nexport * from './features/reconnect/model';\nexport * from './features/routing/glsp-manhattan-edge-router';\nexport * from './features/save/save-keylistener';\nexport * from './features/select/select-feedback-command';\nexport * from './features/select/select-mouse-listener';\nexport * from './features/source-model-watcher/source-model-changed-action-handler';\nexport * from './features/status/status-overlay';\nexport * from './features/svg-metadata/metadata-placer';\nexport * from './features/tool-palette/tool-palette';\nexport * from './features/tools/base-tools';\nexport * from './features/tools/change-bounds/change-bounds-tool';\nexport * from './features/tools/change-bounds/change-bounds-tool-feedback';\nexport * from './features/tools/change-bounds/view';\nexport * from './features/tools/deletion/delete-tool';\nexport * from './features/tools/edge-creation/edge-creation-tool';\nexport * from './features/tools/edge-creation/edge-creation-tool-feedback';\nexport * from './features/tools/edge-creation/view';\nexport * from './features/tools/edge-edit/edge-edit-tool';\nexport * from './features/tools/edge-edit/edge-edit-tool-feedback';\nexport * from './features/tools/marquee-selection/marquee-behavior';\nexport * from './features/tools/marquee-selection/marquee-mouse-tool';\nexport * from './features/tools/marquee-selection/marquee-tool';\nexport * from './features/tools/marquee-selection/marquee-tool-feedback';\nexport * from './features/tools/marquee-selection/model';\nexport * from './features/tools/marquee-selection/view';\nexport * from './features/tools/node-creation/node-creation-tool';\nexport * from './features/undo-redo/undo-redo-key-listener';\nexport * from './features/validation/issue-marker';\nexport * from './features/validation/marker-navigator';\nexport * from './features/validation/validate';\nexport * from './features/viewport/glsp-scroll-mouse-listener';\n\n// ------------------ Misc ------------------\nexport * from './default-modules';\nexport * from './model';\nexport * from './standalone-modules';\nexport * from './utils/argument-utils';\nexport * from './utils/gmodel-util';\nexport * from './utils/html-utils';\nexport * from './utils/layout-utils';\nexport * from './utils/marker';\nexport * from './utils/viewpoint-util';\nexport * from './views';\n// ------------------ DI Modules ------------------\nexport * from './base/default.module';\nexport * from './features/accessibility/accessibility-module';\nexport * from './features/accessibility/element-navigation/element-navigation-module';\nexport * from './features/accessibility/focus-tracker/focus-tracker-module';\nexport * from './features/accessibility/move-zoom/move-zoom-module';\nexport * from './features/accessibility/resize-key-tool/resize-key-module';\nexport * from './features/accessibility/search/search-palette-module';\nexport * from './features/accessibility/toast/toast-module';\nexport * from './features/accessibility/view-key-tools/view-key-tools-module';\nexport * from './features/command-palette/command-palette-module';\nexport * from './features/context-menu/context-menu-module';\nexport * from './features/copy-paste/copy-paste-modules';\nexport * from './features/decoration/decoration-module';\nexport * from './features/export/export-modules';\nexport * from './features/hints/type-hints-module';\nexport * from './features/hover/hover-module';\nexport * from './features/label-edit/label-edit-module';\nexport * from './features/layout/layout-module';\nexport * from './features/navigation/navigation-module';\nexport * from './features/routing/routing-module';\nexport * from './features/save/save-module';\nexport * from './features/select/select-module';\nexport * from './features/source-model-watcher/source-model-wacher-module';\nexport * from './features/status/status-module';\nexport * from './features/svg-metadata/svg-metadata-module';\nexport * from './features/tool-palette/tool-palette-module';\nexport * from './features/tools/change-bounds/change-boounds-tool-module';\nexport * from './features/tools/deletion/deletion-tool-module';\nexport * from './features/tools/edge-creation/edege-creation-module';\nexport * from './features/tools/edge-edit/edge-edit-module';\nexport * from './features/tools/marquee-selection/marquee-selection-module';\nexport * from './features/tools/node-creation/node-creation-module';\nexport * from './features/tools/tool-focus-loss-module';\nexport * from './features/undo-redo/undo-redo-module';\nexport * from './features/validation/validation-modules';\nexport * from './features/viewport/viewport-modules';\n", "/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar Reflect;\n(function (Reflect) {\n    // Metadata Proposal\n    // https://rbuckton.github.io/reflect-metadata/\n    (function (factory) {\n        var root = typeof global === \"object\" ? global :\n            typeof self === \"object\" ? self :\n                typeof this === \"object\" ? this :\n                    Function(\"return this;\")();\n        var exporter = makeExporter(Reflect);\n        if (typeof root.Reflect === \"undefined\") {\n            root.Reflect = Reflect;\n        }\n        else {\n            exporter = makeExporter(root.Reflect, exporter);\n        }\n        factory(exporter);\n        function makeExporter(target, previous) {\n            return function (key, value) {\n                if (typeof target[key] !== \"function\") {\n                    Object.defineProperty(target, key, { configurable: true, writable: true, value: value });\n                }\n                if (previous)\n                    previous(key, value);\n            };\n        }\n    })(function (exporter) {\n        var hasOwn = Object.prototype.hasOwnProperty;\n        // feature test for Symbol support\n        var supportsSymbol = typeof Symbol === \"function\";\n        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== \"undefined\" ? Symbol.toPrimitive : \"@@toPrimitive\";\n        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== \"undefined\" ? Symbol.iterator : \"@@iterator\";\n        var supportsCreate = typeof Object.create === \"function\"; // feature test for Object.create support\n        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support\n        var downLevel = !supportsCreate && !supportsProto;\n        var HashMap = {\n            // create an object in dictionary mode (a.k.a. \"slow\" mode in v8)\n            create: supportsCreate\n                ? function () { return MakeDictionary(Object.create(null)); }\n                : supportsProto\n                    ? function () { return MakeDictionary({ __proto__: null }); }\n                    : function () { return MakeDictionary({}); },\n            has: downLevel\n                ? function (map, key) { return hasOwn.call(map, key); }\n                : function (map, key) { return key in map; },\n            get: downLevel\n                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }\n                : function (map, key) { return map[key]; },\n        };\n        // Load global or shim versions of Map, Set, and WeakMap\n        var functionPrototype = Object.getPrototypeOf(Function);\n        var usePolyfill = typeof process === \"object\" && process.env && process.env[\"REFLECT_METADATA_USE_MAP_POLYFILL\"] === \"true\";\n        var _Map = !usePolyfill && typeof Map === \"function\" && typeof Map.prototype.entries === \"function\" ? Map : CreateMapPolyfill();\n        var _Set = !usePolyfill && typeof Set === \"function\" && typeof Set.prototype.entries === \"function\" ? Set : CreateSetPolyfill();\n        var _WeakMap = !usePolyfill && typeof WeakMap === \"function\" ? WeakMap : CreateWeakMapPolyfill();\n        // [[Metadata]] internal slot\n        // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots\n        var Metadata = new _WeakMap();\n        /**\n         * Applies a set of decorators to a property of a target object.\n         * @param decorators An array of decorators.\n         * @param target The target object.\n         * @param propertyKey (Optional) The property key to decorate.\n         * @param attributes (Optional) The property descriptor for the target key.\n         * @remarks Decorators are applied in reverse order.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Example = Reflect.decorate(decoratorsArray, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.decorate(decoratorsArray, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.decorate(decoratorsArray, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Object.defineProperty(Example, \"staticMethod\",\n         *         Reflect.decorate(decoratorsArray, Example, \"staticMethod\",\n         *             Object.getOwnPropertyDescriptor(Example, \"staticMethod\")));\n         *\n         *     // method (on prototype)\n         *     Object.defineProperty(Example.prototype, \"method\",\n         *         Reflect.decorate(decoratorsArray, Example.prototype, \"method\",\n         *             Object.getOwnPropertyDescriptor(Example.prototype, \"method\")));\n         *\n         */\n        function decorate(decorators, target, propertyKey, attributes) {\n            if (!IsUndefined(propertyKey)) {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))\n                    throw new TypeError();\n                if (IsNull(attributes))\n                    attributes = undefined;\n                propertyKey = ToPropertyKey(propertyKey);\n                return DecorateProperty(decorators, target, propertyKey, attributes);\n            }\n            else {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsConstructor(target))\n                    throw new TypeError();\n                return DecorateConstructor(decorators, target);\n            }\n        }\n        exporter(\"decorate\", decorate);\n        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n        /**\n         * A default metadata decorator factory that can be used on a class, class member, or parameter.\n         * @param metadataKey The key for the metadata entry.\n         * @param metadataValue The value for the metadata entry.\n         * @returns A decorator function.\n         * @remarks\n         * If `metadataKey` is already defined for the target and target key, the\n         * metadataValue for that key will be overwritten.\n         * @example\n         *\n         *     // constructor\n         *     @Reflect.metadata(key, value)\n         *     class Example {\n         *     }\n         *\n         *     // property (on constructor, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticProperty;\n         *     }\n         *\n         *     // property (on prototype, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         property;\n         *     }\n         *\n         *     // method (on constructor)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticMethod() { }\n         *     }\n         *\n         *     // method (on prototype)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         method() { }\n         *     }\n         *\n         */\n        function metadata(metadataKey, metadataValue) {\n            function decorator(target, propertyKey) {\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))\n                    throw new TypeError();\n                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n            }\n            return decorator;\n        }\n        exporter(\"metadata\", metadata);\n        /**\n         * Define a unique metadata entry on the target.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param metadataValue A value that contains attached metadata.\n         * @param target The target object on which to define metadata.\n         * @param propertyKey (Optional) The property key for the target.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"method\");\n         *\n         *     // decorator factory as metadata-producing annotation.\n         *     function MyAnnotation(options): Decorator {\n         *         return (target, key?) => Reflect.defineMetadata(\"custom:annotation\", options, target, key);\n         *     }\n         *\n         */\n        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n        }\n        exporter(\"defineMetadata\", defineMetadata);\n        /**\n         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasMetadata\", hasMetadata);\n        /**\n         * Gets a value indicating whether the target object has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasOwnMetadata\", hasOwnMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getMetadata\", getMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getOwnMetadata\", getOwnMetadata);\n        /**\n         * Gets the metadata keys defined on the target object or its prototype chain.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getMetadataKeys\", getMetadataKeys);\n        /**\n         * Gets the unique metadata keys defined on the target object.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryOwnMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getOwnMetadataKeys\", getOwnMetadataKeys);\n        /**\n         * Deletes the metadata entry from the target object with the provided key.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function deleteMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            var metadataMap = GetOrCreateMetadataMap(target, propertyKey, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            if (!metadataMap.delete(metadataKey))\n                return false;\n            if (metadataMap.size > 0)\n                return true;\n            var targetMetadata = Metadata.get(target);\n            targetMetadata.delete(propertyKey);\n            if (targetMetadata.size > 0)\n                return true;\n            Metadata.delete(target);\n            return true;\n        }\n        exporter(\"deleteMetadata\", deleteMetadata);\n        function DecorateConstructor(decorators, target) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsConstructor(decorated))\n                        throw new TypeError();\n                    target = decorated;\n                }\n            }\n            return target;\n        }\n        function DecorateProperty(decorators, target, propertyKey, descriptor) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target, propertyKey, descriptor);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsObject(decorated))\n                        throw new TypeError();\n                    descriptor = decorated;\n                }\n            }\n            return descriptor;\n        }\n        function GetOrCreateMetadataMap(O, P, Create) {\n            var targetMetadata = Metadata.get(O);\n            if (IsUndefined(targetMetadata)) {\n                if (!Create)\n                    return undefined;\n                targetMetadata = new _Map();\n                Metadata.set(O, targetMetadata);\n            }\n            var metadataMap = targetMetadata.get(P);\n            if (IsUndefined(metadataMap)) {\n                if (!Create)\n                    return undefined;\n                metadataMap = new _Map();\n                targetMetadata.set(P, metadataMap);\n            }\n            return metadataMap;\n        }\n        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\n        function OrdinaryHasMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return true;\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryHasMetadata(MetadataKey, parent, P);\n            return false;\n        }\n        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            return ToBoolean(metadataMap.has(MetadataKey));\n        }\n        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\n        function OrdinaryGetMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryGetMetadata(MetadataKey, parent, P);\n            return undefined;\n        }\n        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return undefined;\n            return metadataMap.get(MetadataKey);\n        }\n        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);\n            metadataMap.set(MetadataKey, MetadataValue);\n        }\n        // 3.1.6.1 OrdinaryMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\n        function OrdinaryMetadataKeys(O, P) {\n            var ownKeys = OrdinaryOwnMetadataKeys(O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (parent === null)\n                return ownKeys;\n            var parentKeys = OrdinaryMetadataKeys(parent, P);\n            if (parentKeys.length <= 0)\n                return ownKeys;\n            if (ownKeys.length <= 0)\n                return parentKeys;\n            var set = new _Set();\n            var keys = [];\n            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {\n                var key = ownKeys_1[_i];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {\n                var key = parentKeys_1[_a];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n        function OrdinaryOwnMetadataKeys(O, P) {\n            var keys = [];\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return keys;\n            var keysObj = metadataMap.keys();\n            var iterator = GetIterator(keysObj);\n            var k = 0;\n            while (true) {\n                var next = IteratorStep(iterator);\n                if (!next) {\n                    keys.length = k;\n                    return keys;\n                }\n                var nextValue = IteratorValue(next);\n                try {\n                    keys[k] = nextValue;\n                }\n                catch (e) {\n                    try {\n                        IteratorClose(iterator);\n                    }\n                    finally {\n                        throw e;\n                    }\n                }\n                k++;\n            }\n        }\n        // 6 ECMAScript Data Typ0es and Values\n        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values\n        function Type(x) {\n            if (x === null)\n                return 1 /* Null */;\n            switch (typeof x) {\n                case \"undefined\": return 0 /* Undefined */;\n                case \"boolean\": return 2 /* Boolean */;\n                case \"string\": return 3 /* String */;\n                case \"symbol\": return 4 /* Symbol */;\n                case \"number\": return 5 /* Number */;\n                case \"object\": return x === null ? 1 /* Null */ : 6 /* Object */;\n                default: return 6 /* Object */;\n            }\n        }\n        // 6.1.1 The Undefined Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type\n        function IsUndefined(x) {\n            return x === undefined;\n        }\n        // 6.1.2 The Null Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type\n        function IsNull(x) {\n            return x === null;\n        }\n        // 6.1.5 The Symbol Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type\n        function IsSymbol(x) {\n            return typeof x === \"symbol\";\n        }\n        // 6.1.7 The Object Type\n        // https://tc39.github.io/ecma262/#sec-object-type\n        function IsObject(x) {\n            return typeof x === \"object\" ? x !== null : typeof x === \"function\";\n        }\n        // 7.1 Type Conversion\n        // https://tc39.github.io/ecma262/#sec-type-conversion\n        // 7.1.1 ToPrimitive(input [, PreferredType])\n        // https://tc39.github.io/ecma262/#sec-toprimitive\n        function ToPrimitive(input, PreferredType) {\n            switch (Type(input)) {\n                case 0 /* Undefined */: return input;\n                case 1 /* Null */: return input;\n                case 2 /* Boolean */: return input;\n                case 3 /* String */: return input;\n                case 4 /* Symbol */: return input;\n                case 5 /* Number */: return input;\n            }\n            var hint = PreferredType === 3 /* String */ ? \"string\" : PreferredType === 5 /* Number */ ? \"number\" : \"default\";\n            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);\n            if (exoticToPrim !== undefined) {\n                var result = exoticToPrim.call(input, hint);\n                if (IsObject(result))\n                    throw new TypeError();\n                return result;\n            }\n            return OrdinaryToPrimitive(input, hint === \"default\" ? \"number\" : hint);\n        }\n        // 7.1.1.1 OrdinaryToPrimitive(O, hint)\n        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive\n        function OrdinaryToPrimitive(O, hint) {\n            if (hint === \"string\") {\n                var toString_1 = O.toString;\n                if (IsCallable(toString_1)) {\n                    var result = toString_1.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            else {\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var toString_2 = O.toString;\n                if (IsCallable(toString_2)) {\n                    var result = toString_2.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            throw new TypeError();\n        }\n        // 7.1.2 ToBoolean(argument)\n        // https://tc39.github.io/ecma262/2016/#sec-toboolean\n        function ToBoolean(argument) {\n            return !!argument;\n        }\n        // 7.1.12 ToString(argument)\n        // https://tc39.github.io/ecma262/#sec-tostring\n        function ToString(argument) {\n            return \"\" + argument;\n        }\n        // 7.1.14 ToPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-topropertykey\n        function ToPropertyKey(argument) {\n            var key = ToPrimitive(argument, 3 /* String */);\n            if (IsSymbol(key))\n                return key;\n            return ToString(key);\n        }\n        // 7.2 Testing and Comparison Operations\n        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations\n        // 7.2.2 IsArray(argument)\n        // https://tc39.github.io/ecma262/#sec-isarray\n        function IsArray(argument) {\n            return Array.isArray\n                ? Array.isArray(argument)\n                : argument instanceof Object\n                    ? argument instanceof Array\n                    : Object.prototype.toString.call(argument) === \"[object Array]\";\n        }\n        // 7.2.3 IsCallable(argument)\n        // https://tc39.github.io/ecma262/#sec-iscallable\n        function IsCallable(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.4 IsConstructor(argument)\n        // https://tc39.github.io/ecma262/#sec-isconstructor\n        function IsConstructor(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.7 IsPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-ispropertykey\n        function IsPropertyKey(argument) {\n            switch (Type(argument)) {\n                case 3 /* String */: return true;\n                case 4 /* Symbol */: return true;\n                default: return false;\n            }\n        }\n        // 7.3 Operations on Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-objects\n        // 7.3.9 GetMethod(V, P)\n        // https://tc39.github.io/ecma262/#sec-getmethod\n        function GetMethod(V, P) {\n            var func = V[P];\n            if (func === undefined || func === null)\n                return undefined;\n            if (!IsCallable(func))\n                throw new TypeError();\n            return func;\n        }\n        // 7.4 Operations on Iterator Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects\n        function GetIterator(obj) {\n            var method = GetMethod(obj, iteratorSymbol);\n            if (!IsCallable(method))\n                throw new TypeError(); // from Call\n            var iterator = method.call(obj);\n            if (!IsObject(iterator))\n                throw new TypeError();\n            return iterator;\n        }\n        // 7.4.4 IteratorValue(iterResult)\n        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue\n        function IteratorValue(iterResult) {\n            return iterResult.value;\n        }\n        // 7.4.5 IteratorStep(iterator)\n        // https://tc39.github.io/ecma262/#sec-iteratorstep\n        function IteratorStep(iterator) {\n            var result = iterator.next();\n            return result.done ? false : result;\n        }\n        // 7.4.6 IteratorClose(iterator, completion)\n        // https://tc39.github.io/ecma262/#sec-iteratorclose\n        function IteratorClose(iterator) {\n            var f = iterator[\"return\"];\n            if (f)\n                f.call(iterator);\n        }\n        // 9.1 Ordinary Object Internal Methods and Internal Slots\n        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots\n        // 9.1.1.1 OrdinaryGetPrototypeOf(O)\n        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof\n        function OrdinaryGetPrototypeOf(O) {\n            var proto = Object.getPrototypeOf(O);\n            if (typeof O !== \"function\" || O === functionPrototype)\n                return proto;\n            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.\n            // Try to determine the superclass constructor. Compatible implementations\n            // must either set __proto__ on a subclass constructor to the superclass constructor,\n            // or ensure each class has a valid `constructor` property on its prototype that\n            // points back to the constructor.\n            // If this is not the same as Function.[[Prototype]], then this is definately inherited.\n            // This is the case when in ES6 or when using __proto__ in a compatible browser.\n            if (proto !== functionPrototype)\n                return proto;\n            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.\n            var prototype = O.prototype;\n            var prototypeProto = prototype && Object.getPrototypeOf(prototype);\n            if (prototypeProto == null || prototypeProto === Object.prototype)\n                return proto;\n            // If the constructor was not a function, then we cannot determine the heritage.\n            var constructor = prototypeProto.constructor;\n            if (typeof constructor !== \"function\")\n                return proto;\n            // If we have some kind of self-reference, then we cannot determine the heritage.\n            if (constructor === O)\n                return proto;\n            // we have a pretty good guess at the heritage.\n            return constructor;\n        }\n        // naive Map shim\n        function CreateMapPolyfill() {\n            var cacheSentinel = {};\n            var arraySentinel = [];\n            var MapIterator = /** @class */ (function () {\n                function MapIterator(keys, values, selector) {\n                    this._index = 0;\n                    this._keys = keys;\n                    this._values = values;\n                    this._selector = selector;\n                }\n                MapIterator.prototype[\"@@iterator\"] = function () { return this; };\n                MapIterator.prototype[iteratorSymbol] = function () { return this; };\n                MapIterator.prototype.next = function () {\n                    var index = this._index;\n                    if (index >= 0 && index < this._keys.length) {\n                        var result = this._selector(this._keys[index], this._values[index]);\n                        if (index + 1 >= this._keys.length) {\n                            this._index = -1;\n                            this._keys = arraySentinel;\n                            this._values = arraySentinel;\n                        }\n                        else {\n                            this._index++;\n                        }\n                        return { value: result, done: false };\n                    }\n                    return { value: undefined, done: true };\n                };\n                MapIterator.prototype.throw = function (error) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    throw error;\n                };\n                MapIterator.prototype.return = function (value) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    return { value: value, done: true };\n                };\n                return MapIterator;\n            }());\n            return /** @class */ (function () {\n                function Map() {\n                    this._keys = [];\n                    this._values = [];\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                }\n                Object.defineProperty(Map.prototype, \"size\", {\n                    get: function () { return this._keys.length; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };\n                Map.prototype.get = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    return index >= 0 ? this._values[index] : undefined;\n                };\n                Map.prototype.set = function (key, value) {\n                    var index = this._find(key, /*insert*/ true);\n                    this._values[index] = value;\n                    return this;\n                };\n                Map.prototype.delete = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    if (index >= 0) {\n                        var size = this._keys.length;\n                        for (var i = index + 1; i < size; i++) {\n                            this._keys[i - 1] = this._keys[i];\n                            this._values[i - 1] = this._values[i];\n                        }\n                        this._keys.length--;\n                        this._values.length--;\n                        if (key === this._cacheKey) {\n                            this._cacheKey = cacheSentinel;\n                            this._cacheIndex = -2;\n                        }\n                        return true;\n                    }\n                    return false;\n                };\n                Map.prototype.clear = function () {\n                    this._keys.length = 0;\n                    this._values.length = 0;\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                };\n                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };\n                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };\n                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };\n                Map.prototype[\"@@iterator\"] = function () { return this.entries(); };\n                Map.prototype[iteratorSymbol] = function () { return this.entries(); };\n                Map.prototype._find = function (key, insert) {\n                    if (this._cacheKey !== key) {\n                        this._cacheIndex = this._keys.indexOf(this._cacheKey = key);\n                    }\n                    if (this._cacheIndex < 0 && insert) {\n                        this._cacheIndex = this._keys.length;\n                        this._keys.push(key);\n                        this._values.push(undefined);\n                    }\n                    return this._cacheIndex;\n                };\n                return Map;\n            }());\n            function getKey(key, _) {\n                return key;\n            }\n            function getValue(_, value) {\n                return value;\n            }\n            function getEntry(key, value) {\n                return [key, value];\n            }\n        }\n        // naive Set shim\n        function CreateSetPolyfill() {\n            return /** @class */ (function () {\n                function Set() {\n                    this._map = new _Map();\n                }\n                Object.defineProperty(Set.prototype, \"size\", {\n                    get: function () { return this._map.size; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Set.prototype.has = function (value) { return this._map.has(value); };\n                Set.prototype.add = function (value) { return this._map.set(value, value), this; };\n                Set.prototype.delete = function (value) { return this._map.delete(value); };\n                Set.prototype.clear = function () { this._map.clear(); };\n                Set.prototype.keys = function () { return this._map.keys(); };\n                Set.prototype.values = function () { return this._map.values(); };\n                Set.prototype.entries = function () { return this._map.entries(); };\n                Set.prototype[\"@@iterator\"] = function () { return this.keys(); };\n                Set.prototype[iteratorSymbol] = function () { return this.keys(); };\n                return Set;\n            }());\n        }\n        // naive WeakMap shim\n        function CreateWeakMapPolyfill() {\n            var UUID_SIZE = 16;\n            var keys = HashMap.create();\n            var rootKey = CreateUniqueKey();\n            return /** @class */ (function () {\n                function WeakMap() {\n                    this._key = CreateUniqueKey();\n                }\n                WeakMap.prototype.has = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.has(table, this._key) : false;\n                };\n                WeakMap.prototype.get = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.get(table, this._key) : undefined;\n                };\n                WeakMap.prototype.set = function (target, value) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);\n                    table[this._key] = value;\n                    return this;\n                };\n                WeakMap.prototype.delete = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? delete table[this._key] : false;\n                };\n                WeakMap.prototype.clear = function () {\n                    // NOTE: not a real clear, just makes the previous data unreachable\n                    this._key = CreateUniqueKey();\n                };\n                return WeakMap;\n            }());\n            function CreateUniqueKey() {\n                var key;\n                do\n                    key = \"@@WeakMap@@\" + CreateUUID();\n                while (HashMap.has(keys, key));\n                keys[key] = true;\n                return key;\n            }\n            function GetOrCreateWeakMapTable(target, create) {\n                if (!hasOwn.call(target, rootKey)) {\n                    if (!create)\n                        return undefined;\n                    Object.defineProperty(target, rootKey, { value: HashMap.create() });\n                }\n                return target[rootKey];\n            }\n            function FillRandomBytes(buffer, size) {\n                for (var i = 0; i < size; ++i)\n                    buffer[i] = Math.random() * 0xff | 0;\n                return buffer;\n            }\n            function GenRandomBytes(size) {\n                if (typeof Uint8Array === \"function\") {\n                    if (typeof crypto !== \"undefined\")\n                        return crypto.getRandomValues(new Uint8Array(size));\n                    if (typeof msCrypto !== \"undefined\")\n                        return msCrypto.getRandomValues(new Uint8Array(size));\n                    return FillRandomBytes(new Uint8Array(size), size);\n                }\n                return FillRandomBytes(new Array(size), size);\n            }\n            function CreateUUID() {\n                var data = GenRandomBytes(UUID_SIZE);\n                // mark as random - RFC 4122 \u00A7 4.4\n                data[6] = data[6] & 0x4f | 0x40;\n                data[8] = data[8] & 0xbf | 0x80;\n                var result = \"\";\n                for (var offset = 0; offset < UUID_SIZE; ++offset) {\n                    var byte = data[offset];\n                    if (offset === 4 || offset === 6 || offset === 8)\n                        result += \"-\";\n                    if (byte < 16)\n                        result += \"0\";\n                    result += byte.toString(16).toLowerCase();\n                }\n                return result;\n            }\n        }\n        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.\n        function MakeDictionary(obj) {\n            obj.__ = undefined;\n            delete obj.__;\n            return obj;\n        }\n    });\n})(Reflect || (Reflect = {}));\n", "import \"reflect-metadata\";\nimport { LocalModelSource, TYPES } from \"sprotty\";\nimport { createContainer } from \"./di.config\";\n\nexport default function run() {\n  const container = createContainer(\"sprotty-container\");\n  const modelSource = container.get<LocalModelSource>(TYPES.ModelSource);\n  modelSource.updateModel();\n\n  let btnExport = document.getElementsByClassName(\"btnExport\")?.item(0);\n  btnExport.addEventListener(\"click\", async (e: PointerEvent) => {\n    let str = JSON.stringify(modelSource.model, null, \" \");\n    console.log(str);\n    alert(str);\n  });\n\n  let btnUpdate = document.getElementsByClassName(\"btnUpdate\")?.item(0);\n  btnUpdate.addEventListener(\"click\", async (e: PointerEvent) => {\n    modelSource.updateModel();\n  });\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => run());\n", "import { Container, ContainerModule } from \"inversify\";\nimport {\n  configureModelElement,\n  configureViewerOptions,\n  connectableFeature,\n  ConsoleLogger,\n  edgeIntersectionModule,\n  editLabelFeature,\n  expandModule,\n  fadeModule,\n  hoverFeedbackFeature,\n  layoutableChildFeature,\n  loadDefaultModules,\n  LogLevel,\n  PolylineEdgeView,\n  popupFeature,\n  SCompartmentImpl,\n  SCompartmentView,\n  SEdgeImpl,\n  SGraphImpl,\n  SGraphView,\n  SLabelImpl,\n  SLabelView,\n  SPortImpl,\n  SRoutingHandleImpl,\n  SRoutingHandleView,\n} from \"sprotty\";\nimport {\n  Node4diacView,\n  PortViewWithExternalLabel,\n  WorkflowEdgeView,\n} from \"./views\";\nimport { Node4diac } from \"./models\";\nimport { ClassDiagramModelSource } from \"./model-source\";\nimport creatingEdgeModule from \"./features/creatingEdge/di.config\";\nimport { creatingEdgeFeature } from \"./features/creatingEdge/model\";\nimport creatingNodesModule from \"./features/creatingNodes/di.config\";\nimport { DefaultTypes, GEdge, TYPES } from \"@eclipse-glsp/client\";\n\nexport const createContainer = (containerId: string) => {\n  const myModule = new ContainerModule((bind, unbind, isBound, rebind) => {\n    bind(TYPES.ModelSource).to(ClassDiagramModelSource).inSingletonScope();\n    rebind(TYPES.ILogger).to(ConsoleLogger).inSingletonScope();\n    rebind(TYPES.LogLevel).toConstantValue(LogLevel.log);\n\n    const context = { bind, unbind, isBound, rebind };\n    configureModelElement(context, \"graph\", SGraphImpl, SGraphView);\n\n    configureModelElement(context, \"node4diac\", Node4diac, Node4diacView, {\n      // enable: [withEditLabelFeature, layoutableChildFeature], // \u043F\u043B\u044E\u0441\u0443\u044E\u0442\u0441\u044F \u043A SNodeImpl.DEFAULT_FEATURES\n      disable: [hoverFeedbackFeature, popupFeature, connectableFeature],\n    });\n\n    // \u0422\u0430\u0439\u0442\u043B \u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0443\u0435\u043C\u044B\u0439\n    configureModelElement(context, \"node4diac:title\", SLabelImpl, SLabelView, {\n      enable: [editLabelFeature],\n    });\n\n    configureModelElement(\n      context,\n      \"node4diac:inputs\",\n      SCompartmentImpl,\n      SCompartmentView\n    );\n\n    configureModelElement(\n      context,\n      \"node4diac:port\",\n      SPortImpl,\n      PortViewWithExternalLabel,\n      {\n        enable: [layoutableChildFeature, creatingEdgeFeature],\n        disable: [hoverFeedbackFeature, popupFeature],\n      }\n    );\n\n    // \u0413\u0440\u0430\u043D\u044C\n    configureModelElement(\n      context,\n      \"edge:straight\",\n      SEdgeImpl,\n      PolylineEdgeView\n    );\n\n    configureModelElement(\n      context,\n      \"node4diac:port_title\",\n      SLabelImpl,\n      SLabelView\n    );\n\n    configureModelElement(context, DefaultTypes.EDGE, GEdge, WorkflowEdgeView);\n\n    configureViewerOptions(context, {\n      needsClientLayout: true,\n      baseDiv: containerId,\n    });\n\n    configureModelElement(\n      context,\n      \"routing-point\",\n      SRoutingHandleImpl,\n      SRoutingHandleView\n    );\n    configureModelElement(\n      context,\n      \"volatile-routing-point\",\n      SRoutingHandleImpl,\n      SRoutingHandleView\n    );\n    // configureModelElement(\n    //   context,\n    //   \"bezier-create-routing-point\",\n    //   SRoutingHandleImpl,\n    //   SBezierCreateHandleView\n    // );\n    // configureModelElement(\n    //   context,\n    //   \"bezier-remove-routing-point\",\n    //   SRoutingHandleImpl,\n    //   SBezierCreateHandleView\n    // );\n    // configureModelElement(\n    //   context,\n    //   \"bezier-routing-point\",\n    //   SRoutingHandleImpl,\n    //   SBezierControlHandleView\n    // );\n  });\n\n  const container = new Container();\n  loadDefaultModules(container, { exclude: [expandModule, fadeModule] });\n  container.load(\n    myModule,\n    edgeIntersectionModule,\n    creatingEdgeModule,\n    creatingNodesModule\n  );\n  return container;\n};\n", "/** @jsx svg */\nimport { svg } from 'sprotty/lib/lib/jsx';\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { ATTR_BBOX_ELEMENT, IViewArgs, PolylineEdgeViewWithGapsOnIntersections, RenderingContext, SNodeImpl, SPortImpl, ShapeView, setAttr } from 'sprotty';\nimport { Point, angleOfPoint, toDegrees } from 'sprotty-protocol';\nimport { GEdge, getSubType } from '@eclipse-glsp/client';\n\n@injectable()\nexport class Node4diacView extends ShapeView {\n    override render(node: Readonly<SNodeImpl>, context: RenderingContext, args?: IViewArgs): VNode | undefined {\n        if (!this.isVisible(node, context)) {\n            return undefined;\n        }\n        let d = 20\n        let path = `M 0 0 H${node.size.width} v${d} h${-d} v${d} h${d} V ${node.size.height} H0 V${d*2} h${d} v${-d} h${-d} Z`;\n        return <g class-b4diac={true}>\n                  <path d={path} fill=\"transparent\" />\n            {context.renderChildren(node)}\n        </g>;\n    }\n}\n\n@injectable()\nexport class PortViewWithExternalLabel extends ShapeView {\n    render(node: Readonly<SPortImpl>, context: RenderingContext): VNode | undefined {\n        if (!this.isVisible(node, context)) {\n            return undefined;\n        }\n        const bboxElement = <rect\n            class-sprotty-port={true}\n            class-mouseover={node.hoverFeedback} class-selected={node.selected}\n            x=\"0\" y=\"0\" width={Math.max(node.size.width, 0)} height={Math.max(node.size.height, 0)}>\n        </rect>;\n        // setAttr(bboxElement, ATTR_BBOX_ELEMENT, true);\n        return <g>\n            {bboxElement}\n            {context.renderChildren(node)}\n        </g>;\n    }\n}\n\n@injectable()\nexport class WorkflowEdgeView extends PolylineEdgeViewWithGapsOnIntersections {\n    protected override renderAdditionals(edge: GEdge, segments: Point[], context: RenderingContext): VNode[] {\n        const additionals = super.renderAdditionals(edge, segments, context);\n        const p1 = segments[segments.length - 2];\n        const p2 = segments[segments.length - 1];\n        const arrow = (\n            <path\n                class-sprotty-edge={true}\n                class-arrow={true}\n                d='M 1,0 L 10,-4 L 10,4 Z'\n                transform={`rotate(${toDegrees(angleOfPoint({ x: p1.x - p2.x, y: p1.y - p2.y }))} ${p2.x} ${p2.y}) translate(${p2.x} ${\n                    p2.y\n                })`}\n            />\n        );\n        additionals.push(arrow);\n        return additionals;\n    }\n}\n\n\n\n\n", "import { RectangularNode } from \"sprotty\";\n\nexport class Node4diac extends RectangularNode {}\n", "import {\n  SGraph,\n  SNode,\n  SCompartment,\n  SLabel,\n  SPort,\n  Action,\n} from \"sprotty-protocol\";\nimport {\n  ActionHandlerRegistry,\n  LocalModelSource,\n  createRandomId,\n} from \"sprotty\";\nimport { injectable } from \"inversify\";\nimport {\n  CreatingFbAction,\n  CreatingInpAction,\n} from \"./features/creatingNodes/creatingNodes\";\n\n@injectable()\nexport class ClassDiagramModelSource extends LocalModelSource {\n  constructor() {\n    super();\n    this.currentRoot = this.initializeModel();\n    // this.model = this.initializeModel();\n  }\n\n  override initialize(registry: ActionHandlerRegistry): void {\n    super.initialize(registry);\n    registry.register(CreatingFbAction.KIND, this);\n    registry.register(CreatingInpAction.KIND, this);\n  }\n\n  override handle(action: Action) {\n    switch (action.kind) {\n      case CreatingInpAction.KIND:\n        this.creatingInp(action as CreatingInpAction);\n        break;\n      case CreatingFbAction.KIND:\n        this.creatingFb(action as CreatingFbAction);\n        break;\n      default:\n        super.handle(action);\n    }\n  }\n  async creatingFb(action: CreatingFbAction) {\n    let point = action.point;\n    const viewport = await this.getViewport();\n    const adjust = (offset: number) => {\n      return offset / viewport.zoom - 100 / 2;\n    };\n    let position = {\n      x: viewport.scroll.x + adjust(point.x),\n      y: viewport.scroll.y + adjust(point.y),\n    };\n    console.log(action.point);\n    let id = createRandomId();\n    let newNode = <SNode>{\n      id: id,\n      type: \"node4diac\",\n      position,\n      size: { width: 100, height: 100 },\n      layoutOptions: {\n        resizeContainer: true,\n      },\n      children: [\n        <SLabel>{\n          id: `${id}_title`,\n          text:\n            \"FB #\" +\n            (this.model.children.filter((item) => item.type == \"node4diac\")\n              .length +\n              1),\n          type: \"node4diac:title\",\n          position: { x: 20, y: 0 },\n        },\n        <SCompartment>{\n          id: `${id}_inputs`,\n          position: { x: 0, y: 50 },\n          type: \"node4diac:inputs\",\n          layout: \"vbox\",\n          layoutOptions: {\n            hAlign: \"left\",\n            resizeContainer: true,\n          },\n          children: [],\n        },\n      ],\n    };\n    this.addElements([{ element: newNode, parentId: this.model.id }]);\n    // this.updateModel();\n  }\n  creatingInp(action: CreatingInpAction) {\n    let id = createRandomId();\n    let parent = this.model.children.find((item) => item.id == action.parentId);\n    if (parent) {\n      let inputs = parent.children.find(\n        (item) => item.type == \"node4diac:inputs\"\n      );\n      if (inputs) {\n        this.addElements([\n          {\n            element: <SPort>{\n              type: \"node4diac:port\",\n              id: id,\n              children: [\n                <SLabel>{\n                  id: `${id}_title`,\n                  text: \"INP\",\n                  type: \"node4diac:port_title\",\n                },\n              ],\n            },\n            parentId: inputs.id,\n          },\n        ]);\n        this.updateModel();\n      }\n    }\n  }\n\n  initializeModel() {\n    let node1 = <SNode>{\n      id: \"node1\",\n      type: \"node4diac\",\n      position: {\n        x: 100,\n        y: 100,\n      },\n      size: { width: 100, height: 100 },\n      // layout: \"vbox\",\n      layoutOptions: {\n        resizeContainer: true,\n      },\n      children: [\n        <SLabel>{\n          id: \"node1_title\",\n          text: \"FB #1\",\n          type: \"node4diac:title\",\n          position: { x: 20, y: 0 },\n        },\n        <SCompartment>{\n          id: \"node1_inputs\",\n          position: { x: 0, y: 50 },\n          type: \"node4diac:inputs\",\n          layout: \"vbox\",\n          layoutOptions: {\n            hAlign: \"left\",\n            resizeContainer: true,\n          },\n          children: [\n            <SPort>{\n              id: \"node1_port1\",\n              type: \"node4diac:port\",\n              // anchorKind: \"diamond\",\n              children: [\n                <SLabel>{\n                  id: \"node1_port_title1\",\n                  text: \"INP\",\n                  type: \"node4diac:port_title\",\n                },\n              ],\n            },\n            <SPort>{\n              id: \"node1_port2\",\n              type: \"node4diac:port\",\n              // anchorKind: \"diamond\",\n              children: [\n                <SLabel>{\n                  id: \"node1_port_title2\",\n                  text: \"INP\",\n                  type: \"node4diac:port_title\",\n                },\n              ],\n            },\n          ],\n        },\n      ],\n    };\n\n    let node2 = <SNode>{\n      id: \"node2\",\n      type: \"node4diac\",\n      position: {\n        x: 300,\n        y: 300,\n      },\n      size: { width: 100, height: 100 },\n      children: [\n        <SLabel>{\n          id: \"node2_title\",\n          text: \"FB #2\",\n          type: \"node4diac:title\",\n          position: { x: 20, y: 0 },\n        },\n        <SCompartment>{\n          id: \"node2_inputs\",\n          position: { x: 0, y: 50 },\n          type: \"node4diac:inputs\",\n          layout: \"vbox\",\n          layoutOptions: {\n            hAlign: \"left\",\n          },\n          children: [\n            <SPort>{\n              id: \"node2_port1\",\n              type: \"node4diac:port\",\n              // anchorKind: \"diamond\",\n              children: [\n                <SLabel>{\n                  id: \"node2_port_title1\",\n                  text: \"INP\",\n                  type: \"node4diac:port_title\",\n                },\n              ],\n            },\n            <SPort>{\n              id: \"node2_port2\",\n              type: \"node4diac:port\",\n              // anchorKind: \"diamond\",\n              children: [\n                <SLabel>{\n                  id: \"node2_port_title2\",\n                  text: \"INP\",\n                  type: \"node4diac:port_title\",\n                },\n              ],\n            },\n          ],\n        },\n      ],\n    };\n\n    const graph: SGraph = {\n      id: \"root\",\n      type: \"graph\",\n      children: [node1, node2],\n      layoutOptions: {\n        // hGap: 5,\n        // paddingLeft: 7,\n        // paddingRight: 7,\n        // paddingTop: 7,\n        // paddingBottom: 7,\n      },\n    };\n    return graph;\n  }\n}\n", "import { Action, MouseListener, Point } from \"@eclipse-glsp/client\";\nimport { SModelElementImpl, findParent } from \"sprotty\";\nimport { injectable } from \"inversify\";\nimport { Node4diac } from \"../../models\";\n\n// export const NodeCreator = Symbol(\"NodeCreator\");\n\n@injectable()\nexport class DroppableMouseListener extends MouseListener {\n  //   @inject(NodeCreator) nodeCreator: (point: Point, type: string) => void;\n\n  override dragOver(\n    target: SModelElementImpl,\n    event: MouseEvent\n  ): (Action | Promise<Action>)[] {\n    event.preventDefault();\n    return [];\n  }\n\n  override drop(\n    target: SModelElementImpl,\n    e: DragEvent\n  ): (Action | Promise<Action>)[] {\n    let actions: Action[] = [];\n    let type = e.dataTransfer.getData(\"text/plain\");\n    if (type == \"INP\") {\n      if (!(target instanceof Node4diac)) {\n        target = findParent(target, (item) => item.type == \"node4diac\");\n      }\n      if (target instanceof Node4diac) {\n        actions = [CreatingInpAction.create(target.id)];\n      }\n    } else if (type == \"FB\") {\n      let point: Point = { x: e.offsetX, y: e.offsetY };\n      actions = [CreatingFbAction.create(point)];\n    }\n    return actions;\n  }\n}\n\nexport interface CreatingInpAction extends Action {\n  kind: typeof CreatingInpAction.KIND;\n  parentId: string;\n}\nexport namespace CreatingInpAction {\n  export const KIND = \"CreatingInp\";\n\n  export function create(parentId: string): CreatingInpAction {\n    return {\n      kind: KIND,\n      parentId,\n    };\n  }\n}\n\nexport interface CreatingFbAction extends Action {\n  kind: typeof CreatingFbAction.KIND;\n  point: Point;\n}\nexport namespace CreatingFbAction {\n  export const KIND = \"CreatingFb\";\n\n  export function create(point: Point): CreatingFbAction {\n    return {\n      kind: KIND,\n      point,\n    };\n  }\n}\n", "import { ContainerModule } from \"inversify\";\nimport {\n  CreateEdgeCommand,\n  CreatingEdgeCommand,\n  CreatingEdgeMouseListener,\n} from \"./creatingEdge\";\n// import { configureCommand } from \"../../base/commands/command-registration\";\nimport { configureCommand } from \"sprotty\";\nimport { bindAsService, TYPES } from \"@eclipse-glsp/client\";\nimport { configureDanglingFeedbackEdge } from \"../edge-creation/dangling-edge-feedback\";\n// import { configureDanglingFeedbackEdge } from \"@eclipse-glsp/client/src/features/tools/edge-creation/dangling-edge-feedback\";\n\nconst creatingEdgeModule = new ContainerModule(\n  (bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    configureCommand({ bind, isBound }, CreatingEdgeCommand);\n    configureCommand({ bind, isBound }, CreateEdgeCommand);\n\n    bind(CreatingEdgeMouseListener).toSelf().inSingletonScope();\n    bind(TYPES.MouseListener).toService(CreatingEdgeMouseListener);\n\n    // bindAsService(context, TYPES.ITool, EdgeCreationTool);\n    configureDanglingFeedbackEdge(context);\n  }\n);\n\nexport default creatingEdgeModule;\n", "import { inject, injectable, optional } from \"inversify\";\nimport { VNode } from \"snabbdom\";\nimport {\n  AnchorComputerRegistry,\n  ButtonHandlerRegistry,\n  Command,\n  CommandExecutionContext,\n  CommitModelAction,\n  Connectable,\n  PolylineEdgeRouter,\n  SModelElementImpl,\n  SModelRootImpl,\n  Selectable,\n  TYPES,\n  createRandomId,\n  findChildrenAtPosition,\n  findParentByFeature,\n  isBoundsAware,\n  isConnectable,\n  setClass,\n} from \"sprotty\";\nimport { Action } from \"sprotty-protocol/lib/actions\";\nimport { CreatableEdge, isCreatableEdge } from \"./model\";\nimport {\n  Bounds,\n  CreateEdgeOperation,\n  DefaultTypes,\n  DragAwareMouseListener,\n  GChildElement,\n  GConnectableElement,\n  GModelElement,\n  MoveAction,\n  Point,\n  absoluteToParent,\n  getAbsolutePosition,\n  toAbsoluteBounds,\n} from \"@eclipse-glsp/client\";\nimport {\n  DrawFeedbackEdgeAction,\n  FeedbackEdgeEnd,\n  RemoveFeedbackEdgeAction,\n  feedbackEdgeEndId,\n} from \"../edge-creation/dangling-edge-feedback\";\n// import {\n//   DrawFeedbackEdgeAction,\n//   FeedbackEdgeEnd,\n//   RemoveFeedbackEdgeAction,\n//   feedbackEdgeEndId,\n// } from \"@eclipse-glsp/client/src/features/tools/edge-creation/dangling-edge-feedback\";\nimport { SEdge } from \"sprotty-protocol\";\n\nexport interface CreatingEdgeAction extends Action {\n  kind: typeof CreatingEdgeAction.KIND;\n  sourceId: string;\n}\nexport namespace CreatingEdgeAction {\n  export const KIND = \"CreatingEdge\";\n\n  export function create(sourceId: string): CreatingEdgeAction {\n    return {\n      kind: KIND,\n      sourceId,\n    };\n  }\n}\n\n@injectable()\nexport class CreateEdgeCommand extends Command {\n  static readonly KIND = CreateEdgeOperation.KIND;\n  private id: string;\n\n  constructor(@inject(TYPES.Action) public action: CreateEdgeOperation) {\n    super();\n  }\n\n  execute(context: CommandExecutionContext): SModelRootImpl {\n    this.id = createRandomId();\n    return this.redo(context);\n  }\n\n  undo(context: CommandExecutionContext): SModelRootImpl {\n    if (this.id) {\n      const model = context.root;\n      let element = model.index.getById(this.id);\n      if (element instanceof GChildElement) {\n        context.root.remove(element);\n      }\n      return context.root;\n    }\n  }\n\n  redo(context: CommandExecutionContext): SModelRootImpl {\n    let a = this.action;\n    let element = context.modelFactory.createElement(<SEdge>{\n      sourceId: a.sourceElementId,\n      targetId: a.targetElementId,\n      routerKind: \"manhattan\",\n      type: DefaultTypes.EDGE,\n      id: this.id,\n    });\n    const model = context.root;\n    model.add(element);\n    return context.root;\n  }\n}\n\n@injectable()\nexport class CreatingEdgeCommand extends Command {\n  static readonly KIND = CreatingEdgeAction.KIND;\n\n  constructor(@inject(TYPES.Action) public action: CreatingEdgeAction) {\n    super();\n  }\n\n  execute(context: CommandExecutionContext): SModelRootImpl {\n    const model = context.root;\n    let element = model.index.getById(this.action.sourceId);\n    if (element && isCreatableEdge(element)) {\n      element.selected = !element.selected;\n    }\n    return this.redo(context);\n  }\n\n  undo(context: CommandExecutionContext): SModelRootImpl {\n    return context.root;\n  }\n\n  redo(context: CommandExecutionContext): SModelRootImpl {\n    return context.root;\n  }\n}\n\nexport class CreatingEdgeMouseListener extends DragAwareMouseListener {\n  @inject(ButtonHandlerRegistry)\n  @optional()\n  protected buttonHandlerRegistry: ButtonHandlerRegistry;\n\n  @inject(AnchorComputerRegistry)\n  protected anchorRegistry: AnchorComputerRegistry;\n\n  protected source?: string;\n  protected target?: string;\n  protected currentTarget?: GModelElement;\n  protected allowedTarget = false;\n  protected pendingDynamicCheck = false;\n\n  wasSelected = false;\n  constructing = false;\n\n  protected reinitialize(): void {\n    this.source = undefined;\n    this.target = undefined;\n    this.currentTarget = undefined;\n    this.allowedTarget = false;\n  }\n\n  // override doubleClick(target: SModelElementImpl, event: MouseEvent): Action[] {\n  override mouseDown(target: SModelElementImpl, event: MouseEvent): Action[] {\n    let creatableEdge = getCreatableEdge(target);\n    if (!creatableEdge) {\n      creatableEdge = findParentByFeature(target, isCreatableEdge);\n    }\n    if (creatableEdge) {\n      this.constructing = true;\n      this.source = creatableEdge.id;\n      return [\n        DrawFeedbackEdgeAction.create({\n          elementTypeId: DefaultTypes.EDGE,\n          sourceId: creatableEdge.id,\n        }),\n      ];\n    }\n    return [];\n  }\n\n  override nonDraggingMouseUp(\n    target: SModelElementImpl,\n    event: MouseEvent\n  ): Action[] {\n    if (this.constructing) {\n      this.constructing = false;\n\n      const root = target.root;\n      let edgeEnd = root.index.getById(target.id);\n      let connectable = false;\n      if (edgeEnd) {\n        edgeEnd = findParentByFeature(edgeEnd, isConnectable);\n        if (edgeEnd) {\n          connectable = true;\n        }\n      }\n\n      if (connectable && edgeEnd.id != this.source) {\n        return [\n          CreateEdgeOperation.create({\n            elementTypeId: DefaultTypes.EDGE,\n            sourceElementId: this.source,\n            targetElementId: edgeEnd.id,\n            // args: this.triggerAction.args,\n          }),\n          RemoveFeedbackEdgeAction.create(),\n          CommitModelAction.create(),\n        ];\n      } else {\n        return [RemoveFeedbackEdgeAction.create()];\n      }\n    }\n    return [];\n  }\n\n  override mouseMove(target: SModelElementImpl, event: MouseEvent) {\n    if (this.constructing) {\n      // console.log(\"mouse move\");\n      const root = target.root;\n      const edgeEnd = root.index.getById(feedbackEdgeEndId(root));\n      if (!(edgeEnd instanceof FeedbackEdgeEnd) || !edgeEnd.feedbackEdge) {\n        return [];\n      }\n      const edge = edgeEnd.feedbackEdge;\n      const position = getAbsolutePosition(edgeEnd, event);\n      const endAtMousePosition = findChildrenAtPosition(target.root, position)\n        .reverse()\n        .find(\n          (element) =>\n            isConnectable(element) && element.canConnect(edge, \"target\")\n        );\n      if (\n        endAtMousePosition instanceof GConnectableElement &&\n        edge.source &&\n        isBoundsAware(edge.source)\n      ) {\n        const anchor = this.computeAbsoluteAnchor(\n          endAtMousePosition,\n          Bounds.center(toAbsoluteBounds(edge.source))\n        );\n        if (Point.euclideanDistance(anchor, edgeEnd.position) > 1) {\n          let actions: Action[] = [\n            MoveAction.create([{ elementId: edgeEnd.id, toPosition: anchor }], {\n              animate: false,\n            }),\n          ];\n          return actions;\n        }\n      } else {\n        return [\n          MoveAction.create([{ elementId: edgeEnd.id, toPosition: position }], {\n            animate: false,\n          }),\n        ];\n      }\n    }\n    return [];\n  }\n\n  protected computeAbsoluteAnchor(\n    element: GConnectableElement,\n    absoluteReferencePoint: Point,\n    offset?: number\n  ): Point {\n    const referencePointInParent = absoluteToParent(\n      element,\n      absoluteReferencePoint\n    );\n    const anchorComputer = this.anchorRegistry.get(\n      PolylineEdgeRouter.KIND,\n      element.anchorKind\n    );\n    let anchor = anchorComputer.getAnchor(\n      element,\n      referencePointInParent,\n      offset\n    );\n    // The anchor is computed in the local coordinate system of the element.\n    // If the element is a nested child element we have to add the absolute position of its parent to the anchor.\n    if (element.parent !== element.root) {\n      const parent = findParentByFeature(element.parent, isBoundsAware);\n      if (parent) {\n        const absoluteParentPosition = toAbsoluteBounds(parent);\n        anchor = Point.add(absoluteParentPosition, anchor);\n      }\n    }\n    return anchor;\n  }\n\n  protected isSourceSelected(): boolean {\n    return this.source !== undefined;\n  }\n\n  protected isTargetSelected(): boolean {\n    return this.target !== undefined;\n  }\n\n  override decorate(vnode: VNode, element: SModelElementImpl): VNode {\n    let selectableTarget = getCreatableEdge(element);\n    if (selectableTarget !== undefined) {\n      setClass(vnode, \"selected\", selectableTarget.selected);\n    }\n    return vnode;\n  }\n}\n\nexport function getCreatableEdge(\n  element: SModelElementImpl\n): (CreatableEdge & Selectable & SModelElementImpl & Connectable) | undefined {\n  // ): typeof isCreatableEdge {\n  if (isCreatableEdge(element)) {\n    return element;\n  }\n  return undefined;\n}\n", "import {\n  Connectable,\n  SEdgeImpl,\n  SModelElementImpl,\n  Selectable,\n  getRouteBounds,\n} from \"sprotty\";\nimport { Bounds, Point, isBounds } from \"sprotty-protocol\";\n\nexport const creatingEdgeFeature = Symbol(\"creatingEdgeFeature\");\n\n/**\n * Feature extension interface for {@link creatingEdgeFeature}.\n */\nexport interface CreatableEdge {\n  creatingEdge: boolean;\n}\n\nexport function isCreatableEdge(\n  element: SModelElementImpl\n): element is SModelElementImpl & CreatableEdge & Selectable & Connectable {\n  return element.hasFeature(creatingEdgeFeature);\n}\n\nexport function isCreatingEdge(\n  element: SModelElementImpl | undefined\n): element is SModelElementImpl & CreatableEdge {\n  return (\n    element !== undefined && isCreatableEdge(element) && element.creatingEdge\n  );\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\nimport { inject, injectable } from \"inversify\";\nimport {\n  Action,\n  BindingContext,\n  CommandExecutionContext,\n  CommandReturn,\n  GChildElement,\n  GModelRoot,\n  GRoutableElement,\n  TYPES,\n  configureCommand,\n  configureView,\n  findParentByFeature,\n  isBoundsAware,\n  isConnectable,\n  GDanglingAnchor,\n  GEdgeSchema,\n} from \"@eclipse-glsp/sprotty\";\nimport { FeedbackEdgeEndView } from \"./view\";\nimport {\n  FeedbackCommand,\n  isRoutable,\n  toAbsolutePosition,\n} from \"@eclipse-glsp/client\";\n\nexport interface DrawFeedbackEdgeAction extends Action {\n  kind: typeof DrawFeedbackEdgeAction.KIND;\n  elementTypeId: string;\n  sourceId: string;\n  edgeSchema?: Partial<GEdgeSchema>;\n}\n\nexport namespace DrawFeedbackEdgeAction {\n  export const KIND = \"drawFeedbackEdge\";\n\n  export function is(object: any): object is DrawFeedbackEdgeAction {\n    return Action.hasKind(object, KIND);\n  }\n\n  export function create(options: {\n    elementTypeId: string;\n    sourceId: string;\n    edgeSchema?: Partial<GEdgeSchema>;\n  }): DrawFeedbackEdgeAction {\n    return {\n      kind: KIND,\n      ...options,\n    };\n  }\n}\n\n@injectable()\nexport class DrawFeedbackEdgeCommand extends FeedbackCommand {\n  static readonly KIND = DrawFeedbackEdgeAction.KIND;\n\n  constructor(@inject(TYPES.Action) protected action: DrawFeedbackEdgeAction) {\n    super();\n  }\n\n  execute(context: CommandExecutionContext): CommandReturn {\n    drawFeedbackEdge(\n      context,\n      this.action.sourceId,\n      this.action.elementTypeId,\n      this.action.edgeSchema\n    );\n    return context.root;\n  }\n}\n\nexport interface RemoveFeedbackEdgeAction extends Action {\n  kind: typeof RemoveFeedbackEdgeAction.KIND;\n}\n\nexport namespace RemoveFeedbackEdgeAction {\n  export const KIND = \"removeFeedbackEdgeCommand\";\n\n  export function is(object: any): object is RemoveFeedbackEdgeAction {\n    return Action.hasKind(object, KIND);\n  }\n\n  export function create(): RemoveFeedbackEdgeAction {\n    return { kind: KIND };\n  }\n}\n\n@injectable()\nexport class RemoveFeedbackEdgeCommand extends FeedbackCommand {\n  static readonly KIND = RemoveFeedbackEdgeAction.KIND;\n\n  execute(context: CommandExecutionContext): CommandReturn {\n    removeDanglingFeedbackEdge(context.root);\n    return context.root;\n  }\n}\n\nexport class FeedbackEdgeEnd extends GDanglingAnchor {\n  static readonly TYPE = \"feedback-edge-end\";\n  constructor(\n    readonly sourceId: string,\n    readonly elementTypeId: string,\n    public feedbackEdge: GRoutableElement | undefined = undefined,\n    override readonly type: string = FeedbackEdgeEnd.TYPE\n  ) {\n    super();\n  }\n}\n\nexport function feedbackEdgeId(root: GModelRoot): string {\n  return root.id + \"_feedback_edge\";\n}\n\nexport function feedbackEdgeEndId(root: GModelRoot): string {\n  return root.id + \"_feedback_anchor\";\n}\n\nexport const defaultFeedbackEdgeSchema: Partial<GEdgeSchema> = {\n  cssClasses: [\"feedback-edge\"],\n  opacity: 0.3,\n};\n\nexport function drawFeedbackEdge(\n  context: CommandExecutionContext,\n  sourceId: string,\n  elementTypeId: string,\n  edgeTemplate?: Partial<GEdgeSchema>\n): void {\n  const root = context.root;\n  const sourceChild = root.index.getById(sourceId);\n  if (!sourceChild) {\n    return;\n  }\n\n  const source = findParentByFeature(sourceChild, isConnectable);\n  if (!source || !isBoundsAware(source)) {\n    return;\n  }\n\n  const edgeEnd = new FeedbackEdgeEnd(source.id, elementTypeId);\n  edgeEnd.id = feedbackEdgeEndId(root);\n  edgeEnd.position = toAbsolutePosition(source);\n\n  const edgeSchema: GEdgeSchema = {\n    id: feedbackEdgeId(root),\n    type: elementTypeId,\n    sourceId: source.id,\n    targetId: edgeEnd.id,\n    ...defaultFeedbackEdgeSchema,\n    ...edgeTemplate,\n  };\n\n  const feedbackEdge = context.modelFactory.createElement(edgeSchema);\n  if (isRoutable(feedbackEdge)) {\n    edgeEnd.feedbackEdge = feedbackEdge;\n    root.add(edgeEnd);\n    root.add(feedbackEdge);\n  }\n}\n\nexport function removeDanglingFeedbackEdge(root: GModelRoot): void {\n  const feedbackEdge = root.index.getById(feedbackEdgeId(root));\n  const feedbackEdgeEnd = root.index.getById(feedbackEdgeEndId(root));\n  if (feedbackEdge instanceof GChildElement) {\n    root.remove(feedbackEdge);\n  }\n  if (feedbackEdgeEnd instanceof GChildElement) {\n    root.remove(feedbackEdgeEnd);\n  }\n}\n\nexport function configureDanglingFeedbackEdge(context: BindingContext): void {\n  if (\n    !context.isBound(DrawFeedbackEdgeCommand) &&\n    !context.isBound(RemoveFeedbackEdgeCommand) &&\n    !context.isBound(FeedbackEdgeEndView)\n  ) {\n    configureCommand(context, DrawFeedbackEdgeCommand);\n    configureCommand(context, RemoveFeedbackEdgeCommand);\n    configureView(context, FeedbackEdgeEnd.TYPE, FeedbackEdgeEndView);\n  }\n}\n", "/********************************************************************************\n * Copyright (c) 2019-2023 EclipseSource and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n/** @jsx svg */\nimport { injectable } from 'inversify';\nimport { VNode } from 'snabbdom';\nimport { IView, Point, RenderingContext, GModelElement, svg } from '@eclipse-glsp/sprotty';\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst JSX = { createElement: svg };\n\n/**\n * This view is used for the invisible end of the feedback edge.\n * A feedback edge is shown as a visual feedback when creating edges.\n */\n@injectable()\nexport class FeedbackEdgeEndView implements IView {\n    render(model: Readonly<GModelElement>, context: RenderingContext): VNode {\n        const position: Point = (model as any).position ?? Point.ORIGIN;\n        return <g x={position.x} y={position.y} />;\n    }\n}\n", "import { ContainerModule } from \"inversify\";\nimport { DroppableMouseListener } from \"./creatingNodes\";\nimport { TYPES, configureCommand } from \"@eclipse-glsp/client\";\n\nconst creatingEdgeModule = new ContainerModule(\n  (bind, unbind, isBound, rebind) => {\n    const context = { bind, unbind, isBound, rebind };\n    // configureCommand({ bind, isBound }, CreateInpCommand);\n    //   configureCommand({ bind, isBound }, CreateEdgeCommand);\n\n    // bind(NodeCreator).toConstantValue(nodeCreator);\n    bind(DroppableMouseListener).toSelf().inSingletonScope();\n    bind(TYPES.MouseListener).toService(DroppableMouseListener);\n  }\n);\n\nexport default creatingEdgeModule;\n"],
  "mappings": "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",
  "names": ["Binding", "MetadataReader", "Context", "Metadata", "Plan", "LazyServiceIdentifier", "QueryableString", "Target", "inject", "Request", "FactoryType", "resolve", "BindingWhenSyntax", "BindingOnSyntax", "BindingWhenOnSyntax", "BindingInSyntax", "BindingInWhenOnSyntax", "BindingToSyntax", "self", "ContainerSnapshot", "Lookup", "ModuleActivationStore", "Container", "module", "ContainerModule", "AsyncContainerModule", "m", "injectable", "inject", "optional", "interfaces", "RejectAction", "RequestModelAction", "SetModelAction", "UpdateModelAction", "RequestPopupModelAction", "SetPopupModelAction", "SetBoundsAction", "RequestBoundsAction", "ComputedBoundsAction", "LoggingAction", "SelectAction", "SelectAllAction", "GetSelectionAction", "SelectionResult", "CollapseExpandAction", "CollapseExpandAllAction", "OpenAction", "LayoutAction", "CenterAction", "FitToScreenAction", "SetViewportAction", "GetViewportAction", "ViewportResult", "BringToFrontAction", "UndoAction", "RedoAction", "MoveAction", "HoverFeedbackAction", "CreateElementAction", "DeleteElementAction", "ApplyLabelEditAction", "ReconnectAction", "Point", "angleOfPoint", "Bounds", "Dimension", "toDegrees", "SModelElementImpl", "SModelRootImpl", "createRandomId", "ActionHandlerRegistry", "Command", "configureCommand", "InitializeCanvasBoundsAction", "findParent", "findParentByFeature", "SetUIExtensionVisibilityAction", "setAttr", "setClass", "MouseListener", "tagName", "parentNode", "fragment", "vnode", "module", "init", "thunk", "jsx", "svg", "configureModelElement", "configureView", "configureViewerOptions", "LogLevel", "ConsoleLogger", "isBoundsAware", "findChildrenAtPosition", "ShapeView", "ButtonHandlerRegistry", "isConnectable", "SRoutingHandleImpl", "SGraphImpl", "SNodeImpl", "SPortImpl", "SEdgeImpl", "SLabelImpl", "SCompartmentImpl", "AnchorComputerRegistry", "Side", "PolylineEdgeRouter", "EditLabelAction", "ExportSvgAction", "svg", "CommitModelAction", "SwitchEditModeAction", "RequestExportSvgAction", "global", "TinyQueue", "AddRemoveBezierSegmentAction", "edgeIntersectionModule", "expandModule", "fadeModule", "SGraphView", "PolylineEdgeView", "PolylineEdgeViewWithGapsOnIntersections", "SRoutingHandleView", "SLabelView", "SCompartmentView", "loadDefaultModules", "RectangularNode", "a", "b", "c", "d", "g", "f", "e", "LocalModelSource", "Point", "angleOfPoint", "Bounds", "Dimension", "toDegrees", "RejectAction", "RequestModelAction", "SetModelAction", "UpdateModelAction", "RequestPopupModelAction", "SetPopupModelAction", "SetBoundsAction", "RequestBoundsAction", "ComputedBoundsAction", "LoggingAction", "SelectAction", "SelectAllAction", "GetSelectionAction", "SelectionResult", "CollapseExpandAction", "CollapseExpandAllAction", "OpenAction", "LayoutAction", "CenterAction", "FitToScreenAction", "SetViewportAction", "GetViewportAction", "ViewportResult", "BringToFrontAction", "UndoAction", "RedoAction", "MoveAction", "HoverFeedbackAction", "CreateElementAction", "DeleteElementAction", "ApplyLabelEditAction", "ReconnectAction", "AnyObject", "optional", "Action", "ActionMessage", "RequestAction", "ResponseAction", "RejectAction", "Operation", "CompoundOperation", "StatusAction", "MessageAction", "StartProgressAction", "UpdateProgressAction", "EndProgressAction", "RequestClipboardDataAction", "SetClipboardDataAction", "CutOperation", "PasteOperation", "RequestContextActions", "SetContextActions", "ReconnectEdgeOperation", "ChangeRoutingPointsOperation", "CreateOperation", "CreateNodeOperation", "CreateEdgeOperation", "DeleteElementOperation", "RequestPopupModelAction", "SetPopupModelAction", "NavigationTarget", "RequestNavigationTargetsAction", "SetNavigationTargetsAction", "NavigateToTargetAction", "ResolveNavigationTargetAction", "SetResolvedNavigationTargetAction", "NavigateToExternalTargetAction", "SelectAction", "SelectAllAction", "RequestEditValidationAction", "SetEditValidationResultAction", "ApplyLabelEditOperation", "ValidationStatus", "Severity", "RequestTypeHintsAction", "SetTypeHintsAction", "RequestCheckEdgeAction", "CheckEdgeResultAction", "MarkerKind", "MarkersReason", "RequestMarkersAction", "SetMarkersAction", "DeleteMarkersAction", "RequestModelAction", "SetModelAction", "UpdateModelAction", "SourceModelChangedAction", "SetEditModeAction", "EditMode", "RequestBoundsAction", "ComputedBoundsAction", "LayoutOperation", "SaveModelAction", "SetDirtyStateAction", "RequestExportSvgAction", "ExportSvgAction", "svg", "ChangeBoundsOperation", "ChangeContainerOperation", "TriggerNodeCreationAction", "TriggerEdgeCreationAction", "EditorContext", "LabeledAction", "PaletteItem", "MenuItem", "UndoAction", "RedoAction", "CenterAction", "FitToScreenAction", "ErrorCodes", "Message", "Touch", "Disposable", "RAL", "Event", "CancellationToken", "CancellationState", "MessageReader", "ResolvedMessageReaderOptions", "MessageWriter", "ResolvedMessageWriterOptions", "result", "CancelNotification", "ProgressToken", "ProgressNotification", "StarRequestHandler", "Trace", "TraceValues", "TraceFormat", "SetTraceNotification", "LogTraceNotification", "ConnectionErrors", "ConnectionStrategy", "IdCancellationReceiverStrategy", "RequestCancellationReceiverStrategy", "CancellationReceiverStrategy", "CancellationSenderStrategy", "CancellationStrategy", "MessageStrategy", "ConnectionOptions", "ConnectionState", "startTime", "RIL", "exports", "i", "ClientState", "GLSPClient", "JsonrpcGLSPClient", "_a", "_b", "DefaultTypes", "module", "bindAsService", "Disposable", "MouseListener", "AutoCompleteValue", "IValidationDecorator", "DragAwareMouseListener", "isRoutable", "SelectFeedbackAction", "FeedbackCommand", "FocusStateChangedAction", "Ranked", "ServerAction", "IDiagramStartup", "EnableToolsAction", "EnableDefaultToolsAction", "Tool", "ModifyCSSFeedbackAction", "CursorCSS", "GEdge", "RepositionAction", "undefined", "collection", "runInContext", "Array", "Date", "Error", "Function", "Math", "Object", "RegExp", "String", "TypeError", "Buffer", "Symbol", "Uint8Array", "Map", "Promise", "Set", "WeakMap", "result", "iteratee", "size", "values", "key", "setTimeout", "includes", "object", "indexOf", "set", "clearTimeout", "index", "ary", "othValue", "map", "transform", "parent", "clone", "isNaN", "parseInt", "unescape", "chain", "value", "SetAccessibleKeyShortcutAction", "require_messages", "HideToastAction", "ShowToastMessageAction", "NavigationMode", "navigator", "ResizeType", "ResizeElementAction", "ResizeHandleLocation", "location", "MoveViewportAction", "MoveElementAction", "ZoomViewportAction", "ZoomElementAction", "EnableKeyboardGridAction", "KeyboardGridCellSelectedAction", "KeyboardGridKeyboardEventAction", "getAbsolutePosition", "toAbsoluteBounds", "location", "toAbsolutePosition", "absoluteToParent", "ServerCommandPalette", "ServerContextMenu", "InvokeCopyPasteAction", "svg", "ApplyTypeHintsAction", "FeedbackEdgeEndView", "DrawFeedbackEdgeAction", "DrawFeedbackEdgeCommand", "drawFeedbackEdge", "RemoveFeedbackEdgeAction", "RemoveFeedbackEdgeCommand", "removeDanglingFeedbackEdge", "FeedbackEdgeEnd", "feedbackEdgeId", "feedbackEdgeEndId", "configureDanglingFeedbackEdge", "LabelEditValidation", "ResizeDimension", "ReduceFunction", "ResizeElementsAction", "Alignment", "SelectFunction", "AlignElementsAction", "NavigateAction", "ProcessNavigationArgumentsAction", "DrawMarqueeAction", "RemoveMarqueeAction", "EnableToolPaletteAction", "ShowChangeBoundsToolResizeFeedbackAction", "HideChangeBoundsToolResizeFeedbackAction", "ShowEdgeReconnectHandlesFeedbackAction", "HideEdgeReconnectHandlesFeedbackAction", "SwitchRoutingModeAction", "DrawFeedbackEdgeSourceAction", "location", "MarkerPredicates", "NavigateToMarkerAction", "ApplyMarkersAction", "FocusDomAction", "GArgument", "EdgePadding", "svg", "KeyboardGridMetadata", "KeyboardNodeGridMetadata", "SetEdgeTargetSelectionAction", "EdgeAutocompletePaletteMetadata", "KeyboardPointerMetadata", "SetKeyboardPointerRenderPositionAction", "location", "GridSearchPaletteMetadata", "Reflect", "hasOwn", "MapIterator", "Map", "Set", "WeakMap", "import_sprotty", "import_inversify", "import_sprotty", "import_sprotty", "import_sprotty", "import_inversify", "import_sprotty", "import_inversify", "CreatingInpAction", "CreatingFbAction", "import_inversify", "import_inversify", "import_sprotty", "import_client", "import_inversify", "import_sprotty", "import_inversify", "import_sprotty", "import_client", "DrawFeedbackEdgeAction", "RemoveFeedbackEdgeAction", "CreatingEdgeAction", "import_sprotty", "import_client", "import_inversify", "import_client", "creatingEdgeModule", "di_config_default", "import_client", "di_config_default"]
}
